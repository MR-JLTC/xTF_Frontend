var Uee=Object.defineProperty;var Vee=(t,e,n)=>e in t?Uee(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var $C=(t,e,n)=>Vee(t,typeof e!="symbol"?e+"":e,n);function o7(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in t)){const a=Object.getOwnPropertyDescriptor(s,r);a&&Object.defineProperty(t,r,a.get?a:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerPolicy&&(a.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?a.credentials="include":r.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(r){if(r.ep)return;r.ep=!0;const a=n(r);fetch(r.href,a)}})();function Hl(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function Wee(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var e=t.default;if(typeof e=="function"){var n=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var r=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(n,s,r.get?r:{enumerable:!0,get:function(){return t[s]}})}),n}var IC={exports:{}},Q0={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jP;function Hee(){if(jP)return Q0;jP=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(s,r,a){var i=null;if(a!==void 0&&(i=""+a),r.key!==void 0&&(i=""+r.key),"key"in r){a={};for(var l in r)l!=="key"&&(a[l]=r[l])}else a=r;return r=a.ref,{$$typeof:t,type:s,key:i,ref:r!==void 0?r:null,props:a}}return Q0.Fragment=e,Q0.jsx=n,Q0.jsxs=n,Q0}var kP;function Gee(){return kP||(kP=1,IC.exports=Hee()),IC.exports}var o=Gee(),RC={exports:{}},sn={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CP;function qee(){if(CP)return sn;CP=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),i=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),f=Symbol.for("react.activity"),p=Symbol.iterator;function x(O){return O===null||typeof O!="object"?null:(O=p&&O[p]||O["@@iterator"],typeof O=="function"?O:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v=Object.assign,b={};function N(O,U,J){this.props=O,this.context=U,this.refs=b,this.updater=J||y}N.prototype.isReactComponent={},N.prototype.setState=function(O,U){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,U,"setState")},N.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function S(){}S.prototype=N.prototype;function k(O,U,J){this.props=O,this.context=U,this.refs=b,this.updater=J||y}var T=k.prototype=new S;T.constructor=k,v(T,N.prototype),T.isPureReactComponent=!0;var E=Array.isArray;function D(){}var A={H:null,A:null,T:null,S:null},I=Object.prototype.hasOwnProperty;function P(O,U,J){var se=J.ref;return{$$typeof:t,type:O,key:U,ref:se!==void 0?se:null,props:J}}function $(O,U){return P(O.type,U,O.props)}function R(O){return typeof O=="object"&&O!==null&&O.$$typeof===t}function F(O){var U={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(J){return U[J]})}var W=/\/+/g;function q(O,U){return typeof O=="object"&&O!==null&&O.key!=null?F(""+O.key):U.toString(36)}function X(O){switch(O.status){case"fulfilled":return O.value;case"rejected":throw O.reason;default:switch(typeof O.status=="string"?O.then(D,D):(O.status="pending",O.then(function(U){O.status==="pending"&&(O.status="fulfilled",O.value=U)},function(U){O.status==="pending"&&(O.status="rejected",O.reason=U)})),O.status){case"fulfilled":return O.value;case"rejected":throw O.reason}}throw O}function z(O,U,J,se,ae){var fe=typeof O;(fe==="undefined"||fe==="boolean")&&(O=null);var ye=!1;if(O===null)ye=!0;else switch(fe){case"bigint":case"string":case"number":ye=!0;break;case"object":switch(O.$$typeof){case t:case e:ye=!0;break;case h:return ye=O._init,z(ye(O._payload),U,J,se,ae)}}if(ye)return ae=ae(O),ye=se===""?"."+q(O,0):se,E(ae)?(J="",ye!=null&&(J=ye.replace(W,"$&/")+"/"),z(ae,U,J,"",function(Se){return Se})):ae!=null&&(R(ae)&&(ae=$(ae,J+(ae.key==null||O&&O.key===ae.key?"":(""+ae.key).replace(W,"$&/")+"/")+ye)),U.push(ae)),1;ye=0;var Te=se===""?".":se+":";if(E(O))for(var oe=0;oe<O.length;oe++)se=O[oe],fe=Te+q(se,oe),ye+=z(se,U,J,fe,ae);else if(oe=x(O),typeof oe=="function")for(O=oe.call(O),oe=0;!(se=O.next()).done;)se=se.value,fe=Te+q(se,oe++),ye+=z(se,U,J,fe,ae);else if(fe==="object"){if(typeof O.then=="function")return z(X(O),U,J,se,ae);throw U=String(O),Error("Objects are not valid as a React child (found: "+(U==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":U)+"). If you meant to render a collection of children, use an array instead.")}return ye}function K(O,U,J){if(O==null)return O;var se=[],ae=0;return z(O,se,"","",function(fe){return U.call(J,fe,ae++)}),se}function H(O){if(O._status===-1){var U=O._result;U=U(),U.then(function(J){(O._status===0||O._status===-1)&&(O._status=1,O._result=J)},function(J){(O._status===0||O._status===-1)&&(O._status=2,O._result=J)}),O._status===-1&&(O._status=0,O._result=U)}if(O._status===1)return O._result.default;throw O._result}var Y=typeof reportError=="function"?reportError:function(O){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var U=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof O=="object"&&O!==null&&typeof O.message=="string"?String(O.message):String(O),error:O});if(!window.dispatchEvent(U))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",O);return}console.error(O)},B={map:K,forEach:function(O,U,J){K(O,function(){U.apply(this,arguments)},J)},count:function(O){var U=0;return K(O,function(){U++}),U},toArray:function(O){return K(O,function(U){return U})||[]},only:function(O){if(!R(O))throw Error("React.Children.only expected to receive a single React element child.");return O}};return sn.Activity=f,sn.Children=B,sn.Component=N,sn.Fragment=n,sn.Profiler=r,sn.PureComponent=k,sn.StrictMode=s,sn.Suspense=c,sn.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=A,sn.__COMPILER_RUNTIME={__proto__:null,c:function(O){return A.H.useMemoCache(O)}},sn.cache=function(O){return function(){return O.apply(null,arguments)}},sn.cacheSignal=function(){return null},sn.cloneElement=function(O,U,J){if(O==null)throw Error("The argument must be a React element, but you passed "+O+".");var se=v({},O.props),ae=O.key;if(U!=null)for(fe in U.key!==void 0&&(ae=""+U.key),U)!I.call(U,fe)||fe==="key"||fe==="__self"||fe==="__source"||fe==="ref"&&U.ref===void 0||(se[fe]=U[fe]);var fe=arguments.length-2;if(fe===1)se.children=J;else if(1<fe){for(var ye=Array(fe),Te=0;Te<fe;Te++)ye[Te]=arguments[Te+2];se.children=ye}return P(O.type,ae,se)},sn.createContext=function(O){return O={$$typeof:i,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null},O.Provider=O,O.Consumer={$$typeof:a,_context:O},O},sn.createElement=function(O,U,J){var se,ae={},fe=null;if(U!=null)for(se in U.key!==void 0&&(fe=""+U.key),U)I.call(U,se)&&se!=="key"&&se!=="__self"&&se!=="__source"&&(ae[se]=U[se]);var ye=arguments.length-2;if(ye===1)ae.children=J;else if(1<ye){for(var Te=Array(ye),oe=0;oe<ye;oe++)Te[oe]=arguments[oe+2];ae.children=Te}if(O&&O.defaultProps)for(se in ye=O.defaultProps,ye)ae[se]===void 0&&(ae[se]=ye[se]);return P(O,fe,ae)},sn.createRef=function(){return{current:null}},sn.forwardRef=function(O){return{$$typeof:l,render:O}},sn.isValidElement=R,sn.lazy=function(O){return{$$typeof:h,_payload:{_status:-1,_result:O},_init:H}},sn.memo=function(O,U){return{$$typeof:u,type:O,compare:U===void 0?null:U}},sn.startTransition=function(O){var U=A.T,J={};A.T=J;try{var se=O(),ae=A.S;ae!==null&&ae(J,se),typeof se=="object"&&se!==null&&typeof se.then=="function"&&se.then(D,Y)}catch(fe){Y(fe)}finally{U!==null&&J.types!==null&&(U.types=J.types),A.T=U}},sn.unstable_useCacheRefresh=function(){return A.H.useCacheRefresh()},sn.use=function(O){return A.H.use(O)},sn.useActionState=function(O,U,J){return A.H.useActionState(O,U,J)},sn.useCallback=function(O,U){return A.H.useCallback(O,U)},sn.useContext=function(O){return A.H.useContext(O)},sn.useDebugValue=function(){},sn.useDeferredValue=function(O,U){return A.H.useDeferredValue(O,U)},sn.useEffect=function(O,U){return A.H.useEffect(O,U)},sn.useEffectEvent=function(O){return A.H.useEffectEvent(O)},sn.useId=function(){return A.H.useId()},sn.useImperativeHandle=function(O,U,J){return A.H.useImperativeHandle(O,U,J)},sn.useInsertionEffect=function(O,U){return A.H.useInsertionEffect(O,U)},sn.useLayoutEffect=function(O,U){return A.H.useLayoutEffect(O,U)},sn.useMemo=function(O,U){return A.H.useMemo(O,U)},sn.useOptimistic=function(O,U){return A.H.useOptimistic(O,U)},sn.useReducer=function(O,U,J){return A.H.useReducer(O,U,J)},sn.useRef=function(O){return A.H.useRef(O)},sn.useState=function(O){return A.H.useState(O)},sn.useSyncExternalStore=function(O,U,J){return A.H.useSyncExternalStore(O,U,J)},sn.useTransition=function(){return A.H.useTransition()},sn.version="19.2.0",sn}var TP;function Tf(){return TP||(TP=1,RC.exports=qee()),RC.exports}var j=Tf();const tn=Hl(j),Kee=o7({__proto__:null,default:tn},[j]);var OC={exports:{}},Z0={},DC={exports:{}},PC={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _P;function Xee(){return _P||(_P=1,(function(t){function e(z,K){var H=z.length;z.push(K);e:for(;0<H;){var Y=H-1>>>1,B=z[Y];if(0<r(B,K))z[Y]=K,z[H]=B,H=Y;else break e}}function n(z){return z.length===0?null:z[0]}function s(z){if(z.length===0)return null;var K=z[0],H=z.pop();if(H!==K){z[0]=H;e:for(var Y=0,B=z.length,O=B>>>1;Y<O;){var U=2*(Y+1)-1,J=z[U],se=U+1,ae=z[se];if(0>r(J,H))se<B&&0>r(ae,J)?(z[Y]=ae,z[se]=H,Y=se):(z[Y]=J,z[U]=H,Y=U);else if(se<B&&0>r(ae,H))z[Y]=ae,z[se]=H,Y=se;else break e}}return K}function r(z,K){var H=z.sortIndex-K.sortIndex;return H!==0?H:z.id-K.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var i=Date,l=i.now();t.unstable_now=function(){return i.now()-l}}var c=[],u=[],h=1,f=null,p=3,x=!1,y=!1,v=!1,b=!1,N=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;function T(z){for(var K=n(u);K!==null;){if(K.callback===null)s(u);else if(K.startTime<=z)s(u),K.sortIndex=K.expirationTime,e(c,K);else break;K=n(u)}}function E(z){if(v=!1,T(z),!y)if(n(c)!==null)y=!0,D||(D=!0,F());else{var K=n(u);K!==null&&X(E,K.startTime-z)}}var D=!1,A=-1,I=5,P=-1;function $(){return b?!0:!(t.unstable_now()-P<I)}function R(){if(b=!1,D){var z=t.unstable_now();P=z;var K=!0;try{e:{y=!1,v&&(v=!1,S(A),A=-1),x=!0;var H=p;try{t:{for(T(z),f=n(c);f!==null&&!(f.expirationTime>z&&$());){var Y=f.callback;if(typeof Y=="function"){f.callback=null,p=f.priorityLevel;var B=Y(f.expirationTime<=z);if(z=t.unstable_now(),typeof B=="function"){f.callback=B,T(z),K=!0;break t}f===n(c)&&s(c),T(z)}else s(c);f=n(c)}if(f!==null)K=!0;else{var O=n(u);O!==null&&X(E,O.startTime-z),K=!1}}break e}finally{f=null,p=H,x=!1}K=void 0}}finally{K?F():D=!1}}}var F;if(typeof k=="function")F=function(){k(R)};else if(typeof MessageChannel<"u"){var W=new MessageChannel,q=W.port2;W.port1.onmessage=R,F=function(){q.postMessage(null)}}else F=function(){N(R,0)};function X(z,K){A=N(function(){z(t.unstable_now())},K)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(z){z.callback=null},t.unstable_forceFrameRate=function(z){0>z||125<z?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<z?Math.floor(1e3/z):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_next=function(z){switch(p){case 1:case 2:case 3:var K=3;break;default:K=p}var H=p;p=K;try{return z()}finally{p=H}},t.unstable_requestPaint=function(){b=!0},t.unstable_runWithPriority=function(z,K){switch(z){case 1:case 2:case 3:case 4:case 5:break;default:z=3}var H=p;p=z;try{return K()}finally{p=H}},t.unstable_scheduleCallback=function(z,K,H){var Y=t.unstable_now();switch(typeof H=="object"&&H!==null?(H=H.delay,H=typeof H=="number"&&0<H?Y+H:Y):H=Y,z){case 1:var B=-1;break;case 2:B=250;break;case 5:B=1073741823;break;case 4:B=1e4;break;default:B=5e3}return B=H+B,z={id:h++,callback:K,priorityLevel:z,startTime:H,expirationTime:B,sortIndex:-1},H>Y?(z.sortIndex=H,e(u,z),n(c)===null&&z===n(u)&&(v?(S(A),A=-1):v=!0,X(E,H-Y))):(z.sortIndex=B,e(c,z),y||x||(y=!0,D||(D=!0,F()))),z},t.unstable_shouldYield=$,t.unstable_wrapCallback=function(z){var K=p;return function(){var H=p;p=K;try{return z.apply(this,arguments)}finally{p=H}}}})(PC)),PC}var EP;function Yee(){return EP||(EP=1,DC.exports=Xee()),DC.exports}var LC={exports:{}},ga={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AP;function Qee(){if(AP)return ga;AP=1;var t=Tf();function e(c){var u="https://react.dev/errors/"+c;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var h=2;h<arguments.length;h++)u+="&args[]="+encodeURIComponent(arguments[h])}return"Minified React error #"+c+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var s={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},r=Symbol.for("react.portal");function a(c,u,h){var f=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:f==null?null:""+f,children:c,containerInfo:u,implementation:h}}var i=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(c,u){if(c==="font")return"";if(typeof u=="string")return u==="use-credentials"?u:""}return ga.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=s,ga.createPortal=function(c,u){var h=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)throw Error(e(299));return a(c,u,null,h)},ga.flushSync=function(c){var u=i.T,h=s.p;try{if(i.T=null,s.p=2,c)return c()}finally{i.T=u,s.p=h,s.d.f()}},ga.preconnect=function(c,u){typeof c=="string"&&(u?(u=u.crossOrigin,u=typeof u=="string"?u==="use-credentials"?u:"":void 0):u=null,s.d.C(c,u))},ga.prefetchDNS=function(c){typeof c=="string"&&s.d.D(c)},ga.preinit=function(c,u){if(typeof c=="string"&&u&&typeof u.as=="string"){var h=u.as,f=l(h,u.crossOrigin),p=typeof u.integrity=="string"?u.integrity:void 0,x=typeof u.fetchPriority=="string"?u.fetchPriority:void 0;h==="style"?s.d.S(c,typeof u.precedence=="string"?u.precedence:void 0,{crossOrigin:f,integrity:p,fetchPriority:x}):h==="script"&&s.d.X(c,{crossOrigin:f,integrity:p,fetchPriority:x,nonce:typeof u.nonce=="string"?u.nonce:void 0})}},ga.preinitModule=function(c,u){if(typeof c=="string")if(typeof u=="object"&&u!==null){if(u.as==null||u.as==="script"){var h=l(u.as,u.crossOrigin);s.d.M(c,{crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0})}}else u==null&&s.d.M(c)},ga.preload=function(c,u){if(typeof c=="string"&&typeof u=="object"&&u!==null&&typeof u.as=="string"){var h=u.as,f=l(h,u.crossOrigin);s.d.L(c,h,{crossOrigin:f,integrity:typeof u.integrity=="string"?u.integrity:void 0,nonce:typeof u.nonce=="string"?u.nonce:void 0,type:typeof u.type=="string"?u.type:void 0,fetchPriority:typeof u.fetchPriority=="string"?u.fetchPriority:void 0,referrerPolicy:typeof u.referrerPolicy=="string"?u.referrerPolicy:void 0,imageSrcSet:typeof u.imageSrcSet=="string"?u.imageSrcSet:void 0,imageSizes:typeof u.imageSizes=="string"?u.imageSizes:void 0,media:typeof u.media=="string"?u.media:void 0})}},ga.preloadModule=function(c,u){if(typeof c=="string")if(u){var h=l(u.as,u.crossOrigin);s.d.m(c,{as:typeof u.as=="string"&&u.as!=="script"?u.as:void 0,crossOrigin:h,integrity:typeof u.integrity=="string"?u.integrity:void 0})}else s.d.m(c)},ga.requestFormReset=function(c){s.d.r(c)},ga.unstable_batchedUpdates=function(c,u){return c(u)},ga.useFormState=function(c,u,h){return i.H.useFormState(c,u,h)},ga.useFormStatus=function(){return i.H.useHostTransitionStatus()},ga.version="19.2.0",ga}var $P;function l7(){if($P)return LC.exports;$P=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),LC.exports=Qee(),LC.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IP;function Zee(){if(IP)return Z0;IP=1;var t=Yee(),e=Tf(),n=l7();function s(d){var m="https://react.dev/errors/"+d;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)m+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+d+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function a(d){var m=d,g=d;if(d.alternate)for(;m.return;)m=m.return;else{d=m;do m=d,(m.flags&4098)!==0&&(g=m.return),d=m.return;while(d)}return m.tag===3?g:null}function i(d){if(d.tag===13){var m=d.memoizedState;if(m===null&&(d=d.alternate,d!==null&&(m=d.memoizedState)),m!==null)return m.dehydrated}return null}function l(d){if(d.tag===31){var m=d.memoizedState;if(m===null&&(d=d.alternate,d!==null&&(m=d.memoizedState)),m!==null)return m.dehydrated}return null}function c(d){if(a(d)!==d)throw Error(s(188))}function u(d){var m=d.alternate;if(!m){if(m=a(d),m===null)throw Error(s(188));return m!==d?null:d}for(var g=d,w=m;;){var C=g.return;if(C===null)break;var _=C.alternate;if(_===null){if(w=C.return,w!==null){g=w;continue}break}if(C.child===_.child){for(_=C.child;_;){if(_===g)return c(C),d;if(_===w)return c(C),m;_=_.sibling}throw Error(s(188))}if(g.return!==w.return)g=C,w=_;else{for(var G=!1,ne=C.child;ne;){if(ne===g){G=!0,g=C,w=_;break}if(ne===w){G=!0,w=C,g=_;break}ne=ne.sibling}if(!G){for(ne=_.child;ne;){if(ne===g){G=!0,g=_,w=C;break}if(ne===w){G=!0,w=_,g=C;break}ne=ne.sibling}if(!G)throw Error(s(189))}}if(g.alternate!==w)throw Error(s(190))}if(g.tag!==3)throw Error(s(188));return g.stateNode.current===g?d:m}function h(d){var m=d.tag;if(m===5||m===26||m===27||m===6)return d;for(d=d.child;d!==null;){if(m=h(d),m!==null)return m;d=d.sibling}return null}var f=Object.assign,p=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),y=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),N=Symbol.for("react.profiler"),S=Symbol.for("react.consumer"),k=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),E=Symbol.for("react.suspense"),D=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),P=Symbol.for("react.activity"),$=Symbol.for("react.memo_cache_sentinel"),R=Symbol.iterator;function F(d){return d===null||typeof d!="object"?null:(d=R&&d[R]||d["@@iterator"],typeof d=="function"?d:null)}var W=Symbol.for("react.client.reference");function q(d){if(d==null)return null;if(typeof d=="function")return d.$$typeof===W?null:d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case v:return"Fragment";case N:return"Profiler";case b:return"StrictMode";case E:return"Suspense";case D:return"SuspenseList";case P:return"Activity"}if(typeof d=="object")switch(d.$$typeof){case y:return"Portal";case k:return d.displayName||"Context";case S:return(d._context.displayName||"Context")+".Consumer";case T:var m=d.render;return d=d.displayName,d||(d=m.displayName||m.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case A:return m=d.displayName||null,m!==null?m:q(d.type)||"Memo";case I:m=d._payload,d=d._init;try{return q(d(m))}catch{}}return null}var X=Array.isArray,z=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,K=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,H={pending:!1,data:null,method:null,action:null},Y=[],B=-1;function O(d){return{current:d}}function U(d){0>B||(d.current=Y[B],Y[B]=null,B--)}function J(d,m){B++,Y[B]=d.current,d.current=m}var se=O(null),ae=O(null),fe=O(null),ye=O(null);function Te(d,m){switch(J(fe,m),J(ae,d),J(se,null),m.nodeType){case 9:case 11:d=(d=m.documentElement)&&(d=d.namespaceURI)?q6(d):0;break;default:if(d=m.tagName,m=m.namespaceURI)m=q6(m),d=K6(m,d);else switch(d){case"svg":d=1;break;case"math":d=2;break;default:d=0}}U(se),J(se,d)}function oe(){U(se),U(ae),U(fe)}function Se(d){d.memoizedState!==null&&J(ye,d);var m=se.current,g=K6(m,d.type);m!==g&&(J(ae,d),J(se,g))}function ke(d){ae.current===d&&(U(se),U(ae)),ye.current===d&&(U(ye),q0._currentValue=H)}var me,re;function je(d){if(me===void 0)try{throw Error()}catch(g){var m=g.stack.trim().match(/\n( *(at )?)/);me=m&&m[1]||"",re=-1<g.stack.indexOf(`
    at`)?" (<anonymous>)":-1<g.stack.indexOf("@")?"@unknown:0:0":""}return`
`+me+d+re}var ie=!1;function Re(d,m){if(!d||ie)return"";ie=!0;var g=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var w={DetermineComponentFrameRoot:function(){try{if(m){var et=function(){throw Error()};if(Object.defineProperty(et.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(et,[])}catch(Ue){var Fe=Ue}Reflect.construct(d,[],et)}else{try{et.call()}catch(Ue){Fe=Ue}d.call(et.prototype)}}else{try{throw Error()}catch(Ue){Fe=Ue}(et=d())&&typeof et.catch=="function"&&et.catch(function(){})}}catch(Ue){if(Ue&&Fe&&typeof Ue.stack=="string")return[Ue.stack,Fe.stack]}return[null,null]}};w.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var C=Object.getOwnPropertyDescriptor(w.DetermineComponentFrameRoot,"name");C&&C.configurable&&Object.defineProperty(w.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var _=w.DetermineComponentFrameRoot(),G=_[0],ne=_[1];if(G&&ne){var pe=G.split(`
`),Me=ne.split(`
`);for(C=w=0;w<pe.length&&!pe[w].includes("DetermineComponentFrameRoot");)w++;for(;C<Me.length&&!Me[C].includes("DetermineComponentFrameRoot");)C++;if(w===pe.length||C===Me.length)for(w=pe.length-1,C=Me.length-1;1<=w&&0<=C&&pe[w]!==Me[C];)C--;for(;1<=w&&0<=C;w--,C--)if(pe[w]!==Me[C]){if(w!==1||C!==1)do if(w--,C--,0>C||pe[w]!==Me[C]){var Xe=`
`+pe[w].replace(" at new "," at ");return d.displayName&&Xe.includes("<anonymous>")&&(Xe=Xe.replace("<anonymous>",d.displayName)),Xe}while(1<=w&&0<=C);break}}}finally{ie=!1,Error.prepareStackTrace=g}return(g=d?d.displayName||d.name:"")?je(g):""}function Ve(d,m){switch(d.tag){case 26:case 27:case 5:return je(d.type);case 16:return je("Lazy");case 13:return d.child!==m&&m!==null?je("Suspense Fallback"):je("Suspense");case 19:return je("SuspenseList");case 0:case 15:return Re(d.type,!1);case 11:return Re(d.type.render,!1);case 1:return Re(d.type,!0);case 31:return je("Activity");default:return""}}function Ze(d){try{var m="",g=null;do m+=Ve(d,g),g=d,d=d.return;while(d);return m}catch(w){return`
Error generating stack: `+w.message+`
`+w.stack}}var bt=Object.prototype.hasOwnProperty,tt=t.unstable_scheduleCallback,St=t.unstable_cancelCallback,mt=t.unstable_shouldYield,jt=t.unstable_requestPaint,Oe=t.unstable_now,ht=t.unstable_getCurrentPriorityLevel,ut=t.unstable_ImmediatePriority,Q=t.unstable_UserBlockingPriority,L=t.unstable_NormalPriority,M=t.unstable_LowPriority,ee=t.unstable_IdlePriority,ce=t.log,Ce=t.unstable_setDisableYieldValue,De=null,xt=null;function Ie(d){if(typeof ce=="function"&&Ce(d),xt&&typeof xt.setStrictMode=="function")try{xt.setStrictMode(De,d)}catch{}}var lt=Math.clz32?Math.clz32:In,Nt=Math.log,kt=Math.LN2;function In(d){return d>>>=0,d===0?32:31-(Nt(d)/kt|0)|0}var vs=256,ns=262144,qn=4194304;function Ds(d){var m=d&42;if(m!==0)return m;switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return d&261888;case 262144:case 524288:case 1048576:case 2097152:return d&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return d&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return d}}function Ks(d,m,g){var w=d.pendingLanes;if(w===0)return 0;var C=0,_=d.suspendedLanes,G=d.pingedLanes;d=d.warmLanes;var ne=w&134217727;return ne!==0?(w=ne&~_,w!==0?C=Ds(w):(G&=ne,G!==0?C=Ds(G):g||(g=ne&~d,g!==0&&(C=Ds(g))))):(ne=w&~_,ne!==0?C=Ds(ne):G!==0?C=Ds(G):g||(g=w&~d,g!==0&&(C=Ds(g)))),C===0?0:m!==0&&m!==C&&(m&_)===0&&(_=C&-C,g=m&-m,_>=g||_===32&&(g&4194048)!==0)?m:C}function ro(d,m){return(d.pendingLanes&~(d.suspendedLanes&~d.pingedLanes)&m)===0}function Xa(d,m){switch(d){case 1:case 2:case 4:case 8:case 64:return m+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Aa(){var d=qn;return qn<<=1,(qn&62914560)===0&&(qn=4194304),d}function vr(d){for(var m=[],g=0;31>g;g++)m.push(d);return m}function na(d,m){d.pendingLanes|=m,m!==268435456&&(d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0)}function Pr(d,m,g,w,C,_){var G=d.pendingLanes;d.pendingLanes=g,d.suspendedLanes=0,d.pingedLanes=0,d.warmLanes=0,d.expiredLanes&=g,d.entangledLanes&=g,d.errorRecoveryDisabledLanes&=g,d.shellSuspendCounter=0;var ne=d.entanglements,pe=d.expirationTimes,Me=d.hiddenUpdates;for(g=G&~g;0<g;){var Xe=31-lt(g),et=1<<Xe;ne[Xe]=0,pe[Xe]=-1;var Fe=Me[Xe];if(Fe!==null)for(Me[Xe]=null,Xe=0;Xe<Fe.length;Xe++){var Ue=Fe[Xe];Ue!==null&&(Ue.lane&=-536870913)}g&=~et}w!==0&&Fo(d,w,0),_!==0&&C===0&&d.tag!==0&&(d.suspendedLanes|=_&~(G&~m))}function Fo(d,m,g){d.pendingLanes|=m,d.suspendedLanes&=~m;var w=31-lt(m);d.entangledLanes|=m,d.entanglements[w]=d.entanglements[w]|1073741824|g&261930}function Kl(d,m){var g=d.entangledLanes|=m;for(d=d.entanglements;g;){var w=31-lt(g),C=1<<w;C&m|d[w]&m&&(d[w]|=m),g&=~C}}function Ya(d,m){var g=m&-m;return g=(g&42)!==0?1:Si(g),(g&(d.suspendedLanes|m))!==0?0:g}function Si(d){switch(d){case 2:d=1;break;case 8:d=4;break;case 32:d=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:d=128;break;case 268435456:d=134217728;break;default:d=0}return d}function Qa(d){return d&=-d,2<d?8<d?(d&134217727)!==0?32:268435456:8:2}function ji(){var d=K.p;return d!==0?d:(d=window.event,d===void 0?32:xP(d.type))}function zo(d,m){var g=K.p;try{return K.p=d,m()}finally{K.p=g}}var wr=Math.random().toString(36).slice(2),us="__reactFiber$"+wr,Ps="__reactProps$"+wr,$a="__reactContainer$"+wr,Lr="__reactEvents$"+wr,ao="__reactListeners$"+wr,ue="__reactHandles$"+wr,He="__reactResources$"+wr,ot="__reactMarker$"+wr;function st(d){delete d[us],delete d[Ps],delete d[Lr],delete d[ao],delete d[ue]}function _t(d){var m=d[us];if(m)return m;for(var g=d.parentNode;g;){if(m=g[$a]||g[us]){if(g=m.alternate,m.child!==null||g!==null&&g.child!==null)for(d=tP(d);d!==null;){if(g=d[us])return g;d=tP(d)}return m}d=g,g=d.parentNode}return null}function Qt(d){if(d=d[us]||d[$a]){var m=d.tag;if(m===5||m===6||m===13||m===31||m===26||m===27||m===3)return d}return null}function ds(d){var m=d.tag;if(m===5||m===26||m===27||m===6)return d.stateNode;throw Error(s(33))}function Nr(d){var m=d[He];return m||(m=d[He]={hoistableStyles:new Map,hoistableScripts:new Map}),m}function Xt(d){d[ot]=!0}var Vn=new Set,ki={};function xe(d,m){Ke(d,m),Ke(d+"Capture",m)}function Ke(d,m){for(ki[d]=m,d=0;d<m.length;d++)Vn.add(m[d])}var Ge=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),rt={},ct={};function Ye(d){return bt.call(ct,d)?!0:bt.call(rt,d)?!1:Ge.test(d)?ct[d]=!0:(rt[d]=!0,!1)}function yt(d,m,g){if(Ye(m))if(g===null)d.removeAttribute(m);else{switch(typeof g){case"undefined":case"function":case"symbol":d.removeAttribute(m);return;case"boolean":var w=m.toLowerCase().slice(0,5);if(w!=="data-"&&w!=="aria-"){d.removeAttribute(m);return}}d.setAttribute(m,""+g)}}function dt(d,m,g){if(g===null)d.removeAttribute(m);else{switch(typeof g){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(m);return}d.setAttribute(m,""+g)}}function Dt(d,m,g,w){if(w===null)d.removeAttribute(g);else{switch(typeof w){case"undefined":case"function":case"symbol":case"boolean":d.removeAttribute(g);return}d.setAttributeNS(m,g,""+w)}}function Et(d){switch(typeof d){case"bigint":case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function Pt(d){var m=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(m==="checkbox"||m==="radio")}function Wt(d,m,g){var w=Object.getOwnPropertyDescriptor(d.constructor.prototype,m);if(!d.hasOwnProperty(m)&&typeof w<"u"&&typeof w.get=="function"&&typeof w.set=="function"){var C=w.get,_=w.set;return Object.defineProperty(d,m,{configurable:!0,get:function(){return C.call(this)},set:function(G){g=""+G,_.call(this,G)}}),Object.defineProperty(d,m,{enumerable:w.enumerable}),{getValue:function(){return g},setValue:function(G){g=""+G},stopTracking:function(){d._valueTracker=null,delete d[m]}}}}function un(d){if(!d._valueTracker){var m=Pt(d)?"checked":"value";d._valueTracker=Wt(d,m,""+d[m])}}function Pn(d){if(!d)return!1;var m=d._valueTracker;if(!m)return!0;var g=m.getValue(),w="";return d&&(w=Pt(d)?d.checked?"true":"false":d.value),d=w,d!==g?(m.setValue(d),!0):!1}function Ls(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}var Kn=/[\n"\\]/g;function Ln(d){return d.replace(Kn,function(m){return"\\"+m.charCodeAt(0).toString(16)+" "})}function pa(d,m,g,w,C,_,G,ne){d.name="",G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"?d.type=G:d.removeAttribute("type"),m!=null?G==="number"?(m===0&&d.value===""||d.value!=m)&&(d.value=""+Et(m)):d.value!==""+Et(m)&&(d.value=""+Et(m)):G!=="submit"&&G!=="reset"||d.removeAttribute("value"),m!=null?Uo(d,G,Et(m)):g!=null?Uo(d,G,Et(g)):w!=null&&d.removeAttribute("value"),C==null&&_!=null&&(d.defaultChecked=!!_),C!=null&&(d.checked=C&&typeof C!="function"&&typeof C!="symbol"),ne!=null&&typeof ne!="function"&&typeof ne!="symbol"&&typeof ne!="boolean"?d.name=""+Et(ne):d.removeAttribute("name")}function Bo(d,m,g,w,C,_,G,ne){if(_!=null&&typeof _!="function"&&typeof _!="symbol"&&typeof _!="boolean"&&(d.type=_),m!=null||g!=null){if(!(_!=="submit"&&_!=="reset"||m!=null)){un(d);return}g=g!=null?""+Et(g):"",m=m!=null?""+Et(m):g,ne||m===d.value||(d.value=m),d.defaultValue=m}w=w??C,w=typeof w!="function"&&typeof w!="symbol"&&!!w,d.checked=ne?d.checked:!!w,d.defaultChecked=!!w,G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"&&(d.name=G),un(d)}function Uo(d,m,g){m==="number"&&Ls(d.ownerDocument)===d||d.defaultValue===""+g||(d.defaultValue=""+g)}function sa(d,m,g,w){if(d=d.options,m){m={};for(var C=0;C<g.length;C++)m["$"+g[C]]=!0;for(g=0;g<d.length;g++)C=m.hasOwnProperty("$"+d[g].value),d[g].selected!==C&&(d[g].selected=C),C&&w&&(d[g].defaultSelected=!0)}else{for(g=""+Et(g),m=null,C=0;C<d.length;C++){if(d[C].value===g){d[C].selected=!0,w&&(d[C].defaultSelected=!0);return}m!==null||d[C].disabled||(m=d[C])}m!==null&&(m.selected=!0)}}function Xl(d,m,g){if(m!=null&&(m=""+Et(m),m!==d.value&&(d.value=m),g==null)){d.defaultValue!==m&&(d.defaultValue=m);return}d.defaultValue=g!=null?""+Et(g):""}function rm(d,m,g,w){if(m==null){if(w!=null){if(g!=null)throw Error(s(92));if(X(w)){if(1<w.length)throw Error(s(93));w=w[0]}g=w}g==null&&(g=""),m=g}g=Et(m),d.defaultValue=g,w=d.textContent,w===g&&w!==""&&w!==null&&(d.value=w),un(d)}function ru(d,m){if(m){var g=d.firstChild;if(g&&g===d.lastChild&&g.nodeType===3){g.nodeValue=m;return}}d.textContent=m}var o0=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function l0(d,m,g){var w=m.indexOf("--")===0;g==null||typeof g=="boolean"||g===""?w?d.setProperty(m,""):m==="float"?d.cssFloat="":d[m]="":w?d.setProperty(m,g):typeof g!="number"||g===0||o0.has(m)?m==="float"?d.cssFloat=g:d[m]=(""+g).trim():d[m]=g+"px"}function Ib(d,m,g){if(m!=null&&typeof m!="object")throw Error(s(62));if(d=d.style,g!=null){for(var w in g)!g.hasOwnProperty(w)||m!=null&&m.hasOwnProperty(w)||(w.indexOf("--")===0?d.setProperty(w,""):w==="float"?d.cssFloat="":d[w]="");for(var C in m)w=m[C],m.hasOwnProperty(C)&&g[C]!==w&&l0(d,C,w)}else for(var _ in m)m.hasOwnProperty(_)&&l0(d,_,m[_])}function c0(d){if(d.indexOf("-")===-1)return!1;switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Rb=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Ob=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function am(d){return Ob.test(""+d)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":d}function Ci(){}var io=null;function u0(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var Yl=null,le=null;function _e(d){var m=Qt(d);if(m&&(d=m.stateNode)){var g=d[Ps]||null;e:switch(d=m.stateNode,m.type){case"input":if(pa(d,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name),m=g.name,g.type==="radio"&&m!=null){for(g=d;g.parentNode;)g=g.parentNode;for(g=g.querySelectorAll('input[name="'+Ln(""+m)+'"][type="radio"]'),m=0;m<g.length;m++){var w=g[m];if(w!==d&&w.form===d.form){var C=w[Ps]||null;if(!C)throw Error(s(90));pa(w,C.value,C.defaultValue,C.defaultValue,C.checked,C.defaultChecked,C.type,C.name)}}for(m=0;m<g.length;m++)w=g[m],w.form===d.form&&Pn(w)}break e;case"textarea":Xl(d,g.value,g.defaultValue);break e;case"select":m=g.value,m!=null&&sa(d,!!g.multiple,m,!1)}}}var Pe=!1;function Je(d,m,g){if(Pe)return d(m,g);Pe=!0;try{var w=d(m);return w}finally{if(Pe=!1,(Yl!==null||le!==null)&&(vv(),Yl&&(m=Yl,d=le,le=Yl=null,_e(m),d)))for(m=0;m<d.length;m++)_e(d[m])}}function pt(d,m){var g=d.stateNode;if(g===null)return null;var w=g[Ps]||null;if(w===null)return null;g=w[m];e:switch(m){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(w=!w.disabled)||(d=d.type,w=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!w;break e;default:d=!1}if(d)return null;if(g&&typeof g!="function")throw Error(s(231,m,typeof g));return g}var Ct=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),At=!1;if(Ct)try{var dn={};Object.defineProperty(dn,"passive",{get:function(){At=!0}}),window.addEventListener("test",dn,dn),window.removeEventListener("test",dn,dn)}catch{At=!1}var gn=null,jn=null,yn=null;function Wn(){if(yn)return yn;var d,m=jn,g=m.length,w,C="value"in gn?gn.value:gn.textContent,_=C.length;for(d=0;d<g&&m[d]===C[d];d++);var G=g-d;for(w=1;w<=G&&m[g-w]===C[_-w];w++);return yn=C.slice(d,1<w?1-w:void 0)}function ws(d){var m=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&m===13&&(d=13)):d=m,d===10&&(d=13),32<=d||d===13?d:0}function An(){return!0}function Fs(){return!1}function ss(d){function m(g,w,C,_,G){this._reactName=g,this._targetInst=C,this.type=w,this.nativeEvent=_,this.target=G,this.currentTarget=null;for(var ne in d)d.hasOwnProperty(ne)&&(g=d[ne],this[ne]=g?g(_):_[ne]);return this.isDefaultPrevented=(_.defaultPrevented!=null?_.defaultPrevented:_.returnValue===!1)?An:Fs,this.isPropagationStopped=Fs,this}return f(m.prototype,{preventDefault:function(){this.defaultPrevented=!0;var g=this.nativeEvent;g&&(g.preventDefault?g.preventDefault():typeof g.returnValue!="unknown"&&(g.returnValue=!1),this.isDefaultPrevented=An)},stopPropagation:function(){var g=this.nativeEvent;g&&(g.stopPropagation?g.stopPropagation():typeof g.cancelBubble!="unknown"&&(g.cancelBubble=!0),this.isPropagationStopped=An)},persist:function(){},isPersistent:An}),m}var Xs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},oo=ss(Xs),ra=f({},Xs,{view:0,detail:0}),ar=ss(ra),lo,co,Ia,bl=f({},ra,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Vt,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==Ia&&(Ia&&d.type==="mousemove"?(lo=d.screenX-Ia.screenX,co=d.screenY-Ia.screenY):co=lo=0,Ia=d),lo)},movementY:function(d){return"movementY"in d?d.movementY:co}}),im=ss(bl),au=f({},bl,{dataTransfer:0}),Db=ss(au),Pb=f({},ra,{relatedTarget:0}),om=ss(Pb),hs=f({},Xs,{animationName:0,elapsedTime:0,pseudoElement:0}),Za=ss(hs),Vo=f({},Xs,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),d0=ss(Vo),h0=f({},Xs,{data:0}),Wo=ss(h0),Lb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Mb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},m0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pj(d){var m=this.nativeEvent;return m.getModifierState?m.getModifierState(d):(d=m0[d])?!!m[d]:!1}function Vt(){return Pj}var Ql=f({},ra,{key:function(d){if(d.key){var m=Lb[d.key]||d.key;if(m!=="Unidentified")return m}return d.type==="keypress"?(d=ws(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?Mb[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Vt,charCode:function(d){return d.type==="keypress"?ws(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?ws(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),ir=ss(Ql),lm=f({},bl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ZR=ss(lm),nJ=f({},ra,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Vt}),sJ=ss(nJ),rJ=f({},Xs,{propertyName:0,elapsedTime:0,pseudoElement:0}),aJ=ss(rJ),iJ=f({},bl,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),oJ=ss(iJ),lJ=f({},Xs,{newState:0,oldState:0}),cJ=ss(lJ),uJ=[9,13,27,32],Lj=Ct&&"CompositionEvent"in window,f0=null;Ct&&"documentMode"in document&&(f0=document.documentMode);var dJ=Ct&&"TextEvent"in window&&!f0,JR=Ct&&(!Lj||f0&&8<f0&&11>=f0),eO=" ",tO=!1;function nO(d,m){switch(d){case"keyup":return uJ.indexOf(m.keyCode)!==-1;case"keydown":return m.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sO(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var cm=!1;function hJ(d,m){switch(d){case"compositionend":return sO(m);case"keypress":return m.which!==32?null:(tO=!0,eO);case"textInput":return d=m.data,d===eO&&tO?null:d;default:return null}}function mJ(d,m){if(cm)return d==="compositionend"||!Lj&&nO(d,m)?(d=Wn(),yn=jn=gn=null,cm=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(m.ctrlKey||m.altKey||m.metaKey)||m.ctrlKey&&m.altKey){if(m.char&&1<m.char.length)return m.char;if(m.which)return String.fromCharCode(m.which)}return null;case"compositionend":return JR&&m.locale!=="ko"?null:m.data;default:return null}}var fJ={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function rO(d){var m=d&&d.nodeName&&d.nodeName.toLowerCase();return m==="input"?!!fJ[d.type]:m==="textarea"}function aO(d,m,g,w){Yl?le?le.push(w):le=[w]:Yl=w,m=Tv(m,"onChange"),0<m.length&&(g=new oo("onChange","change",null,g,w),d.push({event:g,listeners:m}))}var p0=null,g0=null;function pJ(d){B6(d,0)}function Fb(d){var m=ds(d);if(Pn(m))return d}function iO(d,m){if(d==="change")return m}var oO=!1;if(Ct){var Mj;if(Ct){var Fj="oninput"in document;if(!Fj){var lO=document.createElement("div");lO.setAttribute("oninput","return;"),Fj=typeof lO.oninput=="function"}Mj=Fj}else Mj=!1;oO=Mj&&(!document.documentMode||9<document.documentMode)}function cO(){p0&&(p0.detachEvent("onpropertychange",uO),g0=p0=null)}function uO(d){if(d.propertyName==="value"&&Fb(g0)){var m=[];aO(m,g0,d,u0(d)),Je(pJ,m)}}function gJ(d,m,g){d==="focusin"?(cO(),p0=m,g0=g,p0.attachEvent("onpropertychange",uO)):d==="focusout"&&cO()}function xJ(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return Fb(g0)}function yJ(d,m){if(d==="click")return Fb(m)}function bJ(d,m){if(d==="input"||d==="change")return Fb(m)}function vJ(d,m){return d===m&&(d!==0||1/d===1/m)||d!==d&&m!==m}var Ti=typeof Object.is=="function"?Object.is:vJ;function x0(d,m){if(Ti(d,m))return!0;if(typeof d!="object"||d===null||typeof m!="object"||m===null)return!1;var g=Object.keys(d),w=Object.keys(m);if(g.length!==w.length)return!1;for(w=0;w<g.length;w++){var C=g[w];if(!bt.call(m,C)||!Ti(d[C],m[C]))return!1}return!0}function dO(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function hO(d,m){var g=dO(d);d=0;for(var w;g;){if(g.nodeType===3){if(w=d+g.textContent.length,d<=m&&w>=m)return{node:g,offset:m-d};d=w}e:{for(;g;){if(g.nextSibling){g=g.nextSibling;break e}g=g.parentNode}g=void 0}g=dO(g)}}function mO(d,m){return d&&m?d===m?!0:d&&d.nodeType===3?!1:m&&m.nodeType===3?mO(d,m.parentNode):"contains"in d?d.contains(m):d.compareDocumentPosition?!!(d.compareDocumentPosition(m)&16):!1:!1}function fO(d){d=d!=null&&d.ownerDocument!=null&&d.ownerDocument.defaultView!=null?d.ownerDocument.defaultView:window;for(var m=Ls(d.document);m instanceof d.HTMLIFrameElement;){try{var g=typeof m.contentWindow.location.href=="string"}catch{g=!1}if(g)d=m.contentWindow;else break;m=Ls(d.document)}return m}function zj(d){var m=d&&d.nodeName&&d.nodeName.toLowerCase();return m&&(m==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||m==="textarea"||d.contentEditable==="true")}var wJ=Ct&&"documentMode"in document&&11>=document.documentMode,um=null,Bj=null,y0=null,Uj=!1;function pO(d,m,g){var w=g.window===g?g.document:g.nodeType===9?g:g.ownerDocument;Uj||um==null||um!==Ls(w)||(w=um,"selectionStart"in w&&zj(w)?w={start:w.selectionStart,end:w.selectionEnd}:(w=(w.ownerDocument&&w.ownerDocument.defaultView||window).getSelection(),w={anchorNode:w.anchorNode,anchorOffset:w.anchorOffset,focusNode:w.focusNode,focusOffset:w.focusOffset}),y0&&x0(y0,w)||(y0=w,w=Tv(Bj,"onSelect"),0<w.length&&(m=new oo("onSelect","select",null,m,g),d.push({event:m,listeners:w}),m.target=um)))}function yd(d,m){var g={};return g[d.toLowerCase()]=m.toLowerCase(),g["Webkit"+d]="webkit"+m,g["Moz"+d]="moz"+m,g}var dm={animationend:yd("Animation","AnimationEnd"),animationiteration:yd("Animation","AnimationIteration"),animationstart:yd("Animation","AnimationStart"),transitionrun:yd("Transition","TransitionRun"),transitionstart:yd("Transition","TransitionStart"),transitioncancel:yd("Transition","TransitionCancel"),transitionend:yd("Transition","TransitionEnd")},Vj={},gO={};Ct&&(gO=document.createElement("div").style,"AnimationEvent"in window||(delete dm.animationend.animation,delete dm.animationiteration.animation,delete dm.animationstart.animation),"TransitionEvent"in window||delete dm.transitionend.transition);function bd(d){if(Vj[d])return Vj[d];if(!dm[d])return d;var m=dm[d],g;for(g in m)if(m.hasOwnProperty(g)&&g in gO)return Vj[d]=m[g];return d}var xO=bd("animationend"),yO=bd("animationiteration"),bO=bd("animationstart"),NJ=bd("transitionrun"),SJ=bd("transitionstart"),jJ=bd("transitioncancel"),vO=bd("transitionend"),wO=new Map,Wj="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Wj.push("scrollEnd");function Ho(d,m){wO.set(d,m),xe(m,[d])}var zb=typeof reportError=="function"?reportError:function(d){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var m=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof d=="object"&&d!==null&&typeof d.message=="string"?String(d.message):String(d),error:d});if(!window.dispatchEvent(m))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",d);return}console.error(d)},uo=[],hm=0,Hj=0;function Bb(){for(var d=hm,m=Hj=hm=0;m<d;){var g=uo[m];uo[m++]=null;var w=uo[m];uo[m++]=null;var C=uo[m];uo[m++]=null;var _=uo[m];if(uo[m++]=null,w!==null&&C!==null){var G=w.pending;G===null?C.next=C:(C.next=G.next,G.next=C),w.pending=C}_!==0&&NO(g,C,_)}}function Ub(d,m,g,w){uo[hm++]=d,uo[hm++]=m,uo[hm++]=g,uo[hm++]=w,Hj|=w,d.lanes|=w,d=d.alternate,d!==null&&(d.lanes|=w)}function Gj(d,m,g,w){return Ub(d,m,g,w),Vb(d)}function vd(d,m){return Ub(d,null,null,m),Vb(d)}function NO(d,m,g){d.lanes|=g;var w=d.alternate;w!==null&&(w.lanes|=g);for(var C=!1,_=d.return;_!==null;)_.childLanes|=g,w=_.alternate,w!==null&&(w.childLanes|=g),_.tag===22&&(d=_.stateNode,d===null||d._visibility&1||(C=!0)),d=_,_=_.return;return d.tag===3?(_=d.stateNode,C&&m!==null&&(C=31-lt(g),d=_.hiddenUpdates,w=d[C],w===null?d[C]=[m]:w.push(m),m.lane=g|536870912),_):null}function Vb(d){if(50<z0)throw z0=0,tC=null,Error(s(185));for(var m=d.return;m!==null;)d=m,m=d.return;return d.tag===3?d.stateNode:null}var mm={};function kJ(d,m,g,w){this.tag=d,this.key=g,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=m,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=w,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _i(d,m,g,w){return new kJ(d,m,g,w)}function qj(d){return d=d.prototype,!(!d||!d.isReactComponent)}function Zl(d,m){var g=d.alternate;return g===null?(g=_i(d.tag,m,d.key,d.mode),g.elementType=d.elementType,g.type=d.type,g.stateNode=d.stateNode,g.alternate=d,d.alternate=g):(g.pendingProps=m,g.type=d.type,g.flags=0,g.subtreeFlags=0,g.deletions=null),g.flags=d.flags&65011712,g.childLanes=d.childLanes,g.lanes=d.lanes,g.child=d.child,g.memoizedProps=d.memoizedProps,g.memoizedState=d.memoizedState,g.updateQueue=d.updateQueue,m=d.dependencies,g.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext},g.sibling=d.sibling,g.index=d.index,g.ref=d.ref,g.refCleanup=d.refCleanup,g}function SO(d,m){d.flags&=65011714;var g=d.alternate;return g===null?(d.childLanes=0,d.lanes=m,d.child=null,d.subtreeFlags=0,d.memoizedProps=null,d.memoizedState=null,d.updateQueue=null,d.dependencies=null,d.stateNode=null):(d.childLanes=g.childLanes,d.lanes=g.lanes,d.child=g.child,d.subtreeFlags=0,d.deletions=null,d.memoizedProps=g.memoizedProps,d.memoizedState=g.memoizedState,d.updateQueue=g.updateQueue,d.type=g.type,m=g.dependencies,d.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext}),d}function Wb(d,m,g,w,C,_){var G=0;if(w=d,typeof d=="function")qj(d)&&(G=1);else if(typeof d=="string")G=Aee(d,g,se.current)?26:d==="html"||d==="head"||d==="body"?27:5;else e:switch(d){case P:return d=_i(31,g,m,C),d.elementType=P,d.lanes=_,d;case v:return wd(g.children,C,_,m);case b:G=8,C|=24;break;case N:return d=_i(12,g,m,C|2),d.elementType=N,d.lanes=_,d;case E:return d=_i(13,g,m,C),d.elementType=E,d.lanes=_,d;case D:return d=_i(19,g,m,C),d.elementType=D,d.lanes=_,d;default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case k:G=10;break e;case S:G=9;break e;case T:G=11;break e;case A:G=14;break e;case I:G=16,w=null;break e}G=29,g=Error(s(130,d===null?"null":typeof d,"")),w=null}return m=_i(G,g,m,C),m.elementType=d,m.type=w,m.lanes=_,m}function wd(d,m,g,w){return d=_i(7,d,w,m),d.lanes=g,d}function Kj(d,m,g){return d=_i(6,d,null,m),d.lanes=g,d}function jO(d){var m=_i(18,null,null,0);return m.stateNode=d,m}function Xj(d,m,g){return m=_i(4,d.children!==null?d.children:[],d.key,m),m.lanes=g,m.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},m}var kO=new WeakMap;function ho(d,m){if(typeof d=="object"&&d!==null){var g=kO.get(d);return g!==void 0?g:(m={value:d,source:m,stack:Ze(m)},kO.set(d,m),m)}return{value:d,source:m,stack:Ze(m)}}var fm=[],pm=0,Hb=null,b0=0,mo=[],fo=0,iu=null,vl=1,wl="";function Jl(d,m){fm[pm++]=b0,fm[pm++]=Hb,Hb=d,b0=m}function CO(d,m,g){mo[fo++]=vl,mo[fo++]=wl,mo[fo++]=iu,iu=d;var w=vl;d=wl;var C=32-lt(w)-1;w&=~(1<<C),g+=1;var _=32-lt(m)+C;if(30<_){var G=C-C%5;_=(w&(1<<G)-1).toString(32),w>>=G,C-=G,vl=1<<32-lt(m)+C|g<<C|w,wl=_+d}else vl=1<<_|g<<C|w,wl=d}function Yj(d){d.return!==null&&(Jl(d,1),CO(d,1,0))}function Qj(d){for(;d===Hb;)Hb=fm[--pm],fm[pm]=null,b0=fm[--pm],fm[pm]=null;for(;d===iu;)iu=mo[--fo],mo[fo]=null,wl=mo[--fo],mo[fo]=null,vl=mo[--fo],mo[fo]=null}function TO(d,m){mo[fo++]=vl,mo[fo++]=wl,mo[fo++]=iu,vl=m.id,wl=m.overflow,iu=d}var aa=null,Ns=null,_n=!1,ou=null,po=!1,Zj=Error(s(519));function lu(d){var m=Error(s(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw v0(ho(m,d)),Zj}function _O(d){var m=d.stateNode,g=d.type,w=d.memoizedProps;switch(m[us]=d,m[Ps]=w,g){case"dialog":wn("cancel",m),wn("close",m);break;case"iframe":case"object":case"embed":wn("load",m);break;case"video":case"audio":for(g=0;g<U0.length;g++)wn(U0[g],m);break;case"source":wn("error",m);break;case"img":case"image":case"link":wn("error",m),wn("load",m);break;case"details":wn("toggle",m);break;case"input":wn("invalid",m),Bo(m,w.value,w.defaultValue,w.checked,w.defaultChecked,w.type,w.name,!0);break;case"select":wn("invalid",m);break;case"textarea":wn("invalid",m),rm(m,w.value,w.defaultValue,w.children)}g=w.children,typeof g!="string"&&typeof g!="number"&&typeof g!="bigint"||m.textContent===""+g||w.suppressHydrationWarning===!0||H6(m.textContent,g)?(w.popover!=null&&(wn("beforetoggle",m),wn("toggle",m)),w.onScroll!=null&&wn("scroll",m),w.onScrollEnd!=null&&wn("scrollend",m),w.onClick!=null&&(m.onclick=Ci),m=!0):m=!1,m||lu(d,!0)}function EO(d){for(aa=d.return;aa;)switch(aa.tag){case 5:case 31:case 13:po=!1;return;case 27:case 3:po=!0;return;default:aa=aa.return}}function gm(d){if(d!==aa)return!1;if(!_n)return EO(d),_n=!0,!1;var m=d.tag,g;if((g=m!==3&&m!==27)&&((g=m===5)&&(g=d.type,g=!(g!=="form"&&g!=="button")||gC(d.type,d.memoizedProps)),g=!g),g&&Ns&&lu(d),EO(d),m===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(s(317));Ns=eP(d)}else if(m===31){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(s(317));Ns=eP(d)}else m===27?(m=Ns,Nu(d.type)?(d=wC,wC=null,Ns=d):Ns=m):Ns=aa?xo(d.stateNode.nextSibling):null;return!0}function Nd(){Ns=aa=null,_n=!1}function Jj(){var d=ou;return d!==null&&(ni===null?ni=d:ni.push.apply(ni,d),ou=null),d}function v0(d){ou===null?ou=[d]:ou.push(d)}var ek=O(null),Sd=null,ec=null;function cu(d,m,g){J(ek,m._currentValue),m._currentValue=g}function tc(d){d._currentValue=ek.current,U(ek)}function tk(d,m,g){for(;d!==null;){var w=d.alternate;if((d.childLanes&m)!==m?(d.childLanes|=m,w!==null&&(w.childLanes|=m)):w!==null&&(w.childLanes&m)!==m&&(w.childLanes|=m),d===g)break;d=d.return}}function nk(d,m,g,w){var C=d.child;for(C!==null&&(C.return=d);C!==null;){var _=C.dependencies;if(_!==null){var G=C.child;_=_.firstContext;e:for(;_!==null;){var ne=_;_=C;for(var pe=0;pe<m.length;pe++)if(ne.context===m[pe]){_.lanes|=g,ne=_.alternate,ne!==null&&(ne.lanes|=g),tk(_.return,g,d),w||(G=null);break e}_=ne.next}}else if(C.tag===18){if(G=C.return,G===null)throw Error(s(341));G.lanes|=g,_=G.alternate,_!==null&&(_.lanes|=g),tk(G,g,d),G=null}else G=C.child;if(G!==null)G.return=C;else for(G=C;G!==null;){if(G===d){G=null;break}if(C=G.sibling,C!==null){C.return=G.return,G=C;break}G=G.return}C=G}}function xm(d,m,g,w){d=null;for(var C=m,_=!1;C!==null;){if(!_){if((C.flags&524288)!==0)_=!0;else if((C.flags&262144)!==0)break}if(C.tag===10){var G=C.alternate;if(G===null)throw Error(s(387));if(G=G.memoizedProps,G!==null){var ne=C.type;Ti(C.pendingProps.value,G.value)||(d!==null?d.push(ne):d=[ne])}}else if(C===ye.current){if(G=C.alternate,G===null)throw Error(s(387));G.memoizedState.memoizedState!==C.memoizedState.memoizedState&&(d!==null?d.push(q0):d=[q0])}C=C.return}d!==null&&nk(m,d,g,w),m.flags|=262144}function Gb(d){for(d=d.firstContext;d!==null;){if(!Ti(d.context._currentValue,d.memoizedValue))return!0;d=d.next}return!1}function jd(d){Sd=d,ec=null,d=d.dependencies,d!==null&&(d.firstContext=null)}function ia(d){return AO(Sd,d)}function qb(d,m){return Sd===null&&jd(d),AO(d,m)}function AO(d,m){var g=m._currentValue;if(m={context:m,memoizedValue:g,next:null},ec===null){if(d===null)throw Error(s(308));ec=m,d.dependencies={lanes:0,firstContext:m},d.flags|=524288}else ec=ec.next=m;return g}var CJ=typeof AbortController<"u"?AbortController:function(){var d=[],m=this.signal={aborted:!1,addEventListener:function(g,w){d.push(w)}};this.abort=function(){m.aborted=!0,d.forEach(function(g){return g()})}},TJ=t.unstable_scheduleCallback,_J=t.unstable_NormalPriority,or={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function sk(){return{controller:new CJ,data:new Map,refCount:0}}function w0(d){d.refCount--,d.refCount===0&&TJ(_J,function(){d.controller.abort()})}var N0=null,rk=0,ym=0,bm=null;function EJ(d,m){if(N0===null){var g=N0=[];rk=0,ym=oC(),bm={status:"pending",value:void 0,then:function(w){g.push(w)}}}return rk++,m.then($O,$O),m}function $O(){if(--rk===0&&N0!==null){bm!==null&&(bm.status="fulfilled");var d=N0;N0=null,ym=0,bm=null;for(var m=0;m<d.length;m++)(0,d[m])()}}function AJ(d,m){var g=[],w={status:"pending",value:null,reason:null,then:function(C){g.push(C)}};return d.then(function(){w.status="fulfilled",w.value=m;for(var C=0;C<g.length;C++)(0,g[C])(m)},function(C){for(w.status="rejected",w.reason=C,C=0;C<g.length;C++)(0,g[C])(void 0)}),w}var IO=z.S;z.S=function(d,m){p6=Oe(),typeof m=="object"&&m!==null&&typeof m.then=="function"&&EJ(d,m),IO!==null&&IO(d,m)};var kd=O(null);function ak(){var d=kd.current;return d!==null?d:ms.pooledCache}function Kb(d,m){m===null?J(kd,kd.current):J(kd,m.pool)}function RO(){var d=ak();return d===null?null:{parent:or._currentValue,pool:d}}var vm=Error(s(460)),ik=Error(s(474)),Xb=Error(s(542)),Yb={then:function(){}};function OO(d){return d=d.status,d==="fulfilled"||d==="rejected"}function DO(d,m,g){switch(g=d[g],g===void 0?d.push(m):g!==m&&(m.then(Ci,Ci),m=g),m.status){case"fulfilled":return m.value;case"rejected":throw d=m.reason,LO(d),d;default:if(typeof m.status=="string")m.then(Ci,Ci);else{if(d=ms,d!==null&&100<d.shellSuspendCounter)throw Error(s(482));d=m,d.status="pending",d.then(function(w){if(m.status==="pending"){var C=m;C.status="fulfilled",C.value=w}},function(w){if(m.status==="pending"){var C=m;C.status="rejected",C.reason=w}})}switch(m.status){case"fulfilled":return m.value;case"rejected":throw d=m.reason,LO(d),d}throw Td=m,vm}}function Cd(d){try{var m=d._init;return m(d._payload)}catch(g){throw g!==null&&typeof g=="object"&&typeof g.then=="function"?(Td=g,vm):g}}var Td=null;function PO(){if(Td===null)throw Error(s(459));var d=Td;return Td=null,d}function LO(d){if(d===vm||d===Xb)throw Error(s(483))}var wm=null,S0=0;function Qb(d){var m=S0;return S0+=1,wm===null&&(wm=[]),DO(wm,d,m)}function j0(d,m){m=m.props.ref,d.ref=m!==void 0?m:null}function Zb(d,m){throw m.$$typeof===p?Error(s(525)):(d=Object.prototype.toString.call(m),Error(s(31,d==="[object Object]"?"object with keys {"+Object.keys(m).join(", ")+"}":d)))}function MO(d){function m(Ae,Ne){if(d){var Le=Ae.deletions;Le===null?(Ae.deletions=[Ne],Ae.flags|=16):Le.push(Ne)}}function g(Ae,Ne){if(!d)return null;for(;Ne!==null;)m(Ae,Ne),Ne=Ne.sibling;return null}function w(Ae){for(var Ne=new Map;Ae!==null;)Ae.key!==null?Ne.set(Ae.key,Ae):Ne.set(Ae.index,Ae),Ae=Ae.sibling;return Ne}function C(Ae,Ne){return Ae=Zl(Ae,Ne),Ae.index=0,Ae.sibling=null,Ae}function _(Ae,Ne,Le){return Ae.index=Le,d?(Le=Ae.alternate,Le!==null?(Le=Le.index,Le<Ne?(Ae.flags|=67108866,Ne):Le):(Ae.flags|=67108866,Ne)):(Ae.flags|=1048576,Ne)}function G(Ae){return d&&Ae.alternate===null&&(Ae.flags|=67108866),Ae}function ne(Ae,Ne,Le,Qe){return Ne===null||Ne.tag!==6?(Ne=Kj(Le,Ae.mode,Qe),Ne.return=Ae,Ne):(Ne=C(Ne,Le),Ne.return=Ae,Ne)}function pe(Ae,Ne,Le,Qe){var Ht=Le.type;return Ht===v?Xe(Ae,Ne,Le.props.children,Qe,Le.key):Ne!==null&&(Ne.elementType===Ht||typeof Ht=="object"&&Ht!==null&&Ht.$$typeof===I&&Cd(Ht)===Ne.type)?(Ne=C(Ne,Le.props),j0(Ne,Le),Ne.return=Ae,Ne):(Ne=Wb(Le.type,Le.key,Le.props,null,Ae.mode,Qe),j0(Ne,Le),Ne.return=Ae,Ne)}function Me(Ae,Ne,Le,Qe){return Ne===null||Ne.tag!==4||Ne.stateNode.containerInfo!==Le.containerInfo||Ne.stateNode.implementation!==Le.implementation?(Ne=Xj(Le,Ae.mode,Qe),Ne.return=Ae,Ne):(Ne=C(Ne,Le.children||[]),Ne.return=Ae,Ne)}function Xe(Ae,Ne,Le,Qe,Ht){return Ne===null||Ne.tag!==7?(Ne=wd(Le,Ae.mode,Qe,Ht),Ne.return=Ae,Ne):(Ne=C(Ne,Le),Ne.return=Ae,Ne)}function et(Ae,Ne,Le){if(typeof Ne=="string"&&Ne!==""||typeof Ne=="number"||typeof Ne=="bigint")return Ne=Kj(""+Ne,Ae.mode,Le),Ne.return=Ae,Ne;if(typeof Ne=="object"&&Ne!==null){switch(Ne.$$typeof){case x:return Le=Wb(Ne.type,Ne.key,Ne.props,null,Ae.mode,Le),j0(Le,Ne),Le.return=Ae,Le;case y:return Ne=Xj(Ne,Ae.mode,Le),Ne.return=Ae,Ne;case I:return Ne=Cd(Ne),et(Ae,Ne,Le)}if(X(Ne)||F(Ne))return Ne=wd(Ne,Ae.mode,Le,null),Ne.return=Ae,Ne;if(typeof Ne.then=="function")return et(Ae,Qb(Ne),Le);if(Ne.$$typeof===k)return et(Ae,qb(Ae,Ne),Le);Zb(Ae,Ne)}return null}function Fe(Ae,Ne,Le,Qe){var Ht=Ne!==null?Ne.key:null;if(typeof Le=="string"&&Le!==""||typeof Le=="number"||typeof Le=="bigint")return Ht!==null?null:ne(Ae,Ne,""+Le,Qe);if(typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case x:return Le.key===Ht?pe(Ae,Ne,Le,Qe):null;case y:return Le.key===Ht?Me(Ae,Ne,Le,Qe):null;case I:return Le=Cd(Le),Fe(Ae,Ne,Le,Qe)}if(X(Le)||F(Le))return Ht!==null?null:Xe(Ae,Ne,Le,Qe,null);if(typeof Le.then=="function")return Fe(Ae,Ne,Qb(Le),Qe);if(Le.$$typeof===k)return Fe(Ae,Ne,qb(Ae,Le),Qe);Zb(Ae,Le)}return null}function Ue(Ae,Ne,Le,Qe,Ht){if(typeof Qe=="string"&&Qe!==""||typeof Qe=="number"||typeof Qe=="bigint")return Ae=Ae.get(Le)||null,ne(Ne,Ae,""+Qe,Ht);if(typeof Qe=="object"&&Qe!==null){switch(Qe.$$typeof){case x:return Ae=Ae.get(Qe.key===null?Le:Qe.key)||null,pe(Ne,Ae,Qe,Ht);case y:return Ae=Ae.get(Qe.key===null?Le:Qe.key)||null,Me(Ne,Ae,Qe,Ht);case I:return Qe=Cd(Qe),Ue(Ae,Ne,Le,Qe,Ht)}if(X(Qe)||F(Qe))return Ae=Ae.get(Le)||null,Xe(Ne,Ae,Qe,Ht,null);if(typeof Qe.then=="function")return Ue(Ae,Ne,Le,Qb(Qe),Ht);if(Qe.$$typeof===k)return Ue(Ae,Ne,Le,qb(Ne,Qe),Ht);Zb(Ne,Qe)}return null}function Rt(Ae,Ne,Le,Qe){for(var Ht=null,Mn=null,zt=Ne,hn=Ne=0,Cn=null;zt!==null&&hn<Le.length;hn++){zt.index>hn?(Cn=zt,zt=null):Cn=zt.sibling;var Fn=Fe(Ae,zt,Le[hn],Qe);if(Fn===null){zt===null&&(zt=Cn);break}d&&zt&&Fn.alternate===null&&m(Ae,zt),Ne=_(Fn,Ne,hn),Mn===null?Ht=Fn:Mn.sibling=Fn,Mn=Fn,zt=Cn}if(hn===Le.length)return g(Ae,zt),_n&&Jl(Ae,hn),Ht;if(zt===null){for(;hn<Le.length;hn++)zt=et(Ae,Le[hn],Qe),zt!==null&&(Ne=_(zt,Ne,hn),Mn===null?Ht=zt:Mn.sibling=zt,Mn=zt);return _n&&Jl(Ae,hn),Ht}for(zt=w(zt);hn<Le.length;hn++)Cn=Ue(zt,Ae,hn,Le[hn],Qe),Cn!==null&&(d&&Cn.alternate!==null&&zt.delete(Cn.key===null?hn:Cn.key),Ne=_(Cn,Ne,hn),Mn===null?Ht=Cn:Mn.sibling=Cn,Mn=Cn);return d&&zt.forEach(function(Tu){return m(Ae,Tu)}),_n&&Jl(Ae,hn),Ht}function Kt(Ae,Ne,Le,Qe){if(Le==null)throw Error(s(151));for(var Ht=null,Mn=null,zt=Ne,hn=Ne=0,Cn=null,Fn=Le.next();zt!==null&&!Fn.done;hn++,Fn=Le.next()){zt.index>hn?(Cn=zt,zt=null):Cn=zt.sibling;var Tu=Fe(Ae,zt,Fn.value,Qe);if(Tu===null){zt===null&&(zt=Cn);break}d&&zt&&Tu.alternate===null&&m(Ae,zt),Ne=_(Tu,Ne,hn),Mn===null?Ht=Tu:Mn.sibling=Tu,Mn=Tu,zt=Cn}if(Fn.done)return g(Ae,zt),_n&&Jl(Ae,hn),Ht;if(zt===null){for(;!Fn.done;hn++,Fn=Le.next())Fn=et(Ae,Fn.value,Qe),Fn!==null&&(Ne=_(Fn,Ne,hn),Mn===null?Ht=Fn:Mn.sibling=Fn,Mn=Fn);return _n&&Jl(Ae,hn),Ht}for(zt=w(zt);!Fn.done;hn++,Fn=Le.next())Fn=Ue(zt,Ae,hn,Fn.value,Qe),Fn!==null&&(d&&Fn.alternate!==null&&zt.delete(Fn.key===null?hn:Fn.key),Ne=_(Fn,Ne,hn),Mn===null?Ht=Fn:Mn.sibling=Fn,Mn=Fn);return d&&zt.forEach(function(Bee){return m(Ae,Bee)}),_n&&Jl(Ae,hn),Ht}function is(Ae,Ne,Le,Qe){if(typeof Le=="object"&&Le!==null&&Le.type===v&&Le.key===null&&(Le=Le.props.children),typeof Le=="object"&&Le!==null){switch(Le.$$typeof){case x:e:{for(var Ht=Le.key;Ne!==null;){if(Ne.key===Ht){if(Ht=Le.type,Ht===v){if(Ne.tag===7){g(Ae,Ne.sibling),Qe=C(Ne,Le.props.children),Qe.return=Ae,Ae=Qe;break e}}else if(Ne.elementType===Ht||typeof Ht=="object"&&Ht!==null&&Ht.$$typeof===I&&Cd(Ht)===Ne.type){g(Ae,Ne.sibling),Qe=C(Ne,Le.props),j0(Qe,Le),Qe.return=Ae,Ae=Qe;break e}g(Ae,Ne);break}else m(Ae,Ne);Ne=Ne.sibling}Le.type===v?(Qe=wd(Le.props.children,Ae.mode,Qe,Le.key),Qe.return=Ae,Ae=Qe):(Qe=Wb(Le.type,Le.key,Le.props,null,Ae.mode,Qe),j0(Qe,Le),Qe.return=Ae,Ae=Qe)}return G(Ae);case y:e:{for(Ht=Le.key;Ne!==null;){if(Ne.key===Ht)if(Ne.tag===4&&Ne.stateNode.containerInfo===Le.containerInfo&&Ne.stateNode.implementation===Le.implementation){g(Ae,Ne.sibling),Qe=C(Ne,Le.children||[]),Qe.return=Ae,Ae=Qe;break e}else{g(Ae,Ne);break}else m(Ae,Ne);Ne=Ne.sibling}Qe=Xj(Le,Ae.mode,Qe),Qe.return=Ae,Ae=Qe}return G(Ae);case I:return Le=Cd(Le),is(Ae,Ne,Le,Qe)}if(X(Le))return Rt(Ae,Ne,Le,Qe);if(F(Le)){if(Ht=F(Le),typeof Ht!="function")throw Error(s(150));return Le=Ht.call(Le),Kt(Ae,Ne,Le,Qe)}if(typeof Le.then=="function")return is(Ae,Ne,Qb(Le),Qe);if(Le.$$typeof===k)return is(Ae,Ne,qb(Ae,Le),Qe);Zb(Ae,Le)}return typeof Le=="string"&&Le!==""||typeof Le=="number"||typeof Le=="bigint"?(Le=""+Le,Ne!==null&&Ne.tag===6?(g(Ae,Ne.sibling),Qe=C(Ne,Le),Qe.return=Ae,Ae=Qe):(g(Ae,Ne),Qe=Kj(Le,Ae.mode,Qe),Qe.return=Ae,Ae=Qe),G(Ae)):g(Ae,Ne)}return function(Ae,Ne,Le,Qe){try{S0=0;var Ht=is(Ae,Ne,Le,Qe);return wm=null,Ht}catch(zt){if(zt===vm||zt===Xb)throw zt;var Mn=_i(29,zt,null,Ae.mode);return Mn.lanes=Qe,Mn.return=Ae,Mn}finally{}}}var _d=MO(!0),FO=MO(!1),uu=!1;function ok(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function lk(d,m){d=d.updateQueue,m.updateQueue===d&&(m.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,callbacks:null})}function du(d){return{lane:d,tag:0,payload:null,callback:null,next:null}}function hu(d,m,g){var w=d.updateQueue;if(w===null)return null;if(w=w.shared,(Bn&2)!==0){var C=w.pending;return C===null?m.next=m:(m.next=C.next,C.next=m),w.pending=m,m=Vb(d),NO(d,null,g),m}return Ub(d,w,m,g),Vb(d)}function k0(d,m,g){if(m=m.updateQueue,m!==null&&(m=m.shared,(g&4194048)!==0)){var w=m.lanes;w&=d.pendingLanes,g|=w,m.lanes=g,Kl(d,g)}}function ck(d,m){var g=d.updateQueue,w=d.alternate;if(w!==null&&(w=w.updateQueue,g===w)){var C=null,_=null;if(g=g.firstBaseUpdate,g!==null){do{var G={lane:g.lane,tag:g.tag,payload:g.payload,callback:null,next:null};_===null?C=_=G:_=_.next=G,g=g.next}while(g!==null);_===null?C=_=m:_=_.next=m}else C=_=m;g={baseState:w.baseState,firstBaseUpdate:C,lastBaseUpdate:_,shared:w.shared,callbacks:w.callbacks},d.updateQueue=g;return}d=g.lastBaseUpdate,d===null?g.firstBaseUpdate=m:d.next=m,g.lastBaseUpdate=m}var uk=!1;function C0(){if(uk){var d=bm;if(d!==null)throw d}}function T0(d,m,g,w){uk=!1;var C=d.updateQueue;uu=!1;var _=C.firstBaseUpdate,G=C.lastBaseUpdate,ne=C.shared.pending;if(ne!==null){C.shared.pending=null;var pe=ne,Me=pe.next;pe.next=null,G===null?_=Me:G.next=Me,G=pe;var Xe=d.alternate;Xe!==null&&(Xe=Xe.updateQueue,ne=Xe.lastBaseUpdate,ne!==G&&(ne===null?Xe.firstBaseUpdate=Me:ne.next=Me,Xe.lastBaseUpdate=pe))}if(_!==null){var et=C.baseState;G=0,Xe=Me=pe=null,ne=_;do{var Fe=ne.lane&-536870913,Ue=Fe!==ne.lane;if(Ue?(kn&Fe)===Fe:(w&Fe)===Fe){Fe!==0&&Fe===ym&&(uk=!0),Xe!==null&&(Xe=Xe.next={lane:0,tag:ne.tag,payload:ne.payload,callback:null,next:null});e:{var Rt=d,Kt=ne;Fe=m;var is=g;switch(Kt.tag){case 1:if(Rt=Kt.payload,typeof Rt=="function"){et=Rt.call(is,et,Fe);break e}et=Rt;break e;case 3:Rt.flags=Rt.flags&-65537|128;case 0:if(Rt=Kt.payload,Fe=typeof Rt=="function"?Rt.call(is,et,Fe):Rt,Fe==null)break e;et=f({},et,Fe);break e;case 2:uu=!0}}Fe=ne.callback,Fe!==null&&(d.flags|=64,Ue&&(d.flags|=8192),Ue=C.callbacks,Ue===null?C.callbacks=[Fe]:Ue.push(Fe))}else Ue={lane:Fe,tag:ne.tag,payload:ne.payload,callback:ne.callback,next:null},Xe===null?(Me=Xe=Ue,pe=et):Xe=Xe.next=Ue,G|=Fe;if(ne=ne.next,ne===null){if(ne=C.shared.pending,ne===null)break;Ue=ne,ne=Ue.next,Ue.next=null,C.lastBaseUpdate=Ue,C.shared.pending=null}}while(!0);Xe===null&&(pe=et),C.baseState=pe,C.firstBaseUpdate=Me,C.lastBaseUpdate=Xe,_===null&&(C.shared.lanes=0),xu|=G,d.lanes=G,d.memoizedState=et}}function zO(d,m){if(typeof d!="function")throw Error(s(191,d));d.call(m)}function BO(d,m){var g=d.callbacks;if(g!==null)for(d.callbacks=null,d=0;d<g.length;d++)zO(g[d],m)}var Nm=O(null),Jb=O(0);function UO(d,m){d=uc,J(Jb,d),J(Nm,m),uc=d|m.baseLanes}function dk(){J(Jb,uc),J(Nm,Nm.current)}function hk(){uc=Jb.current,U(Nm),U(Jb)}var Ei=O(null),go=null;function mu(d){var m=d.alternate;J(Ys,Ys.current&1),J(Ei,d),go===null&&(m===null||Nm.current!==null||m.memoizedState!==null)&&(go=d)}function mk(d){J(Ys,Ys.current),J(Ei,d),go===null&&(go=d)}function VO(d){d.tag===22?(J(Ys,Ys.current),J(Ei,d),go===null&&(go=d)):fu()}function fu(){J(Ys,Ys.current),J(Ei,Ei.current)}function Ai(d){U(Ei),go===d&&(go=null),U(Ys)}var Ys=O(0);function ev(d){for(var m=d;m!==null;){if(m.tag===13){var g=m.memoizedState;if(g!==null&&(g=g.dehydrated,g===null||bC(g)||vC(g)))return m}else if(m.tag===19&&(m.memoizedProps.revealOrder==="forwards"||m.memoizedProps.revealOrder==="backwards"||m.memoizedProps.revealOrder==="unstable_legacy-backwards"||m.memoizedProps.revealOrder==="together")){if((m.flags&128)!==0)return m}else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===d)break;for(;m.sibling===null;){if(m.return===null||m.return===d)return null;m=m.return}m.sibling.return=m.return,m=m.sibling}return null}var nc=0,ln=null,rs=null,lr=null,tv=!1,Sm=!1,Ed=!1,nv=0,_0=0,jm=null,$J=0;function zs(){throw Error(s(321))}function fk(d,m){if(m===null)return!1;for(var g=0;g<m.length&&g<d.length;g++)if(!Ti(d[g],m[g]))return!1;return!0}function pk(d,m,g,w,C,_){return nc=_,ln=m,m.memoizedState=null,m.updateQueue=null,m.lanes=0,z.H=d===null||d.memoizedState===null?CD:Ak,Ed=!1,_=g(w,C),Ed=!1,Sm&&(_=HO(m,g,w,C)),WO(d),_}function WO(d){z.H=$0;var m=rs!==null&&rs.next!==null;if(nc=0,lr=rs=ln=null,tv=!1,_0=0,jm=null,m)throw Error(s(300));d===null||cr||(d=d.dependencies,d!==null&&Gb(d)&&(cr=!0))}function HO(d,m,g,w){ln=d;var C=0;do{if(Sm&&(jm=null),_0=0,Sm=!1,25<=C)throw Error(s(301));if(C+=1,lr=rs=null,d.updateQueue!=null){var _=d.updateQueue;_.lastEffect=null,_.events=null,_.stores=null,_.memoCache!=null&&(_.memoCache.index=0)}z.H=TD,_=m(g,w)}while(Sm);return _}function IJ(){var d=z.H,m=d.useState()[0];return m=typeof m.then=="function"?E0(m):m,d=d.useState()[0],(rs!==null?rs.memoizedState:null)!==d&&(ln.flags|=1024),m}function gk(){var d=nv!==0;return nv=0,d}function xk(d,m,g){m.updateQueue=d.updateQueue,m.flags&=-2053,d.lanes&=~g}function yk(d){if(tv){for(d=d.memoizedState;d!==null;){var m=d.queue;m!==null&&(m.pending=null),d=d.next}tv=!1}nc=0,lr=rs=ln=null,Sm=!1,_0=nv=0,jm=null}function Ra(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return lr===null?ln.memoizedState=lr=d:lr=lr.next=d,lr}function Qs(){if(rs===null){var d=ln.alternate;d=d!==null?d.memoizedState:null}else d=rs.next;var m=lr===null?ln.memoizedState:lr.next;if(m!==null)lr=m,rs=d;else{if(d===null)throw ln.alternate===null?Error(s(467)):Error(s(310));rs=d,d={memoizedState:rs.memoizedState,baseState:rs.baseState,baseQueue:rs.baseQueue,queue:rs.queue,next:null},lr===null?ln.memoizedState=lr=d:lr=lr.next=d}return lr}function sv(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function E0(d){var m=_0;return _0+=1,jm===null&&(jm=[]),d=DO(jm,d,m),m=ln,(lr===null?m.memoizedState:lr.next)===null&&(m=m.alternate,z.H=m===null||m.memoizedState===null?CD:Ak),d}function rv(d){if(d!==null&&typeof d=="object"){if(typeof d.then=="function")return E0(d);if(d.$$typeof===k)return ia(d)}throw Error(s(438,String(d)))}function bk(d){var m=null,g=ln.updateQueue;if(g!==null&&(m=g.memoCache),m==null){var w=ln.alternate;w!==null&&(w=w.updateQueue,w!==null&&(w=w.memoCache,w!=null&&(m={data:w.data.map(function(C){return C.slice()}),index:0})))}if(m==null&&(m={data:[],index:0}),g===null&&(g=sv(),ln.updateQueue=g),g.memoCache=m,g=m.data[m.index],g===void 0)for(g=m.data[m.index]=Array(d),w=0;w<d;w++)g[w]=$;return m.index++,g}function sc(d,m){return typeof m=="function"?m(d):m}function av(d){var m=Qs();return vk(m,rs,d)}function vk(d,m,g){var w=d.queue;if(w===null)throw Error(s(311));w.lastRenderedReducer=g;var C=d.baseQueue,_=w.pending;if(_!==null){if(C!==null){var G=C.next;C.next=_.next,_.next=G}m.baseQueue=C=_,w.pending=null}if(_=d.baseState,C===null)d.memoizedState=_;else{m=C.next;var ne=G=null,pe=null,Me=m,Xe=!1;do{var et=Me.lane&-536870913;if(et!==Me.lane?(kn&et)===et:(nc&et)===et){var Fe=Me.revertLane;if(Fe===0)pe!==null&&(pe=pe.next={lane:0,revertLane:0,gesture:null,action:Me.action,hasEagerState:Me.hasEagerState,eagerState:Me.eagerState,next:null}),et===ym&&(Xe=!0);else if((nc&Fe)===Fe){Me=Me.next,Fe===ym&&(Xe=!0);continue}else et={lane:0,revertLane:Me.revertLane,gesture:null,action:Me.action,hasEagerState:Me.hasEagerState,eagerState:Me.eagerState,next:null},pe===null?(ne=pe=et,G=_):pe=pe.next=et,ln.lanes|=Fe,xu|=Fe;et=Me.action,Ed&&g(_,et),_=Me.hasEagerState?Me.eagerState:g(_,et)}else Fe={lane:et,revertLane:Me.revertLane,gesture:Me.gesture,action:Me.action,hasEagerState:Me.hasEagerState,eagerState:Me.eagerState,next:null},pe===null?(ne=pe=Fe,G=_):pe=pe.next=Fe,ln.lanes|=et,xu|=et;Me=Me.next}while(Me!==null&&Me!==m);if(pe===null?G=_:pe.next=ne,!Ti(_,d.memoizedState)&&(cr=!0,Xe&&(g=bm,g!==null)))throw g;d.memoizedState=_,d.baseState=G,d.baseQueue=pe,w.lastRenderedState=_}return C===null&&(w.lanes=0),[d.memoizedState,w.dispatch]}function wk(d){var m=Qs(),g=m.queue;if(g===null)throw Error(s(311));g.lastRenderedReducer=d;var w=g.dispatch,C=g.pending,_=m.memoizedState;if(C!==null){g.pending=null;var G=C=C.next;do _=d(_,G.action),G=G.next;while(G!==C);Ti(_,m.memoizedState)||(cr=!0),m.memoizedState=_,m.baseQueue===null&&(m.baseState=_),g.lastRenderedState=_}return[_,w]}function GO(d,m,g){var w=ln,C=Qs(),_=_n;if(_){if(g===void 0)throw Error(s(407));g=g()}else g=m();var G=!Ti((rs||C).memoizedState,g);if(G&&(C.memoizedState=g,cr=!0),C=C.queue,jk(XO.bind(null,w,C,d),[d]),C.getSnapshot!==m||G||lr!==null&&lr.memoizedState.tag&1){if(w.flags|=2048,km(9,{destroy:void 0},KO.bind(null,w,C,g,m),null),ms===null)throw Error(s(349));_||(nc&127)!==0||qO(w,m,g)}return g}function qO(d,m,g){d.flags|=16384,d={getSnapshot:m,value:g},m=ln.updateQueue,m===null?(m=sv(),ln.updateQueue=m,m.stores=[d]):(g=m.stores,g===null?m.stores=[d]:g.push(d))}function KO(d,m,g,w){m.value=g,m.getSnapshot=w,YO(m)&&QO(d)}function XO(d,m,g){return g(function(){YO(m)&&QO(d)})}function YO(d){var m=d.getSnapshot;d=d.value;try{var g=m();return!Ti(d,g)}catch{return!0}}function QO(d){var m=vd(d,2);m!==null&&si(m,d,2)}function Nk(d){var m=Ra();if(typeof d=="function"){var g=d;if(d=g(),Ed){Ie(!0);try{g()}finally{Ie(!1)}}}return m.memoizedState=m.baseState=d,m.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:sc,lastRenderedState:d},m}function ZO(d,m,g,w){return d.baseState=g,vk(d,rs,typeof w=="function"?w:sc)}function RJ(d,m,g,w,C){if(lv(d))throw Error(s(485));if(d=m.action,d!==null){var _={payload:C,action:d,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(G){_.listeners.push(G)}};z.T!==null?g(!0):_.isTransition=!1,w(_),g=m.pending,g===null?(_.next=m.pending=_,JO(m,_)):(_.next=g.next,m.pending=g.next=_)}}function JO(d,m){var g=m.action,w=m.payload,C=d.state;if(m.isTransition){var _=z.T,G={};z.T=G;try{var ne=g(C,w),pe=z.S;pe!==null&&pe(G,ne),eD(d,m,ne)}catch(Me){Sk(d,m,Me)}finally{_!==null&&G.types!==null&&(_.types=G.types),z.T=_}}else try{_=g(C,w),eD(d,m,_)}catch(Me){Sk(d,m,Me)}}function eD(d,m,g){g!==null&&typeof g=="object"&&typeof g.then=="function"?g.then(function(w){tD(d,m,w)},function(w){return Sk(d,m,w)}):tD(d,m,g)}function tD(d,m,g){m.status="fulfilled",m.value=g,nD(m),d.state=g,m=d.pending,m!==null&&(g=m.next,g===m?d.pending=null:(g=g.next,m.next=g,JO(d,g)))}function Sk(d,m,g){var w=d.pending;if(d.pending=null,w!==null){w=w.next;do m.status="rejected",m.reason=g,nD(m),m=m.next;while(m!==w)}d.action=null}function nD(d){d=d.listeners;for(var m=0;m<d.length;m++)(0,d[m])()}function sD(d,m){return m}function rD(d,m){if(_n){var g=ms.formState;if(g!==null){e:{var w=ln;if(_n){if(Ns){t:{for(var C=Ns,_=po;C.nodeType!==8;){if(!_){C=null;break t}if(C=xo(C.nextSibling),C===null){C=null;break t}}_=C.data,C=_==="F!"||_==="F"?C:null}if(C){Ns=xo(C.nextSibling),w=C.data==="F!";break e}}lu(w)}w=!1}w&&(m=g[0])}}return g=Ra(),g.memoizedState=g.baseState=m,w={pending:null,lanes:0,dispatch:null,lastRenderedReducer:sD,lastRenderedState:m},g.queue=w,g=SD.bind(null,ln,w),w.dispatch=g,w=Nk(!1),_=Ek.bind(null,ln,!1,w.queue),w=Ra(),C={state:m,dispatch:null,action:d,pending:null},w.queue=C,g=RJ.bind(null,ln,C,_,g),C.dispatch=g,w.memoizedState=d,[m,g,!1]}function aD(d){var m=Qs();return iD(m,rs,d)}function iD(d,m,g){if(m=vk(d,m,sD)[0],d=av(sc)[0],typeof m=="object"&&m!==null&&typeof m.then=="function")try{var w=E0(m)}catch(G){throw G===vm?Xb:G}else w=m;m=Qs();var C=m.queue,_=C.dispatch;return g!==m.memoizedState&&(ln.flags|=2048,km(9,{destroy:void 0},OJ.bind(null,C,g),null)),[w,_,d]}function OJ(d,m){d.action=m}function oD(d){var m=Qs(),g=rs;if(g!==null)return iD(m,g,d);Qs(),m=m.memoizedState,g=Qs();var w=g.queue.dispatch;return g.memoizedState=d,[m,w,!1]}function km(d,m,g,w){return d={tag:d,create:g,deps:w,inst:m,next:null},m=ln.updateQueue,m===null&&(m=sv(),ln.updateQueue=m),g=m.lastEffect,g===null?m.lastEffect=d.next=d:(w=g.next,g.next=d,d.next=w,m.lastEffect=d),d}function lD(){return Qs().memoizedState}function iv(d,m,g,w){var C=Ra();ln.flags|=d,C.memoizedState=km(1|m,{destroy:void 0},g,w===void 0?null:w)}function ov(d,m,g,w){var C=Qs();w=w===void 0?null:w;var _=C.memoizedState.inst;rs!==null&&w!==null&&fk(w,rs.memoizedState.deps)?C.memoizedState=km(m,_,g,w):(ln.flags|=d,C.memoizedState=km(1|m,_,g,w))}function cD(d,m){iv(8390656,8,d,m)}function jk(d,m){ov(2048,8,d,m)}function DJ(d){ln.flags|=4;var m=ln.updateQueue;if(m===null)m=sv(),ln.updateQueue=m,m.events=[d];else{var g=m.events;g===null?m.events=[d]:g.push(d)}}function uD(d){var m=Qs().memoizedState;return DJ({ref:m,nextImpl:d}),function(){if((Bn&2)!==0)throw Error(s(440));return m.impl.apply(void 0,arguments)}}function dD(d,m){return ov(4,2,d,m)}function hD(d,m){return ov(4,4,d,m)}function mD(d,m){if(typeof m=="function"){d=d();var g=m(d);return function(){typeof g=="function"?g():m(null)}}if(m!=null)return d=d(),m.current=d,function(){m.current=null}}function fD(d,m,g){g=g!=null?g.concat([d]):null,ov(4,4,mD.bind(null,m,d),g)}function kk(){}function pD(d,m){var g=Qs();m=m===void 0?null:m;var w=g.memoizedState;return m!==null&&fk(m,w[1])?w[0]:(g.memoizedState=[d,m],d)}function gD(d,m){var g=Qs();m=m===void 0?null:m;var w=g.memoizedState;if(m!==null&&fk(m,w[1]))return w[0];if(w=d(),Ed){Ie(!0);try{d()}finally{Ie(!1)}}return g.memoizedState=[w,m],w}function Ck(d,m,g){return g===void 0||(nc&1073741824)!==0&&(kn&261930)===0?d.memoizedState=m:(d.memoizedState=g,d=x6(),ln.lanes|=d,xu|=d,g)}function xD(d,m,g,w){return Ti(g,m)?g:Nm.current!==null?(d=Ck(d,g,w),Ti(d,m)||(cr=!0),d):(nc&42)===0||(nc&1073741824)!==0&&(kn&261930)===0?(cr=!0,d.memoizedState=g):(d=x6(),ln.lanes|=d,xu|=d,m)}function yD(d,m,g,w,C){var _=K.p;K.p=_!==0&&8>_?_:8;var G=z.T,ne={};z.T=ne,Ek(d,!1,m,g);try{var pe=C(),Me=z.S;if(Me!==null&&Me(ne,pe),pe!==null&&typeof pe=="object"&&typeof pe.then=="function"){var Xe=AJ(pe,w);A0(d,m,Xe,Ri(d))}else A0(d,m,w,Ri(d))}catch(et){A0(d,m,{then:function(){},status:"rejected",reason:et},Ri())}finally{K.p=_,G!==null&&ne.types!==null&&(G.types=ne.types),z.T=G}}function PJ(){}function Tk(d,m,g,w){if(d.tag!==5)throw Error(s(476));var C=bD(d).queue;yD(d,C,m,H,g===null?PJ:function(){return vD(d),g(w)})}function bD(d){var m=d.memoizedState;if(m!==null)return m;m={memoizedState:H,baseState:H,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:sc,lastRenderedState:H},next:null};var g={};return m.next={memoizedState:g,baseState:g,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:sc,lastRenderedState:g},next:null},d.memoizedState=m,d=d.alternate,d!==null&&(d.memoizedState=m),m}function vD(d){var m=bD(d);m.next===null&&(m=d.alternate.memoizedState),A0(d,m.next.queue,{},Ri())}function _k(){return ia(q0)}function wD(){return Qs().memoizedState}function ND(){return Qs().memoizedState}function LJ(d){for(var m=d.return;m!==null;){switch(m.tag){case 24:case 3:var g=Ri();d=du(g);var w=hu(m,d,g);w!==null&&(si(w,m,g),k0(w,m,g)),m={cache:sk()},d.payload=m;return}m=m.return}}function MJ(d,m,g){var w=Ri();g={lane:w,revertLane:0,gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null},lv(d)?jD(m,g):(g=Gj(d,m,g,w),g!==null&&(si(g,d,w),kD(g,m,w)))}function SD(d,m,g){var w=Ri();A0(d,m,g,w)}function A0(d,m,g,w){var C={lane:w,revertLane:0,gesture:null,action:g,hasEagerState:!1,eagerState:null,next:null};if(lv(d))jD(m,C);else{var _=d.alternate;if(d.lanes===0&&(_===null||_.lanes===0)&&(_=m.lastRenderedReducer,_!==null))try{var G=m.lastRenderedState,ne=_(G,g);if(C.hasEagerState=!0,C.eagerState=ne,Ti(ne,G))return Ub(d,m,C,0),ms===null&&Bb(),!1}catch{}finally{}if(g=Gj(d,m,C,w),g!==null)return si(g,d,w),kD(g,m,w),!0}return!1}function Ek(d,m,g,w){if(w={lane:2,revertLane:oC(),gesture:null,action:w,hasEagerState:!1,eagerState:null,next:null},lv(d)){if(m)throw Error(s(479))}else m=Gj(d,g,w,2),m!==null&&si(m,d,2)}function lv(d){var m=d.alternate;return d===ln||m!==null&&m===ln}function jD(d,m){Sm=tv=!0;var g=d.pending;g===null?m.next=m:(m.next=g.next,g.next=m),d.pending=m}function kD(d,m,g){if((g&4194048)!==0){var w=m.lanes;w&=d.pendingLanes,g|=w,m.lanes=g,Kl(d,g)}}var $0={readContext:ia,use:rv,useCallback:zs,useContext:zs,useEffect:zs,useImperativeHandle:zs,useLayoutEffect:zs,useInsertionEffect:zs,useMemo:zs,useReducer:zs,useRef:zs,useState:zs,useDebugValue:zs,useDeferredValue:zs,useTransition:zs,useSyncExternalStore:zs,useId:zs,useHostTransitionStatus:zs,useFormState:zs,useActionState:zs,useOptimistic:zs,useMemoCache:zs,useCacheRefresh:zs};$0.useEffectEvent=zs;var CD={readContext:ia,use:rv,useCallback:function(d,m){return Ra().memoizedState=[d,m===void 0?null:m],d},useContext:ia,useEffect:cD,useImperativeHandle:function(d,m,g){g=g!=null?g.concat([d]):null,iv(4194308,4,mD.bind(null,m,d),g)},useLayoutEffect:function(d,m){return iv(4194308,4,d,m)},useInsertionEffect:function(d,m){iv(4,2,d,m)},useMemo:function(d,m){var g=Ra();m=m===void 0?null:m;var w=d();if(Ed){Ie(!0);try{d()}finally{Ie(!1)}}return g.memoizedState=[w,m],w},useReducer:function(d,m,g){var w=Ra();if(g!==void 0){var C=g(m);if(Ed){Ie(!0);try{g(m)}finally{Ie(!1)}}}else C=m;return w.memoizedState=w.baseState=C,d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:C},w.queue=d,d=d.dispatch=MJ.bind(null,ln,d),[w.memoizedState,d]},useRef:function(d){var m=Ra();return d={current:d},m.memoizedState=d},useState:function(d){d=Nk(d);var m=d.queue,g=SD.bind(null,ln,m);return m.dispatch=g,[d.memoizedState,g]},useDebugValue:kk,useDeferredValue:function(d,m){var g=Ra();return Ck(g,d,m)},useTransition:function(){var d=Nk(!1);return d=yD.bind(null,ln,d.queue,!0,!1),Ra().memoizedState=d,[!1,d]},useSyncExternalStore:function(d,m,g){var w=ln,C=Ra();if(_n){if(g===void 0)throw Error(s(407));g=g()}else{if(g=m(),ms===null)throw Error(s(349));(kn&127)!==0||qO(w,m,g)}C.memoizedState=g;var _={value:g,getSnapshot:m};return C.queue=_,cD(XO.bind(null,w,_,d),[d]),w.flags|=2048,km(9,{destroy:void 0},KO.bind(null,w,_,g,m),null),g},useId:function(){var d=Ra(),m=ms.identifierPrefix;if(_n){var g=wl,w=vl;g=(w&~(1<<32-lt(w)-1)).toString(32)+g,m="_"+m+"R_"+g,g=nv++,0<g&&(m+="H"+g.toString(32)),m+="_"}else g=$J++,m="_"+m+"r_"+g.toString(32)+"_";return d.memoizedState=m},useHostTransitionStatus:_k,useFormState:rD,useActionState:rD,useOptimistic:function(d){var m=Ra();m.memoizedState=m.baseState=d;var g={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return m.queue=g,m=Ek.bind(null,ln,!0,g),g.dispatch=m,[d,m]},useMemoCache:bk,useCacheRefresh:function(){return Ra().memoizedState=LJ.bind(null,ln)},useEffectEvent:function(d){var m=Ra(),g={impl:d};return m.memoizedState=g,function(){if((Bn&2)!==0)throw Error(s(440));return g.impl.apply(void 0,arguments)}}},Ak={readContext:ia,use:rv,useCallback:pD,useContext:ia,useEffect:jk,useImperativeHandle:fD,useInsertionEffect:dD,useLayoutEffect:hD,useMemo:gD,useReducer:av,useRef:lD,useState:function(){return av(sc)},useDebugValue:kk,useDeferredValue:function(d,m){var g=Qs();return xD(g,rs.memoizedState,d,m)},useTransition:function(){var d=av(sc)[0],m=Qs().memoizedState;return[typeof d=="boolean"?d:E0(d),m]},useSyncExternalStore:GO,useId:wD,useHostTransitionStatus:_k,useFormState:aD,useActionState:aD,useOptimistic:function(d,m){var g=Qs();return ZO(g,rs,d,m)},useMemoCache:bk,useCacheRefresh:ND};Ak.useEffectEvent=uD;var TD={readContext:ia,use:rv,useCallback:pD,useContext:ia,useEffect:jk,useImperativeHandle:fD,useInsertionEffect:dD,useLayoutEffect:hD,useMemo:gD,useReducer:wk,useRef:lD,useState:function(){return wk(sc)},useDebugValue:kk,useDeferredValue:function(d,m){var g=Qs();return rs===null?Ck(g,d,m):xD(g,rs.memoizedState,d,m)},useTransition:function(){var d=wk(sc)[0],m=Qs().memoizedState;return[typeof d=="boolean"?d:E0(d),m]},useSyncExternalStore:GO,useId:wD,useHostTransitionStatus:_k,useFormState:oD,useActionState:oD,useOptimistic:function(d,m){var g=Qs();return rs!==null?ZO(g,rs,d,m):(g.baseState=d,[d,g.queue.dispatch])},useMemoCache:bk,useCacheRefresh:ND};TD.useEffectEvent=uD;function $k(d,m,g,w){m=d.memoizedState,g=g(w,m),g=g==null?m:f({},m,g),d.memoizedState=g,d.lanes===0&&(d.updateQueue.baseState=g)}var Ik={enqueueSetState:function(d,m,g){d=d._reactInternals;var w=Ri(),C=du(w);C.payload=m,g!=null&&(C.callback=g),m=hu(d,C,w),m!==null&&(si(m,d,w),k0(m,d,w))},enqueueReplaceState:function(d,m,g){d=d._reactInternals;var w=Ri(),C=du(w);C.tag=1,C.payload=m,g!=null&&(C.callback=g),m=hu(d,C,w),m!==null&&(si(m,d,w),k0(m,d,w))},enqueueForceUpdate:function(d,m){d=d._reactInternals;var g=Ri(),w=du(g);w.tag=2,m!=null&&(w.callback=m),m=hu(d,w,g),m!==null&&(si(m,d,g),k0(m,d,g))}};function _D(d,m,g,w,C,_,G){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(w,_,G):m.prototype&&m.prototype.isPureReactComponent?!x0(g,w)||!x0(C,_):!0}function ED(d,m,g,w){d=m.state,typeof m.componentWillReceiveProps=="function"&&m.componentWillReceiveProps(g,w),typeof m.UNSAFE_componentWillReceiveProps=="function"&&m.UNSAFE_componentWillReceiveProps(g,w),m.state!==d&&Ik.enqueueReplaceState(m,m.state,null)}function Ad(d,m){var g=m;if("ref"in m){g={};for(var w in m)w!=="ref"&&(g[w]=m[w])}if(d=d.defaultProps){g===m&&(g=f({},g));for(var C in d)g[C]===void 0&&(g[C]=d[C])}return g}function AD(d){zb(d)}function $D(d){console.error(d)}function ID(d){zb(d)}function cv(d,m){try{var g=d.onUncaughtError;g(m.value,{componentStack:m.stack})}catch(w){setTimeout(function(){throw w})}}function RD(d,m,g){try{var w=d.onCaughtError;w(g.value,{componentStack:g.stack,errorBoundary:m.tag===1?m.stateNode:null})}catch(C){setTimeout(function(){throw C})}}function Rk(d,m,g){return g=du(g),g.tag=3,g.payload={element:null},g.callback=function(){cv(d,m)},g}function OD(d){return d=du(d),d.tag=3,d}function DD(d,m,g,w){var C=g.type.getDerivedStateFromError;if(typeof C=="function"){var _=w.value;d.payload=function(){return C(_)},d.callback=function(){RD(m,g,w)}}var G=g.stateNode;G!==null&&typeof G.componentDidCatch=="function"&&(d.callback=function(){RD(m,g,w),typeof C!="function"&&(yu===null?yu=new Set([this]):yu.add(this));var ne=w.stack;this.componentDidCatch(w.value,{componentStack:ne!==null?ne:""})})}function FJ(d,m,g,w,C){if(g.flags|=32768,w!==null&&typeof w=="object"&&typeof w.then=="function"){if(m=g.alternate,m!==null&&xm(m,g,C,!0),g=Ei.current,g!==null){switch(g.tag){case 31:case 13:return go===null?wv():g.alternate===null&&Bs===0&&(Bs=3),g.flags&=-257,g.flags|=65536,g.lanes=C,w===Yb?g.flags|=16384:(m=g.updateQueue,m===null?g.updateQueue=new Set([w]):m.add(w),rC(d,w,C)),!1;case 22:return g.flags|=65536,w===Yb?g.flags|=16384:(m=g.updateQueue,m===null?(m={transitions:null,markerInstances:null,retryQueue:new Set([w])},g.updateQueue=m):(g=m.retryQueue,g===null?m.retryQueue=new Set([w]):g.add(w)),rC(d,w,C)),!1}throw Error(s(435,g.tag))}return rC(d,w,C),wv(),!1}if(_n)return m=Ei.current,m!==null?((m.flags&65536)===0&&(m.flags|=256),m.flags|=65536,m.lanes=C,w!==Zj&&(d=Error(s(422),{cause:w}),v0(ho(d,g)))):(w!==Zj&&(m=Error(s(423),{cause:w}),v0(ho(m,g))),d=d.current.alternate,d.flags|=65536,C&=-C,d.lanes|=C,w=ho(w,g),C=Rk(d.stateNode,w,C),ck(d,C),Bs!==4&&(Bs=2)),!1;var _=Error(s(520),{cause:w});if(_=ho(_,g),F0===null?F0=[_]:F0.push(_),Bs!==4&&(Bs=2),m===null)return!0;w=ho(w,g),g=m;do{switch(g.tag){case 3:return g.flags|=65536,d=C&-C,g.lanes|=d,d=Rk(g.stateNode,w,d),ck(g,d),!1;case 1:if(m=g.type,_=g.stateNode,(g.flags&128)===0&&(typeof m.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(yu===null||!yu.has(_))))return g.flags|=65536,C&=-C,g.lanes|=C,C=OD(C),DD(C,d,g,w),ck(g,C),!1}g=g.return}while(g!==null);return!1}var Ok=Error(s(461)),cr=!1;function oa(d,m,g,w){m.child=d===null?FO(m,null,g,w):_d(m,d.child,g,w)}function PD(d,m,g,w,C){g=g.render;var _=m.ref;if("ref"in w){var G={};for(var ne in w)ne!=="ref"&&(G[ne]=w[ne])}else G=w;return jd(m),w=pk(d,m,g,G,_,C),ne=gk(),d!==null&&!cr?(xk(d,m,C),rc(d,m,C)):(_n&&ne&&Yj(m),m.flags|=1,oa(d,m,w,C),m.child)}function LD(d,m,g,w,C){if(d===null){var _=g.type;return typeof _=="function"&&!qj(_)&&_.defaultProps===void 0&&g.compare===null?(m.tag=15,m.type=_,MD(d,m,_,w,C)):(d=Wb(g.type,null,w,m,m.mode,C),d.ref=m.ref,d.return=m,m.child=d)}if(_=d.child,!Uk(d,C)){var G=_.memoizedProps;if(g=g.compare,g=g!==null?g:x0,g(G,w)&&d.ref===m.ref)return rc(d,m,C)}return m.flags|=1,d=Zl(_,w),d.ref=m.ref,d.return=m,m.child=d}function MD(d,m,g,w,C){if(d!==null){var _=d.memoizedProps;if(x0(_,w)&&d.ref===m.ref)if(cr=!1,m.pendingProps=w=_,Uk(d,C))(d.flags&131072)!==0&&(cr=!0);else return m.lanes=d.lanes,rc(d,m,C)}return Dk(d,m,g,w,C)}function FD(d,m,g,w){var C=w.children,_=d!==null?d.memoizedState:null;if(d===null&&m.stateNode===null&&(m.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),w.mode==="hidden"){if((m.flags&128)!==0){if(_=_!==null?_.baseLanes|g:g,d!==null){for(w=m.child=d.child,C=0;w!==null;)C=C|w.lanes|w.childLanes,w=w.sibling;w=C&~_}else w=0,m.child=null;return zD(d,m,_,g,w)}if((g&536870912)!==0)m.memoizedState={baseLanes:0,cachePool:null},d!==null&&Kb(m,_!==null?_.cachePool:null),_!==null?UO(m,_):dk(),VO(m);else return w=m.lanes=536870912,zD(d,m,_!==null?_.baseLanes|g:g,g,w)}else _!==null?(Kb(m,_.cachePool),UO(m,_),fu(),m.memoizedState=null):(d!==null&&Kb(m,null),dk(),fu());return oa(d,m,C,g),m.child}function I0(d,m){return d!==null&&d.tag===22||m.stateNode!==null||(m.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),m.sibling}function zD(d,m,g,w,C){var _=ak();return _=_===null?null:{parent:or._currentValue,pool:_},m.memoizedState={baseLanes:g,cachePool:_},d!==null&&Kb(m,null),dk(),VO(m),d!==null&&xm(d,m,w,!0),m.childLanes=C,null}function uv(d,m){return m=hv({mode:m.mode,children:m.children},d.mode),m.ref=d.ref,d.child=m,m.return=d,m}function BD(d,m,g){return _d(m,d.child,null,g),d=uv(m,m.pendingProps),d.flags|=2,Ai(m),m.memoizedState=null,d}function zJ(d,m,g){var w=m.pendingProps,C=(m.flags&128)!==0;if(m.flags&=-129,d===null){if(_n){if(w.mode==="hidden")return d=uv(m,w),m.lanes=536870912,I0(null,d);if(mk(m),(d=Ns)?(d=J6(d,po),d=d!==null&&d.data==="&"?d:null,d!==null&&(m.memoizedState={dehydrated:d,treeContext:iu!==null?{id:vl,overflow:wl}:null,retryLane:536870912,hydrationErrors:null},g=jO(d),g.return=m,m.child=g,aa=m,Ns=null)):d=null,d===null)throw lu(m);return m.lanes=536870912,null}return uv(m,w)}var _=d.memoizedState;if(_!==null){var G=_.dehydrated;if(mk(m),C)if(m.flags&256)m.flags&=-257,m=BD(d,m,g);else if(m.memoizedState!==null)m.child=d.child,m.flags|=128,m=null;else throw Error(s(558));else if(cr||xm(d,m,g,!1),C=(g&d.childLanes)!==0,cr||C){if(w=ms,w!==null&&(G=Ya(w,g),G!==0&&G!==_.retryLane))throw _.retryLane=G,vd(d,G),si(w,d,G),Ok;wv(),m=BD(d,m,g)}else d=_.treeContext,Ns=xo(G.nextSibling),aa=m,_n=!0,ou=null,po=!1,d!==null&&TO(m,d),m=uv(m,w),m.flags|=4096;return m}return d=Zl(d.child,{mode:w.mode,children:w.children}),d.ref=m.ref,m.child=d,d.return=m,d}function dv(d,m){var g=m.ref;if(g===null)d!==null&&d.ref!==null&&(m.flags|=4194816);else{if(typeof g!="function"&&typeof g!="object")throw Error(s(284));(d===null||d.ref!==g)&&(m.flags|=4194816)}}function Dk(d,m,g,w,C){return jd(m),g=pk(d,m,g,w,void 0,C),w=gk(),d!==null&&!cr?(xk(d,m,C),rc(d,m,C)):(_n&&w&&Yj(m),m.flags|=1,oa(d,m,g,C),m.child)}function UD(d,m,g,w,C,_){return jd(m),m.updateQueue=null,g=HO(m,w,g,C),WO(d),w=gk(),d!==null&&!cr?(xk(d,m,_),rc(d,m,_)):(_n&&w&&Yj(m),m.flags|=1,oa(d,m,g,_),m.child)}function VD(d,m,g,w,C){if(jd(m),m.stateNode===null){var _=mm,G=g.contextType;typeof G=="object"&&G!==null&&(_=ia(G)),_=new g(w,_),m.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,_.updater=Ik,m.stateNode=_,_._reactInternals=m,_=m.stateNode,_.props=w,_.state=m.memoizedState,_.refs={},ok(m),G=g.contextType,_.context=typeof G=="object"&&G!==null?ia(G):mm,_.state=m.memoizedState,G=g.getDerivedStateFromProps,typeof G=="function"&&($k(m,g,G,w),_.state=m.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(G=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),G!==_.state&&Ik.enqueueReplaceState(_,_.state,null),T0(m,w,_,C),C0(),_.state=m.memoizedState),typeof _.componentDidMount=="function"&&(m.flags|=4194308),w=!0}else if(d===null){_=m.stateNode;var ne=m.memoizedProps,pe=Ad(g,ne);_.props=pe;var Me=_.context,Xe=g.contextType;G=mm,typeof Xe=="object"&&Xe!==null&&(G=ia(Xe));var et=g.getDerivedStateFromProps;Xe=typeof et=="function"||typeof _.getSnapshotBeforeUpdate=="function",ne=m.pendingProps!==ne,Xe||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(ne||Me!==G)&&ED(m,_,w,G),uu=!1;var Fe=m.memoizedState;_.state=Fe,T0(m,w,_,C),C0(),Me=m.memoizedState,ne||Fe!==Me||uu?(typeof et=="function"&&($k(m,g,et,w),Me=m.memoizedState),(pe=uu||_D(m,g,pe,w,Fe,Me,G))?(Xe||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount()),typeof _.componentDidMount=="function"&&(m.flags|=4194308)):(typeof _.componentDidMount=="function"&&(m.flags|=4194308),m.memoizedProps=w,m.memoizedState=Me),_.props=w,_.state=Me,_.context=G,w=pe):(typeof _.componentDidMount=="function"&&(m.flags|=4194308),w=!1)}else{_=m.stateNode,lk(d,m),G=m.memoizedProps,Xe=Ad(g,G),_.props=Xe,et=m.pendingProps,Fe=_.context,Me=g.contextType,pe=mm,typeof Me=="object"&&Me!==null&&(pe=ia(Me)),ne=g.getDerivedStateFromProps,(Me=typeof ne=="function"||typeof _.getSnapshotBeforeUpdate=="function")||typeof _.UNSAFE_componentWillReceiveProps!="function"&&typeof _.componentWillReceiveProps!="function"||(G!==et||Fe!==pe)&&ED(m,_,w,pe),uu=!1,Fe=m.memoizedState,_.state=Fe,T0(m,w,_,C),C0();var Ue=m.memoizedState;G!==et||Fe!==Ue||uu||d!==null&&d.dependencies!==null&&Gb(d.dependencies)?(typeof ne=="function"&&($k(m,g,ne,w),Ue=m.memoizedState),(Xe=uu||_D(m,g,Xe,w,Fe,Ue,pe)||d!==null&&d.dependencies!==null&&Gb(d.dependencies))?(Me||typeof _.UNSAFE_componentWillUpdate!="function"&&typeof _.componentWillUpdate!="function"||(typeof _.componentWillUpdate=="function"&&_.componentWillUpdate(w,Ue,pe),typeof _.UNSAFE_componentWillUpdate=="function"&&_.UNSAFE_componentWillUpdate(w,Ue,pe)),typeof _.componentDidUpdate=="function"&&(m.flags|=4),typeof _.getSnapshotBeforeUpdate=="function"&&(m.flags|=1024)):(typeof _.componentDidUpdate!="function"||G===d.memoizedProps&&Fe===d.memoizedState||(m.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||G===d.memoizedProps&&Fe===d.memoizedState||(m.flags|=1024),m.memoizedProps=w,m.memoizedState=Ue),_.props=w,_.state=Ue,_.context=pe,w=Xe):(typeof _.componentDidUpdate!="function"||G===d.memoizedProps&&Fe===d.memoizedState||(m.flags|=4),typeof _.getSnapshotBeforeUpdate!="function"||G===d.memoizedProps&&Fe===d.memoizedState||(m.flags|=1024),w=!1)}return _=w,dv(d,m),w=(m.flags&128)!==0,_||w?(_=m.stateNode,g=w&&typeof g.getDerivedStateFromError!="function"?null:_.render(),m.flags|=1,d!==null&&w?(m.child=_d(m,d.child,null,C),m.child=_d(m,null,g,C)):oa(d,m,g,C),m.memoizedState=_.state,d=m.child):d=rc(d,m,C),d}function WD(d,m,g,w){return Nd(),m.flags|=256,oa(d,m,g,w),m.child}var Pk={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Lk(d){return{baseLanes:d,cachePool:RO()}}function Mk(d,m,g){return d=d!==null?d.childLanes&~g:0,m&&(d|=Ii),d}function HD(d,m,g){var w=m.pendingProps,C=!1,_=(m.flags&128)!==0,G;if((G=_)||(G=d!==null&&d.memoizedState===null?!1:(Ys.current&2)!==0),G&&(C=!0,m.flags&=-129),G=(m.flags&32)!==0,m.flags&=-33,d===null){if(_n){if(C?mu(m):fu(),(d=Ns)?(d=J6(d,po),d=d!==null&&d.data!=="&"?d:null,d!==null&&(m.memoizedState={dehydrated:d,treeContext:iu!==null?{id:vl,overflow:wl}:null,retryLane:536870912,hydrationErrors:null},g=jO(d),g.return=m,m.child=g,aa=m,Ns=null)):d=null,d===null)throw lu(m);return vC(d)?m.lanes=32:m.lanes=536870912,null}var ne=w.children;return w=w.fallback,C?(fu(),C=m.mode,ne=hv({mode:"hidden",children:ne},C),w=wd(w,C,g,null),ne.return=m,w.return=m,ne.sibling=w,m.child=ne,w=m.child,w.memoizedState=Lk(g),w.childLanes=Mk(d,G,g),m.memoizedState=Pk,I0(null,w)):(mu(m),Fk(m,ne))}var pe=d.memoizedState;if(pe!==null&&(ne=pe.dehydrated,ne!==null)){if(_)m.flags&256?(mu(m),m.flags&=-257,m=zk(d,m,g)):m.memoizedState!==null?(fu(),m.child=d.child,m.flags|=128,m=null):(fu(),ne=w.fallback,C=m.mode,w=hv({mode:"visible",children:w.children},C),ne=wd(ne,C,g,null),ne.flags|=2,w.return=m,ne.return=m,w.sibling=ne,m.child=w,_d(m,d.child,null,g),w=m.child,w.memoizedState=Lk(g),w.childLanes=Mk(d,G,g),m.memoizedState=Pk,m=I0(null,w));else if(mu(m),vC(ne)){if(G=ne.nextSibling&&ne.nextSibling.dataset,G)var Me=G.dgst;G=Me,w=Error(s(419)),w.stack="",w.digest=G,v0({value:w,source:null,stack:null}),m=zk(d,m,g)}else if(cr||xm(d,m,g,!1),G=(g&d.childLanes)!==0,cr||G){if(G=ms,G!==null&&(w=Ya(G,g),w!==0&&w!==pe.retryLane))throw pe.retryLane=w,vd(d,w),si(G,d,w),Ok;bC(ne)||wv(),m=zk(d,m,g)}else bC(ne)?(m.flags|=192,m.child=d.child,m=null):(d=pe.treeContext,Ns=xo(ne.nextSibling),aa=m,_n=!0,ou=null,po=!1,d!==null&&TO(m,d),m=Fk(m,w.children),m.flags|=4096);return m}return C?(fu(),ne=w.fallback,C=m.mode,pe=d.child,Me=pe.sibling,w=Zl(pe,{mode:"hidden",children:w.children}),w.subtreeFlags=pe.subtreeFlags&65011712,Me!==null?ne=Zl(Me,ne):(ne=wd(ne,C,g,null),ne.flags|=2),ne.return=m,w.return=m,w.sibling=ne,m.child=w,I0(null,w),w=m.child,ne=d.child.memoizedState,ne===null?ne=Lk(g):(C=ne.cachePool,C!==null?(pe=or._currentValue,C=C.parent!==pe?{parent:pe,pool:pe}:C):C=RO(),ne={baseLanes:ne.baseLanes|g,cachePool:C}),w.memoizedState=ne,w.childLanes=Mk(d,G,g),m.memoizedState=Pk,I0(d.child,w)):(mu(m),g=d.child,d=g.sibling,g=Zl(g,{mode:"visible",children:w.children}),g.return=m,g.sibling=null,d!==null&&(G=m.deletions,G===null?(m.deletions=[d],m.flags|=16):G.push(d)),m.child=g,m.memoizedState=null,g)}function Fk(d,m){return m=hv({mode:"visible",children:m},d.mode),m.return=d,d.child=m}function hv(d,m){return d=_i(22,d,null,m),d.lanes=0,d}function zk(d,m,g){return _d(m,d.child,null,g),d=Fk(m,m.pendingProps.children),d.flags|=2,m.memoizedState=null,d}function GD(d,m,g){d.lanes|=m;var w=d.alternate;w!==null&&(w.lanes|=m),tk(d.return,m,g)}function Bk(d,m,g,w,C,_){var G=d.memoizedState;G===null?d.memoizedState={isBackwards:m,rendering:null,renderingStartTime:0,last:w,tail:g,tailMode:C,treeForkCount:_}:(G.isBackwards=m,G.rendering=null,G.renderingStartTime=0,G.last=w,G.tail=g,G.tailMode=C,G.treeForkCount=_)}function qD(d,m,g){var w=m.pendingProps,C=w.revealOrder,_=w.tail;w=w.children;var G=Ys.current,ne=(G&2)!==0;if(ne?(G=G&1|2,m.flags|=128):G&=1,J(Ys,G),oa(d,m,w,g),w=_n?b0:0,!ne&&d!==null&&(d.flags&128)!==0)e:for(d=m.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&GD(d,g,m);else if(d.tag===19)GD(d,g,m);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===m)break e;for(;d.sibling===null;){if(d.return===null||d.return===m)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}switch(C){case"forwards":for(g=m.child,C=null;g!==null;)d=g.alternate,d!==null&&ev(d)===null&&(C=g),g=g.sibling;g=C,g===null?(C=m.child,m.child=null):(C=g.sibling,g.sibling=null),Bk(m,!1,C,g,_,w);break;case"backwards":case"unstable_legacy-backwards":for(g=null,C=m.child,m.child=null;C!==null;){if(d=C.alternate,d!==null&&ev(d)===null){m.child=C;break}d=C.sibling,C.sibling=g,g=C,C=d}Bk(m,!0,g,null,_,w);break;case"together":Bk(m,!1,null,null,void 0,w);break;default:m.memoizedState=null}return m.child}function rc(d,m,g){if(d!==null&&(m.dependencies=d.dependencies),xu|=m.lanes,(g&m.childLanes)===0)if(d!==null){if(xm(d,m,g,!1),(g&m.childLanes)===0)return null}else return null;if(d!==null&&m.child!==d.child)throw Error(s(153));if(m.child!==null){for(d=m.child,g=Zl(d,d.pendingProps),m.child=g,g.return=m;d.sibling!==null;)d=d.sibling,g=g.sibling=Zl(d,d.pendingProps),g.return=m;g.sibling=null}return m.child}function Uk(d,m){return(d.lanes&m)!==0?!0:(d=d.dependencies,!!(d!==null&&Gb(d)))}function BJ(d,m,g){switch(m.tag){case 3:Te(m,m.stateNode.containerInfo),cu(m,or,d.memoizedState.cache),Nd();break;case 27:case 5:Se(m);break;case 4:Te(m,m.stateNode.containerInfo);break;case 10:cu(m,m.type,m.memoizedProps.value);break;case 31:if(m.memoizedState!==null)return m.flags|=128,mk(m),null;break;case 13:var w=m.memoizedState;if(w!==null)return w.dehydrated!==null?(mu(m),m.flags|=128,null):(g&m.child.childLanes)!==0?HD(d,m,g):(mu(m),d=rc(d,m,g),d!==null?d.sibling:null);mu(m);break;case 19:var C=(d.flags&128)!==0;if(w=(g&m.childLanes)!==0,w||(xm(d,m,g,!1),w=(g&m.childLanes)!==0),C){if(w)return qD(d,m,g);m.flags|=128}if(C=m.memoizedState,C!==null&&(C.rendering=null,C.tail=null,C.lastEffect=null),J(Ys,Ys.current),w)break;return null;case 22:return m.lanes=0,FD(d,m,g,m.pendingProps);case 24:cu(m,or,d.memoizedState.cache)}return rc(d,m,g)}function KD(d,m,g){if(d!==null)if(d.memoizedProps!==m.pendingProps)cr=!0;else{if(!Uk(d,g)&&(m.flags&128)===0)return cr=!1,BJ(d,m,g);cr=(d.flags&131072)!==0}else cr=!1,_n&&(m.flags&1048576)!==0&&CO(m,b0,m.index);switch(m.lanes=0,m.tag){case 16:e:{var w=m.pendingProps;if(d=Cd(m.elementType),m.type=d,typeof d=="function")qj(d)?(w=Ad(d,w),m.tag=1,m=VD(null,m,d,w,g)):(m.tag=0,m=Dk(null,m,d,w,g));else{if(d!=null){var C=d.$$typeof;if(C===T){m.tag=11,m=PD(null,m,d,w,g);break e}else if(C===A){m.tag=14,m=LD(null,m,d,w,g);break e}}throw m=q(d)||d,Error(s(306,m,""))}}return m;case 0:return Dk(d,m,m.type,m.pendingProps,g);case 1:return w=m.type,C=Ad(w,m.pendingProps),VD(d,m,w,C,g);case 3:e:{if(Te(m,m.stateNode.containerInfo),d===null)throw Error(s(387));w=m.pendingProps;var _=m.memoizedState;C=_.element,lk(d,m),T0(m,w,null,g);var G=m.memoizedState;if(w=G.cache,cu(m,or,w),w!==_.cache&&nk(m,[or],g,!0),C0(),w=G.element,_.isDehydrated)if(_={element:w,isDehydrated:!1,cache:G.cache},m.updateQueue.baseState=_,m.memoizedState=_,m.flags&256){m=WD(d,m,w,g);break e}else if(w!==C){C=ho(Error(s(424)),m),v0(C),m=WD(d,m,w,g);break e}else{switch(d=m.stateNode.containerInfo,d.nodeType){case 9:d=d.body;break;default:d=d.nodeName==="HTML"?d.ownerDocument.body:d}for(Ns=xo(d.firstChild),aa=m,_n=!0,ou=null,po=!0,g=FO(m,null,w,g),m.child=g;g;)g.flags=g.flags&-3|4096,g=g.sibling}else{if(Nd(),w===C){m=rc(d,m,g);break e}oa(d,m,w,g)}m=m.child}return m;case 26:return dv(d,m),d===null?(g=aP(m.type,null,m.pendingProps,null))?m.memoizedState=g:_n||(g=m.type,d=m.pendingProps,w=_v(fe.current).createElement(g),w[us]=m,w[Ps]=d,la(w,g,d),Xt(w),m.stateNode=w):m.memoizedState=aP(m.type,d.memoizedProps,m.pendingProps,d.memoizedState),null;case 27:return Se(m),d===null&&_n&&(w=m.stateNode=nP(m.type,m.pendingProps,fe.current),aa=m,po=!0,C=Ns,Nu(m.type)?(wC=C,Ns=xo(w.firstChild)):Ns=C),oa(d,m,m.pendingProps.children,g),dv(d,m),d===null&&(m.flags|=4194304),m.child;case 5:return d===null&&_n&&((C=w=Ns)&&(w=xee(w,m.type,m.pendingProps,po),w!==null?(m.stateNode=w,aa=m,Ns=xo(w.firstChild),po=!1,C=!0):C=!1),C||lu(m)),Se(m),C=m.type,_=m.pendingProps,G=d!==null?d.memoizedProps:null,w=_.children,gC(C,_)?w=null:G!==null&&gC(C,G)&&(m.flags|=32),m.memoizedState!==null&&(C=pk(d,m,IJ,null,null,g),q0._currentValue=C),dv(d,m),oa(d,m,w,g),m.child;case 6:return d===null&&_n&&((d=g=Ns)&&(g=yee(g,m.pendingProps,po),g!==null?(m.stateNode=g,aa=m,Ns=null,d=!0):d=!1),d||lu(m)),null;case 13:return HD(d,m,g);case 4:return Te(m,m.stateNode.containerInfo),w=m.pendingProps,d===null?m.child=_d(m,null,w,g):oa(d,m,w,g),m.child;case 11:return PD(d,m,m.type,m.pendingProps,g);case 7:return oa(d,m,m.pendingProps,g),m.child;case 8:return oa(d,m,m.pendingProps.children,g),m.child;case 12:return oa(d,m,m.pendingProps.children,g),m.child;case 10:return w=m.pendingProps,cu(m,m.type,w.value),oa(d,m,w.children,g),m.child;case 9:return C=m.type._context,w=m.pendingProps.children,jd(m),C=ia(C),w=w(C),m.flags|=1,oa(d,m,w,g),m.child;case 14:return LD(d,m,m.type,m.pendingProps,g);case 15:return MD(d,m,m.type,m.pendingProps,g);case 19:return qD(d,m,g);case 31:return zJ(d,m,g);case 22:return FD(d,m,g,m.pendingProps);case 24:return jd(m),w=ia(or),d===null?(C=ak(),C===null&&(C=ms,_=sk(),C.pooledCache=_,_.refCount++,_!==null&&(C.pooledCacheLanes|=g),C=_),m.memoizedState={parent:w,cache:C},ok(m),cu(m,or,C)):((d.lanes&g)!==0&&(lk(d,m),T0(m,null,null,g),C0()),C=d.memoizedState,_=m.memoizedState,C.parent!==w?(C={parent:w,cache:w},m.memoizedState=C,m.lanes===0&&(m.memoizedState=m.updateQueue.baseState=C),cu(m,or,w)):(w=_.cache,cu(m,or,w),w!==C.cache&&nk(m,[or],g,!0))),oa(d,m,m.pendingProps.children,g),m.child;case 29:throw m.pendingProps}throw Error(s(156,m.tag))}function ac(d){d.flags|=4}function Vk(d,m,g,w,C){if((m=(d.mode&32)!==0)&&(m=!1),m){if(d.flags|=16777216,(C&335544128)===C)if(d.stateNode.complete)d.flags|=8192;else if(w6())d.flags|=8192;else throw Td=Yb,ik}else d.flags&=-16777217}function XD(d,m){if(m.type!=="stylesheet"||(m.state.loading&4)!==0)d.flags&=-16777217;else if(d.flags|=16777216,!uP(m))if(w6())d.flags|=8192;else throw Td=Yb,ik}function mv(d,m){m!==null&&(d.flags|=4),d.flags&16384&&(m=d.tag!==22?Aa():536870912,d.lanes|=m,Em|=m)}function R0(d,m){if(!_n)switch(d.tailMode){case"hidden":m=d.tail;for(var g=null;m!==null;)m.alternate!==null&&(g=m),m=m.sibling;g===null?d.tail=null:g.sibling=null;break;case"collapsed":g=d.tail;for(var w=null;g!==null;)g.alternate!==null&&(w=g),g=g.sibling;w===null?m||d.tail===null?d.tail=null:d.tail.sibling=null:w.sibling=null}}function Ss(d){var m=d.alternate!==null&&d.alternate.child===d.child,g=0,w=0;if(m)for(var C=d.child;C!==null;)g|=C.lanes|C.childLanes,w|=C.subtreeFlags&65011712,w|=C.flags&65011712,C.return=d,C=C.sibling;else for(C=d.child;C!==null;)g|=C.lanes|C.childLanes,w|=C.subtreeFlags,w|=C.flags,C.return=d,C=C.sibling;return d.subtreeFlags|=w,d.childLanes=g,m}function UJ(d,m,g){var w=m.pendingProps;switch(Qj(m),m.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ss(m),null;case 1:return Ss(m),null;case 3:return g=m.stateNode,w=null,d!==null&&(w=d.memoizedState.cache),m.memoizedState.cache!==w&&(m.flags|=2048),tc(or),oe(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(d===null||d.child===null)&&(gm(m)?ac(m):d===null||d.memoizedState.isDehydrated&&(m.flags&256)===0||(m.flags|=1024,Jj())),Ss(m),null;case 26:var C=m.type,_=m.memoizedState;return d===null?(ac(m),_!==null?(Ss(m),XD(m,_)):(Ss(m),Vk(m,C,null,w,g))):_?_!==d.memoizedState?(ac(m),Ss(m),XD(m,_)):(Ss(m),m.flags&=-16777217):(d=d.memoizedProps,d!==w&&ac(m),Ss(m),Vk(m,C,d,w,g)),null;case 27:if(ke(m),g=fe.current,C=m.type,d!==null&&m.stateNode!=null)d.memoizedProps!==w&&ac(m);else{if(!w){if(m.stateNode===null)throw Error(s(166));return Ss(m),null}d=se.current,gm(m)?_O(m):(d=nP(C,w,g),m.stateNode=d,ac(m))}return Ss(m),null;case 5:if(ke(m),C=m.type,d!==null&&m.stateNode!=null)d.memoizedProps!==w&&ac(m);else{if(!w){if(m.stateNode===null)throw Error(s(166));return Ss(m),null}if(_=se.current,gm(m))_O(m);else{var G=_v(fe.current);switch(_){case 1:_=G.createElementNS("http://www.w3.org/2000/svg",C);break;case 2:_=G.createElementNS("http://www.w3.org/1998/Math/MathML",C);break;default:switch(C){case"svg":_=G.createElementNS("http://www.w3.org/2000/svg",C);break;case"math":_=G.createElementNS("http://www.w3.org/1998/Math/MathML",C);break;case"script":_=G.createElement("div"),_.innerHTML="<script><\/script>",_=_.removeChild(_.firstChild);break;case"select":_=typeof w.is=="string"?G.createElement("select",{is:w.is}):G.createElement("select"),w.multiple?_.multiple=!0:w.size&&(_.size=w.size);break;default:_=typeof w.is=="string"?G.createElement(C,{is:w.is}):G.createElement(C)}}_[us]=m,_[Ps]=w;e:for(G=m.child;G!==null;){if(G.tag===5||G.tag===6)_.appendChild(G.stateNode);else if(G.tag!==4&&G.tag!==27&&G.child!==null){G.child.return=G,G=G.child;continue}if(G===m)break e;for(;G.sibling===null;){if(G.return===null||G.return===m)break e;G=G.return}G.sibling.return=G.return,G=G.sibling}m.stateNode=_;e:switch(la(_,C,w),C){case"button":case"input":case"select":case"textarea":w=!!w.autoFocus;break e;case"img":w=!0;break e;default:w=!1}w&&ac(m)}}return Ss(m),Vk(m,m.type,d===null?null:d.memoizedProps,m.pendingProps,g),null;case 6:if(d&&m.stateNode!=null)d.memoizedProps!==w&&ac(m);else{if(typeof w!="string"&&m.stateNode===null)throw Error(s(166));if(d=fe.current,gm(m)){if(d=m.stateNode,g=m.memoizedProps,w=null,C=aa,C!==null)switch(C.tag){case 27:case 5:w=C.memoizedProps}d[us]=m,d=!!(d.nodeValue===g||w!==null&&w.suppressHydrationWarning===!0||H6(d.nodeValue,g)),d||lu(m,!0)}else d=_v(d).createTextNode(w),d[us]=m,m.stateNode=d}return Ss(m),null;case 31:if(g=m.memoizedState,d===null||d.memoizedState!==null){if(w=gm(m),g!==null){if(d===null){if(!w)throw Error(s(318));if(d=m.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(s(557));d[us]=m}else Nd(),(m.flags&128)===0&&(m.memoizedState=null),m.flags|=4;Ss(m),d=!1}else g=Jj(),d!==null&&d.memoizedState!==null&&(d.memoizedState.hydrationErrors=g),d=!0;if(!d)return m.flags&256?(Ai(m),m):(Ai(m),null);if((m.flags&128)!==0)throw Error(s(558))}return Ss(m),null;case 13:if(w=m.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(C=gm(m),w!==null&&w.dehydrated!==null){if(d===null){if(!C)throw Error(s(318));if(C=m.memoizedState,C=C!==null?C.dehydrated:null,!C)throw Error(s(317));C[us]=m}else Nd(),(m.flags&128)===0&&(m.memoizedState=null),m.flags|=4;Ss(m),C=!1}else C=Jj(),d!==null&&d.memoizedState!==null&&(d.memoizedState.hydrationErrors=C),C=!0;if(!C)return m.flags&256?(Ai(m),m):(Ai(m),null)}return Ai(m),(m.flags&128)!==0?(m.lanes=g,m):(g=w!==null,d=d!==null&&d.memoizedState!==null,g&&(w=m.child,C=null,w.alternate!==null&&w.alternate.memoizedState!==null&&w.alternate.memoizedState.cachePool!==null&&(C=w.alternate.memoizedState.cachePool.pool),_=null,w.memoizedState!==null&&w.memoizedState.cachePool!==null&&(_=w.memoizedState.cachePool.pool),_!==C&&(w.flags|=2048)),g!==d&&g&&(m.child.flags|=8192),mv(m,m.updateQueue),Ss(m),null);case 4:return oe(),d===null&&dC(m.stateNode.containerInfo),Ss(m),null;case 10:return tc(m.type),Ss(m),null;case 19:if(U(Ys),w=m.memoizedState,w===null)return Ss(m),null;if(C=(m.flags&128)!==0,_=w.rendering,_===null)if(C)R0(w,!1);else{if(Bs!==0||d!==null&&(d.flags&128)!==0)for(d=m.child;d!==null;){if(_=ev(d),_!==null){for(m.flags|=128,R0(w,!1),d=_.updateQueue,m.updateQueue=d,mv(m,d),m.subtreeFlags=0,d=g,g=m.child;g!==null;)SO(g,d),g=g.sibling;return J(Ys,Ys.current&1|2),_n&&Jl(m,w.treeForkCount),m.child}d=d.sibling}w.tail!==null&&Oe()>yv&&(m.flags|=128,C=!0,R0(w,!1),m.lanes=4194304)}else{if(!C)if(d=ev(_),d!==null){if(m.flags|=128,C=!0,d=d.updateQueue,m.updateQueue=d,mv(m,d),R0(w,!0),w.tail===null&&w.tailMode==="hidden"&&!_.alternate&&!_n)return Ss(m),null}else 2*Oe()-w.renderingStartTime>yv&&g!==536870912&&(m.flags|=128,C=!0,R0(w,!1),m.lanes=4194304);w.isBackwards?(_.sibling=m.child,m.child=_):(d=w.last,d!==null?d.sibling=_:m.child=_,w.last=_)}return w.tail!==null?(d=w.tail,w.rendering=d,w.tail=d.sibling,w.renderingStartTime=Oe(),d.sibling=null,g=Ys.current,J(Ys,C?g&1|2:g&1),_n&&Jl(m,w.treeForkCount),d):(Ss(m),null);case 22:case 23:return Ai(m),hk(),w=m.memoizedState!==null,d!==null?d.memoizedState!==null!==w&&(m.flags|=8192):w&&(m.flags|=8192),w?(g&536870912)!==0&&(m.flags&128)===0&&(Ss(m),m.subtreeFlags&6&&(m.flags|=8192)):Ss(m),g=m.updateQueue,g!==null&&mv(m,g.retryQueue),g=null,d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(g=d.memoizedState.cachePool.pool),w=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(w=m.memoizedState.cachePool.pool),w!==g&&(m.flags|=2048),d!==null&&U(kd),null;case 24:return g=null,d!==null&&(g=d.memoizedState.cache),m.memoizedState.cache!==g&&(m.flags|=2048),tc(or),Ss(m),null;case 25:return null;case 30:return null}throw Error(s(156,m.tag))}function VJ(d,m){switch(Qj(m),m.tag){case 1:return d=m.flags,d&65536?(m.flags=d&-65537|128,m):null;case 3:return tc(or),oe(),d=m.flags,(d&65536)!==0&&(d&128)===0?(m.flags=d&-65537|128,m):null;case 26:case 27:case 5:return ke(m),null;case 31:if(m.memoizedState!==null){if(Ai(m),m.alternate===null)throw Error(s(340));Nd()}return d=m.flags,d&65536?(m.flags=d&-65537|128,m):null;case 13:if(Ai(m),d=m.memoizedState,d!==null&&d.dehydrated!==null){if(m.alternate===null)throw Error(s(340));Nd()}return d=m.flags,d&65536?(m.flags=d&-65537|128,m):null;case 19:return U(Ys),null;case 4:return oe(),null;case 10:return tc(m.type),null;case 22:case 23:return Ai(m),hk(),d!==null&&U(kd),d=m.flags,d&65536?(m.flags=d&-65537|128,m):null;case 24:return tc(or),null;case 25:return null;default:return null}}function YD(d,m){switch(Qj(m),m.tag){case 3:tc(or),oe();break;case 26:case 27:case 5:ke(m);break;case 4:oe();break;case 31:m.memoizedState!==null&&Ai(m);break;case 13:Ai(m);break;case 19:U(Ys);break;case 10:tc(m.type);break;case 22:case 23:Ai(m),hk(),d!==null&&U(kd);break;case 24:tc(or)}}function O0(d,m){try{var g=m.updateQueue,w=g!==null?g.lastEffect:null;if(w!==null){var C=w.next;g=C;do{if((g.tag&d)===d){w=void 0;var _=g.create,G=g.inst;w=_(),G.destroy=w}g=g.next}while(g!==C)}}catch(ne){Yn(m,m.return,ne)}}function pu(d,m,g){try{var w=m.updateQueue,C=w!==null?w.lastEffect:null;if(C!==null){var _=C.next;w=_;do{if((w.tag&d)===d){var G=w.inst,ne=G.destroy;if(ne!==void 0){G.destroy=void 0,C=m;var pe=g,Me=ne;try{Me()}catch(Xe){Yn(C,pe,Xe)}}}w=w.next}while(w!==_)}}catch(Xe){Yn(m,m.return,Xe)}}function QD(d){var m=d.updateQueue;if(m!==null){var g=d.stateNode;try{BO(m,g)}catch(w){Yn(d,d.return,w)}}}function ZD(d,m,g){g.props=Ad(d.type,d.memoizedProps),g.state=d.memoizedState;try{g.componentWillUnmount()}catch(w){Yn(d,m,w)}}function D0(d,m){try{var g=d.ref;if(g!==null){switch(d.tag){case 26:case 27:case 5:var w=d.stateNode;break;case 30:w=d.stateNode;break;default:w=d.stateNode}typeof g=="function"?d.refCleanup=g(w):g.current=w}}catch(C){Yn(d,m,C)}}function Nl(d,m){var g=d.ref,w=d.refCleanup;if(g!==null)if(typeof w=="function")try{w()}catch(C){Yn(d,m,C)}finally{d.refCleanup=null,d=d.alternate,d!=null&&(d.refCleanup=null)}else if(typeof g=="function")try{g(null)}catch(C){Yn(d,m,C)}else g.current=null}function JD(d){var m=d.type,g=d.memoizedProps,w=d.stateNode;try{e:switch(m){case"button":case"input":case"select":case"textarea":g.autoFocus&&w.focus();break e;case"img":g.src?w.src=g.src:g.srcSet&&(w.srcset=g.srcSet)}}catch(C){Yn(d,d.return,C)}}function Wk(d,m,g){try{var w=d.stateNode;dee(w,d.type,g,m),w[Ps]=m}catch(C){Yn(d,d.return,C)}}function e6(d){return d.tag===5||d.tag===3||d.tag===26||d.tag===27&&Nu(d.type)||d.tag===4}function Hk(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||e6(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.tag===27&&Nu(d.type)||d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function Gk(d,m,g){var w=d.tag;if(w===5||w===6)d=d.stateNode,m?(g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g).insertBefore(d,m):(m=g.nodeType===9?g.body:g.nodeName==="HTML"?g.ownerDocument.body:g,m.appendChild(d),g=g._reactRootContainer,g!=null||m.onclick!==null||(m.onclick=Ci));else if(w!==4&&(w===27&&Nu(d.type)&&(g=d.stateNode,m=null),d=d.child,d!==null))for(Gk(d,m,g),d=d.sibling;d!==null;)Gk(d,m,g),d=d.sibling}function fv(d,m,g){var w=d.tag;if(w===5||w===6)d=d.stateNode,m?g.insertBefore(d,m):g.appendChild(d);else if(w!==4&&(w===27&&Nu(d.type)&&(g=d.stateNode),d=d.child,d!==null))for(fv(d,m,g),d=d.sibling;d!==null;)fv(d,m,g),d=d.sibling}function t6(d){var m=d.stateNode,g=d.memoizedProps;try{for(var w=d.type,C=m.attributes;C.length;)m.removeAttributeNode(C[0]);la(m,w,g),m[us]=d,m[Ps]=g}catch(_){Yn(d,d.return,_)}}var ic=!1,ur=!1,qk=!1,n6=typeof WeakSet=="function"?WeakSet:Set,Mr=null;function WJ(d,m){if(d=d.containerInfo,fC=Dv,d=fO(d),zj(d)){if("selectionStart"in d)var g={start:d.selectionStart,end:d.selectionEnd};else e:{g=(g=d.ownerDocument)&&g.defaultView||window;var w=g.getSelection&&g.getSelection();if(w&&w.rangeCount!==0){g=w.anchorNode;var C=w.anchorOffset,_=w.focusNode;w=w.focusOffset;try{g.nodeType,_.nodeType}catch{g=null;break e}var G=0,ne=-1,pe=-1,Me=0,Xe=0,et=d,Fe=null;t:for(;;){for(var Ue;et!==g||C!==0&&et.nodeType!==3||(ne=G+C),et!==_||w!==0&&et.nodeType!==3||(pe=G+w),et.nodeType===3&&(G+=et.nodeValue.length),(Ue=et.firstChild)!==null;)Fe=et,et=Ue;for(;;){if(et===d)break t;if(Fe===g&&++Me===C&&(ne=G),Fe===_&&++Xe===w&&(pe=G),(Ue=et.nextSibling)!==null)break;et=Fe,Fe=et.parentNode}et=Ue}g=ne===-1||pe===-1?null:{start:ne,end:pe}}else g=null}g=g||{start:0,end:0}}else g=null;for(pC={focusedElem:d,selectionRange:g},Dv=!1,Mr=m;Mr!==null;)if(m=Mr,d=m.child,(m.subtreeFlags&1028)!==0&&d!==null)d.return=m,Mr=d;else for(;Mr!==null;){switch(m=Mr,_=m.alternate,d=m.flags,m.tag){case 0:if((d&4)!==0&&(d=m.updateQueue,d=d!==null?d.events:null,d!==null))for(g=0;g<d.length;g++)C=d[g],C.ref.impl=C.nextImpl;break;case 11:case 15:break;case 1:if((d&1024)!==0&&_!==null){d=void 0,g=m,C=_.memoizedProps,_=_.memoizedState,w=g.stateNode;try{var Rt=Ad(g.type,C);d=w.getSnapshotBeforeUpdate(Rt,_),w.__reactInternalSnapshotBeforeUpdate=d}catch(Kt){Yn(g,g.return,Kt)}}break;case 3:if((d&1024)!==0){if(d=m.stateNode.containerInfo,g=d.nodeType,g===9)yC(d);else if(g===1)switch(d.nodeName){case"HEAD":case"HTML":case"BODY":yC(d);break;default:d.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((d&1024)!==0)throw Error(s(163))}if(d=m.sibling,d!==null){d.return=m.return,Mr=d;break}Mr=m.return}}function s6(d,m,g){var w=g.flags;switch(g.tag){case 0:case 11:case 15:lc(d,g),w&4&&O0(5,g);break;case 1:if(lc(d,g),w&4)if(d=g.stateNode,m===null)try{d.componentDidMount()}catch(G){Yn(g,g.return,G)}else{var C=Ad(g.type,m.memoizedProps);m=m.memoizedState;try{d.componentDidUpdate(C,m,d.__reactInternalSnapshotBeforeUpdate)}catch(G){Yn(g,g.return,G)}}w&64&&QD(g),w&512&&D0(g,g.return);break;case 3:if(lc(d,g),w&64&&(d=g.updateQueue,d!==null)){if(m=null,g.child!==null)switch(g.child.tag){case 27:case 5:m=g.child.stateNode;break;case 1:m=g.child.stateNode}try{BO(d,m)}catch(G){Yn(g,g.return,G)}}break;case 27:m===null&&w&4&&t6(g);case 26:case 5:lc(d,g),m===null&&w&4&&JD(g),w&512&&D0(g,g.return);break;case 12:lc(d,g);break;case 31:lc(d,g),w&4&&i6(d,g);break;case 13:lc(d,g),w&4&&o6(d,g),w&64&&(d=g.memoizedState,d!==null&&(d=d.dehydrated,d!==null&&(g=JJ.bind(null,g),bee(d,g))));break;case 22:if(w=g.memoizedState!==null||ic,!w){m=m!==null&&m.memoizedState!==null||ur,C=ic;var _=ur;ic=w,(ur=m)&&!_?cc(d,g,(g.subtreeFlags&8772)!==0):lc(d,g),ic=C,ur=_}break;case 30:break;default:lc(d,g)}}function r6(d){var m=d.alternate;m!==null&&(d.alternate=null,r6(m)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(m=d.stateNode,m!==null&&st(m)),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}var Ts=null,Ja=!1;function oc(d,m,g){for(g=g.child;g!==null;)a6(d,m,g),g=g.sibling}function a6(d,m,g){if(xt&&typeof xt.onCommitFiberUnmount=="function")try{xt.onCommitFiberUnmount(De,g)}catch{}switch(g.tag){case 26:ur||Nl(g,m),oc(d,m,g),g.memoizedState?g.memoizedState.count--:g.stateNode&&(g=g.stateNode,g.parentNode.removeChild(g));break;case 27:ur||Nl(g,m);var w=Ts,C=Ja;Nu(g.type)&&(Ts=g.stateNode,Ja=!1),oc(d,m,g),W0(g.stateNode),Ts=w,Ja=C;break;case 5:ur||Nl(g,m);case 6:if(w=Ts,C=Ja,Ts=null,oc(d,m,g),Ts=w,Ja=C,Ts!==null)if(Ja)try{(Ts.nodeType===9?Ts.body:Ts.nodeName==="HTML"?Ts.ownerDocument.body:Ts).removeChild(g.stateNode)}catch(_){Yn(g,m,_)}else try{Ts.removeChild(g.stateNode)}catch(_){Yn(g,m,_)}break;case 18:Ts!==null&&(Ja?(d=Ts,Q6(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,g.stateNode),Lm(d)):Q6(Ts,g.stateNode));break;case 4:w=Ts,C=Ja,Ts=g.stateNode.containerInfo,Ja=!0,oc(d,m,g),Ts=w,Ja=C;break;case 0:case 11:case 14:case 15:pu(2,g,m),ur||pu(4,g,m),oc(d,m,g);break;case 1:ur||(Nl(g,m),w=g.stateNode,typeof w.componentWillUnmount=="function"&&ZD(g,m,w)),oc(d,m,g);break;case 21:oc(d,m,g);break;case 22:ur=(w=ur)||g.memoizedState!==null,oc(d,m,g),ur=w;break;default:oc(d,m,g)}}function i6(d,m){if(m.memoizedState===null&&(d=m.alternate,d!==null&&(d=d.memoizedState,d!==null))){d=d.dehydrated;try{Lm(d)}catch(g){Yn(m,m.return,g)}}}function o6(d,m){if(m.memoizedState===null&&(d=m.alternate,d!==null&&(d=d.memoizedState,d!==null&&(d=d.dehydrated,d!==null))))try{Lm(d)}catch(g){Yn(m,m.return,g)}}function HJ(d){switch(d.tag){case 31:case 13:case 19:var m=d.stateNode;return m===null&&(m=d.stateNode=new n6),m;case 22:return d=d.stateNode,m=d._retryCache,m===null&&(m=d._retryCache=new n6),m;default:throw Error(s(435,d.tag))}}function pv(d,m){var g=HJ(d);m.forEach(function(w){if(!g.has(w)){g.add(w);var C=eee.bind(null,d,w);w.then(C,C)}})}function ei(d,m){var g=m.deletions;if(g!==null)for(var w=0;w<g.length;w++){var C=g[w],_=d,G=m,ne=G;e:for(;ne!==null;){switch(ne.tag){case 27:if(Nu(ne.type)){Ts=ne.stateNode,Ja=!1;break e}break;case 5:Ts=ne.stateNode,Ja=!1;break e;case 3:case 4:Ts=ne.stateNode.containerInfo,Ja=!0;break e}ne=ne.return}if(Ts===null)throw Error(s(160));a6(_,G,C),Ts=null,Ja=!1,_=C.alternate,_!==null&&(_.return=null),C.return=null}if(m.subtreeFlags&13886)for(m=m.child;m!==null;)l6(m,d),m=m.sibling}var Go=null;function l6(d,m){var g=d.alternate,w=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:ei(m,d),ti(d),w&4&&(pu(3,d,d.return),O0(3,d),pu(5,d,d.return));break;case 1:ei(m,d),ti(d),w&512&&(ur||g===null||Nl(g,g.return)),w&64&&ic&&(d=d.updateQueue,d!==null&&(w=d.callbacks,w!==null&&(g=d.shared.hiddenCallbacks,d.shared.hiddenCallbacks=g===null?w:g.concat(w))));break;case 26:var C=Go;if(ei(m,d),ti(d),w&512&&(ur||g===null||Nl(g,g.return)),w&4){var _=g!==null?g.memoizedState:null;if(w=d.memoizedState,g===null)if(w===null)if(d.stateNode===null){e:{w=d.type,g=d.memoizedProps,C=C.ownerDocument||C;t:switch(w){case"title":_=C.getElementsByTagName("title")[0],(!_||_[ot]||_[us]||_.namespaceURI==="http://www.w3.org/2000/svg"||_.hasAttribute("itemprop"))&&(_=C.createElement(w),C.head.insertBefore(_,C.querySelector("head > title"))),la(_,w,g),_[us]=d,Xt(_),w=_;break e;case"link":var G=lP("link","href",C).get(w+(g.href||""));if(G){for(var ne=0;ne<G.length;ne++)if(_=G[ne],_.getAttribute("href")===(g.href==null||g.href===""?null:g.href)&&_.getAttribute("rel")===(g.rel==null?null:g.rel)&&_.getAttribute("title")===(g.title==null?null:g.title)&&_.getAttribute("crossorigin")===(g.crossOrigin==null?null:g.crossOrigin)){G.splice(ne,1);break t}}_=C.createElement(w),la(_,w,g),C.head.appendChild(_);break;case"meta":if(G=lP("meta","content",C).get(w+(g.content||""))){for(ne=0;ne<G.length;ne++)if(_=G[ne],_.getAttribute("content")===(g.content==null?null:""+g.content)&&_.getAttribute("name")===(g.name==null?null:g.name)&&_.getAttribute("property")===(g.property==null?null:g.property)&&_.getAttribute("http-equiv")===(g.httpEquiv==null?null:g.httpEquiv)&&_.getAttribute("charset")===(g.charSet==null?null:g.charSet)){G.splice(ne,1);break t}}_=C.createElement(w),la(_,w,g),C.head.appendChild(_);break;default:throw Error(s(468,w))}_[us]=d,Xt(_),w=_}d.stateNode=w}else cP(C,d.type,d.stateNode);else d.stateNode=oP(C,w,d.memoizedProps);else _!==w?(_===null?g.stateNode!==null&&(g=g.stateNode,g.parentNode.removeChild(g)):_.count--,w===null?cP(C,d.type,d.stateNode):oP(C,w,d.memoizedProps)):w===null&&d.stateNode!==null&&Wk(d,d.memoizedProps,g.memoizedProps)}break;case 27:ei(m,d),ti(d),w&512&&(ur||g===null||Nl(g,g.return)),g!==null&&w&4&&Wk(d,d.memoizedProps,g.memoizedProps);break;case 5:if(ei(m,d),ti(d),w&512&&(ur||g===null||Nl(g,g.return)),d.flags&32){C=d.stateNode;try{ru(C,"")}catch(Rt){Yn(d,d.return,Rt)}}w&4&&d.stateNode!=null&&(C=d.memoizedProps,Wk(d,C,g!==null?g.memoizedProps:C)),w&1024&&(qk=!0);break;case 6:if(ei(m,d),ti(d),w&4){if(d.stateNode===null)throw Error(s(162));w=d.memoizedProps,g=d.stateNode;try{g.nodeValue=w}catch(Rt){Yn(d,d.return,Rt)}}break;case 3:if($v=null,C=Go,Go=Ev(m.containerInfo),ei(m,d),Go=C,ti(d),w&4&&g!==null&&g.memoizedState.isDehydrated)try{Lm(m.containerInfo)}catch(Rt){Yn(d,d.return,Rt)}qk&&(qk=!1,c6(d));break;case 4:w=Go,Go=Ev(d.stateNode.containerInfo),ei(m,d),ti(d),Go=w;break;case 12:ei(m,d),ti(d);break;case 31:ei(m,d),ti(d),w&4&&(w=d.updateQueue,w!==null&&(d.updateQueue=null,pv(d,w)));break;case 13:ei(m,d),ti(d),d.child.flags&8192&&d.memoizedState!==null!=(g!==null&&g.memoizedState!==null)&&(xv=Oe()),w&4&&(w=d.updateQueue,w!==null&&(d.updateQueue=null,pv(d,w)));break;case 22:C=d.memoizedState!==null;var pe=g!==null&&g.memoizedState!==null,Me=ic,Xe=ur;if(ic=Me||C,ur=Xe||pe,ei(m,d),ur=Xe,ic=Me,ti(d),w&8192)e:for(m=d.stateNode,m._visibility=C?m._visibility&-2:m._visibility|1,C&&(g===null||pe||ic||ur||$d(d)),g=null,m=d;;){if(m.tag===5||m.tag===26){if(g===null){pe=g=m;try{if(_=pe.stateNode,C)G=_.style,typeof G.setProperty=="function"?G.setProperty("display","none","important"):G.display="none";else{ne=pe.stateNode;var et=pe.memoizedProps.style,Fe=et!=null&&et.hasOwnProperty("display")?et.display:null;ne.style.display=Fe==null||typeof Fe=="boolean"?"":(""+Fe).trim()}}catch(Rt){Yn(pe,pe.return,Rt)}}}else if(m.tag===6){if(g===null){pe=m;try{pe.stateNode.nodeValue=C?"":pe.memoizedProps}catch(Rt){Yn(pe,pe.return,Rt)}}}else if(m.tag===18){if(g===null){pe=m;try{var Ue=pe.stateNode;C?Z6(Ue,!0):Z6(pe.stateNode,!1)}catch(Rt){Yn(pe,pe.return,Rt)}}}else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===d)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===d)break e;for(;m.sibling===null;){if(m.return===null||m.return===d)break e;g===m&&(g=null),m=m.return}g===m&&(g=null),m.sibling.return=m.return,m=m.sibling}w&4&&(w=d.updateQueue,w!==null&&(g=w.retryQueue,g!==null&&(w.retryQueue=null,pv(d,g))));break;case 19:ei(m,d),ti(d),w&4&&(w=d.updateQueue,w!==null&&(d.updateQueue=null,pv(d,w)));break;case 30:break;case 21:break;default:ei(m,d),ti(d)}}function ti(d){var m=d.flags;if(m&2){try{for(var g,w=d.return;w!==null;){if(e6(w)){g=w;break}w=w.return}if(g==null)throw Error(s(160));switch(g.tag){case 27:var C=g.stateNode,_=Hk(d);fv(d,_,C);break;case 5:var G=g.stateNode;g.flags&32&&(ru(G,""),g.flags&=-33);var ne=Hk(d);fv(d,ne,G);break;case 3:case 4:var pe=g.stateNode.containerInfo,Me=Hk(d);Gk(d,Me,pe);break;default:throw Error(s(161))}}catch(Xe){Yn(d,d.return,Xe)}d.flags&=-3}m&4096&&(d.flags&=-4097)}function c6(d){if(d.subtreeFlags&1024)for(d=d.child;d!==null;){var m=d;c6(m),m.tag===5&&m.flags&1024&&m.stateNode.reset(),d=d.sibling}}function lc(d,m){if(m.subtreeFlags&8772)for(m=m.child;m!==null;)s6(d,m.alternate,m),m=m.sibling}function $d(d){for(d=d.child;d!==null;){var m=d;switch(m.tag){case 0:case 11:case 14:case 15:pu(4,m,m.return),$d(m);break;case 1:Nl(m,m.return);var g=m.stateNode;typeof g.componentWillUnmount=="function"&&ZD(m,m.return,g),$d(m);break;case 27:W0(m.stateNode);case 26:case 5:Nl(m,m.return),$d(m);break;case 22:m.memoizedState===null&&$d(m);break;case 30:$d(m);break;default:$d(m)}d=d.sibling}}function cc(d,m,g){for(g=g&&(m.subtreeFlags&8772)!==0,m=m.child;m!==null;){var w=m.alternate,C=d,_=m,G=_.flags;switch(_.tag){case 0:case 11:case 15:cc(C,_,g),O0(4,_);break;case 1:if(cc(C,_,g),w=_,C=w.stateNode,typeof C.componentDidMount=="function")try{C.componentDidMount()}catch(Me){Yn(w,w.return,Me)}if(w=_,C=w.updateQueue,C!==null){var ne=w.stateNode;try{var pe=C.shared.hiddenCallbacks;if(pe!==null)for(C.shared.hiddenCallbacks=null,C=0;C<pe.length;C++)zO(pe[C],ne)}catch(Me){Yn(w,w.return,Me)}}g&&G&64&&QD(_),D0(_,_.return);break;case 27:t6(_);case 26:case 5:cc(C,_,g),g&&w===null&&G&4&&JD(_),D0(_,_.return);break;case 12:cc(C,_,g);break;case 31:cc(C,_,g),g&&G&4&&i6(C,_);break;case 13:cc(C,_,g),g&&G&4&&o6(C,_);break;case 22:_.memoizedState===null&&cc(C,_,g),D0(_,_.return);break;case 30:break;default:cc(C,_,g)}m=m.sibling}}function Kk(d,m){var g=null;d!==null&&d.memoizedState!==null&&d.memoizedState.cachePool!==null&&(g=d.memoizedState.cachePool.pool),d=null,m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(d=m.memoizedState.cachePool.pool),d!==g&&(d!=null&&d.refCount++,g!=null&&w0(g))}function Xk(d,m){d=null,m.alternate!==null&&(d=m.alternate.memoizedState.cache),m=m.memoizedState.cache,m!==d&&(m.refCount++,d!=null&&w0(d))}function qo(d,m,g,w){if(m.subtreeFlags&10256)for(m=m.child;m!==null;)u6(d,m,g,w),m=m.sibling}function u6(d,m,g,w){var C=m.flags;switch(m.tag){case 0:case 11:case 15:qo(d,m,g,w),C&2048&&O0(9,m);break;case 1:qo(d,m,g,w);break;case 3:qo(d,m,g,w),C&2048&&(d=null,m.alternate!==null&&(d=m.alternate.memoizedState.cache),m=m.memoizedState.cache,m!==d&&(m.refCount++,d!=null&&w0(d)));break;case 12:if(C&2048){qo(d,m,g,w),d=m.stateNode;try{var _=m.memoizedProps,G=_.id,ne=_.onPostCommit;typeof ne=="function"&&ne(G,m.alternate===null?"mount":"update",d.passiveEffectDuration,-0)}catch(pe){Yn(m,m.return,pe)}}else qo(d,m,g,w);break;case 31:qo(d,m,g,w);break;case 13:qo(d,m,g,w);break;case 23:break;case 22:_=m.stateNode,G=m.alternate,m.memoizedState!==null?_._visibility&2?qo(d,m,g,w):P0(d,m):_._visibility&2?qo(d,m,g,w):(_._visibility|=2,Cm(d,m,g,w,(m.subtreeFlags&10256)!==0||!1)),C&2048&&Kk(G,m);break;case 24:qo(d,m,g,w),C&2048&&Xk(m.alternate,m);break;default:qo(d,m,g,w)}}function Cm(d,m,g,w,C){for(C=C&&((m.subtreeFlags&10256)!==0||!1),m=m.child;m!==null;){var _=d,G=m,ne=g,pe=w,Me=G.flags;switch(G.tag){case 0:case 11:case 15:Cm(_,G,ne,pe,C),O0(8,G);break;case 23:break;case 22:var Xe=G.stateNode;G.memoizedState!==null?Xe._visibility&2?Cm(_,G,ne,pe,C):P0(_,G):(Xe._visibility|=2,Cm(_,G,ne,pe,C)),C&&Me&2048&&Kk(G.alternate,G);break;case 24:Cm(_,G,ne,pe,C),C&&Me&2048&&Xk(G.alternate,G);break;default:Cm(_,G,ne,pe,C)}m=m.sibling}}function P0(d,m){if(m.subtreeFlags&10256)for(m=m.child;m!==null;){var g=d,w=m,C=w.flags;switch(w.tag){case 22:P0(g,w),C&2048&&Kk(w.alternate,w);break;case 24:P0(g,w),C&2048&&Xk(w.alternate,w);break;default:P0(g,w)}m=m.sibling}}var L0=8192;function Tm(d,m,g){if(d.subtreeFlags&L0)for(d=d.child;d!==null;)d6(d,m,g),d=d.sibling}function d6(d,m,g){switch(d.tag){case 26:Tm(d,m,g),d.flags&L0&&d.memoizedState!==null&&$ee(g,Go,d.memoizedState,d.memoizedProps);break;case 5:Tm(d,m,g);break;case 3:case 4:var w=Go;Go=Ev(d.stateNode.containerInfo),Tm(d,m,g),Go=w;break;case 22:d.memoizedState===null&&(w=d.alternate,w!==null&&w.memoizedState!==null?(w=L0,L0=16777216,Tm(d,m,g),L0=w):Tm(d,m,g));break;default:Tm(d,m,g)}}function h6(d){var m=d.alternate;if(m!==null&&(d=m.child,d!==null)){m.child=null;do m=d.sibling,d.sibling=null,d=m;while(d!==null)}}function M0(d){var m=d.deletions;if((d.flags&16)!==0){if(m!==null)for(var g=0;g<m.length;g++){var w=m[g];Mr=w,f6(w,d)}h6(d)}if(d.subtreeFlags&10256)for(d=d.child;d!==null;)m6(d),d=d.sibling}function m6(d){switch(d.tag){case 0:case 11:case 15:M0(d),d.flags&2048&&pu(9,d,d.return);break;case 3:M0(d);break;case 12:M0(d);break;case 22:var m=d.stateNode;d.memoizedState!==null&&m._visibility&2&&(d.return===null||d.return.tag!==13)?(m._visibility&=-3,gv(d)):M0(d);break;default:M0(d)}}function gv(d){var m=d.deletions;if((d.flags&16)!==0){if(m!==null)for(var g=0;g<m.length;g++){var w=m[g];Mr=w,f6(w,d)}h6(d)}for(d=d.child;d!==null;){switch(m=d,m.tag){case 0:case 11:case 15:pu(8,m,m.return),gv(m);break;case 22:g=m.stateNode,g._visibility&2&&(g._visibility&=-3,gv(m));break;default:gv(m)}d=d.sibling}}function f6(d,m){for(;Mr!==null;){var g=Mr;switch(g.tag){case 0:case 11:case 15:pu(8,g,m);break;case 23:case 22:if(g.memoizedState!==null&&g.memoizedState.cachePool!==null){var w=g.memoizedState.cachePool.pool;w!=null&&w.refCount++}break;case 24:w0(g.memoizedState.cache)}if(w=g.child,w!==null)w.return=g,Mr=w;else e:for(g=d;Mr!==null;){w=Mr;var C=w.sibling,_=w.return;if(r6(w),w===g){Mr=null;break e}if(C!==null){C.return=_,Mr=C;break e}Mr=_}}}var GJ={getCacheForType:function(d){var m=ia(or),g=m.data.get(d);return g===void 0&&(g=d(),m.data.set(d,g)),g},cacheSignal:function(){return ia(or).controller.signal}},qJ=typeof WeakMap=="function"?WeakMap:Map,Bn=0,ms=null,vn=null,kn=0,Xn=0,$i=null,gu=!1,_m=!1,Yk=!1,uc=0,Bs=0,xu=0,Id=0,Qk=0,Ii=0,Em=0,F0=null,ni=null,Zk=!1,xv=0,p6=0,yv=1/0,bv=null,yu=null,Sr=0,bu=null,Am=null,dc=0,Jk=0,eC=null,g6=null,z0=0,tC=null;function Ri(){return(Bn&2)!==0&&kn!==0?kn&-kn:z.T!==null?oC():ji()}function x6(){if(Ii===0)if((kn&536870912)===0||_n){var d=ns;ns<<=1,(ns&3932160)===0&&(ns=262144),Ii=d}else Ii=536870912;return d=Ei.current,d!==null&&(d.flags|=32),Ii}function si(d,m,g){(d===ms&&(Xn===2||Xn===9)||d.cancelPendingCommit!==null)&&($m(d,0),vu(d,kn,Ii,!1)),na(d,g),((Bn&2)===0||d!==ms)&&(d===ms&&((Bn&2)===0&&(Id|=g),Bs===4&&vu(d,kn,Ii,!1)),Sl(d))}function y6(d,m,g){if((Bn&6)!==0)throw Error(s(327));var w=!g&&(m&127)===0&&(m&d.expiredLanes)===0||ro(d,m),C=w?YJ(d,m):sC(d,m,!0),_=w;do{if(C===0){_m&&!w&&vu(d,m,0,!1);break}else{if(g=d.current.alternate,_&&!KJ(g)){C=sC(d,m,!1),_=!1;continue}if(C===2){if(_=m,d.errorRecoveryDisabledLanes&_)var G=0;else G=d.pendingLanes&-536870913,G=G!==0?G:G&536870912?536870912:0;if(G!==0){m=G;e:{var ne=d;C=F0;var pe=ne.current.memoizedState.isDehydrated;if(pe&&($m(ne,G).flags|=256),G=sC(ne,G,!1),G!==2){if(Yk&&!pe){ne.errorRecoveryDisabledLanes|=_,Id|=_,C=4;break e}_=ni,ni=C,_!==null&&(ni===null?ni=_:ni.push.apply(ni,_))}C=G}if(_=!1,C!==2)continue}}if(C===1){$m(d,0),vu(d,m,0,!0);break}e:{switch(w=d,_=C,_){case 0:case 1:throw Error(s(345));case 4:if((m&4194048)!==m)break;case 6:vu(w,m,Ii,!gu);break e;case 2:ni=null;break;case 3:case 5:break;default:throw Error(s(329))}if((m&62914560)===m&&(C=xv+300-Oe(),10<C)){if(vu(w,m,Ii,!gu),Ks(w,0,!0)!==0)break e;dc=m,w.timeoutHandle=X6(b6.bind(null,w,g,ni,bv,Zk,m,Ii,Id,Em,gu,_,"Throttled",-0,0),C);break e}b6(w,g,ni,bv,Zk,m,Ii,Id,Em,gu,_,null,-0,0)}}break}while(!0);Sl(d)}function b6(d,m,g,w,C,_,G,ne,pe,Me,Xe,et,Fe,Ue){if(d.timeoutHandle=-1,et=m.subtreeFlags,et&8192||(et&16785408)===16785408){et={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Ci},d6(m,_,et);var Rt=(_&62914560)===_?xv-Oe():(_&4194048)===_?p6-Oe():0;if(Rt=Iee(et,Rt),Rt!==null){dc=_,d.cancelPendingCommit=Rt(T6.bind(null,d,m,_,g,w,C,G,ne,pe,Xe,et,null,Fe,Ue)),vu(d,_,G,!Me);return}}T6(d,m,_,g,w,C,G,ne,pe)}function KJ(d){for(var m=d;;){var g=m.tag;if((g===0||g===11||g===15)&&m.flags&16384&&(g=m.updateQueue,g!==null&&(g=g.stores,g!==null)))for(var w=0;w<g.length;w++){var C=g[w],_=C.getSnapshot;C=C.value;try{if(!Ti(_(),C))return!1}catch{return!1}}if(g=m.child,m.subtreeFlags&16384&&g!==null)g.return=m,m=g;else{if(m===d)break;for(;m.sibling===null;){if(m.return===null||m.return===d)return!0;m=m.return}m.sibling.return=m.return,m=m.sibling}}return!0}function vu(d,m,g,w){m&=~Qk,m&=~Id,d.suspendedLanes|=m,d.pingedLanes&=~m,w&&(d.warmLanes|=m),w=d.expirationTimes;for(var C=m;0<C;){var _=31-lt(C),G=1<<_;w[_]=-1,C&=~G}g!==0&&Fo(d,g,m)}function vv(){return(Bn&6)===0?(B0(0),!1):!0}function nC(){if(vn!==null){if(Xn===0)var d=vn.return;else d=vn,ec=Sd=null,yk(d),wm=null,S0=0,d=vn;for(;d!==null;)YD(d.alternate,d),d=d.return;vn=null}}function $m(d,m){var g=d.timeoutHandle;g!==-1&&(d.timeoutHandle=-1,fee(g)),g=d.cancelPendingCommit,g!==null&&(d.cancelPendingCommit=null,g()),dc=0,nC(),ms=d,vn=g=Zl(d.current,null),kn=m,Xn=0,$i=null,gu=!1,_m=ro(d,m),Yk=!1,Em=Ii=Qk=Id=xu=Bs=0,ni=F0=null,Zk=!1,(m&8)!==0&&(m|=m&32);var w=d.entangledLanes;if(w!==0)for(d=d.entanglements,w&=m;0<w;){var C=31-lt(w),_=1<<C;m|=d[C],w&=~_}return uc=m,Bb(),g}function v6(d,m){ln=null,z.H=$0,m===vm||m===Xb?(m=PO(),Xn=3):m===ik?(m=PO(),Xn=4):Xn=m===Ok?8:m!==null&&typeof m=="object"&&typeof m.then=="function"?6:1,$i=m,vn===null&&(Bs=1,cv(d,ho(m,d.current)))}function w6(){var d=Ei.current;return d===null?!0:(kn&4194048)===kn?go===null:(kn&62914560)===kn||(kn&536870912)!==0?d===go:!1}function N6(){var d=z.H;return z.H=$0,d===null?$0:d}function S6(){var d=z.A;return z.A=GJ,d}function wv(){Bs=4,gu||(kn&4194048)!==kn&&Ei.current!==null||(_m=!0),(xu&134217727)===0&&(Id&134217727)===0||ms===null||vu(ms,kn,Ii,!1)}function sC(d,m,g){var w=Bn;Bn|=2;var C=N6(),_=S6();(ms!==d||kn!==m)&&(bv=null,$m(d,m)),m=!1;var G=Bs;e:do try{if(Xn!==0&&vn!==null){var ne=vn,pe=$i;switch(Xn){case 8:nC(),G=6;break e;case 3:case 2:case 9:case 6:Ei.current===null&&(m=!0);var Me=Xn;if(Xn=0,$i=null,Im(d,ne,pe,Me),g&&_m){G=0;break e}break;default:Me=Xn,Xn=0,$i=null,Im(d,ne,pe,Me)}}XJ(),G=Bs;break}catch(Xe){v6(d,Xe)}while(!0);return m&&d.shellSuspendCounter++,ec=Sd=null,Bn=w,z.H=C,z.A=_,vn===null&&(ms=null,kn=0,Bb()),G}function XJ(){for(;vn!==null;)j6(vn)}function YJ(d,m){var g=Bn;Bn|=2;var w=N6(),C=S6();ms!==d||kn!==m?(bv=null,yv=Oe()+500,$m(d,m)):_m=ro(d,m);e:do try{if(Xn!==0&&vn!==null){m=vn;var _=$i;t:switch(Xn){case 1:Xn=0,$i=null,Im(d,m,_,1);break;case 2:case 9:if(OO(_)){Xn=0,$i=null,k6(m);break}m=function(){Xn!==2&&Xn!==9||ms!==d||(Xn=7),Sl(d)},_.then(m,m);break e;case 3:Xn=7;break e;case 4:Xn=5;break e;case 7:OO(_)?(Xn=0,$i=null,k6(m)):(Xn=0,$i=null,Im(d,m,_,7));break;case 5:var G=null;switch(vn.tag){case 26:G=vn.memoizedState;case 5:case 27:var ne=vn;if(G?uP(G):ne.stateNode.complete){Xn=0,$i=null;var pe=ne.sibling;if(pe!==null)vn=pe;else{var Me=ne.return;Me!==null?(vn=Me,Nv(Me)):vn=null}break t}}Xn=0,$i=null,Im(d,m,_,5);break;case 6:Xn=0,$i=null,Im(d,m,_,6);break;case 8:nC(),Bs=6;break e;default:throw Error(s(462))}}QJ();break}catch(Xe){v6(d,Xe)}while(!0);return ec=Sd=null,z.H=w,z.A=C,Bn=g,vn!==null?0:(ms=null,kn=0,Bb(),Bs)}function QJ(){for(;vn!==null&&!mt();)j6(vn)}function j6(d){var m=KD(d.alternate,d,uc);d.memoizedProps=d.pendingProps,m===null?Nv(d):vn=m}function k6(d){var m=d,g=m.alternate;switch(m.tag){case 15:case 0:m=UD(g,m,m.pendingProps,m.type,void 0,kn);break;case 11:m=UD(g,m,m.pendingProps,m.type.render,m.ref,kn);break;case 5:yk(m);default:YD(g,m),m=vn=SO(m,uc),m=KD(g,m,uc)}d.memoizedProps=d.pendingProps,m===null?Nv(d):vn=m}function Im(d,m,g,w){ec=Sd=null,yk(m),wm=null,S0=0;var C=m.return;try{if(FJ(d,C,m,g,kn)){Bs=1,cv(d,ho(g,d.current)),vn=null;return}}catch(_){if(C!==null)throw vn=C,_;Bs=1,cv(d,ho(g,d.current)),vn=null;return}m.flags&32768?(_n||w===1?d=!0:_m||(kn&536870912)!==0?d=!1:(gu=d=!0,(w===2||w===9||w===3||w===6)&&(w=Ei.current,w!==null&&w.tag===13&&(w.flags|=16384))),C6(m,d)):Nv(m)}function Nv(d){var m=d;do{if((m.flags&32768)!==0){C6(m,gu);return}d=m.return;var g=UJ(m.alternate,m,uc);if(g!==null){vn=g;return}if(m=m.sibling,m!==null){vn=m;return}vn=m=d}while(m!==null);Bs===0&&(Bs=5)}function C6(d,m){do{var g=VJ(d.alternate,d);if(g!==null){g.flags&=32767,vn=g;return}if(g=d.return,g!==null&&(g.flags|=32768,g.subtreeFlags=0,g.deletions=null),!m&&(d=d.sibling,d!==null)){vn=d;return}vn=d=g}while(d!==null);Bs=6,vn=null}function T6(d,m,g,w,C,_,G,ne,pe){d.cancelPendingCommit=null;do Sv();while(Sr!==0);if((Bn&6)!==0)throw Error(s(327));if(m!==null){if(m===d.current)throw Error(s(177));if(_=m.lanes|m.childLanes,_|=Hj,Pr(d,g,_,G,ne,pe),d===ms&&(vn=ms=null,kn=0),Am=m,bu=d,dc=g,Jk=_,eC=C,g6=w,(m.subtreeFlags&10256)!==0||(m.flags&10256)!==0?(d.callbackNode=null,d.callbackPriority=0,tee(L,function(){return I6(),null})):(d.callbackNode=null,d.callbackPriority=0),w=(m.flags&13878)!==0,(m.subtreeFlags&13878)!==0||w){w=z.T,z.T=null,C=K.p,K.p=2,G=Bn,Bn|=4;try{WJ(d,m,g)}finally{Bn=G,K.p=C,z.T=w}}Sr=1,_6(),E6(),A6()}}function _6(){if(Sr===1){Sr=0;var d=bu,m=Am,g=(m.flags&13878)!==0;if((m.subtreeFlags&13878)!==0||g){g=z.T,z.T=null;var w=K.p;K.p=2;var C=Bn;Bn|=4;try{l6(m,d);var _=pC,G=fO(d.containerInfo),ne=_.focusedElem,pe=_.selectionRange;if(G!==ne&&ne&&ne.ownerDocument&&mO(ne.ownerDocument.documentElement,ne)){if(pe!==null&&zj(ne)){var Me=pe.start,Xe=pe.end;if(Xe===void 0&&(Xe=Me),"selectionStart"in ne)ne.selectionStart=Me,ne.selectionEnd=Math.min(Xe,ne.value.length);else{var et=ne.ownerDocument||document,Fe=et&&et.defaultView||window;if(Fe.getSelection){var Ue=Fe.getSelection(),Rt=ne.textContent.length,Kt=Math.min(pe.start,Rt),is=pe.end===void 0?Kt:Math.min(pe.end,Rt);!Ue.extend&&Kt>is&&(G=is,is=Kt,Kt=G);var Ae=hO(ne,Kt),Ne=hO(ne,is);if(Ae&&Ne&&(Ue.rangeCount!==1||Ue.anchorNode!==Ae.node||Ue.anchorOffset!==Ae.offset||Ue.focusNode!==Ne.node||Ue.focusOffset!==Ne.offset)){var Le=et.createRange();Le.setStart(Ae.node,Ae.offset),Ue.removeAllRanges(),Kt>is?(Ue.addRange(Le),Ue.extend(Ne.node,Ne.offset)):(Le.setEnd(Ne.node,Ne.offset),Ue.addRange(Le))}}}}for(et=[],Ue=ne;Ue=Ue.parentNode;)Ue.nodeType===1&&et.push({element:Ue,left:Ue.scrollLeft,top:Ue.scrollTop});for(typeof ne.focus=="function"&&ne.focus(),ne=0;ne<et.length;ne++){var Qe=et[ne];Qe.element.scrollLeft=Qe.left,Qe.element.scrollTop=Qe.top}}Dv=!!fC,pC=fC=null}finally{Bn=C,K.p=w,z.T=g}}d.current=m,Sr=2}}function E6(){if(Sr===2){Sr=0;var d=bu,m=Am,g=(m.flags&8772)!==0;if((m.subtreeFlags&8772)!==0||g){g=z.T,z.T=null;var w=K.p;K.p=2;var C=Bn;Bn|=4;try{s6(d,m.alternate,m)}finally{Bn=C,K.p=w,z.T=g}}Sr=3}}function A6(){if(Sr===4||Sr===3){Sr=0,jt();var d=bu,m=Am,g=dc,w=g6;(m.subtreeFlags&10256)!==0||(m.flags&10256)!==0?Sr=5:(Sr=0,Am=bu=null,$6(d,d.pendingLanes));var C=d.pendingLanes;if(C===0&&(yu=null),Qa(g),m=m.stateNode,xt&&typeof xt.onCommitFiberRoot=="function")try{xt.onCommitFiberRoot(De,m,void 0,(m.current.flags&128)===128)}catch{}if(w!==null){m=z.T,C=K.p,K.p=2,z.T=null;try{for(var _=d.onRecoverableError,G=0;G<w.length;G++){var ne=w[G];_(ne.value,{componentStack:ne.stack})}}finally{z.T=m,K.p=C}}(dc&3)!==0&&Sv(),Sl(d),C=d.pendingLanes,(g&261930)!==0&&(C&42)!==0?d===tC?z0++:(z0=0,tC=d):z0=0,B0(0)}}function $6(d,m){(d.pooledCacheLanes&=m)===0&&(m=d.pooledCache,m!=null&&(d.pooledCache=null,w0(m)))}function Sv(){return _6(),E6(),A6(),I6()}function I6(){if(Sr!==5)return!1;var d=bu,m=Jk;Jk=0;var g=Qa(dc),w=z.T,C=K.p;try{K.p=32>g?32:g,z.T=null,g=eC,eC=null;var _=bu,G=dc;if(Sr=0,Am=bu=null,dc=0,(Bn&6)!==0)throw Error(s(331));var ne=Bn;if(Bn|=4,m6(_.current),u6(_,_.current,G,g),Bn=ne,B0(0,!1),xt&&typeof xt.onPostCommitFiberRoot=="function")try{xt.onPostCommitFiberRoot(De,_)}catch{}return!0}finally{K.p=C,z.T=w,$6(d,m)}}function R6(d,m,g){m=ho(g,m),m=Rk(d.stateNode,m,2),d=hu(d,m,2),d!==null&&(na(d,2),Sl(d))}function Yn(d,m,g){if(d.tag===3)R6(d,d,g);else for(;m!==null;){if(m.tag===3){R6(m,d,g);break}else if(m.tag===1){var w=m.stateNode;if(typeof m.type.getDerivedStateFromError=="function"||typeof w.componentDidCatch=="function"&&(yu===null||!yu.has(w))){d=ho(g,d),g=OD(2),w=hu(m,g,2),w!==null&&(DD(g,w,m,d),na(w,2),Sl(w));break}}m=m.return}}function rC(d,m,g){var w=d.pingCache;if(w===null){w=d.pingCache=new qJ;var C=new Set;w.set(m,C)}else C=w.get(m),C===void 0&&(C=new Set,w.set(m,C));C.has(g)||(Yk=!0,C.add(g),d=ZJ.bind(null,d,m,g),m.then(d,d))}function ZJ(d,m,g){var w=d.pingCache;w!==null&&w.delete(m),d.pingedLanes|=d.suspendedLanes&g,d.warmLanes&=~g,ms===d&&(kn&g)===g&&(Bs===4||Bs===3&&(kn&62914560)===kn&&300>Oe()-xv?(Bn&2)===0&&$m(d,0):Qk|=g,Em===kn&&(Em=0)),Sl(d)}function O6(d,m){m===0&&(m=Aa()),d=vd(d,m),d!==null&&(na(d,m),Sl(d))}function JJ(d){var m=d.memoizedState,g=0;m!==null&&(g=m.retryLane),O6(d,g)}function eee(d,m){var g=0;switch(d.tag){case 31:case 13:var w=d.stateNode,C=d.memoizedState;C!==null&&(g=C.retryLane);break;case 19:w=d.stateNode;break;case 22:w=d.stateNode._retryCache;break;default:throw Error(s(314))}w!==null&&w.delete(m),O6(d,g)}function tee(d,m){return tt(d,m)}var jv=null,Rm=null,aC=!1,kv=!1,iC=!1,wu=0;function Sl(d){d!==Rm&&d.next===null&&(Rm===null?jv=Rm=d:Rm=Rm.next=d),kv=!0,aC||(aC=!0,see())}function B0(d,m){if(!iC&&kv){iC=!0;do for(var g=!1,w=jv;w!==null;){if(d!==0){var C=w.pendingLanes;if(C===0)var _=0;else{var G=w.suspendedLanes,ne=w.pingedLanes;_=(1<<31-lt(42|d)+1)-1,_&=C&~(G&~ne),_=_&201326741?_&201326741|1:_?_|2:0}_!==0&&(g=!0,M6(w,_))}else _=kn,_=Ks(w,w===ms?_:0,w.cancelPendingCommit!==null||w.timeoutHandle!==-1),(_&3)===0||ro(w,_)||(g=!0,M6(w,_));w=w.next}while(g);iC=!1}}function nee(){D6()}function D6(){kv=aC=!1;var d=0;wu!==0&&mee()&&(d=wu);for(var m=Oe(),g=null,w=jv;w!==null;){var C=w.next,_=P6(w,m);_===0?(w.next=null,g===null?jv=C:g.next=C,C===null&&(Rm=g)):(g=w,(d!==0||(_&3)!==0)&&(kv=!0)),w=C}Sr!==0&&Sr!==5||B0(d),wu!==0&&(wu=0)}function P6(d,m){for(var g=d.suspendedLanes,w=d.pingedLanes,C=d.expirationTimes,_=d.pendingLanes&-62914561;0<_;){var G=31-lt(_),ne=1<<G,pe=C[G];pe===-1?((ne&g)===0||(ne&w)!==0)&&(C[G]=Xa(ne,m)):pe<=m&&(d.expiredLanes|=ne),_&=~ne}if(m=ms,g=kn,g=Ks(d,d===m?g:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),w=d.callbackNode,g===0||d===m&&(Xn===2||Xn===9)||d.cancelPendingCommit!==null)return w!==null&&w!==null&&St(w),d.callbackNode=null,d.callbackPriority=0;if((g&3)===0||ro(d,g)){if(m=g&-g,m===d.callbackPriority)return m;switch(w!==null&&St(w),Qa(g)){case 2:case 8:g=Q;break;case 32:g=L;break;case 268435456:g=ee;break;default:g=L}return w=L6.bind(null,d),g=tt(g,w),d.callbackPriority=m,d.callbackNode=g,m}return w!==null&&w!==null&&St(w),d.callbackPriority=2,d.callbackNode=null,2}function L6(d,m){if(Sr!==0&&Sr!==5)return d.callbackNode=null,d.callbackPriority=0,null;var g=d.callbackNode;if(Sv()&&d.callbackNode!==g)return null;var w=kn;return w=Ks(d,d===ms?w:0,d.cancelPendingCommit!==null||d.timeoutHandle!==-1),w===0?null:(y6(d,w,m),P6(d,Oe()),d.callbackNode!=null&&d.callbackNode===g?L6.bind(null,d):null)}function M6(d,m){if(Sv())return null;y6(d,m,!0)}function see(){pee(function(){(Bn&6)!==0?tt(ut,nee):D6()})}function oC(){if(wu===0){var d=ym;d===0&&(d=vs,vs<<=1,(vs&261888)===0&&(vs=256)),wu=d}return wu}function F6(d){return d==null||typeof d=="symbol"||typeof d=="boolean"?null:typeof d=="function"?d:am(""+d)}function z6(d,m){var g=m.ownerDocument.createElement("input");return g.name=m.name,g.value=m.value,d.id&&g.setAttribute("form",d.id),m.parentNode.insertBefore(g,m),d=new FormData(d),g.parentNode.removeChild(g),d}function ree(d,m,g,w,C){if(m==="submit"&&g&&g.stateNode===C){var _=F6((C[Ps]||null).action),G=w.submitter;G&&(m=(m=G[Ps]||null)?F6(m.formAction):G.getAttribute("formAction"),m!==null&&(_=m,G=null));var ne=new oo("action","action",null,w,C);d.push({event:ne,listeners:[{instance:null,listener:function(){if(w.defaultPrevented){if(wu!==0){var pe=G?z6(C,G):new FormData(C);Tk(g,{pending:!0,data:pe,method:C.method,action:_},null,pe)}}else typeof _=="function"&&(ne.preventDefault(),pe=G?z6(C,G):new FormData(C),Tk(g,{pending:!0,data:pe,method:C.method,action:_},_,pe))},currentTarget:C}]})}}for(var lC=0;lC<Wj.length;lC++){var cC=Wj[lC],aee=cC.toLowerCase(),iee=cC[0].toUpperCase()+cC.slice(1);Ho(aee,"on"+iee)}Ho(xO,"onAnimationEnd"),Ho(yO,"onAnimationIteration"),Ho(bO,"onAnimationStart"),Ho("dblclick","onDoubleClick"),Ho("focusin","onFocus"),Ho("focusout","onBlur"),Ho(NJ,"onTransitionRun"),Ho(SJ,"onTransitionStart"),Ho(jJ,"onTransitionCancel"),Ho(vO,"onTransitionEnd"),Ke("onMouseEnter",["mouseout","mouseover"]),Ke("onMouseLeave",["mouseout","mouseover"]),Ke("onPointerEnter",["pointerout","pointerover"]),Ke("onPointerLeave",["pointerout","pointerover"]),xe("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),xe("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),xe("onBeforeInput",["compositionend","keypress","textInput","paste"]),xe("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),xe("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),xe("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var U0="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),oee=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(U0));function B6(d,m){m=(m&4)!==0;for(var g=0;g<d.length;g++){var w=d[g],C=w.event;w=w.listeners;e:{var _=void 0;if(m)for(var G=w.length-1;0<=G;G--){var ne=w[G],pe=ne.instance,Me=ne.currentTarget;if(ne=ne.listener,pe!==_&&C.isPropagationStopped())break e;_=ne,C.currentTarget=Me;try{_(C)}catch(Xe){zb(Xe)}C.currentTarget=null,_=pe}else for(G=0;G<w.length;G++){if(ne=w[G],pe=ne.instance,Me=ne.currentTarget,ne=ne.listener,pe!==_&&C.isPropagationStopped())break e;_=ne,C.currentTarget=Me;try{_(C)}catch(Xe){zb(Xe)}C.currentTarget=null,_=pe}}}}function wn(d,m){var g=m[Lr];g===void 0&&(g=m[Lr]=new Set);var w=d+"__bubble";g.has(w)||(U6(m,d,2,!1),g.add(w))}function uC(d,m,g){var w=0;m&&(w|=4),U6(g,d,w,m)}var Cv="_reactListening"+Math.random().toString(36).slice(2);function dC(d){if(!d[Cv]){d[Cv]=!0,Vn.forEach(function(g){g!=="selectionchange"&&(oee.has(g)||uC(g,!1,d),uC(g,!0,d))});var m=d.nodeType===9?d:d.ownerDocument;m===null||m[Cv]||(m[Cv]=!0,uC("selectionchange",!1,m))}}function U6(d,m,g,w){switch(xP(m)){case 2:var C=Dee;break;case 8:C=Pee;break;default:C=CC}g=C.bind(null,m,g,d),C=void 0,!At||m!=="touchstart"&&m!=="touchmove"&&m!=="wheel"||(C=!0),w?C!==void 0?d.addEventListener(m,g,{capture:!0,passive:C}):d.addEventListener(m,g,!0):C!==void 0?d.addEventListener(m,g,{passive:C}):d.addEventListener(m,g,!1)}function hC(d,m,g,w,C){var _=w;if((m&1)===0&&(m&2)===0&&w!==null)e:for(;;){if(w===null)return;var G=w.tag;if(G===3||G===4){var ne=w.stateNode.containerInfo;if(ne===C)break;if(G===4)for(G=w.return;G!==null;){var pe=G.tag;if((pe===3||pe===4)&&G.stateNode.containerInfo===C)return;G=G.return}for(;ne!==null;){if(G=_t(ne),G===null)return;if(pe=G.tag,pe===5||pe===6||pe===26||pe===27){w=_=G;continue e}ne=ne.parentNode}}w=w.return}Je(function(){var Me=_,Xe=u0(g),et=[];e:{var Fe=wO.get(d);if(Fe!==void 0){var Ue=oo,Rt=d;switch(d){case"keypress":if(ws(g)===0)break e;case"keydown":case"keyup":Ue=ir;break;case"focusin":Rt="focus",Ue=om;break;case"focusout":Rt="blur",Ue=om;break;case"beforeblur":case"afterblur":Ue=om;break;case"click":if(g.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ue=im;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ue=Db;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ue=sJ;break;case xO:case yO:case bO:Ue=Za;break;case vO:Ue=aJ;break;case"scroll":case"scrollend":Ue=ar;break;case"wheel":Ue=oJ;break;case"copy":case"cut":case"paste":Ue=d0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ue=ZR;break;case"toggle":case"beforetoggle":Ue=cJ}var Kt=(m&4)!==0,is=!Kt&&(d==="scroll"||d==="scrollend"),Ae=Kt?Fe!==null?Fe+"Capture":null:Fe;Kt=[];for(var Ne=Me,Le;Ne!==null;){var Qe=Ne;if(Le=Qe.stateNode,Qe=Qe.tag,Qe!==5&&Qe!==26&&Qe!==27||Le===null||Ae===null||(Qe=pt(Ne,Ae),Qe!=null&&Kt.push(V0(Ne,Qe,Le))),is)break;Ne=Ne.return}0<Kt.length&&(Fe=new Ue(Fe,Rt,null,g,Xe),et.push({event:Fe,listeners:Kt}))}}if((m&7)===0){e:{if(Fe=d==="mouseover"||d==="pointerover",Ue=d==="mouseout"||d==="pointerout",Fe&&g!==io&&(Rt=g.relatedTarget||g.fromElement)&&(_t(Rt)||Rt[$a]))break e;if((Ue||Fe)&&(Fe=Xe.window===Xe?Xe:(Fe=Xe.ownerDocument)?Fe.defaultView||Fe.parentWindow:window,Ue?(Rt=g.relatedTarget||g.toElement,Ue=Me,Rt=Rt?_t(Rt):null,Rt!==null&&(is=a(Rt),Kt=Rt.tag,Rt!==is||Kt!==5&&Kt!==27&&Kt!==6)&&(Rt=null)):(Ue=null,Rt=Me),Ue!==Rt)){if(Kt=im,Qe="onMouseLeave",Ae="onMouseEnter",Ne="mouse",(d==="pointerout"||d==="pointerover")&&(Kt=ZR,Qe="onPointerLeave",Ae="onPointerEnter",Ne="pointer"),is=Ue==null?Fe:ds(Ue),Le=Rt==null?Fe:ds(Rt),Fe=new Kt(Qe,Ne+"leave",Ue,g,Xe),Fe.target=is,Fe.relatedTarget=Le,Qe=null,_t(Xe)===Me&&(Kt=new Kt(Ae,Ne+"enter",Rt,g,Xe),Kt.target=Le,Kt.relatedTarget=is,Qe=Kt),is=Qe,Ue&&Rt)t:{for(Kt=lee,Ae=Ue,Ne=Rt,Le=0,Qe=Ae;Qe;Qe=Kt(Qe))Le++;Qe=0;for(var Ht=Ne;Ht;Ht=Kt(Ht))Qe++;for(;0<Le-Qe;)Ae=Kt(Ae),Le--;for(;0<Qe-Le;)Ne=Kt(Ne),Qe--;for(;Le--;){if(Ae===Ne||Ne!==null&&Ae===Ne.alternate){Kt=Ae;break t}Ae=Kt(Ae),Ne=Kt(Ne)}Kt=null}else Kt=null;Ue!==null&&V6(et,Fe,Ue,Kt,!1),Rt!==null&&is!==null&&V6(et,is,Rt,Kt,!0)}}e:{if(Fe=Me?ds(Me):window,Ue=Fe.nodeName&&Fe.nodeName.toLowerCase(),Ue==="select"||Ue==="input"&&Fe.type==="file")var Mn=iO;else if(rO(Fe))if(oO)Mn=bJ;else{Mn=xJ;var zt=gJ}else Ue=Fe.nodeName,!Ue||Ue.toLowerCase()!=="input"||Fe.type!=="checkbox"&&Fe.type!=="radio"?Me&&c0(Me.elementType)&&(Mn=iO):Mn=yJ;if(Mn&&(Mn=Mn(d,Me))){aO(et,Mn,g,Xe);break e}zt&&zt(d,Fe,Me),d==="focusout"&&Me&&Fe.type==="number"&&Me.memoizedProps.value!=null&&Uo(Fe,"number",Fe.value)}switch(zt=Me?ds(Me):window,d){case"focusin":(rO(zt)||zt.contentEditable==="true")&&(um=zt,Bj=Me,y0=null);break;case"focusout":y0=Bj=um=null;break;case"mousedown":Uj=!0;break;case"contextmenu":case"mouseup":case"dragend":Uj=!1,pO(et,g,Xe);break;case"selectionchange":if(wJ)break;case"keydown":case"keyup":pO(et,g,Xe)}var hn;if(Lj)e:{switch(d){case"compositionstart":var Cn="onCompositionStart";break e;case"compositionend":Cn="onCompositionEnd";break e;case"compositionupdate":Cn="onCompositionUpdate";break e}Cn=void 0}else cm?nO(d,g)&&(Cn="onCompositionEnd"):d==="keydown"&&g.keyCode===229&&(Cn="onCompositionStart");Cn&&(JR&&g.locale!=="ko"&&(cm||Cn!=="onCompositionStart"?Cn==="onCompositionEnd"&&cm&&(hn=Wn()):(gn=Xe,jn="value"in gn?gn.value:gn.textContent,cm=!0)),zt=Tv(Me,Cn),0<zt.length&&(Cn=new Wo(Cn,d,null,g,Xe),et.push({event:Cn,listeners:zt}),hn?Cn.data=hn:(hn=sO(g),hn!==null&&(Cn.data=hn)))),(hn=dJ?hJ(d,g):mJ(d,g))&&(Cn=Tv(Me,"onBeforeInput"),0<Cn.length&&(zt=new Wo("onBeforeInput","beforeinput",null,g,Xe),et.push({event:zt,listeners:Cn}),zt.data=hn)),ree(et,d,Me,g,Xe)}B6(et,m)})}function V0(d,m,g){return{instance:d,listener:m,currentTarget:g}}function Tv(d,m){for(var g=m+"Capture",w=[];d!==null;){var C=d,_=C.stateNode;if(C=C.tag,C!==5&&C!==26&&C!==27||_===null||(C=pt(d,g),C!=null&&w.unshift(V0(d,C,_)),C=pt(d,m),C!=null&&w.push(V0(d,C,_))),d.tag===3)return w;d=d.return}return[]}function lee(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5&&d.tag!==27);return d||null}function V6(d,m,g,w,C){for(var _=m._reactName,G=[];g!==null&&g!==w;){var ne=g,pe=ne.alternate,Me=ne.stateNode;if(ne=ne.tag,pe!==null&&pe===w)break;ne!==5&&ne!==26&&ne!==27||Me===null||(pe=Me,C?(Me=pt(g,_),Me!=null&&G.unshift(V0(g,Me,pe))):C||(Me=pt(g,_),Me!=null&&G.push(V0(g,Me,pe)))),g=g.return}G.length!==0&&d.push({event:m,listeners:G})}var cee=/\r\n?/g,uee=/\u0000|\uFFFD/g;function W6(d){return(typeof d=="string"?d:""+d).replace(cee,`
`).replace(uee,"")}function H6(d,m){return m=W6(m),W6(d)===m}function as(d,m,g,w,C,_){switch(g){case"children":typeof w=="string"?m==="body"||m==="textarea"&&w===""||ru(d,w):(typeof w=="number"||typeof w=="bigint")&&m!=="body"&&ru(d,""+w);break;case"className":dt(d,"class",w);break;case"tabIndex":dt(d,"tabindex",w);break;case"dir":case"role":case"viewBox":case"width":case"height":dt(d,g,w);break;case"style":Ib(d,w,_);break;case"data":if(m!=="object"){dt(d,"data",w);break}case"src":case"href":if(w===""&&(m!=="a"||g!=="href")){d.removeAttribute(g);break}if(w==null||typeof w=="function"||typeof w=="symbol"||typeof w=="boolean"){d.removeAttribute(g);break}w=am(""+w),d.setAttribute(g,w);break;case"action":case"formAction":if(typeof w=="function"){d.setAttribute(g,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof _=="function"&&(g==="formAction"?(m!=="input"&&as(d,m,"name",C.name,C,null),as(d,m,"formEncType",C.formEncType,C,null),as(d,m,"formMethod",C.formMethod,C,null),as(d,m,"formTarget",C.formTarget,C,null)):(as(d,m,"encType",C.encType,C,null),as(d,m,"method",C.method,C,null),as(d,m,"target",C.target,C,null)));if(w==null||typeof w=="symbol"||typeof w=="boolean"){d.removeAttribute(g);break}w=am(""+w),d.setAttribute(g,w);break;case"onClick":w!=null&&(d.onclick=Ci);break;case"onScroll":w!=null&&wn("scroll",d);break;case"onScrollEnd":w!=null&&wn("scrollend",d);break;case"dangerouslySetInnerHTML":if(w!=null){if(typeof w!="object"||!("__html"in w))throw Error(s(61));if(g=w.__html,g!=null){if(C.children!=null)throw Error(s(60));d.innerHTML=g}}break;case"multiple":d.multiple=w&&typeof w!="function"&&typeof w!="symbol";break;case"muted":d.muted=w&&typeof w!="function"&&typeof w!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(w==null||typeof w=="function"||typeof w=="boolean"||typeof w=="symbol"){d.removeAttribute("xlink:href");break}g=am(""+w),d.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",g);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":w!=null&&typeof w!="function"&&typeof w!="symbol"?d.setAttribute(g,""+w):d.removeAttribute(g);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":w&&typeof w!="function"&&typeof w!="symbol"?d.setAttribute(g,""):d.removeAttribute(g);break;case"capture":case"download":w===!0?d.setAttribute(g,""):w!==!1&&w!=null&&typeof w!="function"&&typeof w!="symbol"?d.setAttribute(g,w):d.removeAttribute(g);break;case"cols":case"rows":case"size":case"span":w!=null&&typeof w!="function"&&typeof w!="symbol"&&!isNaN(w)&&1<=w?d.setAttribute(g,w):d.removeAttribute(g);break;case"rowSpan":case"start":w==null||typeof w=="function"||typeof w=="symbol"||isNaN(w)?d.removeAttribute(g):d.setAttribute(g,w);break;case"popover":wn("beforetoggle",d),wn("toggle",d),yt(d,"popover",w);break;case"xlinkActuate":Dt(d,"http://www.w3.org/1999/xlink","xlink:actuate",w);break;case"xlinkArcrole":Dt(d,"http://www.w3.org/1999/xlink","xlink:arcrole",w);break;case"xlinkRole":Dt(d,"http://www.w3.org/1999/xlink","xlink:role",w);break;case"xlinkShow":Dt(d,"http://www.w3.org/1999/xlink","xlink:show",w);break;case"xlinkTitle":Dt(d,"http://www.w3.org/1999/xlink","xlink:title",w);break;case"xlinkType":Dt(d,"http://www.w3.org/1999/xlink","xlink:type",w);break;case"xmlBase":Dt(d,"http://www.w3.org/XML/1998/namespace","xml:base",w);break;case"xmlLang":Dt(d,"http://www.w3.org/XML/1998/namespace","xml:lang",w);break;case"xmlSpace":Dt(d,"http://www.w3.org/XML/1998/namespace","xml:space",w);break;case"is":yt(d,"is",w);break;case"innerText":case"textContent":break;default:(!(2<g.length)||g[0]!=="o"&&g[0]!=="O"||g[1]!=="n"&&g[1]!=="N")&&(g=Rb.get(g)||g,yt(d,g,w))}}function mC(d,m,g,w,C,_){switch(g){case"style":Ib(d,w,_);break;case"dangerouslySetInnerHTML":if(w!=null){if(typeof w!="object"||!("__html"in w))throw Error(s(61));if(g=w.__html,g!=null){if(C.children!=null)throw Error(s(60));d.innerHTML=g}}break;case"children":typeof w=="string"?ru(d,w):(typeof w=="number"||typeof w=="bigint")&&ru(d,""+w);break;case"onScroll":w!=null&&wn("scroll",d);break;case"onScrollEnd":w!=null&&wn("scrollend",d);break;case"onClick":w!=null&&(d.onclick=Ci);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!ki.hasOwnProperty(g))e:{if(g[0]==="o"&&g[1]==="n"&&(C=g.endsWith("Capture"),m=g.slice(2,C?g.length-7:void 0),_=d[Ps]||null,_=_!=null?_[g]:null,typeof _=="function"&&d.removeEventListener(m,_,C),typeof w=="function")){typeof _!="function"&&_!==null&&(g in d?d[g]=null:d.hasAttribute(g)&&d.removeAttribute(g)),d.addEventListener(m,w,C);break e}g in d?d[g]=w:w===!0?d.setAttribute(g,""):yt(d,g,w)}}}function la(d,m,g){switch(m){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":wn("error",d),wn("load",d);var w=!1,C=!1,_;for(_ in g)if(g.hasOwnProperty(_)){var G=g[_];if(G!=null)switch(_){case"src":w=!0;break;case"srcSet":C=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(s(137,m));default:as(d,m,_,G,g,null)}}C&&as(d,m,"srcSet",g.srcSet,g,null),w&&as(d,m,"src",g.src,g,null);return;case"input":wn("invalid",d);var ne=_=G=C=null,pe=null,Me=null;for(w in g)if(g.hasOwnProperty(w)){var Xe=g[w];if(Xe!=null)switch(w){case"name":C=Xe;break;case"type":G=Xe;break;case"checked":pe=Xe;break;case"defaultChecked":Me=Xe;break;case"value":_=Xe;break;case"defaultValue":ne=Xe;break;case"children":case"dangerouslySetInnerHTML":if(Xe!=null)throw Error(s(137,m));break;default:as(d,m,w,Xe,g,null)}}Bo(d,_,ne,pe,Me,G,C,!1);return;case"select":wn("invalid",d),w=G=_=null;for(C in g)if(g.hasOwnProperty(C)&&(ne=g[C],ne!=null))switch(C){case"value":_=ne;break;case"defaultValue":G=ne;break;case"multiple":w=ne;default:as(d,m,C,ne,g,null)}m=_,g=G,d.multiple=!!w,m!=null?sa(d,!!w,m,!1):g!=null&&sa(d,!!w,g,!0);return;case"textarea":wn("invalid",d),_=C=w=null;for(G in g)if(g.hasOwnProperty(G)&&(ne=g[G],ne!=null))switch(G){case"value":w=ne;break;case"defaultValue":C=ne;break;case"children":_=ne;break;case"dangerouslySetInnerHTML":if(ne!=null)throw Error(s(91));break;default:as(d,m,G,ne,g,null)}rm(d,w,C,_);return;case"option":for(pe in g)if(g.hasOwnProperty(pe)&&(w=g[pe],w!=null))switch(pe){case"selected":d.selected=w&&typeof w!="function"&&typeof w!="symbol";break;default:as(d,m,pe,w,g,null)}return;case"dialog":wn("beforetoggle",d),wn("toggle",d),wn("cancel",d),wn("close",d);break;case"iframe":case"object":wn("load",d);break;case"video":case"audio":for(w=0;w<U0.length;w++)wn(U0[w],d);break;case"image":wn("error",d),wn("load",d);break;case"details":wn("toggle",d);break;case"embed":case"source":case"link":wn("error",d),wn("load",d);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Me in g)if(g.hasOwnProperty(Me)&&(w=g[Me],w!=null))switch(Me){case"children":case"dangerouslySetInnerHTML":throw Error(s(137,m));default:as(d,m,Me,w,g,null)}return;default:if(c0(m)){for(Xe in g)g.hasOwnProperty(Xe)&&(w=g[Xe],w!==void 0&&mC(d,m,Xe,w,g,void 0));return}}for(ne in g)g.hasOwnProperty(ne)&&(w=g[ne],w!=null&&as(d,m,ne,w,g,null))}function dee(d,m,g,w){switch(m){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var C=null,_=null,G=null,ne=null,pe=null,Me=null,Xe=null;for(Ue in g){var et=g[Ue];if(g.hasOwnProperty(Ue)&&et!=null)switch(Ue){case"checked":break;case"value":break;case"defaultValue":pe=et;default:w.hasOwnProperty(Ue)||as(d,m,Ue,null,w,et)}}for(var Fe in w){var Ue=w[Fe];if(et=g[Fe],w.hasOwnProperty(Fe)&&(Ue!=null||et!=null))switch(Fe){case"type":_=Ue;break;case"name":C=Ue;break;case"checked":Me=Ue;break;case"defaultChecked":Xe=Ue;break;case"value":G=Ue;break;case"defaultValue":ne=Ue;break;case"children":case"dangerouslySetInnerHTML":if(Ue!=null)throw Error(s(137,m));break;default:Ue!==et&&as(d,m,Fe,Ue,w,et)}}pa(d,G,ne,pe,Me,Xe,_,C);return;case"select":Ue=G=ne=Fe=null;for(_ in g)if(pe=g[_],g.hasOwnProperty(_)&&pe!=null)switch(_){case"value":break;case"multiple":Ue=pe;default:w.hasOwnProperty(_)||as(d,m,_,null,w,pe)}for(C in w)if(_=w[C],pe=g[C],w.hasOwnProperty(C)&&(_!=null||pe!=null))switch(C){case"value":Fe=_;break;case"defaultValue":ne=_;break;case"multiple":G=_;default:_!==pe&&as(d,m,C,_,w,pe)}m=ne,g=G,w=Ue,Fe!=null?sa(d,!!g,Fe,!1):!!w!=!!g&&(m!=null?sa(d,!!g,m,!0):sa(d,!!g,g?[]:"",!1));return;case"textarea":Ue=Fe=null;for(ne in g)if(C=g[ne],g.hasOwnProperty(ne)&&C!=null&&!w.hasOwnProperty(ne))switch(ne){case"value":break;case"children":break;default:as(d,m,ne,null,w,C)}for(G in w)if(C=w[G],_=g[G],w.hasOwnProperty(G)&&(C!=null||_!=null))switch(G){case"value":Fe=C;break;case"defaultValue":Ue=C;break;case"children":break;case"dangerouslySetInnerHTML":if(C!=null)throw Error(s(91));break;default:C!==_&&as(d,m,G,C,w,_)}Xl(d,Fe,Ue);return;case"option":for(var Rt in g)if(Fe=g[Rt],g.hasOwnProperty(Rt)&&Fe!=null&&!w.hasOwnProperty(Rt))switch(Rt){case"selected":d.selected=!1;break;default:as(d,m,Rt,null,w,Fe)}for(pe in w)if(Fe=w[pe],Ue=g[pe],w.hasOwnProperty(pe)&&Fe!==Ue&&(Fe!=null||Ue!=null))switch(pe){case"selected":d.selected=Fe&&typeof Fe!="function"&&typeof Fe!="symbol";break;default:as(d,m,pe,Fe,w,Ue)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Kt in g)Fe=g[Kt],g.hasOwnProperty(Kt)&&Fe!=null&&!w.hasOwnProperty(Kt)&&as(d,m,Kt,null,w,Fe);for(Me in w)if(Fe=w[Me],Ue=g[Me],w.hasOwnProperty(Me)&&Fe!==Ue&&(Fe!=null||Ue!=null))switch(Me){case"children":case"dangerouslySetInnerHTML":if(Fe!=null)throw Error(s(137,m));break;default:as(d,m,Me,Fe,w,Ue)}return;default:if(c0(m)){for(var is in g)Fe=g[is],g.hasOwnProperty(is)&&Fe!==void 0&&!w.hasOwnProperty(is)&&mC(d,m,is,void 0,w,Fe);for(Xe in w)Fe=w[Xe],Ue=g[Xe],!w.hasOwnProperty(Xe)||Fe===Ue||Fe===void 0&&Ue===void 0||mC(d,m,Xe,Fe,w,Ue);return}}for(var Ae in g)Fe=g[Ae],g.hasOwnProperty(Ae)&&Fe!=null&&!w.hasOwnProperty(Ae)&&as(d,m,Ae,null,w,Fe);for(et in w)Fe=w[et],Ue=g[et],!w.hasOwnProperty(et)||Fe===Ue||Fe==null&&Ue==null||as(d,m,et,Fe,w,Ue)}function G6(d){switch(d){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function hee(){if(typeof performance.getEntriesByType=="function"){for(var d=0,m=0,g=performance.getEntriesByType("resource"),w=0;w<g.length;w++){var C=g[w],_=C.transferSize,G=C.initiatorType,ne=C.duration;if(_&&ne&&G6(G)){for(G=0,ne=C.responseEnd,w+=1;w<g.length;w++){var pe=g[w],Me=pe.startTime;if(Me>ne)break;var Xe=pe.transferSize,et=pe.initiatorType;Xe&&G6(et)&&(pe=pe.responseEnd,G+=Xe*(pe<ne?1:(ne-Me)/(pe-Me)))}if(--w,m+=8*(_+G)/(C.duration/1e3),d++,10<d)break}}if(0<d)return m/d/1e6}return navigator.connection&&(d=navigator.connection.downlink,typeof d=="number")?d:5}var fC=null,pC=null;function _v(d){return d.nodeType===9?d:d.ownerDocument}function q6(d){switch(d){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function K6(d,m){if(d===0)switch(m){case"svg":return 1;case"math":return 2;default:return 0}return d===1&&m==="foreignObject"?0:d}function gC(d,m){return d==="textarea"||d==="noscript"||typeof m.children=="string"||typeof m.children=="number"||typeof m.children=="bigint"||typeof m.dangerouslySetInnerHTML=="object"&&m.dangerouslySetInnerHTML!==null&&m.dangerouslySetInnerHTML.__html!=null}var xC=null;function mee(){var d=window.event;return d&&d.type==="popstate"?d===xC?!1:(xC=d,!0):(xC=null,!1)}var X6=typeof setTimeout=="function"?setTimeout:void 0,fee=typeof clearTimeout=="function"?clearTimeout:void 0,Y6=typeof Promise=="function"?Promise:void 0,pee=typeof queueMicrotask=="function"?queueMicrotask:typeof Y6<"u"?function(d){return Y6.resolve(null).then(d).catch(gee)}:X6;function gee(d){setTimeout(function(){throw d})}function Nu(d){return d==="head"}function Q6(d,m){var g=m,w=0;do{var C=g.nextSibling;if(d.removeChild(g),C&&C.nodeType===8)if(g=C.data,g==="/$"||g==="/&"){if(w===0){d.removeChild(C),Lm(m);return}w--}else if(g==="$"||g==="$?"||g==="$~"||g==="$!"||g==="&")w++;else if(g==="html")W0(d.ownerDocument.documentElement);else if(g==="head"){g=d.ownerDocument.head,W0(g);for(var _=g.firstChild;_;){var G=_.nextSibling,ne=_.nodeName;_[ot]||ne==="SCRIPT"||ne==="STYLE"||ne==="LINK"&&_.rel.toLowerCase()==="stylesheet"||g.removeChild(_),_=G}}else g==="body"&&W0(d.ownerDocument.body);g=C}while(g);Lm(m)}function Z6(d,m){var g=d;d=0;do{var w=g.nextSibling;if(g.nodeType===1?m?(g._stashedDisplay=g.style.display,g.style.display="none"):(g.style.display=g._stashedDisplay||"",g.getAttribute("style")===""&&g.removeAttribute("style")):g.nodeType===3&&(m?(g._stashedText=g.nodeValue,g.nodeValue=""):g.nodeValue=g._stashedText||""),w&&w.nodeType===8)if(g=w.data,g==="/$"){if(d===0)break;d--}else g!=="$"&&g!=="$?"&&g!=="$~"&&g!=="$!"||d++;g=w}while(g)}function yC(d){var m=d.firstChild;for(m&&m.nodeType===10&&(m=m.nextSibling);m;){var g=m;switch(m=m.nextSibling,g.nodeName){case"HTML":case"HEAD":case"BODY":yC(g),st(g);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(g.rel.toLowerCase()==="stylesheet")continue}d.removeChild(g)}}function xee(d,m,g,w){for(;d.nodeType===1;){var C=g;if(d.nodeName.toLowerCase()!==m.toLowerCase()){if(!w&&(d.nodeName!=="INPUT"||d.type!=="hidden"))break}else if(w){if(!d[ot])switch(m){case"meta":if(!d.hasAttribute("itemprop"))break;return d;case"link":if(_=d.getAttribute("rel"),_==="stylesheet"&&d.hasAttribute("data-precedence"))break;if(_!==C.rel||d.getAttribute("href")!==(C.href==null||C.href===""?null:C.href)||d.getAttribute("crossorigin")!==(C.crossOrigin==null?null:C.crossOrigin)||d.getAttribute("title")!==(C.title==null?null:C.title))break;return d;case"style":if(d.hasAttribute("data-precedence"))break;return d;case"script":if(_=d.getAttribute("src"),(_!==(C.src==null?null:C.src)||d.getAttribute("type")!==(C.type==null?null:C.type)||d.getAttribute("crossorigin")!==(C.crossOrigin==null?null:C.crossOrigin))&&_&&d.hasAttribute("async")&&!d.hasAttribute("itemprop"))break;return d;default:return d}}else if(m==="input"&&d.type==="hidden"){var _=C.name==null?null:""+C.name;if(C.type==="hidden"&&d.getAttribute("name")===_)return d}else return d;if(d=xo(d.nextSibling),d===null)break}return null}function yee(d,m,g){if(m==="")return null;for(;d.nodeType!==3;)if((d.nodeType!==1||d.nodeName!=="INPUT"||d.type!=="hidden")&&!g||(d=xo(d.nextSibling),d===null))return null;return d}function J6(d,m){for(;d.nodeType!==8;)if((d.nodeType!==1||d.nodeName!=="INPUT"||d.type!=="hidden")&&!m||(d=xo(d.nextSibling),d===null))return null;return d}function bC(d){return d.data==="$?"||d.data==="$~"}function vC(d){return d.data==="$!"||d.data==="$?"&&d.ownerDocument.readyState!=="loading"}function bee(d,m){var g=d.ownerDocument;if(d.data==="$~")d._reactRetry=m;else if(d.data!=="$?"||g.readyState!=="loading")m();else{var w=function(){m(),g.removeEventListener("DOMContentLoaded",w)};g.addEventListener("DOMContentLoaded",w),d._reactRetry=w}}function xo(d){for(;d!=null;d=d.nextSibling){var m=d.nodeType;if(m===1||m===3)break;if(m===8){if(m=d.data,m==="$"||m==="$!"||m==="$?"||m==="$~"||m==="&"||m==="F!"||m==="F")break;if(m==="/$"||m==="/&")return null}}return d}var wC=null;function eP(d){d=d.nextSibling;for(var m=0;d;){if(d.nodeType===8){var g=d.data;if(g==="/$"||g==="/&"){if(m===0)return xo(d.nextSibling);m--}else g!=="$"&&g!=="$!"&&g!=="$?"&&g!=="$~"&&g!=="&"||m++}d=d.nextSibling}return null}function tP(d){d=d.previousSibling;for(var m=0;d;){if(d.nodeType===8){var g=d.data;if(g==="$"||g==="$!"||g==="$?"||g==="$~"||g==="&"){if(m===0)return d;m--}else g!=="/$"&&g!=="/&"||m++}d=d.previousSibling}return null}function nP(d,m,g){switch(m=_v(g),d){case"html":if(d=m.documentElement,!d)throw Error(s(452));return d;case"head":if(d=m.head,!d)throw Error(s(453));return d;case"body":if(d=m.body,!d)throw Error(s(454));return d;default:throw Error(s(451))}}function W0(d){for(var m=d.attributes;m.length;)d.removeAttributeNode(m[0]);st(d)}var yo=new Map,sP=new Set;function Ev(d){return typeof d.getRootNode=="function"?d.getRootNode():d.nodeType===9?d:d.ownerDocument}var hc=K.d;K.d={f:vee,r:wee,D:Nee,C:See,L:jee,m:kee,X:Tee,S:Cee,M:_ee};function vee(){var d=hc.f(),m=vv();return d||m}function wee(d){var m=Qt(d);m!==null&&m.tag===5&&m.type==="form"?vD(m):hc.r(d)}var Om=typeof document>"u"?null:document;function rP(d,m,g){var w=Om;if(w&&typeof m=="string"&&m){var C=Ln(m);C='link[rel="'+d+'"][href="'+C+'"]',typeof g=="string"&&(C+='[crossorigin="'+g+'"]'),sP.has(C)||(sP.add(C),d={rel:d,crossOrigin:g,href:m},w.querySelector(C)===null&&(m=w.createElement("link"),la(m,"link",d),Xt(m),w.head.appendChild(m)))}}function Nee(d){hc.D(d),rP("dns-prefetch",d,null)}function See(d,m){hc.C(d,m),rP("preconnect",d,m)}function jee(d,m,g){hc.L(d,m,g);var w=Om;if(w&&d&&m){var C='link[rel="preload"][as="'+Ln(m)+'"]';m==="image"&&g&&g.imageSrcSet?(C+='[imagesrcset="'+Ln(g.imageSrcSet)+'"]',typeof g.imageSizes=="string"&&(C+='[imagesizes="'+Ln(g.imageSizes)+'"]')):C+='[href="'+Ln(d)+'"]';var _=C;switch(m){case"style":_=Dm(d);break;case"script":_=Pm(d)}yo.has(_)||(d=f({rel:"preload",href:m==="image"&&g&&g.imageSrcSet?void 0:d,as:m},g),yo.set(_,d),w.querySelector(C)!==null||m==="style"&&w.querySelector(H0(_))||m==="script"&&w.querySelector(G0(_))||(m=w.createElement("link"),la(m,"link",d),Xt(m),w.head.appendChild(m)))}}function kee(d,m){hc.m(d,m);var g=Om;if(g&&d){var w=m&&typeof m.as=="string"?m.as:"script",C='link[rel="modulepreload"][as="'+Ln(w)+'"][href="'+Ln(d)+'"]',_=C;switch(w){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":_=Pm(d)}if(!yo.has(_)&&(d=f({rel:"modulepreload",href:d},m),yo.set(_,d),g.querySelector(C)===null)){switch(w){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(g.querySelector(G0(_)))return}w=g.createElement("link"),la(w,"link",d),Xt(w),g.head.appendChild(w)}}}function Cee(d,m,g){hc.S(d,m,g);var w=Om;if(w&&d){var C=Nr(w).hoistableStyles,_=Dm(d);m=m||"default";var G=C.get(_);if(!G){var ne={loading:0,preload:null};if(G=w.querySelector(H0(_)))ne.loading=5;else{d=f({rel:"stylesheet",href:d,"data-precedence":m},g),(g=yo.get(_))&&NC(d,g);var pe=G=w.createElement("link");Xt(pe),la(pe,"link",d),pe._p=new Promise(function(Me,Xe){pe.onload=Me,pe.onerror=Xe}),pe.addEventListener("load",function(){ne.loading|=1}),pe.addEventListener("error",function(){ne.loading|=2}),ne.loading|=4,Av(G,m,w)}G={type:"stylesheet",instance:G,count:1,state:ne},C.set(_,G)}}}function Tee(d,m){hc.X(d,m);var g=Om;if(g&&d){var w=Nr(g).hoistableScripts,C=Pm(d),_=w.get(C);_||(_=g.querySelector(G0(C)),_||(d=f({src:d,async:!0},m),(m=yo.get(C))&&SC(d,m),_=g.createElement("script"),Xt(_),la(_,"link",d),g.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},w.set(C,_))}}function _ee(d,m){hc.M(d,m);var g=Om;if(g&&d){var w=Nr(g).hoistableScripts,C=Pm(d),_=w.get(C);_||(_=g.querySelector(G0(C)),_||(d=f({src:d,async:!0,type:"module"},m),(m=yo.get(C))&&SC(d,m),_=g.createElement("script"),Xt(_),la(_,"link",d),g.head.appendChild(_)),_={type:"script",instance:_,count:1,state:null},w.set(C,_))}}function aP(d,m,g,w){var C=(C=fe.current)?Ev(C):null;if(!C)throw Error(s(446));switch(d){case"meta":case"title":return null;case"style":return typeof g.precedence=="string"&&typeof g.href=="string"?(m=Dm(g.href),g=Nr(C).hoistableStyles,w=g.get(m),w||(w={type:"style",instance:null,count:0,state:null},g.set(m,w)),w):{type:"void",instance:null,count:0,state:null};case"link":if(g.rel==="stylesheet"&&typeof g.href=="string"&&typeof g.precedence=="string"){d=Dm(g.href);var _=Nr(C).hoistableStyles,G=_.get(d);if(G||(C=C.ownerDocument||C,G={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},_.set(d,G),(_=C.querySelector(H0(d)))&&!_._p&&(G.instance=_,G.state.loading=5),yo.has(d)||(g={rel:"preload",as:"style",href:g.href,crossOrigin:g.crossOrigin,integrity:g.integrity,media:g.media,hrefLang:g.hrefLang,referrerPolicy:g.referrerPolicy},yo.set(d,g),_||Eee(C,d,g,G.state))),m&&w===null)throw Error(s(528,""));return G}if(m&&w!==null)throw Error(s(529,""));return null;case"script":return m=g.async,g=g.src,typeof g=="string"&&m&&typeof m!="function"&&typeof m!="symbol"?(m=Pm(g),g=Nr(C).hoistableScripts,w=g.get(m),w||(w={type:"script",instance:null,count:0,state:null},g.set(m,w)),w):{type:"void",instance:null,count:0,state:null};default:throw Error(s(444,d))}}function Dm(d){return'href="'+Ln(d)+'"'}function H0(d){return'link[rel="stylesheet"]['+d+"]"}function iP(d){return f({},d,{"data-precedence":d.precedence,precedence:null})}function Eee(d,m,g,w){d.querySelector('link[rel="preload"][as="style"]['+m+"]")?w.loading=1:(m=d.createElement("link"),w.preload=m,m.addEventListener("load",function(){return w.loading|=1}),m.addEventListener("error",function(){return w.loading|=2}),la(m,"link",g),Xt(m),d.head.appendChild(m))}function Pm(d){return'[src="'+Ln(d)+'"]'}function G0(d){return"script[async]"+d}function oP(d,m,g){if(m.count++,m.instance===null)switch(m.type){case"style":var w=d.querySelector('style[data-href~="'+Ln(g.href)+'"]');if(w)return m.instance=w,Xt(w),w;var C=f({},g,{"data-href":g.href,"data-precedence":g.precedence,href:null,precedence:null});return w=(d.ownerDocument||d).createElement("style"),Xt(w),la(w,"style",C),Av(w,g.precedence,d),m.instance=w;case"stylesheet":C=Dm(g.href);var _=d.querySelector(H0(C));if(_)return m.state.loading|=4,m.instance=_,Xt(_),_;w=iP(g),(C=yo.get(C))&&NC(w,C),_=(d.ownerDocument||d).createElement("link"),Xt(_);var G=_;return G._p=new Promise(function(ne,pe){G.onload=ne,G.onerror=pe}),la(_,"link",w),m.state.loading|=4,Av(_,g.precedence,d),m.instance=_;case"script":return _=Pm(g.src),(C=d.querySelector(G0(_)))?(m.instance=C,Xt(C),C):(w=g,(C=yo.get(_))&&(w=f({},g),SC(w,C)),d=d.ownerDocument||d,C=d.createElement("script"),Xt(C),la(C,"link",w),d.head.appendChild(C),m.instance=C);case"void":return null;default:throw Error(s(443,m.type))}else m.type==="stylesheet"&&(m.state.loading&4)===0&&(w=m.instance,m.state.loading|=4,Av(w,g.precedence,d));return m.instance}function Av(d,m,g){for(var w=g.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),C=w.length?w[w.length-1]:null,_=C,G=0;G<w.length;G++){var ne=w[G];if(ne.dataset.precedence===m)_=ne;else if(_!==C)break}_?_.parentNode.insertBefore(d,_.nextSibling):(m=g.nodeType===9?g.head:g,m.insertBefore(d,m.firstChild))}function NC(d,m){d.crossOrigin==null&&(d.crossOrigin=m.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=m.referrerPolicy),d.title==null&&(d.title=m.title)}function SC(d,m){d.crossOrigin==null&&(d.crossOrigin=m.crossOrigin),d.referrerPolicy==null&&(d.referrerPolicy=m.referrerPolicy),d.integrity==null&&(d.integrity=m.integrity)}var $v=null;function lP(d,m,g){if($v===null){var w=new Map,C=$v=new Map;C.set(g,w)}else C=$v,w=C.get(g),w||(w=new Map,C.set(g,w));if(w.has(d))return w;for(w.set(d,null),g=g.getElementsByTagName(d),C=0;C<g.length;C++){var _=g[C];if(!(_[ot]||_[us]||d==="link"&&_.getAttribute("rel")==="stylesheet")&&_.namespaceURI!=="http://www.w3.org/2000/svg"){var G=_.getAttribute(m)||"";G=d+G;var ne=w.get(G);ne?ne.push(_):w.set(G,[_])}}return w}function cP(d,m,g){d=d.ownerDocument||d,d.head.insertBefore(g,m==="title"?d.querySelector("head > title"):null)}function Aee(d,m,g){if(g===1||m.itemProp!=null)return!1;switch(d){case"meta":case"title":return!0;case"style":if(typeof m.precedence!="string"||typeof m.href!="string"||m.href==="")break;return!0;case"link":if(typeof m.rel!="string"||typeof m.href!="string"||m.href===""||m.onLoad||m.onError)break;switch(m.rel){case"stylesheet":return d=m.disabled,typeof m.precedence=="string"&&d==null;default:return!0}case"script":if(m.async&&typeof m.async!="function"&&typeof m.async!="symbol"&&!m.onLoad&&!m.onError&&m.src&&typeof m.src=="string")return!0}return!1}function uP(d){return!(d.type==="stylesheet"&&(d.state.loading&3)===0)}function $ee(d,m,g,w){if(g.type==="stylesheet"&&(typeof w.media!="string"||matchMedia(w.media).matches!==!1)&&(g.state.loading&4)===0){if(g.instance===null){var C=Dm(w.href),_=m.querySelector(H0(C));if(_){m=_._p,m!==null&&typeof m=="object"&&typeof m.then=="function"&&(d.count++,d=Iv.bind(d),m.then(d,d)),g.state.loading|=4,g.instance=_,Xt(_);return}_=m.ownerDocument||m,w=iP(w),(C=yo.get(C))&&NC(w,C),_=_.createElement("link"),Xt(_);var G=_;G._p=new Promise(function(ne,pe){G.onload=ne,G.onerror=pe}),la(_,"link",w),g.instance=_}d.stylesheets===null&&(d.stylesheets=new Map),d.stylesheets.set(g,m),(m=g.state.preload)&&(g.state.loading&3)===0&&(d.count++,g=Iv.bind(d),m.addEventListener("load",g),m.addEventListener("error",g))}}var jC=0;function Iee(d,m){return d.stylesheets&&d.count===0&&Ov(d,d.stylesheets),0<d.count||0<d.imgCount?function(g){var w=setTimeout(function(){if(d.stylesheets&&Ov(d,d.stylesheets),d.unsuspend){var _=d.unsuspend;d.unsuspend=null,_()}},6e4+m);0<d.imgBytes&&jC===0&&(jC=62500*hee());var C=setTimeout(function(){if(d.waitingForImages=!1,d.count===0&&(d.stylesheets&&Ov(d,d.stylesheets),d.unsuspend)){var _=d.unsuspend;d.unsuspend=null,_()}},(d.imgBytes>jC?50:800)+m);return d.unsuspend=g,function(){d.unsuspend=null,clearTimeout(w),clearTimeout(C)}}:null}function Iv(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)Ov(this,this.stylesheets);else if(this.unsuspend){var d=this.unsuspend;this.unsuspend=null,d()}}}var Rv=null;function Ov(d,m){d.stylesheets=null,d.unsuspend!==null&&(d.count++,Rv=new Map,m.forEach(Ree,d),Rv=null,Iv.call(d))}function Ree(d,m){if(!(m.state.loading&4)){var g=Rv.get(d);if(g)var w=g.get(null);else{g=new Map,Rv.set(d,g);for(var C=d.querySelectorAll("link[data-precedence],style[data-precedence]"),_=0;_<C.length;_++){var G=C[_];(G.nodeName==="LINK"||G.getAttribute("media")!=="not all")&&(g.set(G.dataset.precedence,G),w=G)}w&&g.set(null,w)}C=m.instance,G=C.getAttribute("data-precedence"),_=g.get(G)||w,_===w&&g.set(null,C),g.set(G,C),this.count++,w=Iv.bind(this),C.addEventListener("load",w),C.addEventListener("error",w),_?_.parentNode.insertBefore(C,_.nextSibling):(d=d.nodeType===9?d.head:d,d.insertBefore(C,d.firstChild)),m.state.loading|=4}}var q0={$$typeof:k,Provider:null,Consumer:null,_currentValue:H,_currentValue2:H,_threadCount:0};function Oee(d,m,g,w,C,_,G,ne,pe){this.tag=1,this.containerInfo=d,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=vr(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=vr(0),this.hiddenUpdates=vr(null),this.identifierPrefix=w,this.onUncaughtError=C,this.onCaughtError=_,this.onRecoverableError=G,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=pe,this.incompleteTransitions=new Map}function dP(d,m,g,w,C,_,G,ne,pe,Me,Xe,et){return d=new Oee(d,m,g,G,pe,Me,Xe,et,ne),m=1,_===!0&&(m|=24),_=_i(3,null,null,m),d.current=_,_.stateNode=d,m=sk(),m.refCount++,d.pooledCache=m,m.refCount++,_.memoizedState={element:w,isDehydrated:g,cache:m},ok(_),d}function hP(d){return d?(d=mm,d):mm}function mP(d,m,g,w,C,_){C=hP(C),w.context===null?w.context=C:w.pendingContext=C,w=du(m),w.payload={element:g},_=_===void 0?null:_,_!==null&&(w.callback=_),g=hu(d,w,m),g!==null&&(si(g,d,m),k0(g,d,m))}function fP(d,m){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var g=d.retryLane;d.retryLane=g!==0&&g<m?g:m}}function kC(d,m){fP(d,m),(d=d.alternate)&&fP(d,m)}function pP(d){if(d.tag===13||d.tag===31){var m=vd(d,67108864);m!==null&&si(m,d,67108864),kC(d,67108864)}}function gP(d){if(d.tag===13||d.tag===31){var m=Ri();m=Si(m);var g=vd(d,m);g!==null&&si(g,d,m),kC(d,m)}}var Dv=!0;function Dee(d,m,g,w){var C=z.T;z.T=null;var _=K.p;try{K.p=2,CC(d,m,g,w)}finally{K.p=_,z.T=C}}function Pee(d,m,g,w){var C=z.T;z.T=null;var _=K.p;try{K.p=8,CC(d,m,g,w)}finally{K.p=_,z.T=C}}function CC(d,m,g,w){if(Dv){var C=TC(w);if(C===null)hC(d,m,w,Pv,g),yP(d,w);else if(Mee(C,d,m,g,w))w.stopPropagation();else if(yP(d,w),m&4&&-1<Lee.indexOf(d)){for(;C!==null;){var _=Qt(C);if(_!==null)switch(_.tag){case 3:if(_=_.stateNode,_.current.memoizedState.isDehydrated){var G=Ds(_.pendingLanes);if(G!==0){var ne=_;for(ne.pendingLanes|=2,ne.entangledLanes|=2;G;){var pe=1<<31-lt(G);ne.entanglements[1]|=pe,G&=~pe}Sl(_),(Bn&6)===0&&(yv=Oe()+500,B0(0))}}break;case 31:case 13:ne=vd(_,2),ne!==null&&si(ne,_,2),vv(),kC(_,2)}if(_=TC(w),_===null&&hC(d,m,w,Pv,g),_===C)break;C=_}C!==null&&w.stopPropagation()}else hC(d,m,w,null,g)}}function TC(d){return d=u0(d),_C(d)}var Pv=null;function _C(d){if(Pv=null,d=_t(d),d!==null){var m=a(d);if(m===null)d=null;else{var g=m.tag;if(g===13){if(d=i(m),d!==null)return d;d=null}else if(g===31){if(d=l(m),d!==null)return d;d=null}else if(g===3){if(m.stateNode.current.memoizedState.isDehydrated)return m.tag===3?m.stateNode.containerInfo:null;d=null}else m!==d&&(d=null)}}return Pv=d,null}function xP(d){switch(d){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ht()){case ut:return 2;case Q:return 8;case L:case M:return 32;case ee:return 268435456;default:return 32}default:return 32}}var EC=!1,Su=null,ju=null,ku=null,K0=new Map,X0=new Map,Cu=[],Lee="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function yP(d,m){switch(d){case"focusin":case"focusout":Su=null;break;case"dragenter":case"dragleave":ju=null;break;case"mouseover":case"mouseout":ku=null;break;case"pointerover":case"pointerout":K0.delete(m.pointerId);break;case"gotpointercapture":case"lostpointercapture":X0.delete(m.pointerId)}}function Y0(d,m,g,w,C,_){return d===null||d.nativeEvent!==_?(d={blockedOn:m,domEventName:g,eventSystemFlags:w,nativeEvent:_,targetContainers:[C]},m!==null&&(m=Qt(m),m!==null&&pP(m)),d):(d.eventSystemFlags|=w,m=d.targetContainers,C!==null&&m.indexOf(C)===-1&&m.push(C),d)}function Mee(d,m,g,w,C){switch(m){case"focusin":return Su=Y0(Su,d,m,g,w,C),!0;case"dragenter":return ju=Y0(ju,d,m,g,w,C),!0;case"mouseover":return ku=Y0(ku,d,m,g,w,C),!0;case"pointerover":var _=C.pointerId;return K0.set(_,Y0(K0.get(_)||null,d,m,g,w,C)),!0;case"gotpointercapture":return _=C.pointerId,X0.set(_,Y0(X0.get(_)||null,d,m,g,w,C)),!0}return!1}function bP(d){var m=_t(d.target);if(m!==null){var g=a(m);if(g!==null){if(m=g.tag,m===13){if(m=i(g),m!==null){d.blockedOn=m,zo(d.priority,function(){gP(g)});return}}else if(m===31){if(m=l(g),m!==null){d.blockedOn=m,zo(d.priority,function(){gP(g)});return}}else if(m===3&&g.stateNode.current.memoizedState.isDehydrated){d.blockedOn=g.tag===3?g.stateNode.containerInfo:null;return}}}d.blockedOn=null}function Lv(d){if(d.blockedOn!==null)return!1;for(var m=d.targetContainers;0<m.length;){var g=TC(d.nativeEvent);if(g===null){g=d.nativeEvent;var w=new g.constructor(g.type,g);io=w,g.target.dispatchEvent(w),io=null}else return m=Qt(g),m!==null&&pP(m),d.blockedOn=g,!1;m.shift()}return!0}function vP(d,m,g){Lv(d)&&g.delete(m)}function Fee(){EC=!1,Su!==null&&Lv(Su)&&(Su=null),ju!==null&&Lv(ju)&&(ju=null),ku!==null&&Lv(ku)&&(ku=null),K0.forEach(vP),X0.forEach(vP)}function Mv(d,m){d.blockedOn===m&&(d.blockedOn=null,EC||(EC=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,Fee)))}var Fv=null;function wP(d){Fv!==d&&(Fv=d,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){Fv===d&&(Fv=null);for(var m=0;m<d.length;m+=3){var g=d[m],w=d[m+1],C=d[m+2];if(typeof w!="function"){if(_C(w||g)===null)continue;break}var _=Qt(g);_!==null&&(d.splice(m,3),m-=3,Tk(_,{pending:!0,data:C,method:g.method,action:w},w,C))}}))}function Lm(d){function m(pe){return Mv(pe,d)}Su!==null&&Mv(Su,d),ju!==null&&Mv(ju,d),ku!==null&&Mv(ku,d),K0.forEach(m),X0.forEach(m);for(var g=0;g<Cu.length;g++){var w=Cu[g];w.blockedOn===d&&(w.blockedOn=null)}for(;0<Cu.length&&(g=Cu[0],g.blockedOn===null);)bP(g),g.blockedOn===null&&Cu.shift();if(g=(d.ownerDocument||d).$$reactFormReplay,g!=null)for(w=0;w<g.length;w+=3){var C=g[w],_=g[w+1],G=C[Ps]||null;if(typeof _=="function")G||wP(g);else if(G){var ne=null;if(_&&_.hasAttribute("formAction")){if(C=_,G=_[Ps]||null)ne=G.formAction;else if(_C(C)!==null)continue}else ne=G.action;typeof ne=="function"?g[w+1]=ne:(g.splice(w,3),w-=3),wP(g)}}}function NP(){function d(_){_.canIntercept&&_.info==="react-transition"&&_.intercept({handler:function(){return new Promise(function(G){return C=G})},focusReset:"manual",scroll:"manual"})}function m(){C!==null&&(C(),C=null),w||setTimeout(g,20)}function g(){if(!w&&!navigation.transition){var _=navigation.currentEntry;_&&_.url!=null&&navigation.navigate(_.url,{state:_.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var w=!1,C=null;return navigation.addEventListener("navigate",d),navigation.addEventListener("navigatesuccess",m),navigation.addEventListener("navigateerror",m),setTimeout(g,100),function(){w=!0,navigation.removeEventListener("navigate",d),navigation.removeEventListener("navigatesuccess",m),navigation.removeEventListener("navigateerror",m),C!==null&&(C(),C=null)}}}function AC(d){this._internalRoot=d}zv.prototype.render=AC.prototype.render=function(d){var m=this._internalRoot;if(m===null)throw Error(s(409));var g=m.current,w=Ri();mP(g,w,d,m,null,null)},zv.prototype.unmount=AC.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var m=d.containerInfo;mP(d.current,2,null,d,null,null),vv(),m[$a]=null}};function zv(d){this._internalRoot=d}zv.prototype.unstable_scheduleHydration=function(d){if(d){var m=ji();d={blockedOn:null,target:d,priority:m};for(var g=0;g<Cu.length&&m!==0&&m<Cu[g].priority;g++);Cu.splice(g,0,d),g===0&&bP(d)}};var SP=e.version;if(SP!=="19.2.0")throw Error(s(527,SP,"19.2.0"));K.findDOMNode=function(d){var m=d._reactInternals;if(m===void 0)throw typeof d.render=="function"?Error(s(188)):(d=Object.keys(d).join(","),Error(s(268,d)));return d=u(m),d=d!==null?h(d):null,d=d===null?null:d.stateNode,d};var zee={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:z,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Bv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Bv.isDisabled&&Bv.supportsFiber)try{De=Bv.inject(zee),xt=Bv}catch{}}return Z0.createRoot=function(d,m){if(!r(d))throw Error(s(299));var g=!1,w="",C=AD,_=$D,G=ID;return m!=null&&(m.unstable_strictMode===!0&&(g=!0),m.identifierPrefix!==void 0&&(w=m.identifierPrefix),m.onUncaughtError!==void 0&&(C=m.onUncaughtError),m.onCaughtError!==void 0&&(_=m.onCaughtError),m.onRecoverableError!==void 0&&(G=m.onRecoverableError)),m=dP(d,1,!1,null,null,g,w,null,C,_,G,NP),d[$a]=m.current,dC(d),new AC(m)},Z0.hydrateRoot=function(d,m,g){if(!r(d))throw Error(s(299));var w=!1,C="",_=AD,G=$D,ne=ID,pe=null;return g!=null&&(g.unstable_strictMode===!0&&(w=!0),g.identifierPrefix!==void 0&&(C=g.identifierPrefix),g.onUncaughtError!==void 0&&(_=g.onUncaughtError),g.onCaughtError!==void 0&&(G=g.onCaughtError),g.onRecoverableError!==void 0&&(ne=g.onRecoverableError),g.formState!==void 0&&(pe=g.formState)),m=dP(d,1,!0,m,g??null,w,C,pe,_,G,ne,NP),m.context=hP(null),g=m.current,w=Ri(),w=Si(w),C=du(w),C.callback=null,hu(g,C,w),g=w,m.current.lanes=g,na(m,g),Sl(m),d[$a]=m.current,dC(d),new zv(m)},Z0.version="19.2.0",Z0}var RP;function Jee(){if(RP)return OC.exports;RP=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),OC.exports=Zee(),OC.exports}var ete=Jee();/**
 * react-router v7.12.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var OP="popstate";function tte(t={}){function e(s,r){let{pathname:a,search:i,hash:l}=s.location;return B3("",{pathname:a,search:i,hash:l},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(s,r){return typeof r=="string"?r:Dg(r)}return ste(e,n,null,t)}function Is(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Xi(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function nte(){return Math.random().toString(36).substring(2,10)}function DP(t,e){return{usr:t.state,key:t.key,idx:e}}function B3(t,e,n=null,s){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?_f(e):e,state:n,key:e&&e.key||s||nte()}}function Dg({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function _f(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substring(s),t=t.substring(0,s)),t&&(e.pathname=t)}return e}function ste(t,e,n,s={}){let{window:r=document.defaultView,v5Compat:a=!1}=s,i=r.history,l="POP",c=null,u=h();u==null&&(u=0,i.replaceState({...i.state,idx:u},""));function h(){return(i.state||{idx:null}).idx}function f(){l="POP";let b=h(),N=b==null?null:b-u;u=b,c&&c({action:l,location:v.location,delta:N})}function p(b,N){l="PUSH";let S=B3(v.location,b,N);u=h()+1;let k=DP(S,u),T=v.createHref(S);try{i.pushState(k,"",T)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;r.location.assign(T)}a&&c&&c({action:l,location:v.location,delta:1})}function x(b,N){l="REPLACE";let S=B3(v.location,b,N);u=h();let k=DP(S,u),T=v.createHref(S);i.replaceState(k,"",T),a&&c&&c({action:l,location:v.location,delta:0})}function y(b){return rte(b)}let v={get action(){return l},get location(){return t(r,i)},listen(b){if(c)throw new Error("A history only accepts one active listener");return r.addEventListener(OP,f),c=b,()=>{r.removeEventListener(OP,f),c=null}},createHref(b){return e(r,b)},createURL:y,encodeLocation(b){let N=y(b);return{pathname:N.pathname,search:N.search,hash:N.hash}},push:p,replace:x,go(b){return i.go(b)}};return v}function rte(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Is(n,"No window.location.(origin|href) available to create URL");let s=typeof t=="string"?t:Dg(t);return s=s.replace(/ $/,"%20"),!e&&s.startsWith("//")&&(s=n+s),new URL(s,n)}function c7(t,e,n="/"){return ate(t,e,n,!1)}function ate(t,e,n,s){let r=typeof e=="string"?_f(e):e,a=Tc(r.pathname||"/",n);if(a==null)return null;let i=u7(t);ite(i);let l=null;for(let c=0;l==null&&c<i.length;++c){let u=xte(a);l=pte(i[c],u,s)}return l}function u7(t,e=[],n=[],s="",r=!1){let a=(i,l,c=r,u)=>{let h={relativePath:u===void 0?i.path||"":u,caseSensitive:i.caseSensitive===!0,childrenIndex:l,route:i};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(s)&&c)return;Is(h.relativePath.startsWith(s),`Absolute route path "${h.relativePath}" nested under path "${s}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(s.length)}let f=Sc([s,h.relativePath]),p=n.concat(h);i.children&&i.children.length>0&&(Is(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${f}".`),u7(i.children,e,p,f,c)),!(i.path==null&&!i.index)&&e.push({path:f,score:mte(f,i.index),routesMeta:p})};return t.forEach((i,l)=>{var c;if(i.path===""||!((c=i.path)!=null&&c.includes("?")))a(i,l);else for(let u of d7(i.path))a(i,l,!0,u)}),e}function d7(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,r=n.endsWith("?"),a=n.replace(/\?$/,"");if(s.length===0)return r?[a,""]:[a];let i=d7(s.join("/")),l=[];return l.push(...i.map(c=>c===""?a:[a,c].join("/"))),r&&l.push(...i),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function ite(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:fte(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}var ote=/^:[\w-]+$/,lte=3,cte=2,ute=1,dte=10,hte=-2,PP=t=>t==="*";function mte(t,e){let n=t.split("/"),s=n.length;return n.some(PP)&&(s+=hte),e&&(s+=cte),n.filter(r=>!PP(r)).reduce((r,a)=>r+(ote.test(a)?lte:a===""?ute:dte),s)}function fte(t,e){return t.length===e.length&&t.slice(0,-1).every((s,r)=>s===e[r])?t[t.length-1]-e[e.length-1]:0}function pte(t,e,n=!1){let{routesMeta:s}=t,r={},a="/",i=[];for(let l=0;l<s.length;++l){let c=s[l],u=l===s.length-1,h=a==="/"?e:e.slice(a.length)||"/",f=J1({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},h),p=c.route;if(!f&&u&&n&&!s[s.length-1].route.index&&(f=J1({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},h)),!f)return null;Object.assign(r,f.params),i.push({params:r,pathname:Sc([a,f.pathname]),pathnameBase:wte(Sc([a,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(a=Sc([a,f.pathnameBase]))}return i}function J1(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=gte(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let a=r[0],i=a.replace(/(.)\/+$/,"$1"),l=r.slice(1);return{params:s.reduce((u,{paramName:h,isOptional:f},p)=>{if(h==="*"){let y=l[p]||"";i=a.slice(0,a.length-y.length).replace(/(.)\/+$/,"$1")}const x=l[p];return f&&!x?u[h]=void 0:u[h]=(x||"").replace(/%2F/g,"/"),u},{}),pathname:a,pathnameBase:i,pattern:t}}function gte(t,e=!1,n=!0){Xi(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let s=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,l,c)=>(s.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(s.push({paramName:"*"}),r+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":t!==""&&t!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),s]}function xte(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Xi(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Tc(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}var h7=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,yte=t=>h7.test(t);function bte(t,e="/"){let{pathname:n,search:s="",hash:r=""}=typeof t=="string"?_f(t):t,a;if(n)if(yte(n))a=n;else{if(n.includes("//")){let i=n;n=n.replace(/\/\/+/g,"/"),Xi(!1,`Pathnames cannot have embedded double slashes - normalizing ${i} -> ${n}`)}n.startsWith("/")?a=LP(n.substring(1),"/"):a=LP(n,e)}else a=e;return{pathname:a,search:Nte(s),hash:Ste(r)}}function LP(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function MC(t,e,n,s){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(s)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function vte(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function HE(t){let e=vte(t);return e.map((n,s)=>s===e.length-1?n.pathname:n.pathnameBase)}function GE(t,e,n,s=!1){let r;typeof t=="string"?r=_f(t):(r={...t},Is(!r.pathname||!r.pathname.includes("?"),MC("?","pathname","search",r)),Is(!r.pathname||!r.pathname.includes("#"),MC("#","pathname","hash",r)),Is(!r.search||!r.search.includes("#"),MC("#","search","hash",r)));let a=t===""||r.pathname==="",i=a?"/":r.pathname,l;if(i==null)l=n;else{let f=e.length-1;if(!s&&i.startsWith("..")){let p=i.split("/");for(;p[0]==="..";)p.shift(),f-=1;r.pathname=p.join("/")}l=f>=0?e[f]:"/"}let c=bte(r,l),u=i&&i!=="/"&&i.endsWith("/"),h=(a||i===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||h)&&(c.pathname+="/"),c}var Sc=t=>t.join("/").replace(/\/\/+/g,"/"),wte=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Nte=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Ste=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t,jte=class{constructor(t,e,n,s=!1){this.status=t,this.statusText=e||"",this.internal=s,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function kte(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}function Cte(t){return t.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var m7=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function f7(t,e){let n=t;if(typeof n!="string"||!h7.test(n))return{absoluteURL:void 0,isExternal:!1,to:n};let s=n,r=!1;if(m7)try{let a=new URL(window.location.href),i=n.startsWith("//")?new URL(a.protocol+n):new URL(n),l=Tc(i.pathname,e);i.origin===a.origin&&l!=null?n=l+i.search+i.hash:r=!0}catch{Xi(!1,`<Link to="${n}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:s,isExternal:r,to:n}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var p7=["POST","PUT","PATCH","DELETE"];new Set(p7);var Tte=["GET",...p7];new Set(Tte);var Ef=j.createContext(null);Ef.displayName="DataRouter";var N2=j.createContext(null);N2.displayName="DataRouterState";var _te=j.createContext(!1),g7=j.createContext({isTransitioning:!1});g7.displayName="ViewTransition";var Ete=j.createContext(new Map);Ete.displayName="Fetchers";var Ate=j.createContext(null);Ate.displayName="Await";var to=j.createContext(null);to.displayName="Navigation";var bx=j.createContext(null);bx.displayName="Location";var hl=j.createContext({outlet:null,matches:[],isDataRoute:!1});hl.displayName="Route";var qE=j.createContext(null);qE.displayName="RouteError";var x7="REACT_ROUTER_ERROR",$te="REDIRECT",Ite="ROUTE_ERROR_RESPONSE";function Rte(t){if(t.startsWith(`${x7}:${$te}:{`))try{let e=JSON.parse(t.slice(28));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.location=="string"&&typeof e.reloadDocument=="boolean"&&typeof e.replace=="boolean")return e}catch{}}function Ote(t){if(t.startsWith(`${x7}:${Ite}:{`))try{let e=JSON.parse(t.slice(40));if(typeof e=="object"&&e&&typeof e.status=="number"&&typeof e.statusText=="string")return new jte(e.status,e.statusText,e.data)}catch{}}function Dte(t,{relative:e}={}){Is(Af(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:s}=j.useContext(to),{hash:r,pathname:a,search:i}=vx(t,{relative:e}),l=a;return n!=="/"&&(l=a==="/"?n:Sc([n,a])),s.createHref({pathname:l,search:i,hash:r})}function Af(){return j.useContext(bx)!=null}function vi(){return Is(Af(),"useLocation() may be used only in the context of a <Router> component."),j.useContext(bx).location}var y7="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function b7(t){j.useContext(to).static||j.useLayoutEffect(t)}function qr(){let{isDataRoute:t}=j.useContext(hl);return t?Yte():Pte()}function Pte(){Is(Af(),"useNavigate() may be used only in the context of a <Router> component.");let t=j.useContext(Ef),{basename:e,navigator:n}=j.useContext(to),{matches:s}=j.useContext(hl),{pathname:r}=vi(),a=JSON.stringify(HE(s)),i=j.useRef(!1);return b7(()=>{i.current=!0}),j.useCallback((c,u={})=>{if(Xi(i.current,y7),!i.current)return;if(typeof c=="number"){n.go(c);return}let h=GE(c,JSON.parse(a),r,u.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Sc([e,h.pathname])),(u.replace?n.replace:n.push)(h,u.state,u)},[e,n,a,r,t])}var Lte=j.createContext(null);function Mte(t){let e=j.useContext(hl).outlet;return j.useMemo(()=>e&&j.createElement(Lte.Provider,{value:t},e),[e,t])}function vx(t,{relative:e}={}){let{matches:n}=j.useContext(hl),{pathname:s}=vi(),r=JSON.stringify(HE(n));return j.useMemo(()=>GE(t,JSON.parse(r),s,e==="path"),[t,r,s,e])}function Fte(t,e){return v7(t,e)}function v7(t,e,n,s,r){var S;Is(Af(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=j.useContext(to),{matches:i}=j.useContext(hl),l=i[i.length-1],c=l?l.params:{},u=l?l.pathname:"/",h=l?l.pathnameBase:"/",f=l&&l.route;{let k=f&&f.path||"";N7(u,!f||k.endsWith("*")||k.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${k}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${k}"> to <Route path="${k==="/"?"*":`${k}/*`}">.`)}let p=vi(),x;if(e){let k=typeof e=="string"?_f(e):e;Is(h==="/"||((S=k.pathname)==null?void 0:S.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${k.pathname}" was given in the \`location\` prop.`),x=k}else x=p;let y=x.pathname||"/",v=y;if(h!=="/"){let k=h.replace(/^\//,"").split("/");v="/"+y.replace(/^\//,"").split("/").slice(k.length).join("/")}let b=c7(t,{pathname:v});Xi(f||b!=null,`No routes matched location "${x.pathname}${x.search}${x.hash}" `),Xi(b==null||b[b.length-1].route.element!==void 0||b[b.length-1].route.Component!==void 0||b[b.length-1].route.lazy!==void 0,`Matched leaf route at location "${x.pathname}${x.search}${x.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let N=Wte(b&&b.map(k=>Object.assign({},k,{params:Object.assign({},c,k.params),pathname:Sc([h,a.encodeLocation?a.encodeLocation(k.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:k.pathname]),pathnameBase:k.pathnameBase==="/"?h:Sc([h,a.encodeLocation?a.encodeLocation(k.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:k.pathnameBase])})),i,n,s,r);return e&&N?j.createElement(bx.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...x},navigationType:"POP"}},N):N}function zte(){let t=Xte(),e=kte(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:s},a={padding:"2px 4px",backgroundColor:s},i=null;return console.error("Error handled by React Router default ErrorBoundary:",t),i=j.createElement(j.Fragment,null,j.createElement("p",null," Hey developer "),j.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",j.createElement("code",{style:a},"ErrorBoundary")," or"," ",j.createElement("code",{style:a},"errorElement")," prop on your route.")),j.createElement(j.Fragment,null,j.createElement("h2",null,"Unexpected Application Error!"),j.createElement("h3",{style:{fontStyle:"italic"}},e),n?j.createElement("pre",{style:r},n):null,i)}var Bte=j.createElement(zte,null),w7=class extends j.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){let t=this.state.error;if(this.context&&typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){const n=Ote(t.digest);n&&(t=n)}let e=t!==void 0?j.createElement(hl.Provider,{value:this.props.routeContext},j.createElement(qE.Provider,{value:t,children:this.props.component})):this.props.children;return this.context?j.createElement(Ute,{error:t},e):e}};w7.contextType=_te;var FC=new WeakMap;function Ute({children:t,error:e}){let{basename:n}=j.useContext(to);if(typeof e=="object"&&e&&"digest"in e&&typeof e.digest=="string"){let s=Rte(e.digest);if(s){let r=FC.get(e);if(r)throw r;let a=f7(s.location,n);if(m7&&!FC.get(e))if(a.isExternal||s.reloadDocument)window.location.href=a.absoluteURL||a.to;else{const i=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(a.to,{replace:s.replace}));throw FC.set(e,i),i}return j.createElement("meta",{httpEquiv:"refresh",content:`0;url=${a.absoluteURL||a.to}`})}}return t}function Vte({routeContext:t,match:e,children:n}){let s=j.useContext(Ef);return s&&s.static&&s.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=e.route.id),j.createElement(hl.Provider,{value:t},n)}function Wte(t,e=[],n=null,s=null,r=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let a=t,i=n==null?void 0:n.errors;if(i!=null){let h=a.findIndex(f=>f.route.id&&(i==null?void 0:i[f.route.id])!==void 0);Is(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),a=a.slice(0,Math.min(a.length,h+1))}let l=!1,c=-1;if(n)for(let h=0;h<a.length;h++){let f=a[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(c=h),f.route.id){let{loaderData:p,errors:x}=n,y=f.route.loader&&!p.hasOwnProperty(f.route.id)&&(!x||x[f.route.id]===void 0);if(f.route.lazy||y){l=!0,c>=0?a=a.slice(0,c+1):a=[a[0]];break}}}let u=n&&s?(h,f)=>{var p,x;s(h,{location:n.location,params:((x=(p=n.matches)==null?void 0:p[0])==null?void 0:x.params)??{},unstable_pattern:Cte(n.matches),errorInfo:f})}:void 0;return a.reduceRight((h,f,p)=>{let x,y=!1,v=null,b=null;n&&(x=i&&f.route.id?i[f.route.id]:void 0,v=f.route.errorElement||Bte,l&&(c<0&&p===0?(N7("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),y=!0,b=null):c===p&&(y=!0,b=f.route.hydrateFallbackElement||null)));let N=e.concat(a.slice(0,p+1)),S=()=>{let k;return x?k=v:y?k=b:f.route.Component?k=j.createElement(f.route.Component,null):f.route.element?k=f.route.element:k=h,j.createElement(Vte,{match:f,routeContext:{outlet:h,matches:N,isDataRoute:n!=null},children:k})};return n&&(f.route.ErrorBoundary||f.route.errorElement||p===0)?j.createElement(w7,{location:n.location,revalidation:n.revalidation,component:v,error:x,children:S(),routeContext:{outlet:null,matches:N,isDataRoute:!0},onError:u}):S()},null)}function KE(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Hte(t){let e=j.useContext(Ef);return Is(e,KE(t)),e}function Gte(t){let e=j.useContext(N2);return Is(e,KE(t)),e}function qte(t){let e=j.useContext(hl);return Is(e,KE(t)),e}function XE(t){let e=qte(t),n=e.matches[e.matches.length-1];return Is(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function Kte(){return XE("useRouteId")}function Xte(){var s;let t=j.useContext(qE),e=Gte("useRouteError"),n=XE("useRouteError");return t!==void 0?t:(s=e.errors)==null?void 0:s[n]}function Yte(){let{router:t}=Hte("useNavigate"),e=XE("useNavigate"),n=j.useRef(!1);return b7(()=>{n.current=!0}),j.useCallback(async(r,a={})=>{Xi(n.current,y7),n.current&&(typeof r=="number"?await t.navigate(r):await t.navigate(r,{fromRouteId:e,...a}))},[t,e])}var MP={};function N7(t,e,n){!e&&!MP[t]&&(MP[t]=!0,Xi(!1,n))}j.memo(Qte);function Qte({routes:t,future:e,state:n,onError:s}){return v7(t,void 0,n,s,e)}function nl({to:t,replace:e,state:n,relative:s}){Is(Af(),"<Navigate> may be used only in the context of a <Router> component.");let{static:r}=j.useContext(to);Xi(!r,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:a}=j.useContext(hl),{pathname:i}=vi(),l=qr(),c=GE(t,HE(a),i,s==="path"),u=JSON.stringify(c);return j.useEffect(()=>{l(JSON.parse(u),{replace:e,state:n,relative:s})},[l,u,s,e,n]),null}function Zte(t){return Mte(t.context)}function rn(t){Is(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Jte({basename:t="/",children:e=null,location:n,navigationType:s="POP",navigator:r,static:a=!1,unstable_useTransitions:i}){Is(!Af(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let l=t.replace(/^\/*/,"/"),c=j.useMemo(()=>({basename:l,navigator:r,static:a,unstable_useTransitions:i,future:{}}),[l,r,a,i]);typeof n=="string"&&(n=_f(n));let{pathname:u="/",search:h="",hash:f="",state:p=null,key:x="default"}=n,y=j.useMemo(()=>{let v=Tc(u,l);return v==null?null:{location:{pathname:v,search:h,hash:f,state:p,key:x},navigationType:s}},[l,u,h,f,p,x,s]);return Xi(y!=null,`<Router basename="${l}"> is not able to match the URL "${u}${h}${f}" because it does not start with the basename, so the <Router> won't render anything.`),y==null?null:j.createElement(to.Provider,{value:c},j.createElement(bx.Provider,{children:e,value:y}))}function ew({children:t,location:e}){return Fte(U3(t),e)}function U3(t,e=[]){let n=[];return j.Children.forEach(t,(s,r)=>{if(!j.isValidElement(s))return;let a=[...e,r];if(s.type===j.Fragment){n.push.apply(n,U3(s.props.children,a));return}Is(s.type===rn,`[${typeof s.type=="string"?s.type:s.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Is(!s.props.index||!s.props.children,"An index route cannot have child routes.");let i={id:s.props.id||a.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,middleware:s.props.middleware,loader:s.props.loader,action:s.props.action,hydrateFallbackElement:s.props.hydrateFallbackElement,HydrateFallback:s.props.HydrateFallback,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.hasErrorBoundary===!0||s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(i.children=U3(s.props.children,a)),n.push(i)}),n}var C1="get",T1="application/x-www-form-urlencoded";function S2(t){return typeof HTMLElement<"u"&&t instanceof HTMLElement}function ene(t){return S2(t)&&t.tagName.toLowerCase()==="button"}function tne(t){return S2(t)&&t.tagName.toLowerCase()==="form"}function nne(t){return S2(t)&&t.tagName.toLowerCase()==="input"}function sne(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function rne(t,e){return t.button===0&&(!e||e==="_self")&&!sne(t)}function V3(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let s=t[n];return e.concat(Array.isArray(s)?s.map(r=>[n,r]):[[n,s]])},[]))}function ane(t,e){let n=V3(t);return e&&e.forEach((s,r)=>{n.has(r)||e.getAll(r).forEach(a=>{n.append(r,a)})}),n}var Uv=null;function ine(){if(Uv===null)try{new FormData(document.createElement("form"),0),Uv=!1}catch{Uv=!0}return Uv}var one=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function zC(t){return t!=null&&!one.has(t)?(Xi(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${T1}"`),null):t}function lne(t,e){let n,s,r,a,i;if(tne(t)){let l=t.getAttribute("action");s=l?Tc(l,e):null,n=t.getAttribute("method")||C1,r=zC(t.getAttribute("enctype"))||T1,a=new FormData(t)}else if(ene(t)||nne(t)&&(t.type==="submit"||t.type==="image")){let l=t.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let c=t.getAttribute("formaction")||l.getAttribute("action");if(s=c?Tc(c,e):null,n=t.getAttribute("formmethod")||l.getAttribute("method")||C1,r=zC(t.getAttribute("formenctype"))||zC(l.getAttribute("enctype"))||T1,a=new FormData(l,t),!ine()){let{name:u,type:h,value:f}=t;if(h==="image"){let p=u?`${u}.`:"";a.append(`${p}x`,"0"),a.append(`${p}y`,"0")}else u&&a.append(u,f)}}else{if(S2(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=C1,s=null,r=T1,i=t}return a&&r==="text/plain"&&(i=a,a=void 0),{action:s,method:n.toLowerCase(),encType:r,formData:a,body:i}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function YE(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function cne(t,e,n,s){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n?r.pathname.endsWith("/")?r.pathname=`${r.pathname}_.${s}`:r.pathname=`${r.pathname}.${s}`:r.pathname==="/"?r.pathname=`_root.${s}`:e&&Tc(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${s}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${s}`,r}async function une(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function dne(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function hne(t,e,n){let s=await Promise.all(t.map(async r=>{let a=e.routes[r.route.id];if(a){let i=await une(a,n);return i.links?i.links():[]}return[]}));return gne(s.flat(1).filter(dne).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function FP(t,e,n,s,r,a){let i=(c,u)=>n[u]?c.route.id!==n[u].route.id:!0,l=(c,u)=>{var h;return n[u].pathname!==c.pathname||((h=n[u].route.path)==null?void 0:h.endsWith("*"))&&n[u].params["*"]!==c.params["*"]};return a==="assets"?e.filter((c,u)=>i(c,u)||l(c,u)):a==="data"?e.filter((c,u)=>{var f;let h=s.routes[c.route.id];if(!h||!h.hasLoader)return!1;if(i(c,u)||l(c,u))return!0;if(c.route.shouldRevalidate){let p=c.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:((f=n[0])==null?void 0:f.params)||{},nextUrl:new URL(t,window.origin),nextParams:c.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function mne(t,e,{includeHydrateFallback:n}={}){return fne(t.map(s=>{let r=e.routes[s.route.id];if(!r)return[];let a=[r.module];return r.clientActionModule&&(a=a.concat(r.clientActionModule)),r.clientLoaderModule&&(a=a.concat(r.clientLoaderModule)),n&&r.hydrateFallbackModule&&(a=a.concat(r.hydrateFallbackModule)),r.imports&&(a=a.concat(r.imports)),a}).flat(1))}function fne(t){return[...new Set(t)]}function pne(t){let e={},n=Object.keys(t).sort();for(let s of n)e[s]=t[s];return e}function gne(t,e){let n=new Set;return new Set(e),t.reduce((s,r)=>{let a=JSON.stringify(pne(r));return n.has(a)||(n.add(a),s.push({key:a,link:r})),s},[])}function S7(){let t=j.useContext(Ef);return YE(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function xne(){let t=j.useContext(N2);return YE(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var QE=j.createContext(void 0);QE.displayName="FrameworkContext";function j7(){let t=j.useContext(QE);return YE(t,"You must render this element inside a <HydratedRouter> element"),t}function yne(t,e){let n=j.useContext(QE),[s,r]=j.useState(!1),[a,i]=j.useState(!1),{onFocus:l,onBlur:c,onMouseEnter:u,onMouseLeave:h,onTouchStart:f}=e,p=j.useRef(null);j.useEffect(()=>{if(t==="render"&&i(!0),t==="viewport"){let v=N=>{N.forEach(S=>{i(S.isIntersecting)})},b=new IntersectionObserver(v,{threshold:.5});return p.current&&b.observe(p.current),()=>{b.disconnect()}}},[t]),j.useEffect(()=>{if(s){let v=setTimeout(()=>{i(!0)},100);return()=>{clearTimeout(v)}}},[s]);let x=()=>{r(!0)},y=()=>{r(!1),i(!1)};return n?t!=="intent"?[a,p,{}]:[a,p,{onFocus:J0(l,x),onBlur:J0(c,y),onMouseEnter:J0(u,x),onMouseLeave:J0(h,y),onTouchStart:J0(f,x)}]:[!1,p,{}]}function J0(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function bne({page:t,...e}){let{router:n}=S7(),s=j.useMemo(()=>c7(n.routes,t,n.basename),[n.routes,t,n.basename]);return s?j.createElement(wne,{page:t,matches:s,...e}):null}function vne(t){let{manifest:e,routeModules:n}=j7(),[s,r]=j.useState([]);return j.useEffect(()=>{let a=!1;return hne(t,e,n).then(i=>{a||r(i)}),()=>{a=!0}},[t,e,n]),s}function wne({page:t,matches:e,...n}){let s=vi(),{future:r,manifest:a,routeModules:i}=j7(),{basename:l}=S7(),{loaderData:c,matches:u}=xne(),h=j.useMemo(()=>FP(t,e,u,a,s,"data"),[t,e,u,a,s]),f=j.useMemo(()=>FP(t,e,u,a,s,"assets"),[t,e,u,a,s]),p=j.useMemo(()=>{if(t===s.pathname+s.search+s.hash)return[];let v=new Set,b=!1;if(e.forEach(S=>{var T;let k=a.routes[S.route.id];!k||!k.hasLoader||(!h.some(E=>E.route.id===S.route.id)&&S.route.id in c&&((T=i[S.route.id])!=null&&T.shouldRevalidate)||k.hasClientLoader?b=!0:v.add(S.route.id))}),v.size===0)return[];let N=cne(t,l,r.unstable_trailingSlashAwareDataRequests,"data");return b&&v.size>0&&N.searchParams.set("_routes",e.filter(S=>v.has(S.route.id)).map(S=>S.route.id).join(",")),[N.pathname+N.search]},[l,r.unstable_trailingSlashAwareDataRequests,c,s,a,h,e,t,i]),x=j.useMemo(()=>mne(f,a),[f,a]),y=vne(f);return j.createElement(j.Fragment,null,p.map(v=>j.createElement("link",{key:v,rel:"prefetch",as:"fetch",href:v,...n})),x.map(v=>j.createElement("link",{key:v,rel:"modulepreload",href:v,...n})),y.map(({key:v,link:b})=>j.createElement("link",{key:v,nonce:n.nonce,...b})))}function Nne(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var Sne=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Sne&&(window.__reactRouterVersion="7.12.0")}catch{}function jne({basename:t,children:e,unstable_useTransitions:n,window:s}){let r=j.useRef();r.current==null&&(r.current=tte({window:s,v5Compat:!0}));let a=r.current,[i,l]=j.useState({action:a.action,location:a.location}),c=j.useCallback(u=>{n===!1?l(u):j.startTransition(()=>l(u))},[n]);return j.useLayoutEffect(()=>a.listen(c),[a,c]),j.createElement(Jte,{basename:t,children:e,location:i.location,navigationType:i.action,navigator:a,unstable_useTransitions:n})}var k7=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,j2=j.forwardRef(function({onClick:e,discover:n="render",prefetch:s="none",relative:r,reloadDocument:a,replace:i,state:l,target:c,to:u,preventScrollReset:h,viewTransition:f,unstable_defaultShouldRevalidate:p,...x},y){let{basename:v,unstable_useTransitions:b}=j.useContext(to),N=typeof u=="string"&&k7.test(u),S=f7(u,v);u=S.to;let k=Dte(u,{relative:r}),[T,E,D]=yne(s,x),A=Tne(u,{replace:i,state:l,target:c,preventScrollReset:h,relative:r,viewTransition:f,unstable_defaultShouldRevalidate:p,unstable_useTransitions:b});function I($){e&&e($),$.defaultPrevented||A($)}let P=j.createElement("a",{...x,...D,href:S.absoluteURL||k,onClick:S.isExternal||a?e:I,ref:Nne(y,E),target:c,"data-discover":!N&&n==="render"?"true":void 0});return T&&!N?j.createElement(j.Fragment,null,P,j.createElement(bne,{page:k})):P});j2.displayName="Link";var Pg=j.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:s="",end:r=!1,style:a,to:i,viewTransition:l,children:c,...u},h){let f=vx(i,{relative:u.relative}),p=vi(),x=j.useContext(N2),{navigator:y,basename:v}=j.useContext(to),b=x!=null&&Rne(f)&&l===!0,N=y.encodeLocation?y.encodeLocation(f).pathname:f.pathname,S=p.pathname,k=x&&x.navigation&&x.navigation.location?x.navigation.location.pathname:null;n||(S=S.toLowerCase(),k=k?k.toLowerCase():null,N=N.toLowerCase()),k&&v&&(k=Tc(k,v)||k);const T=N!=="/"&&N.endsWith("/")?N.length-1:N.length;let E=S===N||!r&&S.startsWith(N)&&S.charAt(T)==="/",D=k!=null&&(k===N||!r&&k.startsWith(N)&&k.charAt(N.length)==="/"),A={isActive:E,isPending:D,isTransitioning:b},I=E?e:void 0,P;typeof s=="function"?P=s(A):P=[s,E?"active":null,D?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let $=typeof a=="function"?a(A):a;return j.createElement(j2,{...u,"aria-current":I,className:P,ref:h,style:$,to:i,viewTransition:l},typeof c=="function"?c(A):c)});Pg.displayName="NavLink";var kne=j.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:s,replace:r,state:a,method:i=C1,action:l,onSubmit:c,relative:u,preventScrollReset:h,viewTransition:f,unstable_defaultShouldRevalidate:p,...x},y)=>{let{unstable_useTransitions:v}=j.useContext(to),b=$ne(),N=Ine(l,{relative:u}),S=i.toLowerCase()==="get"?"get":"post",k=typeof l=="string"&&k7.test(l),T=E=>{if(c&&c(E),E.defaultPrevented)return;E.preventDefault();let D=E.nativeEvent.submitter,A=(D==null?void 0:D.getAttribute("formmethod"))||i,I=()=>b(D||E.currentTarget,{fetcherKey:e,method:A,navigate:n,replace:r,state:a,relative:u,preventScrollReset:h,viewTransition:f,unstable_defaultShouldRevalidate:p});v&&n!==!1?j.startTransition(()=>I()):I()};return j.createElement("form",{ref:y,method:S,action:N,onSubmit:s?c:T,...x,"data-discover":!k&&t==="render"?"true":void 0})});kne.displayName="Form";function Cne(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function C7(t){let e=j.useContext(Ef);return Is(e,Cne(t)),e}function Tne(t,{target:e,replace:n,state:s,preventScrollReset:r,relative:a,viewTransition:i,unstable_defaultShouldRevalidate:l,unstable_useTransitions:c}={}){let u=qr(),h=vi(),f=vx(t,{relative:a});return j.useCallback(p=>{if(rne(p,e)){p.preventDefault();let x=n!==void 0?n:Dg(h)===Dg(f),y=()=>u(t,{replace:x,state:s,preventScrollReset:r,relative:a,viewTransition:i,unstable_defaultShouldRevalidate:l});c?j.startTransition(()=>y()):y()}},[h,u,f,n,s,e,t,r,a,i,l,c])}function _ne(t){Xi(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=j.useRef(V3(t)),n=j.useRef(!1),s=vi(),r=j.useMemo(()=>ane(s.search,n.current?null:e.current),[s.search]),a=qr(),i=j.useCallback((l,c)=>{const u=V3(typeof l=="function"?l(new URLSearchParams(r)):l);n.current=!0,a("?"+u,c)},[a,r]);return[r,i]}var Ene=0,Ane=()=>`__${String(++Ene)}__`;function $ne(){let{router:t}=C7("useSubmit"),{basename:e}=j.useContext(to),n=Kte(),s=t.fetch,r=t.navigate;return j.useCallback(async(a,i={})=>{let{action:l,method:c,encType:u,formData:h,body:f}=lne(a,e);if(i.navigate===!1){let p=i.fetcherKey||Ane();await s(p,n,i.action||l,{unstable_defaultShouldRevalidate:i.unstable_defaultShouldRevalidate,preventScrollReset:i.preventScrollReset,formData:h,body:f,formMethod:i.method||c,formEncType:i.encType||u,flushSync:i.flushSync})}else await r(i.action||l,{unstable_defaultShouldRevalidate:i.unstable_defaultShouldRevalidate,preventScrollReset:i.preventScrollReset,formData:h,body:f,formMethod:i.method||c,formEncType:i.encType||u,replace:i.replace,state:i.state,fromRouteId:n,flushSync:i.flushSync,viewTransition:i.viewTransition})},[s,r,e,n])}function Ine(t,{relative:e}={}){let{basename:n}=j.useContext(to),s=j.useContext(hl);Is(s,"useFormAction must be used inside a RouteContext");let[r]=s.matches.slice(-1),a={...vx(t||".",{relative:e})},i=vi();if(t==null){a.search=i.search;let l=new URLSearchParams(a.search),c=l.getAll("index");if(c.some(h=>h==="")){l.delete("index"),c.filter(f=>f).forEach(f=>l.append("index",f));let h=l.toString();a.search=h?`?${h}`:""}}return(!t||t===".")&&r.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(a.pathname=a.pathname==="/"?n:Sc([n,a.pathname])),Dg(a)}function Rne(t,{relative:e}={}){let n=j.useContext(g7);Is(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:s}=C7("useViewTransitionState"),r=vx(t,{relative:e});if(!n.isTransitioning)return!1;let a=Tc(n.currentLocation.pathname,s)||n.currentLocation.pathname,i=Tc(n.nextLocation.pathname,s)||n.nextLocation.pathname;return J1(r.pathname,i)!=null||J1(r.pathname,a)!=null}var T7=l7();function _7(t,e){return function(){return t.apply(e,arguments)}}const{toString:One}=Object.prototype,{getPrototypeOf:ZE}=Object,{iterator:k2,toStringTag:E7}=Symbol,C2=(t=>e=>{const n=One.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),ml=t=>(t=t.toLowerCase(),e=>C2(e)===t),T2=t=>e=>typeof e===t,{isArray:$f}=Array,Jm=T2("undefined");function wx(t){return t!==null&&!Jm(t)&&t.constructor!==null&&!Jm(t.constructor)&&mi(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const A7=ml("ArrayBuffer");function Dne(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&A7(t.buffer),e}const Pne=T2("string"),mi=T2("function"),$7=T2("number"),Nx=t=>t!==null&&typeof t=="object",Lne=t=>t===!0||t===!1,_1=t=>{if(C2(t)!=="object")return!1;const e=ZE(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(E7 in t)&&!(k2 in t)},Mne=t=>{if(!Nx(t)||wx(t))return!1;try{return Object.keys(t).length===0&&Object.getPrototypeOf(t)===Object.prototype}catch{return!1}},Fne=ml("Date"),zne=ml("File"),Bne=ml("Blob"),Une=ml("FileList"),Vne=t=>Nx(t)&&mi(t.pipe),Wne=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||mi(t.append)&&((e=C2(t))==="formdata"||e==="object"&&mi(t.toString)&&t.toString()==="[object FormData]"))},Hne=ml("URLSearchParams"),[Gne,qne,Kne,Xne]=["ReadableStream","Request","Response","Headers"].map(ml),Yne=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Sx(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let s,r;if(typeof t!="object"&&(t=[t]),$f(t))for(s=0,r=t.length;s<r;s++)e.call(null,t[s],s,t);else{if(wx(t))return;const a=n?Object.getOwnPropertyNames(t):Object.keys(t),i=a.length;let l;for(s=0;s<i;s++)l=a[s],e.call(null,t[l],l,t)}}function I7(t,e){if(wx(t))return null;e=e.toLowerCase();const n=Object.keys(t);let s=n.length,r;for(;s-- >0;)if(r=n[s],e===r.toLowerCase())return r;return null}const Kd=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,R7=t=>!Jm(t)&&t!==Kd;function W3(){const{caseless:t,skipUndefined:e}=R7(this)&&this||{},n={},s=(r,a)=>{const i=t&&I7(n,a)||a;_1(n[i])&&_1(r)?n[i]=W3(n[i],r):_1(r)?n[i]=W3({},r):$f(r)?n[i]=r.slice():(!e||!Jm(r))&&(n[i]=r)};for(let r=0,a=arguments.length;r<a;r++)arguments[r]&&Sx(arguments[r],s);return n}const Qne=(t,e,n,{allOwnKeys:s}={})=>(Sx(e,(r,a)=>{n&&mi(r)?t[a]=_7(r,n):t[a]=r},{allOwnKeys:s}),t),Zne=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),Jne=(t,e,n,s)=>{t.prototype=Object.create(e.prototype,s),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},ese=(t,e,n,s)=>{let r,a,i;const l={};if(e=e||{},t==null)return e;do{for(r=Object.getOwnPropertyNames(t),a=r.length;a-- >0;)i=r[a],(!s||s(i,t,e))&&!l[i]&&(e[i]=t[i],l[i]=!0);t=n!==!1&&ZE(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},tse=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const s=t.indexOf(e,n);return s!==-1&&s===n},nse=t=>{if(!t)return null;if($f(t))return t;let e=t.length;if(!$7(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},sse=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&ZE(Uint8Array)),rse=(t,e)=>{const s=(t&&t[k2]).call(t);let r;for(;(r=s.next())&&!r.done;){const a=r.value;e.call(t,a[0],a[1])}},ase=(t,e)=>{let n;const s=[];for(;(n=t.exec(e))!==null;)s.push(n);return s},ise=ml("HTMLFormElement"),ose=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,s,r){return s.toUpperCase()+r}),zP=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),lse=ml("RegExp"),O7=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),s={};Sx(n,(r,a)=>{let i;(i=e(r,a,t))!==!1&&(s[a]=i||r)}),Object.defineProperties(t,s)},cse=t=>{O7(t,(e,n)=>{if(mi(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const s=t[n];if(mi(s)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},use=(t,e)=>{const n={},s=r=>{r.forEach(a=>{n[a]=!0})};return $f(t)?s(t):s(String(t).split(e)),n},dse=()=>{},hse=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function mse(t){return!!(t&&mi(t.append)&&t[E7]==="FormData"&&t[k2])}const fse=t=>{const e=new Array(10),n=(s,r)=>{if(Nx(s)){if(e.indexOf(s)>=0)return;if(wx(s))return s;if(!("toJSON"in s)){e[r]=s;const a=$f(s)?[]:{};return Sx(s,(i,l)=>{const c=n(i,r+1);!Jm(c)&&(a[l]=c)}),e[r]=void 0,a}}return s};return n(t,0)},pse=ml("AsyncFunction"),gse=t=>t&&(Nx(t)||mi(t))&&mi(t.then)&&mi(t.catch),D7=((t,e)=>t?setImmediate:e?((n,s)=>(Kd.addEventListener("message",({source:r,data:a})=>{r===Kd&&a===n&&s.length&&s.shift()()},!1),r=>{s.push(r),Kd.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",mi(Kd.postMessage)),xse=typeof queueMicrotask<"u"?queueMicrotask.bind(Kd):typeof process<"u"&&process.nextTick||D7,yse=t=>t!=null&&mi(t[k2]),Be={isArray:$f,isArrayBuffer:A7,isBuffer:wx,isFormData:Wne,isArrayBufferView:Dne,isString:Pne,isNumber:$7,isBoolean:Lne,isObject:Nx,isPlainObject:_1,isEmptyObject:Mne,isReadableStream:Gne,isRequest:qne,isResponse:Kne,isHeaders:Xne,isUndefined:Jm,isDate:Fne,isFile:zne,isBlob:Bne,isRegExp:lse,isFunction:mi,isStream:Vne,isURLSearchParams:Hne,isTypedArray:sse,isFileList:Une,forEach:Sx,merge:W3,extend:Qne,trim:Yne,stripBOM:Zne,inherits:Jne,toFlatObject:ese,kindOf:C2,kindOfTest:ml,endsWith:tse,toArray:nse,forEachEntry:rse,matchAll:ase,isHTMLForm:ise,hasOwnProperty:zP,hasOwnProp:zP,reduceDescriptors:O7,freezeMethods:cse,toObjectSet:use,toCamelCase:ose,noop:dse,toFiniteNumber:hse,findKey:I7,global:Kd,isContextDefined:R7,isSpecCompliantForm:mse,toJSONObject:fse,isAsyncFn:pse,isThenable:gse,setImmediate:D7,asap:xse,isIterable:yse};function cn(t,e,n,s,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),s&&(this.request=s),r&&(this.response=r,this.status=r.status?r.status:null)}Be.inherits(cn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Be.toJSONObject(this.config),code:this.code,status:this.status}}});const P7=cn.prototype,L7={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{L7[t]={value:t}});Object.defineProperties(cn,L7);Object.defineProperty(P7,"isAxiosError",{value:!0});cn.from=(t,e,n,s,r,a)=>{const i=Object.create(P7);Be.toFlatObject(t,i,function(h){return h!==Error.prototype},u=>u!=="isAxiosError");const l=t&&t.message?t.message:"Error",c=e==null&&t?t.code:e;return cn.call(i,l,c,n,s,r),t&&i.cause==null&&Object.defineProperty(i,"cause",{value:t,configurable:!0}),i.name=t&&t.name||"Error",a&&Object.assign(i,a),i};const bse=null;function H3(t){return Be.isPlainObject(t)||Be.isArray(t)}function M7(t){return Be.endsWith(t,"[]")?t.slice(0,-2):t}function BP(t,e,n){return t?t.concat(e).map(function(r,a){return r=M7(r),!n&&a?"["+r+"]":r}).join(n?".":""):e}function vse(t){return Be.isArray(t)&&!t.some(H3)}const wse=Be.toFlatObject(Be,{},null,function(e){return/^is[A-Z]/.test(e)});function _2(t,e,n){if(!Be.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=Be.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(v,b){return!Be.isUndefined(b[v])});const s=n.metaTokens,r=n.visitor||h,a=n.dots,i=n.indexes,c=(n.Blob||typeof Blob<"u"&&Blob)&&Be.isSpecCompliantForm(e);if(!Be.isFunction(r))throw new TypeError("visitor must be a function");function u(y){if(y===null)return"";if(Be.isDate(y))return y.toISOString();if(Be.isBoolean(y))return y.toString();if(!c&&Be.isBlob(y))throw new cn("Blob is not supported. Use a Buffer instead.");return Be.isArrayBuffer(y)||Be.isTypedArray(y)?c&&typeof Blob=="function"?new Blob([y]):Buffer.from(y):y}function h(y,v,b){let N=y;if(y&&!b&&typeof y=="object"){if(Be.endsWith(v,"{}"))v=s?v:v.slice(0,-2),y=JSON.stringify(y);else if(Be.isArray(y)&&vse(y)||(Be.isFileList(y)||Be.endsWith(v,"[]"))&&(N=Be.toArray(y)))return v=M7(v),N.forEach(function(k,T){!(Be.isUndefined(k)||k===null)&&e.append(i===!0?BP([v],T,a):i===null?v:v+"[]",u(k))}),!1}return H3(y)?!0:(e.append(BP(b,v,a),u(y)),!1)}const f=[],p=Object.assign(wse,{defaultVisitor:h,convertValue:u,isVisitable:H3});function x(y,v){if(!Be.isUndefined(y)){if(f.indexOf(y)!==-1)throw Error("Circular reference detected in "+v.join("."));f.push(y),Be.forEach(y,function(N,S){(!(Be.isUndefined(N)||N===null)&&r.call(e,N,Be.isString(S)?S.trim():S,v,p))===!0&&x(N,v?v.concat(S):[S])}),f.pop()}}if(!Be.isObject(t))throw new TypeError("data must be an object");return x(t),e}function UP(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(s){return e[s]})}function JE(t,e){this._pairs=[],t&&_2(t,this,e)}const F7=JE.prototype;F7.append=function(e,n){this._pairs.push([e,n])};F7.toString=function(e){const n=e?function(s){return e.call(this,s,UP)}:UP;return this._pairs.map(function(r){return n(r[0])+"="+n(r[1])},"").join("&")};function Nse(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function z7(t,e,n){if(!e)return t;const s=n&&n.encode||Nse;Be.isFunction(n)&&(n={serialize:n});const r=n&&n.serialize;let a;if(r?a=r(e,n):a=Be.isURLSearchParams(e)?e.toString():new JE(e,n).toString(s),a){const i=t.indexOf("#");i!==-1&&(t=t.slice(0,i)),t+=(t.indexOf("?")===-1?"?":"&")+a}return t}class VP{constructor(){this.handlers=[]}use(e,n,s){return this.handlers.push({fulfilled:e,rejected:n,synchronous:s?s.synchronous:!1,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){Be.forEach(this.handlers,function(s){s!==null&&e(s)})}}const B7={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Sse=typeof URLSearchParams<"u"?URLSearchParams:JE,jse=typeof FormData<"u"?FormData:null,kse=typeof Blob<"u"?Blob:null,Cse={isBrowser:!0,classes:{URLSearchParams:Sse,FormData:jse,Blob:kse},protocols:["http","https","file","blob","url","data"]},e4=typeof window<"u"&&typeof document<"u",G3=typeof navigator=="object"&&navigator||void 0,Tse=e4&&(!G3||["ReactNative","NativeScript","NS"].indexOf(G3.product)<0),_se=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Ese=e4&&window.location.href||"http://localhost",Ase=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:e4,hasStandardBrowserEnv:Tse,hasStandardBrowserWebWorkerEnv:_se,navigator:G3,origin:Ese},Symbol.toStringTag,{value:"Module"})),wa={...Ase,...Cse};function $se(t,e){return _2(t,new wa.classes.URLSearchParams,{visitor:function(n,s,r,a){return wa.isNode&&Be.isBuffer(n)?(this.append(s,n.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)},...e})}function Ise(t){return Be.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function Rse(t){const e={},n=Object.keys(t);let s;const r=n.length;let a;for(s=0;s<r;s++)a=n[s],e[a]=t[a];return e}function U7(t){function e(n,s,r,a){let i=n[a++];if(i==="__proto__")return!0;const l=Number.isFinite(+i),c=a>=n.length;return i=!i&&Be.isArray(r)?r.length:i,c?(Be.hasOwnProp(r,i)?r[i]=[r[i],s]:r[i]=s,!l):((!r[i]||!Be.isObject(r[i]))&&(r[i]=[]),e(n,s,r[i],a)&&Be.isArray(r[i])&&(r[i]=Rse(r[i])),!l)}if(Be.isFormData(t)&&Be.isFunction(t.entries)){const n={};return Be.forEachEntry(t,(s,r)=>{e(Ise(s),r,n,0)}),n}return null}function Ose(t,e,n){if(Be.isString(t))try{return(e||JSON.parse)(t),Be.trim(t)}catch(s){if(s.name!=="SyntaxError")throw s}return(n||JSON.stringify)(t)}const jx={transitional:B7,adapter:["xhr","http","fetch"],transformRequest:[function(e,n){const s=n.getContentType()||"",r=s.indexOf("application/json")>-1,a=Be.isObject(e);if(a&&Be.isHTMLForm(e)&&(e=new FormData(e)),Be.isFormData(e))return r?JSON.stringify(U7(e)):e;if(Be.isArrayBuffer(e)||Be.isBuffer(e)||Be.isStream(e)||Be.isFile(e)||Be.isBlob(e)||Be.isReadableStream(e))return e;if(Be.isArrayBufferView(e))return e.buffer;if(Be.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let l;if(a){if(s.indexOf("application/x-www-form-urlencoded")>-1)return $se(e,this.formSerializer).toString();if((l=Be.isFileList(e))||s.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return _2(l?{"files[]":e}:e,c&&new c,this.formSerializer)}}return a||r?(n.setContentType("application/json",!1),Ose(e)):e}],transformResponse:[function(e){const n=this.transitional||jx.transitional,s=n&&n.forcedJSONParsing,r=this.responseType==="json";if(Be.isResponse(e)||Be.isReadableStream(e))return e;if(e&&Be.isString(e)&&(s&&!this.responseType||r)){const i=!(n&&n.silentJSONParsing)&&r;try{return JSON.parse(e,this.parseReviver)}catch(l){if(i)throw l.name==="SyntaxError"?cn.from(l,cn.ERR_BAD_RESPONSE,this,null,this.response):l}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:wa.classes.FormData,Blob:wa.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Be.forEach(["delete","get","head","post","put","patch"],t=>{jx.headers[t]={}});const Dse=Be.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Pse=t=>{const e={};let n,s,r;return t&&t.split(`
`).forEach(function(i){r=i.indexOf(":"),n=i.substring(0,r).trim().toLowerCase(),s=i.substring(r+1).trim(),!(!n||e[n]&&Dse[n])&&(n==="set-cookie"?e[n]?e[n].push(s):e[n]=[s]:e[n]=e[n]?e[n]+", "+s:s)}),e},WP=Symbol("internals");function eg(t){return t&&String(t).trim().toLowerCase()}function E1(t){return t===!1||t==null?t:Be.isArray(t)?t.map(E1):String(t)}function Lse(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let s;for(;s=n.exec(t);)e[s[1]]=s[2];return e}const Mse=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function BC(t,e,n,s,r){if(Be.isFunction(s))return s.call(this,e,n);if(r&&(e=n),!!Be.isString(e)){if(Be.isString(s))return e.indexOf(s)!==-1;if(Be.isRegExp(s))return s.test(e)}}function Fse(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,s)=>n.toUpperCase()+s)}function zse(t,e){const n=Be.toCamelCase(" "+e);["get","set","has"].forEach(s=>{Object.defineProperty(t,s+n,{value:function(r,a,i){return this[s].call(this,e,r,a,i)},configurable:!0})})}let fi=class{constructor(e){e&&this.set(e)}set(e,n,s){const r=this;function a(l,c,u){const h=eg(c);if(!h)throw new Error("header name must be a non-empty string");const f=Be.findKey(r,h);(!f||r[f]===void 0||u===!0||u===void 0&&r[f]!==!1)&&(r[f||c]=E1(l))}const i=(l,c)=>Be.forEach(l,(u,h)=>a(u,h,c));if(Be.isPlainObject(e)||e instanceof this.constructor)i(e,n);else if(Be.isString(e)&&(e=e.trim())&&!Mse(e))i(Pse(e),n);else if(Be.isObject(e)&&Be.isIterable(e)){let l={},c,u;for(const h of e){if(!Be.isArray(h))throw TypeError("Object iterator must return a key-value pair");l[u=h[0]]=(c=l[u])?Be.isArray(c)?[...c,h[1]]:[c,h[1]]:h[1]}i(l,n)}else e!=null&&a(n,e,s);return this}get(e,n){if(e=eg(e),e){const s=Be.findKey(this,e);if(s){const r=this[s];if(!n)return r;if(n===!0)return Lse(r);if(Be.isFunction(n))return n.call(this,r,s);if(Be.isRegExp(n))return n.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=eg(e),e){const s=Be.findKey(this,e);return!!(s&&this[s]!==void 0&&(!n||BC(this,this[s],s,n)))}return!1}delete(e,n){const s=this;let r=!1;function a(i){if(i=eg(i),i){const l=Be.findKey(s,i);l&&(!n||BC(s,s[l],l,n))&&(delete s[l],r=!0)}}return Be.isArray(e)?e.forEach(a):a(e),r}clear(e){const n=Object.keys(this);let s=n.length,r=!1;for(;s--;){const a=n[s];(!e||BC(this,this[a],a,e,!0))&&(delete this[a],r=!0)}return r}normalize(e){const n=this,s={};return Be.forEach(this,(r,a)=>{const i=Be.findKey(s,a);if(i){n[i]=E1(r),delete n[a];return}const l=e?Fse(a):String(a).trim();l!==a&&delete n[a],n[l]=E1(r),s[l]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return Be.forEach(this,(s,r)=>{s!=null&&s!==!1&&(n[r]=e&&Be.isArray(s)?s.join(", "):s)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const s=new this(e);return n.forEach(r=>s.set(r)),s}static accessor(e){const s=(this[WP]=this[WP]={accessors:{}}).accessors,r=this.prototype;function a(i){const l=eg(i);s[l]||(zse(r,i),s[l]=!0)}return Be.isArray(e)?e.forEach(a):a(e),this}};fi.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Be.reduceDescriptors(fi.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(s){this[n]=s}}});Be.freezeMethods(fi);function UC(t,e){const n=this||jx,s=e||n,r=fi.from(s.headers);let a=s.data;return Be.forEach(t,function(l){a=l.call(n,a,r.normalize(),e?e.status:void 0)}),r.normalize(),a}function V7(t){return!!(t&&t.__CANCEL__)}function If(t,e,n){cn.call(this,t??"canceled",cn.ERR_CANCELED,e,n),this.name="CanceledError"}Be.inherits(If,cn,{__CANCEL__:!0});function W7(t,e,n){const s=n.config.validateStatus;!n.status||!s||s(n.status)?t(n):e(new cn("Request failed with status code "+n.status,[cn.ERR_BAD_REQUEST,cn.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function Bse(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function Use(t,e){t=t||10;const n=new Array(t),s=new Array(t);let r=0,a=0,i;return e=e!==void 0?e:1e3,function(c){const u=Date.now(),h=s[a];i||(i=u),n[r]=c,s[r]=u;let f=a,p=0;for(;f!==r;)p+=n[f++],f=f%t;if(r=(r+1)%t,r===a&&(a=(a+1)%t),u-i<e)return;const x=h&&u-h;return x?Math.round(p*1e3/x):void 0}}function Vse(t,e){let n=0,s=1e3/e,r,a;const i=(u,h=Date.now())=>{n=h,r=null,a&&(clearTimeout(a),a=null),t(...u)};return[(...u)=>{const h=Date.now(),f=h-n;f>=s?i(u,h):(r=u,a||(a=setTimeout(()=>{a=null,i(r)},s-f)))},()=>r&&i(r)]}const tw=(t,e,n=3)=>{let s=0;const r=Use(50,250);return Vse(a=>{const i=a.loaded,l=a.lengthComputable?a.total:void 0,c=i-s,u=r(c),h=i<=l;s=i;const f={loaded:i,total:l,progress:l?i/l:void 0,bytes:c,rate:u||void 0,estimated:u&&l&&h?(l-i)/u:void 0,event:a,lengthComputable:l!=null,[e?"download":"upload"]:!0};t(f)},n)},HP=(t,e)=>{const n=t!=null;return[s=>e[0]({lengthComputable:n,total:t,loaded:s}),e[1]]},GP=t=>(...e)=>Be.asap(()=>t(...e)),Wse=wa.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,wa.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(wa.origin),wa.navigator&&/(msie|trident)/i.test(wa.navigator.userAgent)):()=>!0,Hse=wa.hasStandardBrowserEnv?{write(t,e,n,s,r,a){const i=[t+"="+encodeURIComponent(e)];Be.isNumber(n)&&i.push("expires="+new Date(n).toGMTString()),Be.isString(s)&&i.push("path="+s),Be.isString(r)&&i.push("domain="+r),a===!0&&i.push("secure"),document.cookie=i.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Gse(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function qse(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function H7(t,e,n){let s=!Gse(e);return t&&(s||n==!1)?qse(t,e):e}const qP=t=>t instanceof fi?{...t}:t;function mh(t,e){e=e||{};const n={};function s(u,h,f,p){return Be.isPlainObject(u)&&Be.isPlainObject(h)?Be.merge.call({caseless:p},u,h):Be.isPlainObject(h)?Be.merge({},h):Be.isArray(h)?h.slice():h}function r(u,h,f,p){if(Be.isUndefined(h)){if(!Be.isUndefined(u))return s(void 0,u,f,p)}else return s(u,h,f,p)}function a(u,h){if(!Be.isUndefined(h))return s(void 0,h)}function i(u,h){if(Be.isUndefined(h)){if(!Be.isUndefined(u))return s(void 0,u)}else return s(void 0,h)}function l(u,h,f){if(f in e)return s(u,h);if(f in t)return s(void 0,u)}const c={url:a,method:a,data:a,baseURL:i,transformRequest:i,transformResponse:i,paramsSerializer:i,timeout:i,timeoutMessage:i,withCredentials:i,withXSRFToken:i,adapter:i,responseType:i,xsrfCookieName:i,xsrfHeaderName:i,onUploadProgress:i,onDownloadProgress:i,decompress:i,maxContentLength:i,maxBodyLength:i,beforeRedirect:i,transport:i,httpAgent:i,httpsAgent:i,cancelToken:i,socketPath:i,responseEncoding:i,validateStatus:l,headers:(u,h,f)=>r(qP(u),qP(h),f,!0)};return Be.forEach(Object.keys({...t,...e}),function(h){const f=c[h]||r,p=f(t[h],e[h],h);Be.isUndefined(p)&&f!==l||(n[h]=p)}),n}const G7=t=>{const e=mh({},t);let{data:n,withXSRFToken:s,xsrfHeaderName:r,xsrfCookieName:a,headers:i,auth:l}=e;if(e.headers=i=fi.from(i),e.url=z7(H7(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),l&&i.set("Authorization","Basic "+btoa((l.username||"")+":"+(l.password?unescape(encodeURIComponent(l.password)):""))),Be.isFormData(n)){if(wa.hasStandardBrowserEnv||wa.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(Be.isFunction(n.getHeaders)){const c=n.getHeaders(),u=["content-type","content-length"];Object.entries(c).forEach(([h,f])=>{u.includes(h.toLowerCase())&&i.set(h,f)})}}if(wa.hasStandardBrowserEnv&&(s&&Be.isFunction(s)&&(s=s(e)),s||s!==!1&&Wse(e.url))){const c=r&&a&&Hse.read(a);c&&i.set(r,c)}return e},Kse=typeof XMLHttpRequest<"u",Xse=Kse&&function(t){return new Promise(function(n,s){const r=G7(t);let a=r.data;const i=fi.from(r.headers).normalize();let{responseType:l,onUploadProgress:c,onDownloadProgress:u}=r,h,f,p,x,y;function v(){x&&x(),y&&y(),r.cancelToken&&r.cancelToken.unsubscribe(h),r.signal&&r.signal.removeEventListener("abort",h)}let b=new XMLHttpRequest;b.open(r.method.toUpperCase(),r.url,!0),b.timeout=r.timeout;function N(){if(!b)return;const k=fi.from("getAllResponseHeaders"in b&&b.getAllResponseHeaders()),E={data:!l||l==="text"||l==="json"?b.responseText:b.response,status:b.status,statusText:b.statusText,headers:k,config:t,request:b};W7(function(A){n(A),v()},function(A){s(A),v()},E),b=null}"onloadend"in b?b.onloadend=N:b.onreadystatechange=function(){!b||b.readyState!==4||b.status===0&&!(b.responseURL&&b.responseURL.indexOf("file:")===0)||setTimeout(N)},b.onabort=function(){b&&(s(new cn("Request aborted",cn.ECONNABORTED,t,b)),b=null)},b.onerror=function(T){const E=T&&T.message?T.message:"Network Error",D=new cn(E,cn.ERR_NETWORK,t,b);D.event=T||null,s(D),b=null},b.ontimeout=function(){let T=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const E=r.transitional||B7;r.timeoutErrorMessage&&(T=r.timeoutErrorMessage),s(new cn(T,E.clarifyTimeoutError?cn.ETIMEDOUT:cn.ECONNABORTED,t,b)),b=null},a===void 0&&i.setContentType(null),"setRequestHeader"in b&&Be.forEach(i.toJSON(),function(T,E){b.setRequestHeader(E,T)}),Be.isUndefined(r.withCredentials)||(b.withCredentials=!!r.withCredentials),l&&l!=="json"&&(b.responseType=r.responseType),u&&([p,y]=tw(u,!0),b.addEventListener("progress",p)),c&&b.upload&&([f,x]=tw(c),b.upload.addEventListener("progress",f),b.upload.addEventListener("loadend",x)),(r.cancelToken||r.signal)&&(h=k=>{b&&(s(!k||k.type?new If(null,t,b):k),b.abort(),b=null)},r.cancelToken&&r.cancelToken.subscribe(h),r.signal&&(r.signal.aborted?h():r.signal.addEventListener("abort",h)));const S=Bse(r.url);if(S&&wa.protocols.indexOf(S)===-1){s(new cn("Unsupported protocol "+S+":",cn.ERR_BAD_REQUEST,t));return}b.send(a||null)})},Yse=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let s=new AbortController,r;const a=function(u){if(!r){r=!0,l();const h=u instanceof Error?u:this.reason;s.abort(h instanceof cn?h:new If(h instanceof Error?h.message:h))}};let i=e&&setTimeout(()=>{i=null,a(new cn(`timeout ${e} of ms exceeded`,cn.ETIMEDOUT))},e);const l=()=>{t&&(i&&clearTimeout(i),i=null,t.forEach(u=>{u.unsubscribe?u.unsubscribe(a):u.removeEventListener("abort",a)}),t=null)};t.forEach(u=>u.addEventListener("abort",a));const{signal:c}=s;return c.unsubscribe=()=>Be.asap(l),c}},Qse=function*(t,e){let n=t.byteLength;if(n<e){yield t;return}let s=0,r;for(;s<n;)r=s+e,yield t.slice(s,r),s=r},Zse=async function*(t,e){for await(const n of Jse(t))yield*Qse(n,e)},Jse=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:n,value:s}=await e.read();if(n)break;yield s}}finally{await e.cancel()}},KP=(t,e,n,s)=>{const r=Zse(t,e);let a=0,i,l=c=>{i||(i=!0,s&&s(c))};return new ReadableStream({async pull(c){try{const{done:u,value:h}=await r.next();if(u){l(),c.close();return}let f=h.byteLength;if(n){let p=a+=f;n(p)}c.enqueue(new Uint8Array(h))}catch(u){throw l(u),u}},cancel(c){return l(c),r.return()}},{highWaterMark:2})},XP=64*1024,{isFunction:Vv}=Be,ere=(({Request:t,Response:e})=>({Request:t,Response:e}))(Be.global),{ReadableStream:YP,TextEncoder:QP}=Be.global,ZP=(t,...e)=>{try{return!!t(...e)}catch{return!1}},tre=t=>{t=Be.merge.call({skipUndefined:!0},ere,t);const{fetch:e,Request:n,Response:s}=t,r=e?Vv(e):typeof fetch=="function",a=Vv(n),i=Vv(s);if(!r)return!1;const l=r&&Vv(YP),c=r&&(typeof QP=="function"?(y=>v=>y.encode(v))(new QP):async y=>new Uint8Array(await new n(y).arrayBuffer())),u=a&&l&&ZP(()=>{let y=!1;const v=new n(wa.origin,{body:new YP,method:"POST",get duplex(){return y=!0,"half"}}).headers.has("Content-Type");return y&&!v}),h=i&&l&&ZP(()=>Be.isReadableStream(new s("").body)),f={stream:h&&(y=>y.body)};r&&["text","arrayBuffer","blob","formData","stream"].forEach(y=>{!f[y]&&(f[y]=(v,b)=>{let N=v&&v[y];if(N)return N.call(v);throw new cn(`Response type '${y}' is not supported`,cn.ERR_NOT_SUPPORT,b)})});const p=async y=>{if(y==null)return 0;if(Be.isBlob(y))return y.size;if(Be.isSpecCompliantForm(y))return(await new n(wa.origin,{method:"POST",body:y}).arrayBuffer()).byteLength;if(Be.isArrayBufferView(y)||Be.isArrayBuffer(y))return y.byteLength;if(Be.isURLSearchParams(y)&&(y=y+""),Be.isString(y))return(await c(y)).byteLength},x=async(y,v)=>{const b=Be.toFiniteNumber(y.getContentLength());return b??p(v)};return async y=>{let{url:v,method:b,data:N,signal:S,cancelToken:k,timeout:T,onDownloadProgress:E,onUploadProgress:D,responseType:A,headers:I,withCredentials:P="same-origin",fetchOptions:$}=G7(y),R=e||fetch;A=A?(A+"").toLowerCase():"text";let F=Yse([S,k&&k.toAbortSignal()],T),W=null;const q=F&&F.unsubscribe&&(()=>{F.unsubscribe()});let X;try{if(D&&u&&b!=="get"&&b!=="head"&&(X=await x(I,N))!==0){let O=new n(v,{method:"POST",body:N,duplex:"half"}),U;if(Be.isFormData(N)&&(U=O.headers.get("content-type"))&&I.setContentType(U),O.body){const[J,se]=HP(X,tw(GP(D)));N=KP(O.body,XP,J,se)}}Be.isString(P)||(P=P?"include":"omit");const z=a&&"credentials"in n.prototype,K={...$,signal:F,method:b.toUpperCase(),headers:I.normalize().toJSON(),body:N,duplex:"half",credentials:z?P:void 0};W=a&&new n(v,K);let H=await(a?R(W,$):R(v,K));const Y=h&&(A==="stream"||A==="response");if(h&&(E||Y&&q)){const O={};["status","statusText","headers"].forEach(ae=>{O[ae]=H[ae]});const U=Be.toFiniteNumber(H.headers.get("content-length")),[J,se]=E&&HP(U,tw(GP(E),!0))||[];H=new s(KP(H.body,XP,J,()=>{se&&se(),q&&q()}),O)}A=A||"text";let B=await f[Be.findKey(f,A)||"text"](H,y);return!Y&&q&&q(),await new Promise((O,U)=>{W7(O,U,{data:B,headers:fi.from(H.headers),status:H.status,statusText:H.statusText,config:y,request:W})})}catch(z){throw q&&q(),z&&z.name==="TypeError"&&/Load failed|fetch/i.test(z.message)?Object.assign(new cn("Network Error",cn.ERR_NETWORK,y,W),{cause:z.cause||z}):cn.from(z,z&&z.code,y,W)}}},nre=new Map,q7=t=>{let e=t?t.env:{};const{fetch:n,Request:s,Response:r}=e,a=[s,r,n];let i=a.length,l=i,c,u,h=nre;for(;l--;)c=a[l],u=h.get(c),u===void 0&&h.set(c,u=l?new Map:tre(e)),h=u;return u};q7();const q3={http:bse,xhr:Xse,fetch:{get:q7}};Be.forEach(q3,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const JP=t=>`- ${t}`,sre=t=>Be.isFunction(t)||t===null||t===!1,K7={getAdapter:(t,e)=>{t=Be.isArray(t)?t:[t];const{length:n}=t;let s,r;const a={};for(let i=0;i<n;i++){s=t[i];let l;if(r=s,!sre(s)&&(r=q3[(l=String(s)).toLowerCase()],r===void 0))throw new cn(`Unknown adapter '${l}'`);if(r&&(Be.isFunction(r)||(r=r.get(e))))break;a[l||"#"+i]=r}if(!r){const i=Object.entries(a).map(([c,u])=>`adapter ${c} `+(u===!1?"is not supported by the environment":"is not available in the build"));let l=n?i.length>1?`since :
`+i.map(JP).join(`
`):" "+JP(i[0]):"as no adapter specified";throw new cn("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return r},adapters:q3};function VC(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new If(null,t)}function eL(t){return VC(t),t.headers=fi.from(t.headers),t.data=UC.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),K7.getAdapter(t.adapter||jx.adapter,t)(t).then(function(s){return VC(t),s.data=UC.call(t,t.transformResponse,s),s.headers=fi.from(s.headers),s},function(s){return V7(s)||(VC(t),s&&s.response&&(s.response.data=UC.call(t,t.transformResponse,s.response),s.response.headers=fi.from(s.response.headers))),Promise.reject(s)})}const X7="1.12.2",E2={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{E2[t]=function(s){return typeof s===t||"a"+(e<1?"n ":" ")+t}});const tL={};E2.transitional=function(e,n,s){function r(a,i){return"[Axios v"+X7+"] Transitional option '"+a+"'"+i+(s?". "+s:"")}return(a,i,l)=>{if(e===!1)throw new cn(r(i," has been removed"+(n?" in "+n:"")),cn.ERR_DEPRECATED);return n&&!tL[i]&&(tL[i]=!0,console.warn(r(i," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(a,i,l):!0}};E2.spelling=function(e){return(n,s)=>(console.warn(`${s} is likely a misspelling of ${e}`),!0)};function rre(t,e,n){if(typeof t!="object")throw new cn("options must be an object",cn.ERR_BAD_OPTION_VALUE);const s=Object.keys(t);let r=s.length;for(;r-- >0;){const a=s[r],i=e[a];if(i){const l=t[a],c=l===void 0||i(l,a,t);if(c!==!0)throw new cn("option "+a+" must be "+c,cn.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new cn("Unknown option "+a,cn.ERR_BAD_OPTION)}}const A1={assertOptions:rre,validators:E2},jl=A1.validators;let nh=class{constructor(e){this.defaults=e||{},this.interceptors={request:new VP,response:new VP}}async request(e,n){try{return await this._request(e,n)}catch(s){if(s instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const a=r.stack?r.stack.replace(/^.+\n/,""):"";try{s.stack?a&&!String(s.stack).endsWith(a.replace(/^.+\n.+\n/,""))&&(s.stack+=`
`+a):s.stack=a}catch{}}throw s}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=mh(this.defaults,n);const{transitional:s,paramsSerializer:r,headers:a}=n;s!==void 0&&A1.assertOptions(s,{silentJSONParsing:jl.transitional(jl.boolean),forcedJSONParsing:jl.transitional(jl.boolean),clarifyTimeoutError:jl.transitional(jl.boolean)},!1),r!=null&&(Be.isFunction(r)?n.paramsSerializer={serialize:r}:A1.assertOptions(r,{encode:jl.function,serialize:jl.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),A1.assertOptions(n,{baseUrl:jl.spelling("baseURL"),withXsrfToken:jl.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let i=a&&Be.merge(a.common,a[n.method]);a&&Be.forEach(["delete","get","head","post","put","patch","common"],y=>{delete a[y]}),n.headers=fi.concat(i,a);const l=[];let c=!0;this.interceptors.request.forEach(function(v){typeof v.runWhen=="function"&&v.runWhen(n)===!1||(c=c&&v.synchronous,l.unshift(v.fulfilled,v.rejected))});const u=[];this.interceptors.response.forEach(function(v){u.push(v.fulfilled,v.rejected)});let h,f=0,p;if(!c){const y=[eL.bind(this),void 0];for(y.unshift(...l),y.push(...u),p=y.length,h=Promise.resolve(n);f<p;)h=h.then(y[f++],y[f++]);return h}p=l.length;let x=n;for(;f<p;){const y=l[f++],v=l[f++];try{x=y(x)}catch(b){v.call(this,b);break}}try{h=eL.call(this,x)}catch(y){return Promise.reject(y)}for(f=0,p=u.length;f<p;)h=h.then(u[f++],u[f++]);return h}getUri(e){e=mh(this.defaults,e);const n=H7(e.baseURL,e.url,e.allowAbsoluteUrls);return z7(n,e.params,e.paramsSerializer)}};Be.forEach(["delete","get","head","options"],function(e){nh.prototype[e]=function(n,s){return this.request(mh(s||{},{method:e,url:n,data:(s||{}).data}))}});Be.forEach(["post","put","patch"],function(e){function n(s){return function(a,i,l){return this.request(mh(l||{},{method:e,headers:s?{"Content-Type":"multipart/form-data"}:{},url:a,data:i}))}}nh.prototype[e]=n(),nh.prototype[e+"Form"]=n(!0)});let are=class Y7{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(a){n=a});const s=this;this.promise.then(r=>{if(!s._listeners)return;let a=s._listeners.length;for(;a-- >0;)s._listeners[a](r);s._listeners=null}),this.promise.then=r=>{let a;const i=new Promise(l=>{s.subscribe(l),a=l}).then(r);return i.cancel=function(){s.unsubscribe(a)},i},e(function(a,i,l){s.reason||(s.reason=new If(a,i,l),n(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const e=new AbortController,n=s=>{e.abort(s)};return this.subscribe(n),e.signal.unsubscribe=()=>this.unsubscribe(n),e.signal}static source(){let e;return{token:new Y7(function(r){e=r}),cancel:e}}};function ire(t){return function(n){return t.apply(null,n)}}function ore(t){return Be.isObject(t)&&t.isAxiosError===!0}const K3={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(K3).forEach(([t,e])=>{K3[e]=t});function Q7(t){const e=new nh(t),n=_7(nh.prototype.request,e);return Be.extend(n,nh.prototype,e,{allOwnKeys:!0}),Be.extend(n,e,null,{allOwnKeys:!0}),n.create=function(r){return Q7(mh(t,r))},n}const nr=Q7(jx);nr.Axios=nh;nr.CanceledError=If;nr.CancelToken=are;nr.isCancel=V7;nr.VERSION=X7;nr.toFormData=_2;nr.AxiosError=cn;nr.Cancel=nr.CanceledError;nr.all=function(e){return Promise.all(e)};nr.spread=ire;nr.isAxiosError=ore;nr.mergeConfig=mh;nr.AxiosHeaders=fi;nr.formToJSON=t=>U7(Be.isHTMLForm(t)?new FormData(t):t);nr.getAdapter=K7.getAdapter;nr.HttpStatusCode=K3;nr.default=nr;const{Axios:AKe,AxiosError:$Ke,CanceledError:IKe,isCancel:RKe,CancelToken:OKe,VERSION:DKe,all:PKe,Cancel:LKe,isAxiosError:MKe,spread:FKe,toFormData:zKe,AxiosHeaders:BKe,HttpStatusCode:UKe,formToJSON:VKe,getAdapter:WKe,mergeConfig:HKe}=nr,lre="token:",cre="user:",Wm="activeRole",t4=typeof window<"u",gg={admin:"admin",tutor:"tutor",tutee:"tutee",student:"tutee"},ci=t=>t?gg[t.toLowerCase()]??null:null,Z7=t=>t?t.startsWith("/admin")?"admin":t.startsWith("/tutor-dashboard")||t.startsWith("/tutor")?"tutor":t.startsWith("/tutee-dashboard")||t.startsWith("/tutee")?"tutee":null:null,Pd=t=>{if(t4){if(!t){sessionStorage.removeItem(Wm),localStorage.removeItem(Wm);return}sessionStorage.setItem(Wm,t),localStorage.setItem(Wm,t)}},ure=()=>{if(!t4)return null;const t=sessionStorage.getItem(Wm);if(t){const n=t.toLowerCase();if(gg[n])return gg[n]}const e=localStorage.getItem(Wm);if(e){const n=e.toLowerCase();if(gg[n])return gg[n]}return null},A2=t=>{const e=Z7(t4?window.location.pathname:"");return e||ure()},n4=t=>`${lre}${t}`,$2=t=>`${cre}${t}`,dre=t=>localStorage.getItem(n4(t)),hre=t=>{const e=localStorage.getItem($2(t));if(!e)return null;try{return JSON.parse(e)}catch{return null}},nw=(t,e,n)=>{localStorage.setItem(n4(t),n),localStorage.setItem($2(t),JSON.stringify(e)),Pd(t)},J7=t=>{localStorage.removeItem(n4(t)),localStorage.removeItem($2(t))},Lg=t=>{const e=ci(t.role)??ci(t.user_type);e&&localStorage.setItem($2(e),JSON.stringify(t))},Mg=t=>{const e=A2();if(e){const n=dre(e);if(n)return n}return localStorage.getItem("token")},nL=t=>{const e=A2();if(e){const s=hre(e);if(s)return s}const n=localStorage.getItem("user");if(!n)return null;try{return JSON.parse(n)}catch{return null}},sw="https://xtf-backend-1.onrender.com",mre=sw.startsWith("http://")||sw.startsWith("https://"),fre=mre?sw:`http://${sw}:3000`,eU=`${fre}/api`,Wv=eU.replace(/\/?api$/,""),we=nr.create({baseURL:eU,timeout:1e4,headers:{},validateStatus:function(t){return t>=200&&t<400}});we.interceptors.request.use(t=>{const e=Mg(),n=t.url||"",s=n.includes("/auth/login")||n.includes("/auth/register")||n.includes("/auth/login-tutor-tutee")||n.includes("/auth/forgot-password")||n.includes("/auth/reset-password"),r=n.split("?")[0],a=r.includes("/landing/stats")||r==="/universities"||r.endsWith("/universities");if(e)t.headers.Authorization=`Bearer ${e}`;else if(!s&&!a){const i=window.location.pathname.toLowerCase();if(!(i.includes("/login")||i.includes("/admin-login")||i.includes("/landingpage")||i.includes("/tuteeregistrationpage")||i.includes("/tutorregistrationpage")||i.includes("/register")||i.includes("/password-reset"))){const c=i.startsWith("/tutor")||i.startsWith("/tutee");window.location.href=c?"/login":"/admin-login"}}return t},t=>(console.error("API Request Error:",t),Promise.reject(t)));we.interceptors.request.use(t=>(console.log("API Request:",{method:t.method,url:t.url,data:t.data,headers:t.headers}),t),t=>(console.error("API Request Error:",t),Promise.reject(t)));we.interceptors.response.use(t=>(console.log("API Response:",{method:t.config.method,url:t.config.url,status:t.status,data:t.data}),t),t=>{var e,n,s,r;return console.error("API Response Error:",{method:(e=t.config)==null?void 0:e.method,url:(n=t.config)==null?void 0:n.url,status:(s=t.response)==null?void 0:s.status,data:(r=t.response)==null?void 0:r.data}),Promise.reject(t)});we.interceptors.response.use(t=>{var e;return console.log(`API Response [${(e=t.config.method)==null?void 0:e.toUpperCase()}] ${t.config.url}:`,{status:t.status,data:t.data}),t},t=>{var f,p,x,y,v,b,N,S,k,T,E,D;if(!t.response){console.error("Network Error:",t.message,"Code:",t.code);const A=t.code||((p=(f=t.message)==null?void 0:f.match(/ERR_\w+/))==null?void 0:p[0]);return Promise.reject({...t,code:t.code||A,response:{data:{message:"Unable to connect to the server. Please check your internet connection."},status:void 0},isNetworkError:!0})}console.error(`API Error [${(y=(x=t.config)==null?void 0:x.method)==null?void 0:y.toUpperCase()}] ${(v=t.config)==null?void 0:v.url}:`,{status:(b=t.response)==null?void 0:b.status,data:(N=t.response)==null?void 0:N.data,error:t.message});const e=(S=t==null?void 0:t.response)==null?void 0:S.status,n=(T=(k=t==null?void 0:t.response)==null?void 0:k.data)==null?void 0:T.message,s=window.__notify,r=(E=t==null?void 0:t.config)==null?void 0:E.url,a=(D=t==null?void 0:t.config)!=null&&D.baseURL?`${t.config.baseURL}${r||""}`:r||"",i=(r||"")+" "+a,l=i.includes("/auth/login")||i.includes("/auth/register")||i.includes("/auth/login-tutor-tutee")||i.includes("/auth/forgot-password")||i.includes("/auth/reset-password")||i.includes("/auth/email-verification"),c=(r==null?void 0:r.includes("/tutors/by-user/"))&&(r==null?void 0:r.includes("/tutor-id")),u=r==null?void 0:r.includes("/courses"),h=typeof n=="string"&&n.toLowerCase().includes("tutor not found");if(s&&!l&&!c&&!u&&!h){let A=Array.isArray(n)?n.join(", "):n;typeof A=="string"&&A.toLowerCase().includes("email already registered")&&(A="Email already registered"),A||(A=e===401?"You are not authorized.":"Something went wrong. Please try again."),s(A,"error")}if(e===401){const A=window.location.pathname.toLowerCase(),I=A==="/login"||A==="/admin-login"||A.includes("/password-reset"),P=A.includes("/landingpage")||A.includes("/tuteeregistrationpage")||A.includes("/tutorregistrationpage");if(!l&&!I&&!P){const $=A2();$&&J7($),localStorage.removeItem("token"),localStorage.removeItem("user");const R=window.location.pathname.toLowerCase(),F=R.startsWith("/tutor")||R.startsWith("/tutee");window.location.href=F?"/login":"/admin-login"}}return Promise.reject(t)});const Zt=t=>{if(!t)return"";if(/^https?:\/\//i.test(t))return t;if(t.startsWith("/user_profile_images/")||t.startsWith("user_profile_images/")){const n=t.startsWith("/")?t:`/${t}`;return`${Wv}${n}`}if(t.startsWith("/admin_qr/")||t.startsWith("admin_qr/")){const n=t.startsWith("/")?t:`/${t}`;return`${Wv}${n}`}if(t.startsWith("/tutor_documents/")||t.startsWith("tutor_documents/")){const n=t.startsWith("/")?t:`/${t}`;return`${Wv}${n}`}const e=t.startsWith("/")?t:`/${t}`;return`${Wv}${e}`},s4=j.createContext(void 0);function pre({children:t}){const[e,n]=j.useState(()=>nL()),[s,r]=j.useState(()=>Mg()),[a,i]=j.useState(!0),l=qr();j.useEffect(()=>{const y=nL(),v=Mg();y&&v&&(n(y),r(v)),i(!1)},[]),j.useEffect(()=>{if(typeof window>"u")return;const y=Z7(window.location.pathname),v=ci(e==null?void 0:e.role)??ci(e==null?void 0:e.user_type);y?Pd(y):v&&Pd(v)},[e]);const c=tn.useCallback(y=>{Promise.resolve().then(()=>{const v=y.user.user_type==="student"?"tutee":y.user.user_type,b={...y.user,role:y.user.role||v,user_type:y.user.user_type};n(b),r(y.accessToken),localStorage.setItem("user",JSON.stringify(b)),localStorage.setItem("token",y.accessToken);const N=ci(b.role)??ci(b.user_type);N&&nw(N,b,y.accessToken)})},[]),x={user:e,token:s,isLoading:a,login:async(y,v)=>{try{const b=await we.post("/auth/login",{email:y,password:v}),{user:N,accessToken:S}=b.data,k={...N,user_type:"admin",role:"admin"};c({user:k,accessToken:S}),Pd("admin")}catch(b){throw b}},loginTutorTutee:async(y,v)=>{console.log("AuthContext: Attempting tutor/tutee login...",{email:y});try{console.log("AuthContext: Making API request...");const b=await we.post("/auth/login-tutor-tutee",{email:y,password:v});console.log("AuthContext: Received response:",b.data);const{user:N,accessToken:S}=b.data;console.log("AuthContext: User data:",N);const k=N.user_type==="student"||N.user_type==="tutee"?"tutee":N.user_type;console.log("AuthContext: Mapped role:",k);const T={...N,role:k};console.log("AuthContext: User with mapped role:",T),n(T),r(S),localStorage.setItem("user",JSON.stringify(T)),localStorage.setItem("token",S);const E=ci(T.role)??ci(T.user_type);return E&&(nw(E,T,S),Pd(E)),console.log("AuthContext: State updated, returning mapped role"),k}catch(b){throw b}},register:async y=>{try{const v=await we.post("/auth/register",{...y,user_type:"admin"});c(v.data)}catch(v){throw v}},logout:async()=>{if(e&&(e.role==="tutor"||e.user_type==="tutor"))try{await we.patch(`/tutors/by-user/${e.user_id}/online-status`,{status:"offline"})}catch(b){console.warn("Failed to update tutor online status on logout:",b)}const y=ci(e==null?void 0:e.role)??ci(e==null?void 0:e.user_type);y&&(J7(y),A2()===y&&Pd(null)),n(null),r(null),localStorage.removeItem("user"),localStorage.removeItem("token"),y||Pd(null);const v=(e==null?void 0:e.role)==="admin";l(v?"/admin-login":"/login")}};return o.jsx(s4.Provider,{value:x,children:t})}function kx(){const t=tn.useContext(s4);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t}const rr=()=>{const t=j.useContext(s4);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},Hu=({className:t="",style:e})=>o.jsx("img",{src:"assets/images/tutorfriends-logo.png",alt:"TutorFriends Logo",className:t,style:e}),tU=({isOpen:t,onClose:e,onSuccess:n,mode:s="default"})=>{const r=qr(),[a,i]=j.useState(""),[l,c]=j.useState(!1),[u,h]=j.useState(""),[f,p]=j.useState(!1),[x,y]=j.useState(!1),v=s==="admin",b=v?"/auth/password-reset/admin/request":"/auth/password-reset/request",N=async T=>{var E,D,A,I,P,$,R,F,W;T.preventDefault(),c(!0),h("");try{console.log("Frontend: Sending email:",a),console.log("Frontend: Email type:",typeof a),console.log("Frontend: Email length:",a.length);try{const K=(E=(await we.get(`/auth/password-reset/check-user-type?email=${encodeURIComponent(a)}`)).data)==null?void 0:E.userType;if(console.log("Frontend: User type check result:",K),!K){h("This email address is not registered in our system. Cannot proceed with password reset. Please verify your email address or contact support if you believe this is an error."),c(!1);return}if(v&&K!=="admin"){h(`This email belongs to a ${K==="tutor"?"tutor":K==="tutee"?"tutee":K} account. Please use the regular login page to reset your password.`),c(!1);return}if(!v&&K==="admin"){h("This email belongs to an admin account. Admin password reset must be done through the Admin Login Page."),c(!1);return}}catch(z){if(((D=z.response)==null?void 0:D.status)===404||((A=z.response)==null?void 0:A.status)===400){const K=((P=(I=z.response)==null?void 0:I.data)==null?void 0:P.message)||"";if(K.toLowerCase().includes("not found")||K.toLowerCase().includes("not registered")){h("This email address is not registered in our system. Cannot proceed with password reset. Please verify your email address or contact support if you believe this is an error."),c(!1);return}}console.log("Frontend: User type check failed, continuing with request:",z)}const q={email:a};console.log("Frontend: Request body:",q);const X=await we.post(b,q);console.log("Frontend: Response received:",X.data),X.data&&(p(!0),y(!0))}catch(q){console.log("Frontend: Error occurred:",q),console.log("Frontend: Error response:",($=q.response)==null?void 0:$.data);const X=((F=(R=q.response)==null?void 0:R.data)==null?void 0:F.message)||q.message||"Failed to send verification code. Please try again.";((W=q.response)==null?void 0:W.status)===404||X.toLowerCase().includes("not found")||X.toLowerCase().includes("user not found")||X.toLowerCase().includes("email not registered")||X.toLowerCase().includes("could not find")||X.toLowerCase().includes("does not exist")?h("This email address is not registered in our system. Cannot proceed with password reset. Please verify your email address or contact support if you believe this is an error."):h(X)}finally{c(!1)}},S=()=>{i(""),h(""),p(!1),y(!1),e()},k=()=>{const T=new URLSearchParams;a&&T.set("email",a),v&&T.set("type","admin"),r(`/password-reset?${T.toString()}`),n&&n(a),e()};return t?o.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"bg-white/95 backdrop-blur-xl rounded-2xl shadow-2xl border border-white/50 max-w-md w-full relative overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 opacity-5",children:o.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-gradient-to-br from-sky-500 to-indigo-600"})}),o.jsxs("div",{className:"relative z-10 p-5",children:[o.jsxs("div",{className:"text-center mb-3",children:[o.jsx("div",{className:"mx-auto w-12 h-12 bg-gradient-to-r from-sky-500 to-indigo-600 rounded-full flex items-center justify-center mb-3",children:o.jsx("svg",{className:"w-6 h-6 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})})}),o.jsx("h2",{className:"text-2xl font-bold bg-gradient-to-r from-slate-900 via-sky-800 to-indigo-800 bg-clip-text text-transparent mb-2",children:"Forgot Password?"}),o.jsxs("p",{className:"text-slate-600 text-sm",children:["Enter your ",v?"admin":"account"," email address and we'll send you a verification code to reset your password."]})]}),f?o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"mx-auto w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mb-3",children:o.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),o.jsx("h3",{className:"text-lg font-semibold text-green-800 mb-2",children:"Code Sent!"}),o.jsxs("p",{className:"text-green-700 text-sm mb-4",children:["We've sent a verification code to ",o.jsx("strong",{children:a}),". Please check your email and spam folder."]}),o.jsxs("div",{className:"flex items-center justify-center space-x-1 mb-4",children:[o.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),o.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse",style:{animationDelay:"0.2s"}}),o.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse",style:{animationDelay:"0.4s"}})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("button",{onClick:k,className:"w-full flex justify-center items-center py-3 px-6 border border-transparent rounded-lg shadow-xl text-sm font-bold text-white bg-gradient-to-r from-green-600 via-green-500 to-emerald-600 hover:from-green-700 hover:via-green-600 hover:to-emerald-700 focus:outline-none focus:ring-4 focus:ring-green-500/30 transition-all duration-300 transform hover:scale-105 hover:shadow-2xl relative overflow-hidden group",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),o.jsxs("span",{className:"relative z-10 flex items-center",children:[o.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Reset Password"]})]}),o.jsx("button",{onClick:S,className:"w-full py-2 px-4 border border-slate-300 rounded-lg text-sm font-medium text-slate-700 hover:bg-slate-50 transition-colors",children:"Close"})]})]}):o.jsxs("form",{onSubmit:N,className:"space-y-3",children:[u&&o.jsx("div",{className:"bg-red-50/90 backdrop-blur-sm border border-red-200 text-red-600 px-3 py-2 rounded-xl text-xs font-medium shadow-lg",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("svg",{className:"w-4 h-4 mr-2 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),u]})}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"email",className:"block text-sm font-semibold text-slate-800",children:"Email Address"}),o.jsxs("div",{className:"relative group",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx("svg",{className:"h-4 w-4 text-slate-400 group-focus-within:text-sky-500 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"})})}),o.jsx("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:a,onChange:T=>i(T.target.value),className:"w-full pl-10 pr-4 py-2 bg-white/95 backdrop-blur-sm border-2 border-slate-200 rounded-lg focus:ring-4 focus:ring-sky-500/20 focus:border-sky-500 transition-all duration-300 placeholder-slate-400 font-medium shadow-lg hover:shadow-xl text-sm group-focus-within:shadow-xl",placeholder:"Enter your university email"})]})]}),o.jsx("div",{className:"pt-2",children:o.jsxs("button",{type:"submit",disabled:l,className:"w-full flex justify-center items-center py-2.5 px-6 border border-transparent rounded-lg shadow-2xl text-sm font-bold text-white bg-gradient-to-r from-sky-600 via-sky-500 to-indigo-600 hover:from-sky-700 hover:via-sky-600 hover:to-indigo-700 focus:outline-none focus:ring-4 focus:ring-sky-500/30 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 transform hover:scale-105 hover:shadow-3xl relative overflow-hidden group",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),l?o.jsxs("div",{className:"flex items-center relative z-10",children:[o.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),o.jsx("span",{className:"text-sm",children:"Sending Code..."})]}):o.jsxs("span",{className:"relative z-10 flex items-center",children:[o.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Send Verification Code"]})]})})]}),o.jsx("button",{onClick:S,className:"absolute top-4 right-4 p-2 text-slate-400 hover:text-slate-600 transition-colors",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})}):null},gre=()=>{const t=qr(),[e,n]=j.useState(""),[s,r]=j.useState(""),[a,i]=j.useState(!1),[l,c]=j.useState(""),[u,h]=j.useState(!1),[f,p]=j.useState(!1),{login:x}=rr(),y=async b=>{var N,S;b.preventDefault(),i(!0),c("");try{if(s.length<7||s.length>13){c("Password must be between 7 and 13 characters."),i(!1);return}await x(e,s);const k=localStorage.getItem("user");if(!k)throw new Error("Login failed: No user data found");const T=JSON.parse(k);if(T.user_type!=="admin"&&T.role!=="admin")throw new Error("This login is for administrators only. Please use the regular login page.");t("/admin/dashboard",{replace:!0})}catch(k){const T=((S=(N=k.response)==null?void 0:N.data)==null?void 0:S.message)||k.message||"Invalid credentials. Please try again.";c(T)}finally{i(!1)}},v="w-full pl-10 pr-10 py-3 bg-slate-50 border border-slate-200 rounded-lg focus:bg-white focus:ring-[3px] focus:ring-sky-500/20 focus:border-sky-500 outline-none transition-all duration-300 font-medium text-slate-900 placeholder:text-slate-400 text-sm shadow-sm";return o.jsxs("div",{className:"h-screen bg-gradient-to-br from-slate-50 via-sky-50 to-indigo-100 flex items-start sm:items-center justify-center p-4 relative overflow-hidden",children:[o.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[o.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-gradient-to-br from-sky-400/20 to-indigo-400/20 rounded-full blur-3xl"}),o.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-gradient-to-tr from-indigo-400/20 to-sky-400/20 rounded-full blur-3xl"})]}),o.jsxs("div",{className:"w-full max-w-6xl bg-white/80 backdrop-blur-2xl rounded-[2.5rem] shadow-2xl overflow-hidden grid lg:grid-cols-2 relative z-10 max-h-[95vh] lg:max-h-[800px]",children:[o.jsxs("div",{className:"relative hidden lg:block h-full min-h-[500px]",children:[o.jsx(xre,{}),o.jsx("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 z-20 w-max",children:o.jsx("div",{className:"flex items-center bg-white/95 backdrop-blur-md border border-white/60 rounded-2xl shadow-xl px-5 py-2.5",children:o.jsx("span",{className:"px-3 py-1 bg-sky-600 text-white rounded-full text-[10px] font-bold tracking-widest uppercase shadow-sm",children:"Administrative"})})})]}),o.jsxs("div",{className:"relative w-full min-h-full lg:h-full bg-white overflow-hidden flex flex-col",children:[o.jsx("div",{className:"absolute top-0 right-0 -mt-20 -mr-20 w-80 h-80 bg-gradient-to-br from-sky-100/40 to-indigo-100/40 rounded-full blur-3xl pointer-events-none"}),o.jsx("div",{className:"relative lg:absolute lg:inset-0 overflow-y-auto flex flex-col lg:justify-center px-6 sm:px-10 pt-10 pb-10 custom-scrollbar lg:[scrollbar-width:none] lg:[-ms-overflow-style:none] lg:[&::-webkit-scrollbar]:display-none",children:o.jsxs("div",{className:"relative z-10 w-full max-w-md mx-auto",children:[o.jsx("div",{className:"mb-8",children:o.jsxs("div",{className:"flex flex-col lg:flex-row items-center lg:justify-between lg:items-end gap-4",children:[o.jsxs("div",{className:"flex flex-col lg:flex-row items-center gap-0",children:[o.jsx(Hu,{className:"h-11 w-auto text-sky-600"}),o.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-sky-600 to-indigo-600 bg-clip-text text-transparent tracking-tight text-center lg:text-left lg:-ml-1.5",children:"TutorFriends"})]}),o.jsxs("div",{className:"text-center lg:text-right pb-0.5",children:[o.jsx("h1",{className:"text-base font-bold text-slate-900 leading-tight",children:"Admin Portal"}),o.jsx("p",{className:"text-slate-500 text-xs font-medium leading-tight mt-0.5",children:"Secure Access"})]})]})}),o.jsxs("form",{className:"space-y-4",onSubmit:y,children:[l&&o.jsx("div",{className:"bg-red-50/90 backdrop-blur-sm border border-red-200 text-red-600 px-4 py-3 rounded-xl text-sm font-medium shadow-lg mb-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("svg",{className:"w-5 h-5 mr-2 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),l]})}),o.jsxs("div",{className:"space-y-1",children:[o.jsx("label",{htmlFor:"email",className:"block text-xs font-bold text-slate-600 uppercase tracking-wider ml-1",children:"Email Address"}),o.jsxs("div",{className:"relative group",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx("svg",{className:"h-5 w-5 text-slate-400 group-focus-within:text-sky-500 transition-colors duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"})})}),o.jsx("input",{id:"email",name:"email",type:"email",required:!0,value:e,onChange:b=>n(b.target.value.toLowerCase()),className:v,placeholder:"admin@university.edu"})]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsxs("div",{className:"flex justify-between items-center ml-1 mb-0",children:[o.jsx("label",{htmlFor:"password",className:"block text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Password"}),o.jsx("button",{type:"button",onClick:()=>p(!0),className:"text-xs font-bold text-sky-600 hover:text-sky-700 transition-colors",children:"Forgot Password?"})]}),o.jsxs("div",{className:"relative group",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx("svg",{className:"h-5 w-5 text-slate-400 group-focus-within:text-sky-500 transition-colors duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),o.jsx("input",{id:"password",name:"password",type:u?"text":"password",required:!0,value:s,onChange:b=>r(b.target.value),placeholder:"",autoComplete:"current-password","data-form-type":"other","data-lpignore":"true","data-1p-ignore":"true","data-bwignore":"true",className:`${v} pr-10 
                      [&::-ms-reveal]:hidden 
                      [&::-webkit-credentials-auto-fill-button]:!hidden 
                      [&::-webkit-strong-password-auto-fill-button]:!hidden`,minLength:7,maxLength:13}),o.jsx("button",{type:"button",onClick:()=>h(!u),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-slate-400 hover:text-slate-600",children:u?o.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}):o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.049m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88L3 3m11.737 11.737l6.264 6.264M21 12c-1.274 4.057-5.064 7-9.542 7-1.307 0-2.542-.255-3.669-.714m5.94-11.526A8.959 8.959 0 0112 5c4.478 0 8.268 2.943 9.542 7a9.97 9.97 0 01-1.563 3.049"})})})]})]}),o.jsx("div",{className:"pt-2",children:o.jsx("button",{type:"submit",disabled:a,className:"w-full py-2.5 px-4 bg-gradient-to-r from-sky-600 to-indigo-600 hover:from-sky-700 hover:to-indigo-700 text-white font-bold rounded-xl shadow-lg shadow-sky-200 transition-all duration-300 transform active:scale-[0.98] disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:a?o.jsxs(o.Fragment,{children:[o.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),o.jsx("span",{children:"Signing In..."})]}):o.jsxs(o.Fragment,{children:[o.jsx("span",{children:"Sign In"}),o.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})})}),o.jsxs("div",{className:"text-center text-sm text-slate-500 font-medium mt-2",children:["Don't have an account?"," ",o.jsx(j2,{to:"/register",className:"text-sky-600 hover:text-sky-700 font-bold transition-colors underline-offset-4 hover:underline",children:"Register here"})]})]}),o.jsx("div",{className:"mt-3 mb-2 flex justify-center",children:o.jsxs("button",{onClick:()=>t("/LandingPage"),className:"group relative flex items-center justify-center text-slate-500 hover:text-sky-600 transition-all duration-300 text-sm font-semibold hover:translate-x-1 py-1",children:[o.jsx("span",{className:"absolute -left-6 opacity-0 -translate-x-2 group-hover:opacity-100 group-hover:translate-x-0 transition-all duration-300",children:""}),o.jsx("span",{children:"Back to Home Page"})]})})]})})]})]}),o.jsx(tU,{isOpen:f,onClose:()=>p(!1),onSuccess:()=>{},mode:"admin"})]})},xre=()=>{const[t,e]=tn.useState(0),n=tn.useMemo(()=>[{src:"https://images.unsplash.com/photo-1553729459-efe14ef6055d?q=80&w=2070&auto=format&fit=crop",alt:"Admin reviewing dashboard analytics charts"},{src:"https://images.unsplash.com/photo-1556157382-97eda2d62296?q=80&w=2070&auto=format&fit=crop",alt:"Team collaboration with laptops in modern office"},{src:"https://images.unsplash.com/photo-1552581234-26160f608093?q=80&w=2070&auto=format&fit=crop",alt:"Secure admin operations on computer"}],[]);return tn.useEffect(()=>{const s=setInterval(()=>e(r=>(r+1)%n.length),4e3);return()=>clearInterval(s)},[n.length]),o.jsxs("div",{className:"absolute inset-0",children:[n.map((s,r)=>o.jsx("img",{src:s.src,alt:s.alt,className:`absolute inset-0 w-full h-full object-cover transition-opacity duration-1000 ${r===t?"opacity-100":"opacity-0"}`},r)),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 via-black/10 to-transparent"})]})},nU=j.createContext(void 0),Mh=()=>{const t=j.useContext(nU);if(!t)throw new Error("useToast must be used within ToastProvider");return t},yre=({children:t})=>{const[e,n]=j.useState([]),s=j.useRef(1),r=c=>n(u=>u.filter(h=>h.id!==c)),a=(c,u="info")=>{const h=s.current++;n(f=>[...f,{id:h,message:c,type:u,action:null}]),setTimeout(()=>r(h),3500)};j.useEffect(()=>(window.__notify=(c,u,h)=>{const f=s.current++;n(p=>[...p,{id:f,message:c,type:u||"info",action:h||null}]),setTimeout(()=>r(f),3500)},()=>{delete window.__notify}),[]);const i=j.useMemo(()=>({notify:a}),[]),l={success:"bg-green-600",error:"bg-red-600",info:"bg-primary-600"};return o.jsxs(nU.Provider,{value:i,children:[t,o.jsx("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:e.map(c=>o.jsxs("div",{className:`text-white shadow-lg rounded-md px-4 py-3 flex items-start gap-3 ${l[c.type]} animate-slide-in`,role:"alert",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("span",{className:"text-sm",children:c.message}),c.action&&o.jsx("div",{className:"mt-2",children:o.jsx("button",{onClick:()=>{var u;try{(u=c.action)!=null&&u.onClick&&c.action.onClick()}catch(h){console.error("Toast action failed",h)}r(c.id)},className:"ml-0 inline-block px-3 py-1 text-sm font-medium bg-white text-gray-800 rounded",children:c.action.label})})]}),o.jsx("button",{className:"ml-2 opacity-80 hover:opacity-100",onClick:()=>r(c.id),"aria-label":"Dismiss",children:""})]},c.id))}),o.jsx("style",{children:`
          @keyframes slide-in { from { transform: translateY(-8px); opacity: 0 } to { transform: translateY(0); opacity: 1 } }
          .animate-slide-in { animation: slide-in 150ms ease-out; }
        `})]})},bre=()=>{const t=qr(),[e,n]=j.useState(""),[s,r]=j.useState(""),[a,i]=j.useState(""),[l,c]=j.useState(""),[u,h]=j.useState(null),[f,p]=j.useState(!1),[x,y]=j.useState(!1),[v,b]=j.useState(!1),{register:N}=rr(),{notify:S}=Mh(),[k,T]=j.useState([]),[E,D]=j.useState(""),[A,I]=j.useState(null),[P,$]=j.useState(!1),[R,F]=j.useState(""),[W,q]=j.useState(!1),[X,z]=j.useState(!1),[K,H]=j.useState(!1),[Y,B]=j.useState(""),[O,U]=j.useState(!1),[J,se]=j.useState(!1);j.useEffect(()=>{(async()=>{try{const re=((await we.get("/universities")).data||[]).filter(je=>je.status==="active");T(re)}catch{}})()},[]),j.useEffect(()=>{if(!s){I(null),$(!1),U(!1),se(!1);return}I(null),ae(s)},[s]);const ae=async ke=>{if(!ke){$(!1),U(!1),se(!1);return}try{const me=await we.get(`/auth/email-verification/status?email=${encodeURIComponent(ke)}&user_type=admin`);me.data&&me.data.is_verified===1?($(!0),U(!1),se(!1)):($(!1),me.data&&me.data.verification_expires?new Date(me.data.verification_expires)>new Date?(U(!0),se(!1)):(U(!0),se(!0)):(U(!1),se(!1)))}catch{$(!1),U(!1),se(!1)}},fe=async()=>{var ke,me,re,je;if(!(!s||A)){z(!0),B("");try{console.log("Frontend: Sending verification code to:",s);const ie=await we.post("/auth/email-verification/send-code",{email:s,user_type:"admin"},{timeout:3e4});console.log("Frontend: Verification code response:",ie.data),ie.data&&(U(!0),se(!1),q(!0),S("Verification code sent to your email!","success"))}catch(ie){console.log("Frontend: Verification code error:",ie),console.log("Error details:",{message:ie.message,code:ie.code,response:ie.response,request:ie.request});let Re="Failed to send verification code. Please try again.";const Ve=ie.code==="ERR_CONNECTION_TIMED_OUT"||ie.code==="ETIMEDOUT"||ie.message&&ie.message.includes("ERR_CONNECTION_TIMED_OUT")||ie.message&&ie.message.includes("Connection timed out"),Ze=ie.code==="ECONNABORTED"||ie.message&&ie.message.includes("timeout")&&!Ve,bt=(ie.isNetworkError||ie.code==="ENOTFOUND"||ie.code==="ERR_NETWORK"||ie.code==="ERR_INTERNET_DISCONNECTED"||ie.message&&ie.message.includes("Network Error"))&&!Ve&&!Ze,tt=!ie.response&&ie.request&&!Ve&&!Ze||ie.response&&!ie.response.status&&((me=(ke=ie.response.data)==null?void 0:ke.message)==null?void 0:me.includes("Unable to connect to the server"))&&!Ve&&!Ze;Ve?Re="Connection timed out. Please check that the backend server is running at the correct IP address and port, and that there are no firewall issues blocking the connection.":Ze?Re="Request timed out. The email service may be slow. Please try again.":bt||tt?Re="Unable to connect to the server. Please ensure the backend server is running and try again.":(je=(re=ie.response)==null?void 0:re.data)!=null&&je.message?Re=ie.response.data.message:ie.message&&(Re=ie.message),B(Re)}finally{z(!1)}}},ye=async()=>{var ke,me,re,je;if(!R.trim()){B("Please enter the verification code");return}H(!0),B("");try{console.log("Frontend: Verifying code:",R);const ie=await we.post("/auth/email-verification/verify-code",{email:s,code:R,user_type:"admin"},{timeout:3e4});console.log("Frontend: Verification response:",ie.data),ie.data&&($(!0),U(!1),se(!1),q(!1),F(""),S("Email verified successfully! You can now create your account.","success"))}catch(ie){console.log("Frontend: Verification error:",ie),console.log("Error details:",{message:ie.message,code:ie.code,response:ie.response,request:ie.request});let Re="Invalid verification code. Please try again.";const Ve=ie.code==="ERR_CONNECTION_TIMED_OUT"||ie.code==="ETIMEDOUT"||ie.message&&ie.message.includes("ERR_CONNECTION_TIMED_OUT")||ie.message&&ie.message.includes("Connection timed out"),Ze=ie.code==="ECONNABORTED"||ie.message&&ie.message.includes("timeout")&&!Ve,bt=(ie.isNetworkError||ie.code==="ENOTFOUND"||ie.code==="ERR_NETWORK"||ie.code==="ERR_INTERNET_DISCONNECTED"||ie.message&&ie.message.includes("Network Error"))&&!Ve&&!Ze,tt=!ie.response&&ie.request&&!Ve&&!Ze||ie.response&&!ie.response.status&&((me=(ke=ie.response.data)==null?void 0:ke.message)==null?void 0:me.includes("Unable to connect to the server"))&&!Ve&&!Ze;Ve?Re="Connection timed out. Please check that the backend server is running at the correct IP address and port, and that there are no firewall issues blocking the connection.":Ze?Re="Request timed out. The email service may be slow. Please try again.":bt||tt?Re="Unable to connect to the server. Please ensure the backend server is running and try again.":(je=(re=ie.response)==null?void 0:re.data)!=null&&je.message?Re=ie.response.data.message:ie.message&&(Re=ie.message),B(Re)}finally{H(!1)}},Te=()=>{q(!1),F(""),B("")},oe=async ke=>{var me,re,je;if(ke.preventDefault(),a!==l){h("Passwords do not match.");return}if(a.length<7||a.length>13){h("Password must be between 7 and 13 characters.");return}if(A){h(A);return}if(!P){h("Please verify your email address before creating your account.");return}h(null),p(!0);try{await N({name:e,email:s,password:a,user_type:"admin",...E?{university_id:Number(E)}:{}}),S("Account created successfully! Redirecting to admin dashboard...","success"),setTimeout(()=>{p(!1),t("/admin/dashboard")},1500)}catch(ie){const Re=((re=(me=ie.response)==null?void 0:me.data)==null?void 0:re.message)||ie.message||"An unknown error occurred during registration.",Ze=((je=ie.response)==null?void 0:je.status)===404||Re!=null&&Re.toString().includes("404")?"1 Admin Account is permitted.":Re;h(Ze),p(!1)}},Se="w-full px-4 py-3 bg-slate-50 border border-slate-200 rounded-lg focus:bg-white focus:ring-[3px] focus:ring-sky-500/20 focus:border-sky-500 outline-none transition-all duration-300 font-medium text-slate-900 placeholder:text-slate-400 text-sm shadow-sm";return o.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-sky-50 to-indigo-100 flex items-start justify-center p-4 relative overflow-y-auto overflow-x-hidden",children:[o.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[o.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-gradient-to-br from-sky-400/20 to-indigo-400/20 rounded-full blur-3xl"}),o.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-gradient-to-tr from-indigo-400/20 to-sky-400/20 rounded-full blur-3xl"})]}),o.jsxs("div",{className:"w-full max-w-6xl my-auto bg-white/80 backdrop-blur-2xl rounded-[2.5rem] shadow-2xl lg:overflow-hidden grid lg:grid-cols-2 relative z-10 lg:max-h-[800px]",children:[o.jsxs("div",{className:"relative hidden lg:block h-full min-h-[500px]",children:[o.jsx(vre,{}),o.jsx("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 z-20 w-max",children:o.jsxs("div",{className:"flex items-center gap-3 bg-white/95 backdrop-blur-md border border-white/60 rounded-2xl shadow-xl px-5 py-2.5",children:[o.jsx(Hu,{className:"h-8 w-auto text-sky-600"}),o.jsx("div",{className:"h-6 w-px bg-slate-200 mx-1"}),o.jsx("span",{className:"px-3 py-1 bg-sky-600 text-white rounded-full text-[10px] font-bold tracking-widest uppercase shadow-sm",children:"Administrative"})]})})]}),o.jsxs("div",{className:"relative w-full min-h-full lg:h-full bg-white overflow-hidden flex flex-col",children:[o.jsx("div",{className:"absolute top-0 right-0 -mt-20 -mr-20 w-80 h-80 bg-gradient-to-br from-sky-100/40 to-indigo-100/40 rounded-full blur-3xl pointer-events-none"}),o.jsx("div",{className:`relative lg:absolute lg:inset-0 flex flex-col px-6 sm:px-10 pt-12 pb-10 custom-scrollbar lg:[scrollbar-width:none] lg:[-ms-overflow-style:none] lg:[&::-webkit-scrollbar]:display-none ${P?"lg:overflow-y-auto":"lg:overflow-hidden"}`,children:o.jsxs("div",{className:"relative z-10 w-full max-w-md mx-auto my-auto",children:[o.jsxs("form",{className:"space-y-4 pt-0",onSubmit:oe,children:[o.jsxs("div",{className:"bg-gradient-to-r from-primary-50 to-primary-100 p-3 rounded-xl border border-primary-200 mt-2",children:[o.jsxs("h3",{className:"text-base font-semibold text-slate-800 mb-2 flex items-center",children:[o.jsx("svg",{className:"w-4 h-4 mr-2 text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Email Verification"]}),o.jsxs("div",{className:"flex flex-col gap-2",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-bold text-slate-600 uppercase tracking-wider ml-1",children:"University(Optional)"}),o.jsxs("select",{className:"w-full px-4 py-3 border border-slate-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all",value:E,onChange:ke=>D(ke.target.value?Number(ke.target.value):""),children:[o.jsx("option",{value:"",children:"Select University"}),k.map(ke=>o.jsx("option",{value:ke.university_id,children:ke.name},ke.university_id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs font-bold text-slate-600 uppercase tracking-wider ml-1",children:"Email Address"}),o.jsx("input",{type:"email",value:s,onChange:ke=>r(ke.target.value),className:`w-full px-4 py-3 border rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all ${A?"border-red-400 bg-red-50":"border-slate-300"}`,placeholder:"Enter your email address",required:!0}),A&&o.jsxs("p",{className:"text-sm text-red-600 mt-2 flex items-center",children:[o.jsx("svg",{className:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),A]})]})]}),o.jsxs("div",{className:"mt-2 space-y-2",children:[o.jsx("div",{className:"flex items-center text-slate-600",children:P?o.jsxs("div",{className:"flex items-center text-green-700",children:[o.jsx("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),o.jsx("span",{className:"font-medium",children:"Email verified successfully!"})]}):o.jsxs("div",{className:"flex items-center text-slate-600",children:[o.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 19.5c-.77.833.192 2.5 1.732 2.5z"})}),o.jsx("span",{children:"Email verification required to create account"})]})}),(!O||J)&&!P&&o.jsx("button",{type:"button",onClick:fe,disabled:!s||A||X,className:`w-full px-6 py-3 rounded-lg font-semibold transition-all duration-300 transform ${!s||A?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-primary-600 text-white hover:bg-primary-700 hover:scale-105 shadow-lg hover:shadow-xl focus:ring-2 focus:ring-primary-500 focus:ring-offset-2"}`,title:s?A?"Fix email domain error first":J?"Code expired. Send a new code":"Send verification code":"Enter email first",children:X?o.jsxs("div",{className:"flex justify-center items-center",children:[o.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Sending Code..."]}):o.jsxs("div",{className:"flex justify-center items-center",children:[o.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Send Code"]})}),O&&!J&&!P&&o.jsx("button",{type:"button",onClick:()=>q(!0),disabled:!s||A,className:`w-full px-6 py-3 rounded-lg font-semibold transition-all duration-300 transform ${!s||A?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-primary-600 text-white hover:bg-primary-700 hover:scale-105 shadow-lg hover:shadow-xl focus:ring-2 focus:ring-primary-500 focus:ring-offset-2"}`,title:s?A?"Fix email domain error first":"Enter verification code":"Enter email first",children:o.jsxs("div",{className:"flex justify-center items-center",children:[o.jsxs("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Input Code"]})}),P&&o.jsxs("div",{className:"w-full px-6 py-3 rounded-lg font-semibold bg-green-100 text-green-800 border-2 border-green-300 cursor-default flex justify-center items-center",children:[o.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Verified "]})]})]}),P&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"name",className:"block text-xs font-bold text-slate-600 uppercase tracking-wider ml-1",children:"Full Name"}),o.jsx("input",{id:"name",name:"name",type:"text",autoComplete:"name",required:!0,value:e,onChange:ke=>{let me=ke.target.value.replace(/[^a-zA-Z.]/g,"");if((me.match(/\./g)||[]).length>1){const je=me.indexOf(".");me=me.slice(0,je+1)+me.slice(je+1).replace(/\./g,"")}me.length>100&&(me=me.slice(0,100)),n(me)},className:Se,placeholder:"John Doe",maxLength:100})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"password",className:"block text-xs font-bold text-slate-600 uppercase tracking-wider ml-1",children:"Password"}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{id:"password",name:"password",type:x?"text":"password",autoComplete:"new-password","data-form-type":"other","data-lpignore":"true","data-1p-ignore":"true","data-bwignore":"true",style:{WebkitTextSecurity:x?"none":"disc",WebkitAppearance:"none",MozAppearance:"textfield"},required:!0,value:a,onChange:ke=>i(ke.target.value),className:`${Se} pr-10 
                    [&::-ms-reveal]:hidden 
                    [&::-webkit-credentials-auto-fill-button]:!hidden 
                    [&::-webkit-strong-password-auto-fill-button]:!hidden 
                    [&::-webkit-credentials-auto-fill-button]:!hidden 
                    [&::-webkit-strong-password-auto-fill-button]:!hidden`,minLength:7,maxLength:13,placeholder:"********"}),o.jsx("button",{type:"button",onClick:()=>y(!x),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-slate-400 hover:text-slate-600",children:x?o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"h-5 w-5",children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}):o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"h-5 w-5",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.242 4.242L6.228 6.228"})})})]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"confirm-password",className:"block text-xs font-bold text-slate-600 uppercase tracking-wider ml-1",children:"Confirm Password"}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{id:"confirm-password",name:"confirm-password",type:v?"text":"password",autoComplete:"new-password","data-form-type":"other","data-lpignore":"true","data-1p-ignore":"true","data-bwignore":"true",style:{WebkitTextSecurity:v?"none":"disc",WebkitAppearance:"none",MozAppearance:"textfield"},required:!0,value:l,onChange:ke=>c(ke.target.value),className:`${Se} pr-10 
                    [&::-ms-reveal]:hidden 
                    [&::-webkit-credentials-auto-fill-button]:!hidden 
                    [&::-webkit-strong-password-auto-fill-button]:!hidden 
                    [&::-webkit-credentials-auto-fill-button]:!hidden 
                    [&::-webkit-strong-password-auto-fill-button]:!hidden`,minLength:7,maxLength:13,placeholder:"********"}),o.jsx("button",{type:"button",onClick:()=>b(!v),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-slate-400 hover:text-slate-600",children:v?o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"h-5 w-5",children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}):o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"h-5 w-5",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.242 4.242L6.228 6.228"})})})]})]})]}),u&&o.jsx("div",{className:"bg-red-50/90 backdrop-blur-sm border border-red-200 text-red-600 px-4 py-3 rounded-xl text-sm font-medium shadow-lg",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("svg",{className:"w-5 h-5 mr-2 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),u]})}),o.jsx("div",{className:"pt-2",children:o.jsx("button",{type:"submit",disabled:f||!P,className:"w-full py-2.5 px-4 bg-gradient-to-r from-sky-600 to-indigo-600 hover:from-sky-700 hover:to-indigo-700 text-white font-bold rounded-xl shadow-lg shadow-sky-200 transition-all duration-300 transform active:scale-[0.98] disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:f?o.jsxs(o.Fragment,{children:[o.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),o.jsx("span",{children:"Creating account..."})]}):o.jsxs(o.Fragment,{children:[o.jsx("span",{children:P?"Create account":"Verify Email to Create Account"}),o.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})})})]}),o.jsxs("div",{className:"mt-2 text-center text-sm text-slate-500 font-medium",children:["Already have an account?"," ",o.jsx(j2,{to:"/admin-login",className:"text-sky-600 hover:text-sky-700 font-bold transition-colors underline-offset-4 hover:underline",children:"Sign in here"})]}),o.jsx("div",{className:"mt-2 mb-2 flex justify-center",children:o.jsxs("button",{onClick:()=>t("/LandingPage"),className:"group relative flex items-center justify-center text-slate-500 hover:text-sky-600 transition-all duration-300 text-sm font-semibold hover:translate-x-1 py-1",children:[o.jsx("span",{className:"absolute -left-6 opacity-0 -translate-x-2 group-hover:opacity-100 group-hover:translate-x-0 transition-all duration-300",children:""}),o.jsx("span",{children:"Back to Home Page"})]})})]})})]})]}),W&&o.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:ke=>{ke.target===ke.currentTarget&&Te()},children:o.jsxs("div",{className:"bg-white/95 backdrop-blur-xl rounded-2xl shadow-2xl border border-white/50 max-w-md w-full relative overflow-hidden",onClick:ke=>ke.stopPropagation(),children:[o.jsx("div",{className:"absolute inset-0 opacity-5",children:o.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-gradient-to-br from-primary-500 to-primary-700"})}),o.jsxs("div",{className:"relative z-10 p-6",children:[o.jsxs("div",{className:"text-center mb-6",children:[o.jsx("div",{className:"mx-auto w-16 h-16 bg-gradient-to-r from-primary-500 to-primary-700 rounded-full flex items-center justify-center mb-4",children:o.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),o.jsx("h2",{className:"text-2xl font-bold bg-gradient-to-r from-slate-900 via-primary-700 to-primary-800 bg-clip-text text-transparent mb-2",children:"Verify Your Email"}),o.jsxs("p",{className:"text-slate-600 text-sm",children:["We've sent a 6-digit verification code to ",o.jsx("strong",{children:s}),". Please check your email and enter the code below."]})]}),Y&&o.jsx("div",{className:"bg-red-50/90 backdrop-blur-sm border border-red-200 text-red-600 px-4 py-3 rounded-xl text-sm font-medium shadow-lg mb-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("svg",{className:"w-5 h-5 mr-2 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),Y]})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"verification-code",className:"block text-sm font-semibold text-slate-800 mb-2",children:"Verification Code"}),o.jsxs("div",{className:"relative",children:[o.jsx("input",{id:"verification-code",type:"text",value:R,onChange:ke=>{const me=ke.target.value.replace(/\D/g,"").slice(0,6);F(me)},placeholder:"Enter 6-digit code",className:"w-full px-4 py-3 pr-12 bg-white/95 backdrop-blur-sm border-2 border-slate-200 rounded-lg focus:ring-4 focus:ring-primary-500/20 focus:border-primary-500 transition-all duration-300 placeholder-slate-400 font-medium shadow-lg hover:shadow-xl text-center text-2xl tracking-widest",maxLength:6,autoComplete:"off"}),R&&o.jsx("button",{type:"button",onClick:()=>{F(""),B("")},className:"absolute right-3 top-1/2 -translate-y-1/2 p-1 text-slate-400 hover:text-slate-600 transition-colors rounded-full hover:bg-slate-100",title:"Clear code",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsxs("button",{onClick:ye,disabled:!R.trim()||R.length!==6||K,className:"flex-1 flex justify-center items-center py-3 px-6 border border-transparent rounded-lg shadow-2xl text-sm font-bold text-white bg-gradient-to-r from-primary-600 via-primary-500 to-primary-700 hover:from-primary-700 hover:via-primary-600 hover:to-primary-800 focus:outline-none focus:ring-4 focus:ring-primary-500/30 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 transform hover:scale-105 hover:shadow-3xl relative overflow-hidden group",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),K?o.jsxs("div",{className:"flex items-center relative z-10",children:[o.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),o.jsx("span",{className:"text-sm",children:"Verifying..."})]}):o.jsxs("span",{className:"relative z-10 flex items-center",children:[o.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Verify Code"]})]}),o.jsx("button",{onClick:Te,className:"px-4 py-3 border border-slate-300 rounded-lg text-sm font-medium text-slate-700 hover:bg-slate-50 transition-colors",children:"Cancel"})]}),o.jsx("div",{className:"text-center",children:o.jsx("button",{onClick:fe,disabled:X,className:"text-sm text-primary-600 hover:text-primary-700 font-medium transition-colors",children:X?"Sending...":"Didn't receive the code? Resend"})})]})]}),o.jsx("button",{type:"button",onClick:Te,className:"absolute top-4 right-4 z-20 p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-full transition-all duration-200 cursor-pointer",title:"Close","aria-label":"Close verification modal",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})]})},vre=()=>{const[t,e]=tn.useState(0),n=tn.useMemo(()=>[{src:"https://images.unsplash.com/photo-1552581234-26160f608093?q=80&w=2070&auto=format&fit=crop",alt:"Admin secure registration environment"},{src:"https://images.unsplash.com/photo-1522075469751-3a6694fb2f61?q=80&w=2070&auto=format&fit=crop",alt:"Admin collaboration in modern workspace"},{src:"https://images.unsplash.com/photo-1521791136064-7986c2920216?q=80&w=2070&auto=format&fit=crop",alt:"Admin teamwork in modern office"}],[]);return tn.useEffect(()=>{const s=setInterval(()=>e(r=>(r+1)%n.length),4e3);return()=>clearInterval(s)},[n.length]),o.jsxs("div",{className:"absolute inset-0",children:[n.map((s,r)=>o.jsx("img",{src:s.src,alt:s.alt,className:`absolute inset-0 w-full h-full object-cover transition-opacity duration-1000 ${r===t?"opacity-100":"opacity-0"}`},r)),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 via-black/10 to-transparent"})]})},wre=()=>{const{user:t,isLoading:e}=rr(),n=vi();if(e)return o.jsx("div",{className:"flex justify-center items-center h-screen",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(!t){const r=n.pathname,a=r.startsWith("/tutor")||r.startsWith("/tutee");return o.jsx(nl,{to:a?"/login":"/admin-login",state:{from:n},replace:!0})}const s=n.pathname;if(s.startsWith("/admin")){if(t.role!=="admin"&&t.user_type!=="admin")return o.jsx(nl,{to:"/admin-login",replace:!0})}else if(s.startsWith("/tutor")){if(t.role!=="tutor"&&t.user_type!=="tutor")return o.jsx(nl,{to:"/login",replace:!0})}else if(s.startsWith("/tutee")&&t.role!=="tutee"&&t.user_type!=="tutee"&&t.user_type!=="student")return console.log("Access denied to tutee route:",{role:t.role,user_type:t.user_type}),o.jsx(nl,{to:"/login",replace:!0});return o.jsx(Zte,{})};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nre=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Sre=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,s)=>s?s.toUpperCase():n.toLowerCase()),sL=t=>{const e=Sre(t);return e.charAt(0).toUpperCase()+e.slice(1)},sU=(...t)=>t.filter((e,n,s)=>!!e&&e.trim()!==""&&s.indexOf(e)===n).join(" ").trim(),jre=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var kre={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cre=j.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:r="",children:a,iconNode:i,...l},c)=>j.createElement("svg",{ref:c,...kre,width:e,height:e,stroke:t,strokeWidth:s?Number(n)*24/Number(e):n,className:sU("lucide",r),...!a&&!jre(l)&&{"aria-hidden":"true"},...l},[...i.map(([u,h])=>j.createElement(u,h)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nn=(t,e)=>{const n=j.forwardRef(({className:s,...r},a)=>j.createElement(Cre,{ref:a,iconNode:e,className:sU(`lucide-${Nre(sL(t))}`,`lucide-${t}`,s),...r}));return n.displayName=sL(t),n};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tre=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],_re=nn("arrow-left",Tre);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ere=[["path",{d:"M4.929 4.929 19.07 19.071",key:"196cmz"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Au=nn("ban",Ere);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Are=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Xd=nn("bell",Are);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $re=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],Fg=nn("book-open",$re);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ire=[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}]],rL=nn("book",Ire);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rre=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Mi=nn("calendar",Rre);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ore=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],$1=nn("camera",Ore);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dre=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],Pre=nn("chart-column",Dre);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lre=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],aL=nn("check",Lre);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mre=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],iL=nn("chevron-down",Mre);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fre=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],oL=nn("chevron-right",Fre);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zre=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],vc=nn("circle-alert",zre);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bre=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Zn=nn("circle-check-big",Bre);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ure=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],jr=nn("circle-check",Ure);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vre=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Wre=nn("circle-x",Vre);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hre=[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Un=nn("clock",Hre);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gre=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],_l=nn("credit-card",Gre);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qre=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],To=nn("dollar-sign",qre);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kre=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Xo=nn("eye",Kre);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xre=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],bs=nn("file-text",Xre);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yre=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],lL=nn("funnel",Yre);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qre=[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]],rU=nn("graduation-cap",Qre);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zre=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],X3=nn("history",Zre);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jre=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],aU=nn("info",Jre);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eae=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],cL=nn("layers",eae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tae=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],nae=nn("layout-dashboard",tae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sae=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],uL=nn("lock",sae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rae=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],r4=nn("log-out",rae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aae=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],Y3=nn("mail",aae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iae=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],a4=nn("menu",iae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oae=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],Gm=nn("message-square",oae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lae=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],zg=nn("plus",lae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cae=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],Q3=nn("refresh-cw",cae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uae=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],dL=nn("save",uae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dae=[["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M18 5v16",key:"1ethyx"}],["path",{d:"m4 6 7.106-3.79a2 2 0 0 1 1.788 0L20 6",key:"zywc2d"}],["path",{d:"m6 11-3.52 2.147a1 1 0 0 0-.48.854V19a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-5a1 1 0 0 0-.48-.853L18 11",key:"1d4ql0"}],["path",{d:"M6 5v16",key:"1sn0nx"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]],Z3=nn("school",dae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hae=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],J3=nn("search",hae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mae=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],fh=nn("square-pen",mae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fae=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],ja=nn("star",fae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pae=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Du=nn("trending-up",pae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gae=[["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M18 12h.01",key:"yjnet6"}],["path",{d:"M18 16h.01",key:"plv8zi"}],["path",{d:"M22 7a1 1 0 0 0-1-1h-2a2 2 0 0 1-1.143-.359L13.143 2.36a2 2 0 0 0-2.286-.001L6.143 5.64A2 2 0 0 1 5 6H3a1 1 0 0 0-1 1v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2z",key:"1ogmi3"}],["path",{d:"M6 12h.01",key:"c2rlol"}],["path",{d:"M6 16h.01",key:"1pmjb7"}],["circle",{cx:"12",cy:"10",r:"2",key:"1yojzk"}]],xae=nn("university",gae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yae=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],iU=nn("upload",yae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bae=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],oU=nn("user-check",bae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vae=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],za=nn("user",vae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wae=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],lU=nn("users",wae);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nae=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Rn=nn("x",Nae),Sae="/assets/tutorfriends-logo-CUD8arwA.png",i4=Sae,jae=[{to:"/admin/dashboard",icon:nae,label:"Dashboard"},{to:"/admin/users",icon:lU,label:"User Management"},{to:"/admin/tutors",icon:oU,label:"Tutor Applications"},{to:"/admin/universities",icon:Z3,label:"Universities"},{to:"/admin/courses",icon:Fg,label:"Courses & Subjects"},{to:"/admin/payments",icon:_l,label:"Payments"}],hL=()=>o.jsxs("aside",{className:"w-64 bg-white border-r border-slate-200 flex flex-col",children:[o.jsxs("div",{className:"h-20 flex items-center border-b border-slate-200 px-4",children:[o.jsx("img",{src:i4,alt:"TutorFriends Logo",className:"h-14 object-contain mr-3"}),o.jsxs("div",{className:"flex flex-col",children:[o.jsx("h1",{className:"text-lg font-bold text-slate-800",children:"TutorFriends"}),o.jsx("p",{className:"text-xs text-slate-600",children:"Connecting Minds, Building Futures"})]})]}),o.jsx("nav",{className:"flex-1 px-4 py-6 space-y-2",children:jae.map(({to:t,icon:e,label:n})=>o.jsxs(Pg,{to:t,className:({isActive:s})=>`flex items-center px-4 py-2.5 text-sm font-medium rounded-md transition-colors ${s?"bg-primary-100 text-primary-700":"text-slate-600 hover:bg-slate-100 hover:text-slate-900"}`,children:[o.jsx(e,{className:"mr-3 h-5 w-5"}),n]},t))})]}),at=({children:t,className:e,variant:n="primary",...s})=>{const r="px-4 py-2 rounded-md font-semibold focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",a={primary:"bg-primary-600 text-white hover:bg-primary-700 focus:ring-primary-500",secondary:"bg-slate-200 text-slate-800 hover:bg-slate-300 focus:ring-slate-400",danger:"bg-red-600 text-white hover:bg-red-700 focus:ring-red-500"};return o.jsx("button",{className:`${r} ${a[n]} ${e}`,...s,children:t})};class kae{constructor(){this.maxNotifications=30,this.baseUrl="/users/notifications"}async getNotifications(){var e;try{return((e=(await we.get(this.baseUrl)).data)==null?void 0:e.data)||[]}catch(n){return console.error("Error fetching notifications:",n),[]}}async getUnreadCount(){var e,n;try{return((n=(e=(await we.get(`${this.baseUrl}/unread-count`)).data)==null?void 0:e.data)==null?void 0:n.count)||0}catch(s){return console.error("Error getting unread count:",s),0}}async markAsRead(e){var n,s;try{const r=await we.patch(`${this.baseUrl}/${e}/read`);if(!((n=r.data)!=null&&n.success))throw new Error(((s=r.data)==null?void 0:s.message)||"Failed to mark notification as read")}catch(r){console.error("Error marking notification as read:",r)}}async markAllAsRead(){var e,n;try{const s=await we.patch(`${this.baseUrl}/mark-all-read`);if(!((e=s.data)!=null&&e.success))throw new Error(((n=s.data)==null?void 0:n.message)||"Failed to mark all notifications as read")}catch(s){console.error("Error marking all notifications as read:",s)}}async deleteNotification(e){var n,s;try{const r=await we.delete(`${this.baseUrl}/${e}`);if(!((n=r.data)!=null&&n.success))throw new Error(((s=r.data)==null?void 0:s.message)||"Failed to delete notification")}catch(r){console.error("Error deleting notification:",r)}}async hasUpcomingSessions(e){var n,s;try{const r=`${this.baseUrl}/upcoming-sessions`;return((s=(n=(await we.get(r,{params:e?{userType:e}:void 0})).data)==null?void 0:n.data)==null?void 0:s.hasUpcoming)||!1}catch(r){return console.error("Error checking upcoming sessions:",r),!1}}}const Mm=new kae,WC={notifications:[],unreadCount:0,hasUpcomingSessions:!1,isLoading:!0,error:null},cU=j.createContext(void 0),o4=({children:t})=>{const[e,n]=j.useState(WC),{notify:s}=Mh(),{user:r}=kx(),a=j.useRef(null),i=j.useRef(null),l=j.useCallback(async()=>{const f=Mg(),p=(r==null?void 0:r.user_id)??null,x=r==null?void 0:r.role;if(!f||!p){a.current=null,i.current=null,n(v=>({...WC,isLoading:!1,error:null}));return}const y=i.current!==p;a.current=p;try{n(k=>y?{...WC,isLoading:!0,error:null}:{...k,isLoading:!0,error:null});const v=x==="tutor"||x==="tutee"?x:void 0,[b,N,S]=await Promise.all([Mm.getNotifications(),Mm.getUnreadCount(),Mm.hasUpcomingSessions(v)]);if(a.current!==p)return;i.current=p,n(k=>({...k,notifications:b,unreadCount:N,hasUpcomingSessions:S,isLoading:!1}))}catch(v){if(console.error("Failed to refresh notifications:",v),a.current!==p)return;n(b=>({...b,isLoading:!1,error:"Failed to refresh notifications"}))}},[r==null?void 0:r.user_id,r==null?void 0:r.role]);j.useEffect(()=>{l()},[l]),j.useEffect(()=>{const f=()=>l();return window.addEventListener("focus",f),()=>{window.removeEventListener("focus",f)}},[l]),j.useEffect(()=>{let f=null;return Mg()&&(f=setInterval(()=>{l()},1e4)),()=>{f&&clearInterval(f)}},[l]);const c=async f=>{try{await Mm.markAsRead(f),await l()}catch(p){console.error("Failed to mark notification as read:",p)}},u=async()=>{try{await Mm.markAllAsRead(),await l()}catch(f){console.error("Failed to mark all notifications as read:",f)}},h=async f=>{try{await Mm.deleteNotification(f),await l()}catch(p){console.error("Failed to delete notification:",p)}};return o.jsx(cU.Provider,{value:{...e,markAsRead:c,markAllAsRead:u,deleteNotification:h,refreshNotifications:l},children:t})},Bg=()=>{const t=j.useContext(cU);if(t===void 0)throw new Error("useNotifications must be used within a NotificationProvider");return t};function Cae(t,e,n="mousedown"){j.useEffect(()=>{const s=r=>{const a=t==null?void 0:t.current;!a||a.contains(r.target)||e(r)};return document.addEventListener(n,s),document.addEventListener("touchstart",s),()=>{document.removeEventListener(n,s),document.removeEventListener("touchstart",s)}},[t,e,n])}const Tae=()=>{const{notifications:t,unreadCount:e,markAsRead:n,markAllAsRead:s,isLoading:r}=Bg(),[a,i]=tn.useState(!1),l=j.useRef(null);Cae(l,()=>i(!1),"mousedown");const c=u=>{const h=new Date(u),p=new Date().getTime()-h.getTime(),x=Math.floor(p/(1e3*60)),y=Math.floor(p/(1e3*60*60)),v=Math.floor(p/(1e3*60*60*24));return x<60?`${x}m ago`:y<24?`${y}h ago`:v<7?`${v}d ago`:h.toLocaleDateString()};return o.jsxs("div",{className:"relative",ref:l,children:[o.jsxs("button",{className:"p-2 rounded-full hover:bg-slate-100 relative",onClick:()=>i(!a),children:[o.jsx(Xd,{className:"h-5 w-5 text-slate-600"}),e>0&&o.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white rounded-full w-5 h-5 text-xs flex items-center justify-center animate-pulse",children:e})]}),o.jsx("div",{className:`absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border border-slate-200 z-50 transform transition-all duration-200 ease-in-out ${a?"opacity-100 translate-y-0":"opacity-0 -translate-y-2 pointer-events-none"}`,children:o.jsxs("div",{className:"p-4",children:[o.jsxs("div",{className:"flex justify-between items-center mb-3",children:[o.jsx("h3",{className:"text-lg font-semibold",children:"Notifications"}),e>0&&o.jsx("button",{onClick:u=>{u.stopPropagation(),s()},className:"text-xs text-blue-600 hover:text-blue-800 transition-colors",children:"Mark all as read"})]}),r?o.jsxs("div",{className:"animate-pulse space-y-4",children:[o.jsx("div",{className:"h-16 bg-slate-100 rounded"}),o.jsx("div",{className:"h-16 bg-slate-100 rounded"})]}):t.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center py-6 text-center",children:[o.jsx(Xd,{className:"h-12 w-12 text-slate-300 mb-2"}),o.jsx("p",{className:"text-slate-500",children:"No notifications"})]}):o.jsx("div",{className:"space-y-3 max-h-[300px] overflow-y-auto custom-scrollbar",children:t.map(u=>{var h;return o.jsx("div",{className:`p-3 rounded-lg transition-all duration-200 ${u.is_read?"bg-slate-50":"bg-blue-50"} hover:shadow-md`,children:o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"text-sm font-medium text-slate-900",children:u.message}),o.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:[((h=u.metadata)==null?void 0:h.session_date)&&o.jsx("span",{className:"mr-2",children:new Date(u.metadata.session_date).toLocaleDateString()}),c(u.created_at)]})]}),!u.is_read&&o.jsx("button",{onClick:f=>{f.stopPropagation(),n(u.notification_id)},className:"ml-2 text-xs text-blue-600 hover:text-blue-800 transition-colors whitespace-nowrap",children:"Mark as read"})]})},u.notification_id)})})]})})]})},_ae=({onMenuClick:t})=>{const{user:e,logout:n}=rr(),s=qr(),[r,a]=j.useState(!1),i=e==null?void 0:e.profile_image_url,l=i?Zt(i):null,c=()=>{s("/admin/profile")};return o.jsxs("header",{className:"h-16 md:h-20 bg-white border-b border-slate-200 flex items-center justify-between px-4 sm:px-4",children:[o.jsx("button",{onClick:t,className:"md:hidden p-2 rounded-md text-slate-700 hover:bg-slate-100 focus:outline-none focus:ring-2 focus:ring-slate-300","aria-label":"Open menu",children:o.jsx(a4,{className:"h-6 w-6"})}),o.jsx("div",{className:"hidden md:block"}),o.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4 md:h-full",children:[o.jsxs("div",{className:"hidden sm:block text-right",children:[o.jsx("p",{className:"text-sm font-semibold text-slate-800 truncate max-w-[120px] lg:max-w-none",children:e==null?void 0:e.name}),o.jsx("p",{className:"text-xs text-slate-500 truncate max-w-[120px] lg:max-w-none",children:e==null?void 0:e.email})]}),o.jsx("button",{type:"button",onClick:c,title:"View profile",className:"h-9 w-9 sm:h-10 sm:w-10 rounded-full overflow-hidden bg-slate-200 border-2 border-slate-300 focus:outline-none focus:ring-2 focus:ring-slate-300 flex-shrink-0",children:l&&!r?o.jsx("img",{src:l,alt:(e==null?void 0:e.name)||"User",className:"h-full w-full object-cover",onError:()=>a(!0)}):o.jsx("div",{className:"h-full w-full flex items-center justify-center bg-gradient-to-br from-blue-500 to-indigo-600",children:e!=null&&e.name?o.jsx("span",{className:"text-white font-semibold text-xs sm:text-sm",children:e.name.charAt(0).toUpperCase()}):o.jsx(za,{className:"h-4 w-4 sm:h-6 sm:w-6 text-white"})})}),o.jsx(Tae,{}),o.jsx(at,{onClick:n,variant:"secondary",className:"!px-2 !py-2 flex-shrink-0",children:o.jsx(r4,{className:"h-4 w-4 sm:h-5 sm:w-5"})})]})]})},Eae=({children:t})=>{const[e,n]=j.useState(!1);return j.useEffect(()=>{const s=()=>{window.innerWidth>=768&&n(!1)};return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),j.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[e]),o.jsxs("div",{className:"flex h-screen bg-slate-50 overflow-hidden",children:[o.jsx("div",{className:"hidden md:flex",children:o.jsx(hL,{})}),o.jsxs("div",{className:`fixed inset-y-0 left-0 z-50 w-64 bg-white border-r border-slate-200 md:hidden transform transition-transform duration-300 ease-in-out ${e?"translate-x-0":"-translate-x-full"}`,children:[o.jsxs("div",{className:"flex items-center justify-between h-16 px-4 border-b border-slate-200 bg-white",children:[o.jsx("h2",{className:"text-lg font-bold text-slate-800",children:"Menu"}),o.jsx("button",{onClick:()=>n(!1),className:"p-2 rounded-md text-slate-600 hover:bg-slate-100 focus:outline-none focus:ring-2 focus:ring-slate-300","aria-label":"Close menu",children:o.jsx(Rn,{className:"h-6 w-6"})})]}),o.jsx("div",{className:"overflow-y-auto h-[calc(100vh-4rem)]",children:o.jsx(hL,{})})]}),e&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden",onClick:()=>n(!1)}),o.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden min-w-0",children:[o.jsx(_ae,{onMenuClick:()=>n(!0)}),o.jsx("main",{className:"flex-1 overflow-x-hidden overflow-y-auto bg-slate-50",children:o.jsx("div",{className:"max-w-7xl mx-auto px-3 sm:px-4 md:px-6 py-4 sm:py-6 md:py-8",children:t})})]})]})},Lt=({children:t,className:e})=>o.jsx("div",{className:`bg-white shadow-md rounded-lg p-6 ${e}`,children:t}),Aae=t=>o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[o.jsx("path",{d:"M8 19V5h4a4 4 0 0 1 0 8h-4"}),o.jsx("path",{d:"M8 13h4"}),o.jsx("path",{d:"M6 13H4"}),o.jsx("path",{d:"M6 9H4"})]});function uU(t){var e,n,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(n=uU(t[e]))&&(s&&(s+=" "),s+=n)}else for(n in t)t[n]&&(s&&(s+=" "),s+=n);return s}function Dn(){for(var t,e,n=0,s="",r=arguments.length;n<r;n++)(t=arguments[n])&&(e=uU(t))&&(s&&(s+=" "),s+=e);return s}var HC={},GC={},mL;function $ae(){return mL||(mL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return n==="__proto__"}t.isUnsafeProperty=e})(GC)),GC}var qC={},fL;function dU(){return fL||(fL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){switch(typeof n){case"number":case"symbol":return!1;case"string":return n.includes(".")||n.includes("[")||n.includes("]")}}t.isDeepKey=e})(qC)),qC}var KC={},pL;function hU(){return pL||(pL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){var s;return typeof n=="string"||typeof n=="symbol"?n:Object.is((s=n==null?void 0:n.valueOf)==null?void 0:s.call(n),-0)?"-0":String(n)}t.toKey=e})(KC)),KC}var XC={},gL;function l4(){return gL||(gL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){const s=[],r=n.length;if(r===0)return s;let a=0,i="",l="",c=!1;for(n.charCodeAt(0)===46&&(s.push(""),a++);a<r;){const u=n[a];l?u==="\\"&&a+1<r?(a++,i+=n[a]):u===l?l="":i+=u:c?u==='"'||u==="'"?l=u:u==="]"?(c=!1,s.push(i),i=""):i+=u:u==="["?(c=!0,i&&(s.push(i),i="")):u==="."?i&&(s.push(i),i=""):i+=u,a++}return i&&s.push(i),s}t.toPath=e})(XC)),XC}var xL;function c4(){return xL||(xL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=$ae(),n=dU(),s=hU(),r=l4();function a(l,c,u){if(l==null)return u;switch(typeof c){case"string":{if(e.isUnsafeProperty(c))return u;const h=l[c];return h===void 0?n.isDeepKey(c)?a(l,r.toPath(c),u):u:h}case"number":case"symbol":{typeof c=="number"&&(c=s.toKey(c));const h=l[c];return h===void 0?u:h}default:{if(Array.isArray(c))return i(l,c,u);if(Object.is(c==null?void 0:c.valueOf(),-0)?c="-0":c=String(c),e.isUnsafeProperty(c))return u;const h=l[c];return h===void 0?u:h}}}function i(l,c,u){if(c.length===0)return u;let h=l;for(let f=0;f<c.length;f++){if(h==null||e.isUnsafeProperty(c[f]))return u;h=h[c[f]]}return h===void 0?u:h}t.get=a})(HC)),HC}var YC,yL;function Iae(){return yL||(yL=1,YC=c4().get),YC}var Rae=Iae();const ef=Hl(Rae);var QC={exports:{}},os={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var bL;function Oae(){if(bL)return os;bL=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),i=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),u=Symbol.for("react.suspense_list"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),p=Symbol.for("react.view_transition"),x=Symbol.for("react.client.reference");function y(v){if(typeof v=="object"&&v!==null){var b=v.$$typeof;switch(b){case t:switch(v=v.type,v){case n:case r:case s:case c:case u:case p:return v;default:switch(v=v&&v.$$typeof,v){case i:case l:case f:case h:return v;case a:return v;default:return b}}case e:return b}}}return os.ContextConsumer=a,os.ContextProvider=i,os.Element=t,os.ForwardRef=l,os.Fragment=n,os.Lazy=f,os.Memo=h,os.Portal=e,os.Profiler=r,os.StrictMode=s,os.Suspense=c,os.SuspenseList=u,os.isContextConsumer=function(v){return y(v)===a},os.isContextProvider=function(v){return y(v)===i},os.isElement=function(v){return typeof v=="object"&&v!==null&&v.$$typeof===t},os.isForwardRef=function(v){return y(v)===l},os.isFragment=function(v){return y(v)===n},os.isLazy=function(v){return y(v)===f},os.isMemo=function(v){return y(v)===h},os.isPortal=function(v){return y(v)===e},os.isProfiler=function(v){return y(v)===r},os.isStrictMode=function(v){return y(v)===s},os.isSuspense=function(v){return y(v)===c},os.isSuspenseList=function(v){return y(v)===u},os.isValidElementType=function(v){return typeof v=="string"||typeof v=="function"||v===n||v===r||v===s||v===c||v===u||typeof v=="object"&&v!==null&&(v.$$typeof===f||v.$$typeof===h||v.$$typeof===i||v.$$typeof===a||v.$$typeof===l||v.$$typeof===x||v.getModuleId!==void 0)},os.typeOf=y,os}var vL;function Dae(){return vL||(vL=1,QC.exports=Oae()),QC.exports}var Pae=Dae(),di=t=>t===0?0:t>0?1:-1,Yi=t=>typeof t=="number"&&t!=+t,Yd=t=>typeof t=="string"&&t.indexOf("%")===t.length-1,qt=t=>(typeof t=="number"||t instanceof Number)&&!Yi(t),Ml=t=>qt(t)||typeof t=="string",Lae=0,Ug=t=>{var e=++Lae;return"".concat(t||"").concat(e)},ol=function(e,n){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!qt(e)&&typeof e!="string")return s;var a;if(Yd(e)){if(n==null)return s;var i=e.indexOf("%");a=n*parseFloat(e.slice(0,i))/100}else a=+e;return Yi(a)&&(a=s),r&&n!=null&&a>n&&(a=n),a},mU=t=>{if(!Array.isArray(t))return!1;for(var e=t.length,n={},s=0;s<e;s++)if(!n[t[s]])n[t[s]]=!0;else return!0;return!1};function Oa(t,e,n){return qt(t)&&qt(e)?t+n*(e-t):e}function Mae(t,e,n){if(!(!t||!t.length))return t.find(s=>s&&(typeof e=="function"?e(s):ef(s,e))===n)}var Hr=t=>t===null||typeof t>"u",Cx=t=>Hr(t)?t:"".concat(t.charAt(0).toUpperCase()).concat(t.slice(1)),Fae=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function u4(t){if(typeof t!="string")return!1;var e=Fae;return e.includes(t)}var zae=["viewBox","children"],wL=["points","pathLength"],ZC={svg:zae,polygon:wL,polyline:wL},Bae=(t,e)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var n=t;if(j.isValidElement(t)&&(n=t.props),typeof n!="object"&&typeof n!="function")return null;var s={};return Object.keys(n).forEach(r=>{u4(r)&&(s[r]=(a=>n[r](n,a)))}),s},Uae=(t,e,n)=>s=>(t(e,n,s),null),I2=(t,e,n)=>{if(t===null||typeof t!="object"&&typeof t!="function")return null;var s=null;return Object.keys(t).forEach(r=>{var a=t[r];u4(r)&&typeof a=="function"&&(s||(s={}),s[r]=Uae(a,e,n))}),s},Vae=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function fU(t){if(typeof t!="string")return!1;var e=Vae;return e.includes(t)}function Rf(t){var e=Object.entries(t).filter(n=>{var[s]=n;return fU(s)});return Object.fromEntries(e)}var NL=t=>typeof t=="string"?t:t?t.displayName||t.name||"Component":"",SL=null,JC=null,pU=t=>{if(t===SL&&Array.isArray(JC))return JC;var e=[];return j.Children.forEach(t,n=>{Hr(n)||(Pae.isFragment(n)?e=e.concat(pU(n.props.children)):e.push(n))}),JC=e,SL=t,e};function Wae(t,e){var n=[],s=[];return Array.isArray(e)?s=e.map(r=>NL(r)):s=[NL(e)],pU(t).forEach(r=>{var a=ef(r,"type.displayName")||ef(r,"type.name");s.indexOf(a)!==-1&&n.push(r)}),n}var Hae=(t,e,n,s)=>{var r;if(typeof e=="symbol"||typeof e=="number")return!0;var a=(r=s&&(ZC==null?void 0:ZC[s]))!==null&&r!==void 0?r:[],i=e.startsWith("data-"),l=typeof t!="function"&&(!!s&&a.includes(e)||fU(e)),c=!!n&&u4(e);return i||l||c},ha=(t,e,n)=>{if(!t||typeof t=="function"||typeof t=="boolean")return null;var s=t;if(j.isValidElement(t)&&(s=t.props),typeof s!="object"&&typeof s!="function")return null;var r={};return Object.keys(s).forEach(a=>{var i;Hae((i=s)===null||i===void 0?void 0:i[a],a,e,n)&&(r[a]=s[a])}),r},Gae=["children","width","height","viewBox","className","style","title","desc"];function e_(){return e_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},e_.apply(null,arguments)}function qae(t,e){if(t==null)return{};var n,s,r=Kae(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(s=0;s<a.length;s++)n=a[s],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Kae(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)!==-1)continue;n[s]=t[s]}return n}var d4=j.forwardRef((t,e)=>{var{children:n,width:s,height:r,viewBox:a,className:i,style:l,title:c,desc:u}=t,h=qae(t,Gae),f=a||{width:s,height:r,x:0,y:0},p=Dn("recharts-surface",i);return j.createElement("svg",e_({},ha(h,!0,"svg"),{className:p,width:s,height:r,style:l,viewBox:"".concat(f.x," ").concat(f.y," ").concat(f.width," ").concat(f.height),ref:e}),j.createElement("title",null,c),j.createElement("desc",null,u),n)}),Xae=["children","className"];function t_(){return t_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},t_.apply(null,arguments)}function Yae(t,e){if(t==null)return{};var n,s,r=Qae(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(s=0;s<a.length;s++)n=a[s],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Qae(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)!==-1)continue;n[s]=t[s]}return n}var Gu=j.forwardRef((t,e)=>{var{children:n,className:s}=t,r=Yae(t,Xae),a=Dn("recharts-layer",s);return j.createElement("g",t_({className:a},ha(r,!0),{ref:e}),n)}),gU=j.createContext(null),Zae=()=>j.useContext(gU);function ys(t){return function(){return t}}const xU=Math.cos,rw=Math.sin,fl=Math.sqrt,aw=Math.PI,R2=2*aw,n_=Math.PI,s_=2*n_,Ld=1e-6,Jae=s_-Ld;function yU(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function eie(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return yU;const n=10**e;return function(s){this._+=s[0];for(let r=1,a=s.length;r<a;++r)this._+=Math.round(arguments[r]*n)/n+s[r]}}class tie{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?yU:eie(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,s,r){this._append`Q${+e},${+n},${this._x1=+s},${this._y1=+r}`}bezierCurveTo(e,n,s,r,a,i){this._append`C${+e},${+n},${+s},${+r},${this._x1=+a},${this._y1=+i}`}arcTo(e,n,s,r,a){if(e=+e,n=+n,s=+s,r=+r,a=+a,a<0)throw new Error(`negative radius: ${a}`);let i=this._x1,l=this._y1,c=s-e,u=r-n,h=i-e,f=l-n,p=h*h+f*f;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(p>Ld)if(!(Math.abs(f*c-u*h)>Ld)||!a)this._append`L${this._x1=e},${this._y1=n}`;else{let x=s-i,y=r-l,v=c*c+u*u,b=x*x+y*y,N=Math.sqrt(v),S=Math.sqrt(p),k=a*Math.tan((n_-Math.acos((v+p-b)/(2*N*S)))/2),T=k/S,E=k/N;Math.abs(T-1)>Ld&&this._append`L${e+T*h},${n+T*f}`,this._append`A${a},${a},0,0,${+(f*x>h*y)},${this._x1=e+E*c},${this._y1=n+E*u}`}}arc(e,n,s,r,a,i){if(e=+e,n=+n,s=+s,i=!!i,s<0)throw new Error(`negative radius: ${s}`);let l=s*Math.cos(r),c=s*Math.sin(r),u=e+l,h=n+c,f=1^i,p=i?r-a:a-r;this._x1===null?this._append`M${u},${h}`:(Math.abs(this._x1-u)>Ld||Math.abs(this._y1-h)>Ld)&&this._append`L${u},${h}`,s&&(p<0&&(p=p%s_+s_),p>Jae?this._append`A${s},${s},0,1,${f},${e-l},${n-c}A${s},${s},0,1,${f},${this._x1=u},${this._y1=h}`:p>Ld&&this._append`A${s},${s},0,${+(p>=n_)},${f},${this._x1=e+s*Math.cos(a)},${this._y1=n+s*Math.sin(a)}`)}rect(e,n,s,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${s=+s}v${+r}h${-s}Z`}toString(){return this._}}function h4(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const s=Math.floor(n);if(!(s>=0))throw new RangeError(`invalid digits: ${n}`);e=s}return t},()=>new tie(e)}function m4(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function bU(t){this._context=t}bU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function O2(t){return new bU(t)}function vU(t){return t[0]}function wU(t){return t[1]}function NU(t,e){var n=ys(!0),s=null,r=O2,a=null,i=h4(l);t=typeof t=="function"?t:t===void 0?vU:ys(t),e=typeof e=="function"?e:e===void 0?wU:ys(e);function l(c){var u,h=(c=m4(c)).length,f,p=!1,x;for(s==null&&(a=r(x=i())),u=0;u<=h;++u)!(u<h&&n(f=c[u],u,c))===p&&((p=!p)?a.lineStart():a.lineEnd()),p&&a.point(+t(f,u,c),+e(f,u,c));if(x)return a=null,x+""||null}return l.x=function(c){return arguments.length?(t=typeof c=="function"?c:ys(+c),l):t},l.y=function(c){return arguments.length?(e=typeof c=="function"?c:ys(+c),l):e},l.defined=function(c){return arguments.length?(n=typeof c=="function"?c:ys(!!c),l):n},l.curve=function(c){return arguments.length?(r=c,s!=null&&(a=r(s)),l):r},l.context=function(c){return arguments.length?(c==null?s=a=null:a=r(s=c),l):s},l}function Hv(t,e,n){var s=null,r=ys(!0),a=null,i=O2,l=null,c=h4(u);t=typeof t=="function"?t:t===void 0?vU:ys(+t),e=typeof e=="function"?e:ys(e===void 0?0:+e),n=typeof n=="function"?n:n===void 0?wU:ys(+n);function u(f){var p,x,y,v=(f=m4(f)).length,b,N=!1,S,k=new Array(v),T=new Array(v);for(a==null&&(l=i(S=c())),p=0;p<=v;++p){if(!(p<v&&r(b=f[p],p,f))===N)if(N=!N)x=p,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),y=p-1;y>=x;--y)l.point(k[y],T[y]);l.lineEnd(),l.areaEnd()}N&&(k[p]=+t(b,p,f),T[p]=+e(b,p,f),l.point(s?+s(b,p,f):k[p],n?+n(b,p,f):T[p]))}if(S)return l=null,S+""||null}function h(){return NU().defined(r).curve(i).context(a)}return u.x=function(f){return arguments.length?(t=typeof f=="function"?f:ys(+f),s=null,u):t},u.x0=function(f){return arguments.length?(t=typeof f=="function"?f:ys(+f),u):t},u.x1=function(f){return arguments.length?(s=f==null?null:typeof f=="function"?f:ys(+f),u):s},u.y=function(f){return arguments.length?(e=typeof f=="function"?f:ys(+f),n=null,u):e},u.y0=function(f){return arguments.length?(e=typeof f=="function"?f:ys(+f),u):e},u.y1=function(f){return arguments.length?(n=f==null?null:typeof f=="function"?f:ys(+f),u):n},u.lineX0=u.lineY0=function(){return h().x(t).y(e)},u.lineY1=function(){return h().x(t).y(n)},u.lineX1=function(){return h().x(s).y(e)},u.defined=function(f){return arguments.length?(r=typeof f=="function"?f:ys(!!f),u):r},u.curve=function(f){return arguments.length?(i=f,a!=null&&(l=i(a)),u):i},u.context=function(f){return arguments.length?(f==null?a=l=null:l=i(a=f),u):a},u}class SU{constructor(e,n){this._context=e,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,n){switch(e=+e,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,n,e,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,e,this._y0,e,n);break}}this._x0=e,this._y0=n}}function nie(t){return new SU(t,!0)}function sie(t){return new SU(t,!1)}const f4={draw(t,e){const n=fl(e/aw);t.moveTo(n,0),t.arc(0,0,n,0,R2)}},rie={draw(t,e){const n=fl(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},jU=fl(1/3),aie=jU*2,iie={draw(t,e){const n=fl(e/aie),s=n*jU;t.moveTo(0,-n),t.lineTo(s,0),t.lineTo(0,n),t.lineTo(-s,0),t.closePath()}},oie={draw(t,e){const n=fl(e),s=-n/2;t.rect(s,s,n,n)}},lie=.8908130915292852,kU=rw(aw/10)/rw(7*aw/10),cie=rw(R2/10)*kU,uie=-xU(R2/10)*kU,die={draw(t,e){const n=fl(e*lie),s=cie*n,r=uie*n;t.moveTo(0,-n),t.lineTo(s,r);for(let a=1;a<5;++a){const i=R2*a/5,l=xU(i),c=rw(i);t.lineTo(c*n,-l*n),t.lineTo(l*s-c*r,c*s+l*r)}t.closePath()}},eT=fl(3),hie={draw(t,e){const n=-fl(e/(eT*3));t.moveTo(0,n*2),t.lineTo(-eT*n,-n),t.lineTo(eT*n,-n),t.closePath()}},bo=-.5,vo=fl(3)/2,r_=1/fl(12),mie=(r_/2+1)*3,fie={draw(t,e){const n=fl(e/mie),s=n/2,r=n*r_,a=s,i=n*r_+n,l=-a,c=i;t.moveTo(s,r),t.lineTo(a,i),t.lineTo(l,c),t.lineTo(bo*s-vo*r,vo*s+bo*r),t.lineTo(bo*a-vo*i,vo*a+bo*i),t.lineTo(bo*l-vo*c,vo*l+bo*c),t.lineTo(bo*s+vo*r,bo*r-vo*s),t.lineTo(bo*a+vo*i,bo*i-vo*a),t.lineTo(bo*l+vo*c,bo*c-vo*l),t.closePath()}};function pie(t,e){let n=null,s=h4(r);t=typeof t=="function"?t:ys(t||f4),e=typeof e=="function"?e:ys(e===void 0?64:+e);function r(){let a;if(n||(n=a=s()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),a)return n=null,a+""||null}return r.type=function(a){return arguments.length?(t=typeof a=="function"?a:ys(a),r):t},r.size=function(a){return arguments.length?(e=typeof a=="function"?a:ys(+a),r):e},r.context=function(a){return arguments.length?(n=a??null,r):n},r}function iw(){}function ow(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function CU(t){this._context=t}CU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:ow(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:ow(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function gie(t){return new CU(t)}function TU(t){this._context=t}TU.prototype={areaStart:iw,areaEnd:iw,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:ow(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function xie(t){return new TU(t)}function _U(t){this._context=t}_U.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,s=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,s):this._context.moveTo(n,s);break;case 3:this._point=4;default:ow(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function yie(t){return new _U(t)}function EU(t){this._context=t}EU.prototype={areaStart:iw,areaEnd:iw,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function bie(t){return new EU(t)}function jL(t){return t<0?-1:1}function kL(t,e,n){var s=t._x1-t._x0,r=e-t._x1,a=(t._y1-t._y0)/(s||r<0&&-0),i=(n-t._y1)/(r||s<0&&-0),l=(a*r+i*s)/(s+r);return(jL(a)+jL(i))*Math.min(Math.abs(a),Math.abs(i),.5*Math.abs(l))||0}function CL(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function tT(t,e,n){var s=t._x0,r=t._y0,a=t._x1,i=t._y1,l=(a-s)/3;t._context.bezierCurveTo(s+l,r+l*e,a-l,i-l*n,a,i)}function lw(t){this._context=t}lw.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:tT(this,this._t0,CL(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,tT(this,CL(this,n=kL(this,t,e)),n);break;default:tT(this,this._t0,n=kL(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}};function AU(t){this._context=new $U(t)}(AU.prototype=Object.create(lw.prototype)).point=function(t,e){lw.prototype.point.call(this,e,t)};function $U(t){this._context=t}$U.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,s,r,a){this._context.bezierCurveTo(e,t,s,n,a,r)}};function vie(t){return new lw(t)}function wie(t){return new AU(t)}function IU(t){this._context=t}IU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),n===2)this._context.lineTo(t[1],e[1]);else for(var s=TL(t),r=TL(e),a=0,i=1;i<n;++a,++i)this._context.bezierCurveTo(s[0][a],r[0][a],s[1][a],r[1][a],t[i],e[i]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function TL(t){var e,n=t.length-1,s,r=new Array(n),a=new Array(n),i=new Array(n);for(r[0]=0,a[0]=2,i[0]=t[0]+2*t[1],e=1;e<n-1;++e)r[e]=1,a[e]=4,i[e]=4*t[e]+2*t[e+1];for(r[n-1]=2,a[n-1]=7,i[n-1]=8*t[n-1]+t[n],e=1;e<n;++e)s=r[e]/a[e-1],a[e]-=s,i[e]-=s*i[e-1];for(r[n-1]=i[n-1]/a[n-1],e=n-2;e>=0;--e)r[e]=(i[e]-r[e+1])/a[e];for(a[n-1]=(t[n]+r[n-1])/2,e=0;e<n-1;++e)a[e]=2*t[e+1]-r[e+1];return[r,a]}function Nie(t){return new IU(t)}function D2(t,e){this._context=t,this._t=e}D2.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}break}}this._x=t,this._y=e}};function Sie(t){return new D2(t,.5)}function jie(t){return new D2(t,0)}function kie(t){return new D2(t,1)}function tf(t,e){if((i=t.length)>1)for(var n=1,s,r,a=t[e[0]],i,l=a.length;n<i;++n)for(r=a,a=t[e[n]],s=0;s<l;++s)a[s][1]+=a[s][0]=isNaN(r[s][1])?r[s][0]:r[s][1]}function a_(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function Cie(t,e){return t[e]}function Tie(t){const e=[];return e.key=t,e}function _ie(){var t=ys([]),e=a_,n=tf,s=Cie;function r(a){var i=Array.from(t.apply(this,arguments),Tie),l,c=i.length,u=-1,h;for(const f of a)for(l=0,++u;l<c;++l)(i[l][u]=[0,+s(f,i[l].key,u,a)]).data=f;for(l=0,h=m4(e(i));l<c;++l)i[h[l]].index=l;return n(i,h),i}return r.keys=function(a){return arguments.length?(t=typeof a=="function"?a:ys(Array.from(a)),r):t},r.value=function(a){return arguments.length?(s=typeof a=="function"?a:ys(+a),r):s},r.order=function(a){return arguments.length?(e=a==null?a_:typeof a=="function"?a:ys(Array.from(a)),r):e},r.offset=function(a){return arguments.length?(n=a??tf,r):n},r}function Eie(t,e){if((s=t.length)>0){for(var n,s,r=0,a=t[0].length,i;r<a;++r){for(i=n=0;n<s;++n)i+=t[n][r][1]||0;if(i)for(n=0;n<s;++n)t[n][r][1]/=i}tf(t,e)}}function Aie(t,e){if((r=t.length)>0){for(var n=0,s=t[e[0]],r,a=s.length;n<a;++n){for(var i=0,l=0;i<r;++i)l+=t[i][n][1]||0;s[n][1]+=s[n][0]=-l/2}tf(t,e)}}function $ie(t,e){if(!(!((i=t.length)>0)||!((a=(r=t[e[0]]).length)>0))){for(var n=0,s=1,r,a,i;s<a;++s){for(var l=0,c=0,u=0;l<i;++l){for(var h=t[e[l]],f=h[s][1]||0,p=h[s-1][1]||0,x=(f-p)/2,y=0;y<l;++y){var v=t[e[y]],b=v[s][1]||0,N=v[s-1][1]||0;x+=b-N}c+=f,u+=x*f}r[s-1][1]+=r[s-1][0]=n,c&&(n-=u/c)}r[s-1][1]+=r[s-1][0]=n,tf(t,e)}}var Iie=["type","size","sizeType"];function i_(){return i_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},i_.apply(null,arguments)}function _L(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function EL(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?_L(Object(n),!0).forEach(function(s){Rie(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_L(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function Rie(t,e,n){return(e=Oie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Oie(t){var e=Die(t,"string");return typeof e=="symbol"?e:e+""}function Die(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pie(t,e){if(t==null)return{};var n,s,r=Lie(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(s=0;s<a.length;s++)n=a[s],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Lie(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)!==-1)continue;n[s]=t[s]}return n}var RU={symbolCircle:f4,symbolCross:rie,symbolDiamond:iie,symbolSquare:oie,symbolStar:die,symbolTriangle:hie,symbolWye:fie},Mie=Math.PI/180,Fie=t=>{var e="symbol".concat(Cx(t));return RU[e]||f4},zie=(t,e,n)=>{if(e==="area")return t;switch(n){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var s=18*Mie;return 1.25*t*t*(Math.tan(s)-Math.tan(s*2)*Math.tan(s)**2)}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},Bie=(t,e)=>{RU["symbol".concat(Cx(t))]=e},p4=t=>{var{type:e="circle",size:n=64,sizeType:s="area"}=t,r=Pie(t,Iie),a=EL(EL({},r),{},{type:e,size:n,sizeType:s}),i="circle";typeof e=="string"&&(i=e);var l=()=>{var p=Fie(i),x=pie().type(p).size(zie(n,s,i));return x()},{className:c,cx:u,cy:h}=a,f=ha(a,!0);return u===+u&&h===+h&&n===+n?j.createElement("path",i_({},f,{className:Dn("recharts-symbols",c),transform:"translate(".concat(u,", ").concat(h,")"),d:l()})):null};p4.registerSymbol=Bie;function o_(){return o_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},o_.apply(null,arguments)}function AL(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function Uie(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?AL(Object(n),!0).forEach(function(s){g4(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):AL(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function g4(t,e,n){return(e=Vie(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vie(t){var e=Wie(t,"string");return typeof e=="symbol"?e:e+""}function Wie(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var wo=32;class x4 extends j.PureComponent{renderIcon(e,n){var{inactiveColor:s}=this.props,r=wo/2,a=wo/6,i=wo/3,l=e.inactive?s:e.color,c=n??e.type;if(c==="none")return null;if(c==="plainline")return j.createElement("line",{strokeWidth:4,fill:"none",stroke:l,strokeDasharray:e.payload.strokeDasharray,x1:0,y1:r,x2:wo,y2:r,className:"recharts-legend-icon"});if(c==="line")return j.createElement("path",{strokeWidth:4,fill:"none",stroke:l,d:"M0,".concat(r,"h").concat(i,`
            A`).concat(a,",").concat(a,",0,1,1,").concat(2*i,",").concat(r,`
            H`).concat(wo,"M").concat(2*i,",").concat(r,`
            A`).concat(a,",").concat(a,",0,1,1,").concat(i,",").concat(r),className:"recharts-legend-icon"});if(c==="rect")return j.createElement("path",{stroke:"none",fill:l,d:"M0,".concat(wo/8,"h").concat(wo,"v").concat(wo*3/4,"h").concat(-wo,"z"),className:"recharts-legend-icon"});if(j.isValidElement(e.legendIcon)){var u=Uie({},e);return delete u.legendIcon,j.cloneElement(e.legendIcon,u)}return j.createElement(p4,{fill:l,cx:r,cy:r,size:wo,sizeType:"diameter",type:c})}renderItems(){var{payload:e,iconSize:n,layout:s,formatter:r,inactiveColor:a,iconType:i}=this.props,l={x:0,y:0,width:wo,height:wo},c={display:s==="horizontal"?"inline-block":"block",marginRight:10},u={display:"inline-block",verticalAlign:"middle",marginRight:4};return e.map((h,f)=>{var p=h.formatter||r,x=Dn({"recharts-legend-item":!0,["legend-item-".concat(f)]:!0,inactive:h.inactive});if(h.type==="none")return null;var y=h.inactive?a:h.color,v=p?p(h.value,h,f):h.value;return j.createElement("li",o_({className:x,style:c,key:"legend-item-".concat(f)},I2(this.props,h,f)),j.createElement(d4,{width:n,height:n,viewBox:l,style:u,"aria-label":"".concat(v," legend icon")},this.renderIcon(h,i)),j.createElement("span",{className:"recharts-legend-item-text",style:{color:y}},v))})}render(){var{payload:e,layout:n,align:s}=this.props;if(!e||!e.length)return null;var r={padding:0,margin:0,textAlign:n==="horizontal"?s:"left"};return j.createElement("ul",{className:"recharts-default-legend",style:r},this.renderItems())}}g4(x4,"displayName","Legend");g4(x4,"defaultProps",{align:"center",iconSize:14,inactiveColor:"#ccc",layout:"horizontal",verticalAlign:"middle"});var nT={},sT={},$L;function Hie(){return $L||($L=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n,s){const r=new Map;for(let a=0;a<n.length;a++){const i=n[a],l=s(i);r.has(l)||r.set(l,i)}return Array.from(r.values())}t.uniqBy=e})(sT)),sT}var rT={},IL;function OU(){return IL||(IL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return n}t.identity=e})(rT)),rT}var aT={},iT={},oT={},RL;function Gie(){return RL||(RL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return Number.isSafeInteger(n)&&n>=0}t.isLength=e})(oT)),oT}var OL;function y4(){return OL||(OL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Gie();function n(s){return s!=null&&typeof s!="function"&&e.isLength(s.length)}t.isArrayLike=n})(iT)),iT}var lT={},DL;function qie(){return DL||(DL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return typeof n=="object"&&n!==null}t.isObjectLike=e})(lT)),lT}var PL;function Kie(){return PL||(PL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=y4(),n=qie();function s(r){return n.isObjectLike(r)&&e.isArrayLike(r)}t.isArrayLikeObject=s})(aT)),aT}var cT={},uT={},LL;function Xie(){return LL||(LL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=c4();function n(s){return function(r){return e.get(r,s)}}t.property=n})(uT)),uT}var dT={},hT={},mT={},fT={},ML;function DU(){return ML||(ML=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return n!==null&&(typeof n=="object"||typeof n=="function")}t.isObject=e})(fT)),fT}var pT={},FL;function PU(){return FL||(FL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return n==null||typeof n!="object"&&typeof n!="function"}t.isPrimitive=e})(pT)),pT}var gT={},zL;function LU(){return zL||(zL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n,s){return n===s||Number.isNaN(n)&&Number.isNaN(s)}t.eq=e})(gT)),gT}var BL;function Yie(){return BL||(BL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=b4(),n=DU(),s=PU(),r=LU();function a(f,p,x){return typeof x!="function"?e.isMatch(f,p):i(f,p,function y(v,b,N,S,k,T){const E=x(v,b,N,S,k,T);return E!==void 0?!!E:i(v,b,y,T)},new Map)}function i(f,p,x,y){if(p===f)return!0;switch(typeof p){case"object":return l(f,p,x,y);case"function":return Object.keys(p).length>0?i(f,{...p},x,y):r.eq(f,p);default:return n.isObject(f)?typeof p=="string"?p==="":!0:r.eq(f,p)}}function l(f,p,x,y){if(p==null)return!0;if(Array.isArray(p))return u(f,p,x,y);if(p instanceof Map)return c(f,p,x,y);if(p instanceof Set)return h(f,p,x,y);const v=Object.keys(p);if(f==null)return v.length===0;if(v.length===0)return!0;if(y&&y.has(p))return y.get(p)===f;y&&y.set(p,f);try{for(let b=0;b<v.length;b++){const N=v[b];if(!s.isPrimitive(f)&&!(N in f)||p[N]===void 0&&f[N]!==void 0||p[N]===null&&f[N]!==null||!x(f[N],p[N],N,f,p,y))return!1}return!0}finally{y&&y.delete(p)}}function c(f,p,x,y){if(p.size===0)return!0;if(!(f instanceof Map))return!1;for(const[v,b]of p.entries()){const N=f.get(v);if(x(N,b,v,f,p,y)===!1)return!1}return!0}function u(f,p,x,y){if(p.length===0)return!0;if(!Array.isArray(f))return!1;const v=new Set;for(let b=0;b<p.length;b++){const N=p[b];let S=!1;for(let k=0;k<f.length;k++){if(v.has(k))continue;const T=f[k];let E=!1;if(x(T,N,b,f,p,y)&&(E=!0),E){v.add(k),S=!0;break}}if(!S)return!1}return!0}function h(f,p,x,y){return p.size===0?!0:f instanceof Set?u([...f],[...p],x,y):!1}t.isMatchWith=a,t.isSetMatch=h})(mT)),mT}var UL;function b4(){return UL||(UL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Yie();function n(s,r){return e.isMatchWith(s,r,()=>{})}t.isMatch=n})(hT)),hT}var xT={},yT={},bT={},VL;function Qie(){return VL||(VL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return Object.getOwnPropertySymbols(n).filter(s=>Object.prototype.propertyIsEnumerable.call(n,s))}t.getSymbols=e})(bT)),bT}var vT={},WL;function MU(){return WL||(WL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return n==null?n===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(n)}t.getTag=e})(vT)),vT}var wT={},HL;function FU(){return HL||(HL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e="[object RegExp]",n="[object String]",s="[object Number]",r="[object Boolean]",a="[object Arguments]",i="[object Symbol]",l="[object Date]",c="[object Map]",u="[object Set]",h="[object Array]",f="[object Function]",p="[object ArrayBuffer]",x="[object Object]",y="[object Error]",v="[object DataView]",b="[object Uint8Array]",N="[object Uint8ClampedArray]",S="[object Uint16Array]",k="[object Uint32Array]",T="[object BigUint64Array]",E="[object Int8Array]",D="[object Int16Array]",A="[object Int32Array]",I="[object BigInt64Array]",P="[object Float32Array]",$="[object Float64Array]";t.argumentsTag=a,t.arrayBufferTag=p,t.arrayTag=h,t.bigInt64ArrayTag=I,t.bigUint64ArrayTag=T,t.booleanTag=r,t.dataViewTag=v,t.dateTag=l,t.errorTag=y,t.float32ArrayTag=P,t.float64ArrayTag=$,t.functionTag=f,t.int16ArrayTag=D,t.int32ArrayTag=A,t.int8ArrayTag=E,t.mapTag=c,t.numberTag=s,t.objectTag=x,t.regexpTag=e,t.setTag=u,t.stringTag=n,t.symbolTag=i,t.uint16ArrayTag=S,t.uint32ArrayTag=k,t.uint8ArrayTag=b,t.uint8ClampedArrayTag=N})(wT)),wT}var NT={},GL;function Zie(){return GL||(GL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}t.isTypedArray=e})(NT)),NT}var qL;function zU(){return qL||(qL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Qie(),n=MU(),s=FU(),r=PU(),a=Zie();function i(h,f){return l(h,void 0,h,new Map,f)}function l(h,f,p,x=new Map,y=void 0){const v=y==null?void 0:y(h,f,p,x);if(v!==void 0)return v;if(r.isPrimitive(h))return h;if(x.has(h))return x.get(h);if(Array.isArray(h)){const b=new Array(h.length);x.set(h,b);for(let N=0;N<h.length;N++)b[N]=l(h[N],N,p,x,y);return Object.hasOwn(h,"index")&&(b.index=h.index),Object.hasOwn(h,"input")&&(b.input=h.input),b}if(h instanceof Date)return new Date(h.getTime());if(h instanceof RegExp){const b=new RegExp(h.source,h.flags);return b.lastIndex=h.lastIndex,b}if(h instanceof Map){const b=new Map;x.set(h,b);for(const[N,S]of h)b.set(N,l(S,N,p,x,y));return b}if(h instanceof Set){const b=new Set;x.set(h,b);for(const N of h)b.add(l(N,void 0,p,x,y));return b}if(typeof Buffer<"u"&&Buffer.isBuffer(h))return h.subarray();if(a.isTypedArray(h)){const b=new(Object.getPrototypeOf(h)).constructor(h.length);x.set(h,b);for(let N=0;N<h.length;N++)b[N]=l(h[N],N,p,x,y);return b}if(h instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&h instanceof SharedArrayBuffer)return h.slice(0);if(h instanceof DataView){const b=new DataView(h.buffer.slice(0),h.byteOffset,h.byteLength);return x.set(h,b),c(b,h,p,x,y),b}if(typeof File<"u"&&h instanceof File){const b=new File([h],h.name,{type:h.type});return x.set(h,b),c(b,h,p,x,y),b}if(h instanceof Blob){const b=new Blob([h],{type:h.type});return x.set(h,b),c(b,h,p,x,y),b}if(h instanceof Error){const b=new h.constructor;return x.set(h,b),b.message=h.message,b.name=h.name,b.stack=h.stack,b.cause=h.cause,c(b,h,p,x,y),b}if(typeof h=="object"&&u(h)){const b=Object.create(Object.getPrototypeOf(h));return x.set(h,b),c(b,h,p,x,y),b}return h}function c(h,f,p=h,x,y){const v=[...Object.keys(f),...e.getSymbols(f)];for(let b=0;b<v.length;b++){const N=v[b],S=Object.getOwnPropertyDescriptor(h,N);(S==null||S.writable)&&(h[N]=l(f[N],N,p,x,y))}}function u(h){switch(n.getTag(h)){case s.argumentsTag:case s.arrayTag:case s.arrayBufferTag:case s.dataViewTag:case s.booleanTag:case s.dateTag:case s.float32ArrayTag:case s.float64ArrayTag:case s.int8ArrayTag:case s.int16ArrayTag:case s.int32ArrayTag:case s.mapTag:case s.numberTag:case s.objectTag:case s.regexpTag:case s.setTag:case s.stringTag:case s.symbolTag:case s.uint8ArrayTag:case s.uint8ClampedArrayTag:case s.uint16ArrayTag:case s.uint32ArrayTag:return!0;default:return!1}}t.cloneDeepWith=i,t.cloneDeepWithImpl=l,t.copyProperties=c})(yT)),yT}var KL;function Jie(){return KL||(KL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=zU();function n(s){return e.cloneDeepWithImpl(s,void 0,s,new Map,void 0)}t.cloneDeep=n})(xT)),xT}var XL;function eoe(){return XL||(XL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=b4(),n=Jie();function s(r){return r=n.cloneDeep(r),a=>e.isMatch(a,r)}t.matches=s})(dT)),dT}var ST={},jT={},kT={},YL;function toe(){return YL||(YL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=zU(),n=FU();function s(r,a){return e.cloneDeepWith(r,(i,l,c,u)=>{const h=a==null?void 0:a(i,l,c,u);if(h!==void 0)return h;if(typeof r=="object")switch(Object.prototype.toString.call(r)){case n.numberTag:case n.stringTag:case n.booleanTag:{const f=new r.constructor(r==null?void 0:r.valueOf());return e.copyProperties(f,r),f}case n.argumentsTag:{const f={};return e.copyProperties(f,r),f.length=r.length,f[Symbol.iterator]=r[Symbol.iterator],f}default:return}})}t.cloneDeepWith=s})(kT)),kT}var QL;function noe(){return QL||(QL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=toe();function n(s){return e.cloneDeepWith(s)}t.cloneDeep=n})(jT)),jT}var CT={},TT={},ZL;function BU(){return ZL||(ZL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=/^(?:0|[1-9]\d*)$/;function n(s,r=Number.MAX_SAFE_INTEGER){switch(typeof s){case"number":return Number.isInteger(s)&&s>=0&&s<r;case"symbol":return!1;case"string":return e.test(s)}}t.isIndex=n})(TT)),TT}var _T={},JL;function soe(){return JL||(JL=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=MU();function n(s){return s!==null&&typeof s=="object"&&e.getTag(s)==="[object Arguments]"}t.isArguments=n})(_T)),_T}var eM;function roe(){return eM||(eM=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=dU(),n=BU(),s=soe(),r=l4();function a(i,l){let c;if(Array.isArray(l)?c=l:typeof l=="string"&&e.isDeepKey(l)&&(i==null?void 0:i[l])==null?c=r.toPath(l):c=[l],c.length===0)return!1;let u=i;for(let h=0;h<c.length;h++){const f=c[h];if((u==null||!Object.hasOwn(u,f))&&!((Array.isArray(u)||s.isArguments(u))&&n.isIndex(f)&&f<u.length))return!1;u=u[f]}return!0}t.has=a})(CT)),CT}var tM;function aoe(){return tM||(tM=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=b4(),n=hU(),s=noe(),r=c4(),a=roe();function i(l,c){switch(typeof l){case"object":{Object.is(l==null?void 0:l.valueOf(),-0)&&(l="-0");break}case"number":{l=n.toKey(l);break}}return c=s.cloneDeep(c),function(u){const h=r.get(u,l);return h===void 0?a.has(u,l):c===void 0?h===void 0:e.isMatch(h,c)}}t.matchesProperty=i})(ST)),ST}var nM;function ioe(){return nM||(nM=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=OU(),n=Xie(),s=eoe(),r=aoe();function a(i){if(i==null)return e.identity;switch(typeof i){case"function":return i;case"object":return Array.isArray(i)&&i.length===2?r.matchesProperty(i[0],i[1]):s.matches(i);case"string":case"symbol":case"number":return n.property(i)}}t.iteratee=a})(cT)),cT}var sM;function ooe(){return sM||(sM=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Hie(),n=OU(),s=Kie(),r=ioe();function a(i,l=n.identity){return s.isArrayLikeObject(i)?e.uniqBy(Array.from(i),r.iteratee(l)):[]}t.uniqBy=a})(nT)),nT}var ET,rM;function loe(){return rM||(rM=1,ET=ooe().uniqBy),ET}var coe=loe();const aM=Hl(coe);function UU(t,e,n){return e===!0?aM(t,n):typeof e=="function"?aM(t,e):t}var AT={exports:{}},$T={},IT={exports:{}},RT={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iM;function uoe(){if(iM)return RT;iM=1;var t=Tf();function e(f,p){return f===p&&(f!==0||1/f===1/p)||f!==f&&p!==p}var n=typeof Object.is=="function"?Object.is:e,s=t.useState,r=t.useEffect,a=t.useLayoutEffect,i=t.useDebugValue;function l(f,p){var x=p(),y=s({inst:{value:x,getSnapshot:p}}),v=y[0].inst,b=y[1];return a(function(){v.value=x,v.getSnapshot=p,c(v)&&b({inst:v})},[f,x,p]),r(function(){return c(v)&&b({inst:v}),f(function(){c(v)&&b({inst:v})})},[f]),i(x),x}function c(f){var p=f.getSnapshot;f=f.value;try{var x=p();return!n(f,x)}catch{return!0}}function u(f,p){return p()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?u:l;return RT.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:h,RT}var oM;function doe(){return oM||(oM=1,IT.exports=uoe()),IT.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lM;function hoe(){if(lM)return $T;lM=1;var t=Tf(),e=doe();function n(u,h){return u===h&&(u!==0||1/u===1/h)||u!==u&&h!==h}var s=typeof Object.is=="function"?Object.is:n,r=e.useSyncExternalStore,a=t.useRef,i=t.useEffect,l=t.useMemo,c=t.useDebugValue;return $T.useSyncExternalStoreWithSelector=function(u,h,f,p,x){var y=a(null);if(y.current===null){var v={hasValue:!1,value:null};y.current=v}else v=y.current;y=l(function(){function N(D){if(!S){if(S=!0,k=D,D=p(D),x!==void 0&&v.hasValue){var A=v.value;if(x(A,D))return T=A}return T=D}if(A=T,s(k,D))return A;var I=p(D);return x!==void 0&&x(A,I)?(k=D,A):(k=D,T=I)}var S=!1,k,T,E=f===void 0?null:f;return[function(){return N(h())},E===null?void 0:function(){return N(E())}]},[h,f,p,x]);var b=r(u,y[0],y[1]);return i(function(){v.hasValue=!0,v.value=b},[b]),c(b),b},$T}var cM;function moe(){return cM||(cM=1,AT.exports=hoe()),AT.exports}var foe=moe(),v4=j.createContext(null),poe=t=>t,xr=()=>{var t=j.useContext(v4);return t?t.store.dispatch:poe},I1=()=>{},goe=()=>I1,xoe=(t,e)=>t===e;function Gt(t){var e=j.useContext(v4);return foe.useSyncExternalStoreWithSelector(e?e.subscription.addNestedSub:goe,e?e.store.getState:I1,e?e.store.getState:I1,e?t:I1,xoe)}function yoe(t,e=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(e)}function boe(t,e=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(e)}function voe(t,e="expected all items to be functions, instead received the following types: "){if(!t.every(n=>typeof n=="function")){const n=t.map(s=>typeof s=="function"?`function ${s.name||"unnamed"}()`:typeof s).join(", ");throw new TypeError(`${e}[${n}]`)}}var uM=t=>Array.isArray(t)?t:[t];function woe(t){const e=Array.isArray(t[0])?t[0]:t;return voe(e,"createSelector expects all input-selectors to be functions, but received the following types: "),e}function Noe(t,e){const n=[],{length:s}=t;for(let r=0;r<s;r++)n.push(t[r].apply(null,e));return n}var Soe=class{constructor(t){this.value=t}deref(){return this.value}},joe=typeof WeakRef<"u"?WeakRef:Soe,koe=0,dM=1;function Gv(){return{s:koe,v:void 0,o:null,p:null}}function VU(t,e={}){let n=Gv();const{resultEqualityCheck:s}=e;let r,a=0;function i(){var f;let l=n;const{length:c}=arguments;for(let p=0,x=c;p<x;p++){const y=arguments[p];if(typeof y=="function"||typeof y=="object"&&y!==null){let v=l.o;v===null&&(l.o=v=new WeakMap);const b=v.get(y);b===void 0?(l=Gv(),v.set(y,l)):l=b}else{let v=l.p;v===null&&(l.p=v=new Map);const b=v.get(y);b===void 0?(l=Gv(),v.set(y,l)):l=b}}const u=l;let h;if(l.s===dM)h=l.v;else if(h=t.apply(null,arguments),a++,s){const p=((f=r==null?void 0:r.deref)==null?void 0:f.call(r))??r;p!=null&&s(p,h)&&(h=p,a!==0&&a--),r=typeof h=="object"&&h!==null||typeof h=="function"?new joe(h):h}return u.s=dM,u.v=h,h}return i.clearCache=()=>{n=Gv(),i.resetResultsCount()},i.resultsCount=()=>a,i.resetResultsCount=()=>{a=0},i}function Coe(t,...e){const n=typeof t=="function"?{memoize:t,memoizeOptions:e}:t,s=(...r)=>{let a=0,i=0,l,c={},u=r.pop();typeof u=="object"&&(c=u,u=r.pop()),yoe(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const h={...n,...c},{memoize:f,memoizeOptions:p=[],argsMemoize:x=VU,argsMemoizeOptions:y=[]}=h,v=uM(p),b=uM(y),N=woe(r),S=f(function(){return a++,u.apply(null,arguments)},...v),k=x(function(){i++;const E=Noe(N,arguments);return l=S.apply(null,E),l},...b);return Object.assign(k,{resultFunc:u,memoizedResultFunc:S,dependencies:N,dependencyRecomputations:()=>i,resetDependencyRecomputations:()=>{i=0},lastResult:()=>l,recomputations:()=>a,resetRecomputations:()=>{a=0},memoize:f,argsMemoize:x})};return Object.assign(s,{withTypes:()=>s}),s}var qe=Coe(VU),Toe=Object.assign((t,e=qe)=>{boe(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const n=Object.keys(t),s=n.map(a=>t[a]);return e(s,(...a)=>a.reduce((i,l,c)=>(i[n[c]]=l,i),{}))},{withTypes:()=>Toe}),OT={},DT={},PT={},hM;function _oe(){return hM||(hM=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(s){return typeof s=="symbol"?1:s===null?2:s===void 0?3:s!==s?4:0}const n=(s,r,a)=>{if(s!==r){const i=e(s),l=e(r);if(i===l&&i===0){if(s<r)return a==="desc"?1:-1;if(s>r)return a==="desc"?-1:1}return a==="desc"?l-i:i-l}return 0};t.compareValues=n})(PT)),PT}var LT={},MT={},mM;function WU(){return mM||(mM=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return typeof n=="symbol"||n instanceof Symbol}t.isSymbol=e})(MT)),MT}var fM;function Eoe(){return fM||(fM=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=WU(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,s=/^\w*$/;function r(a,i){return Array.isArray(a)?!1:typeof a=="number"||typeof a=="boolean"||a==null||e.isSymbol(a)?!0:typeof a=="string"&&(s.test(a)||!n.test(a))||i!=null&&Object.hasOwn(i,a)}t.isKey=r})(LT)),LT}var pM;function Aoe(){return pM||(pM=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=_oe(),n=Eoe(),s=l4();function r(a,i,l,c){if(a==null)return[];l=c?void 0:l,Array.isArray(a)||(a=Object.values(a)),Array.isArray(i)||(i=i==null?[null]:[i]),i.length===0&&(i=[null]),Array.isArray(l)||(l=l==null?[]:[l]),l=l.map(x=>String(x));const u=(x,y)=>{let v=x;for(let b=0;b<y.length&&v!=null;++b)v=v[y[b]];return v},h=(x,y)=>y==null||x==null?y:typeof x=="object"&&"key"in x?Object.hasOwn(y,x.key)?y[x.key]:u(y,x.path):typeof x=="function"?x(y):Array.isArray(x)?u(y,x):typeof y=="object"?y[x]:y,f=i.map(x=>(Array.isArray(x)&&x.length===1&&(x=x[0]),x==null||typeof x=="function"||Array.isArray(x)||n.isKey(x)?x:{key:x,path:s.toPath(x)}));return a.map(x=>({original:x,criteria:f.map(y=>h(y,x))})).slice().sort((x,y)=>{for(let v=0;v<f.length;v++){const b=e.compareValues(x.criteria[v],y.criteria[v],l[v]);if(b!==0)return b}return 0}).map(x=>x.original)}t.orderBy=r})(DT)),DT}var FT={},gM;function $oe(){return gM||(gM=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n,s=1){const r=[],a=Math.floor(s),i=(l,c)=>{for(let u=0;u<l.length;u++){const h=l[u];Array.isArray(h)&&c<a?i(h,c+1):r.push(h)}};return i(n,0),r}t.flatten=e})(FT)),FT}var zT={},xM;function HU(){return xM||(xM=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=BU(),n=y4(),s=DU(),r=LU();function a(i,l,c){return s.isObject(c)&&(typeof l=="number"&&n.isArrayLike(c)&&e.isIndex(l)&&l<c.length||typeof l=="string"&&l in c)?r.eq(c[l],i):!1}t.isIterateeCall=a})(zT)),zT}var yM;function Ioe(){return yM||(yM=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Aoe(),n=$oe(),s=HU();function r(a,...i){const l=i.length;return l>1&&s.isIterateeCall(a,i[0],i[1])?i=[]:l>2&&s.isIterateeCall(i[0],i[1],i[2])&&(i=[i[0]]),e.orderBy(a,n.flatten(i),["asc"])}t.sortBy=r})(OT)),OT}var BT,bM;function Roe(){return bM||(bM=1,BT=Ioe().sortBy),BT}var Ooe=Roe();const P2=Hl(Ooe);var GU=t=>t.legend.settings,Doe=t=>t.legend.size,Poe=t=>t.legend.payload,Loe=qe([Poe,GU],(t,e)=>{var{itemSorter:n}=e,s=t.flat(1);return n?P2(s,n):s});function Moe(){return Gt(Loe)}var qv=1;function qU(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[e,n]=j.useState({height:0,left:0,top:0,width:0}),s=j.useCallback(r=>{if(r!=null){var a=r.getBoundingClientRect(),i={height:a.height,left:a.left,top:a.top,width:a.width};(Math.abs(i.height-e.height)>qv||Math.abs(i.left-e.left)>qv||Math.abs(i.top-e.top)>qv||Math.abs(i.width-e.width)>qv)&&n({height:i.height,left:i.left,top:i.top,width:i.width})}},[e.width,e.height,e.top,e.left,...t]);return[e,s]}function ca(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var Foe=typeof Symbol=="function"&&Symbol.observable||"@@observable",vM=Foe,UT=()=>Math.random().toString(36).substring(7).split("").join("."),zoe={INIT:`@@redux/INIT${UT()}`,REPLACE:`@@redux/REPLACE${UT()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${UT()}`},cw=zoe;function w4(t){if(typeof t!="object"||t===null)return!1;let e=t;for(;Object.getPrototypeOf(e)!==null;)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e||Object.getPrototypeOf(t)===null}function KU(t,e,n){if(typeof t!="function")throw new Error(ca(2));if(typeof e=="function"&&typeof n=="function"||typeof n=="function"&&typeof arguments[3]=="function")throw new Error(ca(0));if(typeof e=="function"&&typeof n>"u"&&(n=e,e=void 0),typeof n<"u"){if(typeof n!="function")throw new Error(ca(1));return n(KU)(t,e)}let s=t,r=e,a=new Map,i=a,l=0,c=!1;function u(){i===a&&(i=new Map,a.forEach((b,N)=>{i.set(N,b)}))}function h(){if(c)throw new Error(ca(3));return r}function f(b){if(typeof b!="function")throw new Error(ca(4));if(c)throw new Error(ca(5));let N=!0;u();const S=l++;return i.set(S,b),function(){if(N){if(c)throw new Error(ca(6));N=!1,u(),i.delete(S),a=null}}}function p(b){if(!w4(b))throw new Error(ca(7));if(typeof b.type>"u")throw new Error(ca(8));if(typeof b.type!="string")throw new Error(ca(17));if(c)throw new Error(ca(9));try{c=!0,r=s(r,b)}finally{c=!1}return(a=i).forEach(S=>{S()}),b}function x(b){if(typeof b!="function")throw new Error(ca(10));s=b,p({type:cw.REPLACE})}function y(){const b=f;return{subscribe(N){if(typeof N!="object"||N===null)throw new Error(ca(11));function S(){const T=N;T.next&&T.next(h())}return S(),{unsubscribe:b(S)}},[vM](){return this}}}return p({type:cw.INIT}),{dispatch:p,subscribe:f,getState:h,replaceReducer:x,[vM]:y}}function Boe(t){Object.keys(t).forEach(e=>{const n=t[e];if(typeof n(void 0,{type:cw.INIT})>"u")throw new Error(ca(12));if(typeof n(void 0,{type:cw.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(ca(13))})}function XU(t){const e=Object.keys(t),n={};for(let a=0;a<e.length;a++){const i=e[a];typeof t[i]=="function"&&(n[i]=t[i])}const s=Object.keys(n);let r;try{Boe(n)}catch(a){r=a}return function(i={},l){if(r)throw r;let c=!1;const u={};for(let h=0;h<s.length;h++){const f=s[h],p=n[f],x=i[f],y=p(x,l);if(typeof y>"u")throw l&&l.type,new Error(ca(14));u[f]=y,c=c||y!==x}return c=c||s.length!==Object.keys(i).length,c?u:i}}function uw(...t){return t.length===0?e=>e:t.length===1?t[0]:t.reduce((e,n)=>(...s)=>e(n(...s)))}function Uoe(...t){return e=>(n,s)=>{const r=e(n,s);let a=()=>{throw new Error(ca(15))};const i={getState:r.getState,dispatch:(c,...u)=>a(c,...u)},l=t.map(c=>c(i));return a=uw(...l)(r.dispatch),{...r,dispatch:a}}}function YU(t){return w4(t)&&"type"in t&&typeof t.type=="string"}var QU=Symbol.for("immer-nothing"),wM=Symbol.for("immer-draftable"),Qi=Symbol.for("immer-state");function el(t,...e){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var nf=Object.getPrototypeOf;function ph(t){return!!t&&!!t[Qi]}function _c(t){var e;return t?ZU(t)||Array.isArray(t)||!!t[wM]||!!((e=t.constructor)!=null&&e[wM])||Tx(t)||M2(t):!1}var Voe=Object.prototype.constructor.toString();function ZU(t){if(!t||typeof t!="object")return!1;const e=nf(t);if(e===null)return!0;const n=Object.hasOwnProperty.call(e,"constructor")&&e.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===Voe}function dw(t,e){L2(t)===0?Reflect.ownKeys(t).forEach(n=>{e(n,t[n],t)}):t.forEach((n,s)=>e(s,n,t))}function L2(t){const e=t[Qi];return e?e.type_:Array.isArray(t)?1:Tx(t)?2:M2(t)?3:0}function l_(t,e){return L2(t)===2?t.has(e):Object.prototype.hasOwnProperty.call(t,e)}function JU(t,e,n){const s=L2(t);s===2?t.set(e,n):s===3?t.add(n):t[e]=n}function Woe(t,e){return t===e?t!==0||1/t===1/e:t!==t&&e!==e}function Tx(t){return t instanceof Map}function M2(t){return t instanceof Set}function Md(t){return t.copy_||t.base_}function c_(t,e){if(Tx(t))return new Map(t);if(M2(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);const n=ZU(t);if(e===!0||e==="class_only"&&!n){const s=Object.getOwnPropertyDescriptors(t);delete s[Qi];let r=Reflect.ownKeys(s);for(let a=0;a<r.length;a++){const i=r[a],l=s[i];l.writable===!1&&(l.writable=!0,l.configurable=!0),(l.get||l.set)&&(s[i]={configurable:!0,writable:!0,enumerable:l.enumerable,value:t[i]})}return Object.create(nf(t),s)}else{const s=nf(t);if(s!==null&&n)return{...t};const r=Object.create(s);return Object.assign(r,t)}}function N4(t,e=!1){return F2(t)||ph(t)||!_c(t)||(L2(t)>1&&Object.defineProperties(t,{set:{value:Kv},add:{value:Kv},clear:{value:Kv},delete:{value:Kv}}),Object.freeze(t),e&&Object.values(t).forEach(n=>N4(n,!0))),t}function Kv(){el(2)}function F2(t){return Object.isFrozen(t)}var Hoe={};function gh(t){const e=Hoe[t];return e||el(0,t),e}var Vg;function eV(){return Vg}function Goe(t,e){return{drafts_:[],parent_:t,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function NM(t,e){e&&(gh("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=e)}function u_(t){d_(t),t.drafts_.forEach(qoe),t.drafts_=null}function d_(t){t===Vg&&(Vg=t.parent_)}function SM(t){return Vg=Goe(Vg,t)}function qoe(t){const e=t[Qi];e.type_===0||e.type_===1?e.revoke_():e.revoked_=!0}function jM(t,e){e.unfinalizedDrafts_=e.drafts_.length;const n=e.drafts_[0];return t!==void 0&&t!==n?(n[Qi].modified_&&(u_(e),el(4)),_c(t)&&(t=hw(e,t),e.parent_||mw(e,t)),e.patches_&&gh("Patches").generateReplacementPatches_(n[Qi].base_,t,e.patches_,e.inversePatches_)):t=hw(e,n,[]),u_(e),e.patches_&&e.patchListener_(e.patches_,e.inversePatches_),t!==QU?t:void 0}function hw(t,e,n){if(F2(e))return e;const s=e[Qi];if(!s)return dw(e,(r,a)=>kM(t,s,e,r,a,n)),e;if(s.scope_!==t)return e;if(!s.modified_)return mw(t,s.base_,!0),s.base_;if(!s.finalized_){s.finalized_=!0,s.scope_.unfinalizedDrafts_--;const r=s.copy_;let a=r,i=!1;s.type_===3&&(a=new Set(r),r.clear(),i=!0),dw(a,(l,c)=>kM(t,s,r,l,c,n,i)),mw(t,r,!1),n&&t.patches_&&gh("Patches").generatePatches_(s,n,t.patches_,t.inversePatches_)}return s.copy_}function kM(t,e,n,s,r,a,i){if(ph(r)){const l=a&&e&&e.type_!==3&&!l_(e.assigned_,s)?a.concat(s):void 0,c=hw(t,r,l);if(JU(n,s,c),ph(c))t.canAutoFreeze_=!1;else return}else i&&n.add(r);if(_c(r)&&!F2(r)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;hw(t,r),(!e||!e.scope_.parent_)&&typeof s!="symbol"&&(Tx(n)?n.has(s):Object.prototype.propertyIsEnumerable.call(n,s))&&mw(t,r)}}function mw(t,e,n=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&N4(e,n)}function Koe(t,e){const n=Array.isArray(t),s={type_:n?1:0,scope_:e?e.scope_:eV(),modified_:!1,finalized_:!1,assigned_:{},parent_:e,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let r=s,a=S4;n&&(r=[s],a=Wg);const{revoke:i,proxy:l}=Proxy.revocable(r,a);return s.draft_=l,s.revoke_=i,l}var S4={get(t,e){if(e===Qi)return t;const n=Md(t);if(!l_(n,e))return Xoe(t,n,e);const s=n[e];return t.finalized_||!_c(s)?s:s===VT(t.base_,e)?(WT(t),t.copy_[e]=m_(s,t)):s},has(t,e){return e in Md(t)},ownKeys(t){return Reflect.ownKeys(Md(t))},set(t,e,n){const s=tV(Md(t),e);if(s!=null&&s.set)return s.set.call(t.draft_,n),!0;if(!t.modified_){const r=VT(Md(t),e),a=r==null?void 0:r[Qi];if(a&&a.base_===n)return t.copy_[e]=n,t.assigned_[e]=!1,!0;if(Woe(n,r)&&(n!==void 0||l_(t.base_,e)))return!0;WT(t),h_(t)}return t.copy_[e]===n&&(n!==void 0||e in t.copy_)||Number.isNaN(n)&&Number.isNaN(t.copy_[e])||(t.copy_[e]=n,t.assigned_[e]=!0),!0},deleteProperty(t,e){return VT(t.base_,e)!==void 0||e in t.base_?(t.assigned_[e]=!1,WT(t),h_(t)):delete t.assigned_[e],t.copy_&&delete t.copy_[e],!0},getOwnPropertyDescriptor(t,e){const n=Md(t),s=Reflect.getOwnPropertyDescriptor(n,e);return s&&{writable:!0,configurable:t.type_!==1||e!=="length",enumerable:s.enumerable,value:n[e]}},defineProperty(){el(11)},getPrototypeOf(t){return nf(t.base_)},setPrototypeOf(){el(12)}},Wg={};dw(S4,(t,e)=>{Wg[t]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}});Wg.deleteProperty=function(t,e){return Wg.set.call(this,t,e,void 0)};Wg.set=function(t,e,n){return S4.set.call(this,t[0],e,n,t[0])};function VT(t,e){const n=t[Qi];return(n?Md(n):t)[e]}function Xoe(t,e,n){var r;const s=tV(e,n);return s?"value"in s?s.value:(r=s.get)==null?void 0:r.call(t.draft_):void 0}function tV(t,e){if(!(e in t))return;let n=nf(t);for(;n;){const s=Object.getOwnPropertyDescriptor(n,e);if(s)return s;n=nf(n)}}function h_(t){t.modified_||(t.modified_=!0,t.parent_&&h_(t.parent_))}function WT(t){t.copy_||(t.copy_=c_(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var Yoe=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,n,s)=>{if(typeof e=="function"&&typeof n!="function"){const a=n;n=e;const i=this;return function(c=a,...u){return i.produce(c,h=>n.call(this,h,...u))}}typeof n!="function"&&el(6),s!==void 0&&typeof s!="function"&&el(7);let r;if(_c(e)){const a=SM(this),i=m_(e,void 0);let l=!0;try{r=n(i),l=!1}finally{l?u_(a):d_(a)}return NM(a,s),jM(r,a)}else if(!e||typeof e!="object"){if(r=n(e),r===void 0&&(r=e),r===QU&&(r=void 0),this.autoFreeze_&&N4(r,!0),s){const a=[],i=[];gh("Patches").generateReplacementPatches_(e,r,a,i),s(a,i)}return r}else el(1,e)},this.produceWithPatches=(e,n)=>{if(typeof e=="function")return(i,...l)=>this.produceWithPatches(i,c=>e(c,...l));let s,r;return[this.produce(e,n,(i,l)=>{s=i,r=l}),s,r]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){_c(t)||el(8),ph(t)&&(t=jc(t));const e=SM(this),n=m_(t,void 0);return n[Qi].isManual_=!0,d_(e),n}finishDraft(t,e){const n=t&&t[Qi];(!n||!n.isManual_)&&el(9);const{scope_:s}=n;return NM(s,e),jM(void 0,s)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,e){let n;for(n=e.length-1;n>=0;n--){const r=e[n];if(r.path.length===0&&r.op==="replace"){t=r.value;break}}n>-1&&(e=e.slice(n+1));const s=gh("Patches").applyPatches_;return ph(t)?s(t,e):this.produce(t,r=>s(r,e))}};function m_(t,e){const n=Tx(t)?gh("MapSet").proxyMap_(t,e):M2(t)?gh("MapSet").proxySet_(t,e):Koe(t,e);return(e?e.scope_:eV()).drafts_.push(n),n}function jc(t){return ph(t)||el(10,t),nV(t)}function nV(t){if(!_c(t)||F2(t))return t;const e=t[Qi];let n;if(e){if(!e.modified_)return e.base_;e.finalized_=!0,n=c_(t,e.scope_.immer_.useStrictShallowCopy_)}else n=c_(t,!0);return dw(n,(s,r)=>{JU(n,s,nV(r))}),e&&(e.finalized_=!1),n}var Qoe=new Yoe,sV=Qoe.produce;function rV(t){return({dispatch:n,getState:s})=>r=>a=>typeof a=="function"?a(n,s,t):r(a)}var Zoe=rV(),Joe=rV,ele=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?uw:uw.apply(null,arguments)};function Ao(t,e){function n(...s){if(e){let r=e(...s);if(!r)throw new Error(Gi(0));return{type:t,payload:r.payload,..."meta"in r&&{meta:r.meta},..."error"in r&&{error:r.error}}}return{type:t,payload:s[0]}}return n.toString=()=>`${t}`,n.type=t,n.match=s=>YU(s)&&s.type===t,n}var aV=class xg extends Array{constructor(...e){super(...e),Object.setPrototypeOf(this,xg.prototype)}static get[Symbol.species](){return xg}concat(...e){return super.concat.apply(this,e)}prepend(...e){return e.length===1&&Array.isArray(e[0])?new xg(...e[0].concat(this)):new xg(...e.concat(this))}};function CM(t){return _c(t)?sV(t,()=>{}):t}function Xv(t,e,n){return t.has(e)?t.get(e):t.set(e,n(e)).get(e)}function tle(t){return typeof t=="boolean"}var nle=()=>function(e){const{thunk:n=!0,immutableCheck:s=!0,serializableCheck:r=!0,actionCreatorCheck:a=!0}=e??{};let i=new aV;return n&&(tle(n)?i.push(Zoe):i.push(Joe(n.extraArgument))),i},sle="RTK_autoBatch",TM=t=>e=>{setTimeout(e,t)},rle=(t={type:"raf"})=>e=>(...n)=>{const s=e(...n);let r=!0,a=!1,i=!1;const l=new Set,c=t.type==="tick"?queueMicrotask:t.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:TM(10):t.type==="callback"?t.queueNotification:TM(t.timeout),u=()=>{i=!1,a&&(a=!1,l.forEach(h=>h()))};return Object.assign({},s,{subscribe(h){const f=()=>r&&h(),p=s.subscribe(f);return l.add(h),()=>{p(),l.delete(h)}},dispatch(h){var f;try{return r=!((f=h==null?void 0:h.meta)!=null&&f[sle]),a=!r,a&&(i||(i=!0,c(u))),s.dispatch(h)}finally{r=!0}}})},ale=t=>function(n){const{autoBatch:s=!0}=n??{};let r=new aV(t);return s&&r.push(rle(typeof s=="object"?s:void 0)),r};function ile(t){const e=nle(),{reducer:n=void 0,middleware:s,devTools:r=!0,preloadedState:a=void 0,enhancers:i=void 0}=t||{};let l;if(typeof n=="function")l=n;else if(w4(n))l=XU(n);else throw new Error(Gi(1));let c;typeof s=="function"?c=s(e):c=e();let u=uw;r&&(u=ele({trace:!1,...typeof r=="object"&&r}));const h=Uoe(...c),f=ale(h);let p=typeof i=="function"?i(f):f();const x=u(...p);return KU(l,a,x)}function iV(t){const e={},n=[];let s;const r={addCase(a,i){const l=typeof a=="string"?a:a.type;if(!l)throw new Error(Gi(28));if(l in e)throw new Error(Gi(29));return e[l]=i,r},addAsyncThunk(a,i){return i.pending&&(e[a.pending.type]=i.pending),i.rejected&&(e[a.rejected.type]=i.rejected),i.fulfilled&&(e[a.fulfilled.type]=i.fulfilled),i.settled&&n.push({matcher:a.settled,reducer:i.settled}),r},addMatcher(a,i){return n.push({matcher:a,reducer:i}),r},addDefaultCase(a){return s=a,r}};return t(r),[e,n,s]}function ole(t){return typeof t=="function"}function lle(t,e){let[n,s,r]=iV(e),a;if(ole(t))a=()=>CM(t());else{const l=CM(t);a=()=>l}function i(l=a(),c){let u=[n[c.type],...s.filter(({matcher:h})=>h(c)).map(({reducer:h})=>h)];return u.filter(h=>!!h).length===0&&(u=[r]),u.reduce((h,f)=>{if(f)if(ph(h)){const x=f(h,c);return x===void 0?h:x}else{if(_c(h))return sV(h,p=>f(p,c));{const p=f(h,c);if(p===void 0){if(h===null)return h;throw Error("A case reducer on a non-draftable value must not return undefined")}return p}}return h},l)}return i.getInitialState=a,i}var cle="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",ule=(t=21)=>{let e="",n=t;for(;n--;)e+=cle[Math.random()*64|0];return e},dle=Symbol.for("rtk-slice-createasyncthunk");function hle(t,e){return`${t}/${e}`}function mle({creators:t}={}){var n;const e=(n=t==null?void 0:t.asyncThunk)==null?void 0:n[dle];return function(r){const{name:a,reducerPath:i=a}=r;if(!a)throw new Error(Gi(11));const l=(typeof r.reducers=="function"?r.reducers(ple()):r.reducers)||{},c=Object.keys(l),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},h={addCase(T,E){const D=typeof T=="string"?T:T.type;if(!D)throw new Error(Gi(12));if(D in u.sliceCaseReducersByType)throw new Error(Gi(13));return u.sliceCaseReducersByType[D]=E,h},addMatcher(T,E){return u.sliceMatchers.push({matcher:T,reducer:E}),h},exposeAction(T,E){return u.actionCreators[T]=E,h},exposeCaseReducer(T,E){return u.sliceCaseReducersByName[T]=E,h}};c.forEach(T=>{const E=l[T],D={reducerName:T,type:hle(a,T),createNotation:typeof r.reducers=="function"};xle(E)?ble(D,E,h,e):gle(D,E,h)});function f(){const[T={},E=[],D=void 0]=typeof r.extraReducers=="function"?iV(r.extraReducers):[r.extraReducers],A={...T,...u.sliceCaseReducersByType};return lle(r.initialState,I=>{for(let P in A)I.addCase(P,A[P]);for(let P of u.sliceMatchers)I.addMatcher(P.matcher,P.reducer);for(let P of E)I.addMatcher(P.matcher,P.reducer);D&&I.addDefaultCase(D)})}const p=T=>T,x=new Map,y=new WeakMap;let v;function b(T,E){return v||(v=f()),v(T,E)}function N(){return v||(v=f()),v.getInitialState()}function S(T,E=!1){function D(I){let P=I[T];return typeof P>"u"&&E&&(P=Xv(y,D,N)),P}function A(I=p){const P=Xv(x,E,()=>new WeakMap);return Xv(P,I,()=>{const $={};for(const[R,F]of Object.entries(r.selectors??{}))$[R]=fle(F,I,()=>Xv(y,I,N),E);return $})}return{reducerPath:T,getSelectors:A,get selectors(){return A(D)},selectSlice:D}}const k={name:a,reducer:b,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:N,...S(i),injectInto(T,{reducerPath:E,...D}={}){const A=E??i;return T.inject({reducerPath:A,reducer:b},D),{...k,...S(A,!0)}}};return k}}function fle(t,e,n,s){function r(a,...i){let l=e(a);return typeof l>"u"&&s&&(l=n()),t(l,...i)}return r.unwrapped=t,r}var no=mle();function ple(){function t(e,n){return{_reducerDefinitionType:"asyncThunk",payloadCreator:e,...n}}return t.withTypes=()=>t,{reducer(e){return Object.assign({[e.name](...n){return e(...n)}}[e.name],{_reducerDefinitionType:"reducer"})},preparedReducer(e,n){return{_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:n}},asyncThunk:t}}function gle({type:t,reducerName:e,createNotation:n},s,r){let a,i;if("reducer"in s){if(n&&!yle(s))throw new Error(Gi(17));a=s.reducer,i=s.prepare}else a=s;r.addCase(t,a).exposeCaseReducer(e,a).exposeAction(e,i?Ao(t,i):Ao(t))}function xle(t){return t._reducerDefinitionType==="asyncThunk"}function yle(t){return t._reducerDefinitionType==="reducerWithPrepare"}function ble({type:t,reducerName:e},n,s,r){if(!r)throw new Error(Gi(18));const{payloadCreator:a,fulfilled:i,pending:l,rejected:c,settled:u,options:h}=n,f=r(t,a,h);s.exposeAction(e,f),i&&s.addCase(f.fulfilled,i),l&&s.addCase(f.pending,l),c&&s.addCase(f.rejected,c),u&&s.addMatcher(f.settled,u),s.exposeCaseReducer(e,{fulfilled:i||Yv,pending:l||Yv,rejected:c||Yv,settled:u||Yv})}function Yv(){}var vle="task",oV="listener",lV="completed",j4="cancelled",wle=`task-${j4}`,Nle=`task-${lV}`,f_=`${oV}-${j4}`,Sle=`${oV}-${lV}`,z2=class{constructor(t){$C(this,"name","TaskAbortError");$C(this,"message");this.code=t,this.message=`${vle} ${j4} (reason: ${t})`}},k4=(t,e)=>{if(typeof t!="function")throw new TypeError(Gi(32))},fw=()=>{},cV=(t,e=fw)=>(t.catch(e),t),uV=(t,e)=>(t.addEventListener("abort",e,{once:!0}),()=>t.removeEventListener("abort",e)),sh=(t,e)=>{const n=t.signal;n.aborted||("reason"in n||Object.defineProperty(n,"reason",{enumerable:!0,value:e,configurable:!0,writable:!0}),t.abort(e))},rh=t=>{if(t.aborted){const{reason:e}=t;throw new z2(e)}};function dV(t,e){let n=fw;return new Promise((s,r)=>{const a=()=>r(new z2(t.reason));if(t.aborted){a();return}n=uV(t,a),e.finally(()=>n()).then(s,r)}).finally(()=>{n=fw})}var jle=async(t,e)=>{try{return await Promise.resolve(),{status:"ok",value:await t()}}catch(n){return{status:n instanceof z2?"cancelled":"rejected",error:n}}finally{e==null||e()}},pw=t=>e=>cV(dV(t,e).then(n=>(rh(t),n))),hV=t=>{const e=pw(t);return n=>e(new Promise(s=>setTimeout(s,n)))},{assign:qm}=Object,_M={},B2="listenerMiddleware",kle=(t,e)=>{const n=s=>uV(t,()=>sh(s,t.reason));return(s,r)=>{k4(s);const a=new AbortController;n(a);const i=jle(async()=>{rh(t),rh(a.signal);const l=await s({pause:pw(a.signal),delay:hV(a.signal),signal:a.signal});return rh(a.signal),l},()=>sh(a,Nle));return r!=null&&r.autoJoin&&e.push(i.catch(fw)),{result:pw(t)(i),cancel(){sh(a,wle)}}}},Cle=(t,e)=>{const n=async(s,r)=>{rh(e);let a=()=>{};const l=[new Promise((c,u)=>{let h=t({predicate:s,effect:(f,p)=>{p.unsubscribe(),c([f,p.getState(),p.getOriginalState()])}});a=()=>{h(),u()}})];r!=null&&l.push(new Promise(c=>setTimeout(c,r,null)));try{const c=await dV(e,Promise.race(l));return rh(e),c}finally{a()}};return(s,r)=>cV(n(s,r))},mV=t=>{let{type:e,actionCreator:n,matcher:s,predicate:r,effect:a}=t;if(e)r=Ao(e).match;else if(n)e=n.type,r=n.match;else if(s)r=s;else if(!r)throw new Error(Gi(21));return k4(a),{predicate:r,type:e,effect:a}},fV=qm(t=>{const{type:e,predicate:n,effect:s}=mV(t);return{id:ule(),effect:s,type:e,predicate:n,pending:new Set,unsubscribe:()=>{throw new Error(Gi(22))}}},{withTypes:()=>fV}),EM=(t,e)=>{const{type:n,effect:s,predicate:r}=mV(e);return Array.from(t.values()).find(a=>(typeof n=="string"?a.type===n:a.predicate===r)&&a.effect===s)},p_=t=>{t.pending.forEach(e=>{sh(e,f_)})},Tle=t=>()=>{t.forEach(p_),t.clear()},AM=(t,e,n)=>{try{t(e,n)}catch(s){setTimeout(()=>{throw s},0)}},pV=qm(Ao(`${B2}/add`),{withTypes:()=>pV}),_le=Ao(`${B2}/removeAll`),gV=qm(Ao(`${B2}/remove`),{withTypes:()=>gV}),Ele=(...t)=>{console.error(`${B2}/error`,...t)},_x=(t={})=>{const e=new Map,{extra:n,onError:s=Ele}=t;k4(s);const r=h=>(h.unsubscribe=()=>e.delete(h.id),e.set(h.id,h),f=>{h.unsubscribe(),f!=null&&f.cancelActive&&p_(h)}),a=h=>{const f=EM(e,h)??fV(h);return r(f)};qm(a,{withTypes:()=>a});const i=h=>{const f=EM(e,h);return f&&(f.unsubscribe(),h.cancelActive&&p_(f)),!!f};qm(i,{withTypes:()=>i});const l=async(h,f,p,x)=>{const y=new AbortController,v=Cle(a,y.signal),b=[];try{h.pending.add(y),await Promise.resolve(h.effect(f,qm({},p,{getOriginalState:x,condition:(N,S)=>v(N,S).then(Boolean),take:v,delay:hV(y.signal),pause:pw(y.signal),extra:n,signal:y.signal,fork:kle(y.signal,b),unsubscribe:h.unsubscribe,subscribe:()=>{e.set(h.id,h)},cancelActiveListeners:()=>{h.pending.forEach((N,S,k)=>{N!==y&&(sh(N,f_),k.delete(N))})},cancel:()=>{sh(y,f_),h.pending.delete(y)},throwIfCancelled:()=>{rh(y.signal)}})))}catch(N){N instanceof z2||AM(s,N,{raisedBy:"effect"})}finally{await Promise.all(b),sh(y,Sle),h.pending.delete(y)}},c=Tle(e);return{middleware:h=>f=>p=>{if(!YU(p))return f(p);if(pV.match(p))return a(p.payload);if(_le.match(p)){c();return}if(gV.match(p))return i(p.payload);let x=h.getState();const y=()=>{if(x===_M)throw new Error(Gi(23));return x};let v;try{if(v=f(p),e.size>0){const b=h.getState(),N=Array.from(e.values());for(const S of N){let k=!1;try{k=S.predicate(p,b,x)}catch(T){k=!1,AM(s,T,{raisedBy:"predicate"})}k&&l(S,p,h,y)}}}finally{x=_M}return v},startListening:a,stopListening:i,clearListeners:c}};function Gi(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var Ale={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},xV=no({name:"chartLayout",initialState:Ale,reducers:{setLayout(t,e){t.layoutType=e.payload},setChartSize(t,e){t.width=e.payload.width,t.height=e.payload.height},setMargin(t,e){var n,s,r,a;t.margin.top=(n=e.payload.top)!==null&&n!==void 0?n:0,t.margin.right=(s=e.payload.right)!==null&&s!==void 0?s:0,t.margin.bottom=(r=e.payload.bottom)!==null&&r!==void 0?r:0,t.margin.left=(a=e.payload.left)!==null&&a!==void 0?a:0},setScale(t,e){t.scale=e.payload}}}),{setMargin:$le,setLayout:Ile,setChartSize:Rle,setScale:Ole}=xV.actions,Dle=xV.reducer;function $M(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function IM(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?$M(Object(n),!0).forEach(function(s){Ple(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$M(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function Ple(t,e,n){return(e=Lle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lle(t){var e=Mle(t,"string");return typeof e=="symbol"?e:e+""}function Mle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var gw=Math.PI/180,Fle=t=>t*180/Math.PI,da=(t,e,n,s)=>({x:t+Math.cos(-gw*s)*n,y:e+Math.sin(-gw*s)*n}),zle=function(e,n){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0};return Math.min(Math.abs(e-(s.left||0)-(s.right||0)),Math.abs(n-(s.top||0)-(s.bottom||0)))/2},Ble=(t,e)=>{var{x:n,y:s}=t,{x:r,y:a}=e;return Math.sqrt((n-r)**2+(s-a)**2)},Ule=(t,e)=>{var{x:n,y:s}=t,{cx:r,cy:a}=e,i=Ble({x:n,y:s},{x:r,y:a});if(i<=0)return{radius:i,angle:0};var l=(n-r)/i,c=Math.acos(l);return s>a&&(c=2*Math.PI-c),{radius:i,angle:Fle(c),angleInRadian:c}},Vle=t=>{var{startAngle:e,endAngle:n}=t,s=Math.floor(e/360),r=Math.floor(n/360),a=Math.min(s,r);return{startAngle:e-a*360,endAngle:n-a*360}},Wle=(t,e)=>{var{startAngle:n,endAngle:s}=e,r=Math.floor(n/360),a=Math.floor(s/360),i=Math.min(r,a);return t+i*360},Hle=(t,e)=>{var{x:n,y:s}=t,{radius:r,angle:a}=Ule({x:n,y:s},e),{innerRadius:i,outerRadius:l}=e;if(r<i||r>l||r===0)return null;var{startAngle:c,endAngle:u}=Vle(e),h=a,f;if(c<=u){for(;h>u;)h-=360;for(;h<c;)h+=360;f=h>=c&&h<=u}else{for(;h>c;)h-=360;for(;h<u;)h+=360;f=h>=u&&h<=c}return f?IM(IM({},e),{},{radius:r,angle:Wle(h,e)}):null};function yV(t,e,n){return Array.isArray(t)&&t&&e+n!==0?t.slice(e,n+1):t}function RM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function Co(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?RM(Object(n),!0).forEach(function(s){Gle(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):RM(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function Gle(t,e,n){return(e=qle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qle(t){var e=Kle(t,"string");return typeof e=="symbol"?e:e+""}function Kle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ba(t,e,n){return Hr(t)||Hr(e)?n:Ml(e)?ef(t,e,n):typeof e=="function"?e(t):n}var Xle=(t,e,n,s,r)=>{var a,i=-1,l=(a=e==null?void 0:e.length)!==null&&a!==void 0?a:0;if(l<=1||t==null)return 0;if(s==="angleAxis"&&r!=null&&Math.abs(Math.abs(r[1]-r[0])-360)<=1e-6)for(var c=0;c<l;c++){var u=c>0?n[c-1].coordinate:n[l-1].coordinate,h=n[c].coordinate,f=c>=l-1?n[0].coordinate:n[c+1].coordinate,p=void 0;if(di(h-u)!==di(f-h)){var x=[];if(di(f-h)===di(r[1]-r[0])){p=f;var y=h+r[1]-r[0];x[0]=Math.min(y,(y+u)/2),x[1]=Math.max(y,(y+u)/2)}else{p=u;var v=f+r[1]-r[0];x[0]=Math.min(h,(v+h)/2),x[1]=Math.max(h,(v+h)/2)}var b=[Math.min(h,(p+h)/2),Math.max(h,(p+h)/2)];if(t>b[0]&&t<=b[1]||t>=x[0]&&t<=x[1]){({index:i}=n[c]);break}}else{var N=Math.min(u,f),S=Math.max(u,f);if(t>(N+h)/2&&t<=(S+h)/2){({index:i}=n[c]);break}}}else if(e){for(var k=0;k<l;k++)if(k===0&&t<=(e[k].coordinate+e[k+1].coordinate)/2||k>0&&k<l-1&&t>(e[k].coordinate+e[k-1].coordinate)/2&&t<=(e[k].coordinate+e[k+1].coordinate)/2||k===l-1&&t>(e[k].coordinate+e[k-1].coordinate)/2){({index:i}=e[k]);break}}return i},Yle=(t,e,n)=>{if(e&&n){var{width:s,height:r}=n,{align:a,verticalAlign:i,layout:l}=e;if((l==="vertical"||l==="horizontal"&&i==="middle")&&a!=="center"&&qt(t[a]))return Co(Co({},t),{},{[a]:t[a]+(s||0)});if((l==="horizontal"||l==="vertical"&&a==="center")&&i!=="middle"&&qt(t[i]))return Co(Co({},t),{},{[i]:t[i]+(r||0)})}return t},Fh=(t,e)=>t==="horizontal"&&e==="xAxis"||t==="vertical"&&e==="yAxis"||t==="centric"&&e==="angleAxis"||t==="radial"&&e==="radiusAxis",bV=(t,e,n,s)=>{if(s)return t.map(l=>l.coordinate);var r,a,i=t.map(l=>(l.coordinate===e&&(r=!0),l.coordinate===n&&(a=!0),l.coordinate));return r||i.push(e),a||i.push(n),i},vV=(t,e,n)=>{if(!t)return null;var{duplicateDomain:s,type:r,range:a,scale:i,realScaleType:l,isCategorical:c,categoricalDomain:u,tickCount:h,ticks:f,niceTicks:p,axisType:x}=t;if(!i)return null;var y=l==="scaleBand"&&i.bandwidth?i.bandwidth()/2:2,v=r==="category"&&i.bandwidth?i.bandwidth()/y:0;if(v=x==="angleAxis"&&a&&a.length>=2?di(a[0]-a[1])*2*v:v,f||p){var b=(f||p||[]).map((N,S)=>{var k=s?s.indexOf(N):N;return{coordinate:i(k)+v,value:N,offset:v,index:S}});return b.filter(N=>!Yi(N.coordinate))}return c&&u?u.map((N,S)=>({coordinate:i(N)+v,value:N,index:S,offset:v})):i.ticks&&h!=null?i.ticks(h).map((N,S)=>({coordinate:i(N)+v,value:N,offset:v,index:S})):i.domain().map((N,S)=>({coordinate:i(N)+v,value:s?s[N]:N,index:S,offset:v}))},OM=1e-4,Qle=t=>{var e=t.domain();if(!(!e||e.length<=2)){var n=e.length,s=t.range(),r=Math.min(s[0],s[1])-OM,a=Math.max(s[0],s[1])+OM,i=t(e[0]),l=t(e[n-1]);(i<r||i>a||l<r||l>a)&&t.domain([e[0],e[n-1]])}},Zle=(t,e)=>{if(!e||e.length!==2||!qt(e[0])||!qt(e[1]))return t;var n=Math.min(e[0],e[1]),s=Math.max(e[0],e[1]),r=[t[0],t[1]];return(!qt(t[0])||t[0]<n)&&(r[0]=n),(!qt(t[1])||t[1]>s)&&(r[1]=s),r[0]>s&&(r[0]=s),r[1]<n&&(r[1]=n),r},Jle=t=>{var e=t.length;if(!(e<=0))for(var n=0,s=t[0].length;n<s;++n)for(var r=0,a=0,i=0;i<e;++i){var l=Yi(t[i][n][1])?t[i][n][0]:t[i][n][1];l>=0?(t[i][n][0]=r,t[i][n][1]=r+l,r=t[i][n][1]):(t[i][n][0]=a,t[i][n][1]=a+l,a=t[i][n][1])}},ece=t=>{var e=t.length;if(!(e<=0))for(var n=0,s=t[0].length;n<s;++n)for(var r=0,a=0;a<e;++a){var i=Yi(t[a][n][1])?t[a][n][0]:t[a][n][1];i>=0?(t[a][n][0]=r,t[a][n][1]=r+i,r=t[a][n][1]):(t[a][n][0]=0,t[a][n][1]=0)}},tce={sign:Jle,expand:Eie,none:tf,silhouette:Aie,wiggle:$ie,positive:ece},nce=(t,e,n)=>{var s=tce[n],r=_ie().keys(e).value((a,i)=>+Ba(a,i,0)).order(a_).offset(s);return r(t)};function sce(t){return t==null?void 0:String(t)}var DM=t=>{var{axis:e,ticks:n,offset:s,bandSize:r,entry:a,index:i}=t;if(e.type==="category")return n[i]?n[i].coordinate+s:null;var l=Ba(a,e.dataKey,e.scale.domain()[i]);return Hr(l)?null:e.scale(l)-r/2+s},rce=t=>{var{numericAxis:e}=t,n=e.scale.domain();if(e.type==="number"){var s=Math.min(n[0],n[1]),r=Math.max(n[0],n[1]);return s<=0&&r>=0?0:r<0?r:s}return n[0]},ace=t=>{var e=t.flat(2).filter(qt);return[Math.min(...e),Math.max(...e)]},ice=t=>[t[0]===1/0?0:t[0],t[1]===-1/0?0:t[1]],oce=(t,e,n)=>{if(t!=null)return ice(Object.keys(t).reduce((s,r)=>{var a=t[r],{stackedData:i}=a,l=i.reduce((c,u)=>{var h=yV(u,e,n),f=ace(h);return[Math.min(c[0],f[0]),Math.max(c[1],f[1])]},[1/0,-1/0]);return[Math.min(l[0],s[0]),Math.max(l[1],s[1])]},[1/0,-1/0]))},PM=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,LM=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,C4=(t,e,n)=>{if(t&&t.scale&&t.scale.bandwidth){var s=t.scale.bandwidth();if(!n||s>0)return s}if(t&&e&&e.length>=2){for(var r=P2(e,h=>h.coordinate),a=1/0,i=1,l=r.length;i<l;i++){var c=r[i],u=r[i-1];a=Math.min((c.coordinate||0)-(u.coordinate||0),a)}return a===1/0?0:a}return n?void 0:0};function MM(t){var{tooltipEntrySettings:e,dataKey:n,payload:s,value:r,name:a}=t;return Co(Co({},e),{},{dataKey:n,payload:s,value:r,name:a})}function wV(t,e){if(t)return String(t);if(typeof e=="string")return e}function lce(t,e,n,s,r){if(n==="horizontal"||n==="vertical"){var a=t>=r.left&&t<=r.left+r.width&&e>=r.top&&e<=r.top+r.height;return a?{x:t,y:e}:null}return s?Hle({x:t,y:e},s):null}var cce=(t,e,n,s)=>{var r=e.find(u=>u&&u.index===n);if(r){if(t==="horizontal")return{x:r.coordinate,y:s.y};if(t==="vertical")return{x:s.x,y:r.coordinate};if(t==="centric"){var a=r.coordinate,{radius:i}=s;return Co(Co(Co({},s),da(s.cx,s.cy,i,a)),{},{angle:a,radius:i})}var l=r.coordinate,{angle:c}=s;return Co(Co(Co({},s),da(s.cx,s.cy,l,c)),{},{angle:c,radius:l})}return{x:0,y:0}},uce=(t,e)=>e==="horizontal"?t.x:e==="vertical"?t.y:e==="centric"?t.angle:t.radius,Uc=t=>t.layout.width,Vc=t=>t.layout.height,dce=t=>t.layout.scale,NV=t=>t.layout.margin,U2=qe(t=>t.cartesianAxis.xAxis,t=>Object.values(t)),V2=qe(t=>t.cartesianAxis.yAxis,t=>Object.values(t)),hce="data-recharts-item-index",mce="data-recharts-item-data-key",Ex=60;function FM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function Qv(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?FM(Object(n),!0).forEach(function(s){fce(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):FM(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function fce(t,e,n){return(e=pce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pce(t){var e=gce(t,"string");return typeof e=="symbol"?e:e+""}function gce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var xce=t=>t.brush.height;function yce(t){var e=V2(t);return e.reduce((n,s)=>{if(s.orientation==="left"&&!s.mirror&&!s.hide){var r=typeof s.width=="number"?s.width:Ex;return n+r}return n},0)}function bce(t){var e=V2(t);return e.reduce((n,s)=>{if(s.orientation==="right"&&!s.mirror&&!s.hide){var r=typeof s.width=="number"?s.width:Ex;return n+r}return n},0)}function vce(t){var e=U2(t);return e.reduce((n,s)=>s.orientation==="top"&&!s.mirror&&!s.hide?n+s.height:n,0)}function wce(t){var e=U2(t);return e.reduce((n,s)=>s.orientation==="bottom"&&!s.mirror&&!s.hide?n+s.height:n,0)}var Kr=qe([Uc,Vc,NV,xce,yce,bce,vce,wce,GU,Doe],(t,e,n,s,r,a,i,l,c,u)=>{var h={left:(n.left||0)+r,right:(n.right||0)+a},f={top:(n.top||0)+i,bottom:(n.bottom||0)+l},p=Qv(Qv({},f),h),x=p.bottom;p.bottom+=s,p=Yle(p,c,u);var y=t-p.left-p.right,v=e-p.top-p.bottom;return Qv(Qv({brushBottom:x},p),{},{width:Math.max(y,0),height:Math.max(v,0)})}),Nce=qe(Kr,t=>({x:t.left,y:t.top,width:t.width,height:t.height})),T4=qe(Uc,Vc,(t,e)=>({x:0,y:0,width:t,height:e})),Sce=j.createContext(null),Ro=()=>j.useContext(Sce)!=null,W2=t=>t.brush,H2=qe([W2,Kr,NV],(t,e,n)=>({height:t.height,x:qt(t.x)?t.x:e.left,y:qt(t.y)?t.y:e.top+e.height+e.brushBottom-((n==null?void 0:n.bottom)||0),width:qt(t.width)?t.width:e.width})),_4=()=>{var t,e=Ro(),n=Gt(Nce),s=Gt(H2),r=(t=Gt(W2))===null||t===void 0?void 0:t.padding;return!e||!s||!r?n:{width:s.width-r.left-r.right,height:s.height-r.top-r.bottom,x:r.left,y:r.top}},jce={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},SV=()=>{var t;return(t=Gt(Kr))!==null&&t!==void 0?t:jce},E4=()=>Gt(Uc),A4=()=>Gt(Vc),kce=()=>Gt(t=>t.layout.margin),ts=t=>t.layout.layoutType,$4=()=>Gt(ts),Cce={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},jV=no({name:"legend",initialState:Cce,reducers:{setLegendSize(t,e){t.size.width=e.payload.width,t.size.height=e.payload.height},setLegendSettings(t,e){t.settings.align=e.payload.align,t.settings.layout=e.payload.layout,t.settings.verticalAlign=e.payload.verticalAlign,t.settings.itemSorter=e.payload.itemSorter},addLegendPayload(t,e){t.payload.push(e.payload)},removeLegendPayload(t,e){var n=jc(t).payload.indexOf(e.payload);n>-1&&t.payload.splice(n,1)}}}),{setLegendSize:zM,setLegendSettings:Tce,addLegendPayload:_ce,removeLegendPayload:Ece}=jV.actions,Ace=jV.reducer,$ce=["contextPayload"];function g_(){return g_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},g_.apply(null,arguments)}function BM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function sf(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?BM(Object(n),!0).forEach(function(s){I4(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):BM(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function I4(t,e,n){return(e=Ice(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ice(t){var e=Rce(t,"string");return typeof e=="symbol"?e:e+""}function Rce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Oce(t,e){if(t==null)return{};var n,s,r=Dce(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(s=0;s<a.length;s++)n=a[s],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Dce(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)!==-1)continue;n[s]=t[s]}return n}function Pce(t){return t.value}function Lce(t){var{contextPayload:e}=t,n=Oce(t,$ce),s=UU(e,t.payloadUniqBy,Pce),r=sf(sf({},n),{},{payload:s});return j.isValidElement(t.content)?j.cloneElement(t.content,r):typeof t.content=="function"?j.createElement(t.content,r):j.createElement(x4,r)}function Mce(t,e,n,s,r,a){var{layout:i,align:l,verticalAlign:c}=e,u,h;return(!t||(t.left===void 0||t.left===null)&&(t.right===void 0||t.right===null))&&(l==="center"&&i==="vertical"?u={left:((s||0)-a.width)/2}:u=l==="right"?{right:n&&n.right||0}:{left:n&&n.left||0}),(!t||(t.top===void 0||t.top===null)&&(t.bottom===void 0||t.bottom===null))&&(c==="middle"?h={top:((r||0)-a.height)/2}:h=c==="bottom"?{bottom:n&&n.bottom||0}:{top:n&&n.top||0}),sf(sf({},u),h)}function Fce(t){var e=xr();return j.useEffect(()=>{e(Tce(t))},[e,t]),null}function zce(t){var e=xr();return j.useEffect(()=>(e(zM(t)),()=>{e(zM({width:0,height:0}))}),[e,t]),null}function Bce(t){var e=Moe(),n=Zae(),s=kce(),{width:r,height:a,wrapperStyle:i,portal:l}=t,[c,u]=qU([e]),h=E4(),f=A4();if(h==null||f==null)return null;var p=h-(s.left||0)-(s.right||0),x=Ax.getWidthOrHeight(t.layout,a,r,p),y=l?i:sf(sf({position:"absolute",width:(x==null?void 0:x.width)||r||"auto",height:(x==null?void 0:x.height)||a||"auto"},Mce(i,t,s,h,f,c)),i),v=l??n;if(v==null)return null;var b=j.createElement("div",{className:"recharts-legend-wrapper",style:y,ref:u},j.createElement(Fce,{layout:t.layout,align:t.align,verticalAlign:t.verticalAlign,itemSorter:t.itemSorter}),j.createElement(zce,{width:c.width,height:c.height}),j.createElement(Lce,g_({},t,x,{margin:s,chartWidth:h,chartHeight:f,contextPayload:e})));return T7.createPortal(b,v)}class Ax extends j.PureComponent{static getWidthOrHeight(e,n,s,r){return e==="vertical"&&qt(n)?{height:n}:e==="horizontal"?{width:s||r}:null}render(){return j.createElement(Bce,this.props)}}I4(Ax,"displayName","Legend");I4(Ax,"defaultProps",{align:"center",iconSize:14,itemSorter:"value",layout:"horizontal",verticalAlign:"bottom"});function x_(){return x_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},x_.apply(null,arguments)}function UM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function HT(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?UM(Object(n),!0).forEach(function(s){Uce(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):UM(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function Uce(t,e,n){return(e=Vce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vce(t){var e=Wce(t,"string");return typeof e=="symbol"?e:e+""}function Wce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hce(t){return Array.isArray(t)&&Ml(t[0])&&Ml(t[1])?t.join(" ~ "):t}var Gce=t=>{var{separator:e=" : ",contentStyle:n={},itemStyle:s={},labelStyle:r={},payload:a,formatter:i,itemSorter:l,wrapperClassName:c,labelClassName:u,label:h,labelFormatter:f,accessibilityLayer:p=!1}=t,x=()=>{if(a&&a.length){var E={padding:0,margin:0},D=(l?P2(a,l):a).map((A,I)=>{if(A.type==="none")return null;var P=A.formatter||i||Hce,{value:$,name:R}=A,F=$,W=R;if(P){var q=P($,R,A,I,a);if(Array.isArray(q))[F,W]=q;else if(q!=null)F=q;else return null}var X=HT({display:"block",paddingTop:4,paddingBottom:4,color:A.color||"#000"},s);return j.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(I),style:X},Ml(W)?j.createElement("span",{className:"recharts-tooltip-item-name"},W):null,Ml(W)?j.createElement("span",{className:"recharts-tooltip-item-separator"},e):null,j.createElement("span",{className:"recharts-tooltip-item-value"},F),j.createElement("span",{className:"recharts-tooltip-item-unit"},A.unit||""))});return j.createElement("ul",{className:"recharts-tooltip-item-list",style:E},D)}return null},y=HT({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},n),v=HT({margin:0},r),b=!Hr(h),N=b?h:"",S=Dn("recharts-default-tooltip",c),k=Dn("recharts-tooltip-label",u);b&&f&&a!==void 0&&a!==null&&(N=f(h,a));var T=p?{role:"status","aria-live":"assertive"}:{};return j.createElement("div",x_({className:S,style:y},T),j.createElement("p",{className:k,style:v},j.isValidElement(N)?N:"".concat(N)),x())},tg="recharts-tooltip-wrapper",qce={visibility:"hidden"};function Kce(t){var{coordinate:e,translateX:n,translateY:s}=t;return Dn(tg,{["".concat(tg,"-right")]:qt(n)&&e&&qt(e.x)&&n>=e.x,["".concat(tg,"-left")]:qt(n)&&e&&qt(e.x)&&n<e.x,["".concat(tg,"-bottom")]:qt(s)&&e&&qt(e.y)&&s>=e.y,["".concat(tg,"-top")]:qt(s)&&e&&qt(e.y)&&s<e.y})}function VM(t){var{allowEscapeViewBox:e,coordinate:n,key:s,offsetTopLeft:r,position:a,reverseDirection:i,tooltipDimension:l,viewBox:c,viewBoxDimension:u}=t;if(a&&qt(a[s]))return a[s];var h=n[s]-l-(r>0?r:0),f=n[s]+r;if(e[s])return i[s]?h:f;var p=c[s];if(p==null)return 0;if(i[s]){var x=h,y=p;return x<y?Math.max(f,p):Math.max(h,p)}if(u==null)return 0;var v=f+l,b=p+u;return v>b?Math.max(h,p):Math.max(f,p)}function Xce(t){var{translateX:e,translateY:n,useTranslate3d:s}=t;return{transform:s?"translate3d(".concat(e,"px, ").concat(n,"px, 0)"):"translate(".concat(e,"px, ").concat(n,"px)")}}function Yce(t){var{allowEscapeViewBox:e,coordinate:n,offsetTopLeft:s,position:r,reverseDirection:a,tooltipBox:i,useTranslate3d:l,viewBox:c}=t,u,h,f;return i.height>0&&i.width>0&&n?(h=VM({allowEscapeViewBox:e,coordinate:n,key:"x",offsetTopLeft:s,position:r,reverseDirection:a,tooltipDimension:i.width,viewBox:c,viewBoxDimension:c.width}),f=VM({allowEscapeViewBox:e,coordinate:n,key:"y",offsetTopLeft:s,position:r,reverseDirection:a,tooltipDimension:i.height,viewBox:c,viewBoxDimension:c.height}),u=Xce({translateX:h,translateY:f,useTranslate3d:l})):u=qce,{cssProperties:u,cssClasses:Kce({translateX:h,translateY:f,coordinate:n})}}function WM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function Zv(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?WM(Object(n),!0).forEach(function(s){y_(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):WM(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function y_(t,e,n){return(e=Qce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qce(t){var e=Zce(t,"string");return typeof e=="symbol"?e:e+""}function Zce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Jce extends j.PureComponent{constructor(){super(...arguments),y_(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),y_(this,"handleKeyDown",e=>{if(e.key==="Escape"){var n,s,r,a;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(n=(s=this.props.coordinate)===null||s===void 0?void 0:s.x)!==null&&n!==void 0?n:0,y:(r=(a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==null&&r!==void 0?r:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var e,n;this.state.dismissed&&(((e=this.props.coordinate)===null||e===void 0?void 0:e.x)!==this.state.dismissedAtCoordinate.x||((n=this.props.coordinate)===null||n===void 0?void 0:n.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:e,allowEscapeViewBox:n,animationDuration:s,animationEasing:r,children:a,coordinate:i,hasPayload:l,isAnimationActive:c,offset:u,position:h,reverseDirection:f,useTranslate3d:p,viewBox:x,wrapperStyle:y,lastBoundingBox:v,innerRef:b,hasPortalFromProps:N}=this.props,{cssClasses:S,cssProperties:k}=Yce({allowEscapeViewBox:n,coordinate:i,offsetTopLeft:u,position:h,reverseDirection:f,tooltipBox:{height:v.height,width:v.width},useTranslate3d:p,viewBox:x}),T=N?{}:Zv(Zv({transition:c&&e?"transform ".concat(s,"ms ").concat(r):void 0},k),{},{pointerEvents:"none",visibility:!this.state.dismissed&&e&&l?"visible":"hidden",position:"absolute",top:0,left:0}),E=Zv(Zv({},T),{},{visibility:!this.state.dismissed&&e&&l?"visible":"hidden"},y);return j.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:S,style:E,ref:b},a)}}var eue=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Of={devToolsEnabled:!1,isSsr:eue()},kV=()=>Gt(t=>t.rootProps.accessibilityLayer);function Zi(t){return Number.isFinite(t)}function xw(t){return typeof t=="number"&&t>0&&Number.isFinite(t)}function b_(){return b_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},b_.apply(null,arguments)}function HM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function GM(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?HM(Object(n),!0).forEach(function(s){tue(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):HM(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function tue(t,e,n){return(e=nue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nue(t){var e=sue(t,"string");return typeof e=="symbol"?e:e+""}function sue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var qM={curveBasisClosed:xie,curveBasisOpen:yie,curveBasis:gie,curveBumpX:nie,curveBumpY:sie,curveLinearClosed:bie,curveLinear:O2,curveMonotoneX:vie,curveMonotoneY:wie,curveNatural:Nie,curveStep:Sie,curveStepAfter:kie,curveStepBefore:jie},Jv=t=>Zi(t.x)&&Zi(t.y),ng=t=>t.x,sg=t=>t.y,rue=(t,e)=>{if(typeof t=="function")return t;var n="curve".concat(Cx(t));return(n==="curveMonotone"||n==="curveBump")&&e?qM["".concat(n).concat(e==="vertical"?"Y":"X")]:qM[n]||O2},aue=t=>{var{type:e="linear",points:n=[],baseLine:s,layout:r,connectNulls:a=!1}=t,i=rue(e,r),l=a?n.filter(Jv):n,c;if(Array.isArray(s)){var u=a?s.filter(f=>Jv(f)):s,h=l.map((f,p)=>GM(GM({},f),{},{base:u[p]}));return r==="vertical"?c=Hv().y(sg).x1(ng).x0(f=>f.base.x):c=Hv().x(ng).y1(sg).y0(f=>f.base.y),c.defined(Jv).curve(i),c(h)}return r==="vertical"&&qt(s)?c=Hv().y(sg).x1(ng).x0(s):qt(s)?c=Hv().x(ng).y1(sg).y0(s):c=NU().x(ng).y(sg),c.defined(Jv).curve(i),c(l)},iue=t=>{var{className:e,points:n,path:s,pathRef:r}=t;if((!n||!n.length)&&!s)return null;var a=n&&n.length?aue(t):s;return j.createElement("path",b_({},Rf(t),Bae(t),{className:Dn("recharts-curve",e),d:a===null?void 0:a,ref:r}))},oue=["x","y","top","left","width","height","className"];function v_(){return v_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},v_.apply(null,arguments)}function KM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function lue(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?KM(Object(n),!0).forEach(function(s){cue(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):KM(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function cue(t,e,n){return(e=uue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uue(t){var e=due(t,"string");return typeof e=="symbol"?e:e+""}function due(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hue(t,e){if(t==null)return{};var n,s,r=mue(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(s=0;s<a.length;s++)n=a[s],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function mue(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)!==-1)continue;n[s]=t[s]}return n}var fue=(t,e,n,s,r,a)=>"M".concat(t,",").concat(r,"v").concat(s,"M").concat(a,",").concat(e,"h").concat(n),pue=t=>{var{x:e=0,y:n=0,top:s=0,left:r=0,width:a=0,height:i=0,className:l}=t,c=hue(t,oue),u=lue({x:e,y:n,top:s,left:r,width:a,height:i},c);return!qt(e)||!qt(n)||!qt(a)||!qt(i)||!qt(s)||!qt(r)?null:j.createElement("path",v_({},ha(u,!0),{className:Dn("recharts-cross",l),d:fue(e,n,a,i,s,r)}))};function gue(t,e,n,s){var r=s/2;return{stroke:"none",fill:"#ccc",x:t==="horizontal"?e.x-r:n.left+.5,y:t==="horizontal"?n.top+.5:e.y-r,width:t==="horizontal"?s:n.width-1,height:t==="horizontal"?n.height-1:s}}function XM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function xue(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?XM(Object(n),!0).forEach(function(s){yue(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):XM(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function yue(t,e,n){return(e=bue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bue(t){var e=vue(t,"string");return typeof e=="symbol"?e:e+""}function vue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Oo(t,e){var n=xue({},t),s=e,r=Object.keys(e),a=r.reduce((i,l)=>(i[l]===void 0&&s[l]!==void 0&&(i[l]=s[l]),i),n);return a}function wue(){}function YM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function QM(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?YM(Object(n),!0).forEach(function(s){Nue(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):YM(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function Nue(t,e,n){return(e=Sue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sue(t){var e=jue(t,"string");return typeof e=="symbol"?e:e+""}function jue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var kue=t=>t.replace(/([A-Z])/g,e=>"-".concat(e.toLowerCase())),CV=(t,e,n)=>t.map(s=>"".concat(kue(s)," ").concat(e,"ms ").concat(n)).join(","),Cue=(t,e)=>[Object.keys(t),Object.keys(e)].reduce((n,s)=>n.filter(r=>s.includes(r))),Hg=(t,e)=>Object.keys(e).reduce((n,s)=>QM(QM({},n),{},{[s]:t(s,e[s])}),{});function ZM(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function ua(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ZM(Object(n),!0).forEach(function(s){Tue(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ZM(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function Tue(t,e,n){return(e=_ue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ue(t){var e=Eue(t,"string");return typeof e=="symbol"?e:e+""}function Eue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var yw=(t,e,n)=>t+(e-t)*n,w_=t=>{var{from:e,to:n}=t;return e!==n},TV=(t,e,n)=>{var s=Hg((r,a)=>{if(w_(a)){var[i,l]=t(a.from,a.to,a.velocity);return ua(ua({},a),{},{from:i,velocity:l})}return a},e);return n<1?Hg((r,a)=>w_(a)?ua(ua({},a),{},{velocity:yw(a.velocity,s[r].velocity,n),from:yw(a.from,s[r].from,n)}):a,e):TV(t,s,n-1)};function Aue(t,e,n,s,r,a){var i,l=s.reduce((p,x)=>ua(ua({},p),{},{[x]:{from:t[x],velocity:0,to:e[x]}}),{}),c=()=>Hg((p,x)=>x.from,l),u=()=>!Object.values(l).filter(w_).length,h=null,f=p=>{i||(i=p);var x=p-i,y=x/n.dt;l=TV(n,l,y),r(ua(ua(ua({},t),e),c())),i=p,u()||(h=a.setTimeout(f))};return()=>(h=a.setTimeout(f),()=>{h()})}function $ue(t,e,n,s,r,a,i){var l=null,c=r.reduce((f,p)=>ua(ua({},f),{},{[p]:[t[p],e[p]]}),{}),u,h=f=>{u||(u=f);var p=(f-u)/s,x=Hg((v,b)=>yw(...b,n(p)),c);if(a(ua(ua(ua({},t),e),x)),p<1)l=i.setTimeout(h);else{var y=Hg((v,b)=>yw(...b,n(1)),c);a(ua(ua(ua({},t),e),y))}};return()=>(l=i.setTimeout(h),()=>{l()})}const Iue=(t,e,n,s,r,a)=>{var i=Cue(t,e);return n.isStepper===!0?Aue(t,e,n,i,r,a):$ue(t,e,n,s,i,r,a)};var bw=1e-4,_V=(t,e)=>[0,3*t,3*e-6*t,3*t-3*e+1],EV=(t,e)=>t.map((n,s)=>n*e**s).reduce((n,s)=>n+s),JM=(t,e)=>n=>{var s=_V(t,e);return EV(s,n)},Rue=(t,e)=>n=>{var s=_V(t,e),r=[...s.map((a,i)=>a*i).slice(1),0];return EV(r,n)},eF=function(){for(var e,n,s,r,a=arguments.length,i=new Array(a),l=0;l<a;l++)i[l]=arguments[l];if(i.length===1)switch(i[0]){case"linear":[e,s,n,r]=[0,0,1,1];break;case"ease":[e,s,n,r]=[.25,.1,.25,1];break;case"ease-in":[e,s,n,r]=[.42,0,1,1];break;case"ease-out":[e,s,n,r]=[.42,0,.58,1];break;case"ease-in-out":[e,s,n,r]=[0,0,.58,1];break;default:{var c=i[0].split("(");c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4&&([e,s,n,r]=c[1].split(")")[0].split(",").map(y=>parseFloat(y)))}}else i.length===4&&([e,s,n,r]=i);var u=JM(e,n),h=JM(s,r),f=Rue(e,n),p=y=>y>1?1:y<0?0:y,x=y=>{for(var v=y>1?1:y,b=v,N=0;N<8;++N){var S=u(b)-v,k=f(b);if(Math.abs(S-v)<bw||k<bw)return h(b);b=p(b-S/k)}return h(b)};return x.isStepper=!1,x},Oue=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:n=100,damping:s=8,dt:r=17}=e,a=(i,l,c)=>{var u=-(i-l)*n,h=c*s,f=c+(u-h)*r/1e3,p=c*r/1e3+i;return Math.abs(p-l)<bw&&Math.abs(f)<bw?[l,0]:[p,f]};return a.isStepper=!0,a.dt=r,a},Due=t=>{if(typeof t=="string")switch(t){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return eF(t);case"spring":return Oue();default:if(t.split("(")[0]==="cubic-bezier")return eF(t)}return typeof t=="function"?t:null};function Pue(t){var e,n=()=>null,s=!1,r=null,a=i=>{if(!s){if(Array.isArray(i)){if(!i.length)return;var l=i,[c,...u]=l;if(typeof c=="number"){r=t.setTimeout(a.bind(null,u),c);return}a(c),r=t.setTimeout(a.bind(null,u));return}typeof i=="string"&&(e=i,n(e)),typeof i=="object"&&(e=i,n(e)),typeof i=="function"&&i()}};return{stop:()=>{s=!0},start:i=>{s=!1,r&&(r(),r=null),a(i)},subscribe:i=>(n=i,()=>{n=()=>null}),getTimeoutController:()=>t}}class Lue{setTimeout(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=performance.now(),r=null,a=i=>{i-s>=n?e(i):typeof requestAnimationFrame=="function"&&(r=requestAnimationFrame(a))};return r=requestAnimationFrame(a),()=>{cancelAnimationFrame(r)}}}function Mue(){return Pue(new Lue)}var Fue=j.createContext(Mue);function zue(t,e){var n=j.useContext(Fue);return j.useMemo(()=>e??n(t),[t,e,n])}var Bue={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},tF={t:0},GT={t:1};function R4(t){var e=Oo(t,Bue),{isActive:n,canBegin:s,duration:r,easing:a,begin:i,onAnimationEnd:l,onAnimationStart:c,children:u}=e,h=zue(e.animationId,e.animationManager),[f,p]=j.useState(n?tF:GT),x=j.useRef(null);return j.useEffect(()=>{n||p(GT)},[n]),j.useEffect(()=>{if(!n||!s)return wue;var y=Iue(tF,GT,Due(a),r,p,h.getTimeoutController()),v=()=>{x.current=y()};return h.start([c,i,v,r,l]),()=>{h.stop(),x.current&&x.current(),l()}},[n,s,r,a,i,c,l,h]),u(f.t)}function O4(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",n=j.useRef(Ug(e)),s=j.useRef(t);return s.current!==t&&(n.current=Ug(e),s.current=t),n.current}function nF(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function sF(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?nF(Object(n),!0).forEach(function(s){Uue(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nF(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function Uue(t,e,n){return(e=Vue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vue(t){var e=Wue(t,"string");return typeof e=="symbol"?e:e+""}function Wue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vw(){return vw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},vw.apply(null,arguments)}var rF=(t,e,n,s,r)=>{var a=Math.min(Math.abs(n)/2,Math.abs(s)/2),i=s>=0?1:-1,l=n>=0?1:-1,c=s>=0&&n>=0||s<0&&n<0?1:0,u;if(a>0&&r instanceof Array){for(var h=[0,0,0,0],f=0,p=4;f<p;f++)h[f]=r[f]>a?a:r[f];u="M".concat(t,",").concat(e+i*h[0]),h[0]>0&&(u+="A ".concat(h[0],",").concat(h[0],",0,0,").concat(c,",").concat(t+l*h[0],",").concat(e)),u+="L ".concat(t+n-l*h[1],",").concat(e),h[1]>0&&(u+="A ".concat(h[1],",").concat(h[1],",0,0,").concat(c,`,
        `).concat(t+n,",").concat(e+i*h[1])),u+="L ".concat(t+n,",").concat(e+s-i*h[2]),h[2]>0&&(u+="A ".concat(h[2],",").concat(h[2],",0,0,").concat(c,`,
        `).concat(t+n-l*h[2],",").concat(e+s)),u+="L ".concat(t+l*h[3],",").concat(e+s),h[3]>0&&(u+="A ".concat(h[3],",").concat(h[3],",0,0,").concat(c,`,
        `).concat(t,",").concat(e+s-i*h[3])),u+="Z"}else if(a>0&&r===+r&&r>0){var x=Math.min(a,r);u="M ".concat(t,",").concat(e+i*x,`
            A `).concat(x,",").concat(x,",0,0,").concat(c,",").concat(t+l*x,",").concat(e,`
            L `).concat(t+n-l*x,",").concat(e,`
            A `).concat(x,",").concat(x,",0,0,").concat(c,",").concat(t+n,",").concat(e+i*x,`
            L `).concat(t+n,",").concat(e+s-i*x,`
            A `).concat(x,",").concat(x,",0,0,").concat(c,",").concat(t+n-l*x,",").concat(e+s,`
            L `).concat(t+l*x,",").concat(e+s,`
            A `).concat(x,",").concat(x,",0,0,").concat(c,",").concat(t,",").concat(e+s-i*x," Z")}else u="M ".concat(t,",").concat(e," h ").concat(n," v ").concat(s," h ").concat(-n," Z");return u},Hue={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},AV=t=>{var e=Oo(t,Hue),n=j.useRef(null),[s,r]=j.useState(-1);j.useEffect(()=>{if(n.current&&n.current.getTotalLength)try{var q=n.current.getTotalLength();q&&r(q)}catch{}},[]);var{x:a,y:i,width:l,height:c,radius:u,className:h}=e,{animationEasing:f,animationDuration:p,animationBegin:x,isAnimationActive:y,isUpdateAnimationActive:v}=e,b=j.useRef(l),N=j.useRef(c),S=j.useRef(a),k=j.useRef(i),T=j.useMemo(()=>({x:a,y:i,width:l,height:c,radius:u}),[a,i,l,c,u]),E=O4(T,"rectangle-");if(a!==+a||i!==+i||l!==+l||c!==+c||l===0||c===0)return null;var D=Dn("recharts-rectangle",h);if(!v)return j.createElement("path",vw({},ha(e,!0),{className:D,d:rF(a,i,l,c,u)}));var A=b.current,I=N.current,P=S.current,$=k.current,R="0px ".concat(s===-1?1:s,"px"),F="".concat(s,"px 0px"),W=CV(["strokeDasharray"],p,typeof f=="string"?f:void 0);return j.createElement(R4,{animationId:E,key:E,canBegin:s>0,duration:p,easing:f,isActive:v,begin:x},q=>{var X=Oa(A,l,q),z=Oa(I,c,q),K=Oa(P,a,q),H=Oa($,i,q);n.current&&(b.current=X,N.current=z,S.current=K,k.current=H);var Y;return y?q>0?Y={transition:W,strokeDasharray:F}:Y={strokeDasharray:R}:Y={strokeDasharray:F},j.createElement("path",vw({},ha(e,!0),{className:D,d:rF(K,H,X,z,u),ref:n,style:sF(sF({},Y),e.style)}))})};function $V(t){var{cx:e,cy:n,radius:s,startAngle:r,endAngle:a}=t,i=da(e,n,s,r),l=da(e,n,s,a);return{points:[i,l],cx:e,cy:n,radius:s,startAngle:r,endAngle:a}}function N_(){return N_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},N_.apply(null,arguments)}var Gue=(t,e)=>{var n=di(e-t),s=Math.min(Math.abs(e-t),359.999);return n*s},e1=t=>{var{cx:e,cy:n,radius:s,angle:r,sign:a,isExternal:i,cornerRadius:l,cornerIsExternal:c}=t,u=l*(i?1:-1)+s,h=Math.asin(l/u)/gw,f=c?r:r+a*h,p=da(e,n,u,f),x=da(e,n,s,f),y=c?r-a*h:r,v=da(e,n,u*Math.cos(h*gw),y);return{center:p,circleTangency:x,lineTangency:v,theta:h}},IV=t=>{var{cx:e,cy:n,innerRadius:s,outerRadius:r,startAngle:a,endAngle:i}=t,l=Gue(a,i),c=a+l,u=da(e,n,r,a),h=da(e,n,r,c),f="M ".concat(u.x,",").concat(u.y,`
    A `).concat(r,",").concat(r,`,0,
    `).concat(+(Math.abs(l)>180),",").concat(+(a>c),`,
    `).concat(h.x,",").concat(h.y,`
  `);if(s>0){var p=da(e,n,s,a),x=da(e,n,s,c);f+="L ".concat(x.x,",").concat(x.y,`
            A `).concat(s,",").concat(s,`,0,
            `).concat(+(Math.abs(l)>180),",").concat(+(a<=c),`,
            `).concat(p.x,",").concat(p.y," Z")}else f+="L ".concat(e,",").concat(n," Z");return f},que=t=>{var{cx:e,cy:n,innerRadius:s,outerRadius:r,cornerRadius:a,forceCornerRadius:i,cornerIsExternal:l,startAngle:c,endAngle:u}=t,h=di(u-c),{circleTangency:f,lineTangency:p,theta:x}=e1({cx:e,cy:n,radius:r,angle:c,sign:h,cornerRadius:a,cornerIsExternal:l}),{circleTangency:y,lineTangency:v,theta:b}=e1({cx:e,cy:n,radius:r,angle:u,sign:-h,cornerRadius:a,cornerIsExternal:l}),N=l?Math.abs(c-u):Math.abs(c-u)-x-b;if(N<0)return i?"M ".concat(p.x,",").concat(p.y,`
        a`).concat(a,",").concat(a,",0,0,1,").concat(a*2,`,0
        a`).concat(a,",").concat(a,",0,0,1,").concat(-a*2,`,0
      `):IV({cx:e,cy:n,innerRadius:s,outerRadius:r,startAngle:c,endAngle:u});var S="M ".concat(p.x,",").concat(p.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(h<0),",").concat(f.x,",").concat(f.y,`
    A`).concat(r,",").concat(r,",0,").concat(+(N>180),",").concat(+(h<0),",").concat(y.x,",").concat(y.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(h<0),",").concat(v.x,",").concat(v.y,`
  `);if(s>0){var{circleTangency:k,lineTangency:T,theta:E}=e1({cx:e,cy:n,radius:s,angle:c,sign:h,isExternal:!0,cornerRadius:a,cornerIsExternal:l}),{circleTangency:D,lineTangency:A,theta:I}=e1({cx:e,cy:n,radius:s,angle:u,sign:-h,isExternal:!0,cornerRadius:a,cornerIsExternal:l}),P=l?Math.abs(c-u):Math.abs(c-u)-E-I;if(P<0&&a===0)return"".concat(S,"L").concat(e,",").concat(n,"Z");S+="L".concat(A.x,",").concat(A.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(h<0),",").concat(D.x,",").concat(D.y,`
      A`).concat(s,",").concat(s,",0,").concat(+(P>180),",").concat(+(h>0),",").concat(k.x,",").concat(k.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(h<0),",").concat(T.x,",").concat(T.y,"Z")}else S+="L".concat(e,",").concat(n,"Z");return S},Kue={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},RV=t=>{var e=Oo(t,Kue),{cx:n,cy:s,innerRadius:r,outerRadius:a,cornerRadius:i,forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:h,className:f}=e;if(a<r||u===h)return null;var p=Dn("recharts-sector",f),x=a-r,y=ol(i,x,0,!0),v;return y>0&&Math.abs(u-h)<360?v=que({cx:n,cy:s,innerRadius:r,outerRadius:a,cornerRadius:Math.min(y,x/2),forceCornerRadius:l,cornerIsExternal:c,startAngle:u,endAngle:h}):v=IV({cx:n,cy:s,innerRadius:r,outerRadius:a,startAngle:u,endAngle:h}),j.createElement("path",N_({},ha(e,!0),{className:p,d:v}))};function Xue(t,e,n){var s,r,a,i;if(t==="horizontal")s=e.x,a=s,r=n.top,i=n.top+n.height;else if(t==="vertical")r=e.y,i=r,s=n.left,a=n.left+n.width;else if(e.cx!=null&&e.cy!=null)if(t==="centric"){var{cx:l,cy:c,innerRadius:u,outerRadius:h,angle:f}=e,p=da(l,c,u,f),x=da(l,c,h,f);s=p.x,r=p.y,a=x.x,i=x.y}else return $V(e);return[{x:s,y:r},{x:a,y:i}]}var qT={},KT={},XT={},aF;function Yue(){return aF||(aF=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=WU();function n(s){return e.isSymbol(s)?NaN:Number(s)}t.toNumber=n})(XT)),XT}var iF;function Que(){return iF||(iF=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Yue();function n(s){return s?(s=e.toNumber(s),s===1/0||s===-1/0?(s<0?-1:1)*Number.MAX_VALUE:s===s?s:0):s===0?s:0}t.toFinite=n})(KT)),KT}var oF;function Zue(){return oF||(oF=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=HU(),n=Que();function s(r,a,i){i&&typeof i!="number"&&e.isIterateeCall(r,a,i)&&(a=i=void 0),r=n.toFinite(r),a===void 0?(a=r,r=0):a=n.toFinite(a),i=i===void 0?r<a?1:-1:n.toFinite(i);const l=Math.max(Math.ceil((a-r)/(i||1)),0),c=new Array(l);for(let u=0;u<l;u++)c[u]=r,r+=i;return c}t.range=s})(qT)),qT}var YT,lF;function Jue(){return lF||(lF=1,YT=Zue().range),YT}var ede=Jue();const OV=Hl(ede);function zu(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function tde(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function D4(t){let e,n,s;t.length!==2?(e=zu,n=(l,c)=>zu(t(l),c),s=(l,c)=>t(l)-c):(e=t===zu||t===tde?t:nde,n=t,s=t);function r(l,c,u=0,h=l.length){if(u<h){if(e(c,c)!==0)return h;do{const f=u+h>>>1;n(l[f],c)<0?u=f+1:h=f}while(u<h)}return u}function a(l,c,u=0,h=l.length){if(u<h){if(e(c,c)!==0)return h;do{const f=u+h>>>1;n(l[f],c)<=0?u=f+1:h=f}while(u<h)}return u}function i(l,c,u=0,h=l.length){const f=r(l,c,u,h-1);return f>u&&s(l[f-1],c)>-s(l[f],c)?f-1:f}return{left:r,center:i,right:a}}function nde(){return 0}function DV(t){return t===null?NaN:+t}function*sde(t,e){for(let n of t)n!=null&&(n=+n)>=n&&(yield n)}const rde=D4(zu),$x=rde.right;D4(DV).center;class cF extends Map{constructor(e,n=ode){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[s,r]of e)this.set(s,r)}get(e){return super.get(uF(this,e))}has(e){return super.has(uF(this,e))}set(e,n){return super.set(ade(this,e),n)}delete(e){return super.delete(ide(this,e))}}function uF({_intern:t,_key:e},n){const s=e(n);return t.has(s)?t.get(s):n}function ade({_intern:t,_key:e},n){const s=e(n);return t.has(s)?t.get(s):(t.set(s,n),n)}function ide({_intern:t,_key:e},n){const s=e(n);return t.has(s)&&(n=t.get(s),t.delete(s)),n}function ode(t){return t!==null&&typeof t=="object"?t.valueOf():t}function lde(t=zu){if(t===zu)return PV;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,n)=>{const s=t(e,n);return s||s===0?s:(t(n,n)===0)-(t(e,e)===0)}}function PV(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}const cde=Math.sqrt(50),ude=Math.sqrt(10),dde=Math.sqrt(2);function ww(t,e,n){const s=(e-t)/Math.max(0,n),r=Math.floor(Math.log10(s)),a=s/Math.pow(10,r),i=a>=cde?10:a>=ude?5:a>=dde?2:1;let l,c,u;return r<0?(u=Math.pow(10,-r)/i,l=Math.round(t*u),c=Math.round(e*u),l/u<t&&++l,c/u>e&&--c,u=-u):(u=Math.pow(10,r)*i,l=Math.round(t/u),c=Math.round(e/u),l*u<t&&++l,c*u>e&&--c),c<l&&.5<=n&&n<2?ww(t,e,n*2):[l,c,u]}function S_(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const s=e<t,[r,a,i]=s?ww(e,t,n):ww(t,e,n);if(!(a>=r))return[];const l=a-r+1,c=new Array(l);if(s)if(i<0)for(let u=0;u<l;++u)c[u]=(a-u)/-i;else for(let u=0;u<l;++u)c[u]=(a-u)*i;else if(i<0)for(let u=0;u<l;++u)c[u]=(r+u)/-i;else for(let u=0;u<l;++u)c[u]=(r+u)*i;return c}function j_(t,e,n){return e=+e,t=+t,n=+n,ww(t,e,n)[2]}function k_(t,e,n){e=+e,t=+t,n=+n;const s=e<t,r=s?j_(e,t,n):j_(t,e,n);return(s?-1:1)*(r<0?1/-r:r)}function dF(t,e){let n;for(const s of t)s!=null&&(n<s||n===void 0&&s>=s)&&(n=s);return n}function hF(t,e){let n;for(const s of t)s!=null&&(n>s||n===void 0&&s>=s)&&(n=s);return n}function LV(t,e,n=0,s=1/0,r){if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),s=Math.floor(Math.min(t.length-1,s)),!(n<=e&&e<=s))return t;for(r=r===void 0?PV:lde(r);s>n;){if(s-n>600){const c=s-n+1,u=e-n+1,h=Math.log(c),f=.5*Math.exp(2*h/3),p=.5*Math.sqrt(h*f*(c-f)/c)*(u-c/2<0?-1:1),x=Math.max(n,Math.floor(e-u*f/c+p)),y=Math.min(s,Math.floor(e+(c-u)*f/c+p));LV(t,e,x,y,r)}const a=t[e];let i=n,l=s;for(rg(t,n,e),r(t[s],a)>0&&rg(t,n,s);i<l;){for(rg(t,i,l),++i,--l;r(t[i],a)<0;)++i;for(;r(t[l],a)>0;)--l}r(t[n],a)===0?rg(t,n,l):(++l,rg(t,l,s)),l<=e&&(n=l+1),e<=l&&(s=l-1)}return t}function rg(t,e,n){const s=t[e];t[e]=t[n],t[n]=s}function hde(t,e,n){if(t=Float64Array.from(sde(t)),!(!(s=t.length)||isNaN(e=+e))){if(e<=0||s<2)return hF(t);if(e>=1)return dF(t);var s,r=(s-1)*e,a=Math.floor(r),i=dF(LV(t,a).subarray(0,a+1)),l=hF(t.subarray(a+1));return i+(l-i)*(r-a)}}function mde(t,e,n=DV){if(!(!(s=t.length)||isNaN(e=+e))){if(e<=0||s<2)return+n(t[0],0,t);if(e>=1)return+n(t[s-1],s-1,t);var s,r=(s-1)*e,a=Math.floor(r),i=+n(t[a],a,t),l=+n(t[a+1],a+1,t);return i+(l-i)*(r-a)}}function fde(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var s=-1,r=Math.max(0,Math.ceil((e-t)/n))|0,a=new Array(r);++s<r;)a[s]=t+s*n;return a}function Do(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function Wc(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const C_=Symbol("implicit");function P4(){var t=new cF,e=[],n=[],s=C_;function r(a){let i=t.get(a);if(i===void 0){if(s!==C_)return s;t.set(a,i=e.push(a)-1)}return n[i%n.length]}return r.domain=function(a){if(!arguments.length)return e.slice();e=[],t=new cF;for(const i of a)t.has(i)||t.set(i,e.push(i)-1);return r},r.range=function(a){return arguments.length?(n=Array.from(a),r):n.slice()},r.unknown=function(a){return arguments.length?(s=a,r):s},r.copy=function(){return P4(e,n).unknown(s)},Do.apply(r,arguments),r}function L4(){var t=P4().unknown(void 0),e=t.domain,n=t.range,s=0,r=1,a,i,l=!1,c=0,u=0,h=.5;delete t.unknown;function f(){var p=e().length,x=r<s,y=x?r:s,v=x?s:r;a=(v-y)/Math.max(1,p-c+u*2),l&&(a=Math.floor(a)),y+=(v-y-a*(p-c))*h,i=a*(1-c),l&&(y=Math.round(y),i=Math.round(i));var b=fde(p).map(function(N){return y+a*N});return n(x?b.reverse():b)}return t.domain=function(p){return arguments.length?(e(p),f()):e()},t.range=function(p){return arguments.length?([s,r]=p,s=+s,r=+r,f()):[s,r]},t.rangeRound=function(p){return[s,r]=p,s=+s,r=+r,l=!0,f()},t.bandwidth=function(){return i},t.step=function(){return a},t.round=function(p){return arguments.length?(l=!!p,f()):l},t.padding=function(p){return arguments.length?(c=Math.min(1,u=+p),f()):c},t.paddingInner=function(p){return arguments.length?(c=Math.min(1,p),f()):c},t.paddingOuter=function(p){return arguments.length?(u=+p,f()):u},t.align=function(p){return arguments.length?(h=Math.max(0,Math.min(1,p)),f()):h},t.copy=function(){return L4(e(),[s,r]).round(l).paddingInner(c).paddingOuter(u).align(h)},Do.apply(f(),arguments)}function MV(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return MV(e())},t}function pde(){return MV(L4.apply(null,arguments).paddingInner(1))}function M4(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function FV(t,e){var n=Object.create(t.prototype);for(var s in e)n[s]=e[s];return n}function Ix(){}var Gg=.7,Nw=1/Gg,Km="\\s*([+-]?\\d+)\\s*",qg="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Il="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",gde=/^#([0-9a-f]{3,8})$/,xde=new RegExp(`^rgb\\(${Km},${Km},${Km}\\)$`),yde=new RegExp(`^rgb\\(${Il},${Il},${Il}\\)$`),bde=new RegExp(`^rgba\\(${Km},${Km},${Km},${qg}\\)$`),vde=new RegExp(`^rgba\\(${Il},${Il},${Il},${qg}\\)$`),wde=new RegExp(`^hsl\\(${qg},${Il},${Il}\\)$`),Nde=new RegExp(`^hsla\\(${qg},${Il},${Il},${qg}\\)$`),mF={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};M4(Ix,Kg,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:fF,formatHex:fF,formatHex8:Sde,formatHsl:jde,formatRgb:pF,toString:pF});function fF(){return this.rgb().formatHex()}function Sde(){return this.rgb().formatHex8()}function jde(){return zV(this).formatHsl()}function pF(){return this.rgb().formatRgb()}function Kg(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=gde.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?gF(e):n===3?new hi(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?t1(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?t1(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=xde.exec(t))?new hi(e[1],e[2],e[3],1):(e=yde.exec(t))?new hi(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=bde.exec(t))?t1(e[1],e[2],e[3],e[4]):(e=vde.exec(t))?t1(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=wde.exec(t))?bF(e[1],e[2]/100,e[3]/100,1):(e=Nde.exec(t))?bF(e[1],e[2]/100,e[3]/100,e[4]):mF.hasOwnProperty(t)?gF(mF[t]):t==="transparent"?new hi(NaN,NaN,NaN,0):null}function gF(t){return new hi(t>>16&255,t>>8&255,t&255,1)}function t1(t,e,n,s){return s<=0&&(t=e=n=NaN),new hi(t,e,n,s)}function kde(t){return t instanceof Ix||(t=Kg(t)),t?(t=t.rgb(),new hi(t.r,t.g,t.b,t.opacity)):new hi}function T_(t,e,n,s){return arguments.length===1?kde(t):new hi(t,e,n,s??1)}function hi(t,e,n,s){this.r=+t,this.g=+e,this.b=+n,this.opacity=+s}M4(hi,T_,FV(Ix,{brighter(t){return t=t==null?Nw:Math.pow(Nw,t),new hi(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Gg:Math.pow(Gg,t),new hi(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new hi(ah(this.r),ah(this.g),ah(this.b),Sw(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:xF,formatHex:xF,formatHex8:Cde,formatRgb:yF,toString:yF}));function xF(){return`#${Qd(this.r)}${Qd(this.g)}${Qd(this.b)}`}function Cde(){return`#${Qd(this.r)}${Qd(this.g)}${Qd(this.b)}${Qd((isNaN(this.opacity)?1:this.opacity)*255)}`}function yF(){const t=Sw(this.opacity);return`${t===1?"rgb(":"rgba("}${ah(this.r)}, ${ah(this.g)}, ${ah(this.b)}${t===1?")":`, ${t})`}`}function Sw(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ah(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Qd(t){return t=ah(t),(t<16?"0":"")+t.toString(16)}function bF(t,e,n,s){return s<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new tl(t,e,n,s)}function zV(t){if(t instanceof tl)return new tl(t.h,t.s,t.l,t.opacity);if(t instanceof Ix||(t=Kg(t)),!t)return new tl;if(t instanceof tl)return t;t=t.rgb();var e=t.r/255,n=t.g/255,s=t.b/255,r=Math.min(e,n,s),a=Math.max(e,n,s),i=NaN,l=a-r,c=(a+r)/2;return l?(e===a?i=(n-s)/l+(n<s)*6:n===a?i=(s-e)/l+2:i=(e-n)/l+4,l/=c<.5?a+r:2-a-r,i*=60):l=c>0&&c<1?0:i,new tl(i,l,c,t.opacity)}function Tde(t,e,n,s){return arguments.length===1?zV(t):new tl(t,e,n,s??1)}function tl(t,e,n,s){this.h=+t,this.s=+e,this.l=+n,this.opacity=+s}M4(tl,Tde,FV(Ix,{brighter(t){return t=t==null?Nw:Math.pow(Nw,t),new tl(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Gg:Math.pow(Gg,t),new tl(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,s=n+(n<.5?n:1-n)*e,r=2*n-s;return new hi(QT(t>=240?t-240:t+120,r,s),QT(t,r,s),QT(t<120?t+240:t-120,r,s),this.opacity)},clamp(){return new tl(vF(this.h),n1(this.s),n1(this.l),Sw(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Sw(this.opacity);return`${t===1?"hsl(":"hsla("}${vF(this.h)}, ${n1(this.s)*100}%, ${n1(this.l)*100}%${t===1?")":`, ${t})`}`}}));function vF(t){return t=(t||0)%360,t<0?t+360:t}function n1(t){return Math.max(0,Math.min(1,t||0))}function QT(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const F4=t=>()=>t;function _de(t,e){return function(n){return t+n*e}}function Ede(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(s){return Math.pow(t+s*e,n)}}function Ade(t){return(t=+t)==1?BV:function(e,n){return n-e?Ede(e,n,t):F4(isNaN(e)?n:e)}}function BV(t,e){var n=e-t;return n?_de(t,n):F4(isNaN(t)?e:t)}const wF=(function t(e){var n=Ade(e);function s(r,a){var i=n((r=T_(r)).r,(a=T_(a)).r),l=n(r.g,a.g),c=n(r.b,a.b),u=BV(r.opacity,a.opacity);return function(h){return r.r=i(h),r.g=l(h),r.b=c(h),r.opacity=u(h),r+""}}return s.gamma=t,s})(1);function $de(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,s=e.slice(),r;return function(a){for(r=0;r<n;++r)s[r]=t[r]*(1-a)+e[r]*a;return s}}function Ide(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function Rde(t,e){var n=e?e.length:0,s=t?Math.min(n,t.length):0,r=new Array(s),a=new Array(n),i;for(i=0;i<s;++i)r[i]=Df(t[i],e[i]);for(;i<n;++i)a[i]=e[i];return function(l){for(i=0;i<s;++i)a[i]=r[i](l);return a}}function Ode(t,e){var n=new Date;return t=+t,e=+e,function(s){return n.setTime(t*(1-s)+e*s),n}}function jw(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Dde(t,e){var n={},s={},r;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(r in e)r in t?n[r]=Df(t[r],e[r]):s[r]=e[r];return function(a){for(r in n)s[r]=n[r](a);return s}}var __=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,ZT=new RegExp(__.source,"g");function Pde(t){return function(){return t}}function Lde(t){return function(e){return t(e)+""}}function Mde(t,e){var n=__.lastIndex=ZT.lastIndex=0,s,r,a,i=-1,l=[],c=[];for(t=t+"",e=e+"";(s=__.exec(t))&&(r=ZT.exec(e));)(a=r.index)>n&&(a=e.slice(n,a),l[i]?l[i]+=a:l[++i]=a),(s=s[0])===(r=r[0])?l[i]?l[i]+=r:l[++i]=r:(l[++i]=null,c.push({i,x:jw(s,r)})),n=ZT.lastIndex;return n<e.length&&(a=e.slice(n),l[i]?l[i]+=a:l[++i]=a),l.length<2?c[0]?Lde(c[0].x):Pde(e):(e=c.length,function(u){for(var h=0,f;h<e;++h)l[(f=c[h]).i]=f.x(u);return l.join("")})}function Df(t,e){var n=typeof e,s;return e==null||n==="boolean"?F4(e):(n==="number"?jw:n==="string"?(s=Kg(e))?(e=s,wF):Mde:e instanceof Kg?wF:e instanceof Date?Ode:Ide(e)?$de:Array.isArray(e)?Rde:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Dde:jw)(t,e)}function z4(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function Fde(t,e){e===void 0&&(e=t,t=Df);for(var n=0,s=e.length-1,r=e[0],a=new Array(s<0?0:s);n<s;)a[n]=t(r,r=e[++n]);return function(i){var l=Math.max(0,Math.min(s-1,Math.floor(i*=s)));return a[l](i-l)}}function zde(t){return function(){return t}}function kw(t){return+t}var NF=[0,1];function La(t){return t}function E_(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:zde(isNaN(e)?NaN:.5)}function Bde(t,e){var n;return t>e&&(n=t,t=e,e=n),function(s){return Math.max(t,Math.min(e,s))}}function Ude(t,e,n){var s=t[0],r=t[1],a=e[0],i=e[1];return r<s?(s=E_(r,s),a=n(i,a)):(s=E_(s,r),a=n(a,i)),function(l){return a(s(l))}}function Vde(t,e,n){var s=Math.min(t.length,e.length)-1,r=new Array(s),a=new Array(s),i=-1;for(t[s]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++i<s;)r[i]=E_(t[i],t[i+1]),a[i]=n(e[i],e[i+1]);return function(l){var c=$x(t,l,1,s)-1;return a[c](r[c](l))}}function Rx(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function G2(){var t=NF,e=NF,n=Df,s,r,a,i=La,l,c,u;function h(){var p=Math.min(t.length,e.length);return i!==La&&(i=Bde(t[0],t[p-1])),l=p>2?Vde:Ude,c=u=null,f}function f(p){return p==null||isNaN(p=+p)?a:(c||(c=l(t.map(s),e,n)))(s(i(p)))}return f.invert=function(p){return i(r((u||(u=l(e,t.map(s),jw)))(p)))},f.domain=function(p){return arguments.length?(t=Array.from(p,kw),h()):t.slice()},f.range=function(p){return arguments.length?(e=Array.from(p),h()):e.slice()},f.rangeRound=function(p){return e=Array.from(p),n=z4,h()},f.clamp=function(p){return arguments.length?(i=p?!0:La,h()):i!==La},f.interpolate=function(p){return arguments.length?(n=p,h()):n},f.unknown=function(p){return arguments.length?(a=p,f):a},function(p,x){return s=p,r=x,h()}}function B4(){return G2()(La,La)}function Wde(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Cw(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,s=t.slice(0,n);return[s.length>1?s[0]+s.slice(2):s,+t.slice(n+1)]}function rf(t){return t=Cw(Math.abs(t)),t?t[1]:NaN}function Hde(t,e){return function(n,s){for(var r=n.length,a=[],i=0,l=t[0],c=0;r>0&&l>0&&(c+l+1>s&&(l=Math.max(1,s-c)),a.push(n.substring(r-=l,r+l)),!((c+=l+1)>s));)l=t[i=(i+1)%t.length];return a.reverse().join(e)}}function Gde(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var qde=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Xg(t){if(!(e=qde.exec(t)))throw new Error("invalid format: "+t);var e;return new U4({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Xg.prototype=U4.prototype;function U4(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}U4.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function Kde(t){e:for(var e=t.length,n=1,s=-1,r;n<e;++n)switch(t[n]){case".":s=r=n;break;case"0":s===0&&(s=n),r=n;break;default:if(!+t[n])break e;s>0&&(s=0);break}return s>0?t.slice(0,s)+t.slice(r+1):t}var UV;function Xde(t,e){var n=Cw(t,e);if(!n)return t+"";var s=n[0],r=n[1],a=r-(UV=Math.max(-8,Math.min(8,Math.floor(r/3)))*3)+1,i=s.length;return a===i?s:a>i?s+new Array(a-i+1).join("0"):a>0?s.slice(0,a)+"."+s.slice(a):"0."+new Array(1-a).join("0")+Cw(t,Math.max(0,e+a-1))[0]}function SF(t,e){var n=Cw(t,e);if(!n)return t+"";var s=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+s:s.length>r+1?s.slice(0,r+1)+"."+s.slice(r+1):s+new Array(r-s.length+2).join("0")}const jF={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:Wde,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>SF(t*100,e),r:SF,s:Xde,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function kF(t){return t}var CF=Array.prototype.map,TF=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Yde(t){var e=t.grouping===void 0||t.thousands===void 0?kF:Hde(CF.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",s=t.currency===void 0?"":t.currency[1]+"",r=t.decimal===void 0?".":t.decimal+"",a=t.numerals===void 0?kF:Gde(CF.call(t.numerals,String)),i=t.percent===void 0?"%":t.percent+"",l=t.minus===void 0?"":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function u(f){f=Xg(f);var p=f.fill,x=f.align,y=f.sign,v=f.symbol,b=f.zero,N=f.width,S=f.comma,k=f.precision,T=f.trim,E=f.type;E==="n"?(S=!0,E="g"):jF[E]||(k===void 0&&(k=12),T=!0,E="g"),(b||p==="0"&&x==="=")&&(b=!0,p="0",x="=");var D=v==="$"?n:v==="#"&&/[boxX]/.test(E)?"0"+E.toLowerCase():"",A=v==="$"?s:/[%p]/.test(E)?i:"",I=jF[E],P=/[defgprs%]/.test(E);k=k===void 0?6:/[gprs]/.test(E)?Math.max(1,Math.min(21,k)):Math.max(0,Math.min(20,k));function $(R){var F=D,W=A,q,X,z;if(E==="c")W=I(R)+W,R="";else{R=+R;var K=R<0||1/R<0;if(R=isNaN(R)?c:I(Math.abs(R),k),T&&(R=Kde(R)),K&&+R==0&&y!=="+"&&(K=!1),F=(K?y==="("?y:l:y==="-"||y==="("?"":y)+F,W=(E==="s"?TF[8+UV/3]:"")+W+(K&&y==="("?")":""),P){for(q=-1,X=R.length;++q<X;)if(z=R.charCodeAt(q),48>z||z>57){W=(z===46?r+R.slice(q+1):R.slice(q))+W,R=R.slice(0,q);break}}}S&&!b&&(R=e(R,1/0));var H=F.length+R.length+W.length,Y=H<N?new Array(N-H+1).join(p):"";switch(S&&b&&(R=e(Y+R,Y.length?N-W.length:1/0),Y=""),x){case"<":R=F+R+W+Y;break;case"=":R=F+Y+R+W;break;case"^":R=Y.slice(0,H=Y.length>>1)+F+R+W+Y.slice(H);break;default:R=Y+F+R+W;break}return a(R)}return $.toString=function(){return f+""},$}function h(f,p){var x=u((f=Xg(f),f.type="f",f)),y=Math.max(-8,Math.min(8,Math.floor(rf(p)/3)))*3,v=Math.pow(10,-y),b=TF[8+y/3];return function(N){return x(v*N)+b}}return{format:u,formatPrefix:h}}var s1,V4,VV;Qde({thousands:",",grouping:[3],currency:["$",""]});function Qde(t){return s1=Yde(t),V4=s1.format,VV=s1.formatPrefix,s1}function Zde(t){return Math.max(0,-rf(Math.abs(t)))}function Jde(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(rf(e)/3)))*3-rf(Math.abs(t)))}function ehe(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,rf(e)-rf(t))+1}function WV(t,e,n,s){var r=k_(t,e,n),a;switch(s=Xg(s??",f"),s.type){case"s":{var i=Math.max(Math.abs(t),Math.abs(e));return s.precision==null&&!isNaN(a=Jde(r,i))&&(s.precision=a),VV(s,i)}case"":case"e":case"g":case"p":case"r":{s.precision==null&&!isNaN(a=ehe(r,Math.max(Math.abs(t),Math.abs(e))))&&(s.precision=a-(s.type==="e"));break}case"f":case"%":{s.precision==null&&!isNaN(a=Zde(r))&&(s.precision=a-(s.type==="%")*2);break}}return V4(s)}function ad(t){var e=t.domain;return t.ticks=function(n){var s=e();return S_(s[0],s[s.length-1],n??10)},t.tickFormat=function(n,s){var r=e();return WV(r[0],r[r.length-1],n??10,s)},t.nice=function(n){n==null&&(n=10);var s=e(),r=0,a=s.length-1,i=s[r],l=s[a],c,u,h=10;for(l<i&&(u=i,i=l,l=u,u=r,r=a,a=u);h-- >0;){if(u=j_(i,l,n),u===c)return s[r]=i,s[a]=l,e(s);if(u>0)i=Math.floor(i/u)*u,l=Math.ceil(l/u)*u;else if(u<0)i=Math.ceil(i*u)/u,l=Math.floor(l*u)/u;else break;c=u}return t},t}function HV(){var t=B4();return t.copy=function(){return Rx(t,HV())},Do.apply(t,arguments),ad(t)}function GV(t){var e;function n(s){return s==null||isNaN(s=+s)?e:s}return n.invert=n,n.domain=n.range=function(s){return arguments.length?(t=Array.from(s,kw),n):t.slice()},n.unknown=function(s){return arguments.length?(e=s,n):e},n.copy=function(){return GV(t).unknown(e)},t=arguments.length?Array.from(t,kw):[0,1],ad(n)}function qV(t,e){t=t.slice();var n=0,s=t.length-1,r=t[n],a=t[s],i;return a<r&&(i=n,n=s,s=i,i=r,r=a,a=i),t[n]=e.floor(r),t[s]=e.ceil(a),t}function _F(t){return Math.log(t)}function EF(t){return Math.exp(t)}function the(t){return-Math.log(-t)}function nhe(t){return-Math.exp(-t)}function she(t){return isFinite(t)?+("1e"+t):t<0?0:t}function rhe(t){return t===10?she:t===Math.E?Math.exp:e=>Math.pow(t,e)}function ahe(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function AF(t){return(e,n)=>-t(-e,n)}function W4(t){const e=t(_F,EF),n=e.domain;let s=10,r,a;function i(){return r=ahe(s),a=rhe(s),n()[0]<0?(r=AF(r),a=AF(a),t(the,nhe)):t(_F,EF),e}return e.base=function(l){return arguments.length?(s=+l,i()):s},e.domain=function(l){return arguments.length?(n(l),i()):n()},e.ticks=l=>{const c=n();let u=c[0],h=c[c.length-1];const f=h<u;f&&([u,h]=[h,u]);let p=r(u),x=r(h),y,v;const b=l==null?10:+l;let N=[];if(!(s%1)&&x-p<b){if(p=Math.floor(p),x=Math.ceil(x),u>0){for(;p<=x;++p)for(y=1;y<s;++y)if(v=p<0?y/a(-p):y*a(p),!(v<u)){if(v>h)break;N.push(v)}}else for(;p<=x;++p)for(y=s-1;y>=1;--y)if(v=p>0?y/a(-p):y*a(p),!(v<u)){if(v>h)break;N.push(v)}N.length*2<b&&(N=S_(u,h,b))}else N=S_(p,x,Math.min(x-p,b)).map(a);return f?N.reverse():N},e.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=s===10?"s":","),typeof c!="function"&&(!(s%1)&&(c=Xg(c)).precision==null&&(c.trim=!0),c=V4(c)),l===1/0)return c;const u=Math.max(1,s*l/e.ticks().length);return h=>{let f=h/a(Math.round(r(h)));return f*s<s-.5&&(f*=s),f<=u?c(h):""}},e.nice=()=>n(qV(n(),{floor:l=>a(Math.floor(r(l))),ceil:l=>a(Math.ceil(r(l)))})),e}function KV(){const t=W4(G2()).domain([1,10]);return t.copy=()=>Rx(t,KV()).base(t.base()),Do.apply(t,arguments),t}function $F(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function IF(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function H4(t){var e=1,n=t($F(e),IF(e));return n.constant=function(s){return arguments.length?t($F(e=+s),IF(e)):e},ad(n)}function XV(){var t=H4(G2());return t.copy=function(){return Rx(t,XV()).constant(t.constant())},Do.apply(t,arguments)}function RF(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function ihe(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function ohe(t){return t<0?-t*t:t*t}function G4(t){var e=t(La,La),n=1;function s(){return n===1?t(La,La):n===.5?t(ihe,ohe):t(RF(n),RF(1/n))}return e.exponent=function(r){return arguments.length?(n=+r,s()):n},ad(e)}function q4(){var t=G4(G2());return t.copy=function(){return Rx(t,q4()).exponent(t.exponent())},Do.apply(t,arguments),t}function lhe(){return q4.apply(null,arguments).exponent(.5)}function OF(t){return Math.sign(t)*t*t}function che(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function YV(){var t=B4(),e=[0,1],n=!1,s;function r(a){var i=che(t(a));return isNaN(i)?s:n?Math.round(i):i}return r.invert=function(a){return t.invert(OF(a))},r.domain=function(a){return arguments.length?(t.domain(a),r):t.domain()},r.range=function(a){return arguments.length?(t.range((e=Array.from(a,kw)).map(OF)),r):e.slice()},r.rangeRound=function(a){return r.range(a).round(!0)},r.round=function(a){return arguments.length?(n=!!a,r):n},r.clamp=function(a){return arguments.length?(t.clamp(a),r):t.clamp()},r.unknown=function(a){return arguments.length?(s=a,r):s},r.copy=function(){return YV(t.domain(),e).round(n).clamp(t.clamp()).unknown(s)},Do.apply(r,arguments),ad(r)}function QV(){var t=[],e=[],n=[],s;function r(){var i=0,l=Math.max(1,e.length);for(n=new Array(l-1);++i<l;)n[i-1]=mde(t,i/l);return a}function a(i){return i==null||isNaN(i=+i)?s:e[$x(n,i)]}return a.invertExtent=function(i){var l=e.indexOf(i);return l<0?[NaN,NaN]:[l>0?n[l-1]:t[0],l<n.length?n[l]:t[t.length-1]]},a.domain=function(i){if(!arguments.length)return t.slice();t=[];for(let l of i)l!=null&&!isNaN(l=+l)&&t.push(l);return t.sort(zu),r()},a.range=function(i){return arguments.length?(e=Array.from(i),r()):e.slice()},a.unknown=function(i){return arguments.length?(s=i,a):s},a.quantiles=function(){return n.slice()},a.copy=function(){return QV().domain(t).range(e).unknown(s)},Do.apply(a,arguments)}function ZV(){var t=0,e=1,n=1,s=[.5],r=[0,1],a;function i(c){return c!=null&&c<=c?r[$x(s,c,0,n)]:a}function l(){var c=-1;for(s=new Array(n);++c<n;)s[c]=((c+1)*e-(c-n)*t)/(n+1);return i}return i.domain=function(c){return arguments.length?([t,e]=c,t=+t,e=+e,l()):[t,e]},i.range=function(c){return arguments.length?(n=(r=Array.from(c)).length-1,l()):r.slice()},i.invertExtent=function(c){var u=r.indexOf(c);return u<0?[NaN,NaN]:u<1?[t,s[0]]:u>=n?[s[n-1],e]:[s[u-1],s[u]]},i.unknown=function(c){return arguments.length&&(a=c),i},i.thresholds=function(){return s.slice()},i.copy=function(){return ZV().domain([t,e]).range(r).unknown(a)},Do.apply(ad(i),arguments)}function JV(){var t=[.5],e=[0,1],n,s=1;function r(a){return a!=null&&a<=a?e[$x(t,a,0,s)]:n}return r.domain=function(a){return arguments.length?(t=Array.from(a),s=Math.min(t.length,e.length-1),r):t.slice()},r.range=function(a){return arguments.length?(e=Array.from(a),s=Math.min(t.length,e.length-1),r):e.slice()},r.invertExtent=function(a){var i=e.indexOf(a);return[t[i-1],t[i]]},r.unknown=function(a){return arguments.length?(n=a,r):n},r.copy=function(){return JV().domain(t).range(e).unknown(n)},Do.apply(r,arguments)}const JT=new Date,e3=new Date;function Ir(t,e,n,s){function r(a){return t(a=arguments.length===0?new Date:new Date(+a)),a}return r.floor=a=>(t(a=new Date(+a)),a),r.ceil=a=>(t(a=new Date(a-1)),e(a,1),t(a),a),r.round=a=>{const i=r(a),l=r.ceil(a);return a-i<l-a?i:l},r.offset=(a,i)=>(e(a=new Date(+a),i==null?1:Math.floor(i)),a),r.range=(a,i,l)=>{const c=[];if(a=r.ceil(a),l=l==null?1:Math.floor(l),!(a<i)||!(l>0))return c;let u;do c.push(u=new Date(+a)),e(a,l),t(a);while(u<a&&a<i);return c},r.filter=a=>Ir(i=>{if(i>=i)for(;t(i),!a(i);)i.setTime(i-1)},(i,l)=>{if(i>=i)if(l<0)for(;++l<=0;)for(;e(i,-1),!a(i););else for(;--l>=0;)for(;e(i,1),!a(i););}),n&&(r.count=(a,i)=>(JT.setTime(+a),e3.setTime(+i),t(JT),t(e3),Math.floor(n(JT,e3))),r.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?r.filter(s?i=>s(i)%a===0:i=>r.count(0,i)%a===0):r)),r}const Tw=Ir(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);Tw.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?Ir(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):Tw);Tw.range;const wc=1e3,_o=wc*60,Nc=_o*60,Ec=Nc*24,K4=Ec*7,DF=Ec*30,t3=Ec*365,Zd=Ir(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*wc)},(t,e)=>(e-t)/wc,t=>t.getUTCSeconds());Zd.range;const X4=Ir(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*wc)},(t,e)=>{t.setTime(+t+e*_o)},(t,e)=>(e-t)/_o,t=>t.getMinutes());X4.range;const Y4=Ir(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*_o)},(t,e)=>(e-t)/_o,t=>t.getUTCMinutes());Y4.range;const Q4=Ir(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*wc-t.getMinutes()*_o)},(t,e)=>{t.setTime(+t+e*Nc)},(t,e)=>(e-t)/Nc,t=>t.getHours());Q4.range;const Z4=Ir(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Nc)},(t,e)=>(e-t)/Nc,t=>t.getUTCHours());Z4.range;const Ox=Ir(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*_o)/Ec,t=>t.getDate()-1);Ox.range;const q2=Ir(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Ec,t=>t.getUTCDate()-1);q2.range;const e9=Ir(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Ec,t=>Math.floor(t/Ec));e9.range;function zh(t){return Ir(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*_o)/K4)}const K2=zh(0),_w=zh(1),uhe=zh(2),dhe=zh(3),af=zh(4),hhe=zh(5),mhe=zh(6);K2.range;_w.range;uhe.range;dhe.range;af.range;hhe.range;mhe.range;function Bh(t){return Ir(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/K4)}const X2=Bh(0),Ew=Bh(1),fhe=Bh(2),phe=Bh(3),of=Bh(4),ghe=Bh(5),xhe=Bh(6);X2.range;Ew.range;fhe.range;phe.range;of.range;ghe.range;xhe.range;const J4=Ir(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth());J4.range;const eA=Ir(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth());eA.range;const Ac=Ir(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());Ac.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Ir(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});Ac.range;const $c=Ir(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());$c.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:Ir(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});$c.range;function t9(t,e,n,s,r,a){const i=[[Zd,1,wc],[Zd,5,5*wc],[Zd,15,15*wc],[Zd,30,30*wc],[a,1,_o],[a,5,5*_o],[a,15,15*_o],[a,30,30*_o],[r,1,Nc],[r,3,3*Nc],[r,6,6*Nc],[r,12,12*Nc],[s,1,Ec],[s,2,2*Ec],[n,1,K4],[e,1,DF],[e,3,3*DF],[t,1,t3]];function l(u,h,f){const p=h<u;p&&([u,h]=[h,u]);const x=f&&typeof f.range=="function"?f:c(u,h,f),y=x?x.range(u,+h+1):[];return p?y.reverse():y}function c(u,h,f){const p=Math.abs(h-u)/f,x=D4(([,,b])=>b).right(i,p);if(x===i.length)return t.every(k_(u/t3,h/t3,f));if(x===0)return Tw.every(Math.max(k_(u,h,f),1));const[y,v]=i[p/i[x-1][2]<i[x][2]/p?x-1:x];return y.every(v)}return[l,c]}const[yhe,bhe]=t9($c,eA,X2,e9,Z4,Y4),[vhe,whe]=t9(Ac,J4,K2,Ox,Q4,X4);function n3(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function s3(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function ag(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function Nhe(t){var e=t.dateTime,n=t.date,s=t.time,r=t.periods,a=t.days,i=t.shortDays,l=t.months,c=t.shortMonths,u=ig(r),h=og(r),f=ig(a),p=og(a),x=ig(i),y=og(i),v=ig(l),b=og(l),N=ig(c),S=og(c),k={a:K,A:H,b:Y,B,c:null,d:BF,e:BF,f:Hhe,g:tme,G:sme,H:Uhe,I:Vhe,j:Whe,L:n9,m:Ghe,M:qhe,p:O,q:U,Q:WF,s:HF,S:Khe,u:Xhe,U:Yhe,V:Qhe,w:Zhe,W:Jhe,x:null,X:null,y:eme,Y:nme,Z:rme,"%":VF},T={a:J,A:se,b:ae,B:fe,c:null,d:UF,e:UF,f:lme,g:yme,G:vme,H:ame,I:ime,j:ome,L:r9,m:cme,M:ume,p:ye,q:Te,Q:WF,s:HF,S:dme,u:hme,U:mme,V:fme,w:pme,W:gme,x:null,X:null,y:xme,Y:bme,Z:wme,"%":VF},E={a:$,A:R,b:F,B:W,c:q,d:FF,e:FF,f:Mhe,g:MF,G:LF,H:zF,I:zF,j:Ohe,L:Lhe,m:Rhe,M:Dhe,p:P,q:Ihe,Q:zhe,s:Bhe,S:Phe,u:The,U:_he,V:Ehe,w:Che,W:Ahe,x:X,X:z,y:MF,Y:LF,Z:$he,"%":Fhe};k.x=D(n,k),k.X=D(s,k),k.c=D(e,k),T.x=D(n,T),T.X=D(s,T),T.c=D(e,T);function D(oe,Se){return function(ke){var me=[],re=-1,je=0,ie=oe.length,Re,Ve,Ze;for(ke instanceof Date||(ke=new Date(+ke));++re<ie;)oe.charCodeAt(re)===37&&(me.push(oe.slice(je,re)),(Ve=PF[Re=oe.charAt(++re)])!=null?Re=oe.charAt(++re):Ve=Re==="e"?" ":"0",(Ze=Se[Re])&&(Re=Ze(ke,Ve)),me.push(Re),je=re+1);return me.push(oe.slice(je,re)),me.join("")}}function A(oe,Se){return function(ke){var me=ag(1900,void 0,1),re=I(me,oe,ke+="",0),je,ie;if(re!=ke.length)return null;if("Q"in me)return new Date(me.Q);if("s"in me)return new Date(me.s*1e3+("L"in me?me.L:0));if(Se&&!("Z"in me)&&(me.Z=0),"p"in me&&(me.H=me.H%12+me.p*12),me.m===void 0&&(me.m="q"in me?me.q:0),"V"in me){if(me.V<1||me.V>53)return null;"w"in me||(me.w=1),"Z"in me?(je=s3(ag(me.y,0,1)),ie=je.getUTCDay(),je=ie>4||ie===0?Ew.ceil(je):Ew(je),je=q2.offset(je,(me.V-1)*7),me.y=je.getUTCFullYear(),me.m=je.getUTCMonth(),me.d=je.getUTCDate()+(me.w+6)%7):(je=n3(ag(me.y,0,1)),ie=je.getDay(),je=ie>4||ie===0?_w.ceil(je):_w(je),je=Ox.offset(je,(me.V-1)*7),me.y=je.getFullYear(),me.m=je.getMonth(),me.d=je.getDate()+(me.w+6)%7)}else("W"in me||"U"in me)&&("w"in me||(me.w="u"in me?me.u%7:"W"in me?1:0),ie="Z"in me?s3(ag(me.y,0,1)).getUTCDay():n3(ag(me.y,0,1)).getDay(),me.m=0,me.d="W"in me?(me.w+6)%7+me.W*7-(ie+5)%7:me.w+me.U*7-(ie+6)%7);return"Z"in me?(me.H+=me.Z/100|0,me.M+=me.Z%100,s3(me)):n3(me)}}function I(oe,Se,ke,me){for(var re=0,je=Se.length,ie=ke.length,Re,Ve;re<je;){if(me>=ie)return-1;if(Re=Se.charCodeAt(re++),Re===37){if(Re=Se.charAt(re++),Ve=E[Re in PF?Se.charAt(re++):Re],!Ve||(me=Ve(oe,ke,me))<0)return-1}else if(Re!=ke.charCodeAt(me++))return-1}return me}function P(oe,Se,ke){var me=u.exec(Se.slice(ke));return me?(oe.p=h.get(me[0].toLowerCase()),ke+me[0].length):-1}function $(oe,Se,ke){var me=x.exec(Se.slice(ke));return me?(oe.w=y.get(me[0].toLowerCase()),ke+me[0].length):-1}function R(oe,Se,ke){var me=f.exec(Se.slice(ke));return me?(oe.w=p.get(me[0].toLowerCase()),ke+me[0].length):-1}function F(oe,Se,ke){var me=N.exec(Se.slice(ke));return me?(oe.m=S.get(me[0].toLowerCase()),ke+me[0].length):-1}function W(oe,Se,ke){var me=v.exec(Se.slice(ke));return me?(oe.m=b.get(me[0].toLowerCase()),ke+me[0].length):-1}function q(oe,Se,ke){return I(oe,e,Se,ke)}function X(oe,Se,ke){return I(oe,n,Se,ke)}function z(oe,Se,ke){return I(oe,s,Se,ke)}function K(oe){return i[oe.getDay()]}function H(oe){return a[oe.getDay()]}function Y(oe){return c[oe.getMonth()]}function B(oe){return l[oe.getMonth()]}function O(oe){return r[+(oe.getHours()>=12)]}function U(oe){return 1+~~(oe.getMonth()/3)}function J(oe){return i[oe.getUTCDay()]}function se(oe){return a[oe.getUTCDay()]}function ae(oe){return c[oe.getUTCMonth()]}function fe(oe){return l[oe.getUTCMonth()]}function ye(oe){return r[+(oe.getUTCHours()>=12)]}function Te(oe){return 1+~~(oe.getUTCMonth()/3)}return{format:function(oe){var Se=D(oe+="",k);return Se.toString=function(){return oe},Se},parse:function(oe){var Se=A(oe+="",!1);return Se.toString=function(){return oe},Se},utcFormat:function(oe){var Se=D(oe+="",T);return Se.toString=function(){return oe},Se},utcParse:function(oe){var Se=A(oe+="",!0);return Se.toString=function(){return oe},Se}}}var PF={"-":"",_:" ",0:"0"},Xr=/^\s*\d+/,She=/^%/,jhe=/[\\^$*+?|[\]().{}]/g;function zn(t,e,n){var s=t<0?"-":"",r=(s?-t:t)+"",a=r.length;return s+(a<n?new Array(n-a+1).join(e)+r:r)}function khe(t){return t.replace(jhe,"\\$&")}function ig(t){return new RegExp("^(?:"+t.map(khe).join("|")+")","i")}function og(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function Che(t,e,n){var s=Xr.exec(e.slice(n,n+1));return s?(t.w=+s[0],n+s[0].length):-1}function The(t,e,n){var s=Xr.exec(e.slice(n,n+1));return s?(t.u=+s[0],n+s[0].length):-1}function _he(t,e,n){var s=Xr.exec(e.slice(n,n+2));return s?(t.U=+s[0],n+s[0].length):-1}function Ehe(t,e,n){var s=Xr.exec(e.slice(n,n+2));return s?(t.V=+s[0],n+s[0].length):-1}function Ahe(t,e,n){var s=Xr.exec(e.slice(n,n+2));return s?(t.W=+s[0],n+s[0].length):-1}function LF(t,e,n){var s=Xr.exec(e.slice(n,n+4));return s?(t.y=+s[0],n+s[0].length):-1}function MF(t,e,n){var s=Xr.exec(e.slice(n,n+2));return s?(t.y=+s[0]+(+s[0]>68?1900:2e3),n+s[0].length):-1}function $he(t,e,n){var s=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return s?(t.Z=s[1]?0:-(s[2]+(s[3]||"00")),n+s[0].length):-1}function Ihe(t,e,n){var s=Xr.exec(e.slice(n,n+1));return s?(t.q=s[0]*3-3,n+s[0].length):-1}function Rhe(t,e,n){var s=Xr.exec(e.slice(n,n+2));return s?(t.m=s[0]-1,n+s[0].length):-1}function FF(t,e,n){var s=Xr.exec(e.slice(n,n+2));return s?(t.d=+s[0],n+s[0].length):-1}function Ohe(t,e,n){var s=Xr.exec(e.slice(n,n+3));return s?(t.m=0,t.d=+s[0],n+s[0].length):-1}function zF(t,e,n){var s=Xr.exec(e.slice(n,n+2));return s?(t.H=+s[0],n+s[0].length):-1}function Dhe(t,e,n){var s=Xr.exec(e.slice(n,n+2));return s?(t.M=+s[0],n+s[0].length):-1}function Phe(t,e,n){var s=Xr.exec(e.slice(n,n+2));return s?(t.S=+s[0],n+s[0].length):-1}function Lhe(t,e,n){var s=Xr.exec(e.slice(n,n+3));return s?(t.L=+s[0],n+s[0].length):-1}function Mhe(t,e,n){var s=Xr.exec(e.slice(n,n+6));return s?(t.L=Math.floor(s[0]/1e3),n+s[0].length):-1}function Fhe(t,e,n){var s=She.exec(e.slice(n,n+1));return s?n+s[0].length:-1}function zhe(t,e,n){var s=Xr.exec(e.slice(n));return s?(t.Q=+s[0],n+s[0].length):-1}function Bhe(t,e,n){var s=Xr.exec(e.slice(n));return s?(t.s=+s[0],n+s[0].length):-1}function BF(t,e){return zn(t.getDate(),e,2)}function Uhe(t,e){return zn(t.getHours(),e,2)}function Vhe(t,e){return zn(t.getHours()%12||12,e,2)}function Whe(t,e){return zn(1+Ox.count(Ac(t),t),e,3)}function n9(t,e){return zn(t.getMilliseconds(),e,3)}function Hhe(t,e){return n9(t,e)+"000"}function Ghe(t,e){return zn(t.getMonth()+1,e,2)}function qhe(t,e){return zn(t.getMinutes(),e,2)}function Khe(t,e){return zn(t.getSeconds(),e,2)}function Xhe(t){var e=t.getDay();return e===0?7:e}function Yhe(t,e){return zn(K2.count(Ac(t)-1,t),e,2)}function s9(t){var e=t.getDay();return e>=4||e===0?af(t):af.ceil(t)}function Qhe(t,e){return t=s9(t),zn(af.count(Ac(t),t)+(Ac(t).getDay()===4),e,2)}function Zhe(t){return t.getDay()}function Jhe(t,e){return zn(_w.count(Ac(t)-1,t),e,2)}function eme(t,e){return zn(t.getFullYear()%100,e,2)}function tme(t,e){return t=s9(t),zn(t.getFullYear()%100,e,2)}function nme(t,e){return zn(t.getFullYear()%1e4,e,4)}function sme(t,e){var n=t.getDay();return t=n>=4||n===0?af(t):af.ceil(t),zn(t.getFullYear()%1e4,e,4)}function rme(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+zn(e/60|0,"0",2)+zn(e%60,"0",2)}function UF(t,e){return zn(t.getUTCDate(),e,2)}function ame(t,e){return zn(t.getUTCHours(),e,2)}function ime(t,e){return zn(t.getUTCHours()%12||12,e,2)}function ome(t,e){return zn(1+q2.count($c(t),t),e,3)}function r9(t,e){return zn(t.getUTCMilliseconds(),e,3)}function lme(t,e){return r9(t,e)+"000"}function cme(t,e){return zn(t.getUTCMonth()+1,e,2)}function ume(t,e){return zn(t.getUTCMinutes(),e,2)}function dme(t,e){return zn(t.getUTCSeconds(),e,2)}function hme(t){var e=t.getUTCDay();return e===0?7:e}function mme(t,e){return zn(X2.count($c(t)-1,t),e,2)}function a9(t){var e=t.getUTCDay();return e>=4||e===0?of(t):of.ceil(t)}function fme(t,e){return t=a9(t),zn(of.count($c(t),t)+($c(t).getUTCDay()===4),e,2)}function pme(t){return t.getUTCDay()}function gme(t,e){return zn(Ew.count($c(t)-1,t),e,2)}function xme(t,e){return zn(t.getUTCFullYear()%100,e,2)}function yme(t,e){return t=a9(t),zn(t.getUTCFullYear()%100,e,2)}function bme(t,e){return zn(t.getUTCFullYear()%1e4,e,4)}function vme(t,e){var n=t.getUTCDay();return t=n>=4||n===0?of(t):of.ceil(t),zn(t.getUTCFullYear()%1e4,e,4)}function wme(){return"+0000"}function VF(){return"%"}function WF(t){return+t}function HF(t){return Math.floor(+t/1e3)}var Fm,i9,o9;Nme({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Nme(t){return Fm=Nhe(t),i9=Fm.format,Fm.parse,o9=Fm.utcFormat,Fm.utcParse,Fm}function Sme(t){return new Date(t)}function jme(t){return t instanceof Date?+t:+new Date(+t)}function tA(t,e,n,s,r,a,i,l,c,u){var h=B4(),f=h.invert,p=h.domain,x=u(".%L"),y=u(":%S"),v=u("%I:%M"),b=u("%I %p"),N=u("%a %d"),S=u("%b %d"),k=u("%B"),T=u("%Y");function E(D){return(c(D)<D?x:l(D)<D?y:i(D)<D?v:a(D)<D?b:s(D)<D?r(D)<D?N:S:n(D)<D?k:T)(D)}return h.invert=function(D){return new Date(f(D))},h.domain=function(D){return arguments.length?p(Array.from(D,jme)):p().map(Sme)},h.ticks=function(D){var A=p();return t(A[0],A[A.length-1],D??10)},h.tickFormat=function(D,A){return A==null?E:u(A)},h.nice=function(D){var A=p();return(!D||typeof D.range!="function")&&(D=e(A[0],A[A.length-1],D??10)),D?p(qV(A,D)):h},h.copy=function(){return Rx(h,tA(t,e,n,s,r,a,i,l,c,u))},h}function kme(){return Do.apply(tA(vhe,whe,Ac,J4,K2,Ox,Q4,X4,Zd,i9).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Cme(){return Do.apply(tA(yhe,bhe,$c,eA,X2,q2,Z4,Y4,Zd,o9).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Y2(){var t=0,e=1,n,s,r,a,i=La,l=!1,c;function u(f){return f==null||isNaN(f=+f)?c:i(r===0?.5:(f=(a(f)-n)*r,l?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([t,e]=f,n=a(t=+t),s=a(e=+e),r=n===s?0:1/(s-n),u):[t,e]},u.clamp=function(f){return arguments.length?(l=!!f,u):l},u.interpolator=function(f){return arguments.length?(i=f,u):i};function h(f){return function(p){var x,y;return arguments.length?([x,y]=p,i=f(x,y),u):[i(0),i(1)]}}return u.range=h(Df),u.rangeRound=h(z4),u.unknown=function(f){return arguments.length?(c=f,u):c},function(f){return a=f,n=f(t),s=f(e),r=n===s?0:1/(s-n),u}}function id(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function l9(){var t=ad(Y2()(La));return t.copy=function(){return id(t,l9())},Wc.apply(t,arguments)}function c9(){var t=W4(Y2()).domain([1,10]);return t.copy=function(){return id(t,c9()).base(t.base())},Wc.apply(t,arguments)}function u9(){var t=H4(Y2());return t.copy=function(){return id(t,u9()).constant(t.constant())},Wc.apply(t,arguments)}function nA(){var t=G4(Y2());return t.copy=function(){return id(t,nA()).exponent(t.exponent())},Wc.apply(t,arguments)}function Tme(){return nA.apply(null,arguments).exponent(.5)}function d9(){var t=[],e=La;function n(s){if(s!=null&&!isNaN(s=+s))return e(($x(t,s,1)-1)/(t.length-1))}return n.domain=function(s){if(!arguments.length)return t.slice();t=[];for(let r of s)r!=null&&!isNaN(r=+r)&&t.push(r);return t.sort(zu),n},n.interpolator=function(s){return arguments.length?(e=s,n):e},n.range=function(){return t.map((s,r)=>e(r/(t.length-1)))},n.quantiles=function(s){return Array.from({length:s+1},(r,a)=>hde(t,a/s))},n.copy=function(){return d9(e).domain(t)},Wc.apply(n,arguments)}function Q2(){var t=0,e=.5,n=1,s=1,r,a,i,l,c,u=La,h,f=!1,p;function x(v){return isNaN(v=+v)?p:(v=.5+((v=+h(v))-a)*(s*v<s*a?l:c),u(f?Math.max(0,Math.min(1,v)):v))}x.domain=function(v){return arguments.length?([t,e,n]=v,r=h(t=+t),a=h(e=+e),i=h(n=+n),l=r===a?0:.5/(a-r),c=a===i?0:.5/(i-a),s=a<r?-1:1,x):[t,e,n]},x.clamp=function(v){return arguments.length?(f=!!v,x):f},x.interpolator=function(v){return arguments.length?(u=v,x):u};function y(v){return function(b){var N,S,k;return arguments.length?([N,S,k]=b,u=Fde(v,[N,S,k]),x):[u(0),u(.5),u(1)]}}return x.range=y(Df),x.rangeRound=y(z4),x.unknown=function(v){return arguments.length?(p=v,x):p},function(v){return h=v,r=v(t),a=v(e),i=v(n),l=r===a?0:.5/(a-r),c=a===i?0:.5/(i-a),s=a<r?-1:1,x}}function h9(){var t=ad(Q2()(La));return t.copy=function(){return id(t,h9())},Wc.apply(t,arguments)}function m9(){var t=W4(Q2()).domain([.1,1,10]);return t.copy=function(){return id(t,m9()).base(t.base())},Wc.apply(t,arguments)}function f9(){var t=H4(Q2());return t.copy=function(){return id(t,f9()).constant(t.constant())},Wc.apply(t,arguments)}function sA(){var t=G4(Q2());return t.copy=function(){return id(t,sA()).exponent(t.exponent())},Wc.apply(t,arguments)}function _me(){return sA.apply(null,arguments).exponent(.5)}const yg=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:L4,scaleDiverging:h9,scaleDivergingLog:m9,scaleDivergingPow:sA,scaleDivergingSqrt:_me,scaleDivergingSymlog:f9,scaleIdentity:GV,scaleImplicit:C_,scaleLinear:HV,scaleLog:KV,scaleOrdinal:P4,scalePoint:pde,scalePow:q4,scaleQuantile:QV,scaleQuantize:ZV,scaleRadial:YV,scaleSequential:l9,scaleSequentialLog:c9,scaleSequentialPow:nA,scaleSequentialQuantile:d9,scaleSequentialSqrt:Tme,scaleSequentialSymlog:u9,scaleSqrt:lhe,scaleSymlog:XV,scaleThreshold:JV,scaleTime:kme,scaleUtc:Cme,tickFormat:WV},Symbol.toStringTag,{value:"Module"}));var od=t=>t.chartData,Eme=qe([od],t=>{var e=t.chartData!=null?t.chartData.length-1:0;return{chartData:t.chartData,computedData:t.computedData,dataEndIndex:e,dataStartIndex:0}}),rA=(t,e,n,s)=>s?Eme(t):od(t);function lf(t){if(Array.isArray(t)&&t.length===2){var[e,n]=t;if(Zi(e)&&Zi(n))return!0}return!1}function GF(t,e,n){return n?t:[Math.min(t[0],e[0]),Math.max(t[1],e[1])]}function Ame(t,e){if(e&&typeof t!="function"&&Array.isArray(t)&&t.length===2){var[n,s]=t,r,a;if(Zi(n))r=n;else if(typeof n=="function")return;if(Zi(s))a=s;else if(typeof s=="function")return;var i=[r,a];if(lf(i))return i}}function $me(t,e,n){if(!(!n&&e==null)){if(typeof t=="function"&&e!=null)try{var s=t(e,n);if(lf(s))return GF(s,e,n)}catch{}if(Array.isArray(t)&&t.length===2){var[r,a]=t,i,l;if(r==="auto")e!=null&&(i=Math.min(...e));else if(qt(r))i=r;else if(typeof r=="function")try{e!=null&&(i=r(e==null?void 0:e[0]))}catch{}else if(typeof r=="string"&&PM.test(r)){var c=PM.exec(r);if(c==null||e==null)i=void 0;else{var u=+c[1];i=e[0]-u}}else i=e==null?void 0:e[0];if(a==="auto")e!=null&&(l=Math.max(...e));else if(qt(a))l=a;else if(typeof a=="function")try{e!=null&&(l=a(e==null?void 0:e[1]))}catch{}else if(typeof a=="string"&&LM.test(a)){var h=LM.exec(a);if(h==null||e==null)l=void 0;else{var f=+h[1];l=e[1]+f}}else l=e==null?void 0:e[1];var p=[i,l];if(lf(p))return e==null?p:GF(p,e,n)}}}var Pf=1e9,Ime={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},iA,As=!0,$o="[DecimalError] ",ih=$o+"Invalid argument: ",aA=$o+"Exponent out of range: ",Lf=Math.floor,Fd=Math.pow,Rme=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Fi,Fr=1e7,js=7,p9=9007199254740991,Aw=Lf(p9/js),It={};It.absoluteValue=It.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};It.comparedTo=It.cmp=function(t){var e,n,s,r,a=this;if(t=new a.constructor(t),a.s!==t.s)return a.s||-t.s;if(a.e!==t.e)return a.e>t.e^a.s<0?1:-1;for(s=a.d.length,r=t.d.length,e=0,n=s<r?s:r;e<n;++e)if(a.d[e]!==t.d[e])return a.d[e]>t.d[e]^a.s<0?1:-1;return s===r?0:s>r^a.s<0?1:-1};It.decimalPlaces=It.dp=function(){var t=this,e=t.d.length-1,n=(e-t.e)*js;if(e=t.d[e],e)for(;e%10==0;e/=10)n--;return n<0?0:n};It.dividedBy=It.div=function(t){return kc(this,new this.constructor(t))};It.dividedToIntegerBy=It.idiv=function(t){var e=this,n=e.constructor;return ps(kc(e,new n(t),0,1),n.precision)};It.equals=It.eq=function(t){return!this.cmp(t)};It.exponent=function(){return fr(this)};It.greaterThan=It.gt=function(t){return this.cmp(t)>0};It.greaterThanOrEqualTo=It.gte=function(t){return this.cmp(t)>=0};It.isInteger=It.isint=function(){return this.e>this.d.length-2};It.isNegative=It.isneg=function(){return this.s<0};It.isPositive=It.ispos=function(){return this.s>0};It.isZero=function(){return this.s===0};It.lessThan=It.lt=function(t){return this.cmp(t)<0};It.lessThanOrEqualTo=It.lte=function(t){return this.cmp(t)<1};It.logarithm=It.log=function(t){var e,n=this,s=n.constructor,r=s.precision,a=r+5;if(t===void 0)t=new s(10);else if(t=new s(t),t.s<1||t.eq(Fi))throw Error($o+"NaN");if(n.s<1)throw Error($o+(n.s?"NaN":"-Infinity"));return n.eq(Fi)?new s(0):(As=!1,e=kc(Yg(n,a),Yg(t,a),a),As=!0,ps(e,r))};It.minus=It.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?y9(e,t):g9(e,(t.s=-t.s,t))};It.modulo=It.mod=function(t){var e,n=this,s=n.constructor,r=s.precision;if(t=new s(t),!t.s)throw Error($o+"NaN");return n.s?(As=!1,e=kc(n,t,0,1).times(t),As=!0,n.minus(e)):ps(new s(n),r)};It.naturalExponential=It.exp=function(){return x9(this)};It.naturalLogarithm=It.ln=function(){return Yg(this)};It.negated=It.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};It.plus=It.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?g9(e,t):y9(e,(t.s=-t.s,t))};It.precision=It.sd=function(t){var e,n,s,r=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(ih+t);if(e=fr(r)+1,s=r.d.length-1,n=s*js+1,s=r.d[s],s){for(;s%10==0;s/=10)n--;for(s=r.d[0];s>=10;s/=10)n++}return t&&e>n?e:n};It.squareRoot=It.sqrt=function(){var t,e,n,s,r,a,i,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error($o+"NaN")}for(t=fr(l),As=!1,r=Math.sqrt(+l),r==0||r==1/0?(e=El(l.d),(e.length+t)%2==0&&(e+="0"),r=Math.sqrt(e),t=Lf((t+1)/2)-(t<0||t%2),r==1/0?e="5e"+t:(e=r.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),s=new c(e)):s=new c(r.toString()),n=c.precision,r=i=n+3;;)if(a=s,s=a.plus(kc(l,a,i+2)).times(.5),El(a.d).slice(0,i)===(e=El(s.d)).slice(0,i)){if(e=e.slice(i-3,i+1),r==i&&e=="4999"){if(ps(a,n+1,0),a.times(a).eq(l)){s=a;break}}else if(e!="9999")break;i+=4}return As=!0,ps(s,n)};It.times=It.mul=function(t){var e,n,s,r,a,i,l,c,u,h=this,f=h.constructor,p=h.d,x=(t=new f(t)).d;if(!h.s||!t.s)return new f(0);for(t.s*=h.s,n=h.e+t.e,c=p.length,u=x.length,c<u&&(a=p,p=x,x=a,i=c,c=u,u=i),a=[],i=c+u,s=i;s--;)a.push(0);for(s=u;--s>=0;){for(e=0,r=c+s;r>s;)l=a[r]+x[s]*p[r-s-1]+e,a[r--]=l%Fr|0,e=l/Fr|0;a[r]=(a[r]+e)%Fr|0}for(;!a[--i];)a.pop();return e?++n:a.shift(),t.d=a,t.e=n,As?ps(t,f.precision):t};It.toDecimalPlaces=It.todp=function(t,e){var n=this,s=n.constructor;return n=new s(n),t===void 0?n:(Fl(t,0,Pf),e===void 0?e=s.rounding:Fl(e,0,8),ps(n,t+fr(n)+1,e))};It.toExponential=function(t,e){var n,s=this,r=s.constructor;return t===void 0?n=xh(s,!0):(Fl(t,0,Pf),e===void 0?e=r.rounding:Fl(e,0,8),s=ps(new r(s),t+1,e),n=xh(s,!0,t+1)),n};It.toFixed=function(t,e){var n,s,r=this,a=r.constructor;return t===void 0?xh(r):(Fl(t,0,Pf),e===void 0?e=a.rounding:Fl(e,0,8),s=ps(new a(r),t+fr(r)+1,e),n=xh(s.abs(),!1,t+fr(s)+1),r.isneg()&&!r.isZero()?"-"+n:n)};It.toInteger=It.toint=function(){var t=this,e=t.constructor;return ps(new e(t),fr(t)+1,e.rounding)};It.toNumber=function(){return+this};It.toPower=It.pow=function(t){var e,n,s,r,a,i,l=this,c=l.constructor,u=12,h=+(t=new c(t));if(!t.s)return new c(Fi);if(l=new c(l),!l.s){if(t.s<1)throw Error($o+"Infinity");return l}if(l.eq(Fi))return l;if(s=c.precision,t.eq(Fi))return ps(l,s);if(e=t.e,n=t.d.length-1,i=e>=n,a=l.s,i){if((n=h<0?-h:h)<=p9){for(r=new c(Fi),e=Math.ceil(s/js+4),As=!1;n%2&&(r=r.times(l),KF(r.d,e)),n=Lf(n/2),n!==0;)l=l.times(l),KF(l.d,e);return As=!0,t.s<0?new c(Fi).div(r):ps(r,s)}}else if(a<0)throw Error($o+"NaN");return a=a<0&&t.d[Math.max(e,n)]&1?-1:1,l.s=1,As=!1,r=t.times(Yg(l,s+u)),As=!0,r=x9(r),r.s=a,r};It.toPrecision=function(t,e){var n,s,r=this,a=r.constructor;return t===void 0?(n=fr(r),s=xh(r,n<=a.toExpNeg||n>=a.toExpPos)):(Fl(t,1,Pf),e===void 0?e=a.rounding:Fl(e,0,8),r=ps(new a(r),t,e),n=fr(r),s=xh(r,t<=n||n<=a.toExpNeg,t)),s};It.toSignificantDigits=It.tosd=function(t,e){var n=this,s=n.constructor;return t===void 0?(t=s.precision,e=s.rounding):(Fl(t,1,Pf),e===void 0?e=s.rounding:Fl(e,0,8)),ps(new s(n),t,e)};It.toString=It.valueOf=It.val=It.toJSON=It[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=fr(t),n=t.constructor;return xh(t,e<=n.toExpNeg||e>=n.toExpPos)};function g9(t,e){var n,s,r,a,i,l,c,u,h=t.constructor,f=h.precision;if(!t.s||!e.s)return e.s||(e=new h(t)),As?ps(e,f):e;if(c=t.d,u=e.d,i=t.e,r=e.e,c=c.slice(),a=i-r,a){for(a<0?(s=c,a=-a,l=u.length):(s=u,r=i,l=c.length),i=Math.ceil(f/js),l=i>l?i+1:l+1,a>l&&(a=l,s.length=1),s.reverse();a--;)s.push(0);s.reverse()}for(l=c.length,a=u.length,l-a<0&&(a=l,s=u,u=c,c=s),n=0;a;)n=(c[--a]=c[a]+u[a]+n)/Fr|0,c[a]%=Fr;for(n&&(c.unshift(n),++r),l=c.length;c[--l]==0;)c.pop();return e.d=c,e.e=r,As?ps(e,f):e}function Fl(t,e,n){if(t!==~~t||t<e||t>n)throw Error(ih+t)}function El(t){var e,n,s,r=t.length-1,a="",i=t[0];if(r>0){for(a+=i,e=1;e<r;e++)s=t[e]+"",n=js-s.length,n&&(a+=$u(n)),a+=s;i=t[e],s=i+"",n=js-s.length,n&&(a+=$u(n))}else if(i===0)return"0";for(;i%10===0;)i/=10;return a+i}var kc=(function(){function t(s,r){var a,i=0,l=s.length;for(s=s.slice();l--;)a=s[l]*r+i,s[l]=a%Fr|0,i=a/Fr|0;return i&&s.unshift(i),s}function e(s,r,a,i){var l,c;if(a!=i)c=a>i?1:-1;else for(l=c=0;l<a;l++)if(s[l]!=r[l]){c=s[l]>r[l]?1:-1;break}return c}function n(s,r,a){for(var i=0;a--;)s[a]-=i,i=s[a]<r[a]?1:0,s[a]=i*Fr+s[a]-r[a];for(;!s[0]&&s.length>1;)s.shift()}return function(s,r,a,i){var l,c,u,h,f,p,x,y,v,b,N,S,k,T,E,D,A,I,P=s.constructor,$=s.s==r.s?1:-1,R=s.d,F=r.d;if(!s.s)return new P(s);if(!r.s)throw Error($o+"Division by zero");for(c=s.e-r.e,A=F.length,E=R.length,x=new P($),y=x.d=[],u=0;F[u]==(R[u]||0);)++u;if(F[u]>(R[u]||0)&&--c,a==null?S=a=P.precision:i?S=a+(fr(s)-fr(r))+1:S=a,S<0)return new P(0);if(S=S/js+2|0,u=0,A==1)for(h=0,F=F[0],S++;(u<E||h)&&S--;u++)k=h*Fr+(R[u]||0),y[u]=k/F|0,h=k%F|0;else{for(h=Fr/(F[0]+1)|0,h>1&&(F=t(F,h),R=t(R,h),A=F.length,E=R.length),T=A,v=R.slice(0,A),b=v.length;b<A;)v[b++]=0;I=F.slice(),I.unshift(0),D=F[0],F[1]>=Fr/2&&++D;do h=0,l=e(F,v,A,b),l<0?(N=v[0],A!=b&&(N=N*Fr+(v[1]||0)),h=N/D|0,h>1?(h>=Fr&&(h=Fr-1),f=t(F,h),p=f.length,b=v.length,l=e(f,v,p,b),l==1&&(h--,n(f,A<p?I:F,p))):(h==0&&(l=h=1),f=F.slice()),p=f.length,p<b&&f.unshift(0),n(v,f,b),l==-1&&(b=v.length,l=e(F,v,A,b),l<1&&(h++,n(v,A<b?I:F,b))),b=v.length):l===0&&(h++,v=[0]),y[u++]=h,l&&v[0]?v[b++]=R[T]||0:(v=[R[T]],b=1);while((T++<E||v[0]!==void 0)&&S--)}return y[0]||y.shift(),x.e=c,ps(x,i?a+fr(x)+1:a)}})();function x9(t,e){var n,s,r,a,i,l,c=0,u=0,h=t.constructor,f=h.precision;if(fr(t)>16)throw Error(aA+fr(t));if(!t.s)return new h(Fi);for(As=!1,l=f,i=new h(.03125);t.abs().gte(.1);)t=t.times(i),u+=5;for(s=Math.log(Fd(2,u))/Math.LN10*2+5|0,l+=s,n=r=a=new h(Fi),h.precision=l;;){if(r=ps(r.times(t),l),n=n.times(++c),i=a.plus(kc(r,n,l)),El(i.d).slice(0,l)===El(a.d).slice(0,l)){for(;u--;)a=ps(a.times(a),l);return h.precision=f,e==null?(As=!0,ps(a,f)):a}a=i}}function fr(t){for(var e=t.e*js,n=t.d[0];n>=10;n/=10)e++;return e}function r3(t,e,n){if(e>t.LN10.sd())throw As=!0,n&&(t.precision=n),Error($o+"LN10 precision limit exceeded");return ps(new t(t.LN10),e)}function $u(t){for(var e="";t--;)e+="0";return e}function Yg(t,e){var n,s,r,a,i,l,c,u,h,f=1,p=10,x=t,y=x.d,v=x.constructor,b=v.precision;if(x.s<1)throw Error($o+(x.s?"NaN":"-Infinity"));if(x.eq(Fi))return new v(0);if(e==null?(As=!1,u=b):u=e,x.eq(10))return e==null&&(As=!0),r3(v,u);if(u+=p,v.precision=u,n=El(y),s=n.charAt(0),a=fr(x),Math.abs(a)<15e14){for(;s<7&&s!=1||s==1&&n.charAt(1)>3;)x=x.times(t),n=El(x.d),s=n.charAt(0),f++;a=fr(x),s>1?(x=new v("0."+n),a++):x=new v(s+"."+n.slice(1))}else return c=r3(v,u+2,b).times(a+""),x=Yg(new v(s+"."+n.slice(1)),u-p).plus(c),v.precision=b,e==null?(As=!0,ps(x,b)):x;for(l=i=x=kc(x.minus(Fi),x.plus(Fi),u),h=ps(x.times(x),u),r=3;;){if(i=ps(i.times(h),u),c=l.plus(kc(i,new v(r),u)),El(c.d).slice(0,u)===El(l.d).slice(0,u))return l=l.times(2),a!==0&&(l=l.plus(r3(v,u+2,b).times(a+""))),l=kc(l,new v(f),u),v.precision=b,e==null?(As=!0,ps(l,b)):l;l=c,r+=2}}function qF(t,e){var n,s,r;for((n=e.indexOf("."))>-1&&(e=e.replace(".","")),(s=e.search(/e/i))>0?(n<0&&(n=s),n+=+e.slice(s+1),e=e.substring(0,s)):n<0&&(n=e.length),s=0;e.charCodeAt(s)===48;)++s;for(r=e.length;e.charCodeAt(r-1)===48;)--r;if(e=e.slice(s,r),e){if(r-=s,n=n-s-1,t.e=Lf(n/js),t.d=[],s=(n+1)%js,n<0&&(s+=js),s<r){for(s&&t.d.push(+e.slice(0,s)),r-=js;s<r;)t.d.push(+e.slice(s,s+=js));e=e.slice(s),s=js-e.length}else s-=r;for(;s--;)e+="0";if(t.d.push(+e),As&&(t.e>Aw||t.e<-Aw))throw Error(aA+n)}else t.s=0,t.e=0,t.d=[0];return t}function ps(t,e,n){var s,r,a,i,l,c,u,h,f=t.d;for(i=1,a=f[0];a>=10;a/=10)i++;if(s=e-i,s<0)s+=js,r=e,u=f[h=0];else{if(h=Math.ceil((s+1)/js),a=f.length,h>=a)return t;for(u=a=f[h],i=1;a>=10;a/=10)i++;s%=js,r=s-js+i}if(n!==void 0&&(a=Fd(10,i-r-1),l=u/a%10|0,c=e<0||f[h+1]!==void 0||u%a,c=n<4?(l||c)&&(n==0||n==(t.s<0?3:2)):l>5||l==5&&(n==4||c||n==6&&(s>0?r>0?u/Fd(10,i-r):0:f[h-1])%10&1||n==(t.s<0?8:7))),e<1||!f[0])return c?(a=fr(t),f.length=1,e=e-a-1,f[0]=Fd(10,(js-e%js)%js),t.e=Lf(-e/js)||0):(f.length=1,f[0]=t.e=t.s=0),t;if(s==0?(f.length=h,a=1,h--):(f.length=h+1,a=Fd(10,js-s),f[h]=r>0?(u/Fd(10,i-r)%Fd(10,r)|0)*a:0),c)for(;;)if(h==0){(f[0]+=a)==Fr&&(f[0]=1,++t.e);break}else{if(f[h]+=a,f[h]!=Fr)break;f[h--]=0,a=1}for(s=f.length;f[--s]===0;)f.pop();if(As&&(t.e>Aw||t.e<-Aw))throw Error(aA+fr(t));return t}function y9(t,e){var n,s,r,a,i,l,c,u,h,f,p=t.constructor,x=p.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new p(t),As?ps(e,x):e;if(c=t.d,f=e.d,s=e.e,u=t.e,c=c.slice(),i=u-s,i){for(h=i<0,h?(n=c,i=-i,l=f.length):(n=f,s=u,l=c.length),r=Math.max(Math.ceil(x/js),l)+2,i>r&&(i=r,n.length=1),n.reverse(),r=i;r--;)n.push(0);n.reverse()}else{for(r=c.length,l=f.length,h=r<l,h&&(l=r),r=0;r<l;r++)if(c[r]!=f[r]){h=c[r]<f[r];break}i=0}for(h&&(n=c,c=f,f=n,e.s=-e.s),l=c.length,r=f.length-l;r>0;--r)c[l++]=0;for(r=f.length;r>i;){if(c[--r]<f[r]){for(a=r;a&&c[--a]===0;)c[a]=Fr-1;--c[a],c[r]+=Fr}c[r]-=f[r]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--s;return c[0]?(e.d=c,e.e=s,As?ps(e,x):e):new p(0)}function xh(t,e,n){var s,r=fr(t),a=El(t.d),i=a.length;return e?(n&&(s=n-i)>0?a=a.charAt(0)+"."+a.slice(1)+$u(s):i>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(r<0?"e":"e+")+r):r<0?(a="0."+$u(-r-1)+a,n&&(s=n-i)>0&&(a+=$u(s))):r>=i?(a+=$u(r+1-i),n&&(s=n-r-1)>0&&(a=a+"."+$u(s))):((s=r+1)<i&&(a=a.slice(0,s)+"."+a.slice(s)),n&&(s=n-i)>0&&(r+1===i&&(a+="."),a+=$u(s))),t.s<0?"-"+a:a}function KF(t,e){if(t.length>e)return t.length=e,!0}function b9(t){var e,n,s;function r(a){var i=this;if(!(i instanceof r))return new r(a);if(i.constructor=r,a instanceof r){i.s=a.s,i.e=a.e,i.d=(a=a.d)?a.slice():a;return}if(typeof a=="number"){if(a*0!==0)throw Error(ih+a);if(a>0)i.s=1;else if(a<0)a=-a,i.s=-1;else{i.s=0,i.e=0,i.d=[0];return}if(a===~~a&&a<1e7){i.e=0,i.d=[a];return}return qF(i,a.toString())}else if(typeof a!="string")throw Error(ih+a);if(a.charCodeAt(0)===45?(a=a.slice(1),i.s=-1):i.s=1,Rme.test(a))qF(i,a);else throw Error(ih+a)}if(r.prototype=It,r.ROUND_UP=0,r.ROUND_DOWN=1,r.ROUND_CEIL=2,r.ROUND_FLOOR=3,r.ROUND_HALF_UP=4,r.ROUND_HALF_DOWN=5,r.ROUND_HALF_EVEN=6,r.ROUND_HALF_CEIL=7,r.ROUND_HALF_FLOOR=8,r.clone=b9,r.config=r.set=Ome,t===void 0&&(t={}),t)for(s=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<s.length;)t.hasOwnProperty(n=s[e++])||(t[n]=this[n]);return r.config(t),r}function Ome(t){if(!t||typeof t!="object")throw Error($o+"Object expected");var e,n,s,r=["precision",1,Pf,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<r.length;e+=3)if((s=t[n=r[e]])!==void 0)if(Lf(s)===s&&s>=r[e+1]&&s<=r[e+2])this[n]=s;else throw Error(ih+n+": "+s);if((s=t[n="LN10"])!==void 0)if(s==Math.LN10)this[n]=new this(s);else throw Error(ih+n+": "+s);return this}var iA=b9(Ime);Fi=new iA(1);const Qn=iA;var Dme=t=>t,v9={},w9=t=>t===v9,XF=t=>function e(){return arguments.length===0||arguments.length===1&&w9(arguments.length<=0?void 0:arguments[0])?e:t(...arguments)},N9=(t,e)=>t===1?e:XF(function(){for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];var a=s.filter(i=>i!==v9).length;return a>=t?e(...s):N9(t-a,XF(function(){for(var i=arguments.length,l=new Array(i),c=0;c<i;c++)l[c]=arguments[c];var u=s.map(h=>w9(h)?l.shift():h);return e(...u,...l)}))}),Z2=t=>N9(t.length,t),A_=(t,e)=>{for(var n=[],s=t;s<e;++s)n[s-t]=s;return n},Pme=Z2((t,e)=>Array.isArray(e)?e.map(t):Object.keys(e).map(n=>e[n]).map(t)),Lme=function(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];if(!n.length)return Dme;var r=n.reverse(),a=r[0],i=r.slice(1);return function(){return i.reduce((l,c)=>c(l),a(...arguments))}},$_=t=>Array.isArray(t)?t.reverse():t.split("").reverse().join(""),S9=t=>{var e=null,n=null;return function(){for(var s=arguments.length,r=new Array(s),a=0;a<s;a++)r[a]=arguments[a];return e&&r.every((i,l)=>{var c;return i===((c=e)===null||c===void 0?void 0:c[l])})||(e=r,n=t(...r)),n}};function j9(t){var e;return t===0?e=1:e=Math.floor(new Qn(t).abs().log(10).toNumber())+1,e}function k9(t,e,n){for(var s=new Qn(t),r=0,a=[];s.lt(e)&&r<1e5;)a.push(s.toNumber()),s=s.add(n),r++;return a}Z2((t,e,n)=>{var s=+t,r=+e;return s+n*(r-s)});Z2((t,e,n)=>{var s=e-+t;return s=s||1/0,(n-t)/s});Z2((t,e,n)=>{var s=e-+t;return s=s||1/0,Math.max(0,Math.min(1,(n-t)/s))});var C9=t=>{var[e,n]=t,[s,r]=[e,n];return e>n&&([s,r]=[n,e]),[s,r]},T9=(t,e,n)=>{if(t.lte(0))return new Qn(0);var s=j9(t.toNumber()),r=new Qn(10).pow(s),a=t.div(r),i=s!==1?.05:.1,l=new Qn(Math.ceil(a.div(i).toNumber())).add(n).mul(i),c=l.mul(r);return e?new Qn(c.toNumber()):new Qn(Math.ceil(c.toNumber()))},Mme=(t,e,n)=>{var s=new Qn(1),r=new Qn(t);if(!r.isint()&&n){var a=Math.abs(t);a<1?(s=new Qn(10).pow(j9(t)-1),r=new Qn(Math.floor(r.div(s).toNumber())).mul(s)):a>1&&(r=new Qn(Math.floor(t)))}else t===0?r=new Qn(Math.floor((e-1)/2)):n||(r=new Qn(Math.floor(t)));var i=Math.floor((e-1)/2),l=Lme(Pme(c=>r.add(new Qn(c-i).mul(s)).toNumber()),A_);return l(0,e)},_9=function(e,n,s,r){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((n-e)/(s-1)))return{step:new Qn(0),tickMin:new Qn(0),tickMax:new Qn(0)};var i=T9(new Qn(n).sub(e).div(s-1),r,a),l;e<=0&&n>=0?l=new Qn(0):(l=new Qn(e).add(n).div(2),l=l.sub(new Qn(l).mod(i)));var c=Math.ceil(l.sub(e).div(i).toNumber()),u=Math.ceil(new Qn(n).sub(l).div(i).toNumber()),h=c+u+1;return h>s?_9(e,n,s,r,a+1):(h<s&&(u=n>0?u+(s-h):u,c=n>0?c:c+(s-h)),{step:i,tickMin:l.sub(new Qn(c).mul(i)),tickMax:l.add(new Qn(u).mul(i))})};function Fme(t){var[e,n]=t,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=Math.max(s,2),[i,l]=C9([e,n]);if(i===-1/0||l===1/0){var c=l===1/0?[i,...A_(0,s-1).map(()=>1/0)]:[...A_(0,s-1).map(()=>-1/0),l];return e>n?$_(c):c}if(i===l)return Mme(i,s,r);var{step:u,tickMin:h,tickMax:f}=_9(i,l,a,r,0),p=k9(h,f.add(new Qn(.1).mul(u)),u);return e>n?$_(p):p}function zme(t,e){var[n,s]=t,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[a,i]=C9([n,s]);if(a===-1/0||i===1/0)return[n,s];if(a===i)return[a];var l=Math.max(e,2),c=T9(new Qn(i).sub(a).div(l-1),r,0),u=[...k9(new Qn(a),new Qn(i),c),i];return r===!1&&(u=u.map(h=>Math.round(h))),n>s?$_(u):u}var Bme=S9(Fme),Ume=S9(zme),E9=t=>t.rootProps.maxBarSize,Vme=t=>t.rootProps.barGap,A9=t=>t.rootProps.barCategoryGap,Wme=t=>t.rootProps.barSize,J2=t=>t.rootProps.stackOffset,oA=t=>t.options.chartName,lA=t=>t.rootProps.syncId,$9=t=>t.rootProps.syncMethod,cA=t=>t.options.eventEmitter,gc={allowDuplicatedCategory:!0,angleAxisId:0,reversed:!1,scale:"auto",tick:!0,type:"category"},Li={allowDataOverflow:!1,allowDuplicatedCategory:!0,radiusAxisId:0,scale:"auto",tick:!0,tickCount:5,type:"number"},eN=(t,e)=>{if(!(!t||!e))return t!=null&&t.reversed?[e[1],e[0]]:e},Hme={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:gc.angleAxisId,includeHidden:!1,name:void 0,reversed:gc.reversed,scale:gc.scale,tick:gc.tick,tickCount:void 0,ticks:void 0,type:gc.type,unit:void 0},Gme={allowDataOverflow:Li.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Li.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Li.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Li.scale,tick:Li.tick,tickCount:Li.tickCount,ticks:void 0,type:Li.type,unit:void 0},qme={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:gc.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:gc.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:gc.scale,tick:gc.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},Kme={allowDataOverflow:Li.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Li.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Li.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Li.scale,tick:Li.tick,tickCount:Li.tickCount,ticks:void 0,type:"category",unit:void 0},uA=(t,e)=>t.polarAxis.angleAxis[e]!=null?t.polarAxis.angleAxis[e]:t.layout.layoutType==="radial"?qme:Hme,dA=(t,e)=>t.polarAxis.radiusAxis[e]!=null?t.polarAxis.radiusAxis[e]:t.layout.layoutType==="radial"?Kme:Gme,tN=t=>t.polarOptions,hA=qe([Uc,Vc,Kr],zle),I9=qe([tN,hA],(t,e)=>{if(t!=null)return ol(t.innerRadius,e,0)}),R9=qe([tN,hA],(t,e)=>{if(t!=null)return ol(t.outerRadius,e,e*.8)}),Xme=t=>{if(t==null)return[0,0];var{startAngle:e,endAngle:n}=t;return[e,n]},O9=qe([tN],Xme);qe([uA,O9],eN);var D9=qe([hA,I9,R9],(t,e,n)=>{if(!(t==null||e==null||n==null))return[e,n]});qe([dA,D9],eN);var P9=qe([ts,tN,I9,R9,Uc,Vc],(t,e,n,s,r,a)=>{if(!(t!=="centric"&&t!=="radial"||e==null||n==null||s==null)){var{cx:i,cy:l,startAngle:c,endAngle:u}=e;return{cx:ol(i,r,r/2),cy:ol(l,a,a/2),innerRadius:n,outerRadius:s,startAngle:c,endAngle:u,clockWise:!1}}}),yr=(t,e)=>e,nN=(t,e,n)=>n;function mA(t){return t==null?void 0:t.id}var Rr=t=>{var e=ts(t);return e==="horizontal"?"xAxis":e==="vertical"?"yAxis":e==="centric"?"angleAxis":"radiusAxis"},Mf=t=>t.tooltip.settings.axisId,Yr=t=>{var e=Rr(t),n=Mf(t);return Dx(t,e,n)},L9=qe([Yr],t=>t==null?void 0:t.dataKey);function M9(t,e,n){var{chartData:s=[]}=e,{allowDuplicatedCategory:r,dataKey:a}=n,i=new Map;return t.forEach(l=>{var c,u=(c=l.data)!==null&&c!==void 0?c:s;if(!(u==null||u.length===0)){var h=mA(l);u.forEach((f,p)=>{var x=a==null||r?p:String(Ba(f,a,null)),y=Ba(f,l.dataKey,0),v;i.has(x)?v=i.get(x):v={},Object.assign(v,{[h]:y}),i.set(x,v)})}}),Array.from(i.values())}function sN(t){return t.stackId!=null&&t.dataKey!=null}function YF(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function $w(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?YF(Object(n),!0).forEach(function(s){Yme(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):YF(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function Yme(t,e,n){return(e=Qme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qme(t){var e=Zme(t,"string");return typeof e=="symbol"?e:e+""}function Zme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var I_=[0,"auto"],Oi={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},F9=(t,e)=>t.cartesianAxis.xAxis[e],Hc=(t,e)=>{var n=F9(t,e);return n??Oi},Di={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:I_,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:Ex},z9=(t,e)=>t.cartesianAxis.yAxis[e],Gc=(t,e)=>{var n=z9(t,e);return n??Di},Jme={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},fA=(t,e)=>{var n=t.cartesianAxis.zAxis[e];return n??Jme},wi=(t,e,n)=>{switch(e){case"xAxis":return Hc(t,n);case"yAxis":return Gc(t,n);case"zAxis":return fA(t,n);case"angleAxis":return uA(t,n);case"radiusAxis":return dA(t,n);default:throw new Error("Unexpected axis type: ".concat(e))}},efe=(t,e,n)=>{switch(e){case"xAxis":return Hc(t,n);case"yAxis":return Gc(t,n);default:throw new Error("Unexpected axis type: ".concat(e))}},Dx=(t,e,n)=>{switch(e){case"xAxis":return Hc(t,n);case"yAxis":return Gc(t,n);case"angleAxis":return uA(t,n);case"radiusAxis":return dA(t,n);default:throw new Error("Unexpected axis type: ".concat(e))}},B9=t=>t.graphicalItems.cartesianItems.some(e=>e.type==="bar")||t.graphicalItems.polarItems.some(e=>e.type==="radialBar");function U9(t,e){return n=>{switch(t){case"xAxis":return"xAxisId"in n&&n.xAxisId===e;case"yAxis":return"yAxisId"in n&&n.yAxisId===e;case"zAxis":return"zAxisId"in n&&n.zAxisId===e;case"angleAxis":return"angleAxisId"in n&&n.angleAxisId===e;case"radiusAxis":return"radiusAxisId"in n&&n.radiusAxisId===e;default:return!1}}}var pA=t=>t.graphicalItems.cartesianItems,tfe=qe([yr,nN],U9),V9=(t,e,n)=>t.filter(n).filter(s=>(e==null?void 0:e.includeHidden)===!0?!0:!s.hide),Px=qe([pA,wi,tfe],V9),W9=qe([Px],t=>t.filter(e=>e.type==="area"||e.type==="bar").filter(sN)),H9=t=>t.filter(e=>!("stackId"in e)||e.stackId===void 0),G9=qe([Px],H9),q9=t=>t.map(e=>e.data).filter(Boolean).flat(1),nfe=qe([Px],q9),K9=(t,e)=>{var{chartData:n=[],dataStartIndex:s,dataEndIndex:r}=e;return t.length>0?t:n.slice(s,r+1)},gA=qe([nfe,rA],K9),X9=(t,e,n)=>(e==null?void 0:e.dataKey)!=null?t.map(s=>({value:Ba(s,e.dataKey)})):n.length>0?n.map(s=>s.dataKey).flatMap(s=>t.map(r=>({value:Ba(r,s)}))):t.map(s=>({value:s})),rN=qe([gA,wi,Px],X9);function Y9(t,e){switch(t){case"xAxis":return e.direction==="x";case"yAxis":return e.direction==="y";default:return!1}}function Uh(t){return t.filter(e=>Ml(e)||e instanceof Date).map(Number).filter(e=>Yi(e)===!1)}function sfe(t,e,n){return!n||typeof e!="number"||Yi(e)?[]:n.length?Uh(n.flatMap(s=>{var r=Ba(t,s.dataKey),a,i;if(Array.isArray(r)?[a,i]=r:a=i=r,!(!Zi(a)||!Zi(i)))return[e-a,e+i]})):[]}var rfe=qe([W9,rA,Yr],M9),Q9=(t,e,n)=>{var s={},r=e.reduce((a,i)=>(i.stackId==null||(a[i.stackId]==null&&(a[i.stackId]=[]),a[i.stackId].push(i)),a),s);return Object.fromEntries(Object.entries(r).map(a=>{var[i,l]=a,c=l.map(mA);return[i,{stackedData:nce(t,c,n),graphicalItems:l}]}))},R_=qe([rfe,W9,J2],Q9),Z9=(t,e,n)=>{var{dataStartIndex:s,dataEndIndex:r}=e;if(n!=="zAxis"){var a=oce(t,s,r);if(!(a!=null&&a[0]===0&&a[1]===0))return a}},afe=qe([R_,od,yr],Z9),J9=(t,e,n,s,r)=>n.length>0?t.flatMap(a=>n.flatMap(i=>{var l,c,u=(l=s[i.id])===null||l===void 0?void 0:l.filter(f=>Y9(r,f)),h=Ba(a,(c=e.dataKey)!==null&&c!==void 0?c:i.dataKey);return{value:h,errorDomain:sfe(a,h,u)}})).filter(Boolean):(e==null?void 0:e.dataKey)!=null?t.map(a=>({value:Ba(a,e.dataKey),errorDomain:[]})):t.map(a=>({value:a,errorDomain:[]})),aN=t=>t.errorBars,eW=(t,e,n)=>t.flatMap(s=>e[s.id]).filter(Boolean).filter(s=>Y9(n,s));qe([G9,aN,yr],eW);var ife=qe([gA,wi,G9,aN,yr],J9);function ofe(t){var{value:e}=t;if(Ml(e)||e instanceof Date)return e}var QF=t=>{var e=t.flatMap(s=>[s.value,s.errorDomain]).flat(1),n=Uh(e);if(n.length!==0)return[Math.min(...n),Math.max(...n)]},lfe=(t,e,n)=>{var s=t.map(ofe).filter(r=>r!=null);return n&&(e.dataKey==null||e.allowDuplicatedCategory&&mU(s))?OV(0,t.length):e.allowDuplicatedCategory?s:Array.from(new Set(s))},xA=t=>{var e;if(t==null||!("domain"in t))return I_;if(t.domain!=null)return t.domain;if(t.ticks!=null){if(t.type==="number"){var n=Uh(t.ticks);return[Math.min(...n),Math.max(...n)]}if(t.type==="category")return t.ticks.map(String)}return(e=t==null?void 0:t.domain)!==null&&e!==void 0?e:I_},Iw=function(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];var r=n.filter(Boolean);if(r.length!==0){var a=r.flat(),i=Math.min(...a),l=Math.max(...a);return[i,l]}},tW=t=>t.referenceElements.dots,Ff=(t,e,n)=>t.filter(s=>s.ifOverflow==="extendDomain").filter(s=>e==="xAxis"?s.xAxisId===n:s.yAxisId===n),cfe=qe([tW,yr,nN],Ff),nW=t=>t.referenceElements.areas,ufe=qe([nW,yr,nN],Ff),sW=t=>t.referenceElements.lines,dfe=qe([sW,yr,nN],Ff),rW=(t,e)=>{var n=Uh(t.map(s=>e==="xAxis"?s.x:s.y));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},hfe=qe(cfe,yr,rW),aW=(t,e)=>{var n=Uh(t.flatMap(s=>[e==="xAxis"?s.x1:s.y1,e==="xAxis"?s.x2:s.y2]));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},mfe=qe([ufe,yr],aW),iW=(t,e)=>{var n=Uh(t.map(s=>e==="xAxis"?s.x:s.y));if(n.length!==0)return[Math.min(...n),Math.max(...n)]},ffe=qe(dfe,yr,iW),pfe=qe(hfe,ffe,mfe,(t,e,n)=>Iw(t,n,e)),gfe=qe([wi],xA),oW=(t,e,n,s,r,a,i)=>{var l=Ame(e,t.allowDataOverflow);if(l!=null)return l;var c=a==="vertical"&&i==="xAxis"||a==="horizontal"&&i==="yAxis",u=c?Iw(n,r,QF(s)):Iw(r,QF(s));return $me(e,u,t.allowDataOverflow)},xfe=qe([wi,gfe,afe,ife,pfe,ts,yr],oW),yfe=[0,1],lW=(t,e,n,s,r,a,i)=>{if(!((t==null||n==null||n.length===0)&&i===void 0)){var{dataKey:l,type:c}=t,u=Fh(e,a);return u&&l==null?OV(0,n.length):c==="category"?lfe(s,t,u):r==="expand"?yfe:i}},yA=qe([wi,ts,gA,rN,J2,yr,xfe],lW),cW=(t,e,n,s,r)=>{if(t!=null){var{scale:a,type:i}=t;if(a==="auto")return e==="radial"&&r==="radiusAxis"?"band":e==="radial"&&r==="angleAxis"?"linear":i==="category"&&s&&(s.indexOf("LineChart")>=0||s.indexOf("AreaChart")>=0||s.indexOf("ComposedChart")>=0&&!n)?"point":i==="category"?"band":"linear";if(typeof a=="string"){var l="scale".concat(Cx(a));return l in yg?l:"point"}}},Lx=qe([wi,ts,B9,oA,yr],cW);function bfe(t){if(t!=null){if(t in yg)return yg[t]();var e="scale".concat(Cx(t));if(e in yg)return yg[e]()}}function bA(t,e,n,s){if(!(n==null||s==null)){if(typeof t.scale=="function")return t.scale.copy().domain(n).range(s);var r=bfe(e);if(r!=null){var a=r.domain(n).range(s);return Qle(a),a}}}var uW=(t,e,n)=>{var s=xA(e);if(!(n!=="auto"&&n!=="linear")){if(e!=null&&e.tickCount&&Array.isArray(s)&&(s[0]==="auto"||s[1]==="auto")&&lf(t))return Bme(t,e.tickCount,e.allowDecimals);if(e!=null&&e.tickCount&&e.type==="number"&&lf(t))return Ume(t,e.tickCount,e.allowDecimals)}},vA=qe([yA,Dx,Lx],uW),dW=(t,e,n,s)=>{if(s!=="angleAxis"&&(t==null?void 0:t.type)==="number"&&lf(e)&&Array.isArray(n)&&n.length>0){var r=e[0],a=n[0],i=e[1],l=n[n.length-1];return[Math.min(r,a),Math.max(i,l)]}return e},vfe=qe([wi,yA,vA,yr],dW),wfe=qe(rN,wi,(t,e)=>{if(!(!e||e.type!=="number")){var n=1/0,s=Array.from(Uh(t.map(l=>l.value))).sort((l,c)=>l-c);if(s.length<2)return 1/0;var r=s[s.length-1]-s[0];if(r===0)return 1/0;for(var a=0;a<s.length-1;a++){var i=s[a+1]-s[a];n=Math.min(n,i)}return n/r}}),hW=qe(wfe,ts,A9,Kr,(t,e,n,s)=>s,(t,e,n,s,r)=>{if(!Zi(t))return 0;var a=e==="vertical"?s.height:s.width;if(r==="gap")return t*a/2;if(r==="no-gap"){var i=ol(n,t*a),l=t*a/2;return l-i-(l-i)/a*i}return 0}),Nfe=(t,e)=>{var n=Hc(t,e);return n==null||typeof n.padding!="string"?0:hW(t,"xAxis",e,n.padding)},Sfe=(t,e)=>{var n=Gc(t,e);return n==null||typeof n.padding!="string"?0:hW(t,"yAxis",e,n.padding)},jfe=qe(Hc,Nfe,(t,e)=>{var n,s;if(t==null)return{left:0,right:0};var{padding:r}=t;return typeof r=="string"?{left:e,right:e}:{left:((n=r.left)!==null&&n!==void 0?n:0)+e,right:((s=r.right)!==null&&s!==void 0?s:0)+e}}),kfe=qe(Gc,Sfe,(t,e)=>{var n,s;if(t==null)return{top:0,bottom:0};var{padding:r}=t;return typeof r=="string"?{top:e,bottom:e}:{top:((n=r.top)!==null&&n!==void 0?n:0)+e,bottom:((s=r.bottom)!==null&&s!==void 0?s:0)+e}}),Cfe=qe([Kr,jfe,H2,W2,(t,e,n)=>n],(t,e,n,s,r)=>{var{padding:a}=s;return r?[a.left,n.width-a.right]:[t.left+e.left,t.left+t.width-e.right]}),Tfe=qe([Kr,ts,kfe,H2,W2,(t,e,n)=>n],(t,e,n,s,r,a)=>{var{padding:i}=r;return a?[s.height-i.bottom,i.top]:e==="horizontal"?[t.top+t.height-n.bottom,t.top+n.top]:[t.top+n.top,t.top+t.height-n.bottom]}),Mx=(t,e,n,s)=>{var r;switch(e){case"xAxis":return Cfe(t,n,s);case"yAxis":return Tfe(t,n,s);case"zAxis":return(r=fA(t,n))===null||r===void 0?void 0:r.range;case"angleAxis":return O9(t);case"radiusAxis":return D9(t,n);default:return}},mW=qe([wi,Mx],eN),zf=qe([wi,Lx,vfe,mW],bA);qe([Px,aN,yr],eW);function fW(t,e){return t.id<e.id?-1:t.id>e.id?1:0}var iN=(t,e)=>e,oN=(t,e,n)=>n,_fe=qe(U2,iN,oN,(t,e,n)=>t.filter(s=>s.orientation===e).filter(s=>s.mirror===n).sort(fW)),Efe=qe(V2,iN,oN,(t,e,n)=>t.filter(s=>s.orientation===e).filter(s=>s.mirror===n).sort(fW)),pW=(t,e)=>({width:t.width,height:e.height}),Afe=(t,e)=>{var n=typeof e.width=="number"?e.width:Ex;return{width:n,height:t.height}},gW=qe(Kr,Hc,pW),$fe=(t,e,n)=>{switch(e){case"top":return t.top;case"bottom":return n-t.bottom;default:return 0}},Ife=(t,e,n)=>{switch(e){case"left":return t.left;case"right":return n-t.right;default:return 0}},Rfe=qe(Vc,Kr,_fe,iN,oN,(t,e,n,s,r)=>{var a={},i;return n.forEach(l=>{var c=pW(e,l);i==null&&(i=$fe(e,s,t));var u=s==="top"&&!r||s==="bottom"&&r;a[l.id]=i-Number(u)*c.height,i+=(u?-1:1)*c.height}),a}),Ofe=qe(Uc,Kr,Efe,iN,oN,(t,e,n,s,r)=>{var a={},i;return n.forEach(l=>{var c=Afe(e,l);i==null&&(i=Ife(e,s,t));var u=s==="left"&&!r||s==="right"&&r;a[l.id]=i-Number(u)*c.width,i+=(u?-1:1)*c.width}),a}),Dfe=(t,e)=>{var n=Hc(t,e);if(n!=null)return Rfe(t,n.orientation,n.mirror)},Pfe=qe([Kr,Hc,Dfe,(t,e)=>e],(t,e,n,s)=>{if(e!=null){var r=n==null?void 0:n[s];return r==null?{x:t.left,y:0}:{x:t.left,y:r}}}),Lfe=(t,e)=>{var n=Gc(t,e);if(n!=null)return Ofe(t,n.orientation,n.mirror)},Mfe=qe([Kr,Gc,Lfe,(t,e)=>e],(t,e,n,s)=>{if(e!=null){var r=n==null?void 0:n[s];return r==null?{x:0,y:t.top}:{x:r,y:t.top}}}),xW=qe(Kr,Gc,(t,e)=>{var n=typeof e.width=="number"?e.width:Ex;return{width:n,height:t.height}}),ZF=(t,e,n)=>{switch(e){case"xAxis":return gW(t,n).width;case"yAxis":return xW(t,n).height;default:return}},yW=(t,e,n,s)=>{if(n!=null){var{allowDuplicatedCategory:r,type:a,dataKey:i}=n,l=Fh(t,s),c=e.map(u=>u.value);if(i&&l&&a==="category"&&r&&mU(c))return c}},wA=qe([ts,rN,wi,yr],yW),bW=(t,e,n,s)=>{if(!(n==null||n.dataKey==null)){var{type:r,scale:a}=n,i=Fh(t,s);if(i&&(r==="number"||a!=="auto"))return e.map(l=>l.value)}},NA=qe([ts,rN,Dx,yr],bW),JF=qe([ts,efe,Lx,zf,wA,NA,Mx,vA,yr],(t,e,n,s,r,a,i,l,c)=>{if(e==null)return null;var u=Fh(t,c);return{angle:e.angle,interval:e.interval,minTickGap:e.minTickGap,orientation:e.orientation,tick:e.tick,tickCount:e.tickCount,tickFormatter:e.tickFormatter,ticks:e.ticks,type:e.type,unit:e.unit,axisType:c,categoricalDomain:a,duplicateDomain:r,isCategorical:u,niceTicks:l,range:i,realScaleType:n,scale:s}}),Ffe=(t,e,n,s,r,a,i,l,c)=>{if(!(e==null||s==null)){var u=Fh(t,c),{type:h,ticks:f,tickCount:p}=e,x=n==="scaleBand"&&typeof s.bandwidth=="function"?s.bandwidth()/2:2,y=h==="category"&&s.bandwidth?s.bandwidth()/x:0;y=c==="angleAxis"&&a!=null&&a.length>=2?di(a[0]-a[1])*2*y:y;var v=f||r;if(v){var b=v.map((N,S)=>{var k=i?i.indexOf(N):N;return{index:S,coordinate:s(k)+y,value:N,offset:y}});return b.filter(N=>!Yi(N.coordinate))}return u&&l?l.map((N,S)=>({coordinate:s(N)+y,value:N,index:S,offset:y})):s.ticks?s.ticks(p).map(N=>({coordinate:s(N)+y,value:N,offset:y})):s.domain().map((N,S)=>({coordinate:s(N)+y,value:i?i[N]:N,index:S,offset:y}))}},vW=qe([ts,Dx,Lx,zf,vA,Mx,wA,NA,yr],Ffe),zfe=(t,e,n,s,r,a,i)=>{if(!(e==null||n==null||s==null||s[0]===s[1])){var l=Fh(t,i),{tickCount:c}=e,u=0;return u=i==="angleAxis"&&(s==null?void 0:s.length)>=2?di(s[0]-s[1])*2*u:u,l&&a?a.map((h,f)=>({coordinate:n(h)+u,value:h,index:f,offset:u})):n.ticks?n.ticks(c).map(h=>({coordinate:n(h)+u,value:h,offset:u})):n.domain().map((h,f)=>({coordinate:n(h)+u,value:r?r[h]:h,index:f,offset:u}))}},cf=qe([ts,Dx,zf,Mx,wA,NA,yr],zfe),uf=qe(wi,zf,(t,e)=>{if(!(t==null||e==null))return $w($w({},t),{},{scale:e})}),Bfe=qe([wi,Lx,yA,mW],bA);qe((t,e,n)=>fA(t,n),Bfe,(t,e)=>{if(!(t==null||e==null))return $w($w({},t),{},{scale:e})});var Ufe=qe([ts,U2,V2],(t,e,n)=>{switch(t){case"horizontal":return e.some(s=>s.reversed)?"right-to-left":"left-to-right";case"vertical":return n.some(s=>s.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),wW=t=>t.options.defaultTooltipEventType,NW=t=>t.options.validateTooltipEventTypes;function SW(t,e,n){if(t==null)return e;var s=t?"axis":"item";return n==null?e:n.includes(s)?s:e}function SA(t,e){var n=wW(t),s=NW(t);return SW(e,n,s)}function Vfe(t){return Gt(e=>SA(e,t))}var jW=(t,e)=>{var n,s=Number(e);if(!(Yi(s)||e==null))return s>=0?t==null||(n=t[s])===null||n===void 0?void 0:n.value:void 0},Wfe=t=>t.tooltip.settings,Ou={active:!1,index:null,dataKey:void 0,coordinate:void 0},Hfe={itemInteraction:{click:Ou,hover:Ou},axisInteraction:{click:Ou,hover:Ou},keyboardInteraction:Ou,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},kW=no({name:"tooltip",initialState:Hfe,reducers:{addTooltipEntrySettings(t,e){t.tooltipItemPayloads.push(e.payload)},removeTooltipEntrySettings(t,e){var n=jc(t).tooltipItemPayloads.indexOf(e.payload);n>-1&&t.tooltipItemPayloads.splice(n,1)},setTooltipSettingsState(t,e){t.settings=e.payload},setActiveMouseOverItemIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.itemInteraction.hover.active=!0,t.itemInteraction.hover.index=e.payload.activeIndex,t.itemInteraction.hover.dataKey=e.payload.activeDataKey,t.itemInteraction.hover.coordinate=e.payload.activeCoordinate},mouseLeaveChart(t){t.itemInteraction.hover.active=!1,t.axisInteraction.hover.active=!1},mouseLeaveItem(t){t.itemInteraction.hover.active=!1},setActiveClickItemIndex(t,e){t.syncInteraction.active=!1,t.itemInteraction.click.active=!0,t.keyboardInteraction.active=!1,t.itemInteraction.click.index=e.payload.activeIndex,t.itemInteraction.click.dataKey=e.payload.activeDataKey,t.itemInteraction.click.coordinate=e.payload.activeCoordinate},setMouseOverAxisIndex(t,e){t.syncInteraction.active=!1,t.axisInteraction.hover.active=!0,t.keyboardInteraction.active=!1,t.axisInteraction.hover.index=e.payload.activeIndex,t.axisInteraction.hover.dataKey=e.payload.activeDataKey,t.axisInteraction.hover.coordinate=e.payload.activeCoordinate},setMouseClickAxisIndex(t,e){t.syncInteraction.active=!1,t.keyboardInteraction.active=!1,t.axisInteraction.click.active=!0,t.axisInteraction.click.index=e.payload.activeIndex,t.axisInteraction.click.dataKey=e.payload.activeDataKey,t.axisInteraction.click.coordinate=e.payload.activeCoordinate},setSyncInteraction(t,e){t.syncInteraction=e.payload},setKeyboardInteraction(t,e){t.keyboardInteraction.active=e.payload.active,t.keyboardInteraction.index=e.payload.activeIndex,t.keyboardInteraction.coordinate=e.payload.activeCoordinate,t.keyboardInteraction.dataKey=e.payload.activeDataKey}}}),{addTooltipEntrySettings:Gfe,removeTooltipEntrySettings:qfe,setTooltipSettingsState:Kfe,setActiveMouseOverItemIndex:CW,mouseLeaveItem:Xfe,mouseLeaveChart:TW,setActiveClickItemIndex:Yfe,setMouseOverAxisIndex:_W,setMouseClickAxisIndex:Qfe,setSyncInteraction:O_,setKeyboardInteraction:D_}=kW.actions,Zfe=kW.reducer;function ez(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function r1(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ez(Object(n),!0).forEach(function(s){Jfe(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ez(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function Jfe(t,e,n){return(e=epe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function epe(t){var e=tpe(t,"string");return typeof e=="symbol"?e:e+""}function tpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function npe(t,e,n){return e==="axis"?n==="click"?t.axisInteraction.click:t.axisInteraction.hover:n==="click"?t.itemInteraction.click:t.itemInteraction.hover}function spe(t){return t.index!=null}var EW=(t,e,n,s)=>{if(e==null)return Ou;var r=npe(t,e,n);if(r==null)return Ou;if(r.active)return r;if(t.keyboardInteraction.active)return t.keyboardInteraction;if(t.syncInteraction.active&&t.syncInteraction.index!=null)return t.syncInteraction;var a=t.settings.active===!0;if(spe(r)){if(a)return r1(r1({},r),{},{active:!0})}else if(s!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:s};return r1(r1({},Ou),{},{coordinate:r.coordinate})},jA=(t,e)=>{var n=t==null?void 0:t.index;if(n==null)return null;var s=Number(n);if(!Zi(s))return n;var r=0,a=1/0;return e.length>0&&(a=e.length-1),String(Math.max(r,Math.min(s,a)))},AW=(t,e,n,s,r,a,i,l)=>{if(!(a==null||l==null)){var c=i[0],u=c==null?void 0:l(c.positions,a);if(u!=null)return u;var h=r==null?void 0:r[Number(a)];if(h)switch(n){case"horizontal":return{x:h.coordinate,y:(s.top+e)/2};default:return{x:(s.left+t)/2,y:h.coordinate}}}},$W=(t,e,n,s)=>{if(e==="axis")return t.tooltipItemPayloads;if(t.tooltipItemPayloads.length===0)return[];var r;return n==="hover"?r=t.itemInteraction.hover.dataKey:r=t.itemInteraction.click.dataKey,r==null&&s!=null?[t.tooltipItemPayloads[0]]:t.tooltipItemPayloads.filter(a=>{var i;return((i=a.settings)===null||i===void 0?void 0:i.dataKey)===r})},Fx=t=>t.options.tooltipPayloadSearcher,Bf=t=>t.tooltip;function tz(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function nz(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?tz(Object(n),!0).forEach(function(s){rpe(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):tz(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function rpe(t,e,n){return(e=ape(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ape(t){var e=ipe(t,"string");return typeof e=="symbol"?e:e+""}function ipe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ope(t,e){return t??e}var IW=(t,e,n,s,r,a,i)=>{if(!(e==null||a==null)){var{chartData:l,computedData:c,dataStartIndex:u,dataEndIndex:h}=n,f=[];return t.reduce((p,x)=>{var y,{dataDefinedOnItem:v,settings:b}=x,N=ope(v,l),S=Array.isArray(N)?yV(N,u,h):N,k=(y=b==null?void 0:b.dataKey)!==null&&y!==void 0?y:s,T=b==null?void 0:b.nameKey,E;if(s&&Array.isArray(S)&&!Array.isArray(S[0])&&i==="axis"?E=Mae(S,s,r):E=a(S,e,c,T),Array.isArray(E))E.forEach(A=>{var I=nz(nz({},b),{},{name:A.name,unit:A.unit,color:void 0,fill:void 0});p.push(MM({tooltipEntrySettings:I,dataKey:A.dataKey,payload:A.payload,value:Ba(A.payload,A.dataKey),name:A.name}))});else{var D;p.push(MM({tooltipEntrySettings:b,dataKey:k,payload:E,value:Ba(E,k),name:(D=Ba(E,T))!==null&&D!==void 0?D:b==null?void 0:b.name}))}return p},f)}},kA=qe([Yr,ts,B9,oA,Rr],cW),lpe=qe([t=>t.graphicalItems.cartesianItems,t=>t.graphicalItems.polarItems],(t,e)=>[...t,...e]),cpe=qe([Rr,Mf],U9),zx=qe([lpe,Yr,cpe],V9),upe=qe([zx],t=>t.filter(sN)),dpe=qe([zx],q9),Uf=qe([dpe,od],K9),hpe=qe([upe,od,Yr],M9),CA=qe([Uf,Yr,zx],X9),mpe=qe([Yr],xA),fpe=qe([zx],t=>t.filter(sN)),ppe=qe([hpe,fpe,J2],Q9),gpe=qe([ppe,od,Rr],Z9),xpe=qe([zx],H9),ype=qe([Uf,Yr,xpe,aN,Rr],J9),bpe=qe([tW,Rr,Mf],Ff),vpe=qe([bpe,Rr],rW),wpe=qe([nW,Rr,Mf],Ff),Npe=qe([wpe,Rr],aW),Spe=qe([sW,Rr,Mf],Ff),jpe=qe([Spe,Rr],iW),kpe=qe([vpe,jpe,Npe],Iw),Cpe=qe([Yr,mpe,gpe,ype,kpe,ts,Rr],oW),RW=qe([Yr,ts,Uf,CA,J2,Rr,Cpe],lW),Tpe=qe([RW,Yr,kA],uW),_pe=qe([Yr,RW,Tpe,Rr],dW),OW=t=>{var e=Rr(t),n=Mf(t),s=!1;return Mx(t,e,n,s)},DW=qe([Yr,OW],eN),PW=qe([Yr,kA,_pe,DW],bA),Epe=qe([ts,CA,Yr,Rr],yW),Ape=qe([ts,CA,Yr,Rr],bW),$pe=(t,e,n,s,r,a,i,l)=>{if(e){var{type:c}=e,u=Fh(t,l);if(s){var h=n==="scaleBand"&&s.bandwidth?s.bandwidth()/2:2,f=c==="category"&&s.bandwidth?s.bandwidth()/h:0;return f=l==="angleAxis"&&r!=null&&(r==null?void 0:r.length)>=2?di(r[0]-r[1])*2*f:f,u&&i?i.map((p,x)=>({coordinate:s(p)+f,value:p,index:x,offset:f})):s.domain().map((p,x)=>({coordinate:s(p)+f,value:a?a[p]:p,index:x,offset:f}))}}},qc=qe([ts,Yr,kA,PW,OW,Epe,Ape,Rr],$pe),TA=qe([wW,NW,Wfe],(t,e,n)=>SW(n.shared,t,e)),LW=t=>t.tooltip.settings.trigger,_A=t=>t.tooltip.settings.defaultIndex,lN=qe([Bf,TA,LW,_A],EW),df=qe([lN,Uf],jA),MW=qe([qc,df],jW),FW=qe([lN],t=>{if(t)return t.dataKey}),zW=qe([Bf,TA,LW,_A],$W),Ipe=qe([Uc,Vc,ts,Kr,qc,_A,zW,Fx],AW),Rpe=qe([lN,Ipe],(t,e)=>t!=null&&t.coordinate?t.coordinate:e),Ope=qe([lN],t=>t.active),Dpe=qe([zW,df,od,L9,MW,Fx,TA],IW);qe([Dpe],t=>{if(t!=null){var e=t.map(n=>n.payload).filter(n=>n!=null);return Array.from(new Set(e))}});function sz(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function rz(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?sz(Object(n),!0).forEach(function(s){Ppe(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):sz(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function Ppe(t,e,n){return(e=Lpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Lpe(t){var e=Mpe(t,"string");return typeof e=="symbol"?e:e+""}function Mpe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Fpe=()=>Gt(Yr),zpe=()=>{var t=Fpe(),e=Gt(qc),n=Gt(PW);return C4(rz(rz({},t),{},{scale:n}),e)},Bpe=()=>Gt(oA),EA=(t,e)=>e,BW=(t,e,n)=>n,AA=(t,e,n,s)=>s,Upe=qe(qc,t=>P2(t,e=>e.coordinate)),$A=qe([Bf,EA,BW,AA],EW),UW=qe([$A,Uf],jA),Vpe=(t,e,n)=>{if(e!=null){var s=Bf(t);return e==="axis"?n==="hover"?s.axisInteraction.hover.dataKey:s.axisInteraction.click.dataKey:n==="hover"?s.itemInteraction.hover.dataKey:s.itemInteraction.click.dataKey}},VW=qe([Bf,EA,BW,AA],$W),Rw=qe([Uc,Vc,ts,Kr,qc,AA,VW,Fx],AW),Wpe=qe([$A,Rw],(t,e)=>{var n;return(n=t.coordinate)!==null&&n!==void 0?n:e}),WW=qe(qc,UW,jW),Hpe=qe([VW,UW,od,L9,WW,Fx,EA],IW),Gpe=qe([$A],t=>({isActive:t.active,activeIndex:t.index})),qpe=(t,e,n,s,r,a,i,l)=>{if(!(!t||!e||!s||!r||!a)){var c=lce(t.chartX,t.chartY,e,n,l);if(c){var u=uce(c,e),h=Xle(u,i,a,s,r),f=cce(e,a,h,c);return{activeIndex:String(h),activeCoordinate:f}}}};function P_(){return P_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},P_.apply(null,arguments)}function az(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function a1(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?az(Object(n),!0).forEach(function(s){Kpe(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):az(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function Kpe(t,e,n){return(e=Xpe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Xpe(t){var e=Ype(t,"string");return typeof e=="symbol"?e:e+""}function Ype(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Qpe(t){var{coordinate:e,payload:n,index:s,offset:r,tooltipAxisBandSize:a,layout:i,cursor:l,tooltipEventType:c,chartName:u}=t,h=e,f=n,p=s;if(!l||!h||u!=="ScatterChart"&&c!=="axis")return null;var x,y;if(u==="ScatterChart")x=h,y=pue;else if(u==="BarChart")x=gue(i,h,r,a),y=AV;else if(i==="radial"){var{cx:v,cy:b,radius:N,startAngle:S,endAngle:k}=$V(h);x={cx:v,cy:b,startAngle:S,endAngle:k,innerRadius:N,outerRadius:N},y=RV}else x={points:Xue(i,h,r)},y=iue;var T=typeof l=="object"&&"className"in l?l.className:void 0,E=a1(a1(a1(a1({stroke:"#ccc",pointerEvents:"none"},r),x),ha(l,!1)),{},{payload:f,payloadIndex:p,className:Dn("recharts-tooltip-cursor",T)});return j.isValidElement(l)?j.cloneElement(l,E):j.createElement(y,E)}function Zpe(t){var e=zpe(),n=SV(),s=$4(),r=Bpe();return j.createElement(Qpe,P_({},t,{coordinate:t.coordinate,index:t.index,payload:t.payload,offset:n,layout:s,tooltipAxisBandSize:e,chartName:r}))}var HW=j.createContext(null),Jpe=()=>j.useContext(HW),a3={exports:{}},iz;function e0e(){return iz||(iz=1,(function(t){var e=Object.prototype.hasOwnProperty,n="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(n=!1));function r(c,u,h){this.fn=c,this.context=u,this.once=h||!1}function a(c,u,h,f,p){if(typeof h!="function")throw new TypeError("The listener must be a function");var x=new r(h,f||c,p),y=n?n+u:u;return c._events[y]?c._events[y].fn?c._events[y]=[c._events[y],x]:c._events[y].push(x):(c._events[y]=x,c._eventsCount++),c}function i(c,u){--c._eventsCount===0?c._events=new s:delete c._events[u]}function l(){this._events=new s,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],h,f;if(this._eventsCount===0)return u;for(f in h=this._events)e.call(h,f)&&u.push(n?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(h)):u},l.prototype.listeners=function(u){var h=n?n+u:u,f=this._events[h];if(!f)return[];if(f.fn)return[f.fn];for(var p=0,x=f.length,y=new Array(x);p<x;p++)y[p]=f[p].fn;return y},l.prototype.listenerCount=function(u){var h=n?n+u:u,f=this._events[h];return f?f.fn?1:f.length:0},l.prototype.emit=function(u,h,f,p,x,y){var v=n?n+u:u;if(!this._events[v])return!1;var b=this._events[v],N=arguments.length,S,k;if(b.fn){switch(b.once&&this.removeListener(u,b.fn,void 0,!0),N){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,h),!0;case 3:return b.fn.call(b.context,h,f),!0;case 4:return b.fn.call(b.context,h,f,p),!0;case 5:return b.fn.call(b.context,h,f,p,x),!0;case 6:return b.fn.call(b.context,h,f,p,x,y),!0}for(k=1,S=new Array(N-1);k<N;k++)S[k-1]=arguments[k];b.fn.apply(b.context,S)}else{var T=b.length,E;for(k=0;k<T;k++)switch(b[k].once&&this.removeListener(u,b[k].fn,void 0,!0),N){case 1:b[k].fn.call(b[k].context);break;case 2:b[k].fn.call(b[k].context,h);break;case 3:b[k].fn.call(b[k].context,h,f);break;case 4:b[k].fn.call(b[k].context,h,f,p);break;default:if(!S)for(E=1,S=new Array(N-1);E<N;E++)S[E-1]=arguments[E];b[k].fn.apply(b[k].context,S)}}return!0},l.prototype.on=function(u,h,f){return a(this,u,h,f,!1)},l.prototype.once=function(u,h,f){return a(this,u,h,f,!0)},l.prototype.removeListener=function(u,h,f,p){var x=n?n+u:u;if(!this._events[x])return this;if(!h)return i(this,x),this;var y=this._events[x];if(y.fn)y.fn===h&&(!p||y.once)&&(!f||y.context===f)&&i(this,x);else{for(var v=0,b=[],N=y.length;v<N;v++)(y[v].fn!==h||p&&!y[v].once||f&&y[v].context!==f)&&b.push(y[v]);b.length?this._events[x]=b.length===1?b[0]:b:i(this,x)}return this},l.prototype.removeAllListeners=function(u){var h;return u?(h=n?n+u:u,this._events[h]&&i(this,h)):(this._events=new s,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=n,l.EventEmitter=l,t.exports=l})(a3)),a3.exports}var t0e=e0e();const n0e=Hl(t0e);var Qg=new n0e,L_="recharts.syncEvent.tooltip",oz="recharts.syncEvent.brush";function s0e(t,e){if(e){var n=Number.parseInt(e,10);if(!Yi(n))return t==null?void 0:t[n]}}var r0e={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},GW=no({name:"options",initialState:r0e,reducers:{createEventEmitter:t=>{t.eventEmitter==null&&(t.eventEmitter=Symbol("rechartsEventEmitter"))}}}),a0e=GW.reducer,{createEventEmitter:i0e}=GW.actions;function o0e(t){return t.tooltip.syncInteraction}var l0e={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},qW=no({name:"chartData",initialState:l0e,reducers:{setChartData(t,e){if(t.chartData=e.payload,e.payload==null){t.dataStartIndex=0,t.dataEndIndex=0;return}e.payload.length>0&&t.dataEndIndex!==e.payload.length-1&&(t.dataEndIndex=e.payload.length-1)},setComputedData(t,e){t.computedData=e.payload},setDataStartEndIndexes(t,e){var{startIndex:n,endIndex:s}=e.payload;n!=null&&(t.dataStartIndex=n),s!=null&&(t.dataEndIndex=s)}}}),{setChartData:lz,setDataStartEndIndexes:c0e,setComputedData:GKe}=qW.actions,u0e=qW.reducer,d0e=["x","y"];function cz(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function Rd(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?cz(Object(n),!0).forEach(function(s){h0e(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):cz(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function h0e(t,e,n){return(e=m0e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function m0e(t){var e=f0e(t,"string");return typeof e=="symbol"?e:e+""}function f0e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function p0e(t,e){if(t==null)return{};var n,s,r=g0e(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(s=0;s<a.length;s++)n=a[s],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function g0e(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)!==-1)continue;n[s]=t[s]}return n}var KW=()=>{};function x0e(){var t=Gt(lA),e=Gt(cA),n=xr(),s=Gt($9),r=Gt(qc),a=$4(),i=_4(),l=Gt(c=>c.rootProps.className);j.useEffect(()=>{if(t==null)return KW;var c=(u,h,f)=>{if(e!==f&&t===u){if(s==="index"){var p;if(i&&h!==null&&h!==void 0&&(p=h.payload)!==null&&p!==void 0&&p.coordinate){var x=h.payload.coordinate,{x:y,y:v}=x,b=p0e(x,d0e),N=Rd(Rd(Rd({},b),typeof y=="number"&&{x:Math.max(i.x,Math.min(y,i.x+i.width))}),typeof v=="number"&&{y:Math.max(i.y,Math.min(v,i.y+i.height))}),S=Rd(Rd({},h),{},{payload:Rd(Rd({},h.payload),{},{coordinate:N})});n(S)}else n(h);return}if(r!=null){var k;if(typeof s=="function"){var T={activeTooltipIndex:h.payload.index==null?void 0:Number(h.payload.index),isTooltipActive:h.payload.active,activeIndex:h.payload.index==null?void 0:Number(h.payload.index),activeLabel:h.payload.label,activeDataKey:h.payload.dataKey,activeCoordinate:h.payload.coordinate},E=s(r,T);k=r[E]}else s==="value"&&(k=r.find(W=>String(W.value)===h.payload.label));var{coordinate:D}=h.payload;if(k==null||h.payload.active===!1||D==null||i==null){n(O_({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:A,y:I}=D,P=Math.min(A,i.x+i.width),$=Math.min(I,i.y+i.height),R={x:a==="horizontal"?k.coordinate:P,y:a==="horizontal"?$:k.coordinate},F=O_({active:h.payload.active,coordinate:R,dataKey:h.payload.dataKey,index:String(k.index),label:h.payload.label});n(F)}}};return Qg.on(L_,c),()=>{Qg.off(L_,c)}},[l,n,e,t,s,r,a,i])}function y0e(){var t=Gt(lA),e=Gt(cA),n=xr();j.useEffect(()=>{if(t==null)return KW;var s=(r,a,i)=>{e!==i&&t===r&&n(c0e(a))};return Qg.on(oz,s),()=>{Qg.off(oz,s)}},[n,e,t])}function b0e(){var t=xr();j.useEffect(()=>{t(i0e())},[t]),x0e(),y0e()}function v0e(t,e,n,s,r,a){var i=Gt(p=>Vpe(p,t,e)),l=Gt(cA),c=Gt(lA),u=Gt($9),h=Gt(o0e),f=h==null?void 0:h.active;j.useEffect(()=>{if(!f&&c!=null&&l!=null){var p=O_({active:a,coordinate:n,dataKey:i,index:r,label:typeof s=="number"?String(s):s});Qg.emit(L_,c,p,l)}},[f,n,i,r,s,l,c,u,a])}function uz(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function dz(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?uz(Object(n),!0).forEach(function(s){w0e(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):uz(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function w0e(t,e,n){return(e=N0e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function N0e(t){var e=S0e(t,"string");return typeof e=="symbol"?e:e+""}function S0e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function j0e(t){return t.dataKey}function k0e(t,e){return j.isValidElement(t)?j.cloneElement(t,e):typeof t=="function"?j.createElement(t,e):j.createElement(Gce,e)}var hz=[],C0e={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!Of.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function R1(t){var e=Oo(t,C0e),{active:n,allowEscapeViewBox:s,animationDuration:r,animationEasing:a,content:i,filterNull:l,isAnimationActive:c,offset:u,payloadUniqBy:h,position:f,reverseDirection:p,useTranslate3d:x,wrapperStyle:y,cursor:v,shared:b,trigger:N,defaultIndex:S,portal:k,axisId:T}=e,E=xr(),D=typeof S=="number"?String(S):S;j.useEffect(()=>{E(Kfe({shared:b,trigger:N,axisId:T,active:n,defaultIndex:D}))},[E,b,N,T,n,D]);var A=_4(),I=kV(),P=Vfe(b),{activeIndex:$,isActive:R}=Gt(ae=>Gpe(ae,P,N,D)),F=Gt(ae=>Hpe(ae,P,N,D)),W=Gt(ae=>WW(ae,P,N,D)),q=Gt(ae=>Wpe(ae,P,N,D)),X=F,z=Jpe(),K=n??R,[H,Y]=qU([X,K]),B=P==="axis"?W:void 0;v0e(P,N,q,B,$,K);var O=k??z;if(O==null)return null;var U=X??hz;K||(U=hz),l&&U.length&&(U=UU(X.filter(ae=>ae.value!=null&&(ae.hide!==!0||e.includeHidden)),h,j0e));var J=U.length>0,se=j.createElement(Jce,{allowEscapeViewBox:s,animationDuration:r,animationEasing:a,isAnimationActive:c,active:K,coordinate:q,hasPayload:J,offset:u,position:f,reverseDirection:p,useTranslate3d:x,viewBox:A,wrapperStyle:y,lastBoundingBox:H,innerRef:Y,hasPortalFromProps:!!k},k0e(i,dz(dz({},e),{},{payload:U,label:B,active:K,coordinate:q,accessibilityLayer:I})));return j.createElement(j.Fragment,null,T7.createPortal(se,O),K&&j.createElement(Zpe,{cursor:v,tooltipEventType:P,coordinate:q,payload:X,index:$}))}var i3={},o3={},l3={},mz;function T0e(){return mz||(mz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n,s,{signal:r,edges:a}={}){let i,l=null;const c=a!=null&&a.includes("leading"),u=a==null||a.includes("trailing"),h=()=>{l!==null&&(n.apply(i,l),i=void 0,l=null)},f=()=>{u&&h(),v()};let p=null;const x=()=>{p!=null&&clearTimeout(p),p=setTimeout(()=>{p=null,f()},s)},y=()=>{p!==null&&(clearTimeout(p),p=null)},v=()=>{y(),i=void 0,l=null},b=()=>{h()},N=function(...S){if(r!=null&&r.aborted)return;i=this,l=S;const k=p==null;x(),c&&k&&h()};return N.schedule=x,N.cancel=v,N.flush=b,r==null||r.addEventListener("abort",v,{once:!0}),N}t.debounce=e})(l3)),l3}var fz;function _0e(){return fz||(fz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=T0e();function n(s,r=0,a={}){typeof a!="object"&&(a={});const{leading:i=!1,trailing:l=!0,maxWait:c}=a,u=Array(2);i&&(u[0]="leading"),l&&(u[1]="trailing");let h,f=null;const p=e.debounce(function(...v){h=s.apply(this,v),f=null},r,{edges:u}),x=function(...v){return c!=null&&(f===null&&(f=Date.now()),Date.now()-f>=c)?(h=s.apply(this,v),f=Date.now(),p.cancel(),p.schedule(),h):(p.apply(this,v),h)},y=()=>(p.flush(),h);return x.cancel=p.cancel,x.flush=y,x}t.debounce=n})(o3)),o3}var pz;function E0e(){return pz||(pz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=_0e();function n(s,r=0,a={}){const{leading:i=!0,trailing:l=!0}=a;return e.debounce(s,r,{leading:i,maxWait:r,trailing:l})}t.throttle=n})(i3)),i3}var c3,gz;function A0e(){return gz||(gz=1,c3=E0e().throttle),c3}var $0e=A0e();const I0e=Hl($0e);var Eg=function(e,n){for(var s=arguments.length,r=new Array(s>2?s-2:0),a=2;a<s;a++)r[a-2]=arguments[a]};function xz(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function u3(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?xz(Object(n),!0).forEach(function(s){R0e(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):xz(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function R0e(t,e,n){return(e=O0e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function O0e(t){var e=D0e(t,"string");return typeof e=="symbol"?e:e+""}function D0e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var O1=j.forwardRef((t,e)=>{var{aspect:n,initialDimension:s={width:-1,height:-1},width:r="100%",height:a="100%",minWidth:i=0,minHeight:l,maxHeight:c,children:u,debounce:h=0,id:f,className:p,onResize:x,style:y={}}=t,v=j.useRef(null),b=j.useRef();b.current=x,j.useImperativeHandle(e,()=>v.current);var[N,S]=j.useState({containerWidth:s.width,containerHeight:s.height}),k=j.useCallback((E,D)=>{S(A=>{var I=Math.round(E),P=Math.round(D);return A.containerWidth===I&&A.containerHeight===P?A:{containerWidth:I,containerHeight:P}})},[]);j.useEffect(()=>{var E=P=>{var $,{width:R,height:F}=P[0].contentRect;k(R,F),($=b.current)===null||$===void 0||$.call(b,R,F)};h>0&&(E=I0e(E,h,{trailing:!0,leading:!1}));var D=new ResizeObserver(E),{width:A,height:I}=v.current.getBoundingClientRect();return k(A,I),D.observe(v.current),()=>{D.disconnect()}},[k,h]);var T=j.useMemo(()=>{var{containerWidth:E,containerHeight:D}=N;if(E<0||D<0)return null;Eg(Yd(r)||Yd(a),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,r,a),Eg(!n||n>0,"The aspect(%s) must be greater than zero.",n);var A=Yd(r)?E:r,I=Yd(a)?D:a;return n&&n>0&&(A?I=A/n:I&&(A=I*n),c&&I>c&&(I=c)),Eg(A>0||I>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,A,I,r,a,i,l,n),j.Children.map(u,P=>j.cloneElement(P,{width:A,height:I,style:u3({width:A,height:I},P.props.style)}))},[n,u,a,c,l,i,N,r]);return j.createElement("div",{id:f?"".concat(f):void 0,className:Dn("recharts-responsive-container",p),style:u3(u3({},y),{},{width:r,height:a,minWidth:i,minHeight:l,maxHeight:c}),ref:v},j.createElement("div",{style:{width:0,height:0,overflow:"visible"}},T))}),Ow=t=>null;Ow.displayName="Cell";function P0e(t,e,n){return(e=L0e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function L0e(t){var e=M0e(t,"string");return typeof e=="symbol"?e:e+""}function M0e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class F0e{constructor(e){P0e(this,"cache",new Map),this.maxSize=e}get(e){var n=this.cache.get(e);return n!==void 0&&(this.cache.delete(e),this.cache.set(e,n)),n}set(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){var s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(e,n)}clear(){this.cache.clear()}size(){return this.cache.size}}function yz(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function z0e(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?yz(Object(n),!0).forEach(function(s){B0e(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):yz(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function B0e(t,e,n){return(e=U0e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function U0e(t){var e=V0e(t,"string");return typeof e=="symbol"?e:e+""}function V0e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var W0e={cacheSize:2e3,enableCache:!0},XW=z0e({},W0e),bz=new F0e(XW.cacheSize),H0e={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},vz="recharts_measurement_span";function G0e(t,e){var n=e.fontSize||"",s=e.fontFamily||"",r=e.fontWeight||"",a=e.fontStyle||"",i=e.letterSpacing||"",l=e.textTransform||"";return"".concat(t,"|").concat(n,"|").concat(s,"|").concat(r,"|").concat(a,"|").concat(i,"|").concat(l)}var wz=(t,e)=>{try{var n=document.getElementById(vz);n||(n=document.createElement("span"),n.setAttribute("id",vz),n.setAttribute("aria-hidden","true"),document.body.appendChild(n)),Object.assign(n.style,H0e,e),n.textContent="".concat(t);var s=n.getBoundingClientRect();return{width:s.width,height:s.height}}catch{return{width:0,height:0}}},Ag=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e==null||Of.isSsr)return{width:0,height:0};if(!XW.enableCache)return wz(e,n);var s=G0e(e,n),r=bz.get(s);if(r)return r;var a=wz(e,n);return bz.set(s,a),a},Nz=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,Sz=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,q0e=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,K0e=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,YW={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},X0e=Object.keys(YW),Hm="NaN";function Y0e(t,e){return t*YW[e]}class oi{static parse(e){var n,[,s,r]=(n=K0e.exec(e))!==null&&n!==void 0?n:[];return new oi(parseFloat(s),r??"")}constructor(e,n){this.num=e,this.unit=n,this.num=e,this.unit=n,Yi(e)&&(this.unit=""),n!==""&&!q0e.test(n)&&(this.num=NaN,this.unit=""),X0e.includes(n)&&(this.num=Y0e(e,n),this.unit="px")}add(e){return this.unit!==e.unit?new oi(NaN,""):new oi(this.num+e.num,this.unit)}subtract(e){return this.unit!==e.unit?new oi(NaN,""):new oi(this.num-e.num,this.unit)}multiply(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new oi(NaN,""):new oi(this.num*e.num,this.unit||e.unit)}divide(e){return this.unit!==""&&e.unit!==""&&this.unit!==e.unit?new oi(NaN,""):new oi(this.num/e.num,this.unit||e.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Yi(this.num)}}function QW(t){if(t.includes(Hm))return Hm;for(var e=t;e.includes("*")||e.includes("/");){var n,[,s,r,a]=(n=Nz.exec(e))!==null&&n!==void 0?n:[],i=oi.parse(s??""),l=oi.parse(a??""),c=r==="*"?i.multiply(l):i.divide(l);if(c.isNaN())return Hm;e=e.replace(Nz,c.toString())}for(;e.includes("+")||/.-\d+(?:\.\d+)?/.test(e);){var u,[,h,f,p]=(u=Sz.exec(e))!==null&&u!==void 0?u:[],x=oi.parse(h??""),y=oi.parse(p??""),v=f==="+"?x.add(y):x.subtract(y);if(v.isNaN())return Hm;e=e.replace(Sz,v.toString())}return e}var jz=/\(([^()]*)\)/;function Q0e(t){for(var e=t,n;(n=jz.exec(e))!=null;){var[,s]=n;e=e.replace(jz,QW(s))}return e}function Z0e(t){var e=t.replace(/\s+/g,"");return e=Q0e(e),e=QW(e),e}function J0e(t){try{return Z0e(t)}catch{return Hm}}function d3(t){var e=J0e(t.slice(5,-1));return e===Hm?"":e}var ege=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],tge=["dx","dy","angle","className","breakAll"];function M_(){return M_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},M_.apply(null,arguments)}function kz(t,e){if(t==null)return{};var n,s,r=nge(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(s=0;s<a.length;s++)n=a[s],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function nge(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)!==-1)continue;n[s]=t[s]}return n}var ZW=/[ \f\n\r\t\v\u2028\u2029]+/,JW=t=>{var{children:e,breakAll:n,style:s}=t;try{var r=[];Hr(e)||(n?r=e.toString().split(""):r=e.toString().split(ZW));var a=r.map(l=>({word:l,width:Ag(l,s).width})),i=n?0:Ag("",s).width;return{wordsWithComputedWidth:a,spaceWidth:i}}catch{return null}},sge=(t,e,n,s,r)=>{var{maxLines:a,children:i,style:l,breakAll:c}=t,u=qt(a),h=i,f=function(){var R=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return R.reduce((F,W)=>{var{word:q,width:X}=W,z=F[F.length-1];if(z&&(s==null||r||z.width+X+n<Number(s)))z.words.push(q),z.width+=X+n;else{var K={words:[q],width:X};F.push(K)}return F},[])},p=f(e),x=$=>$.reduce((R,F)=>R.width>F.width?R:F);if(!u||r)return p;var y=p.length>a||x(p).width>Number(s);if(!y)return p;for(var v="",b=$=>{var R=h.slice(0,$),F=JW({breakAll:c,style:l,children:R+v}).wordsWithComputedWidth,W=f(F),q=W.length>a||x(W).width>Number(s);return[q,W]},N=0,S=h.length-1,k=0,T;N<=S&&k<=h.length-1;){var E=Math.floor((N+S)/2),D=E-1,[A,I]=b(D),[P]=b(E);if(!A&&!P&&(N=E+1),A&&P&&(S=E-1),!A&&P){T=I;break}k++}return T||p},Cz=t=>{var e=Hr(t)?[]:t.toString().split(ZW);return[{words:e}]},rge=t=>{var{width:e,scaleToFit:n,children:s,style:r,breakAll:a,maxLines:i}=t;if((e||n)&&!Of.isSsr){var l,c,u=JW({breakAll:a,children:s,style:r});if(u){var{wordsWithComputedWidth:h,spaceWidth:f}=u;l=h,c=f}else return Cz(s);return sge({breakAll:a,children:s,maxLines:i,style:r},l,c,e,n)}return Cz(s)},Tz="#808080",IA=j.forwardRef((t,e)=>{var{x:n=0,y:s=0,lineHeight:r="1em",capHeight:a="0.71em",scaleToFit:i=!1,textAnchor:l="start",verticalAnchor:c="end",fill:u=Tz}=t,h=kz(t,ege),f=j.useMemo(()=>rge({breakAll:h.breakAll,children:h.children,maxLines:h.maxLines,scaleToFit:i,style:h.style,width:h.width}),[h.breakAll,h.children,h.maxLines,i,h.style,h.width]),{dx:p,dy:x,angle:y,className:v,breakAll:b}=h,N=kz(h,tge);if(!Ml(n)||!Ml(s)||f.length===0)return null;var S=n+(qt(p)?p:0),k=s+(qt(x)?x:0),T;switch(c){case"start":T=d3("calc(".concat(a,")"));break;case"middle":T=d3("calc(".concat((f.length-1)/2," * -").concat(r," + (").concat(a," / 2))"));break;default:T=d3("calc(".concat(f.length-1," * -").concat(r,")"));break}var E=[];if(i){var D=f[0].width,{width:A}=h;E.push("scale(".concat(qt(A)?A/D:1,")"))}return y&&E.push("rotate(".concat(y,", ").concat(S,", ").concat(k,")")),E.length&&(N.transform=E.join(" ")),j.createElement("text",M_({},ha(N,!0),{ref:e,x:S,y:k,className:Dn("recharts-text",v),textAnchor:l,fill:u.includes("url")?Tz:u}),f.map((I,P)=>{var $=I.words.join(b?"":" ");return j.createElement("tspan",{x:S,dy:P===0?T:r,key:"".concat($,"-").concat(P)},$)}))});IA.displayName="Text";var age=["labelRef"];function ige(t,e){if(t==null)return{};var n,s,r=oge(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(s=0;s<a.length;s++)n=a[s],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function oge(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)!==-1)continue;n[s]=t[s]}return n}function _z(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function Zs(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?_z(Object(n),!0).forEach(function(s){lge(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_z(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function lge(t,e,n){return(e=cge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cge(t){var e=uge(t,"string");return typeof e=="symbol"?e:e+""}function uge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xc(){return xc=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},xc.apply(null,arguments)}var eH=j.createContext(null),dge=t=>{var{x:e,y:n,width:s,height:r,children:a}=t,i=j.useMemo(()=>({x:e,y:n,width:s,height:r}),[e,n,s,r]);return j.createElement(eH.Provider,{value:i},a)},tH=()=>{var t=j.useContext(eH),e=_4();return t||e},hge=j.createContext(null),mge=()=>{var t=j.useContext(hge),e=Gt(P9);return t||e},fge=t=>{var{value:e,formatter:n}=t,s=Hr(t.children)?e:t.children;return typeof n=="function"?n(s):s},RA=t=>t!=null&&typeof t=="function",pge=(t,e)=>{var n=di(e-t),s=Math.min(Math.abs(e-t),360);return n*s},gge=(t,e,n,s,r)=>{var{offset:a,className:i}=t,{cx:l,cy:c,innerRadius:u,outerRadius:h,startAngle:f,endAngle:p,clockWise:x}=r,y=(u+h)/2,v=pge(f,p),b=v>=0?1:-1,N,S;switch(e){case"insideStart":N=f+b*a,S=x;break;case"insideEnd":N=p-b*a,S=!x;break;case"end":N=p+b*a,S=x;break;default:throw new Error("Unsupported position ".concat(e))}S=v<=0?S:!S;var k=da(l,c,y,N),T=da(l,c,y,N+(S?1:-1)*359),E="M".concat(k.x,",").concat(k.y,`
    A`).concat(y,",").concat(y,",0,1,").concat(S?0:1,`,
    `).concat(T.x,",").concat(T.y),D=Hr(t.id)?Ug("recharts-radial-line-"):t.id;return j.createElement("text",xc({},s,{dominantBaseline:"central",className:Dn("recharts-radial-bar-label",i)}),j.createElement("defs",null,j.createElement("path",{id:D,d:E})),j.createElement("textPath",{xlinkHref:"#".concat(D)},n))},xge=(t,e,n)=>{var{cx:s,cy:r,innerRadius:a,outerRadius:i,startAngle:l,endAngle:c}=t,u=(l+c)/2;if(n==="outside"){var{x:h,y:f}=da(s,r,i+e,u);return{x:h,y:f,textAnchor:h>=s?"start":"end",verticalAnchor:"middle"}}if(n==="center")return{x:s,y:r,textAnchor:"middle",verticalAnchor:"middle"};if(n==="centerTop")return{x:s,y:r,textAnchor:"middle",verticalAnchor:"start"};if(n==="centerBottom")return{x:s,y:r,textAnchor:"middle",verticalAnchor:"end"};var p=(a+i)/2,{x,y}=da(s,r,p,u);return{x,y,textAnchor:"middle",verticalAnchor:"middle"}},nH=t=>"cx"in t&&qt(t.cx),yge=(t,e)=>{var{parentViewBox:n,offset:s,position:r}=t,a;n!=null&&!nH(n)&&(a=n);var{x:i,y:l,width:c,height:u}=e,h=u>=0?1:-1,f=h*s,p=h>0?"end":"start",x=h>0?"start":"end",y=c>=0?1:-1,v=y*s,b=y>0?"end":"start",N=y>0?"start":"end";if(r==="top"){var S={x:i+c/2,y:l-h*s,textAnchor:"middle",verticalAnchor:p};return Zs(Zs({},S),a?{height:Math.max(l-a.y,0),width:c}:{})}if(r==="bottom"){var k={x:i+c/2,y:l+u+f,textAnchor:"middle",verticalAnchor:x};return Zs(Zs({},k),a?{height:Math.max(a.y+a.height-(l+u),0),width:c}:{})}if(r==="left"){var T={x:i-v,y:l+u/2,textAnchor:b,verticalAnchor:"middle"};return Zs(Zs({},T),a?{width:Math.max(T.x-a.x,0),height:u}:{})}if(r==="right"){var E={x:i+c+v,y:l+u/2,textAnchor:N,verticalAnchor:"middle"};return Zs(Zs({},E),a?{width:Math.max(a.x+a.width-E.x,0),height:u}:{})}var D=a?{width:c,height:u}:{};return r==="insideLeft"?Zs({x:i+v,y:l+u/2,textAnchor:N,verticalAnchor:"middle"},D):r==="insideRight"?Zs({x:i+c-v,y:l+u/2,textAnchor:b,verticalAnchor:"middle"},D):r==="insideTop"?Zs({x:i+c/2,y:l+f,textAnchor:"middle",verticalAnchor:x},D):r==="insideBottom"?Zs({x:i+c/2,y:l+u-f,textAnchor:"middle",verticalAnchor:p},D):r==="insideTopLeft"?Zs({x:i+v,y:l+f,textAnchor:N,verticalAnchor:x},D):r==="insideTopRight"?Zs({x:i+c-v,y:l+f,textAnchor:b,verticalAnchor:x},D):r==="insideBottomLeft"?Zs({x:i+v,y:l+u-f,textAnchor:N,verticalAnchor:p},D):r==="insideBottomRight"?Zs({x:i+c-v,y:l+u-f,textAnchor:b,verticalAnchor:p},D):r&&typeof r=="object"&&(qt(r.x)||Yd(r.x))&&(qt(r.y)||Yd(r.y))?Zs({x:i+ol(r.x,c),y:l+ol(r.y,u),textAnchor:"end",verticalAnchor:"end"},D):Zs({x:i+c/2,y:l+u/2,textAnchor:"middle",verticalAnchor:"middle"},D)},bge={offset:5};function Iu(t){var e=Oo(t,bge),{viewBox:n,position:s,value:r,children:a,content:i,className:l="",textBreakAll:c,labelRef:u}=e,h=mge(),f=tH(),p=s==="center"?f:h??f,x=n||p;if(!x||Hr(r)&&Hr(a)&&!j.isValidElement(i)&&typeof i!="function")return null;var y=Zs(Zs({},e),{},{viewBox:x});if(j.isValidElement(i)){var{labelRef:v}=y,b=ige(y,age);return j.cloneElement(i,b)}var N;if(typeof i=="function"){if(N=j.createElement(i,y),j.isValidElement(N))return N}else N=fge(e);var S=nH(x),k=ha(e,!0);if(S&&(s==="insideStart"||s==="insideEnd"||s==="end"))return gge(e,s,N,k,x);var T=S?xge(x,e.offset,e.position):yge(e,x);return j.createElement(IA,xc({ref:u,className:Dn("recharts-label",l)},k,T,{breakAll:c}),N)}Iu.displayName="Label";var vge=(t,e,n)=>{if(!t)return null;var s={viewBox:e,labelRef:n};return t===!0?j.createElement(Iu,xc({key:"label-implicit"},s)):Ml(t)?j.createElement(Iu,xc({key:"label-implicit",value:t},s)):j.isValidElement(t)?t.type===Iu?j.cloneElement(t,Zs({key:"label-implicit"},s)):j.createElement(Iu,xc({key:"label-implicit",content:t},s)):RA(t)?j.createElement(Iu,xc({key:"label-implicit",content:t},s)):t&&typeof t=="object"?j.createElement(Iu,xc({},t,{key:"label-implicit"},s)):null};function wge(t){var{label:e}=t,n=tH();return vge(e,n)||null}var h3={},m3={},Ez;function Nge(){return Ez||(Ez=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return n[n.length-1]}t.last=e})(m3)),m3}var f3={},Az;function Sge(){return Az||(Az=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){return Array.isArray(n)?n:Array.from(n)}t.toArray=e})(f3)),f3}var $z;function jge(){return $z||($z=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});const e=Nge(),n=Sge(),s=y4();function r(a){if(s.isArrayLike(a))return e.last(n.toArray(a))}t.last=r})(h3)),h3}var p3,Iz;function kge(){return Iz||(Iz=1,p3=jge().last),p3}var Cge=kge();const Tge=Hl(Cge);var _ge=["valueAccessor"],Ege=["dataKey","clockWise","id","textBreakAll"];function Dw(){return Dw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Dw.apply(null,arguments)}function Rz(t,e){if(t==null)return{};var n,s,r=Age(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(s=0;s<a.length;s++)n=a[s],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Age(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)!==-1)continue;n[s]=t[s]}return n}var $ge=t=>Array.isArray(t.value)?Tge(t.value):t.value,sH=j.createContext(void 0),Ige=sH.Provider,rH=j.createContext(void 0);rH.Provider;function Rge(){return j.useContext(sH)}function Oge(){return j.useContext(rH)}function D1(t){var{valueAccessor:e=$ge}=t,n=Rz(t,_ge),{dataKey:s,clockWise:r,id:a,textBreakAll:i}=n,l=Rz(n,Ege),c=Rge(),u=Oge(),h=c||u;return!h||!h.length?null:j.createElement(Gu,{className:"recharts-label-list"},h.map((f,p)=>{var x,y=Hr(s)?e(f,p):Ba(f&&f.payload,s),v=Hr(a)?{}:{id:"".concat(a,"-").concat(p)};return j.createElement(Iu,Dw({},ha(f,!0),l,v,{fill:(x=n.fill)!==null&&x!==void 0?x:f.fill,parentViewBox:f.parentViewBox,value:y,textBreakAll:i,viewBox:f.viewBox,key:"label-".concat(p),index:p}))}))}D1.displayName="LabelList";function Dge(t){var{label:e}=t;return e?e===!0?j.createElement(D1,{key:"labelList-implicit"}):j.isValidElement(e)||RA(e)?j.createElement(D1,{key:"labelList-implicit",content:e}):typeof e=="object"?j.createElement(D1,Dw({key:"labelList-implicit"},e,{type:String(e.type)})):null:null}var Pge={radiusAxis:{},angleAxis:{}},aH=no({name:"polarAxis",initialState:Pge,reducers:{addRadiusAxis(t,e){t.radiusAxis[e.payload.id]=e.payload},removeRadiusAxis(t,e){delete t.radiusAxis[e.payload.id]},addAngleAxis(t,e){t.angleAxis[e.payload.id]=e.payload},removeAngleAxis(t,e){delete t.angleAxis[e.payload.id]}}}),{addRadiusAxis:qKe,removeRadiusAxis:KKe,addAngleAxis:XKe,removeAngleAxis:YKe}=aH.actions,Lge=aH.reducer,g3={},Oz;function Mge(){return Oz||(Oz=1,(function(t){Object.defineProperty(t,Symbol.toStringTag,{value:"Module"});function e(n){var r;if(typeof n!="object"||n==null)return!1;if(Object.getPrototypeOf(n)===null)return!0;if(Object.prototype.toString.call(n)!=="[object Object]"){const a=n[Symbol.toStringTag];return a==null||!((r=Object.getOwnPropertyDescriptor(n,Symbol.toStringTag))!=null&&r.writable)?!1:n.toString()===`[object ${a}]`}let s=n;for(;Object.getPrototypeOf(s)!==null;)s=Object.getPrototypeOf(s);return Object.getPrototypeOf(n)===s}t.isPlainObject=e})(g3)),g3}var x3,Dz;function Fge(){return Dz||(Dz=1,x3=Mge().isPlainObject),x3}var zge=Fge();const Bge=Hl(zge);function Pz(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function Lz(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Pz(Object(n),!0).forEach(function(s){Uge(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Pz(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function Uge(t,e,n){return(e=Vge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vge(t){var e=Wge(t,"string");return typeof e=="symbol"?e:e+""}function Wge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Pw(){return Pw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Pw.apply(null,arguments)}var Mz=(t,e,n,s,r)=>{var a=n-s,i;return i="M ".concat(t,",").concat(e),i+="L ".concat(t+n,",").concat(e),i+="L ".concat(t+n-a/2,",").concat(e+r),i+="L ".concat(t+n-a/2-s,",").concat(e+r),i+="L ".concat(t,",").concat(e," Z"),i},Hge={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Gge=t=>{var e=Oo(t,Hge),{x:n,y:s,upperWidth:r,lowerWidth:a,height:i,className:l}=e,{animationEasing:c,animationDuration:u,animationBegin:h,isUpdateAnimationActive:f}=e,p=j.useRef(),[x,y]=j.useState(-1),v=j.useRef(r),b=j.useRef(a),N=j.useRef(i),S=j.useRef(n),k=j.useRef(s),T=O4(t,"trapezoid-");if(j.useEffect(()=>{if(p.current&&p.current.getTotalLength)try{var q=p.current.getTotalLength();q&&y(q)}catch{}},[]),n!==+n||s!==+s||r!==+r||a!==+a||i!==+i||r===0&&a===0||i===0)return null;var E=Dn("recharts-trapezoid",l);if(!f)return j.createElement("g",null,j.createElement("path",Pw({},ha(e,!0),{className:E,d:Mz(n,s,r,a,i)})));var D=v.current,A=b.current,I=N.current,P=S.current,$=k.current,R="0px ".concat(x===-1?1:x,"px"),F="".concat(x,"px 0px"),W=CV(["strokeDasharray"],u,c);return j.createElement(R4,{animationId:T,key:T,canBegin:x>0,duration:u,easing:c,isActive:f,begin:h},q=>{var X=Oa(D,r,q),z=Oa(A,a,q),K=Oa(I,i,q),H=Oa(P,n,q),Y=Oa($,s,q);p.current&&(v.current=X,b.current=z,N.current=K,S.current=H,k.current=Y);var B=q>0?{transition:W,strokeDasharray:F}:{strokeDasharray:R};return j.createElement("path",Pw({},ha(e,!0),{className:E,d:Mz(H,Y,X,z,K),ref:p,style:Lz(Lz({},B),e.style)}))})},qge=["option","shapeType","propTransformer","activeClassName","isActive"];function Kge(t,e){if(t==null)return{};var n,s,r=Xge(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(s=0;s<a.length;s++)n=a[s],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Xge(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)!==-1)continue;n[s]=t[s]}return n}function Fz(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function Lw(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Fz(Object(n),!0).forEach(function(s){Yge(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Fz(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function Yge(t,e,n){return(e=Qge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qge(t){var e=Zge(t,"string");return typeof e=="symbol"?e:e+""}function Zge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jge(t,e){return Lw(Lw({},e),t)}function exe(t,e){return t==="symbols"}function zz(t){var{shapeType:e,elementProps:n}=t;switch(e){case"rectangle":return j.createElement(AV,n);case"trapezoid":return j.createElement(Gge,n);case"sector":return j.createElement(RV,n);case"symbols":if(exe(e))return j.createElement(p4,n);break;default:return null}}function txe(t){return j.isValidElement(t)?t.props:t}function nxe(t){var{option:e,shapeType:n,propTransformer:s=Jge,activeClassName:r="recharts-active-shape",isActive:a}=t,i=Kge(t,qge),l;if(j.isValidElement(e))l=j.cloneElement(e,Lw(Lw({},i),txe(e)));else if(typeof e=="function")l=e(i);else if(Bge(e)&&typeof e!="boolean"){var c=s(e,i);l=j.createElement(zz,{shapeType:n,elementProps:c})}else{var u=i;l=j.createElement(zz,{shapeType:n,elementProps:u})}return a?j.createElement(Gu,{className:r},l):l}var iH=(t,e)=>{var n=xr();return(s,r)=>a=>{t==null||t(s,r,a),n(CW({activeIndex:String(r),activeDataKey:e,activeCoordinate:s.tooltipPosition}))}},oH=t=>{var e=xr();return(n,s)=>r=>{t==null||t(n,s,r),e(Xfe())}},lH=(t,e)=>{var n=xr();return(s,r)=>a=>{t==null||t(s,r,a),n(Yfe({activeIndex:String(r),activeDataKey:e,activeCoordinate:s.tooltipPosition}))}};function sxe(t){var{fn:e,args:n}=t,s=xr(),r=Ro();return j.useEffect(()=>{if(!r){var a=e(n);return s(Gfe(a)),()=>{s(qfe(a))}}},[e,n,s,r]),null}var rxe=()=>{};function axe(t){var{legendPayload:e}=t,n=xr(),s=Ro();return j.useEffect(()=>s?rxe:(n(_ce(e)),()=>{n(Ece(e))}),[n,s,e]),null}var y3,ixe=()=>{var[t]=j.useState(()=>Ug("uid-"));return t},oxe=(y3=Kee.useId)!==null&&y3!==void 0?y3:ixe;function lxe(t,e){var n=oxe();return e||(t?"".concat(t,"-").concat(n):n)}var cxe=j.createContext(void 0),uxe=t=>{var{id:e,type:n,children:s}=t,r=lxe("recharts-".concat(n),e);return j.createElement(cxe.Provider,{value:r},s(r))},dxe={cartesianItems:[],polarItems:[]},cH=no({name:"graphicalItems",initialState:dxe,reducers:{addCartesianGraphicalItem(t,e){t.cartesianItems.push(e.payload)},replaceCartesianGraphicalItem(t,e){var{prev:n,next:s}=e.payload,r=jc(t).cartesianItems.indexOf(n);r>-1&&(t.cartesianItems[r]=s)},removeCartesianGraphicalItem(t,e){var n=jc(t).cartesianItems.indexOf(e.payload);n>-1&&t.cartesianItems.splice(n,1)},addPolarGraphicalItem(t,e){t.polarItems.push(e.payload)},removePolarGraphicalItem(t,e){var n=jc(t).polarItems.indexOf(e.payload);n>-1&&t.polarItems.splice(n,1)}}}),{addCartesianGraphicalItem:hxe,replaceCartesianGraphicalItem:mxe,removeCartesianGraphicalItem:fxe,addPolarGraphicalItem:QKe,removePolarGraphicalItem:ZKe}=cH.actions,pxe=cH.reducer;function gxe(t){var e=xr(),n=j.useRef(null);return j.useEffect(()=>{n.current===null?e(hxe(t)):n.current!==t&&e(mxe({prev:n.current,next:t})),n.current=t},[e,t]),j.useEffect(()=>()=>{n.current&&(e(fxe(n.current)),n.current=null)},[e]),null}function Bz(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function Uz(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Bz(Object(n),!0).forEach(function(s){xxe(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Bz(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function xxe(t,e,n){return(e=yxe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yxe(t){var e=bxe(t,"string");return typeof e=="symbol"?e:e+""}function bxe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var vxe={xAxis:{},yAxis:{},zAxis:{}},uH=no({name:"cartesianAxis",initialState:vxe,reducers:{addXAxis(t,e){t.xAxis[e.payload.id]=e.payload},removeXAxis(t,e){delete t.xAxis[e.payload.id]},addYAxis(t,e){t.yAxis[e.payload.id]=e.payload},removeYAxis(t,e){delete t.yAxis[e.payload.id]},addZAxis(t,e){t.zAxis[e.payload.id]=e.payload},removeZAxis(t,e){delete t.zAxis[e.payload.id]},updateYAxisWidth(t,e){var{id:n,width:s}=e.payload;t.yAxis[n]&&(t.yAxis[n]=Uz(Uz({},t.yAxis[n]),{},{width:s}))}}}),{addXAxis:wxe,removeXAxis:Nxe,addYAxis:Sxe,removeYAxis:jxe,addZAxis:JKe,removeZAxis:eXe,updateYAxisWidth:kxe}=uH.actions,Cxe=uH.reducer,Txe=qe([Kr],t=>{if(t)return{top:t.top,bottom:t.bottom,left:t.left,right:t.right}}),_xe=qe([Txe,Uc,Vc],(t,e,n)=>{if(!(!t||e==null||n==null))return{x:t.left,y:t.top,width:Math.max(0,e-t.left-t.right),height:Math.max(0,n-t.top-t.bottom)}}),dH=()=>Gt(_xe),Exe="Invariant failed";function Axe(t,e){throw new Error(Exe)}var $xe=["x","y"];function F_(){return F_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},F_.apply(null,arguments)}function Vz(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function lg(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Vz(Object(n),!0).forEach(function(s){Ixe(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Vz(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function Ixe(t,e,n){return(e=Rxe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rxe(t){var e=Oxe(t,"string");return typeof e=="symbol"?e:e+""}function Oxe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Dxe(t,e){if(t==null)return{};var n,s,r=Pxe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(s=0;s<a.length;s++)n=a[s],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Pxe(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)!==-1)continue;n[s]=t[s]}return n}function Lxe(t,e){var{x:n,y:s}=t,r=Dxe(t,$xe),a="".concat(n),i=parseInt(a,10),l="".concat(s),c=parseInt(l,10),u="".concat(e.height||r.height),h=parseInt(u,10),f="".concat(e.width||r.width),p=parseInt(f,10);return lg(lg(lg(lg(lg({},e),r),i?{x:i}:{}),c?{y:c}:{}),{},{height:h,width:p,name:e.name,radius:e.radius})}function OA(t){return j.createElement(nxe,F_({shapeType:"rectangle",propTransformer:Lxe,activeClassName:"recharts-active-bar"},t))}var Mxe=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return(s,r)=>{if(qt(e))return e;var a=qt(s)||Hr(s);return a?e(s,r):(a||Axe(),n)}},Fxe={},hH=no({name:"errorBars",initialState:Fxe,reducers:{addErrorBar:(t,e)=>{var{itemId:n,errorBar:s}=e.payload;t[n]||(t[n]=[]),t[n].push(s)},replaceErrorBar:(t,e)=>{var{itemId:n,prev:s,next:r}=e.payload;t[n]&&(t[n]=t[n].map(a=>a.dataKey===s.dataKey&&a.direction===s.direction?r:a))},removeErrorBar:(t,e)=>{var{itemId:n,errorBar:s}=e.payload;t[n]&&(t[n]=t[n].filter(r=>r.dataKey!==s.dataKey||r.direction!==s.direction))}}}),{addErrorBar:tXe,replaceErrorBar:nXe,removeErrorBar:sXe}=hH.actions,zxe=hH.reducer,Bxe=["children"];function Uxe(t,e){if(t==null)return{};var n,s,r=Vxe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(s=0;s<a.length;s++)n=a[s],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Vxe(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)!==-1)continue;n[s]=t[s]}return n}var Wxe={data:[],xAxisId:"xAxis-0",yAxisId:"yAxis-0",dataPointFormatter:()=>({x:0,y:0,value:0}),errorBarOffset:0},Hxe=j.createContext(Wxe);function Gxe(t){var{children:e}=t,n=Uxe(t,Bxe);return j.createElement(Hxe.Provider,{value:n},e)}function mH(t,e){var n,s,r=Gt(u=>Hc(u,t)),a=Gt(u=>Gc(u,e)),i=(n=r==null?void 0:r.allowDataOverflow)!==null&&n!==void 0?n:Oi.allowDataOverflow,l=(s=a==null?void 0:a.allowDataOverflow)!==null&&s!==void 0?s:Di.allowDataOverflow,c=i||l;return{needClip:c,needClipX:i,needClipY:l}}function qxe(t){var{xAxisId:e,yAxisId:n,clipPathId:s}=t,r=dH(),{needClipX:a,needClipY:i,needClip:l}=mH(e,n);if(!l)return null;var{x:c,y:u,width:h,height:f}=r;return j.createElement("clipPath",{id:"clipPath-".concat(s)},j.createElement("rect",{x:a?c:c-h/2,y:i?u:u-f/2,width:a?h:h*2,height:i?f:f*2}))}var Kxe=["onMouseEnter","onMouseLeave","onClick"],Xxe=["value","background","tooltipPosition"],Yxe=["id"],Qxe=["onMouseEnter","onClick","onMouseLeave"];function qu(){return qu=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},qu.apply(null,arguments)}function Wz(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function Da(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Wz(Object(n),!0).forEach(function(s){Zxe(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Wz(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function Zxe(t,e,n){return(e=Jxe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jxe(t){var e=eye(t,"string");return typeof e=="symbol"?e:e+""}function eye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Mw(t,e){if(t==null)return{};var n,s,r=tye(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(s=0;s<a.length;s++)n=a[s],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function tye(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)!==-1)continue;n[s]=t[s]}return n}var nye=t=>{var{dataKey:e,name:n,fill:s,legendType:r,hide:a}=t;return[{inactive:a,dataKey:e,type:r,color:s,value:wV(n,e),payload:t}]};function sye(t){var{dataKey:e,stroke:n,strokeWidth:s,fill:r,name:a,hide:i,unit:l}=t;return{dataDefinedOnItem:void 0,positions:void 0,settings:{stroke:n,strokeWidth:s,fill:r,dataKey:e,nameKey:void 0,name:wV(a,e),hide:i,type:t.tooltipType,color:t.fill,unit:l}}}function rye(t){var e=Gt(df),{data:n,dataKey:s,background:r,allOtherBarProps:a}=t,{onMouseEnter:i,onMouseLeave:l,onClick:c}=a,u=Mw(a,Kxe),h=iH(i,s),f=oH(l),p=lH(c,s);if(!r||n==null)return null;var x=ha(r,!1);return j.createElement(j.Fragment,null,n.map((y,v)=>{var{value:b,background:N,tooltipPosition:S}=y,k=Mw(y,Xxe);if(!N)return null;var T=h(y,v),E=f(y,v),D=p(y,v),A=Da(Da(Da(Da(Da({option:r,isActive:String(v)===e},k),{},{fill:"#eee"},N),x),I2(u,y,v)),{},{onMouseEnter:T,onMouseLeave:E,onClick:D,dataKey:s,index:v,className:"recharts-bar-background-rectangle"});return j.createElement(OA,qu({key:"background-bar-".concat(A.index)},A))}))}function aye(t){var{showLabels:e,children:n,rects:s}=t,r=s==null?void 0:s.map(a=>{var i={x:a.x,y:a.y,width:a.width,height:a.height};return Da(Da({},i),{},{value:a.value,payload:a.payload,parentViewBox:a.parentViewBox,viewBox:i,fill:a.fill})});return j.createElement(Ige,{value:e?r:void 0},n)}function iye(t){var{shape:e,activeBar:n,baseProps:s,entry:r,index:a,dataKey:i}=t,l=Gt(df),c=Gt(FW),u=n&&String(a)===l&&(c==null||i===c),h=u?n:e;return j.createElement(OA,qu({},s,r,{isActive:u,option:h,index:a,dataKey:i}))}function oye(t){var{shape:e,baseProps:n,entry:s,index:r,dataKey:a}=t;return j.createElement(OA,qu({},n,s,{isActive:!1,option:e,index:r,dataKey:a}))}function lye(t){var{data:e,props:n}=t,s=Rf(n),{id:r}=s,a=Mw(s,Yxe),{shape:i,dataKey:l,activeBar:c}=n,{onMouseEnter:u,onClick:h,onMouseLeave:f}=n,p=Mw(n,Qxe),x=iH(u,l),y=oH(f),v=lH(h,l);return e?j.createElement(j.Fragment,null,e.map((b,N)=>j.createElement(Gu,qu({className:"recharts-bar-rectangle"},I2(p,b,N),{onMouseEnter:x(b,N),onMouseLeave:y(b,N),onClick:v(b,N),key:"rectangle-".concat(b==null?void 0:b.x,"-").concat(b==null?void 0:b.y,"-").concat(b==null?void 0:b.value,"-").concat(N)}),c?j.createElement(iye,{shape:i,activeBar:c,baseProps:a,entry:b,index:N,dataKey:l}):j.createElement(oye,{shape:i,baseProps:a,entry:b,index:N,dataKey:l})))):null}function cye(t){var{props:e,previousRectanglesRef:n}=t,{data:s,layout:r,isAnimationActive:a,animationBegin:i,animationDuration:l,animationEasing:c,onAnimationEnd:u,onAnimationStart:h}=e,f=n.current,p=O4(e,"recharts-bar-"),[x,y]=j.useState(!1),v=!x,b=j.useCallback(()=>{typeof u=="function"&&u(),y(!1)},[u]),N=j.useCallback(()=>{typeof h=="function"&&h(),y(!0)},[h]);return j.createElement(aye,{showLabels:v,rects:s},j.createElement(R4,{animationId:p,begin:i,duration:l,isActive:a,easing:c,onAnimationEnd:b,onAnimationStart:N,key:p},S=>{var k=S===1?s:s==null?void 0:s.map((T,E)=>{var D=f&&f[E];if(D)return Da(Da({},T),{},{x:Oa(D.x,T.x,S),y:Oa(D.y,T.y,S),width:Oa(D.width,T.width,S),height:Oa(D.height,T.height,S)});if(r==="horizontal"){var A=Oa(0,T.height,S);return Da(Da({},T),{},{y:T.y+T.height-A,height:A})}var I=Oa(0,T.width,S);return Da(Da({},T),{},{width:I})});return S>0&&(n.current=k??null),k==null?null:j.createElement(Gu,null,j.createElement(lye,{props:e,data:k}))}),j.createElement(Dge,{label:e.label}),e.children)}function uye(t){var e=j.useRef(null);return j.createElement(cye,{previousRectanglesRef:e,props:t})}var fH=0,dye=(t,e)=>{var n=Array.isArray(t.value)?t.value[1]:t.value;return{x:t.x,y:t.y,value:n,errorVal:Ba(t,e)}};class hye extends j.PureComponent{render(){var{hide:e,data:n,dataKey:s,className:r,xAxisId:a,yAxisId:i,needClip:l,background:c,id:u}=this.props;if(e||n==null)return null;var h=Dn("recharts-bar",r),f=u;return j.createElement(Gu,{className:h,id:u},l&&j.createElement("defs",null,j.createElement(qxe,{clipPathId:f,xAxisId:a,yAxisId:i})),j.createElement(Gu,{className:"recharts-bar-rectangles",clipPath:l?"url(#clipPath-".concat(f,")"):void 0},j.createElement(rye,{data:n,dataKey:s,background:c,allOtherBarProps:this.props}),j.createElement(uye,this.props)))}}var mye={activeBar:!1,animationBegin:0,animationDuration:400,animationEasing:"ease",hide:!1,isAnimationActive:!Of.isSsr,legendType:"rect",minPointSize:fH,xAxisId:0,yAxisId:0};function fye(t){var{xAxisId:e,yAxisId:n,hide:s,legendType:r,minPointSize:a,activeBar:i,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:h}=t,{needClip:f}=mH(e,n),p=$4(),x=Ro(),y=Wae(t.children,Ow),v=Gt(S=>Uye(S,e,n,x,t.id,y));if(p!=="vertical"&&p!=="horizontal")return null;var b,N=v==null?void 0:v[0];return N==null||N.height==null||N.width==null?b=0:b=p==="vertical"?N.height/2:N.width/2,j.createElement(Gxe,{xAxisId:e,yAxisId:n,data:v,dataPointFormatter:dye,errorBarOffset:b},j.createElement(hye,qu({},t,{layout:p,needClip:f,data:v,xAxisId:e,yAxisId:n,hide:s,legendType:r,minPointSize:a,activeBar:i,animationBegin:l,animationDuration:c,animationEasing:u,isAnimationActive:h})))}function pye(t){var{layout:e,barSettings:{dataKey:n,minPointSize:s},pos:r,bandSize:a,xAxis:i,yAxis:l,xAxisTicks:c,yAxisTicks:u,stackedData:h,displayedData:f,offset:p,cells:x,parentViewBox:y}=t,v=e==="horizontal"?l:i,b=h?v.scale.domain():null,N=rce({numericAxis:v});return f.map((S,k)=>{var T,E,D,A,I,P;h?T=Zle(h[k],b):(T=Ba(S,n),Array.isArray(T)||(T=[N,T]));var $=Mxe(s,fH)(T[1],k);if(e==="horizontal"){var R,[F,W]=[l.scale(T[0]),l.scale(T[1])];E=DM({axis:i,ticks:c,bandSize:a,offset:r.offset,entry:S,index:k}),D=(R=W??F)!==null&&R!==void 0?R:void 0,A=r.size;var q=F-W;if(I=Yi(q)?0:q,P={x:E,y:p.top,width:A,height:p.height},Math.abs($)>0&&Math.abs(I)<Math.abs($)){var X=di(I||$)*(Math.abs($)-Math.abs(I));D-=X,I+=X}}else{var[z,K]=[i.scale(T[0]),i.scale(T[1])];if(E=z,D=DM({axis:l,ticks:u,bandSize:a,offset:r.offset,entry:S,index:k}),A=K-z,I=r.size,P={x:p.left,y:D,width:p.width,height:I},Math.abs($)>0&&Math.abs(A)<Math.abs($)){var H=di(A||$)*(Math.abs($)-Math.abs(A));A+=H}}if(E==null||D==null||A==null||I==null)return null;var Y=Da(Da({},S),{},{x:E,y:D,width:A,height:I,value:h?T:T[1],payload:S,background:P,tooltipPosition:{x:E+A/2,y:D+I/2},parentViewBox:y},x&&x[k]&&x[k].props);return Y}).filter(Boolean)}function gye(t){var e=Oo(t,mye),n=Ro();return j.createElement(uxe,{id:e.id,type:"bar"},s=>j.createElement(j.Fragment,null,j.createElement(axe,{legendPayload:nye(e)}),j.createElement(sxe,{fn:sye,args:e}),j.createElement(gxe,{type:"bar",id:s,data:void 0,xAxisId:e.xAxisId,yAxisId:e.yAxisId,zAxisId:0,dataKey:e.dataKey,stackId:sce(e.stackId),hide:e.hide,barSize:e.barSize,minPointSize:e.minPointSize,maxBarSize:e.maxBarSize,isPanorama:n}),j.createElement(fye,qu({},e,{id:s}))))}var oh=j.memo(gye);oh.displayName="Bar";function Hz(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function i1(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Hz(Object(n),!0).forEach(function(s){xye(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Hz(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function xye(t,e,n){return(e=yye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yye(t){var e=bye(t,"string");return typeof e=="symbol"?e:e+""}function bye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var vye=(t,e)=>e,wye=(t,e,n)=>n,Nye=(t,e,n,s)=>s,Sye=(t,e,n,s,r)=>r,Bx=qe([pA,Sye],(t,e)=>t.filter(n=>n.type==="bar").find(n=>n.id===e)),jye=qe([Bx],t=>t==null?void 0:t.maxBarSize),kye=(t,e,n,s,r,a)=>a,Gz=(t,e,n)=>{var s=n??t;if(!Hr(s))return ol(s,e,0)},Cye=qe([ts,pA,vye,wye,Nye],(t,e,n,s,r)=>e.filter(a=>t==="horizontal"?a.xAxisId===n:a.yAxisId===s).filter(a=>a.isPanorama===r).filter(a=>a.hide===!1).filter(a=>a.type==="bar")),Tye=(t,e,n,s)=>{var r=ts(t);return r==="horizontal"?R_(t,"yAxis",n,s):R_(t,"xAxis",e,s)},_ye=(t,e,n)=>{var s=ts(t);return s==="horizontal"?ZF(t,"xAxis",e):ZF(t,"yAxis",n)},Eye=(t,e,n)=>{var s={},r=t.filter(sN),a=t.filter(u=>u.stackId==null),i=r.reduce((u,h)=>(u[h.stackId]||(u[h.stackId]=[]),u[h.stackId].push(h),u),s),l=Object.entries(i).map(u=>{var[h,f]=u,p=f.map(y=>y.dataKey),x=Gz(e,n,f[0].barSize);return{stackId:h,dataKeys:p,barSize:x}}),c=a.map(u=>{var h=[u.dataKey].filter(p=>p!=null),f=Gz(e,n,u.barSize);return{stackId:void 0,dataKeys:h,barSize:f}});return[...l,...c]},Aye=qe([Cye,Wme,_ye],Eye),$ye=(t,e,n,s,r)=>{var a,i,l=Bx(t,e,n,s,r);if(l!=null){var c=ts(t),u=E9(t),{maxBarSize:h}=l,f=Hr(h)?u:h,p,x;return c==="horizontal"?(p=uf(t,"xAxis",e,s),x=cf(t,"xAxis",e,s)):(p=uf(t,"yAxis",n,s),x=cf(t,"yAxis",n,s)),(a=(i=C4(p,x,!0))!==null&&i!==void 0?i:f)!==null&&a!==void 0?a:0}},pH=(t,e,n,s)=>{var r=ts(t),a,i;return r==="horizontal"?(a=uf(t,"xAxis",e,s),i=cf(t,"xAxis",e,s)):(a=uf(t,"yAxis",n,s),i=cf(t,"yAxis",n,s)),C4(a,i)};function Iye(t,e,n,s,r){var a=s.length;if(!(a<1)){var i=ol(t,n,0,!0),l,c=[];if(Zi(s[0].barSize)){var u=!1,h=n/a,f=s.reduce((N,S)=>N+(S.barSize||0),0);f+=(a-1)*i,f>=n&&(f-=(a-1)*i,i=0),f>=n&&h>0&&(u=!0,h*=.9,f=a*h);var p=(n-f)/2>>0,x={offset:p-i,size:0};l=s.reduce((N,S)=>{var k,T={stackId:S.stackId,dataKeys:S.dataKeys,position:{offset:x.offset+x.size+i,size:u?h:(k=S.barSize)!==null&&k!==void 0?k:0}},E=[...N,T];return x=E[E.length-1].position,E},c)}else{var y=ol(e,n,0,!0);n-2*y-(a-1)*i<=0&&(i=0);var v=(n-2*y-(a-1)*i)/a;v>1&&(v>>=0);var b=Zi(r)?Math.min(v,r):v;l=s.reduce((N,S,k)=>[...N,{stackId:S.stackId,dataKeys:S.dataKeys,position:{offset:y+(v+i)*k+(v-b)/2,size:b}}],c)}return l}}var Rye=(t,e,n,s,r,a,i)=>{var l=Hr(i)?e:i,c=Iye(n,s,r!==a?r:a,t,l);return r!==a&&c!=null&&(c=c.map(u=>i1(i1({},u),{},{position:i1(i1({},u.position),{},{offset:u.position.offset-r/2})}))),c},Oye=qe([Aye,E9,Vme,A9,$ye,pH,jye],Rye),Dye=(t,e,n,s)=>uf(t,"xAxis",e,s),Pye=(t,e,n,s)=>uf(t,"yAxis",n,s),Lye=(t,e,n,s)=>cf(t,"xAxis",e,s),Mye=(t,e,n,s)=>cf(t,"yAxis",n,s),Fye=qe([Oye,Bx],(t,e)=>{if(!(t==null||e==null)){var n=t.find(s=>s.stackId===e.stackId&&e.dataKey!=null&&s.dataKeys.includes(e.dataKey));if(n!=null)return n.position}}),zye=(t,e)=>{var n=mA(e);if(!(!t||n==null||e==null)){var{stackId:s}=e;if(s!=null){var r=t[s];if(r){var{stackedData:a}=r;if(a)return a.find(i=>i.key===n)}}}},Bye=qe([Tye,Bx],zye),Uye=qe([Kr,T4,Dye,Pye,Lye,Mye,Fye,ts,rA,pH,Bye,Bx,kye],(t,e,n,s,r,a,i,l,c,u,h,f,p)=>{var{chartData:x,dataStartIndex:y,dataEndIndex:v}=c;if(!(f==null||i==null||e==null||l!=="horizontal"&&l!=="vertical"||n==null||s==null||r==null||a==null||u==null)){var{data:b}=f,N;if(b!=null&&b.length>0?N=b:N=x==null?void 0:x.slice(y,v+1),N!=null)return pye({layout:l,barSettings:f,pos:i,parentViewBox:e,bandSize:u,xAxis:n,yAxis:s,xAxisTicks:r,yAxisTicks:a,stackedData:h,displayedData:N,offset:t,cells:p})}}),Vye=t=>{var{chartData:e}=t,n=xr(),s=Ro();return j.useEffect(()=>s?()=>{}:(n(lz(e)),()=>{n(lz(void 0))}),[e,n,s]),null},qz={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},gH=no({name:"brush",initialState:qz,reducers:{setBrushSettings(t,e){return e.payload==null?qz:e.payload}}}),{setBrushSettings:rXe}=gH.actions,Wye=gH.reducer;function Hye(t,e,n){return(e=Gye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gye(t){var e=qye(t,"string");return typeof e=="symbol"?e:e+""}function qye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DA{static create(e){return new DA(e)}constructor(e){this.scale=e}get domain(){return this.scale.domain}get range(){return this.scale.range}get rangeMin(){return this.range()[0]}get rangeMax(){return this.range()[1]}get bandwidth(){return this.scale.bandwidth}apply(e){var{bandAware:n,position:s}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(e!==void 0){if(s)switch(s){case"start":return this.scale(e);case"middle":{var r=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+r}case"end":{var a=this.bandwidth?this.bandwidth():0;return this.scale(e)+a}default:return this.scale(e)}if(n){var i=this.bandwidth?this.bandwidth()/2:0;return this.scale(e)+i}return this.scale(e)}}isInRange(e){var n=this.range(),s=n[0],r=n[n.length-1];return s<=r?e>=s&&e<=r:e>=r&&e<=s}}Hye(DA,"EPS",1e-4);function Kye(t){return(t%180+180)%180}var Xye=function(e){var{width:n,height:s}=e,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a=Kye(r),i=a*Math.PI/180,l=Math.atan(s/n),c=i>l&&i<Math.PI-l?s/Math.sin(i):n/Math.cos(i);return Math.abs(c)},Yye={dots:[],areas:[],lines:[]},xH=no({name:"referenceElements",initialState:Yye,reducers:{addDot:(t,e)=>{t.dots.push(e.payload)},removeDot:(t,e)=>{var n=jc(t).dots.findIndex(s=>s===e.payload);n!==-1&&t.dots.splice(n,1)},addArea:(t,e)=>{t.areas.push(e.payload)},removeArea:(t,e)=>{var n=jc(t).areas.findIndex(s=>s===e.payload);n!==-1&&t.areas.splice(n,1)},addLine:(t,e)=>{t.lines.push(e.payload)},removeLine:(t,e)=>{var n=jc(t).lines.findIndex(s=>s===e.payload);n!==-1&&t.lines.splice(n,1)}}}),{addDot:aXe,removeDot:iXe,addArea:oXe,removeArea:lXe,addLine:cXe,removeLine:uXe}=xH.actions,Qye=xH.reducer,Zye=j.createContext(void 0),Jye=t=>{var{children:e}=t,[n]=j.useState("".concat(Ug("recharts"),"-clip")),s=dH();if(s==null)return null;var{x:r,y:a,width:i,height:l}=s;return j.createElement(Zye.Provider,{value:n},j.createElement("defs",null,j.createElement("clipPath",{id:n},j.createElement("rect",{x:r,y:a,height:l,width:i}))),e)};function hf(t,e){for(var n in t)if({}.hasOwnProperty.call(t,n)&&(!{}.hasOwnProperty.call(e,n)||t[n]!==e[n]))return!1;for(var s in e)if({}.hasOwnProperty.call(e,s)&&!{}.hasOwnProperty.call(t,s))return!1;return!0}function yH(t,e,n){if(e<1)return[];if(e===1&&n===void 0)return t;for(var s=[],r=0;r<t.length;r+=e)s.push(t[r]);return s}function ebe(t,e,n){var s={width:t.width+e.width,height:t.height+e.height};return Xye(s,n)}function tbe(t,e,n){var s=n==="width",{x:r,y:a,width:i,height:l}=t;return e===1?{start:s?r:a,end:s?r+i:a+l}:{start:s?r+i:a+l,end:s?r:a}}function Fw(t,e,n,s,r){if(t*e<t*s||t*e>t*r)return!1;var a=n();return t*(e-t*a/2-s)>=0&&t*(e+t*a/2-r)<=0}function nbe(t,e){return yH(t,e+1)}function sbe(t,e,n,s,r){for(var a=(s||[]).slice(),{start:i,end:l}=e,c=0,u=1,h=i,f=function(){var y=s==null?void 0:s[c];if(y===void 0)return{v:yH(s,u)};var v=c,b,N=()=>(b===void 0&&(b=n(y,v)),b),S=y.coordinate,k=c===0||Fw(t,S,N,h,l);k||(c=0,h=i,u+=1),k&&(h=S+t*(N()/2+r),c+=u)},p;u<=a.length;)if(p=f(),p)return p.v;return[]}function Kz(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function xa(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Kz(Object(n),!0).forEach(function(s){rbe(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Kz(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function rbe(t,e,n){return(e=abe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function abe(t){var e=ibe(t,"string");return typeof e=="symbol"?e:e+""}function ibe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function obe(t,e,n,s,r){for(var a=(s||[]).slice(),i=a.length,{start:l}=e,{end:c}=e,u=function(p){var x=a[p],y,v=()=>(y===void 0&&(y=n(x,p)),y);if(p===i-1){var b=t*(x.coordinate+t*v()/2-c);a[p]=x=xa(xa({},x),{},{tickCoord:b>0?x.coordinate-b*t:x.coordinate})}else a[p]=x=xa(xa({},x),{},{tickCoord:x.coordinate});var N=Fw(t,x.tickCoord,v,l,c);N&&(c=x.tickCoord-t*(v()/2+r),a[p]=xa(xa({},x),{},{isShow:!0}))},h=i-1;h>=0;h--)u(h);return a}function lbe(t,e,n,s,r,a){var i=(s||[]).slice(),l=i.length,{start:c,end:u}=e;if(a){var h=s[l-1],f=n(h,l-1),p=t*(h.coordinate+t*f/2-u);i[l-1]=h=xa(xa({},h),{},{tickCoord:p>0?h.coordinate-p*t:h.coordinate});var x=Fw(t,h.tickCoord,()=>f,c,u);x&&(u=h.tickCoord-t*(f/2+r),i[l-1]=xa(xa({},h),{},{isShow:!0}))}for(var y=a?l-1:l,v=function(S){var k=i[S],T,E=()=>(T===void 0&&(T=n(k,S)),T);if(S===0){var D=t*(k.coordinate-t*E()/2-c);i[S]=k=xa(xa({},k),{},{tickCoord:D<0?k.coordinate-D*t:k.coordinate})}else i[S]=k=xa(xa({},k),{},{tickCoord:k.coordinate});var A=Fw(t,k.tickCoord,E,c,u);A&&(c=k.tickCoord+t*(E()/2+r),i[S]=xa(xa({},k),{},{isShow:!0}))},b=0;b<y;b++)v(b);return i}function PA(t,e,n){var{tick:s,ticks:r,viewBox:a,minTickGap:i,orientation:l,interval:c,tickFormatter:u,unit:h,angle:f}=t;if(!r||!r.length||!s)return[];if(qt(c)||Of.isSsr){var p;return(p=nbe(r,qt(c)?c:0))!==null&&p!==void 0?p:[]}var x=[],y=l==="top"||l==="bottom"?"width":"height",v=h&&y==="width"?Ag(h,{fontSize:e,letterSpacing:n}):{width:0,height:0},b=(k,T)=>{var E=typeof u=="function"?u(k.value,T):k.value;return y==="width"?ebe(Ag(E,{fontSize:e,letterSpacing:n}),v,f):Ag(E,{fontSize:e,letterSpacing:n})[y]},N=r.length>=2?di(r[1].coordinate-r[0].coordinate):1,S=tbe(a,N,y);return c==="equidistantPreserveStart"?sbe(N,S,b,r,i):(c==="preserveStart"||c==="preserveStartEnd"?x=lbe(N,S,b,r,i,c==="preserveStartEnd"):x=obe(N,S,b,r,i),x.filter(k=>k.isShow))}var cbe=t=>{var{ticks:e,label:n,labelGapWithTick:s=5,tickSize:r=0,tickMargin:a=0}=t,i=0;if(e){e.forEach(h=>{if(h){var f=h.getBoundingClientRect();f.width>i&&(i=f.width)}});var l=n?n.getBoundingClientRect().width:0,c=r+a,u=i+c+l+(n?s:0);return Math.round(u)}return 0},ube=["axisLine","width","height","className","hide","ticks"],dbe=["viewBox"],hbe=["viewBox"];function z_(t,e){if(t==null)return{};var n,s,r=mbe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(s=0;s<a.length;s++)n=a[s],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function mbe(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)!==-1)continue;n[s]=t[s]}return n}function yh(){return yh=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},yh.apply(null,arguments)}function Xz(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function kr(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Xz(Object(n),!0).forEach(function(s){fbe(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Xz(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function fbe(t,e,n){return(e=pbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pbe(t){var e=gbe(t,"string");return typeof e=="symbol"?e:e+""}function gbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var LA={x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"};function xbe(t){var{x:e,y:n,width:s,height:r,orientation:a,mirror:i,axisLine:l,otherSvgProps:c}=t;if(!l)return null;var u=kr(kr(kr({},c),ha(l,!1)),{},{fill:"none"});if(a==="top"||a==="bottom"){var h=+(a==="top"&&!i||a==="bottom"&&i);u=kr(kr({},u),{},{x1:e,y1:n+h*r,x2:e+s,y2:n+h*r})}else{var f=+(a==="left"&&!i||a==="right"&&i);u=kr(kr({},u),{},{x1:e+f*s,y1:n,x2:e+f*s,y2:n+r})}return j.createElement("line",yh({},u,{className:Dn("recharts-cartesian-axis-line",ef(l,"className"))}))}function ybe(t,e,n,s,r,a,i,l,c){var u,h,f,p,x,y,v=l?-1:1,b=t.tickSize||i,N=qt(t.tickCoord)?t.tickCoord:t.coordinate;switch(a){case"top":u=h=t.coordinate,p=n+ +!l*r,f=p-v*b,y=f-v*c,x=N;break;case"left":f=p=t.coordinate,h=e+ +!l*s,u=h-v*b,x=u-v*c,y=N;break;case"right":f=p=t.coordinate,h=e+ +l*s,u=h+v*b,x=u+v*c,y=N;break;default:u=h=t.coordinate,p=n+ +l*r,f=p+v*b,y=f+v*c,x=N;break}return{line:{x1:u,y1:f,x2:h,y2:p},tick:{x,y}}}function bbe(t,e){switch(t){case"left":return e?"start":"end";case"right":return e?"end":"start";default:return"middle"}}function vbe(t,e){switch(t){case"left":case"right":return"middle";case"top":return e?"start":"end";default:return e?"end":"start"}}function wbe(t){var{option:e,tickProps:n,value:s}=t,r,a=Dn(n.className,"recharts-cartesian-axis-tick-value");if(j.isValidElement(e))r=j.cloneElement(e,kr(kr({},n),{},{className:a}));else if(typeof e=="function")r=e(kr(kr({},n),{},{className:a}));else{var i="recharts-cartesian-axis-tick-value";typeof e!="boolean"&&(i=Dn(i,e==null?void 0:e.className)),r=j.createElement(IA,yh({},n,{className:i}),s)}return r}function Nbe(t){var{ticks:e=[],tick:n,tickLine:s,stroke:r,tickFormatter:a,unit:i,padding:l,tickTextProps:c,orientation:u,mirror:h,x:f,y:p,width:x,height:y,tickSize:v,tickMargin:b,fontSize:N,letterSpacing:S,getTicksConfig:k,events:T}=t,E=PA(kr(kr({},k),{},{ticks:e}),N,S),D=bbe(u,h),A=vbe(u,h),I=Rf(k),P=ha(n,!1),$=kr(kr({},I),{},{fill:"none"},ha(s,!1)),R=E.map((F,W)=>{var{line:q,tick:X}=ybe(F,f,p,x,y,u,v,h,b),z=kr(kr(kr(kr({textAnchor:D,verticalAnchor:A},I),{},{stroke:"none",fill:r},P),X),{},{index:W,payload:F,visibleTicksCount:E.length,tickFormatter:a,padding:l},c);return j.createElement(Gu,yh({className:"recharts-cartesian-axis-tick",key:"tick-".concat(F.value,"-").concat(F.coordinate,"-").concat(F.tickCoord)},I2(T,F,W)),s&&j.createElement("line",yh({},$,q,{className:Dn("recharts-cartesian-axis-tick-line",ef(s,"className"))})),n&&j.createElement(wbe,{option:n,tickProps:z,value:"".concat(typeof a=="function"?a(F.value,W):F.value).concat(i||"")}))});return R.length>0?j.createElement("g",{className:"recharts-cartesian-axis-ticks"},R):null}var Sbe=j.forwardRef((t,e)=>{var{axisLine:n,width:s,height:r,className:a,hide:i,ticks:l}=t,c=z_(t,ube),[u,h]=j.useState(""),[f,p]=j.useState(""),x=j.useRef([]);j.useImperativeHandle(e,()=>({getCalculatedWidth:()=>{var v;return cbe({ticks:x.current,label:(v=t.labelRef)===null||v===void 0?void 0:v.current,labelGapWithTick:5,tickSize:t.tickSize,tickMargin:t.tickMargin})}}));var y=j.useCallback(v=>{if(v){var b=v.getElementsByClassName("recharts-cartesian-axis-tick-value");x.current=Array.from(b);var N=b[0];if(N){var S=window.getComputedStyle(N),k=S.fontSize,T=S.letterSpacing;(k!==u||T!==f)&&(h(k),p(T))}}},[u,f]);return i||s!=null&&s<=0||r!=null&&r<=0?null:j.createElement(Gu,{className:Dn("recharts-cartesian-axis",a),ref:y},j.createElement(xbe,{x:t.x,y:t.y,width:s,height:r,orientation:t.orientation,mirror:t.mirror,axisLine:n,otherSvgProps:Rf(t)}),j.createElement(Nbe,{ticks:l,tick:t.tick,tickLine:t.tickLine,stroke:t.stroke,tickFormatter:t.tickFormatter,unit:t.unit,padding:t.padding,tickTextProps:t.tickTextProps,orientation:t.orientation,mirror:t.mirror,x:t.x,y:t.y,width:t.width,height:t.height,tickSize:t.tickSize,tickMargin:t.tickMargin,fontSize:u,letterSpacing:f,getTicksConfig:t,events:c}),j.createElement(dge,{x:t.x,y:t.y,width:t.width,height:t.height},j.createElement(wge,{label:t.label}),t.children))}),jbe=j.memo(Sbe,(t,e)=>{var{viewBox:n}=t,s=z_(t,dbe),{viewBox:r}=e,a=z_(e,hbe);return hf(n,r)&&hf(s,a)}),MA=j.forwardRef((t,e)=>{var n=Oo(t,LA);return j.createElement(jbe,yh({},n,{ref:e}))});MA.displayName="CartesianAxis";var kbe=["x1","y1","x2","y2","key"],Cbe=["offset"],Tbe=["xAxisId","yAxisId"],_be=["xAxisId","yAxisId"];function Yz(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function ba(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Yz(Object(n),!0).forEach(function(s){Ebe(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Yz(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function Ebe(t,e,n){return(e=Abe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Abe(t){var e=$be(t,"string");return typeof e=="symbol"?e:e+""}function $be(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jd(){return Jd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Jd.apply(null,arguments)}function zw(t,e){if(t==null)return{};var n,s,r=Ibe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(s=0;s<a.length;s++)n=a[s],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Ibe(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)!==-1)continue;n[s]=t[s]}return n}var Rbe=t=>{var{fill:e}=t;if(!e||e==="none")return null;var{fillOpacity:n,x:s,y:r,width:a,height:i,ry:l}=t;return j.createElement("rect",{x:s,y:r,ry:l,width:a,height:i,stroke:"none",fill:e,fillOpacity:n,className:"recharts-cartesian-grid-bg"})};function bH(t,e){var n;if(j.isValidElement(t))n=j.cloneElement(t,e);else if(typeof t=="function")n=t(e);else{var{x1:s,y1:r,x2:a,y2:i,key:l}=e,c=zw(e,kbe),u=Rf(c),{offset:h}=u,f=zw(u,Cbe);n=j.createElement("line",Jd({},f,{x1:s,y1:r,x2:a,y2:i,fill:"none",key:l}))}return n}function Obe(t){var{x:e,width:n,horizontal:s=!0,horizontalPoints:r}=t;if(!s||!r||!r.length)return null;var{xAxisId:a,yAxisId:i}=t,l=zw(t,Tbe),c=r.map((u,h)=>{var f=ba(ba({},l),{},{x1:e,y1:u,x2:e+n,y2:u,key:"line-".concat(h),index:h});return bH(s,f)});return j.createElement("g",{className:"recharts-cartesian-grid-horizontal"},c)}function Dbe(t){var{y:e,height:n,vertical:s=!0,verticalPoints:r}=t;if(!s||!r||!r.length)return null;var{xAxisId:a,yAxisId:i}=t,l=zw(t,_be),c=r.map((u,h)=>{var f=ba(ba({},l),{},{x1:u,y1:e,x2:u,y2:e+n,key:"line-".concat(h),index:h});return bH(s,f)});return j.createElement("g",{className:"recharts-cartesian-grid-vertical"},c)}function Pbe(t){var{horizontalFill:e,fillOpacity:n,x:s,y:r,width:a,height:i,horizontalPoints:l,horizontal:c=!0}=t;if(!c||!e||!e.length)return null;var u=l.map(f=>Math.round(f+r-r)).sort((f,p)=>f-p);r!==u[0]&&u.unshift(0);var h=u.map((f,p)=>{var x=!u[p+1],y=x?r+i-f:u[p+1]-f;if(y<=0)return null;var v=p%e.length;return j.createElement("rect",{key:"react-".concat(p),y:f,x:s,height:y,width:a,stroke:"none",fill:e[v],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return j.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},h)}function Lbe(t){var{vertical:e=!0,verticalFill:n,fillOpacity:s,x:r,y:a,width:i,height:l,verticalPoints:c}=t;if(!e||!n||!n.length)return null;var u=c.map(f=>Math.round(f+r-r)).sort((f,p)=>f-p);r!==u[0]&&u.unshift(0);var h=u.map((f,p)=>{var x=!u[p+1],y=x?r+i-f:u[p+1]-f;if(y<=0)return null;var v=p%n.length;return j.createElement("rect",{key:"react-".concat(p),x:f,y:a,width:y,height:l,stroke:"none",fill:n[v],fillOpacity:s,className:"recharts-cartesian-grid-bg"})});return j.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},h)}var Mbe=(t,e)=>{var{xAxis:n,width:s,height:r,offset:a}=t;return bV(PA(ba(ba(ba({},LA),n),{},{ticks:vV(n),viewBox:{x:0,y:0,width:s,height:r}})),a.left,a.left+a.width,e)},Fbe=(t,e)=>{var{yAxis:n,width:s,height:r,offset:a}=t;return bV(PA(ba(ba(ba({},LA),n),{},{ticks:vV(n),viewBox:{x:0,y:0,width:s,height:r}})),a.top,a.top+a.height,e)},zbe={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[],xAxisId:0,yAxisId:0};function $g(t){var e=E4(),n=A4(),s=SV(),r=ba(ba({},Oo(t,zbe)),{},{x:qt(t.x)?t.x:s.left,y:qt(t.y)?t.y:s.top,width:qt(t.width)?t.width:s.width,height:qt(t.height)?t.height:s.height}),{xAxisId:a,yAxisId:i,x:l,y:c,width:u,height:h,syncWithTicks:f,horizontalValues:p,verticalValues:x}=r,y=Ro(),v=Gt(P=>JF(P,"xAxis",a,y)),b=Gt(P=>JF(P,"yAxis",i,y));if(!qt(u)||u<=0||!qt(h)||h<=0||!qt(l)||l!==+l||!qt(c)||c!==+c)return null;var N=r.verticalCoordinatesGenerator||Mbe,S=r.horizontalCoordinatesGenerator||Fbe,{horizontalPoints:k,verticalPoints:T}=r;if((!k||!k.length)&&typeof S=="function"){var E=p&&p.length,D=S({yAxis:b?ba(ba({},b),{},{ticks:E?p:b.ticks}):void 0,width:e,height:n,offset:s},E?!0:f);Eg(Array.isArray(D),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(typeof D,"]")),Array.isArray(D)&&(k=D)}if((!T||!T.length)&&typeof N=="function"){var A=x&&x.length,I=N({xAxis:v?ba(ba({},v),{},{ticks:A?x:v.ticks}):void 0,width:e,height:n,offset:s},A?!0:f);Eg(Array.isArray(I),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(typeof I,"]")),Array.isArray(I)&&(T=I)}return j.createElement("g",{className:"recharts-cartesian-grid"},j.createElement(Rbe,{fill:r.fill,fillOpacity:r.fillOpacity,x:r.x,y:r.y,width:r.width,height:r.height,ry:r.ry}),j.createElement(Pbe,Jd({},r,{horizontalPoints:k})),j.createElement(Lbe,Jd({},r,{verticalPoints:T})),j.createElement(Obe,Jd({},r,{offset:s,horizontalPoints:k,xAxis:v,yAxis:b})),j.createElement(Dbe,Jd({},r,{offset:s,verticalPoints:T,xAxis:v,yAxis:b})))}$g.displayName="CartesianGrid";var Bbe=["dangerouslySetInnerHTML","ticks"],Ube=["id"],Vbe=["domain"],Wbe=["domain"];function B_(){return B_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},B_.apply(null,arguments)}function Bw(t,e){if(t==null)return{};var n,s,r=Hbe(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(s=0;s<a.length;s++)n=a[s],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Hbe(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)!==-1)continue;n[s]=t[s]}return n}function Gbe(t){var e=xr();return j.useEffect(()=>(e(wxe(t)),()=>{e(Nxe(t))}),[t,e]),null}var qbe=t=>{var{xAxisId:e,className:n}=t,s=Gt(T4),r=Ro(),a="xAxis",i=Gt(b=>zf(b,a,e,r)),l=Gt(b=>vW(b,a,e,r)),c=Gt(b=>gW(b,e)),u=Gt(b=>Pfe(b,e)),h=Gt(b=>F9(b,e));if(c==null||u==null||h==null)return null;var{dangerouslySetInnerHTML:f,ticks:p}=t,x=Bw(t,Bbe),{id:y}=h,v=Bw(h,Ube);return j.createElement(MA,B_({},x,v,{scale:i,x:u.x,y:u.y,width:c.width,height:c.height,className:Dn("recharts-".concat(a," ").concat(a),n),viewBox:s,ticks:l}))},Kbe={allowDataOverflow:Oi.allowDataOverflow,allowDecimals:Oi.allowDecimals,allowDuplicatedCategory:Oi.allowDuplicatedCategory,height:Oi.height,hide:!1,mirror:Oi.mirror,orientation:Oi.orientation,padding:Oi.padding,reversed:Oi.reversed,scale:Oi.scale,tickCount:Oi.tickCount,type:Oi.type,xAxisId:0},Xbe=t=>{var e,n,s,r,a,i=Oo(t,Kbe);return j.createElement(j.Fragment,null,j.createElement(Gbe,{interval:(e=i.interval)!==null&&e!==void 0?e:"preserveEnd",id:i.xAxisId,scale:i.scale,type:i.type,padding:i.padding,allowDataOverflow:i.allowDataOverflow,domain:i.domain,dataKey:i.dataKey,allowDuplicatedCategory:i.allowDuplicatedCategory,allowDecimals:i.allowDecimals,tickCount:i.tickCount,includeHidden:(n=i.includeHidden)!==null&&n!==void 0?n:!1,reversed:i.reversed,ticks:i.ticks,height:i.height,orientation:i.orientation,mirror:i.mirror,hide:i.hide,unit:i.unit,name:i.name,angle:(s=i.angle)!==null&&s!==void 0?s:0,minTickGap:(r=i.minTickGap)!==null&&r!==void 0?r:5,tick:(a=i.tick)!==null&&a!==void 0?a:!0,tickFormatter:i.tickFormatter}),j.createElement(qbe,i))},Ybe=(t,e)=>{var{domain:n}=t,s=Bw(t,Vbe),{domain:r}=e,a=Bw(e,Wbe);return hf(s,a)?Array.isArray(n)&&n.length===2&&Array.isArray(r)&&r.length===2?n[0]===r[0]&&n[1]===r[1]:hf({domain:n},{domain:r}):!1},Ig=j.memo(Xbe,Ybe);Ig.displayName="XAxis";var Qbe=["dangerouslySetInnerHTML","ticks"],Zbe=["id"],Jbe=["domain"],eve=["domain"];function U_(){return U_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},U_.apply(null,arguments)}function Uw(t,e){if(t==null)return{};var n,s,r=tve(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(s=0;s<a.length;s++)n=a[s],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function tve(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)!==-1)continue;n[s]=t[s]}return n}function nve(t){var e=xr();return j.useEffect(()=>(e(Sxe(t)),()=>{e(jxe(t))}),[t,e]),null}var sve=t=>{var{yAxisId:e,className:n,width:s,label:r}=t,a=j.useRef(null),i=j.useRef(null),l=Gt(T4),c=Ro(),u=xr(),h="yAxis",f=Gt(E=>zf(E,h,e,c)),p=Gt(E=>xW(E,e)),x=Gt(E=>Mfe(E,e)),y=Gt(E=>vW(E,h,e,c)),v=Gt(E=>z9(E,e));if(j.useLayoutEffect(()=>{if(!(s!=="auto"||!p||RA(r)||j.isValidElement(r)||v==null)){var E=a.current;if(E){var D=E.getCalculatedWidth();Math.round(p.width)!==Math.round(D)&&u(kxe({id:e,width:D}))}}},[y,p,u,r,e,s,v]),p==null||x==null||v==null)return null;var{dangerouslySetInnerHTML:b,ticks:N}=t,S=Uw(t,Qbe),{id:k}=v,T=Uw(v,Zbe);return j.createElement(MA,U_({},S,T,{ref:a,labelRef:i,scale:f,x:x.x,y:x.y,tickTextProps:s==="auto"?{width:void 0}:{width:s},width:p.width,height:p.height,className:Dn("recharts-".concat(h," ").concat(h),n),viewBox:l,ticks:y}))},rve={allowDataOverflow:Di.allowDataOverflow,allowDecimals:Di.allowDecimals,allowDuplicatedCategory:Di.allowDuplicatedCategory,hide:!1,mirror:Di.mirror,orientation:Di.orientation,padding:Di.padding,reversed:Di.reversed,scale:Di.scale,tickCount:Di.tickCount,type:Di.type,width:Di.width,yAxisId:0},ave=t=>{var e,n,s,r,a,i=Oo(t,rve);return j.createElement(j.Fragment,null,j.createElement(nve,{interval:(e=i.interval)!==null&&e!==void 0?e:"preserveEnd",id:i.yAxisId,scale:i.scale,type:i.type,domain:i.domain,allowDataOverflow:i.allowDataOverflow,dataKey:i.dataKey,allowDuplicatedCategory:i.allowDuplicatedCategory,allowDecimals:i.allowDecimals,tickCount:i.tickCount,padding:i.padding,includeHidden:(n=i.includeHidden)!==null&&n!==void 0?n:!1,reversed:i.reversed,ticks:i.ticks,width:i.width,orientation:i.orientation,mirror:i.mirror,hide:i.hide,unit:i.unit,name:i.name,angle:(s=i.angle)!==null&&s!==void 0?s:0,minTickGap:(r=i.minTickGap)!==null&&r!==void 0?r:5,tick:(a=i.tick)!==null&&a!==void 0?a:!0,tickFormatter:i.tickFormatter}),j.createElement(sve,i))},ive=(t,e)=>{var{domain:n}=t,s=Uw(t,Jbe),{domain:r}=e,a=Uw(e,eve);return hf(s,a)?Array.isArray(n)&&n.length===2&&Array.isArray(r)&&r.length===2?n[0]===r[0]&&n[1]===r[1]:hf({domain:n},{domain:r}):!1},Rg=j.memo(ave,ive);Rg.displayName="YAxis";var b3={exports:{}},v3={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qz;function ove(){if(Qz)return v3;Qz=1;var t=Tf();function e(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var n=typeof Object.is=="function"?Object.is:e,s=t.useSyncExternalStore,r=t.useRef,a=t.useEffect,i=t.useMemo,l=t.useDebugValue;return v3.useSyncExternalStoreWithSelector=function(c,u,h,f,p){var x=r(null);if(x.current===null){var y={hasValue:!1,value:null};x.current=y}else y=x.current;x=i(function(){function b(E){if(!N){if(N=!0,S=E,E=f(E),p!==void 0&&y.hasValue){var D=y.value;if(p(D,E))return k=D}return k=E}if(D=k,n(S,E))return D;var A=f(E);return p!==void 0&&p(D,A)?(S=E,D):(S=E,k=A)}var N=!1,S,k,T=h===void 0?null:h;return[function(){return b(u())},T===null?void 0:function(){return b(T())}]},[u,h,f,p]);var v=s(c,x[0],x[1]);return a(function(){y.hasValue=!0,y.value=v},[v]),l(v),v},v3}var Zz;function lve(){return Zz||(Zz=1,b3.exports=ove()),b3.exports}lve();function cve(t){t()}function uve(){let t=null,e=null;return{clear(){t=null,e=null},notify(){cve(()=>{let n=t;for(;n;)n.callback(),n=n.next})},get(){const n=[];let s=t;for(;s;)n.push(s),s=s.next;return n},subscribe(n){let s=!0;const r=e={callback:n,next:null,prev:e};return r.prev?r.prev.next=r:t=r,function(){!s||t===null||(s=!1,r.next?r.next.prev=r.prev:e=r.prev,r.prev?r.prev.next=r.next:t=r.next)}}}}var Jz={notify(){},get:()=>[]};function dve(t,e){let n,s=Jz,r=0,a=!1;function i(v){h();const b=s.subscribe(v);let N=!1;return()=>{N||(N=!0,b(),f())}}function l(){s.notify()}function c(){y.onStateChange&&y.onStateChange()}function u(){return a}function h(){r++,n||(n=t.subscribe(c),s=uve())}function f(){r--,n&&r===0&&(n(),n=void 0,s.clear(),s=Jz)}function p(){a||(a=!0,h())}function x(){a&&(a=!1,f())}const y={addNestedSub:i,notifyNestedSubs:l,handleChangeWrapper:c,isSubscribed:u,trySubscribe:p,tryUnsubscribe:x,getListeners:()=>s};return y}var hve=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",mve=hve(),fve=()=>typeof navigator<"u"&&navigator.product==="ReactNative",pve=fve(),gve=()=>mve||pve?j.useLayoutEffect:j.useEffect,xve=gve(),w3=Symbol.for("react-redux-context"),N3=typeof globalThis<"u"?globalThis:{};function yve(){if(!j.createContext)return{};const t=N3[w3]??(N3[w3]=new Map);let e=t.get(j.createContext);return e||(e=j.createContext(null),t.set(j.createContext,e)),e}var bve=yve();function vve(t){const{children:e,context:n,serverState:s,store:r}=t,a=j.useMemo(()=>{const c=dve(r);return{store:r,subscription:c,getServerState:s?()=>s:void 0}},[r,s]),i=j.useMemo(()=>r.getState(),[r]);xve(()=>{const{subscription:c}=a;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),i!==r.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[a,i]);const l=n||bve;return j.createElement(l.Provider,{value:a},e)}var wve=vve,Nve=(t,e)=>e,FA=qe([Nve,ts,P9,Rr,DW,qc,Upe,Kr],qpe),zA=t=>{var e=t.currentTarget.getBoundingClientRect(),n=e.width/t.currentTarget.offsetWidth,s=e.height/t.currentTarget.offsetHeight;return{chartX:Math.round((t.clientX-e.left)/n),chartY:Math.round((t.clientY-e.top)/s)}},vH=Ao("mouseClick"),wH=_x();wH.startListening({actionCreator:vH,effect:(t,e)=>{var n=t.payload,s=FA(e.getState(),zA(n));(s==null?void 0:s.activeIndex)!=null&&e.dispatch(Qfe({activeIndex:s.activeIndex,activeDataKey:void 0,activeCoordinate:s.activeCoordinate}))}});var V_=Ao("mouseMove"),NH=_x();NH.startListening({actionCreator:V_,effect:(t,e)=>{var n=t.payload,s=e.getState(),r=SA(s,s.tooltip.settings.shared),a=FA(s,zA(n));r==="axis"&&((a==null?void 0:a.activeIndex)!=null?e.dispatch(_W({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate})):e.dispatch(TW()))}});var e8={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},SH=no({name:"rootProps",initialState:e8,reducers:{updateOptions:(t,e)=>{var n;t.accessibilityLayer=e.payload.accessibilityLayer,t.barCategoryGap=e.payload.barCategoryGap,t.barGap=(n=e.payload.barGap)!==null&&n!==void 0?n:e8.barGap,t.barSize=e.payload.barSize,t.maxBarSize=e.payload.maxBarSize,t.stackOffset=e.payload.stackOffset,t.syncId=e.payload.syncId,t.syncMethod=e.payload.syncMethod,t.className=e.payload.className}}}),Sve=SH.reducer,{updateOptions:jve}=SH.actions,jH=no({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(t,e)=>e.payload}}),{updatePolarOptions:dXe}=jH.actions,kve=jH.reducer,kH=Ao("keyDown"),CH=Ao("focus"),BA=_x();BA.startListening({actionCreator:kH,effect:(t,e)=>{var n=e.getState(),s=n.rootProps.accessibilityLayer!==!1;if(s){var{keyboardInteraction:r}=n.tooltip,a=t.payload;if(!(a!=="ArrowRight"&&a!=="ArrowLeft"&&a!=="Enter")){var i=Number(jA(r,Uf(n))),l=qc(n);if(a==="Enter"){var c=Rw(n,"axis","hover",String(r.index));e.dispatch(D_({active:!r.active,activeIndex:r.index,activeDataKey:r.dataKey,activeCoordinate:c}));return}var u=Ufe(n),h=u==="left-to-right"?1:-1,f=a==="ArrowRight"?1:-1,p=i+f*h;if(!(l==null||p>=l.length||p<0)){var x=Rw(n,"axis","hover",String(p));e.dispatch(D_({active:!0,activeIndex:p.toString(),activeDataKey:void 0,activeCoordinate:x}))}}}}});BA.startListening({actionCreator:CH,effect:(t,e)=>{var n=e.getState(),s=n.rootProps.accessibilityLayer!==!1;if(s){var{keyboardInteraction:r}=n.tooltip;if(!r.active&&r.index==null){var a="0",i=Rw(n,"axis","hover",String(a));e.dispatch(D_({activeDataKey:void 0,active:!0,activeIndex:a,activeCoordinate:i}))}}}});var jo=Ao("externalEvent"),TH=_x();TH.startListening({actionCreator:jo,effect:(t,e)=>{if(t.payload.handler!=null){var n=e.getState(),s={activeCoordinate:Rpe(n),activeDataKey:FW(n),activeIndex:df(n),activeLabel:MW(n),activeTooltipIndex:df(n),isTooltipActive:Ope(n)};t.payload.handler(s,t.payload.reactEvent)}}});var Cve=qe([Bf],t=>t.tooltipItemPayloads),Tve=qe([Cve,Fx,(t,e,n)=>e,(t,e,n)=>n],(t,e,n,s)=>{var r=t.find(l=>l.settings.dataKey===s);if(r!=null){var{positions:a}=r;if(a!=null){var i=e(a,n);return i}}}),_H=Ao("touchMove"),EH=_x();EH.startListening({actionCreator:_H,effect:(t,e)=>{var n=t.payload,s=e.getState(),r=SA(s,s.tooltip.settings.shared);if(r==="axis"){var a=FA(s,zA({clientX:n.touches[0].clientX,clientY:n.touches[0].clientY,currentTarget:n.currentTarget}));(a==null?void 0:a.activeIndex)!=null&&e.dispatch(_W({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate}))}else if(r==="item"){var i,l=n.touches[0],c=document.elementFromPoint(l.clientX,l.clientY);if(!c||!c.getAttribute)return;var u=c.getAttribute(hce),h=(i=c.getAttribute(mce))!==null&&i!==void 0?i:void 0,f=Tve(e.getState(),u,h);e.dispatch(CW({activeDataKey:h,activeIndex:u,activeCoordinate:f}))}}});var _ve=XU({brush:Wye,cartesianAxis:Cxe,chartData:u0e,errorBars:zxe,graphicalItems:pxe,layout:Dle,legend:Ace,options:a0e,polarAxis:Lge,polarOptions:kve,referenceElements:Qye,rootProps:Sve,tooltip:Zfe}),Eve=function(e){return ile({reducer:_ve,preloadedState:e,middleware:n=>n({serializableCheck:!1}).concat([wH.middleware,NH.middleware,BA.middleware,TH.middleware,EH.middleware]),devTools:Of.devToolsEnabled})};function Ave(t){var{preloadedState:e,children:n,reduxStoreName:s}=t,r=Ro(),a=j.useRef(null);if(r)return n;a.current==null&&(a.current=Eve(e));var i=v4;return j.createElement(wve,{context:i,store:a.current},n)}function $ve(t){var{layout:e,width:n,height:s,margin:r}=t,a=xr(),i=Ro();return j.useEffect(()=>{i||(a(Ile(e)),a(Rle({width:n,height:s})),a($le(r)))},[a,i,e,n,s,r]),null}function Ive(t){var e=xr();return j.useEffect(()=>{e(jve(t))},[e,t]),null}var Rve=["children"];function Ove(t,e){if(t==null)return{};var n,s,r=Dve(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(s=0;s<a.length;s++)n=a[s],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Dve(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)!==-1)continue;n[s]=t[s]}return n}function Vw(){return Vw=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},Vw.apply(null,arguments)}var Pve={width:"100%",height:"100%"},Lve=j.forwardRef((t,e)=>{var n=E4(),s=A4(),r=kV();if(!xw(n)||!xw(s))return null;var{children:a,otherAttributes:i,title:l,desc:c}=t,u,h;return typeof i.tabIndex=="number"?u=i.tabIndex:u=r?0:void 0,typeof i.role=="string"?h=i.role:h=r?"application":void 0,j.createElement(d4,Vw({},i,{title:l,desc:c,role:h,tabIndex:u,width:n,height:s,style:Pve,ref:e}),a)}),Mve=t=>{var{children:e}=t,n=Gt(H2);if(!n)return null;var{width:s,height:r,y:a,x:i}=n;return j.createElement(d4,{width:s,height:r,x:i,y:a},e)},t8=j.forwardRef((t,e)=>{var{children:n}=t,s=Ove(t,Rve),r=Ro();return r?j.createElement(Mve,null,n):j.createElement(Lve,Vw({ref:e},s),n)});function Fve(){var t=xr(),[e,n]=j.useState(null),s=Gt(dce);return j.useEffect(()=>{if(e!=null){var r=e.getBoundingClientRect(),a=r.width/e.offsetWidth;Zi(a)&&a!==s&&t(Ole(a))}},[e,t,s]),n}function n8(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function zve(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?n8(Object(n),!0).forEach(function(s){Bve(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):n8(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function Bve(t,e,n){return(e=Uve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Uve(t){var e=Vve(t,"string");return typeof e=="symbol"?e:e+""}function Vve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var Wve=j.forwardRef((t,e)=>{var{children:n,className:s,height:r,onClick:a,onContextMenu:i,onDoubleClick:l,onMouseDown:c,onMouseEnter:u,onMouseLeave:h,onMouseMove:f,onMouseUp:p,onTouchEnd:x,onTouchMove:y,onTouchStart:v,style:b,width:N}=t,S=xr(),[k,T]=j.useState(null),[E,D]=j.useState(null);b0e();var A=Fve(),I=j.useCallback(U=>{A(U),typeof e=="function"&&e(U),T(U),D(U)},[A,e,T,D]),P=j.useCallback(U=>{S(vH(U)),S(jo({handler:a,reactEvent:U}))},[S,a]),$=j.useCallback(U=>{S(V_(U)),S(jo({handler:u,reactEvent:U}))},[S,u]),R=j.useCallback(U=>{S(TW()),S(jo({handler:h,reactEvent:U}))},[S,h]),F=j.useCallback(U=>{S(V_(U)),S(jo({handler:f,reactEvent:U}))},[S,f]),W=j.useCallback(()=>{S(CH())},[S]),q=j.useCallback(U=>{S(kH(U.key))},[S]),X=j.useCallback(U=>{S(jo({handler:i,reactEvent:U}))},[S,i]),z=j.useCallback(U=>{S(jo({handler:l,reactEvent:U}))},[S,l]),K=j.useCallback(U=>{S(jo({handler:c,reactEvent:U}))},[S,c]),H=j.useCallback(U=>{S(jo({handler:p,reactEvent:U}))},[S,p]),Y=j.useCallback(U=>{S(jo({handler:v,reactEvent:U}))},[S,v]),B=j.useCallback(U=>{S(_H(U)),S(jo({handler:y,reactEvent:U}))},[S,y]),O=j.useCallback(U=>{S(jo({handler:x,reactEvent:U}))},[S,x]);return j.createElement(HW.Provider,{value:k},j.createElement(gU.Provider,{value:E},j.createElement("div",{className:Dn("recharts-wrapper",s),style:zve({position:"relative",cursor:"default",width:N,height:r},b),onClick:P,onContextMenu:X,onDoubleClick:z,onFocus:W,onKeyDown:q,onMouseDown:K,onMouseEnter:$,onMouseLeave:R,onMouseMove:F,onMouseUp:H,onTouchEnd:O,onTouchMove:B,onTouchStart:Y,ref:I},n)))}),Hve=["children","className","width","height","style","compact","title","desc"];function Gve(t,e){if(t==null)return{};var n,s,r=qve(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(s=0;s<a.length;s++)n=a[s],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function qve(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)!==-1)continue;n[s]=t[s]}return n}var Kve=j.forwardRef((t,e)=>{var{children:n,className:s,width:r,height:a,style:i,compact:l,title:c,desc:u}=t,h=Gve(t,Hve),f=Rf(h);return l?j.createElement(t8,{otherAttributes:f,title:c,desc:u},n):j.createElement(Wve,{className:s,style:i,width:r,height:a,onClick:t.onClick,onMouseLeave:t.onMouseLeave,onMouseEnter:t.onMouseEnter,onMouseMove:t.onMouseMove,onMouseDown:t.onMouseDown,onMouseUp:t.onMouseUp,onContextMenu:t.onContextMenu,onDoubleClick:t.onDoubleClick,onTouchStart:t.onTouchStart,onTouchMove:t.onTouchMove,onTouchEnd:t.onTouchEnd},j.createElement(t8,{otherAttributes:f,title:c,desc:u,ref:e},j.createElement(Jye,null,n)))}),Xve=["width","height"];function W_(){return W_=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},W_.apply(null,arguments)}function Yve(t,e){if(t==null)return{};var n,s,r=Qve(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(s=0;s<a.length;s++)n=a[s],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Qve(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)!==-1)continue;n[s]=t[s]}return n}var Zve={top:5,right:5,bottom:5,left:5},Jve={accessibilityLayer:!0,layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:Zve,reverseStackOrder:!1,syncMethod:"index"},e1e=j.forwardRef(function(e,n){var s,r=Oo(e.categoricalChartProps,Jve),{width:a,height:i}=r,l=Yve(r,Xve);if(!xw(a)||!xw(i))return null;var{chartName:c,defaultTooltipEventType:u,validateTooltipEventTypes:h,tooltipPayloadSearcher:f,categoricalChartProps:p}=e,x={chartName:c,defaultTooltipEventType:u,validateTooltipEventTypes:h,tooltipPayloadSearcher:f,eventEmitter:void 0};return j.createElement(Ave,{preloadedState:{options:x},reduxStoreName:(s=p.id)!==null&&s!==void 0?s:c},j.createElement(Vye,{chartData:p.data}),j.createElement($ve,{width:a,height:i,layout:r.layout,margin:r.margin}),j.createElement(Ive,{accessibilityLayer:r.accessibilityLayer,barCategoryGap:r.barCategoryGap,maxBarSize:r.maxBarSize,stackOffset:r.stackOffset,barGap:r.barGap,barSize:r.barSize,syncId:r.syncId,syncMethod:r.syncMethod,className:r.className}),j.createElement(Kve,W_({},l,{width:a,height:i,ref:n})))}),t1e=["axis","item"],P1=j.forwardRef((t,e)=>j.createElement(e1e,{chartName:"BarChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:t1e,tooltipPayloadSearcher:s0e,categoricalChartProps:t,ref:e}));function n1e(t){if(typeof document>"u")return;let e=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",e.firstChild?e.insertBefore(n,e.firstChild):e.appendChild(n),n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t))}n1e(`:root{--toastify-color-light: #fff;--toastify-color-dark: #121212;--toastify-color-info: #3498db;--toastify-color-success: #07bc0c;--toastify-color-warning: #f1c40f;--toastify-color-error: hsl(6, 78%, 57%);--toastify-color-transparent: rgba(255, 255, 255, .7);--toastify-icon-color-info: var(--toastify-color-info);--toastify-icon-color-success: var(--toastify-color-success);--toastify-icon-color-warning: var(--toastify-color-warning);--toastify-icon-color-error: var(--toastify-color-error);--toastify-container-width: fit-content;--toastify-toast-width: 320px;--toastify-toast-offset: 16px;--toastify-toast-top: max(var(--toastify-toast-offset), env(safe-area-inset-top));--toastify-toast-right: max(var(--toastify-toast-offset), env(safe-area-inset-right));--toastify-toast-left: max(var(--toastify-toast-offset), env(safe-area-inset-left));--toastify-toast-bottom: max(var(--toastify-toast-offset), env(safe-area-inset-bottom));--toastify-toast-background: #fff;--toastify-toast-padding: 14px;--toastify-toast-min-height: 64px;--toastify-toast-max-height: 800px;--toastify-toast-bd-radius: 6px;--toastify-toast-shadow: 0px 4px 12px rgba(0, 0, 0, .1);--toastify-font-family: sans-serif;--toastify-z-index: 9999;--toastify-text-color-light: #757575;--toastify-text-color-dark: #fff;--toastify-text-color-info: #fff;--toastify-text-color-success: #fff;--toastify-text-color-warning: #fff;--toastify-text-color-error: #fff;--toastify-spinner-color: #616161;--toastify-spinner-color-empty-area: #e0e0e0;--toastify-color-progress-light: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55);--toastify-color-progress-dark: #bb86fc;--toastify-color-progress-info: var(--toastify-color-info);--toastify-color-progress-success: var(--toastify-color-success);--toastify-color-progress-warning: var(--toastify-color-warning);--toastify-color-progress-error: var(--toastify-color-error);--toastify-color-progress-bgo: .2}.Toastify__toast-container{z-index:var(--toastify-z-index);-webkit-transform:translate3d(0,0,var(--toastify-z-index));position:fixed;width:var(--toastify-container-width);box-sizing:border-box;color:#fff;display:flex;flex-direction:column}.Toastify__toast-container--top-left{top:var(--toastify-toast-top);left:var(--toastify-toast-left)}.Toastify__toast-container--top-center{top:var(--toastify-toast-top);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--top-right{top:var(--toastify-toast-top);right:var(--toastify-toast-right);align-items:end}.Toastify__toast-container--bottom-left{bottom:var(--toastify-toast-bottom);left:var(--toastify-toast-left)}.Toastify__toast-container--bottom-center{bottom:var(--toastify-toast-bottom);left:50%;transform:translate(-50%);align-items:center}.Toastify__toast-container--bottom-right{bottom:var(--toastify-toast-bottom);right:var(--toastify-toast-right);align-items:end}.Toastify__toast{--y: 0;position:relative;touch-action:none;width:var(--toastify-toast-width);min-height:var(--toastify-toast-min-height);box-sizing:border-box;margin-bottom:1rem;padding:var(--toastify-toast-padding);border-radius:var(--toastify-toast-bd-radius);box-shadow:var(--toastify-toast-shadow);max-height:var(--toastify-toast-max-height);font-family:var(--toastify-font-family);z-index:0;display:flex;flex:1 auto;align-items:center;word-break:break-word}@media only screen and (max-width: 480px){.Toastify__toast-container{width:100vw;left:env(safe-area-inset-left);margin:0}.Toastify__toast-container--top-left,.Toastify__toast-container--top-center,.Toastify__toast-container--top-right{top:env(safe-area-inset-top);transform:translate(0)}.Toastify__toast-container--bottom-left,.Toastify__toast-container--bottom-center,.Toastify__toast-container--bottom-right{bottom:env(safe-area-inset-bottom);transform:translate(0)}.Toastify__toast-container--rtl{right:env(safe-area-inset-right);left:initial}.Toastify__toast{--toastify-toast-width: 100%;margin-bottom:0;border-radius:0}}.Toastify__toast-container[data-stacked=true]{width:var(--toastify-toast-width)}.Toastify__toast--stacked{position:absolute;width:100%;transform:translate3d(0,var(--y),0) scale(var(--s));transition:transform .3s}.Toastify__toast--stacked[data-collapsed] .Toastify__toast-body,.Toastify__toast--stacked[data-collapsed] .Toastify__close-button{transition:opacity .1s}.Toastify__toast--stacked[data-collapsed=false]{overflow:visible}.Toastify__toast--stacked[data-collapsed=true]:not(:last-child)>*{opacity:0}.Toastify__toast--stacked:after{content:"";position:absolute;left:0;right:0;height:calc(var(--g) * 1px);bottom:100%}.Toastify__toast--stacked[data-pos=top]{top:0}.Toastify__toast--stacked[data-pos=bot]{bottom:0}.Toastify__toast--stacked[data-pos=bot].Toastify__toast--stacked:before{transform-origin:top}.Toastify__toast--stacked[data-pos=top].Toastify__toast--stacked:before{transform-origin:bottom}.Toastify__toast--stacked:before{content:"";position:absolute;left:0;right:0;bottom:0;height:100%;transform:scaleY(3);z-index:-1}.Toastify__toast--rtl{direction:rtl}.Toastify__toast--close-on-click{cursor:pointer}.Toastify__toast-icon{margin-inline-end:10px;width:22px;flex-shrink:0;display:flex}.Toastify--animate{animation-fill-mode:both;animation-duration:.5s}.Toastify--animate-icon{animation-fill-mode:both;animation-duration:.3s}.Toastify__toast-theme--dark{background:var(--toastify-color-dark);color:var(--toastify-text-color-dark)}.Toastify__toast-theme--light,.Toastify__toast-theme--colored.Toastify__toast--default{background:var(--toastify-color-light);color:var(--toastify-text-color-light)}.Toastify__toast-theme--colored.Toastify__toast--info{color:var(--toastify-text-color-info);background:var(--toastify-color-info)}.Toastify__toast-theme--colored.Toastify__toast--success{color:var(--toastify-text-color-success);background:var(--toastify-color-success)}.Toastify__toast-theme--colored.Toastify__toast--warning{color:var(--toastify-text-color-warning);background:var(--toastify-color-warning)}.Toastify__toast-theme--colored.Toastify__toast--error{color:var(--toastify-text-color-error);background:var(--toastify-color-error)}.Toastify__progress-bar-theme--light{background:var(--toastify-color-progress-light)}.Toastify__progress-bar-theme--dark{background:var(--toastify-color-progress-dark)}.Toastify__progress-bar--info{background:var(--toastify-color-progress-info)}.Toastify__progress-bar--success{background:var(--toastify-color-progress-success)}.Toastify__progress-bar--warning{background:var(--toastify-color-progress-warning)}.Toastify__progress-bar--error{background:var(--toastify-color-progress-error)}.Toastify__progress-bar-theme--colored.Toastify__progress-bar--info,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--success,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--warning,.Toastify__progress-bar-theme--colored.Toastify__progress-bar--error{background:var(--toastify-color-transparent)}.Toastify__close-button{color:#fff;position:absolute;top:6px;right:6px;background:transparent;outline:none;border:none;padding:0;cursor:pointer;opacity:.7;transition:.3s ease;z-index:1}.Toastify__toast--rtl .Toastify__close-button{left:6px;right:unset}.Toastify__close-button--light{color:#000;opacity:.3}.Toastify__close-button>svg{fill:currentColor;height:16px;width:14px}.Toastify__close-button:hover,.Toastify__close-button:focus{opacity:1}@keyframes Toastify__trackProgress{0%{transform:scaleX(1)}to{transform:scaleX(0)}}.Toastify__progress-bar{position:absolute;bottom:0;left:0;width:100%;height:100%;z-index:1;opacity:.7;transform-origin:left}.Toastify__progress-bar--animated{animation:Toastify__trackProgress linear 1 forwards}.Toastify__progress-bar--controlled{transition:transform .2s}.Toastify__progress-bar--rtl{right:0;left:initial;transform-origin:right;border-bottom-left-radius:initial}.Toastify__progress-bar--wrp{position:absolute;overflow:hidden;bottom:0;left:0;width:100%;height:5px;border-bottom-left-radius:var(--toastify-toast-bd-radius);border-bottom-right-radius:var(--toastify-toast-bd-radius)}.Toastify__progress-bar--wrp[data-hidden=true]{opacity:0}.Toastify__progress-bar--bg{opacity:var(--toastify-color-progress-bgo);width:100%;height:100%}.Toastify__spinner{width:20px;height:20px;box-sizing:border-box;border:2px solid;border-radius:100%;border-color:var(--toastify-spinner-color-empty-area);border-right-color:var(--toastify-spinner-color);animation:Toastify__spin .65s linear infinite}@keyframes Toastify__bounceInRight{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(3000px,0,0)}60%{opacity:1;transform:translate3d(-25px,0,0)}75%{transform:translate3d(10px,0,0)}90%{transform:translate3d(-5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutRight{20%{opacity:1;transform:translate3d(-20px,var(--y),0)}to{opacity:0;transform:translate3d(2000px,var(--y),0)}}@keyframes Toastify__bounceInLeft{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(-3000px,0,0)}60%{opacity:1;transform:translate3d(25px,0,0)}75%{transform:translate3d(-10px,0,0)}90%{transform:translate3d(5px,0,0)}to{transform:none}}@keyframes Toastify__bounceOutLeft{20%{opacity:1;transform:translate3d(20px,var(--y),0)}to{opacity:0;transform:translate3d(-2000px,var(--y),0)}}@keyframes Toastify__bounceInUp{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,3000px,0)}60%{opacity:1;transform:translate3d(0,-20px,0)}75%{transform:translate3d(0,10px,0)}90%{transform:translate3d(0,-5px,0)}to{transform:translateZ(0)}}@keyframes Toastify__bounceOutUp{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,-2000px,0)}}@keyframes Toastify__bounceInDown{0%,60%,75%,90%,to{animation-timing-function:cubic-bezier(.215,.61,.355,1)}0%{opacity:0;transform:translate3d(0,-3000px,0)}60%{opacity:1;transform:translate3d(0,25px,0)}75%{transform:translate3d(0,-10px,0)}90%{transform:translate3d(0,5px,0)}to{transform:none}}@keyframes Toastify__bounceOutDown{20%{transform:translate3d(0,calc(var(--y) - 10px),0)}40%,45%{opacity:1;transform:translate3d(0,calc(var(--y) + 20px),0)}to{opacity:0;transform:translate3d(0,2000px,0)}}.Toastify__bounce-enter--top-left,.Toastify__bounce-enter--bottom-left{animation-name:Toastify__bounceInLeft}.Toastify__bounce-enter--top-right,.Toastify__bounce-enter--bottom-right{animation-name:Toastify__bounceInRight}.Toastify__bounce-enter--top-center{animation-name:Toastify__bounceInDown}.Toastify__bounce-enter--bottom-center{animation-name:Toastify__bounceInUp}.Toastify__bounce-exit--top-left,.Toastify__bounce-exit--bottom-left{animation-name:Toastify__bounceOutLeft}.Toastify__bounce-exit--top-right,.Toastify__bounce-exit--bottom-right{animation-name:Toastify__bounceOutRight}.Toastify__bounce-exit--top-center{animation-name:Toastify__bounceOutUp}.Toastify__bounce-exit--bottom-center{animation-name:Toastify__bounceOutDown}@keyframes Toastify__zoomIn{0%{opacity:0;transform:scale3d(.3,.3,.3)}50%{opacity:1}}@keyframes Toastify__zoomOut{0%{opacity:1}50%{opacity:0;transform:translate3d(0,var(--y),0) scale3d(.3,.3,.3)}to{opacity:0}}.Toastify__zoom-enter{animation-name:Toastify__zoomIn}.Toastify__zoom-exit{animation-name:Toastify__zoomOut}@keyframes Toastify__flipIn{0%{transform:perspective(400px) rotateX(90deg);animation-timing-function:ease-in;opacity:0}40%{transform:perspective(400px) rotateX(-20deg);animation-timing-function:ease-in}60%{transform:perspective(400px) rotateX(10deg);opacity:1}80%{transform:perspective(400px) rotateX(-5deg)}to{transform:perspective(400px)}}@keyframes Toastify__flipOut{0%{transform:translate3d(0,var(--y),0) perspective(400px)}30%{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(-20deg);opacity:1}to{transform:translate3d(0,var(--y),0) perspective(400px) rotateX(90deg);opacity:0}}.Toastify__flip-enter{animation-name:Toastify__flipIn}.Toastify__flip-exit{animation-name:Toastify__flipOut}@keyframes Toastify__slideInRight{0%{transform:translate3d(110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInLeft{0%{transform:translate3d(-110%,0,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInUp{0%{transform:translate3d(0,110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideInDown{0%{transform:translate3d(0,-110%,0);visibility:visible}to{transform:translate3d(0,var(--y),0)}}@keyframes Toastify__slideOutRight{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(110%,var(--y),0)}}@keyframes Toastify__slideOutLeft{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(-110%,var(--y),0)}}@keyframes Toastify__slideOutDown{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,500px,0)}}@keyframes Toastify__slideOutUp{0%{transform:translate3d(0,var(--y),0)}to{visibility:hidden;transform:translate3d(0,-500px,0)}}.Toastify__slide-enter--top-left,.Toastify__slide-enter--bottom-left{animation-name:Toastify__slideInLeft}.Toastify__slide-enter--top-right,.Toastify__slide-enter--bottom-right{animation-name:Toastify__slideInRight}.Toastify__slide-enter--top-center{animation-name:Toastify__slideInDown}.Toastify__slide-enter--bottom-center{animation-name:Toastify__slideInUp}.Toastify__slide-exit--top-left,.Toastify__slide-exit--bottom-left{animation-name:Toastify__slideOutLeft;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-right,.Toastify__slide-exit--bottom-right{animation-name:Toastify__slideOutRight;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--top-center{animation-name:Toastify__slideOutUp;animation-timing-function:ease-in;animation-duration:.3s}.Toastify__slide-exit--bottom-center{animation-name:Toastify__slideOutDown;animation-timing-function:ease-in;animation-duration:.3s}@keyframes Toastify__spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}
`);var Ux=t=>typeof t=="number"&&!isNaN(t),bh=t=>typeof t=="string",Ic=t=>typeof t=="function",s1e=t=>bh(t)||Ux(t),H_=t=>bh(t)||Ic(t)?t:null,r1e=(t,e)=>t===!1||Ux(t)&&t>0?t:e,G_=t=>j.isValidElement(t)||bh(t)||Ic(t)||Ux(t);function a1e(t,e,n=300){let{scrollHeight:s,style:r}=t;requestAnimationFrame(()=>{r.minHeight="initial",r.height=s+"px",r.transition=`all ${n}ms`,requestAnimationFrame(()=>{r.height="0",r.padding="0",r.margin="0",setTimeout(e,n)})})}function i1e({enter:t,exit:e,appendPosition:n=!1,collapse:s=!0,collapseDuration:r=300}){return function({children:a,position:i,preventExitTransition:l,done:c,nodeRef:u,isIn:h,playToast:f}){let p=n?`${t}--${i}`:t,x=n?`${e}--${i}`:e,y=j.useRef(0);return j.useLayoutEffect(()=>{let v=u.current,b=p.split(" "),N=S=>{S.target===u.current&&(f(),v.removeEventListener("animationend",N),v.removeEventListener("animationcancel",N),y.current===0&&S.type!=="animationcancel"&&v.classList.remove(...b))};v.classList.add(...b),v.addEventListener("animationend",N),v.addEventListener("animationcancel",N)},[]),j.useEffect(()=>{let v=u.current,b=()=>{v.removeEventListener("animationend",b),s?a1e(v,c,r):c()};h||(l?b():(y.current=1,v.className+=` ${x}`,v.addEventListener("animationend",b)))},[h]),tn.createElement(tn.Fragment,null,a)}}function s8(t,e){return{content:AH(t.content,t.props),containerId:t.props.containerId,id:t.props.toastId,theme:t.props.theme,type:t.props.type,data:t.props.data||{},isLoading:t.props.isLoading,icon:t.props.icon,reason:t.removalReason,status:e}}function AH(t,e,n=!1){return j.isValidElement(t)&&!bh(t.type)?j.cloneElement(t,{closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:n}):Ic(t)?t({closeToast:e.closeToast,toastProps:e,data:e.data,isPaused:n}):t}function o1e({closeToast:t,theme:e,ariaLabel:n="close"}){return tn.createElement("button",{className:`Toastify__close-button Toastify__close-button--${e}`,type:"button",onClick:s=>{s.stopPropagation(),t(!0)},"aria-label":n},tn.createElement("svg",{"aria-hidden":"true",viewBox:"0 0 14 16"},tn.createElement("path",{fillRule:"evenodd",d:"M7.71 8.23l3.75 3.75-1.48 1.48-3.75-3.75-3.75 3.75L1 11.98l3.75-3.75L1 4.48 2.48 3l3.75 3.75L9.98 3l1.48 1.48-3.75 3.75z"})))}function l1e({delay:t,isRunning:e,closeToast:n,type:s="default",hide:r,className:a,controlledProgress:i,progress:l,rtl:c,isIn:u,theme:h}){let f=r||i&&l===0,p={animationDuration:`${t}ms`,animationPlayState:e?"running":"paused"};i&&(p.transform=`scaleX(${l})`);let x=Dn("Toastify__progress-bar",i?"Toastify__progress-bar--controlled":"Toastify__progress-bar--animated",`Toastify__progress-bar-theme--${h}`,`Toastify__progress-bar--${s}`,{"Toastify__progress-bar--rtl":c}),y=Ic(a)?a({rtl:c,type:s,defaultClassName:x}):Dn(x,a),v={[i&&l>=1?"onTransitionEnd":"onAnimationEnd"]:i&&l<1?null:()=>{u&&n()}};return tn.createElement("div",{className:"Toastify__progress-bar--wrp","data-hidden":f},tn.createElement("div",{className:`Toastify__progress-bar--bg Toastify__progress-bar-theme--${h} Toastify__progress-bar--${s}`}),tn.createElement("div",{role:"progressbar","aria-hidden":f?"true":"false","aria-label":"notification timer",className:y,style:p,...v}))}var c1e=1,$H=()=>`${c1e++}`;function u1e(t,e,n){let s=1,r=0,a=[],i=[],l=e,c=new Map,u=new Set,h=S=>(u.add(S),()=>u.delete(S)),f=()=>{i=Array.from(c.values()),u.forEach(S=>S())},p=({containerId:S,toastId:k,updateId:T})=>{let E=S?S!==t:t!==1,D=c.has(k)&&T==null;return E||D},x=(S,k)=>{c.forEach(T=>{var E;(k==null||k===T.props.toastId)&&((E=T.toggle)==null||E.call(T,S))})},y=S=>{var k,T;(T=(k=S.props)==null?void 0:k.onClose)==null||T.call(k,S.removalReason),S.isActive=!1},v=S=>{if(S==null)c.forEach(y);else{let k=c.get(S);k&&y(k)}f()},b=()=>{r-=a.length,a=[]},N=S=>{var k,T;let{toastId:E,updateId:D}=S.props,A=D==null;S.staleId&&c.delete(S.staleId),S.isActive=!0,c.set(E,S),f(),n(s8(S,A?"added":"updated")),A&&((T=(k=S.props).onOpen)==null||T.call(k))};return{id:t,props:l,observe:h,toggle:x,removeToast:v,toasts:c,clearQueue:b,buildToast:(S,k)=>{if(p(k))return;let{toastId:T,updateId:E,data:D,staleId:A,delay:I}=k,P=E==null;P&&r++;let $={...l,style:l.toastStyle,key:s++,...Object.fromEntries(Object.entries(k).filter(([F,W])=>W!=null)),toastId:T,updateId:E,data:D,isIn:!1,className:H_(k.className||l.toastClassName),progressClassName:H_(k.progressClassName||l.progressClassName),autoClose:k.isLoading?!1:r1e(k.autoClose,l.autoClose),closeToast(F){c.get(T).removalReason=F,v(T)},deleteToast(){let F=c.get(T);if(F!=null){if(n(s8(F,"removed")),c.delete(T),r--,r<0&&(r=0),a.length>0){N(a.shift());return}f()}}};$.closeButton=l.closeButton,k.closeButton===!1||G_(k.closeButton)?$.closeButton=k.closeButton:k.closeButton===!0&&($.closeButton=G_(l.closeButton)?l.closeButton:!0);let R={content:S,props:$,staleId:A};l.limit&&l.limit>0&&r>l.limit&&P?a.push(R):Ux(I)?setTimeout(()=>{N(R)},I):N(R)},setProps(S){l=S},setToggle:(S,k)=>{let T=c.get(S);T&&(T.toggle=k)},isToastActive:S=>{var k;return(k=c.get(S))==null?void 0:k.isActive},getSnapshot:()=>i}}var Ma=new Map,Zg=[],q_=new Set,d1e=t=>q_.forEach(e=>e(t)),IH=()=>Ma.size>0;function h1e(){Zg.forEach(t=>OH(t.content,t.options)),Zg=[]}var m1e=(t,{containerId:e})=>{var n;return(n=Ma.get(e||1))==null?void 0:n.toasts.get(t)};function RH(t,e){var n;if(e)return!!((n=Ma.get(e))!=null&&n.isToastActive(t));let s=!1;return Ma.forEach(r=>{r.isToastActive(t)&&(s=!0)}),s}function f1e(t){if(!IH()){Zg=Zg.filter(e=>t!=null&&e.options.toastId!==t);return}if(t==null||s1e(t))Ma.forEach(e=>{e.removeToast(t)});else if(t&&("containerId"in t||"id"in t)){let e=Ma.get(t.containerId);e?e.removeToast(t.id):Ma.forEach(n=>{n.removeToast(t.id)})}}var p1e=(t={})=>{Ma.forEach(e=>{e.props.limit&&(!t.containerId||e.id===t.containerId)&&e.clearQueue()})};function OH(t,e){G_(t)&&(IH()||Zg.push({content:t,options:e}),Ma.forEach(n=>{n.buildToast(t,e)}))}function g1e(t){var e;(e=Ma.get(t.containerId||1))==null||e.setToggle(t.id,t.fn)}function DH(t,e){Ma.forEach(n=>{(e==null||!(e!=null&&e.containerId)||(e==null?void 0:e.containerId)===n.id)&&n.toggle(t,e==null?void 0:e.id)})}function x1e(t){let e=t.containerId||1;return{subscribe(n){let s=u1e(e,t,d1e);Ma.set(e,s);let r=s.observe(n);return h1e(),()=>{r(),Ma.delete(e)}},setProps(n){var s;(s=Ma.get(e))==null||s.setProps(n)},getSnapshot(){var n;return(n=Ma.get(e))==null?void 0:n.getSnapshot()}}}function y1e(t){return q_.add(t),()=>{q_.delete(t)}}function b1e(t){return t&&(bh(t.toastId)||Ux(t.toastId))?t.toastId:$H()}function Vx(t,e){return OH(t,e),e.toastId}function cN(t,e){return{...e,type:e&&e.type||t,toastId:b1e(e)}}function uN(t){return(e,n)=>Vx(e,cN(t,n))}function gt(t,e){return Vx(t,cN("default",e))}gt.loading=(t,e)=>Vx(t,cN("default",{isLoading:!0,autoClose:!1,closeOnClick:!1,closeButton:!1,draggable:!1,...e}));function v1e(t,{pending:e,error:n,success:s},r){let a;e&&(a=bh(e)?gt.loading(e,r):gt.loading(e.render,{...r,...e}));let i={isLoading:null,autoClose:null,closeOnClick:null,closeButton:null,draggable:null},l=(u,h,f)=>{if(h==null){gt.dismiss(a);return}let p={type:u,...i,...r,data:f},x=bh(h)?{render:h}:h;return a?gt.update(a,{...p,...x}):gt(x.render,{...p,...x}),f},c=Ic(t)?t():t;return c.then(u=>l("success",s,u)).catch(u=>l("error",n,u)),c}gt.promise=v1e;gt.success=uN("success");gt.info=uN("info");gt.error=uN("error");gt.warning=uN("warning");gt.warn=gt.warning;gt.dark=(t,e)=>Vx(t,cN("default",{theme:"dark",...e}));function w1e(t){f1e(t)}gt.dismiss=w1e;gt.clearWaitingQueue=p1e;gt.isActive=RH;gt.update=(t,e={})=>{let n=m1e(t,e);if(n){let{props:s,content:r}=n,a={delay:100,...s,...e,toastId:e.toastId||t,updateId:$H()};a.toastId!==t&&(a.staleId=t);let i=a.render||r;delete a.render,Vx(i,a)}};gt.done=t=>{gt.update(t,{progress:1})};gt.onChange=y1e;gt.play=t=>DH(!0,t);gt.pause=t=>DH(!1,t);function N1e(t){var e;let{subscribe:n,getSnapshot:s,setProps:r}=j.useRef(x1e(t)).current;r(t);let a=(e=j.useSyncExternalStore(n,s,s))==null?void 0:e.slice();function i(l){if(!a)return[];let c=new Map;return t.newestOnTop&&a.reverse(),a.forEach(u=>{let{position:h}=u.props;c.has(h)||c.set(h,[]),c.get(h).push(u)}),Array.from(c,u=>l(u[0],u[1]))}return{getToastToRender:i,isToastActive:RH,count:a==null?void 0:a.length}}function S1e(t){let[e,n]=j.useState(!1),[s,r]=j.useState(!1),a=j.useRef(null),i=j.useRef({start:0,delta:0,removalDistance:0,canCloseOnClick:!0,canDrag:!1,didMove:!1}).current,{autoClose:l,pauseOnHover:c,closeToast:u,onClick:h,closeOnClick:f}=t;g1e({id:t.toastId,containerId:t.containerId,fn:n}),j.useEffect(()=>{if(t.pauseOnFocusLoss)return p(),()=>{x()}},[t.pauseOnFocusLoss]);function p(){document.hasFocus()||N(),window.addEventListener("focus",b),window.addEventListener("blur",N)}function x(){window.removeEventListener("focus",b),window.removeEventListener("blur",N)}function y(A){if(t.draggable===!0||t.draggable===A.pointerType){S();let I=a.current;i.canCloseOnClick=!0,i.canDrag=!0,I.style.transition="none",t.draggableDirection==="x"?(i.start=A.clientX,i.removalDistance=I.offsetWidth*(t.draggablePercent/100)):(i.start=A.clientY,i.removalDistance=I.offsetHeight*(t.draggablePercent===80?t.draggablePercent*1.5:t.draggablePercent)/100)}}function v(A){let{top:I,bottom:P,left:$,right:R}=a.current.getBoundingClientRect();A.nativeEvent.type!=="touchend"&&t.pauseOnHover&&A.clientX>=$&&A.clientX<=R&&A.clientY>=I&&A.clientY<=P?N():b()}function b(){n(!0)}function N(){n(!1)}function S(){i.didMove=!1,document.addEventListener("pointermove",T),document.addEventListener("pointerup",E)}function k(){document.removeEventListener("pointermove",T),document.removeEventListener("pointerup",E)}function T(A){let I=a.current;if(i.canDrag&&I){i.didMove=!0,e&&N(),t.draggableDirection==="x"?i.delta=A.clientX-i.start:i.delta=A.clientY-i.start,i.start!==A.clientX&&(i.canCloseOnClick=!1);let P=t.draggableDirection==="x"?`${i.delta}px, var(--y)`:`0, calc(${i.delta}px + var(--y))`;I.style.transform=`translate3d(${P},0)`,I.style.opacity=`${1-Math.abs(i.delta/i.removalDistance)}`}}function E(){k();let A=a.current;if(i.canDrag&&i.didMove&&A){if(i.canDrag=!1,Math.abs(i.delta)>i.removalDistance){r(!0),t.closeToast(!0),t.collapseAll();return}A.style.transition="transform 0.2s, opacity 0.2s",A.style.removeProperty("transform"),A.style.removeProperty("opacity")}}let D={onPointerDown:y,onPointerUp:v};return l&&c&&(D.onMouseEnter=N,t.stacked||(D.onMouseLeave=b)),f&&(D.onClick=A=>{h&&h(A),i.canCloseOnClick&&u(!0)}),{playToast:b,pauseToast:N,isRunning:e,preventExitTransition:s,toastRef:a,eventHandlers:D}}var j1e=typeof window<"u"?j.useLayoutEffect:j.useEffect,dN=({theme:t,type:e,isLoading:n,...s})=>tn.createElement("svg",{viewBox:"0 0 24 24",width:"100%",height:"100%",fill:t==="colored"?"currentColor":`var(--toastify-icon-color-${e})`,...s});function k1e(t){return tn.createElement(dN,{...t},tn.createElement("path",{d:"M23.32 17.191L15.438 2.184C14.728.833 13.416 0 11.996 0c-1.42 0-2.733.833-3.443 2.184L.533 17.448a4.744 4.744 0 000 4.368C1.243 23.167 2.555 24 3.975 24h16.05C22.22 24 24 22.044 24 19.632c0-.904-.251-1.746-.68-2.44zm-9.622 1.46c0 1.033-.724 1.823-1.698 1.823s-1.698-.79-1.698-1.822v-.043c0-1.028.724-1.822 1.698-1.822s1.698.79 1.698 1.822v.043zm.039-12.285l-.84 8.06c-.057.581-.408.943-.897.943-.49 0-.84-.367-.896-.942l-.84-8.065c-.057-.624.25-1.095.779-1.095h1.91c.528.005.84.476.784 1.1z"}))}function C1e(t){return tn.createElement(dN,{...t},tn.createElement("path",{d:"M12 0a12 12 0 1012 12A12.013 12.013 0 0012 0zm.25 5a1.5 1.5 0 11-1.5 1.5 1.5 1.5 0 011.5-1.5zm2.25 13.5h-4a1 1 0 010-2h.75a.25.25 0 00.25-.25v-4.5a.25.25 0 00-.25-.25h-.75a1 1 0 010-2h1a2 2 0 012 2v4.75a.25.25 0 00.25.25h.75a1 1 0 110 2z"}))}function T1e(t){return tn.createElement(dN,{...t},tn.createElement("path",{d:"M12 0a12 12 0 1012 12A12.014 12.014 0 0012 0zm6.927 8.2l-6.845 9.289a1.011 1.011 0 01-1.43.188l-4.888-3.908a1 1 0 111.25-1.562l4.076 3.261 6.227-8.451a1 1 0 111.61 1.183z"}))}function _1e(t){return tn.createElement(dN,{...t},tn.createElement("path",{d:"M11.983 0a12.206 12.206 0 00-8.51 3.653A11.8 11.8 0 000 12.207 11.779 11.779 0 0011.8 24h.214A12.111 12.111 0 0024 11.791 11.766 11.766 0 0011.983 0zM10.5 16.542a1.476 1.476 0 011.449-1.53h.027a1.527 1.527 0 011.523 1.47 1.475 1.475 0 01-1.449 1.53h-.027a1.529 1.529 0 01-1.523-1.47zM11 12.5v-6a1 1 0 012 0v6a1 1 0 11-2 0z"}))}function E1e(){return tn.createElement("div",{className:"Toastify__spinner"})}var K_={info:C1e,warning:k1e,success:T1e,error:_1e,spinner:E1e},A1e=t=>t in K_;function $1e({theme:t,type:e,isLoading:n,icon:s}){let r=null,a={theme:t,type:e};return s===!1||(Ic(s)?r=s({...a,isLoading:n}):j.isValidElement(s)?r=j.cloneElement(s,a):n?r=K_.spinner():A1e(e)&&(r=K_[e](a))),r}var I1e=t=>{let{isRunning:e,preventExitTransition:n,toastRef:s,eventHandlers:r,playToast:a}=S1e(t),{closeButton:i,children:l,autoClose:c,onClick:u,type:h,hideProgressBar:f,closeToast:p,transition:x,position:y,className:v,style:b,progressClassName:N,updateId:S,role:k,progress:T,rtl:E,toastId:D,deleteToast:A,isIn:I,isLoading:P,closeOnClick:$,theme:R,ariaLabel:F}=t,W=Dn("Toastify__toast",`Toastify__toast-theme--${R}`,`Toastify__toast--${h}`,{"Toastify__toast--rtl":E},{"Toastify__toast--close-on-click":$}),q=Ic(v)?v({rtl:E,position:y,type:h,defaultClassName:W}):Dn(W,v),X=$1e(t),z=!!T||!c,K={closeToast:p,type:h,theme:R},H=null;return i===!1||(Ic(i)?H=i(K):j.isValidElement(i)?H=j.cloneElement(i,K):H=o1e(K)),tn.createElement(x,{isIn:I,done:A,position:y,preventExitTransition:n,nodeRef:s,playToast:a},tn.createElement("div",{id:D,tabIndex:0,onClick:u,"data-in":I,className:q,...r,style:b,ref:s,...I&&{role:k,"aria-label":F}},X!=null&&tn.createElement("div",{className:Dn("Toastify__toast-icon",{"Toastify--animate-icon Toastify__zoom-enter":!P})},X),AH(l,t,!e),H,!t.customProgressBar&&tn.createElement(l1e,{...S&&!z?{key:`p-${S}`}:{},rtl:E,theme:R,delay:c,isRunning:e,isIn:I,closeToast:p,hide:f,type:h,className:N,controlledProgress:z,progress:T||0})))},R1e=(t,e=!1)=>({enter:`Toastify--animate Toastify__${t}-enter`,exit:`Toastify--animate Toastify__${t}-exit`,appendPosition:e}),O1e=i1e(R1e("bounce",!0)),D1e={position:"top-right",transition:O1e,autoClose:5e3,closeButton:!0,pauseOnHover:!0,pauseOnFocusLoss:!0,draggable:"touch",draggablePercent:80,draggableDirection:"x",role:"alert",theme:"light","aria-label":"Notifications Alt+T",hotKeys:t=>t.altKey&&t.code==="KeyT"};function Kc(t){let e={...D1e,...t},n=t.stacked,[s,r]=j.useState(!0),a=j.useRef(null),{getToastToRender:i,isToastActive:l,count:c}=N1e(e),{className:u,style:h,rtl:f,containerId:p,hotKeys:x}=e;function y(b){let N=Dn("Toastify__toast-container",`Toastify__toast-container--${b}`,{"Toastify__toast-container--rtl":f});return Ic(u)?u({position:b,rtl:f,defaultClassName:N}):Dn(N,H_(u))}function v(){n&&(r(!0),gt.play())}return j1e(()=>{var b;if(n){let N=a.current.querySelectorAll('[data-in="true"]'),S=12,k=(b=e.position)==null?void 0:b.includes("top"),T=0,E=0;Array.from(N).reverse().forEach((D,A)=>{let I=D;I.classList.add("Toastify__toast--stacked"),A>0&&(I.dataset.collapsed=`${s}`),I.dataset.pos||(I.dataset.pos=k?"top":"bot");let P=T*(s?.2:1)+(s?0:S*A);I.style.setProperty("--y",`${k?P:P*-1}px`),I.style.setProperty("--g",`${S}`),I.style.setProperty("--s",`${1-(s?E:0)}`),T+=I.offsetHeight,E+=.025})}},[s,c,n]),j.useEffect(()=>{function b(N){var S;let k=a.current;x(N)&&((S=k.querySelector('[tabIndex="0"]'))==null||S.focus(),r(!1),gt.pause()),N.key==="Escape"&&(document.activeElement===k||k!=null&&k.contains(document.activeElement))&&(r(!0),gt.play())}return document.addEventListener("keydown",b),()=>{document.removeEventListener("keydown",b)}},[x]),tn.createElement("section",{ref:a,className:"Toastify",id:p,onMouseEnter:()=>{n&&(r(!1),gt.pause())},onMouseLeave:v,"aria-live":"polite","aria-atomic":"false","aria-relevant":"additions text","aria-label":e["aria-label"]},i((b,N)=>{let S=N.length?{...h}:{...h,pointerEvents:"none"};return tn.createElement("div",{tabIndex:-1,className:y(b),"data-stacked":n,style:S,key:`c-${b}`},N.map(({content:k,props:T})=>tn.createElement(I1e,{...T,stacked:n,collapseAll:v,isIn:l(T.toastId,T.containerId),key:`t-${T.key}`},k)))}))}class PH extends j.Component{constructor(){super(...arguments),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,n){console.error("Uncaught error:",e,n),gt.error("Something went wrong. Please refresh the page.")}render(){return this.state.hasError?o.jsxs("div",{className:"p-4 bg-red-50 rounded-lg",children:[o.jsx("h2",{className:"text-lg font-medium text-red-800 mb-2",children:"Something went wrong"}),o.jsx("p",{className:"text-red-600 mb-4",children:"Please try refreshing the page."}),o.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors",children:"Refresh Page"})]}):this.props.children}}const bg=t=>{if(t>=1e6){const e=t/1e6;return e%1===0?`${e.toFixed(0)}M`:`${e.toFixed(1)}M`}else if(t>=1e3){const e=t/1e3;return e%1===0?`${e.toFixed(0)}K`:`${e.toFixed(1)}K`}return t.toLocaleString("en-US")},cg=({icon:t,title:e,value:n,color:s,showActualValue:r=!1})=>{const a=typeof n=="string"&&n.includes("");let i=n;return typeof n=="number"&&!r?i=bg(n):typeof n=="number"&&r&&(i=n.toLocaleString("en-US")),o.jsxs(Lt,{className:"relative overflow-visible bg-gradient-to-br from-white via-slate-50/30 to-white rounded-xl shadow-lg border border-slate-200/50 hover:shadow-2xl hover:border-primary-300/50 transition-all duration-300 group h-full flex flex-col",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-primary-50/0 to-primary-100/0 group-hover:from-primary-50/30 group-hover:to-primary-100/20 transition-all duration-300 pointer-events-none"}),o.jsxs("div",{className:"relative p-4 sm:p-5 flex-1 flex flex-col min-w-0",children:[o.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3 flex-shrink-0",children:[o.jsx("div",{className:`p-2.5 sm:p-3 rounded-xl flex-shrink-0 shadow-lg group-hover:shadow-xl transition-all duration-300 ${s}`,children:o.jsx(t,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsx("div",{className:"flex-shrink-0",children:o.jsx("div",{className:"w-2 h-2 rounded-full bg-primary-400/50 group-hover:bg-primary-500 transition-colors"})})]}),o.jsxs("div",{className:"space-y-1.5 min-w-0 w-full flex-1 flex flex-col justify-end",children:[o.jsx("p",{className:"text-xs sm:text-sm font-semibold text-slate-500 uppercase tracking-wider leading-tight",children:e}),a?o.jsxs("div",{className:"flex flex-col min-w-0 w-full",children:[o.jsx("p",{className:"text-base sm:text-lg md:text-xl lg:text-2xl xl:text-3xl font-extrabold text-slate-900 leading-tight break-words hyphens-auto",children:n}),o.jsx("p",{className:"text-[10px] sm:text-xs text-slate-500 font-medium mt-0.5",children:"Platform Fee"})]}):o.jsx("p",{className:"text-base sm:text-lg md:text-xl lg:text-2xl xl:text-3xl font-extrabold text-slate-900 leading-tight break-words hyphens-auto",children:i})]})]}),o.jsx("div",{className:`absolute bottom-0 left-0 right-0 h-1 ${s} opacity-60 group-hover:opacity-100 transition-opacity`})]})},P1e=()=>{const[t,e]=j.useState(null),[n,s]=j.useState(!0),[r,a]=j.useState(null),[i,l]=j.useState([]),[c,u]=j.useState(null),[h,f]=j.useState([]),[p,x]=j.useState([]),[y,v]=j.useState(new Map),[b,N]=j.useState(new Map),[S,k]=j.useState([]),[T,E]=j.useState([]),[D,A]=j.useState(6);j.useEffect(()=>{(async()=>{var z,K;try{s(!0);const H=await we.get("/dashboard/stats");console.log("Dashboard stats response:",H.data),console.log("Total Revenue:",(z=H.data)==null?void 0:z.totalRevenue),console.log("Payment Overview:",(K=H.data)==null?void 0:K.paymentOverview),e(H.data)}catch(H){a("Failed to fetch dashboard statistics."),console.error("Dashboard fetch error:",H)}finally{s(!1)}})()},[]),j.useEffect(()=>{(async()=>{try{const K=((await we.get("/payments/payouts")).data||[]).filter(H=>H.status==="released"&&H.payment_id!=null);E(K)}catch(z){console.error("Failed to fetch payouts:",z)}})()},[]),j.useEffect(()=>{(async()=>{try{const z=await we.get("/payments");k(z.data||[])}catch(z){console.error("Failed to fetch payments:",z)}})()},[]),j.useEffect(()=>{(async()=>{try{const K=(await we.get("/universities")).data||[],H=new Map;K.forEach(Y=>{Y.name&&Y.acronym&&H.set(Y.name,Y.acronym)}),v(H)}catch(z){console.error("Failed to fetch universities:",z)}})()},[]),j.useEffect(()=>{(async()=>{try{const K=(await we.get("/courses")).data||[],H=new Map;K.forEach(Y=>{Y.course_name&&Y.acronym&&H.set(Y.course_name,Y.acronym)}),N(H)}catch(z){console.error("Failed to fetch courses:",z)}})()},[]),j.useEffect(()=>{if(!t)return;const X=t.universityDistribution||[];if(Array.isArray(X)){const Y=X.map(B=>({university:B.university||B.name||B.university_name||"Unknown",tutors:Number(B.tutors??B.numTutors??B.tutorCount??0),tutees:Number(B.tutees??B.numTutees??B.tuteeCount??0)}));l(Y)}else l([]);const z=t.userTypeTotals;u(z&&typeof z=="object"?{tutors:Number(z.tutors??z.numTutors??0),tutees:Number(z.tutees??z.numTutees??0)}:null);const K=t.courseDistribution||[];if(Array.isArray(K)){const Y=K.map(B=>({courseName:B.courseName||B.course||B.name||"Unknown",tutors:Number(B.tutors??B.numTutors??B.tutorCount??0),tutees:Number(B.tutees??B.numTutees??B.tuteeCount??0)}));f(Y)}else f([]);const H=t.subjectSessions||t.mostInDemandSubjects||[];if(Array.isArray(H)){console.log("Subject rows from backend:",H);const Y=H.map(B=>{const O=B.subjectName||B.subject||B.subject_name||B.name||null;return console.log("Processing subject row:",B,"Extracted name:",O),(!O||O==="Unknown")&&console.warn("Subject name not found for row:",B),{subjectName:O||"Unknown",sessions:Number(B.sessions??B.count??B.sessionsCount??0)}}).filter(B=>B.subjectName&&B.subjectName!=="Unknown");console.log("Normalized subjects:",Y),x(Y)}else x([])},[t]),j.useMemo(()=>i.reduce((X,z)=>Math.max(X,z.tutors+z.tutees),0),[i]),j.useMemo(()=>h.reduce((X,z)=>Math.max(X,z.tutors+z.tutees),0),[h]),j.useMemo(()=>p.reduce((X,z)=>Math.max(X,z.sessions),0),[p]),j.useMemo(()=>{var X;return(X=t==null?void 0:t.paymentOverview)!=null&&X.trends?t.paymentOverview.trends.map(z=>({month:z.label,"Platform Revenue":z.amount})):[]},[t]);const I=j.useMemo(()=>{const X={};return S.forEach(z=>{let K=null;z.subject&&(typeof z.subject=="string"?K=z.subject:z.subject.subject_name&&(K=z.subject.subject_name)),!K&&z.bookingRequest&&typeof z.bookingRequest=="object"&&z.bookingRequest.subject&&(K=z.bookingRequest.subject),K&&K.trim()!==""&&(X[K]=(X[K]||0)+1)}),Object.entries(X).sort(([,z],[,K])=>K-z).slice(0,5)},[S]),P=j.useMemo(()=>{if(!T||T.length===0||!S||S.length===0)return 0;const X=new Map;S.forEach(K=>{const H=K.payment_id||K.id;H&&X.set(Number(H),Number(K.amount||0))});const z=T.reduce((K,H)=>{var J;const Y=H.payment_id||((J=H.payment)==null?void 0:J.payment_id);if(!Y)return K;const B=X.get(Number(Y))||0,O=Number(H.amount_released||0),U=B-O;return K+U},0);return Number(z.toFixed(2))},[T,S]),$=j.useMemo(()=>{if(!T||T.length===0||!S||S.length===0)return{totalPayments:0,pendingPayments:0,confirmedPayments:0,rejectedPayments:0,totalAmount:0,confirmedAmount:0};const X=new Map;S.forEach(O=>{const U=O.payment_id||O.id;U&&X.set(Number(U),Number(O.amount||0))});const z=T.reduce((O,U)=>{var fe;const J=U.payment_id||((fe=U.payment)==null?void 0:fe.payment_id);if(!J)return O;const se=X.get(Number(J))||0,ae=Number(U.amount_released||0);return O+(se-ae)},0),K=S.length,H=S.filter(O=>O.status==="pending").length,Y=S.filter(O=>O.status==="confirmed").length,B=S.filter(O=>O.status==="rejected").length;return{totalPayments:K,pendingPayments:H,confirmedPayments:Y,rejectedPayments:B,totalAmount:Number(z.toFixed(2)),confirmedAmount:Number(z.toFixed(2))}},[T,S]),R=j.useMemo(()=>{if(!T||T.length===0||!S||S.length===0)return Array.from({length:D},(H,Y)=>{const B=new Date;return B.setMonth(B.getMonth()-(D-1-Y)),{month:B.toLocaleDateString("en-US",{month:"short"}),"Platform Revenue":0}});const X=new Map;return S.forEach(K=>{const H=K.payment_id||K.id;H&&X.set(Number(H),Number(K.amount||0))}),Array.from({length:D},(K,H)=>{const Y=new Date;return Y.setMonth(Y.getMonth()-(D-1-H)),{month:Y.toLocaleDateString("en-US",{month:"short"}),monthIndex:Y.getMonth(),year:Y.getFullYear()}}).map(({month:K,monthIndex:H,year:Y})=>{const O=T.filter(U=>{if(!U.created_at)return!1;const J=new Date(U.created_at);return J.getMonth()===H&&J.getFullYear()===Y}).reduce((U,J)=>{var ye;const se=J.payment_id||((ye=J.payment)==null?void 0:ye.payment_id);if(!se)return U;const ae=X.get(Number(se))||0,fe=Number(J.amount_released||0);return U+(ae-fe)},0);return{month:K,"Platform Revenue":Number(O.toFixed(2))}})},[T,S,D]),F=["#6366f1","#06b6d4","#10b981","#f59e0b","#ef4444","#8b5cf6","#22c55e","#0ea5e9","#f97316","#a78bfa"],W=(X,z,K,H=6)=>{const Y=[...X].sort((ae,fe)=>K(fe)-K(ae)),B=Y.slice(0,H),U=Y.slice(H).reduce((ae,fe)=>ae+K(fe),0),J=B.map((ae,fe)=>({label:z(ae),value:Math.max(0,K(ae)),color:F[fe%F.length]}));U>0&&J.push({label:"Other",value:U,color:"#cbd5e1"});const se=J.reduce((ae,fe)=>ae+fe.value,0)||1;return{items:J,total:se}},q=({items:X,size:z=200,thickness:K=20,total:H,centerLabel:Y,centerSub:B})=>{const O=z/2-K/2,U=z/2,J=2*Math.PI*O,se=(H??X.reduce((ye,Te)=>ye+Te.value,0))||1;let ae=0;const fe=X.map((ye,Te)=>{const oe=ye.value/se,Se=J*oe,ke=o.jsx("circle",{cx:U,cy:U,r:O,fill:"transparent",stroke:ye.color,strokeWidth:K,strokeDasharray:`${Se} ${J-Se}`,strokeDashoffset:-ae,strokeLinecap:"butt",style:{transition:"stroke-dashoffset 700ms ease-out"}},Te);return ae+=Se,ke});return o.jsxs("svg",{width:z,height:z,viewBox:`0 0 ${z} ${z}`,children:[o.jsx("defs",{children:o.jsx("filter",{id:"softShadow",x:"-20%",y:"-20%",width:"140%",height:"140%",children:o.jsx("feDropShadow",{dx:"0",dy:"1",stdDeviation:"2",floodColor:"#0f172a",floodOpacity:"0.15"})})}),o.jsx("circle",{cx:U,cy:U,r:O,fill:"transparent",stroke:"#e2e8f0",strokeWidth:K,filter:"url(#softShadow)"}),fe,(Y||B)&&o.jsxs(o.Fragment,{children:[Y&&o.jsx("text",{x:U,y:U,textAnchor:"middle",dominantBaseline:"central",fontSize:16,fontWeight:700,fill:"#0f172a",children:Y}),B&&o.jsx("text",{x:U,y:U+16,textAnchor:"middle",dominantBaseline:"hanging",fontSize:11,fill:"#475569",children:B})]})]})};return n?o.jsx("div",{children:"Loading dashboard..."}):r?o.jsx("div",{className:"text-red-500",children:r}):o.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[o.jsxs("div",{className:"bg-gradient-to-br from-primary-600 via-primary-700 to-primary-800 rounded-xl sm:rounded-2xl p-4 sm:p-6 text-white shadow-2xl relative overflow-hidden",children:[o.jsxs("div",{className:"absolute inset-0 opacity-20",children:[o.jsx("div",{className:"absolute top-0 right-0 w-40 h-40 bg-white rounded-full -mr-20 -mt-20 blur-2xl"}),o.jsx("div",{className:"absolute bottom-0 left-0 w-32 h-32 bg-white rounded-full -ml-16 -mb-16 blur-2xl"})]}),o.jsxs("div",{className:"relative",children:[o.jsx("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-bold mb-2 drop-shadow-lg",children:"Admin Dashboard"}),o.jsx("p",{className:"text-sm sm:text-base text-white/90",children:"Overview of platform statistics and revenue"})]})]}),o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-4 sm:gap-5 md:gap-6 auto-rows-fr",children:t&&o.jsxs(o.Fragment,{children:[o.jsx(cg,{icon:lU,title:"Total Users",value:t.totalUsers,color:"bg-gradient-to-br from-blue-500 to-blue-600"}),o.jsx(cg,{icon:oU,title:"Verified Tutors",value:t.totalTutors,color:"bg-gradient-to-br from-green-500 to-green-600"}),o.jsx(cg,{icon:bs,title:"Pending Applications",value:t.pendingApplications,color:"bg-gradient-to-br from-yellow-500 to-yellow-600",showActualValue:!0}),o.jsx(cg,{icon:Aae,title:"Total Revenue",value:`${P.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`,color:"bg-gradient-to-br from-indigo-500 via-indigo-600 to-purple-600"}),o.jsx(cg,{icon:jr,title:"Confirmed Sessions",value:t.confirmedSessions??0,color:"bg-gradient-to-br from-emerald-600 to-emerald-700",showActualValue:!0})]})}),o.jsxs("div",{className:"mt-6 sm:mt-8 grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[o.jsxs(Lt,{className:"p-4 sm:p-6",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl shadow-lg",children:o.jsx(Fg,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsx("h2",{className:"text-lg sm:text-xl font-bold text-slate-800",children:"Most-in-Demand Subjects"})]}),o.jsx("div",{className:"space-y-3",children:I.length===0?o.jsx("p",{className:"text-sm text-slate-500 text-center py-4",children:"No subject data available"}):I.map(([X,z],K)=>o.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 rounded-lg hover:bg-slate-100 transition-colors",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-lg bg-primary-100 text-primary-700 font-bold text-sm",children:K+1}),o.jsx("span",{className:"font-medium text-slate-900",children:X})]}),o.jsxs("span",{className:"px-3 py-1 bg-primary-100 text-primary-700 rounded-full text-sm font-semibold",children:[z," ",z===1?"payment":"payments"]})]},X))})]}),o.jsxs(Lt,{className:"p-4 sm:p-6",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl shadow-lg",children:o.jsx(Du,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsx("h2",{className:"text-base sm:text-lg font-bold text-slate-800",children:"Platform Revenue Overview (From Released Payouts)"})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[o.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg border border-blue-200",children:[o.jsx("p",{className:"text-xs text-blue-600 font-semibold mb-1",children:"Total Payments"}),o.jsx("p",{className:"text-lg sm:text-xl font-bold text-blue-900",children:$.totalPayments})]}),o.jsxs("div",{className:"p-3 bg-yellow-50 rounded-lg border border-yellow-200",children:[o.jsx("p",{className:"text-xs text-yellow-600 font-semibold mb-1",children:"Pending"}),o.jsx("p",{className:"text-lg sm:text-xl font-bold text-yellow-900",children:$.pendingPayments})]}),o.jsxs("div",{className:"p-3 bg-green-50 rounded-lg border border-green-200",children:[o.jsx("p",{className:"text-xs text-green-600 font-semibold mb-1",children:"Confirmed"}),o.jsx("p",{className:"text-lg sm:text-xl font-bold text-green-900",children:$.confirmedPayments})]}),o.jsxs("div",{className:"p-3 bg-red-50 rounded-lg border border-red-200",children:[o.jsx("p",{className:"text-xs text-red-600 font-semibold mb-1",children:"Rejected"}),o.jsx("p",{className:"text-lg sm:text-xl font-bold text-red-900",children:$.rejectedPayments})]})]}),o.jsxs("div",{className:"pt-3 border-t border-slate-200",children:[o.jsxs("div",{className:"flex justify-between items-center mb-2",children:[o.jsx("span",{className:"text-sm text-slate-600",children:"Platform Revenue (From Released Payouts)"}),o.jsxs("span",{className:"text-base sm:text-lg font-bold text-slate-900",children:["",$.confirmedAmount.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-slate-600",children:"Released Payouts Revenue"}),o.jsxs("span",{className:"text-base sm:text-lg font-bold text-green-700",children:["",$.confirmedAmount.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]})]})]}),o.jsxs(Lt,{className:"mt-4 sm:mt-6 mb-4 sm:mb-6 p-4 sm:p-6",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4 mb-4",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl shadow-lg",children:o.jsx(Du,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsx("h2",{className:"text-base sm:text-lg font-bold text-slate-800",children:"Platform Revenue Trends (From Released Payouts)"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("label",{htmlFor:"months-filter",className:"text-sm text-slate-600 font-medium",children:"Display:"}),o.jsxs("select",{id:"months-filter",value:D,onChange:X=>A(Number(X.target.value)),className:"px-3 py-2 border border-slate-300 rounded-md text-sm font-medium text-slate-700 bg-white hover:border-primary-500 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-colors",children:[o.jsx("option",{value:3,children:"3 Months"}),o.jsx("option",{value:6,children:"6 Months"}),o.jsx("option",{value:12,children:"12 Months"})]})]})]}),o.jsx("div",{className:"bg-white rounded-lg p-3 sm:p-4 border border-slate-200",children:o.jsx(O1,{width:"100%",height:300,children:o.jsxs(P1,{data:R,margin:{top:10,right:10,left:0,bottom:5},children:[o.jsx($g,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),o.jsx(Ig,{dataKey:"month",tick:{fontSize:11,fill:"#64748b"},stroke:"#cbd5e1"}),o.jsx(Rg,{tick:{fontSize:11,fill:"#64748b"},stroke:"#cbd5e1",tickFormatter:X=>`${(X/1e3).toFixed(0)}k`}),o.jsx(R1,{formatter:X=>[`${X.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`,""],contentStyle:{backgroundColor:"white",border:"1px solid #e2e8f0",borderRadius:"8px",padding:"8px 12px",fontSize:"12px"}}),o.jsx(Ax,{wrapperStyle:{fontSize:"11px",paddingTop:"10px"},iconType:"rect"}),o.jsx(oh,{dataKey:"Platform Revenue",fill:"#10b981",radius:[4,4,0,0]})]})})})]}),o.jsxs("div",{className:"mt-6 sm:mt-8 grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-6",children:[o.jsxs(Lt,{className:"p-4 sm:p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[o.jsx("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0",children:o.jsx("h2",{className:"text-lg sm:text-xl font-semibold truncate",children:"Top Universities (Total Users)"})}),o.jsx(xae,{className:"h-4 w-4 sm:h-5 sm:w-5 text-slate-400 flex-shrink-0"})]}),i.length>0?(()=>{const X=i.map(Y=>{const B=y.get(Y.university),O=B?`${Y.university} (${B})`:Y.university;return{...Y,displayLabel:O,value:Y.tutors+Y.tutees}}).sort((Y,B)=>B.value-Y.value).slice(0,6),z=X.reduce((Y,B)=>Y+B.value,0),K=["#6366f1","#06b6d4","#10b981","#f59e0b","#ef4444","#8b5cf6"],H=X.map((Y,B)=>({label:Y.displayLabel,value:Y.value,color:K[B%K.length]}));return o.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4 sm:gap-6",children:[o.jsx("div",{className:"flex-shrink-0 mx-auto sm:mx-0",children:o.jsx(q,{items:H,size:180,centerLabel:String(z),centerSub:"Total Users"})}),o.jsxs("div",{className:"w-full sm:flex-1 space-y-2 min-w-0",children:[H.map((Y,B)=>o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1.5 sm:gap-3 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2.5 sm:py-2",children:[o.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[o.jsx("span",{className:"inline-block h-2.5 w-2.5 rounded-sm flex-shrink-0",style:{background:Y.color}}),o.jsx("span",{className:"text-sm text-slate-900 font-medium break-words",title:Y.label,children:Y.label})]}),o.jsxs("div",{className:"flex items-center justify-end sm:justify-start gap-1.5 sm:ml-auto flex-shrink-0",children:[o.jsx("span",{className:"text-sm sm:text-base text-slate-700 font-semibold whitespace-nowrap",children:Y.value}),o.jsxs("span",{className:"text-xs sm:text-sm text-slate-400 font-normal whitespace-nowrap",children:["(",Math.round(Y.value/(z||1)*100),"%)"]})]})]},B)),o.jsxs("p",{className:"text-xs text-slate-500 pt-1",children:["Total: ",z]})]})]})})():o.jsx("p",{className:"text-slate-500",children:"No university distribution data."})]}),o.jsxs(Lt,{className:"p-4 sm:p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3 sm:mb-4",children:[o.jsx("h2",{className:"text-lg sm:text-xl font-semibold",children:"Overall Users by Type"}),o.jsx(Pre,{className:"h-4 w-4 sm:h-5 sm:w-5 text-slate-400 flex-shrink-0"})]}),c?(()=>{const X=[{label:"Approved Tutors",value:c.tutors,color:"#6366f1"},{label:"Tutees",value:c.tutees,color:"#06b6d4"}],z=Math.max(1,X[0].value+X[1].value);return o.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4 sm:gap-6",children:[o.jsx("div",{className:"flex-shrink-0 mx-auto sm:mx-0",children:o.jsx(q,{items:X,size:180,centerLabel:String(z),centerSub:"Users"})}),o.jsxs("div",{className:"w-full sm:flex-1 space-y-2 min-w-0",children:[X.map((K,H)=>o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1.5 sm:gap-3 rounded-lg border border-slate-200 bg-slate-50 px-3 py-2.5 sm:py-2",children:[o.jsxs("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[o.jsx("span",{className:"inline-block h-2.5 w-2.5 rounded-sm flex-shrink-0",style:{background:K.color}}),o.jsx("span",{className:"text-sm text-slate-900 font-medium",children:K.label})]}),o.jsxs("div",{className:"flex items-center justify-end sm:justify-start gap-1.5 sm:ml-auto flex-shrink-0",children:[o.jsx("span",{className:"text-sm sm:text-base text-slate-700 font-semibold whitespace-nowrap",children:K.value}),o.jsxs("span",{className:"text-xs sm:text-sm text-slate-400 font-normal whitespace-nowrap",children:["(",Math.round(K.value/z*100),"%)"]})]})]},H)),o.jsxs("p",{className:"text-xs text-slate-500 pt-1",children:["Total: ",z]})]})]})})():o.jsx("p",{className:"text-slate-500",children:"No user totals available."})]})]}),o.jsxs("div",{className:"mt-6 sm:mt-8 grid grid-cols-1 xl:grid-cols-2 gap-4 sm:gap-6",children:[o.jsxs(Lt,{className:"p-4 sm:p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4 sm:mb-6",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl shadow-lg",children:o.jsx(cL,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsx("h2",{className:"text-lg sm:text-xl font-bold text-slate-800",children:"Top Courses (Total Users)"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-sm",style:{backgroundColor:"#6366f1"}}),o.jsx("span",{className:"text-xs sm:text-sm text-slate-600 font-medium",children:"Total Users"})]})]}),(()=>{const X=h.reduce((Y,B)=>{const O=B.courseName||"Unknown";return Y[O]||(Y[O]={courseName:O,tutors:0,tutees:0}),Y[O].tutors+=B.tutors||0,Y[O].tutees+=B.tutees||0,Y},{}),z=Object.values(X),K=W(z,Y=>Y.courseName,Y=>Y.tutors+Y.tutees,10);if(K.items.length===0||K.total===0)return o.jsx("div",{className:"text-center py-12",children:o.jsx("p",{className:"text-slate-500",children:"No course distribution data."})});const H=K.items.map(Y=>{const B=Y.label,O=b.get(B)||B;return{name:O.length>20?O.substring(0,20)+"...":O,fullName:B,value:Y.value}});return o.jsxs("div",{className:"w-full",children:[o.jsx(O1,{width:"100%",height:350,children:o.jsxs(P1,{data:H,margin:{top:20,right:30,left:20,bottom:60},children:[o.jsx($g,{strokeDasharray:"3 3",stroke:"#e2e8f0",vertical:!1}),o.jsx(Ig,{dataKey:"name",angle:-45,textAnchor:"end",height:100,tick:{fontSize:11,fill:"#64748b"},stroke:"#cbd5e1"}),o.jsx(Rg,{tick:{fontSize:11,fill:"#64748b"},stroke:"#cbd5e1",tickFormatter:Y=>bg(Y)}),o.jsx(R1,{content:({active:Y,payload:B})=>{var O;if(Y&&B&&B.length){const U=B[0].payload;return o.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-lg border border-slate-200",children:[o.jsx("p",{className:"font-semibold text-slate-900 mb-2",children:U.fullName}),o.jsxs("p",{className:"text-sm",style:{color:B[0].color},children:[o.jsx("span",{className:"font-medium",children:"Total Users:"})," ",o.jsx("span",{className:"font-bold",children:(O=U.value)==null?void 0:O.toLocaleString()})]})]})}return null}}),o.jsx(oh,{dataKey:"value",name:"Total Users",fill:"#6366f1",radius:[4,4,0,0],maxBarSize:60,children:H.map((Y,B)=>o.jsx(Ow,{fill:"#6366f1"},`cell-${B}`))})]})}),o.jsx("div",{className:"mt-6 pt-4 border-t border-slate-200",children:o.jsx("div",{className:"bg-gradient-to-br from-primary-50 to-primary-100/50 rounded-lg p-4 border border-primary-200",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-xs sm:text-sm font-semibold text-primary-700 uppercase tracking-wider mb-1",children:"Total Course Users"}),o.jsx("p",{className:"text-2xl sm:text-3xl font-extrabold text-primary-900",children:bg(K.total)})]}),o.jsx(cL,{className:"h-8 w-8 sm:h-10 sm:w-10 text-primary-400 opacity-60"})]})})})]})})()]}),o.jsxs(Lt,{className:"p-4 sm:p-6",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4 sm:mb-6",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl shadow-lg",children:o.jsx(Du,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsx("h2",{className:"text-lg sm:text-xl font-bold text-slate-800",children:"Sessions per Subject"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"w-3 h-3 rounded-sm bg-primary-600"}),o.jsx("span",{className:"text-xs sm:text-sm text-slate-600 font-medium",children:"Sessions"})]})]}),(()=>{const X=W(p,K=>K.subjectName,K=>K.sessions,10);if(X.items.length===0||X.total===0)return o.jsx("div",{className:"text-center py-12",children:o.jsx("p",{className:"text-slate-500",children:"No subject sessions data."})});const z=X.items.map(K=>({name:K.label.length>20?K.label.substring(0,20)+"...":K.label,fullName:K.label,value:K.value}));return o.jsxs("div",{className:"w-full",children:[o.jsx(O1,{width:"100%",height:350,children:o.jsxs(P1,{data:z,margin:{top:20,right:30,left:20,bottom:60},children:[o.jsx($g,{strokeDasharray:"3 3",stroke:"#e2e8f0",vertical:!1}),o.jsx(Ig,{dataKey:"name",angle:-45,textAnchor:"end",height:100,tick:{fontSize:11,fill:"#64748b"},stroke:"#cbd5e1"}),o.jsx(Rg,{tick:{fontSize:11,fill:"#64748b"},stroke:"#cbd5e1",tickFormatter:K=>bg(K)}),o.jsx(R1,{content:({active:K,payload:H})=>{var Y;if(K&&H&&H.length){const B=H[0].payload;return o.jsxs("div",{className:"bg-white p-3 rounded-lg shadow-lg border border-slate-200",children:[o.jsx("p",{className:"font-semibold text-slate-900 mb-2",children:B.fullName}),o.jsxs("p",{className:"text-sm",style:{color:H[0].color},children:[o.jsx("span",{className:"font-medium",children:"Sessions:"})," ",o.jsx("span",{className:"font-bold",children:(Y=B.value)==null?void 0:Y.toLocaleString()})]})]})}return null}}),o.jsx(oh,{dataKey:"value",name:"Sessions",fill:"#435de9",radius:[4,4,0,0],maxBarSize:60,children:z.map((K,H)=>o.jsx(Ow,{fill:"#435de9"},`cell-${H}`))})]})}),o.jsx("div",{className:"mt-6 pt-4 border-t border-slate-200",children:o.jsx("div",{className:"bg-gradient-to-br from-primary-100 to-primary-200/50 rounded-lg p-4 border border-primary-300",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-xs sm:text-sm font-semibold text-primary-800 uppercase tracking-wider mb-1",children:"Total Sessions"}),o.jsx("p",{className:"text-2xl sm:text-3xl font-extrabold text-primary-900",children:bg(X.total)})]}),o.jsx(Du,{className:"h-8 w-8 sm:h-10 sm:w-10 text-primary-500 opacity-60"})]})})})]})})()]})]})]})},r8=()=>o.jsx(PH,{children:o.jsx(P1e,{})}),On=({isOpen:t,onClose:e,title:n,children:s,footer:r,className:a="",maxWidth:i="2xl"})=>{if(!t)return null;const l={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl","2xl":"max-w-2xl","4xl":"max-w-4xl","5xl":"max-w-5xl","6xl":"max-w-6xl","7xl":"max-w-7xl"};return o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-2 sm:p-4 overflow-y-auto",onClick:e,children:o.jsxs("div",{className:`bg-white rounded-lg sm:rounded-xl shadow-xl w-full ${l[i]} max-h-[95vh] sm:max-h-[90vh] my-auto flex flex-col ${a}`,onClick:c=>c.stopPropagation(),children:[n&&o.jsxs("div",{className:"flex justify-between items-center p-4 sm:p-5 border-b border-slate-200 flex-shrink-0",children:[o.jsx("h2",{className:"text-lg sm:text-xl font-bold text-slate-800 pr-2",children:n}),o.jsx("button",{onClick:e,className:"text-slate-500 hover:text-slate-800 active:text-slate-900 text-2xl sm:text-3xl leading-none p-1 rounded-lg hover:bg-slate-100 active:bg-slate-200 transition-colors touch-manipulation flex-shrink-0",style:{WebkitTapHighlightColor:"transparent"},"aria-label":"Close modal",children:""})]}),!n&&o.jsx("div",{className:"absolute top-3 right-3 z-10",children:o.jsx("button",{onClick:e,className:"text-slate-500 hover:text-slate-800 active:text-slate-900 text-2xl leading-none bg-white/90 hover:bg-white rounded-full w-9 h-9 sm:w-10 sm:h-10 flex items-center justify-center shadow-lg hover:shadow-xl transition-all touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},"aria-label":"Close modal",children:""})}),o.jsx("div",{className:"flex-1 overflow-y-auto min-h-0 p-4 sm:p-6",children:s}),r&&o.jsx("div",{className:"flex flex-col sm:flex-row justify-end gap-2 sm:gap-2 p-4 sm:p-5 border-t border-slate-200 flex-shrink-0 bg-slate-50 sm:bg-white",children:r})]})})},L1e=()=>{var K,H,Y,B;const[t,e]=j.useState([]),[n,s]=j.useState("all"),[r,a]=j.useState(!0),[i,l]=j.useState(null),[c,u]=j.useState(null),[h,f]=j.useState([]),[p,x]=j.useState(!0),[y,v]=j.useState(null),[b,N]=j.useState("open"),[S,k]=j.useState(""),[T,E]=j.useState(null),[D,A]=j.useState(null),I=async()=>{try{a(!0);const O=await we.get("/users");e(O.data)}catch(O){l("Failed to fetch users."),console.error(O)}finally{a(!1)}},P=async()=>{try{x(!0);const U=(await we.get("/payments")).data;f(U.filter(J=>J.dispute_status&&J.dispute_status!=="none"))}catch(O){console.error(O)}finally{x(!1)}},$=async(O,U)=>{var ae,fe;const J=U==="active"?"inactive":"active";if(confirm(J==="inactive"?"Deactivate this user?":"Activate this user?"))try{u(O),await we.patch(`/users/${O}/status`,{status:J}),await I()}catch(ye){alert(((fe=(ae=ye==null?void 0:ye.response)==null?void 0:ae.data)==null?void 0:fe.message)||"Failed to update user status.")}finally{u(null)}},R=async O=>{const U=prompt("Enter a new password (min 7 chars):");!U||U.length<7||(await we.patch(`/users/${O}/reset-password`,{newPassword:U}),alert("Password reset successfully"))},F=O=>{E(O);const U={name:O.name,email:O.email,status:O.status||"active"};O.university_id&&(U.university_id=O.university_id),O.role!=="admin"&&O.year_level&&(U.year_level=O.year_level),A(U)},W=async()=>{if(!T||!D)return;const O={...D};T.role==="admin"&&delete O.year_level,await we.patch(`/users/${T.user_id}`,O),E(null),A(null),await I()},[q,X]=j.useState([]),z=async()=>{try{const O=await we.get("/universities");X(O.data)}catch(O){console.error("Failed to fetch universities:",O)}};return j.useEffect(()=>{I(),P(),z()},[]),r?o.jsx("div",{children:"Loading users..."}):i?o.jsx("div",{className:"text-red-500",children:i}):o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-800 mb-4 sm:mb-6",children:"User Management"}),o.jsxs("div",{className:"mb-4 flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-3",children:[o.jsx("label",{htmlFor:"user-type-filter",className:"text-sm font-medium text-slate-700 whitespace-nowrap",children:"Filter by User Type:"}),o.jsxs("select",{id:"user-type-filter",className:"border border-slate-300 rounded-md px-3 py-2 text-sm w-full sm:w-auto min-w-[150px]",value:n,onChange:O=>s(O.target.value),children:[o.jsx("option",{value:"all",children:"All"}),o.jsx("option",{value:"admin",children:"Admin"}),o.jsx("option",{value:"tutor",children:"Tutor"}),o.jsx("option",{value:"student",children:"Tutee"})]})]}),o.jsx(Lt,{className:"hidden md:block",children:o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full table-auto divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"University"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider w-40",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.filter(O=>n==="all"?!0:O.role===n).map(O=>o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:o.jsxs("div",{className:"flex items-center",children:[O.profile_image_url?o.jsx("img",{src:Zt(O.profile_image_url),alt:O.name,className:"h-10 w-10 rounded-full mr-3 object-cover flex-shrink-0",style:{aspectRatio:"1 / 1"},onError:U=>{const J=U.target;J.src="https://ui-avatars.com/api/?name="+encodeURIComponent(O.name)+"&background=random"}}):o.jsx("div",{className:"h-10 w-10 rounded-full mr-3 bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center text-white font-semibold flex-shrink-0",children:O.name.charAt(0).toUpperCase()}),O.name]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:O.email}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 capitalize",children:O.role}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:O.university_name||"N/A"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:o.jsxs("div",{className:"flex flex-col space-y-1",children:[o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${(O.status||"active")==="active"?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:O.status||"active"}),O.role==="tutor"&&O.tutor_profile&&o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${O.tutor_profile.status==="approved"?"bg-green-100 text-green-800":O.tutor_profile.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:O.tutor_profile.status||"pending"})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium",children:o.jsxs("div",{className:"inline-flex items-center gap-2",children:[o.jsx("button",{className:"text-green-600 hover:text-green-800 bg-green-50 hover:bg-green-100 border border-green-200 rounded px-2 py-1 transition-colors",title:"Edit",onClick:()=>F(O),children:o.jsx(fh,{className:"inline h-4 w-4"})}),o.jsx("button",{className:"text-blue-600 hover:text-blue-800 bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded px-2 py-1 transition-colors disabled:opacity-50",title:"Reset Password",onClick:()=>R(O.user_id),disabled:c===O.user_id,children:o.jsx(Q3,{className:"inline h-4 w-4"})}),o.jsx("button",{className:"text-red-600 hover:text-red-800 bg-red-50 hover:bg-red-100 border border-red-200 rounded px-2 py-1 transition-colors disabled:opacity-50",title:"Toggle Active",onClick:()=>$(O.user_id,O.status||"active"),disabled:c===O.user_id,children:o.jsx(Au,{className:"inline h-4 w-4"})})]})})]},O.user_id))})]})})}),o.jsx("div",{className:"md:hidden space-y-3",children:t.filter(O=>n==="all"?!0:O.role===n).map(O=>o.jsx(Lt,{className:"p-4",children:o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[O.profile_image_url?o.jsx("img",{src:Zt(O.profile_image_url),alt:O.name,className:"h-12 w-12 rounded-full object-cover flex-shrink-0",style:{aspectRatio:"1 / 1"},onError:U=>{const J=U.target;J.src="https://ui-avatars.com/api/?name="+encodeURIComponent(O.name)+"&background=random"}}):o.jsx("div",{className:"h-12 w-12 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center text-white font-semibold flex-shrink-0",children:O.name.charAt(0).toUpperCase()}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h3",{className:"font-semibold text-slate-900 truncate",children:O.name}),o.jsx("p",{className:"text-sm text-slate-500 truncate",children:O.email})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-slate-500 text-xs mb-1",children:"Role"}),o.jsx("p",{className:"font-medium text-slate-900 capitalize",children:O.role})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-slate-500 text-xs mb-1",children:"University"}),o.jsx("p",{className:"font-medium text-slate-900 truncate",children:O.university_name||"N/A"})]})]}),o.jsxs("div",{className:"flex flex-wrap gap-2",children:[o.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${(O.status||"active")==="active"?"bg-blue-100 text-blue-800":"bg-red-100 text-red-800"}`,children:O.status||"active"}),O.role==="tutor"&&O.tutor_profile&&o.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${O.tutor_profile.status==="approved"?"bg-green-100 text-green-800":O.tutor_profile.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:O.tutor_profile.status||"pending"})]}),o.jsxs("div",{className:"flex items-center gap-2 pt-2 border-t border-slate-200",children:[o.jsxs("button",{className:"flex-1 text-green-600 hover:text-green-800 bg-green-50 hover:bg-green-100 border border-green-200 rounded px-3 py-2 text-sm font-medium transition-colors flex items-center justify-center gap-2",title:"Edit",onClick:()=>F(O),children:[o.jsx(fh,{className:"h-4 w-4"}),o.jsx("span",{children:"Edit"})]}),o.jsxs("button",{className:"flex-1 text-blue-600 hover:text-blue-800 bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50 flex items-center justify-center gap-2",title:"Reset Password",onClick:()=>R(O.user_id),disabled:c===O.user_id,children:[o.jsx(Q3,{className:"h-4 w-4"}),o.jsx("span",{children:"Reset"})]}),o.jsxs("button",{className:"flex-1 text-red-600 hover:text-red-800 bg-red-50 hover:bg-red-100 border border-red-200 rounded px-3 py-2 text-sm font-medium transition-colors disabled:opacity-50 flex items-center justify-center gap-2",title:"Toggle Active",onClick:()=>$(O.user_id,O.status||"active"),disabled:c===O.user_id,children:[o.jsx(Au,{className:"h-4 w-4"}),o.jsx("span",{children:"Status"})]})]})]})},O.user_id))}),T&&D&&o.jsx(On,{isOpen:!0,onClose:()=>{E(null),A(null)},title:`Edit User: ${T.name}`,footer:o.jsxs(o.Fragment,{children:[o.jsx(at,{variant:"secondary",onClick:()=>{E(null),A(null)},children:"Cancel"}),o.jsx(at,{onClick:W,children:"Save"})]}),children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Name"}),o.jsx("input",{className:"mt-1 block w-full border border-slate-300 rounded-md px-3 py-2",value:D.name,onChange:O=>A(U=>U&&{...U,name:O.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Email"}),o.jsx("input",{className:"mt-1 block w-full border border-slate-300 rounded-md px-3 py-2",value:D.email,onChange:O=>A(U=>U&&{...U,email:O.target.value})})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Status"}),o.jsxs("select",{className:"mt-1 block w-full border border-slate-300 rounded-md px-3 py-2",value:D.status,onChange:O=>A(U=>U&&{...U,status:O.target.value}),children:[o.jsx("option",{value:"active",children:"Active"}),o.jsx("option",{value:"inactive",children:"Inactive"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"University"}),o.jsxs("select",{className:"mt-1 block w-full border border-slate-300 rounded-md px-3 py-2",value:D.university_id||"",onChange:O=>A(U=>U&&{...U,university_id:O.target.value?Number(O.target.value):void 0}),children:[o.jsx("option",{value:"",children:"Select University"}),q.map(O=>o.jsx("option",{value:O.university_id,children:O.name},O.university_id))]})]})]}),T&&T.role!=="admin"&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Year Level (optional)"}),o.jsx("input",{type:"number",min:1,max:6,className:"mt-1 block w-full border border-slate-300 rounded-md px-3 py-2",value:D.year_level||"",onChange:O=>A(U=>U&&{...U,year_level:O.target.value?Number(O.target.value):void 0})})]})]})}),o.jsx("div",{className:"mt-8"}),o.jsx("h2",{className:"text-2xl font-semibold text-slate-800 mb-4",children:"Payment Disputes"}),o.jsx(Lt,{children:p?o.jsx("div",{children:"Loading disputes..."}):o.jsx("div",{className:"overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Payment"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tutor"}),o.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),o.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:h.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-gray-500",children:"No disputes at the moment."})}):h.map(O=>{var U,J,se,ae;return o.jsxs("tr",{children:[o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:["#",O.payment_id]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:((J=(U=O.student)==null?void 0:U.user)==null?void 0:J.name)||"N/A"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-700",children:((ae=(se=O.tutor)==null?void 0:se.user)==null?void 0:ae.name)||"N/A"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:o.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-yellow-100 text-yellow-800",children:O.dispute_status})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm",children:o.jsxs(at,{variant:"secondary",onClick:()=>{v(O),N(O.dispute_status||"open"),k(O.admin_note||"")},children:[o.jsx(bs,{className:"mr-2 h-4 w-4"})," Review"]})})]},O.payment_id)})})]})})}),y&&o.jsx(On,{isOpen:!0,onClose:()=>v(null),title:`Dispute #${y.payment_id}`,footer:o.jsxs(o.Fragment,{children:[o.jsx(at,{variant:"secondary",onClick:()=>v(null),children:"Close"}),o.jsx(at,{onClick:async()=>{await we.patch(`/payments/${y.payment_id}/dispute`,{dispute_status:b,admin_note:S}),v(null),P()},children:"Save"})]}),children:o.jsxs("div",{className:"space-y-4 text-sm",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-slate-500",children:"Student"}),o.jsx("div",{className:"text-slate-800 font-medium",children:((H=(K=y.student)==null?void 0:K.user)==null?void 0:H.name)||"N/A"})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-slate-500",children:"Tutor"}),o.jsx("div",{className:"text-slate-800 font-medium",children:((B=(Y=y.tutor)==null?void 0:Y.user)==null?void 0:B.name)||"N/A"})]})]}),y.dispute_proof_url&&o.jsxs("div",{children:[o.jsx("div",{className:"text-slate-500 mb-1",children:"Proof"}),o.jsxs("a",{href:y.dispute_proof_url,target:"_blank",rel:"noreferrer",className:"inline-flex items-center text-primary-600 hover:underline",children:[o.jsx(bs,{className:"mr-2 h-4 w-4"})," View attachment"]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Dispute Status"}),o.jsxs("select",{className:"mt-1 block w-full border border-slate-300 rounded-md px-3 py-2",value:b,onChange:O=>N(O.target.value),children:[o.jsx("option",{value:"open",children:"Open"}),o.jsx("option",{value:"under_review",children:"Under Review"}),o.jsx("option",{value:"resolved",children:"Resolved"}),o.jsx("option",{value:"rejected",children:"Rejected"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Admin Note"}),o.jsx("textarea",{className:"mt-1 block w-full border border-slate-300 rounded-md px-3 py-2",rows:4,value:S,onChange:O=>k(O.target.value)})]})]})})]})},M1e=()=>{var Te,oe,Se,ke,me,re,je,ie,Re,Ve,Ze,bt,tt,St,mt,jt;const[t,e]=j.useState([]),[n,s]=j.useState(!0),[r,a]=j.useState(null),[i,l]=j.useState(null),[c,u]=j.useState(!1),[h,f]=j.useState(!1),[p,x]=j.useState(!1),[y,v]=j.useState(""),[b,N]=j.useState(""),[S,k]=j.useState([]),[T,E]=j.useState(!0),[D,A]=j.useState(null),[I,P]=j.useState(!1),[$,R]=j.useState(!1),[F,W]=j.useState(""),[q,X]=j.useState(""),[z,K]=j.useState(!1),[H,Y]=j.useState(null),B=async()=>{try{s(!0);const Oe=await we.get("/tutors/applications");e(Oe.data)}catch(Oe){a("Failed to fetch tutor applications."),console.error(Oe);const ht=window.__notify;ht&&ht("Unable to load tutor applications. Please try again.","error")}finally{s(!1)}},O=async()=>{try{E(!0);const Oe=await we.get("/tutors/pending-subjects");k(Oe.data)}catch(Oe){console.error("Failed to fetch tutor subjects:",Oe);const ht=window.__notify;ht&&ht("Unable to load tutor subjects. Please try again.","error")}finally{E(!1)}};j.useEffect(()=>{B(),O()},[]);const U=Oe=>{l(Oe),u(!0)},J=async Oe=>{if(i){if(Oe==="rejected"){X(""),Y(()=>async()=>{await se(Oe)}),K(!0);return}await se(Oe)}},se=async(Oe,ht)=>{if(i){f(!0);try{let ut;if(Oe==="rejected"){const L=ht!==void 0?ht:q.trim();if(L.length>0)ut=L,console.log(`[Frontend] Admin rejection reason entered: "${ut}"`),console.log("[Frontend] This will be stored in tutors.admin_notes database column");else{console.error("[Frontend] ERROR: Rejecting without admin notes - modal validation should prevent this!"),alert("Please provide a rejection reason before confirming."),f(!1);return}}if(console.log(`[Frontend] Sending PATCH request to update tutor ${i.tutor_id} status to '${Oe}'`),console.log("[Frontend] Admin notes being sent to backend (will be saved to tutors.admin_notes):",ut||"undefined"),await we.patch(`/tutors/${i.tutor_id}/status`,{status:Oe,adminNotes:ut}),Oe==="rejected")try{const ee=((await we.get(`/tutors/${i.tutor_id}/subject-applications`)).data||[]).filter(ce=>ce.status==="pending");if(ee.length>0){const Ce=`Automatically rejected: Main tutor application was rejected. Reason: ${ut||"No specific reason provided"}`,De=ee.map(xt=>we.patch(`/tutors/tutor-subjects/${xt.id}/status`,{status:"rejected",adminNotes:Ce}));await Promise.all(De),console.log(`Automatically rejected ${ee.length} pending subject application(s) for tutor ${i.tutor_id}`)}}catch(L){console.error("Failed to auto-reject subject applications:",L)}u(!1),K(!1),X(""),await B(),await O();const Q=window.__notify;Q&&Q(`Application ${Oe==="approved"?"approved":"rejected"} successfully.${Oe==="rejected"?" All pending subject applications have also been rejected.":""}`,"success")}catch(ut){console.error("Failed to update status",ut);const Q=window.__notify;Q&&Q("Failed to update application status. Please try again.","error")}finally{f(!1)}}},ae=Oe=>{A(Oe),W(Oe.admin_notes||""),P(!0)},fe=async Oe=>{if(D){R(!0);try{await we.patch(`/tutors/tutor-subjects/${D.tutor_subject_id}/status`,{status:Oe,adminNotes:F.trim()||void 0}),P(!1),W(""),await O();const ht=window.__notify;ht&&ht(`Tutor subject ${Oe==="approved"?"approved":"rejected"} successfully.`,"success")}catch(ht){console.error("Failed to update tutor subject status",ht);const ut=window.__notify;ut&&ut("Failed to update tutor subject status. Please try again.","error")}finally{R(!1)}}},ye=(Oe,ht)=>{const ut=(ht||"").toLowerCase();if(ut.startsWith("image/")||ut==="application/pdf"){v(Oe),N(ut),x(!0);return}const Q=Oe.toLowerCase();if(Q.endsWith(".pdf")){v(Oe),N("application/pdf"),x(!0);return}if(/(\.png|\.jpg|\.jpeg|\.gif|\.webp)$/.test(Q)){v(Oe),N("image/*"),x(!0);return}window.open(Oe,"_blank","noopener,noreferrer")};return n?o.jsx("div",{children:"Loading applications..."}):r?o.jsx("div",{className:"text-red-500",children:r}):o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-800 mb-4 sm:mb-6",children:"Tutor Application Management"}),o.jsxs(Lt,{children:[o.jsxs("h2",{className:"text-lg sm:text-xl font-semibold mb-3 sm:mb-4",children:["Pending Applications (",t.length,")"]}),o.jsx("div",{className:"hidden md:block overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"University"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Course"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:4,className:"px-6 py-4 text-center text-gray-500",children:"No pending applications found."})}):t.map(Oe=>{var ht,ut,Q,L,M;return o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:o.jsxs("div",{className:"flex items-center gap-3",children:[(ht=Oe.user)!=null&&ht.profile_image_url?o.jsx("img",{src:Zt(Oe.user.profile_image_url),alt:"Tutor",className:"h-8 w-8 rounded-full object-cover border flex-shrink-0",style:{aspectRatio:"1 / 1"},onError:ee=>{var ce;ee.target.src=`https://ui-avatars.com/api/?name=${encodeURIComponent(((ce=Oe.user)==null?void 0:ce.name)||"Tutor")}&background=random`}}):o.jsx("img",{src:`https://ui-avatars.com/api/?name=${encodeURIComponent(((ut=Oe.user)==null?void 0:ut.name)||"Tutor")}&background=random`,alt:"Tutor",className:"h-8 w-8 rounded-full object-cover border flex-shrink-0",style:{aspectRatio:"1 / 1"}}),o.jsx("span",{className:"truncate max-w-[200px]",children:(Q=Oe.user)==null?void 0:Q.name})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:((L=Oe.university)==null?void 0:L.name)||"N/A"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:((M=Oe.course)==null?void 0:M.course_name)||"N/A"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium",children:o.jsx("div",{className:"flex justify-center",children:o.jsx(at,{onClick:()=>U(Oe),children:"View Details"})})})]},Oe.tutor_id)})})]})}),o.jsx("div",{className:"md:hidden space-y-3 mt-4",children:t.length===0?o.jsx("p",{className:"text-center text-slate-500 py-4",children:"No pending applications found."}):t.map(Oe=>{var ht,ut,Q,L,M;return o.jsx(Lt,{className:"p-4",children:o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[(ht=Oe.user)!=null&&ht.profile_image_url?o.jsx("img",{src:Zt(Oe.user.profile_image_url),alt:"Tutor",className:"h-12 w-12 rounded-full object-cover border flex-shrink-0",style:{aspectRatio:"1 / 1"},onError:ee=>{var ce;ee.target.src=`https://ui-avatars.com/api/?name=${encodeURIComponent(((ce=Oe.user)==null?void 0:ce.name)||"Tutor")}&background=random`}}):o.jsx("img",{src:`https://ui-avatars.com/api/?name=${encodeURIComponent(((ut=Oe.user)==null?void 0:ut.name)||"Tutor")}&background=random`,alt:"Tutor",className:"h-12 w-12 rounded-full object-cover border flex-shrink-0",style:{aspectRatio:"1 / 1"}}),o.jsx("div",{className:"flex-1 min-w-0",children:o.jsx("h3",{className:"font-semibold text-slate-900 truncate",children:(Q=Oe.user)==null?void 0:Q.name})})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-slate-500 text-xs mb-1",children:"University"}),o.jsx("p",{className:"font-medium text-slate-900 truncate",children:((L=Oe.university)==null?void 0:L.name)||"N/A"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-slate-500 text-xs mb-1",children:"Course"}),o.jsx("p",{className:"font-medium text-slate-900 truncate",children:((M=Oe.course)==null?void 0:M.course_name)||"N/A"})]})]}),o.jsx(at,{onClick:()=>U(Oe),className:"w-full",children:"View Details"})]})},Oe.tutor_id)})})]}),o.jsxs(Lt,{className:"mt-6 sm:mt-8",children:[o.jsxs("h2",{className:"text-lg sm:text-xl font-semibold mb-3 sm:mb-4",children:["Pending Subject Expertise (",S.length,")"]}),T?o.jsx("div",{className:"text-center py-4 text-sm",children:"Loading tutor subjects..."}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"hidden md:block overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tutor"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Applied Date"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:S.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:4,className:"px-6 py-4 text-center text-gray-500",children:"No pending subject expertise found."})}):S.map(Oe=>{var ht,ut,Q,L;return o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:o.jsxs("div",{className:"flex items-center gap-3",children:[(ht=Oe.tutor.user)!=null&&ht.profile_image_url?o.jsx("img",{src:Zt(Oe.tutor.user.profile_image_url),alt:"Tutor",className:"h-8 w-8 rounded-full object-cover border flex-shrink-0",style:{aspectRatio:"1 / 1"}}):o.jsx("div",{className:"h-8 w-8 rounded-full bg-slate-200 border flex-shrink-0"}),o.jsx("span",{className:"truncate max-w-[200px]",children:(Q=(ut=Oe.tutor)==null?void 0:ut.user)==null?void 0:Q.name})]})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:o.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:(L=Oe.subject)==null?void 0:L.subject_name})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(Oe.created_at).toLocaleDateString()}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm font-medium",children:o.jsx("div",{className:"flex justify-center",children:o.jsx(at,{onClick:()=>ae(Oe),children:"View Details"})})})]},Oe.tutor_subject_id)})})]})}),o.jsx("div",{className:"md:hidden space-y-3 mt-4",children:S.length===0?o.jsx("p",{className:"text-center text-slate-500 py-4",children:"No pending subject expertise found."}):S.map(Oe=>{var ht,ut,Q,L;return o.jsx(Lt,{className:"p-4",children:o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[(ht=Oe.tutor.user)!=null&&ht.profile_image_url?o.jsx("img",{src:Zt(Oe.tutor.user.profile_image_url),alt:"Tutor",className:"h-12 w-12 rounded-full object-cover border flex-shrink-0",style:{aspectRatio:"1 / 1"}}):o.jsx("div",{className:"h-12 w-12 rounded-full bg-slate-200 border flex-shrink-0"}),o.jsx("div",{className:"flex-1 min-w-0",children:o.jsx("h3",{className:"font-semibold text-slate-900 truncate",children:(Q=(ut=Oe.tutor)==null?void 0:ut.user)==null?void 0:Q.name})})]}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-slate-500 text-xs mb-1",children:"Subject"}),o.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:(L=Oe.subject)==null?void 0:L.subject_name})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-slate-500 text-xs mb-1",children:"Applied Date"}),o.jsx("p",{className:"font-medium text-slate-900",children:new Date(Oe.created_at).toLocaleDateString()})]})]}),o.jsx(at,{onClick:()=>ae(Oe),className:"w-full",children:"View Details"})]})},Oe.tutor_subject_id)})})]})]}),i&&o.jsx(On,{isOpen:c,onClose:()=>u(!1),title:"Application Details",maxWidth:"5xl",footer:o.jsxs("div",{className:"flex flex-row items-center justify-end gap-2 flex-wrap sm:flex-nowrap",children:[o.jsxs(at,{onClick:()=>J("rejected"),variant:"danger",disabled:h,className:"flex items-center",children:[o.jsx(Rn,{className:"mr-2 h-4 w-4"}),h?"Rejecting...":"Reject"]}),o.jsxs(at,{onClick:()=>J("approved"),variant:"primary",disabled:h,className:"flex items-center",children:[o.jsx(aL,{className:"mr-2 h-4 w-4"}),h?"Approving...":"Approve"]})]}),children:o.jsxs("div",{className:"space-y-6 sm:space-y-8",children:[o.jsxs("div",{className:"bg-gradient-to-br from-primary-600 via-primary-700 to-primary-800 p-6 sm:p-8 rounded-2xl text-white relative overflow-hidden shadow-2xl",children:[o.jsxs("div",{className:"absolute inset-0 opacity-20",children:[o.jsx("div",{className:"absolute top-0 right-0 w-40 h-40 bg-white rounded-full -mr-20 -mt-20 blur-2xl"}),o.jsx("div",{className:"absolute bottom-0 left-0 w-32 h-32 bg-white rounded-full -ml-16 -mb-16 blur-2xl"}),o.jsx("div",{className:"absolute top-1/2 left-1/2 w-24 h-24 bg-white rounded-full -translate-x-1/2 -translate-y-1/2 blur-xl"})]}),o.jsxs("div",{className:"relative flex flex-col sm:flex-row items-start sm:items-center gap-5 sm:gap-6",children:[(Te=i.user)!=null&&Te.profile_image_url?o.jsx("div",{className:"flex-shrink-0",children:o.jsx("div",{className:"h-24 w-24 sm:h-28 sm:w-28 rounded-full ring-4 ring-white/40 shadow-2xl overflow-hidden bg-white/20 backdrop-blur-sm transform hover:scale-105 transition-transform duration-300",children:o.jsx("img",{src:Zt(i.user.profile_image_url),alt:"Tutor Profile",className:"w-full h-full object-cover",style:{aspectRatio:"1/1"}})})}):o.jsx("div",{className:"flex-shrink-0",children:o.jsx("div",{className:"h-24 w-24 sm:h-28 sm:w-28 rounded-full ring-4 ring-white/40 shadow-2xl bg-white/20 backdrop-blur-sm flex items-center justify-center",children:o.jsx(za,{className:"h-12 w-12 sm:h-14 sm:w-14 text-white/80"})})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h3",{className:"text-2xl sm:text-3xl font-bold mb-2 drop-shadow-lg",children:(oe=i.user)==null?void 0:oe.name}),o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-4 text-white/95",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Y3,{className:"h-4 w-4 sm:h-5 sm:w-5 flex-shrink-0"}),o.jsx("p",{className:"text-sm sm:text-base truncate",children:(Se=i.user)==null?void 0:Se.email})]}),((ke=i.university)==null?void 0:ke.name)&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Z3,{className:"h-4 w-4 sm:h-5 sm:w-5 flex-shrink-0"}),o.jsx("p",{className:"text-sm sm:text-base truncate",children:(me=i.university)==null?void 0:me.name})]})]})]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-5 lg:gap-6",children:[o.jsxs("div",{className:"space-y-4 sm:space-y-5",children:[o.jsxs("div",{className:"bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl p-4 sm:p-5 shadow-xl border border-slate-200/50 hover:shadow-2xl hover:border-primary-300 transition-all duration-300",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3 sm:mb-4",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl flex-shrink-0 shadow-lg",children:o.jsx(Z3,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsx("h4",{className:"text-lg sm:text-xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"University & Course"})]}),o.jsxs("div",{className:"space-y-2.5 sm:space-y-3",children:[o.jsxs("div",{className:"bg-gradient-to-br from-primary-50 via-primary-100/50 to-primary-50 p-3.5 sm:p-4 rounded-xl border-2 border-primary-200/50 shadow-sm hover:shadow-md transition-shadow",children:[o.jsx("span",{className:"text-xs text-slate-500 font-semibold uppercase tracking-wide block mb-1.5",children:"University"}),o.jsx("p",{className:"text-slate-800 font-bold text-sm sm:text-base",children:((re=i.university)==null?void 0:re.name)||o.jsx("span",{className:"text-slate-400 italic",children:"Not specified"})})]}),o.jsxs("div",{className:"bg-gradient-to-br from-primary-50 via-primary-100/50 to-primary-50 p-3.5 sm:p-4 rounded-xl border-2 border-primary-200/50 shadow-sm hover:shadow-md transition-shadow",children:[o.jsx("span",{className:"text-xs text-slate-500 font-semibold uppercase tracking-wide block mb-1.5",children:"Course"}),o.jsx("p",{className:"text-slate-800 font-bold text-sm sm:text-base",children:((je=i.course)==null?void 0:je.course_name)||o.jsx("span",{className:"text-slate-400 italic",children:"Not specified"})})]})]})]}),o.jsxs("div",{className:"bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl p-4 sm:p-5 shadow-xl border border-slate-200/50 hover:shadow-2xl hover:border-primary-300 transition-all duration-300",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3 sm:mb-4",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl flex-shrink-0 shadow-lg",children:o.jsx(za,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsx("h4",{className:"text-lg sm:text-xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"Bio"})]}),o.jsx("div",{className:"bg-gradient-to-br from-slate-50 via-primary-50/30 to-slate-50 p-3.5 sm:p-4 rounded-xl border-2 border-slate-200/50 shadow-sm min-h-[80px]",children:o.jsx("p",{className:"text-slate-700 leading-relaxed text-sm",children:i.bio||o.jsx("span",{className:"text-slate-400 italic",children:"No bio provided."})})})]}),o.jsxs("div",{className:"bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl p-4 sm:p-5 shadow-xl border border-slate-200/50 hover:shadow-2xl hover:border-primary-300 transition-all duration-300",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3 sm:mb-4",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl flex-shrink-0 shadow-lg",children:o.jsx(rL,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsx("h4",{className:"text-lg sm:text-xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"Expert Subjects"})]}),o.jsx("div",{className:"flex flex-wrap gap-2",children:(ie=i.subjects)!=null&&ie.length?i.subjects.map(Oe=>{var ht;return o.jsx("span",{className:"px-3 py-1.5 bg-gradient-to-r from-primary-600 to-primary-700 text-white rounded-lg text-xs sm:text-sm font-semibold shadow-md hover:shadow-lg hover:scale-105 transition-all duration-200 border border-primary-400/30",children:(ht=Oe.subject)==null?void 0:ht.subject_name},Oe.tutor_subject_id)}):o.jsx("span",{className:"text-xs sm:text-sm text-slate-400 italic bg-slate-50 px-3 py-1.5 rounded-lg border border-slate-200",children:"No subjects submitted."})})]}),o.jsxs("div",{className:"bg-gradient-to-br from-primary-50 via-primary-100/50 to-primary-50 rounded-xl sm:rounded-2xl p-4 sm:p-5 shadow-xl border-2 border-primary-200/50 hover:shadow-2xl hover:border-primary-300 transition-all duration-300",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3 sm:mb-4",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl flex-shrink-0 shadow-lg",children:o.jsx(Un,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsx("h4",{className:"text-lg sm:text-xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"Availability"})]}),o.jsx("ul",{className:"grid grid-cols-1 gap-2.5",children:(Re=i.availabilities)!=null&&Re.length?(()=>{const Oe=i.availabilities.reduce((ht,ut)=>{const Q=ut.day_of_week;return ht[Q]||(ht[Q]=[]),ht[Q].push(ut),ht},{});return Object.entries(Oe).map(([ht,ut])=>o.jsx("li",{className:"bg-white p-3.5 sm:p-4 rounded-xl border-2 border-primary-200/50 hover:border-primary-400 hover:shadow-lg transition-all duration-200 shadow-sm",children:o.jsxs("div",{className:"flex items-start justify-between gap-3",children:[o.jsx("span",{className:"font-bold text-slate-800 text-sm sm:text-base flex-shrink-0 min-w-[100px]",children:ht}),o.jsx("div",{className:"flex flex-wrap gap-2 flex-1 justify-end",children:ut.map(Q=>o.jsxs("span",{className:"text-primary-700 font-semibold text-xs sm:text-sm bg-gradient-to-r from-primary-50 to-primary-100/50 px-2.5 py-1.5 rounded-lg border border-primary-200 whitespace-nowrap",children:[Q.start_time," - ",Q.end_time]},Q.availability_id))})]})},ht))})():o.jsx("li",{className:"text-sm text-slate-400 italic bg-white p-3.5 sm:p-4 rounded-xl border-2 border-slate-200 text-center",children:"No availability submitted."})})]})]}),o.jsxs("div",{className:"space-y-4 sm:space-y-5",children:[o.jsxs("div",{className:"bg-gradient-to-br from-primary-50 via-primary-100/50 to-primary-50 rounded-xl sm:rounded-2xl p-4 sm:p-5 shadow-xl border-2 border-primary-200/50 hover:shadow-2xl hover:border-primary-300 transition-all duration-300",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl flex-shrink-0 shadow-lg",children:o.jsx(_l,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsx("h4",{className:"text-base sm:text-lg font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"Session Rate"})]}),o.jsxs("div",{className:"bg-white p-3.5 sm:p-4 rounded-xl border-2 border-primary-200/50 shadow-lg",children:[o.jsx("span",{className:"text-xs text-slate-500 font-semibold uppercase tracking-wide block mb-2",children:"Rate per hour"}),o.jsx("p",{className:"text-primary-700 font-bold text-lg sm:text-xl",children:i.session_rate_per_hour?`${Number(i.session_rate_per_hour).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}`:o.jsx("span",{className:"text-slate-400 italic text-sm",children:"Not specified"})})]})]}),o.jsxs("div",{className:"bg-gradient-to-br from-primary-50 via-primary-100/50 to-primary-50 rounded-xl sm:rounded-2xl p-4 sm:p-5 shadow-xl border-2 border-primary-200/50 hover:shadow-2xl hover:border-primary-300 transition-all duration-300",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl flex-shrink-0 shadow-lg",children:o.jsx(_l,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsx("h4",{className:"text-base sm:text-lg font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"GCash Payment"})]}),o.jsxs("div",{className:"space-y-2.5 sm:space-y-3",children:[i.gcash_number&&o.jsxs("div",{className:"bg-white p-3 rounded-xl border-2 border-primary-200/50 shadow-lg",children:[o.jsx("span",{className:"text-xs text-slate-500 font-semibold uppercase tracking-wide block mb-1.5",children:"GCash Number"}),o.jsx("p",{className:"text-primary-700 font-bold text-sm sm:text-base",children:i.gcash_number})]}),i.gcash_qr_url&&o.jsxs("div",{className:"bg-white p-3 rounded-xl border-2 border-primary-200/50 shadow-lg",children:[o.jsx("span",{className:"text-xs text-slate-500 font-semibold uppercase tracking-wide block mb-2",children:"GCash QR Code"}),o.jsx("div",{className:"flex justify-center bg-gradient-to-br from-primary-50 to-primary-100/50 p-2 rounded-xl border border-primary-200/50",children:o.jsx("img",{src:Zt(i.gcash_qr_url),alt:"GCash QR Code",className:"max-w-full h-auto rounded-xl border-2 border-primary-300 shadow-lg hover:shadow-xl hover:scale-105 transition-all duration-300 cursor-pointer",style:{maxHeight:"180px"},onClick:()=>ye(Zt(i.gcash_qr_url),"image/*"),onError:Oe=>{Oe.target.style.display="none";const ht=Oe.target.parentElement;ht&&(ht.innerHTML='<p class="text-xs text-slate-400 italic">QR code image not available</p>')}})})]}),!i.gcash_number&&!i.gcash_qr_url&&o.jsx("div",{className:"bg-white p-3 rounded-xl border-2 border-primary-200/50 shadow-lg",children:o.jsx("p",{className:"text-xs text-slate-400 italic text-center",children:"No GCash information provided."})})]})]}),o.jsxs("div",{className:"bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl p-4 sm:p-5 shadow-xl border border-slate-200/50 hover:shadow-2xl hover:border-primary-300 transition-all duration-300",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3 sm:mb-4",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl flex-shrink-0 shadow-lg",children:o.jsx(bs,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsx("h4",{className:"text-lg sm:text-xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"Submitted Documents"})]}),o.jsx("ul",{className:"space-y-2.5",children:(Ve=i.documents)!=null&&Ve.length?i.documents.map(Oe=>o.jsxs("li",{className:"flex items-center justify-between bg-gradient-to-r from-slate-50 via-primary-50/50 to-slate-50 rounded-xl p-3 border-2 border-slate-200/50 hover:border-primary-300 hover:shadow-lg transition-all duration-200",children:[o.jsxs("div",{className:"flex items-center min-w-0 flex-1",children:[o.jsx("div",{className:"p-1.5 bg-gradient-to-br from-primary-100 to-primary-200 rounded-lg mr-2.5 flex-shrink-0",children:o.jsx(bs,{className:"h-4 w-4 text-primary-600"})}),o.jsx("button",{type:"button",onClick:()=>ye(Zt(Oe.file_url),Oe.file_type),className:"text-primary-700 hover:text-primary-900 hover:underline truncate text-left text-xs sm:text-sm font-semibold",title:"Open file",children:Oe.file_name})]}),o.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink-0 ml-2.5",children:[o.jsx("button",{type:"button",onClick:()=>ye(Zt(Oe.file_url),Oe.file_type),className:"text-xs px-2.5 py-1.5 bg-gradient-to-r from-primary-600 to-primary-700 text-white hover:from-primary-700 hover:to-primary-800 rounded-lg font-semibold shadow-md hover:shadow-lg transition-all duration-200",children:"Open"}),o.jsx("a",{href:Zt(Oe.file_url),download:!0,className:"text-xs px-2.5 py-1.5 bg-gradient-to-r from-primary-600 to-primary-700 text-white hover:from-primary-700 hover:to-primary-800 rounded-lg font-semibold shadow-md hover:shadow-lg transition-all duration-200",children:"Download"})]})]},Oe.document_id)):o.jsx("li",{className:"text-xs sm:text-sm text-slate-400 italic bg-slate-50 p-3 rounded-xl border-2 border-slate-200 text-center",children:"No documents uploaded."})})]})]})]})]})}),D&&o.jsx(On,{isOpen:I,onClose:()=>{P(!1),W("")},title:"Subject Expertise Details",footer:o.jsxs("div",{className:"flex items-center justify-end gap-2",children:[o.jsxs(at,{onClick:()=>fe("rejected"),variant:"danger",disabled:$,className:"flex items-center",children:[o.jsx(Rn,{className:"mr-2 h-4 w-4"}),$?"Rejecting...":"Reject"]}),o.jsxs(at,{onClick:()=>fe("approved"),variant:"primary",disabled:$,className:"flex items-center",children:[o.jsx(aL,{className:"mr-2 h-4 w-4"}),$?"Approving...":"Approve"]})]}),children:o.jsxs("div",{className:"space-y-5 sm:space-y-6",children:[o.jsxs("div",{className:"bg-gradient-to-br from-primary-600 via-primary-700 to-primary-800 p-5 sm:p-6 rounded-2xl text-white relative overflow-hidden shadow-2xl",children:[o.jsxs("div",{className:"absolute inset-0 opacity-20",children:[o.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white rounded-full -mr-16 -mt-16 blur-2xl"}),o.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-white rounded-full -ml-12 -mb-12 blur-xl"})]}),o.jsxs("div",{className:"relative",children:[o.jsx("h3",{className:"text-xl sm:text-2xl font-bold mb-2 drop-shadow-lg",children:(bt=(Ze=D.tutor)==null?void 0:Ze.user)==null?void 0:bt.name}),o.jsxs("div",{className:"flex items-center gap-2 text-white/95",children:[o.jsx(Y3,{className:"h-4 w-4 flex-shrink-0"}),o.jsx("p",{className:"text-sm sm:text-base truncate",children:(St=(tt=D.tutor)==null?void 0:tt.user)==null?void 0:St.email})]})]})]}),o.jsxs("div",{className:"space-y-4 sm:space-y-5",children:[o.jsxs("div",{className:"bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl p-4 sm:p-5 shadow-xl border border-slate-200/50 hover:shadow-2xl hover:border-primary-300 transition-all duration-300",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl flex-shrink-0 shadow-lg",children:o.jsx(rL,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsx("h4",{className:"text-lg sm:text-xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"Subject Expertise"})]}),o.jsx("div",{className:"mt-3",children:o.jsx("span",{className:"inline-flex items-center px-4 py-2 bg-gradient-to-r from-primary-600 to-primary-700 text-white rounded-xl text-sm sm:text-base font-semibold shadow-md border border-primary-400/30",children:(mt=D.subject)==null?void 0:mt.subject_name})})]}),o.jsxs("div",{className:"bg-gradient-to-br from-primary-50 via-primary-100/50 to-primary-50 rounded-xl sm:rounded-2xl p-4 sm:p-5 shadow-xl border-2 border-primary-200/50 hover:shadow-2xl hover:border-primary-300 transition-all duration-300",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl flex-shrink-0 shadow-lg",children:o.jsx(Un,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsx("h4",{className:"text-lg sm:text-xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"Application Date"})]}),o.jsx("div",{className:"bg-white p-3.5 sm:p-4 rounded-xl border-2 border-primary-200/50 shadow-sm",children:o.jsx("p",{className:"text-slate-800 font-semibold text-sm sm:text-base",children:new Date(D.created_at).toLocaleString()})})]}),o.jsxs("div",{className:"bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl p-4 sm:p-5 shadow-xl border border-slate-200/50 hover:shadow-2xl hover:border-primary-300 transition-all duration-300",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl flex-shrink-0 shadow-lg",children:o.jsx(bs,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsx("h4",{className:"text-lg sm:text-xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"Supporting Documents"})]}),o.jsx("ul",{className:"mt-3 space-y-2.5",children:(jt=D.documents)!=null&&jt.length?D.documents.map(Oe=>o.jsxs("li",{className:"flex items-center justify-between bg-gradient-to-r from-slate-50 via-primary-50/50 to-slate-50 rounded-xl p-3 border-2 border-slate-200/50 hover:border-primary-300 hover:shadow-lg transition-all duration-200",children:[o.jsxs("div",{className:"flex items-center min-w-0 flex-1",children:[o.jsx("div",{className:"p-1.5 bg-gradient-to-br from-primary-100 to-primary-200 rounded-lg mr-2.5 flex-shrink-0",children:o.jsx(bs,{className:"h-4 w-4 text-primary-600"})}),o.jsx("button",{type:"button",onClick:()=>ye(Zt(Oe.file_url),Oe.file_type),className:"text-primary-700 hover:text-primary-900 hover:underline truncate text-left text-xs sm:text-sm font-semibold",title:"Open file",children:Oe.file_name})]}),o.jsxs("div",{className:"flex items-center gap-1.5 flex-shrink-0 ml-2.5",children:[o.jsx("button",{type:"button",onClick:()=>ye(Zt(Oe.file_url),Oe.file_type),className:"text-xs px-2.5 py-1.5 bg-gradient-to-r from-primary-600 to-primary-700 text-white hover:from-primary-700 hover:to-primary-800 rounded-lg font-semibold shadow-md hover:shadow-lg transition-all duration-200",children:"Open"}),o.jsx("a",{href:Zt(Oe.file_url),download:!0,className:"text-xs px-2.5 py-1.5 bg-gradient-to-r from-primary-600 to-primary-700 text-white hover:from-primary-700 hover:to-primary-800 rounded-lg font-semibold shadow-md hover:shadow-lg transition-all duration-200",children:"Download"})]})]},Oe.id)):o.jsx("li",{className:"text-xs sm:text-sm text-slate-400 italic bg-slate-50 p-3 rounded-xl border-2 border-slate-200 text-center",children:"No supporting documents uploaded."})})]}),o.jsxs("div",{className:"bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl p-4 sm:p-5 shadow-xl border border-slate-200/50 hover:shadow-2xl hover:border-primary-300 transition-all duration-300",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl flex-shrink-0 shadow-lg",children:o.jsx(bs,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsx("h4",{className:"text-lg sm:text-xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"Admin Notes"})]}),o.jsx("textarea",{value:F,onChange:Oe=>W(Oe.target.value),placeholder:"Add notes for this subject expertise...",className:"w-full p-3.5 border-2 border-slate-200 rounded-xl mt-3 min-h-[100px] resize-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all bg-white text-sm"})]})]})]})}),o.jsx(On,{isOpen:z,onClose:()=>{K(!1),X(""),Y(null)},title:"Rejection Reason",footer:o.jsxs(o.Fragment,{children:[o.jsx(at,{variant:"secondary",onClick:()=>{K(!1),X(""),Y(null)},disabled:h,children:"Cancel"}),o.jsx(at,{variant:"danger",onClick:async()=>{const Oe=q.trim();if(!Oe){alert("Please provide a rejection reason before confirming.");return}console.log(`[Frontend] Modal Confirm clicked - Rejection reason from state: "${Oe}"`),H&&await se("rejected",Oe)},disabled:h||!q.trim(),children:h?"Rejecting...":"Confirm Rejection"})]}),children:o.jsxs("div",{className:"space-y-4",children:[o.jsx("p",{className:"text-sm text-slate-600",children:"Please provide a reason for rejecting this tutor application. This feedback will be shared with the tutor."}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Rejection Reason ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("textarea",{value:q,onChange:Oe=>X(Oe.target.value),placeholder:"Enter the reason for rejection (e.g., incomplete documents, insufficient qualifications, etc.)...",className:"w-full p-3 border border-gray-300 rounded-md mt-1 min-h-[120px] resize-none",required:!0})]})]})}),o.jsx(On,{isOpen:p,onClose:()=>x(!1),title:b.startsWith("image/")?"Image Preview":b==="application/pdf"?"PDF Preview":"File Preview",footer:o.jsx(o.Fragment,{children:o.jsx("a",{href:y,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-primary-600",children:"Open in new tab"})}),children:o.jsx("div",{className:"w-full h-[70vh] bg-gray-100 rounded overflow-hidden flex items-center justify-center",children:b==="application/pdf"?o.jsx("iframe",{title:"PDF",src:y,className:"w-full h-full"}):b.startsWith("image/")||b==="image/*"?o.jsx("img",{src:y,alt:"Preview",className:"max-h-full max-w-full object-contain"}):o.jsx("div",{className:"text-sm text-slate-600 p-4 text-center",children:"Preview not available. You can open the file in a new tab."})})})]})},F1e=()=>{const[t,e]=j.useState([]),[n,s]=j.useState(!0),[r,a]=j.useState(!1),[i,l]=j.useState(!1),[c,u]=j.useState(null),[h,f]=j.useState(""),[p,x]=j.useState("all"),[y,v]=j.useState(null),b=j.useCallback(async()=>{s(!0);try{const A=await we.get("/universities");e(A.data)}finally{s(!1)}},[]);j.useEffect(()=>{b()},[b]);const N=(A=null)=>{u(A?{...A}:{name:"",acronym:"",email_domain:"",status:"active"}),a(!0),v(null)},S=()=>{a(!1),u(null)},k=async()=>{var A;if(!c||!c.name||!c.email_domain){alert("Please fill out all fields.");return}l(!0);try{if(c.university_id){const I=await we.patch(`/universities/${c.university_id}`,c);if(y){const P=new FormData;P.append("file",y);try{await we.post(`/universities/${c.university_id}/logo`,P,{headers:{"Content-Type":"multipart/form-data"}})}catch{await we.post(`/universities/logo/${c.university_id}`,P,{headers:{"Content-Type":"multipart/form-data"}})}}}else{const I=await we.post("/universities",c),P=(A=I==null?void 0:I.data)==null?void 0:A.university_id;if(P&&y){const $=new FormData;$.append("file",y);try{await we.post(`/universities/${P}/logo`,$,{headers:{"Content-Type":"multipart/form-data"}})}catch{await we.post(`/universities/logo/${P}`,$,{headers:{"Content-Type":"multipart/form-data"}})}}}S(),b()}finally{l(!1)}},T=async A=>{var I,P;if(confirm("Are you sure you want to delete this university? This cannot be undone."))try{await we.delete(`/universities/${A}`),b()}catch($){(P=(I=$==null?void 0:$.response)==null?void 0:I.data)==null||P.message}},E=A=>{const{name:I,value:P}=A.target;u($=>$?{...$,[I]:P}:null)},D="mt-1 block w-full px-3 py-2 rounded-md shadow-sm border border-slate-600 bg-slate-700 text-white placeholder-slate-400 focus:outline-none focus:border-primary-600 focus:ring-1 focus:ring-primary-600";return o.jsxs(o.Fragment,{children:[o.jsxs(Lt,{children:[o.jsxs("div",{className:"mb-4",children:[o.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-800",children:"University Management"}),o.jsx("p",{className:"text-sm sm:text-base text-slate-500 mt-1",children:"Manage supported universities/schools used for email domain verification."})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 mb-4",children:[o.jsxs("div",{className:"flex-1 flex flex-col sm:flex-row gap-2",children:[o.jsx("input",{className:"w-full sm:flex-1 border border-slate-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary-600",placeholder:"Search by name, acronym or domain...",value:h,onChange:A=>f(A.target.value)}),o.jsxs("select",{className:"w-full sm:w-auto border border-slate-300 rounded-md px-3 py-2 text-sm focus:outline-none min-w-[120px]",value:p,onChange:A=>x(A.target.value),children:[o.jsx("option",{value:"all",children:"All"}),o.jsx("option",{value:"active",children:"Active"}),o.jsx("option",{value:"inactive",children:"Inactive"})]})]}),o.jsxs(at,{onClick:()=>N(),className:"inline-flex items-center justify-center gap-2 h-10 px-3 sm:px-4 shadow-sm text-sm sm:text-base w-full sm:w-auto",title:"Add a new university",children:[o.jsx(zg,{className:"h-4 w-4"}),o.jsx("span",{children:"Add University"})]})]}),n?o.jsx("p",{className:"text-sm sm:text-base",children:"Loading..."}):o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"hidden md:block overflow-x-auto",children:o.jsxs("table",{className:"min-w-full table-auto bg-white text-sm",children:[o.jsx("thead",{className:"bg-slate-50 text-slate-600",children:o.jsxs("tr",{children:[o.jsx("th",{className:"py-3 px-6 text-left font-semibold tracking-wide",children:"Name"}),o.jsx("th",{className:"py-3 px-6 text-left font-semibold tracking-wide",children:"Acronym"}),o.jsx("th",{className:"py-3 px-6 text-left font-semibold tracking-wide",children:"Email Domain"}),o.jsx("th",{className:"py-3 px-6 text-left font-semibold tracking-wide",children:"Status"}),o.jsx("th",{className:"py-3 px-6 text-center font-semibold tracking-wide w-48",children:"Actions"})]})}),o.jsxs("tbody",{className:"divide-y divide-slate-200",children:[t.filter(A=>{const I=h.toLowerCase();return(p==="all"||A.status===p)&&(A.name.toLowerCase().includes(I)||(A.acronym||"").toLowerCase().includes(I)||(A.email_domain||"").toLowerCase().includes(I))}).map(A=>o.jsxs("tr",{className:"hover:bg-slate-50 transition-colors odd:bg-white even:bg-slate-50/40",children:[o.jsx("td",{className:"py-4 px-6 font-medium text-slate-800",children:o.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[A.logo_url?o.jsx("img",{src:Zt(A.logo_url),alt:A.acronym||A.name,className:"h-8 w-8 rounded-full object-cover bg-slate-100 border border-slate-200 flex-shrink-0"}):o.jsx("div",{className:"h-8 w-8 rounded-full bg-slate-100 border border-slate-200 flex-shrink-0"}),o.jsx("span",{className:"truncate",title:A.name,children:A.name})]})}),o.jsx("td",{className:"py-4 px-6",children:A.acronym||"-"}),o.jsx("td",{className:"py-4 px-6",children:o.jsx("span",{className:"inline-flex items-center gap-2",children:o.jsx("span",{className:"text-slate-700",children:A.email_domain})})}),o.jsx("td",{className:"py-4 px-6",children:o.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${A.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:A.status})}),o.jsx("td",{className:"py-4 px-6 text-center",children:o.jsxs("div",{className:"inline-flex items-center gap-2 justify-center",children:[o.jsxs(at,{variant:"secondary",className:"h-8 px-3 py-0 text-xs font-medium flex items-center justify-center whitespace-nowrap",onClick:()=>N(A),children:[o.jsx(fh,{className:"h-3.5 w-3.5 mr-1.5"})," Edit"]}),o.jsx(at,{variant:"danger",className:"h-8 px-3 py-0 text-xs font-medium flex items-center justify-center",onClick:()=>T(A.university_id),children:"Delete"})]})})]},A.university_id)),t.length===0&&o.jsx("tr",{children:o.jsx("td",{colSpan:5,className:"py-6 text-center text-slate-500",children:"No universities added yet."})})]})]})}),o.jsxs("div",{className:"md:hidden space-y-3",children:[t.filter(A=>{const I=h.toLowerCase();return(p==="all"||A.status===p)&&(A.name.toLowerCase().includes(I)||(A.acronym||"").toLowerCase().includes(I)||(A.email_domain||"").toLowerCase().includes(I))}).map(A=>o.jsx(Lt,{className:"p-4",children:o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[A.logo_url?o.jsx("img",{src:Zt(A.logo_url),alt:A.acronym||A.name,className:"h-12 w-12 rounded-full object-cover bg-slate-100 border border-slate-200 flex-shrink-0"}):o.jsx("div",{className:"h-12 w-12 rounded-full bg-slate-100 border border-slate-200 flex-shrink-0"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h3",{className:"font-semibold text-slate-900 truncate",children:A.name}),A.acronym&&o.jsx("p",{className:"text-sm text-slate-500",children:A.acronym})]})]}),o.jsxs("div",{className:"space-y-2 text-sm",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-slate-500 text-xs mb-1",children:"Email Domain"}),o.jsx("p",{className:"font-medium text-slate-900",children:A.email_domain||"N/A"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-slate-500 text-xs mb-1",children:"Status"}),o.jsx("span",{className:`inline-block px-2 py-1 text-xs font-semibold rounded-full ${A.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:A.status})]})]}),o.jsxs("div",{className:"flex items-center gap-2 pt-2 border-t border-slate-200",children:[o.jsx(at,{variant:"secondary",className:"flex-1 text-sm h-9",onClick:()=>N(A),children:"Edit"}),o.jsx(at,{variant:"danger",className:"flex-1 text-sm h-9",onClick:()=>T(A.university_id),children:"Delete"})]})]})},A.university_id)),t.filter(A=>{const I=h.toLowerCase();return(p==="all"||A.status===p)&&(A.name.toLowerCase().includes(I)||(A.acronym||"").toLowerCase().includes(I)||(A.email_domain||"").toLowerCase().includes(I))}).length===0&&o.jsx("p",{className:"text-center text-slate-500 py-6",children:"No universities found."})]})]})]}),o.jsx(On,{isOpen:r,onClose:S,title:c!=null&&c.university_id?"Edit University":"Add University",footer:o.jsxs(o.Fragment,{children:[o.jsx(at,{variant:"secondary",onClick:S,children:"Cancel"}),o.jsx(at,{onClick:k,disabled:i,children:i?"Saving...":"Save"})]}),children:c&&o.jsx("form",{className:"space-y-6",onSubmit:A=>A.preventDefault(),children:o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6",children:[o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-slate-700",children:"University Name"}),o.jsx("input",{type:"text",name:"name",id:"name",value:c.name||"",onChange:E,className:D,placeholder:"e.g., De La Salle University"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"acronym",className:"block text-sm font-medium text-slate-700",children:"Acronym"}),o.jsx("input",{type:"text",name:"acronym",id:"acronym",value:c.acronym||"",onChange:E,className:D,placeholder:"e.g., DLSU"})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"email_domain",className:"block text-sm font-medium text-slate-700",children:"Email Domain"}),o.jsx("input",{type:"text",name:"email_domain",id:"email_domain",value:c.email_domain||"",onChange:E,className:D,placeholder:"e.g., dlsu.edu.ph"}),o.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"The domain used for student/tutor verification."})]}),o.jsxs("div",{className:"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Logo (optional)"}),o.jsx("input",{type:"file",accept:"image/*",onChange:A=>v(A.target.files&&A.target.files[0]?A.target.files[0]:null),className:"mt-1 block w-full text-sm text-slate-700 file:mr-3 file:py-2 file:px-3 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-slate-200 file:text-slate-800 hover:file:bg-slate-300"}),y&&o.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Selected: ",y.name]})]}),o.jsxs("div",{children:[o.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-slate-700",children:"Status"}),o.jsxs("select",{name:"status",id:"status",value:c.status,onChange:E,className:D,children:[o.jsx("option",{value:"active",children:"Active"}),o.jsx("option",{value:"inactive",children:"Inactive"})]})]})]})})})]})},z1e=()=>{const{notify:t}=Mh(),[e,n]=j.useState([]),[s,r]=j.useState(!0),[a,i]=j.useState(null),[l,c]=j.useState(null),[u,h]=j.useState(!1),[f,p]=j.useState([]),[x,y]=j.useState(null),[v,b]=j.useState(null),[N,S]=j.useState(null);j.useEffect(()=>{const $=async()=>{try{r(!0);const F=await we.get("/courses");n(F.data)}catch(F){i("Failed to fetch courses."),console.error(F)}finally{r(!1)}},R=async()=>{const F=await we.get("/universities");p(F.data)};$(),R()},[]);const k=async $=>{if(l===$){c(null);return}const R=e.find(F=>F.course_id===$);if(R&&!R.subjects)try{const W=(await we.get(`/courses/${$}/subjects`)).data;n(q=>q.map(X=>X.course_id===$?{...X,subjects:W}:X))}catch(F){console.error("Failed to fetch subjects",F)}c($),y(F=>F??{course_name:"",university_id:0,acronym:"",subject_name:""})},T=()=>{var $;y({course_name:"",university_id:(($=f[0])==null?void 0:$.university_id)||0,acronym:""}),h(!0)},E=async()=>{var $,R;if(x)try{v?await we.patch(`/courses/${v.course_id}`,{course_name:x.course_name,university_id:x.university_id,acronym:x.acronym||""}):await we.post("/courses",{course_name:x.course_name,university_id:x.university_id,acronym:x.acronym||""});const F=await we.get("/courses");n(F.data),h(!1),b(null),i(null),t("Course saved successfully!","success")}catch(F){const W=((R=($=F.response)==null?void 0:$.data)==null?void 0:R.message)||F.message||"Failed to save course.";t(W,"error")}},D=async $=>{if(!(x!=null&&x.subject_name))return;await we.post(`/courses/${$}/subjects`,{subject_name:x.subject_name});const R=await we.get(`/courses/${$}/subjects`);n(F=>F.map(W=>W.course_id===$?{...W,subjects:R.data}:W)),y(F=>F&&{...F,subject_name:""})},A=$=>{b($),y({course_name:$.course_name,university_id:$.university.university_id,acronym:$.acronym||""}),h(!0)},I=$=>{S($),y(R=>({course_name:"",university_id:0,acronym:"",subject_name:$.subject_name}))},P=async $=>{if(!N||!x)return;await we.patch(`/courses/${$}/subjects/${N.subject_id}`,{subject_name:x.subject_name});const R=await we.get(`/courses/${$}/subjects`);n(F=>F.map(W=>W.course_id===$?{...W,subjects:R.data}:W)),S(null),y(F=>F&&{...F,subject_name:""})};return s?o.jsx("div",{children:"Loading courses..."}):o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-800 mb-4 sm:mb-6",children:"Course & Subject Management"}),o.jsxs(Lt,{children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3 sm:gap-4 mb-4",children:[o.jsx("h2",{className:"text-lg sm:text-xl font-semibold",children:"Courses"}),o.jsx(at,{onClick:T,className:"w-full sm:w-auto",children:"Add Course"})]}),o.jsx("div",{className:"hidden md:block overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider w-12"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Course Name"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Acronym"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"University"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map($=>{var R;return o.jsxs(tn.Fragment,{children:[o.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>k($.course_id),children:[o.jsx("td",{className:"px-6 py-4",children:o.jsx("button",{className:"text-slate-500 hover:text-slate-800",children:l===$.course_id?o.jsx(iL,{size:20}):o.jsx(oL,{size:20})})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:$.course_name}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:$.acronym||"N/A"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:((R=$.university)==null?void 0:R.name)||"N/A"}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-center text-sm space-x-2",children:[o.jsx(at,{variant:"secondary",onClick:()=>A($),children:"Edit"}),o.jsx(at,{variant:"danger",onClick:async()=>{await we.delete(`/courses/${$.course_id}`);const F=await we.get("/courses");n(F.data)},children:"Delete"})]})]}),l===$.course_id&&o.jsx("tr",{children:o.jsx("td",{colSpan:5,className:"p-0",children:o.jsxs("div",{className:"px-6 py-4 bg-gray-50",children:[o.jsx("h4",{className:"text-sm font-semibold mb-2 ml-12",children:"Subjects:"}),o.jsxs("div",{className:"ml-0 sm:ml-12 mb-3 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-2 items-center",children:[o.jsx("input",{className:"border border-slate-300 rounded px-2 py-1",placeholder:"New subject name",value:(x==null?void 0:x.subject_name)||"",onChange:F=>y(W=>({...W??{course_name:"",university_id:0,acronym:""},subject_name:F.target.value}))}),o.jsx(at,{variant:"secondary",onClick:()=>D($.course_id),children:"Add Subject"})]}),$.subjects&&$.subjects.length>0?o.jsx("ul",{className:"list-disc pl-16 space-y-1",children:[...$.subjects||[]].sort((F,W)=>F.subject_name.localeCompare(W.subject_name)).map(F=>o.jsxs("li",{className:"text-sm text-gray-700 flex items-center justify-between",children:[o.jsx("span",{children:F.subject_name}),o.jsxs("div",{className:"space-x-2",children:[o.jsx(at,{variant:"secondary",onClick:()=>I(F),children:"Edit"}),o.jsx(at,{variant:"danger",onClick:async()=>{await we.delete(`/courses/${$.course_id}/subjects/${F.subject_id}`);const W=await we.get(`/courses/${$.course_id}/subjects`);n(q=>q.map(X=>X.course_id===$.course_id?{...X,subjects:W.data}:X))},children:"Delete"})]})]},F.subject_id))}):o.jsx("p",{className:"text-sm text-gray-500 ml-12",children:"No subjects found for this course."})]})})})]},$.course_id)})})]})}),o.jsx("div",{className:"md:hidden space-y-3",children:e.map($=>{var R;return o.jsx(Lt,{className:"p-4",children:o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h3",{className:"font-semibold text-slate-900 truncate",children:$.course_name}),o.jsxs("p",{className:"text-sm text-slate-500 truncate",children:[$.acronym?`(${$.acronym})`:""," ",((R=$.university)==null?void 0:R.name)||"N/A"]})]}),o.jsx("button",{onClick:()=>k($.course_id),className:"p-2 text-slate-500 hover:text-slate-800 flex-shrink-0",children:l===$.course_id?o.jsx(iL,{size:20}):o.jsx(oL,{size:20})})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(at,{variant:"secondary",onClick:()=>A($),className:"flex-1 text-sm",children:"Edit"}),o.jsx(at,{variant:"danger",onClick:async()=>{await we.delete(`/courses/${$.course_id}`);const F=await we.get("/courses");n(F.data)},className:"flex-1 text-sm",children:"Delete"})]}),l===$.course_id&&o.jsxs("div",{className:"pt-3 border-t border-slate-200 space-y-3",children:[o.jsx("h4",{className:"text-sm font-semibold",children:"Subjects:"}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[o.jsx("input",{className:"border border-slate-300 rounded px-2 py-1 text-sm flex-1",placeholder:"New subject name",value:(x==null?void 0:x.subject_name)||"",onChange:F=>y(W=>({...W??{course_name:"",university_id:0,acronym:""},subject_name:F.target.value}))}),o.jsx(at,{variant:"secondary",onClick:()=>D($.course_id),className:"text-sm",children:"Add Subject"})]}),$.subjects&&$.subjects.length>0?o.jsx("ul",{className:"space-y-2",children:[...$.subjects||[]].sort((F,W)=>F.subject_name.localeCompare(W.subject_name)).map(F=>o.jsxs("li",{className:"text-sm text-gray-700 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 p-2 bg-slate-50 rounded",children:[o.jsx("span",{className:"flex-1",children:F.subject_name}),o.jsxs("div",{className:"flex gap-2 w-full sm:w-auto",children:[o.jsx(at,{variant:"secondary",onClick:()=>I(F),className:"flex-1 sm:flex-none text-xs",children:"Edit"}),o.jsx(at,{variant:"danger",onClick:async()=>{await we.delete(`/courses/${$.course_id}/subjects/${F.subject_id}`);const W=await we.get(`/courses/${$.course_id}/subjects`);n(q=>q.map(X=>X.course_id===$.course_id?{...X,subjects:W.data}:X))},className:"flex-1 sm:flex-none text-xs",children:"Delete"})]})]},F.subject_id))}):o.jsx("p",{className:"text-sm text-gray-500",children:"No subjects found for this course."})]})]})},$.course_id)})})]}),o.jsx(On,{isOpen:u,onClose:()=>{h(!1),b(null),i(null)},title:v?"Edit Course":"Add Course",footer:o.jsxs(o.Fragment,{children:[o.jsx(at,{variant:"secondary",onClick:()=>{h(!1),b(null),i(null)},children:"Cancel"}),o.jsx(at,{onClick:E,children:"Save"})]}),children:x&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Course Name"}),o.jsx("input",{className:"mt-1 block w-full border border-slate-300 rounded-md px-3 py-2",value:x.course_name,onChange:$=>y(R=>R&&{...R,course_name:$.target.value})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Acronym"}),o.jsx("input",{className:"mt-1 block w-full border border-slate-300 rounded-md px-3 py-2",value:x.acronym||"",onChange:$=>y(R=>R&&{...R,acronym:$.target.value}),placeholder:"e.g., CS, IT, BS"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"University"}),o.jsx("select",{className:"mt-1 block w-full border border-slate-300 rounded-md px-3 py-2",value:x.university_id,onChange:$=>y(R=>R&&{...R,university_id:Number($.target.value)}),children:f.map($=>o.jsx("option",{value:$.university_id,children:$.name},$.university_id))})]})]})}),N&&o.jsx(On,{isOpen:!0,onClose:()=>S(null),title:"Edit Subject",footer:o.jsxs(o.Fragment,{children:[o.jsx(at,{variant:"secondary",onClick:()=>S(null),children:"Cancel"}),o.jsx(at,{onClick:()=>{var $;return P(l||(($=e.find(R=>{var F;return(F=R.subjects)==null?void 0:F.some(W=>W.subject_id===N.subject_id)}))==null?void 0:$.course_id))},children:"Save"})]}),children:x&&o.jsx("div",{className:"space-y-4",children:o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Subject Name"}),o.jsx("input",{className:"mt-1 block w-full border border-slate-300 rounded-md px-3 py-2",value:x.subject_name||"",onChange:$=>y(R=>R&&{...R,subject_name:$.target.value})})]})})})]})},B1e=()=>{var tt,St,mt,jt,Oe,ht,ut,Q,L,M,ee,ce,Ce,De,xt;const[t,e]=j.useState([]),[n,s]=j.useState([]),[r,a]=j.useState(null),[i,l]=j.useState("none"),[c,u]=j.useState(""),[h,f]=j.useState(!0),[p,x]=j.useState(null),[y,v]=j.useState(null),[b,N]=j.useState(null),[S,k]=j.useState(null),[T,E]=j.useState(!1),[D,A]=j.useState(null),[I,P]=j.useState(null),[$,R]=j.useState(null),[F,W]=j.useState(null),[q,X]=j.useState(null),[z,K]=j.useState(""),[H,Y]=j.useState(null),[B,O]=j.useState(null),[U,J]=j.useState(null),[se,ae]=j.useState(null),[fe,ye]=j.useState(!1),[Te,oe]=j.useState(!1),[Se,ke]=j.useState(null);j.useEffect(()=>{(async()=>{try{f(!0);const[lt,Nt]=await Promise.all([we.get("/payments"),we.get("/payments/waiting-for-payment")]);e(lt.data),s(Nt.data||[])}catch(lt){x("Failed to fetch data."),console.error(lt)}finally{f(!1)}})()},[]);const me=async Ie=>{try{oe(!0),J(Ie);const Nt=(await we.get("/payments")).data.find(kt=>kt.booking_request_id===Ie.booking_id);ae(Nt||null)}catch(lt){console.error("Failed to fetch payment:",lt),gt.error("Failed to load payment information")}finally{oe(!1)}},re=async Ie=>{var lt,Nt;if(!Se){gt.error("Please upload a payment receipt image");return}try{ye(!0);const kt=new FormData;kt.append("receipt",Se),await we.post(`/payments/process-admin-payment/${Ie}`,kt,{headers:{"Content-Type":"multipart/form-data"}}),gt.success("Payment processed successfully and payout created"),J(null),ae(null),ke(null);const[In,vs]=await Promise.all([we.get("/payments"),we.get("/payments/waiting-for-payment")]);e(In.data),s(vs.data||[])}catch(kt){gt.error(((Nt=(lt=kt==null?void 0:kt.response)==null?void 0:lt.data)==null?void 0:Nt.message)||"Failed to process payment"),console.error(kt)}finally{ye(!1)}},je=Ie=>{var Nt;const lt=(Nt=Ie.target.files)==null?void 0:Nt[0];if(lt){if(!lt.type.startsWith("image/")){alert("Please upload an image file");return}if(lt.size>5*1024*1024){alert("File size should be less than 5MB");return}ke(lt)}},ie=async(Ie,lt,Nt,kt)=>{var In,vs;try{v(Ie);const ns=new FormData;ns.append("status",lt);const qn=Nt??(lt==="confirmed"&&(I==null?void 0:I.payment_id)===Ie?$:null);lt==="confirmed"&&qn&&ns.append("adminProof",qn),lt==="rejected"&&kt&&ns.append("rejection_reason",kt),await we.patch(`/payments/${Ie}/verify`,ns),lt==="confirmed"?gt.success("Payment confirmed successfully"):lt==="rejected"&&gt.success("Payment rejected");const Ds=await we.get("/payments");e(Ds.data);try{const Ks=await we.get("/payments/waiting-for-payment");s(Ks.data||[])}catch{}P(null),R(null),X(null),K(""),W(null)}catch(ns){console.error("Failed to verify payment:",ns),gt.error(((vs=(In=ns==null?void 0:ns.response)==null?void 0:In.data)==null?void 0:vs.message)||"Failed to verify payment")}finally{v(null)}},Re=Ie=>{var Nt;const lt=(Nt=Ie.target.files)==null?void 0:Nt[0];if(lt){if(!lt.type.startsWith("image/")){alert("Please upload an image file");return}if(lt.size>5*1024*1024){alert("File size should be less than 5MB");return}R(lt)}};if(h)return o.jsx("div",{children:"Loading payments..."});if(p)return o.jsx("div",{className:"text-red-500",children:p});const Ve={confirmed:"bg-green-100 text-green-800",pending:"bg-yellow-100 text-yellow-800",paid:"bg-blue-100 text-blue-800",rejected:"bg-red-100 text-red-800",refunded:"bg-blue-100 text-blue-800",admin_confirmed:"bg-blue-100 text-blue-800",admin_paid:"bg-emerald-100 text-emerald-800"},Ze=t.filter(Ie=>Ie.status==="pending").length,bt=t.filter(Ie=>Ie.booking_request_id!=null&&(Ie.status==="pending"||Ie.status==="paid"||Ie.status==="confirmed"));return o.jsxs("div",{children:[o.jsx(Kc,{"aria-label":"Notification messages"}),o.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3 sm:gap-4 mb-4 sm:mb-6",children:[o.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-800",children:"Payment Management"}),Ze>0&&o.jsxs("div",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold bg-yellow-100 text-yellow-800",children:[Ze," pending"]}),n.length>0&&o.jsxs("div",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-semibold bg-blue-100 text-blue-800",children:[n.length," waiting for payment"]})]}),n.length>0&&o.jsxs(Lt,{className:"mb-6",children:[o.jsx("h2",{className:"text-xl font-bold text-slate-800 mb-4",children:"Completed Sessions Waiting for Payment"}),o.jsx("div",{className:"hidden md:block overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tutor"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n.map(Ie=>o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:Ie.tutor.name}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:Ie.student.name}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:Ie.payout_status==="released"?o.jsx("span",{className:"px-3 py-1.5 text-xs font-semibold rounded-full bg-emerald-100 text-emerald-800 whitespace-nowrap",children:"Released"}):Ie.payment_status==="paid"?o.jsx("span",{className:"px-3 py-1.5 text-xs font-semibold rounded-full bg-green-100 text-green-800 whitespace-nowrap",children:"Paid"}):o.jsx("span",{className:"px-3 py-1.5 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800 whitespace-nowrap",children:"Pending Payment"})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:o.jsxs("div",{className:"inline-flex items-center justify-center gap-2",children:[o.jsxs(at,{onClick:()=>Y(Ie),variant:"secondary",className:"text-xs whitespace-nowrap",children:[o.jsx(Xo,{className:"h-4 w-4 mr-1 inline"}),"View Proof (",Ie.subject,")"]}),Ie.payout_status==="released"&&Ie.release_proof_url&&o.jsxs(at,{onClick:()=>O(Ie),variant:"secondary",className:"text-xs whitespace-nowrap",children:[o.jsx(Xo,{className:"h-4 w-4 mr-1 inline"}),"View Release Proof"]}),Ie.payout_status!=="released"&&Ie.payment_status!=="paid"&&o.jsxs(at,{onClick:()=>me(Ie),className:"text-xs whitespace-nowrap",disabled:Te,children:[o.jsx(To,{className:"h-4 w-4 mr-1 inline"}),Te?"Loading...":"Pay"]})]})})]},Ie.booking_id))})]})}),o.jsx("div",{className:"md:hidden space-y-3",children:n.map(Ie=>o.jsx(Lt,{className:"p-4",children:o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-slate-500 text-xs mb-1",children:"Tutor"}),o.jsx("p",{className:"font-medium text-slate-900 truncate",children:Ie.tutor.name})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-slate-500 text-xs mb-1",children:"Student"}),o.jsx("p",{className:"font-medium text-slate-900 truncate",children:Ie.student.name})]})]}),o.jsxs("div",{className:"text-sm",children:[o.jsx("p",{className:"text-slate-500 text-xs mb-1",children:"Status"}),o.jsx("div",{className:"flex items-center",children:Ie.payout_status==="released"?o.jsx("span",{className:"px-3 py-1.5 text-xs font-semibold rounded-full bg-emerald-100 text-emerald-800 whitespace-nowrap",children:"Released"}):Ie.payment_status==="paid"?o.jsx("span",{className:"px-3 py-1.5 text-xs font-semibold rounded-full bg-green-100 text-green-800 whitespace-nowrap",children:"Paid"}):o.jsx("span",{className:"px-3 py-1.5 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800 whitespace-nowrap",children:"Pending Payment"})})]}),o.jsxs("div",{className:"flex flex-wrap gap-2 pt-2 border-t border-slate-200",children:[o.jsxs(at,{onClick:()=>Y(Ie),variant:"secondary",className:"text-xs whitespace-nowrap w-full sm:w-auto",children:[o.jsx(Xo,{className:"h-4 w-4 mr-1 inline"}),"View Proof (",Ie.subject,")"]}),Ie.payout_status==="released"&&Ie.release_proof_url&&o.jsxs(at,{onClick:()=>O(Ie),variant:"secondary",className:"text-xs whitespace-nowrap w-full sm:w-auto",children:[o.jsx(Xo,{className:"h-4 w-4 mr-1 inline"}),"View Release Proof"]}),Ie.payout_status!=="released"&&Ie.payment_status!=="paid"&&o.jsxs(at,{onClick:()=>me(Ie),className:"text-xs whitespace-nowrap w-full sm:w-auto",disabled:Te,children:[o.jsx(To,{className:"h-4 w-4 mr-1 inline"}),Te?"Loading...":"Pay"]})]})]})},Ie.booking_id))})]}),o.jsxs(Lt,{className:"mb-6",children:[o.jsx("h2",{className:"text-xl font-bold text-slate-800 mb-4",children:"Tutee Payments (Pending/Paid/Confirmed)"}),o.jsx("div",{className:"hidden md:block overflow-x-auto",children:o.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[o.jsx("thead",{className:"bg-gray-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tutor"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),o.jsx("th",{scope:"col",className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:bt.length===0?o.jsx("tr",{children:o.jsx("td",{colSpan:6,className:"px-6 py-8 text-center text-sm text-slate-500",children:"No tutee payments found"})}):bt.map(Ie=>{var lt,Nt,kt,In;return o.jsxs("tr",{children:[o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:((Nt=(lt=Ie.student)==null?void 0:lt.user)==null?void 0:Nt.name)||"N/A"}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:((In=(kt=Ie.tutor)==null?void 0:kt.user)==null?void 0:In.name)||"N/A"}),o.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["",Number(Ie.amount).toFixed(2)]}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 text-center",children:new Date(Ie.created_at).toLocaleDateString()}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:o.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${Ve[Ie.status]}`,children:Ie.status.charAt(0).toUpperCase()+Ie.status.slice(1)})}),o.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:o.jsxs("div",{className:"inline-flex items-center justify-center gap-2",children:[(Ie.status==="pending"||Ie.status==="paid")&&o.jsxs(at,{onClick:()=>W(Ie),disabled:y===Ie.payment_id,className:"whitespace-nowrap",children:[o.jsx(Xo,{className:"h-4 w-4 mr-1 inline"}),"View Proof"]}),Ie.status==="confirmed"&&o.jsxs(at,{variant:"secondary",onClick:()=>W(Ie),className:"whitespace-nowrap",children:[o.jsx(Xo,{className:"h-4 w-4 mr-1 inline"}),"View Proof"]}),Ie.status==="rejected"&&o.jsxs(at,{variant:"secondary",onClick:()=>{W(Ie)},className:"whitespace-nowrap",children:[o.jsx(Xo,{className:"h-4 w-4 mr-1 inline"}),"View Proof"]})]})})]},Ie.payment_id)})})]})}),o.jsx("div",{className:"md:hidden space-y-3",children:bt.length===0?o.jsx("div",{className:"text-center py-8 text-sm text-slate-500",children:"No tutee payments found"}):bt.map(Ie=>{var lt,Nt,kt,In;return o.jsx(Lt,{className:"p-4",children:o.jsxs("div",{className:"space-y-3",children:[o.jsx("div",{className:"flex items-center justify-between",children:o.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${Ve[Ie.status]}`,children:Ie.status.charAt(0).toUpperCase()+Ie.status.slice(1)})}),o.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-slate-500 text-xs mb-1",children:"Student"}),o.jsx("p",{className:"font-medium text-slate-900 truncate",children:((Nt=(lt=Ie.student)==null?void 0:lt.user)==null?void 0:Nt.name)||"N/A"})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-slate-500 text-xs mb-1",children:"Tutor"}),o.jsx("p",{className:"font-medium text-slate-900 truncate",children:((In=(kt=Ie.tutor)==null?void 0:kt.user)==null?void 0:In.name)||"N/A"})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-slate-500 text-xs mb-1",children:"Amount"}),o.jsxs("p",{className:"font-medium text-slate-900",children:["",Number(Ie.amount).toFixed(2)]})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-slate-500 text-xs mb-1",children:"Date"}),o.jsx("p",{className:"font-medium text-slate-900",children:new Date(Ie.created_at).toLocaleDateString()})]})]}),o.jsxs("div",{className:"flex flex-wrap gap-2 pt-2 border-t border-slate-200",children:[(Ie.status==="pending"||Ie.status==="paid")&&o.jsxs(at,{onClick:()=>W(Ie),disabled:y===Ie.payment_id,className:"text-xs whitespace-nowrap w-full sm:w-auto",children:[o.jsx(Xo,{className:"h-4 w-4 mr-1 inline"}),"View Proof"]}),Ie.status==="confirmed"&&o.jsxs(at,{variant:"secondary",onClick:()=>W(Ie),className:"text-xs whitespace-nowrap w-full sm:w-auto",children:[o.jsx(Xo,{className:"h-4 w-4 mr-1 inline"}),"View Proof"]}),Ie.status==="rejected"&&o.jsxs(at,{variant:"secondary",onClick:()=>{W(Ie)},className:"text-xs whitespace-nowrap w-full sm:w-auto",children:[o.jsx(Xo,{className:"h-4 w-4 mr-1 inline"}),"View Proof"]})]})]})},Ie.payment_id)})})]}),r&&o.jsx(On,{isOpen:!0,onClose:()=>a(null),title:`Payment #${r.payment_id} Dispute`,footer:o.jsxs(o.Fragment,{children:[o.jsx(at,{variant:"secondary",onClick:()=>a(null),children:"Close"}),o.jsx(at,{onClick:async()=>{await we.patch(`/payments/${r.payment_id}/dispute`,{dispute_status:i,admin_note:c}),a(null);const Ie=await we.get("/payments");e(Ie.data)},children:"Save"})]}),children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"text-sm text-slate-700",children:[o.jsxs("p",{children:[o.jsx("strong",{children:"Student:"})," ",((St=(tt=r.student)==null?void 0:tt.user)==null?void 0:St.name)||"N/A"]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Tutor:"})," ",((jt=(mt=r.tutor)==null?void 0:mt.user)==null?void 0:jt.name)||"N/A"]}),r.dispute_proof_url&&o.jsxs("p",{className:"mt-2",children:[o.jsx("strong",{children:"Proof:"})," ",o.jsx("a",{className:"text-primary-600 hover:underline",href:r.dispute_proof_url,target:"_blank",rel:"noreferrer",children:"View attachment"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Dispute Status"}),o.jsxs("select",{className:"mt-1 block w-full border border-slate-300 rounded-md px-3 py-2",value:i,onChange:Ie=>l(Ie.target.value),children:[o.jsx("option",{value:"none",children:"None"}),o.jsx("option",{value:"open",children:"Open"}),o.jsx("option",{value:"under_review",children:"Under Review"}),o.jsx("option",{value:"resolved",children:"Resolved"}),o.jsx("option",{value:"rejected",children:"Rejected"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Admin Note"}),o.jsx("textarea",{className:"mt-1 block w-full border border-slate-300 rounded-md px-3 py-2",rows:4,value:c,onChange:Ie=>u(Ie.target.value)})]})]})}),I&&o.jsx(On,{isOpen:!0,onClose:()=>{P(null),R(null)},title:`Approve Payment #${I.payment_id}`,footer:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(at,{variant:"secondary",onClick:()=>{P(null),R(null)},children:"Cancel"}),o.jsx(at,{onClick:()=>ie(I.payment_id,"confirmed"),disabled:y===I.payment_id||!$,children:"Confirm Approve"})]}),children:o.jsxs("div",{className:"space-y-4",children:[o.jsx("p",{className:"text-sm text-slate-600",children:"Review the tutor's QR, then upload an admin proof screenshot to finalize approval."}),(Oe=I.tutor)!=null&&Oe.gcash_qr_url?o.jsx("div",{className:"flex justify-center",children:o.jsx("img",{src:Zt(I.tutor.gcash_qr_url),alt:"Tutor GCash QR",className:"max-w-full h-auto border border-slate-200 rounded-lg",onError:Ie=>{Ie.target.src="https://via.placeholder.com/300?text=QR+Not+Available"}})}):o.jsx("p",{className:"text-sm text-slate-500 text-center py-4",children:"Tutor has not uploaded a GCash QR code yet."}),((ht=I.tutor)==null?void 0:ht.gcash_number)&&o.jsxs("p",{className:"text-sm text-slate-600 text-center",children:[o.jsx("strong",{children:"GCash Number:"})," ",I.tutor.gcash_number]}),o.jsxs("div",{className:"pt-2",children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Upload Admin Proof"}),o.jsx("input",{type:"file",accept:"image/*",onChange:Re}),$&&o.jsxs("div",{className:"text-xs text-green-700 mt-1",children:["Selected: ",$.name]}),!$&&o.jsx("div",{className:"text-xs text-red-600 mt-1",children:"Proof is required to confirm approval."})]})]})}),q&&o.jsx(On,{isOpen:!0,onClose:()=>{X(null),K("")},title:`Reject Payment #${q.payment_id}`,footer:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(at,{variant:"secondary",onClick:()=>{X(null),K("")},children:"Cancel"}),o.jsx(at,{variant:"danger",onClick:()=>{if(!z.trim()){alert("Please provide a rejection reason");return}ie(q.payment_id,"rejected",null,z.trim())},disabled:y===q.payment_id||!z.trim(),children:"Confirm Reject"})]}),children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"text-sm text-slate-700",children:[o.jsxs("p",{children:[o.jsx("strong",{children:"Student:"})," ",((Q=(ut=q.student)==null?void 0:ut.user)==null?void 0:Q.name)||"N/A"]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Tutor:"})," ",((M=(L=q.tutor)==null?void 0:L.user)==null?void 0:M.name)||"N/A"]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Amount:"})," ",Number(q.amount).toFixed(2)]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Subject:"})," ",(()=>{var lt;const Ie=q.subject;return typeof Ie=="string"?Ie:Ie!=null&&Ie.subject_name?Ie.subject_name:((lt=q.bookingRequest)==null?void 0:lt.subject)||"N/A"})()]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Rejection Reason ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("textarea",{className:"w-full border border-slate-300 rounded-md px-3 py-2 focus:ring-2 focus:ring-red-500 focus:border-red-500",rows:4,value:z,onChange:Ie=>K(Ie.target.value),placeholder:"Please provide a reason for rejecting this payment (e.g., Payment proof is unclear, Amount mismatch, etc.)"}),o.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"This reason will be shown to the student to help them understand why their payment was rejected."})]})]})}),F&&o.jsxs(On,{isOpen:!0,onClose:()=>{W(null)},title:`Payment Proof #${F.payment_id}`,maxWidth:"6xl",footer:F.status==="pending"||F.status==="paid"?o.jsxs("div",{className:"flex items-center justify-end gap-2 w-full",children:[o.jsx(at,{variant:"secondary",onClick:()=>W(null),children:"Cancel"}),o.jsx(at,{onClick:async()=>{await ie(F.payment_id,"confirmed"),W(null)},disabled:y===F.payment_id,children:"Confirm"}),o.jsx(at,{variant:"danger",onClick:()=>{X(F),W(null)},children:"Reject"})]}):o.jsx("div",{className:"flex items-center justify-end gap-2 w-full",children:o.jsx(at,{variant:"secondary",onClick:()=>W(null),children:"Close"})}),children:[o.jsxs("div",{className:"bg-gradient-to-br from-primary-50 via-white to-primary-50/50 rounded-xl border-2 border-primary-200 p-4 sm:p-5 md:p-6 shadow-lg space-y-6",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-4 sm:mb-5",children:[o.jsx("div",{className:"p-2 sm:p-2.5 bg-primary-100 rounded-lg",children:o.jsx("svg",{className:"h-5 w-5 sm:h-6 sm:w-6 text-primary-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),o.jsx("h3",{className:"text-lg sm:text-xl md:text-2xl font-extrabold text-slate-900",children:"Payment Details"})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[o.jsxs("div",{className:"flex items-start gap-3 p-3 bg-white rounded-lg border border-primary-200 shadow-sm",children:[o.jsx("div",{className:"p-1.5 bg-primary-100 rounded-lg flex-shrink-0",children:o.jsx("svg",{className:"h-4 w-4 sm:h-5 sm:w-5 text-primary-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-sm sm:text-base text-slate-500 font-bold mb-1 uppercase tracking-wide",children:"Student"}),o.jsx("p",{className:"text-base sm:text-lg font-extrabold text-slate-900 break-words",children:((ce=(ee=F.student)==null?void 0:ee.user)==null?void 0:ce.name)||"N/A"})]})]}),o.jsxs("div",{className:"flex items-start gap-3 p-3 bg-white rounded-lg border border-primary-200 shadow-sm",children:[o.jsx("div",{className:"p-1.5 bg-primary-100 rounded-lg flex-shrink-0",children:o.jsx("svg",{className:"h-4 w-4 sm:h-5 sm:w-5 text-primary-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-sm sm:text-base text-slate-500 font-bold mb-1 uppercase tracking-wide",children:"Tutor"}),o.jsx("p",{className:"text-base sm:text-lg font-extrabold text-slate-900 break-words",children:((De=(Ce=F.tutor)==null?void 0:Ce.user)==null?void 0:De.name)||"N/A"})]})]}),o.jsxs("div",{className:"flex items-start gap-3 p-3 bg-white rounded-lg border border-primary-200 shadow-sm",children:[o.jsx("div",{className:"p-1.5 bg-indigo-100 rounded-lg flex-shrink-0",children:o.jsx("svg",{className:"h-4 w-4 sm:h-5 sm:w-5 text-indigo-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-sm sm:text-base text-slate-500 font-bold mb-1 uppercase tracking-wide",children:"Subject"}),o.jsx("p",{className:"text-base sm:text-lg font-extrabold text-slate-900 break-words",children:(()=>{var lt;const Ie=F.subject;return typeof Ie=="string"?Ie:Ie!=null&&Ie.subject_name?Ie.subject_name:((lt=F.bookingRequest)==null?void 0:lt.subject)||"N/A"})()})]})]}),o.jsxs("div",{className:"flex items-start gap-3 p-3 bg-white rounded-lg border border-primary-200 shadow-sm",children:[o.jsx("div",{className:"p-1.5 bg-primary-100 rounded-lg flex-shrink-0",children:o.jsx("svg",{className:"h-4 w-4 sm:h-5 sm:w-5 text-primary-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-sm sm:text-base text-slate-500 font-bold mb-1 uppercase tracking-wide",children:"Duration"}),o.jsx("p",{className:"text-base sm:text-lg font-extrabold text-slate-900",children:(xt=F.bookingRequest)!=null&&xt.duration?`${F.bookingRequest.duration} ${F.bookingRequest.duration===1?"hour":"hours"}`:"N/A"})]})]}),o.jsxs("div",{className:"flex items-start gap-3 p-3 bg-gradient-to-br from-primary-100 to-primary-200 rounded-lg border-2 border-primary-300 shadow-md sm:col-span-2",children:[o.jsx("div",{className:"p-1.5 bg-primary-600 rounded-lg flex-shrink-0",children:o.jsx("svg",{className:"h-4 w-4 sm:h-5 sm:w-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-sm sm:text-base text-primary-800 font-bold mb-1 uppercase tracking-wide",children:"Amount"}),o.jsxs("p",{className:"text-xl sm:text-2xl md:text-3xl font-black text-primary-900",children:["",Number(F.amount).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),o.jsxs("div",{className:"flex items-start gap-3 p-3 bg-white rounded-lg border border-primary-200 shadow-sm sm:col-span-2",children:[o.jsx("div",{className:"p-1.5 bg-slate-100 rounded-lg flex-shrink-0",children:o.jsx("svg",{className:"h-4 w-4 sm:h-5 sm:w-5 text-slate-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),o.jsx("div",{className:"min-w-0 flex-1 flex items-center gap-3",children:o.jsxs("div",{children:[o.jsx("p",{className:"text-sm sm:text-base text-slate-500 font-bold mb-1 uppercase tracking-wide",children:"Status"}),o.jsx("span",{className:`inline-flex items-center px-3 sm:px-4 py-1.5 sm:py-2 text-sm sm:text-base font-extrabold rounded-lg border-2 ${Ve[F.status]} ${F.status==="confirmed"?"border-green-400":F.status==="pending"?"border-yellow-400":F.status==="rejected"?"border-red-400":"border-blue-400"}`,children:F.status.charAt(0).toUpperCase()+F.status.slice(1)})]})})]})]})]}),o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-3 sm:mb-4",children:[o.jsx("div",{className:"p-2 sm:p-2.5 bg-primary-100 rounded-lg",children:o.jsx("svg",{className:"h-5 w-5 sm:h-6 sm:w-6 text-primary-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),o.jsx("h3",{className:"text-lg sm:text-xl md:text-2xl font-extrabold text-slate-900",children:F.status==="confirmed"&&F.admin_payment_proof_url?"Admin Payment Proof":"Payment Proof"})]}),o.jsx("div",{className:"flex justify-center bg-white rounded-lg border-2 border-primary-200 p-3 sm:p-4 md:p-5 shadow-inner",children:o.jsx("img",{src:Zt(F.status==="confirmed"&&F.admin_payment_proof_url?F.admin_payment_proof_url:F.dispute_proof_url||F.payment_proof_url),alt:"Payment proof",className:"max-h-[60vh] w-auto object-contain rounded-lg shadow-md",onError:Ie=>{Ie.target.src="https://via.placeholder.com/400?text=No+Image"}})})]})]}),F.status==="rejected"&&F.rejection_reason&&o.jsx("div",{className:"mt-4 sm:mt-5 md:mt-6 bg-gradient-to-br from-red-50 via-rose-50 to-red-50 rounded-xl border-2 border-red-300 p-4 sm:p-5 md:p-6 shadow-lg",children:o.jsxs("div",{className:"flex items-start gap-3 sm:gap-4",children:[o.jsx("div",{className:"p-2 sm:p-2.5 bg-red-100 rounded-lg flex-shrink-0",children:o.jsx("svg",{className:"h-5 w-5 sm:h-6 sm:w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h4",{className:"text-sm sm:text-base md:text-lg font-extrabold text-red-900 mb-2 uppercase tracking-wide",children:"Rejection Reason"}),o.jsx("p",{className:"text-sm sm:text-base text-red-800 leading-relaxed whitespace-pre-wrap break-words font-medium",children:F.rejection_reason})]})]})})]}),B&&o.jsx(On,{isOpen:!0,onClose:()=>O(null),title:`Release Proof - ${B.subject}`,maxWidth:"4xl",footer:o.jsx(at,{variant:"secondary",onClick:()=>O(null),children:"Close"}),children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-slate-500 font-medium mb-1",children:"Tutor"}),o.jsx("p",{className:"font-semibold text-slate-900",children:B.tutor.name})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-slate-500 font-medium mb-1",children:"Student"}),o.jsx("p",{className:"font-semibold text-slate-900",children:B.student.name})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-slate-500 font-medium mb-1",children:"Date"}),o.jsx("p",{className:"font-semibold text-slate-900",children:new Date(B.date).toLocaleDateString()})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-slate-500 font-medium mb-1",children:"Amount Released"}),o.jsxs("p",{className:"font-semibold text-slate-900",children:["",B.calculated_amount.toFixed(2)]})]})]}),B.release_proof_url&&o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-2",children:"Admin Payment Receipt (Release Proof)"}),o.jsx("div",{className:"flex justify-center bg-white rounded-lg border-2 border-slate-200 p-4",children:o.jsx("img",{src:Zt(B.release_proof_url),alt:"Release proof",className:"max-h-[400px] w-auto object-contain rounded-lg shadow-md",onError:Ie=>{Ie.target.src="https://via.placeholder.com/400?text=No+Image"}})})]})]})}),H&&o.jsx(On,{isOpen:!0,onClose:()=>Y(null),title:`Session Proof - ${H.subject}`,maxWidth:"4xl",footer:o.jsx(at,{variant:"secondary",onClick:()=>Y(null),children:"Close"}),children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-slate-500 font-medium mb-1",children:"Tutor"}),o.jsx("p",{className:"font-semibold text-slate-900",children:H.tutor.name})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-slate-500 font-medium mb-1",children:"Student"}),o.jsx("p",{className:"font-semibold text-slate-900",children:H.student.name})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-slate-500 font-medium mb-1",children:"Date"}),o.jsx("p",{className:"font-semibold text-slate-900",children:new Date(H.date).toLocaleDateString()})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-slate-500 font-medium mb-1",children:"Duration"}),o.jsxs("p",{className:"font-semibold text-slate-900",children:[H.duration," ",H.duration===1?"hour":"hours"]})]})]}),H.session_proof_url&&o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-2",children:"Tutor's Session Proof"}),o.jsx("div",{className:"flex justify-center bg-white rounded-lg border-2 border-slate-200 p-4",children:o.jsx("img",{src:Zt(H.session_proof_url),alt:"Session proof",className:"max-h-[400px] w-auto object-contain rounded-lg shadow-md",onError:Ie=>{Ie.target.src="https://via.placeholder.com/400?text=No+Image"}})})]}),(H.tutee_rating||H.tutee_comment)&&o.jsxs("div",{className:"bg-gradient-to-br from-primary-50 to-primary-100 rounded-lg border-2 border-primary-200 p-4",children:[o.jsxs("h3",{className:"text-lg font-semibold text-slate-800 mb-3 flex items-center gap-2",children:[o.jsx(ja,{className:"h-5 w-5 text-yellow-500 fill-current"}),"Student Feedback"]}),H.tutee_rating&&o.jsxs("div",{className:"mb-3",children:[o.jsx("p",{className:"text-slate-600 font-medium mb-1",children:"Rating"}),o.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:5},(Ie,lt)=>o.jsx(ja,{className:`h-5 w-5 ${lt<Math.floor(H.tutee_rating)?"text-yellow-400 fill-current":"text-slate-300"}`},lt))})]}),H.tutee_comment&&o.jsxs("div",{children:[o.jsx("p",{className:"text-slate-600 font-medium mb-1",children:"Comment"}),o.jsx("p",{className:"text-slate-800 bg-white rounded-lg p-3 border border-primary-200",children:H.tutee_comment})]})]})]})}),U&&o.jsx(On,{isOpen:!0,onClose:()=>{J(null),ae(null),ke(null)},title:`Pay Tutor - ${U.subject}`,maxWidth:"2xl",footer:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(at,{variant:"secondary",onClick:()=>{J(null),ae(null),ke(null)},children:"Cancel"}),o.jsx(at,{onClick:()=>re(U.booking_id),disabled:fe||!se||!Se,children:fe?"Processing Payment...":"Pay Tutor"})]}),children:o.jsx("div",{className:"space-y-4",children:Te?o.jsxs("div",{className:"text-center py-8",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4"}),o.jsx("p",{className:"text-slate-600",children:"Loading payment information..."})]}):se?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"bg-blue-50 border-2 border-blue-200 rounded-lg p-4 mb-4",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:"p-2 bg-blue-100 rounded-lg flex-shrink-0",children:o.jsx("svg",{className:"h-5 w-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),o.jsxs("div",{children:[o.jsx("h4",{className:"font-bold text-blue-900 mb-1",children:"Payment Information"}),o.jsx("p",{className:"text-sm text-blue-800",children:"The tutee has already paid the full amount. You need to pay the tutor the net amount (after 13% platform fee deduction)."})]})]})}),o.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-4",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-slate-500 font-medium mb-1",children:"Tutor"}),o.jsx("p",{className:"font-semibold text-slate-900",children:U.tutor.name})]}),o.jsxs("div",{children:[o.jsx("p",{className:"text-slate-500 font-medium mb-1",children:"Student"}),o.jsx("p",{className:"font-semibold text-slate-900",children:U.student.name})]})]}),U.tutor.gcash_qr_url&&o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-2",children:"Tutor's GCash QR Code"}),o.jsx("div",{className:"flex justify-center bg-white rounded-lg border-2 border-slate-200 p-4",children:o.jsx("img",{src:Zt(U.tutor.gcash_qr_url),alt:"GCash QR Code",className:"max-h-[300px] w-auto object-contain rounded-lg shadow-md",onError:Ie=>{Ie.target.src="https://via.placeholder.com/300?text=QR+Not+Available"}})})]}),U.tutor.gcash_number&&o.jsxs("div",{className:"bg-primary-50 rounded-lg border-2 border-primary-200 p-4",children:[o.jsx("p",{className:"text-slate-600 font-medium mb-1",children:"GCash Number"}),o.jsx("p",{className:"text-2xl font-bold text-primary-900",children:U.tutor.gcash_number})]}),o.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg border-2 border-blue-200 p-4 mb-4",children:[o.jsxs("h3",{className:"text-lg font-semibold text-slate-800 mb-3 flex items-center gap-2",children:[o.jsx("svg",{className:"h-5 w-5 text-blue-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"})}),"Payment Flow"]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-blue-200",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"p-1.5 bg-green-100 rounded-lg",children:o.jsx("svg",{className:"h-4 w-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),o.jsx("span",{className:"text-slate-700 font-medium",children:"Tutee Paid to Admin:"})]}),o.jsxs("span",{className:"font-bold text-green-700",children:["",Number(se.amount).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),o.jsx("div",{className:"flex items-center justify-center text-blue-600",children:o.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})}),o.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border border-blue-200",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"p-1.5 bg-red-100 rounded-lg",children:o.jsx("svg",{className:"h-4 w-4 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),o.jsx("span",{className:"text-slate-700 font-medium",children:"Platform Fee (13%):"})]}),o.jsxs("span",{className:"font-bold text-red-600",children:["-",(Number(se.amount)*.13).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),o.jsx("div",{className:"flex items-center justify-center text-blue-600",children:o.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 14l-7 7m0 0l-7-7m7 7V3"})})}),o.jsxs("div",{className:"flex items-center justify-between p-4 bg-gradient-to-r from-green-100 to-emerald-100 rounded-lg border-2 border-green-400",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"p-2 bg-green-600 rounded-lg",children:o.jsx("svg",{className:"h-5 w-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),o.jsx("span",{className:"text-lg font-bold text-slate-900",children:"Admin Pays to Tutor:"})]}),o.jsxs("span",{className:"text-2xl font-black text-green-700",children:["",(Number(se.amount)*.87).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]}),o.jsxs("div",{className:"bg-gradient-to-br from-amber-50 to-orange-50 rounded-lg border-2 border-amber-200 p-4 mb-4",children:[o.jsxs("h3",{className:"text-lg font-semibold text-slate-800 mb-3 flex items-center gap-2",children:[o.jsx(iU,{className:"h-5 w-5 text-amber-600"}),"Upload Payment Receipt"]}),o.jsx("div",{className:"space-y-3",children:o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:["Payment Receipt (Proof of Payment to Tutor) ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"file",accept:"image/*",onChange:je,className:"w-full text-sm file:mr-3 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-sm file:font-semibold file:bg-amber-50 file:text-amber-700 hover:file:bg-amber-100 transition-colors"}),Se&&o.jsxs("div",{className:"mt-2 p-2 bg-green-50 border border-green-200 rounded-lg flex items-center gap-2",children:[o.jsx(jr,{className:"h-4 w-4 text-green-600 flex-shrink-0"}),o.jsx("span",{className:"text-sm text-green-700 truncate flex-1",children:Se.name}),o.jsx("button",{onClick:()=>ke(null),className:"text-red-600 hover:text-red-700 text-sm font-medium flex-shrink-0","aria-label":"Remove file",children:"Remove"})]}),!Se&&o.jsx("p",{className:"text-xs text-amber-600 mt-1",children:"Please upload a screenshot of your payment receipt to the tutor (max 5MB, JPG/PNG)."})]})})]})]}):o.jsxs("div",{className:"text-center py-8",children:[o.jsx("p",{className:"text-red-600 font-semibold mb-2",children:"Payment Not Found"}),o.jsx("p",{className:"text-slate-600 text-sm",children:"No payment found for this booking."})]})})})]})},U1e=()=>{const{user:t}=rr(),[e,n]=j.useState(null),[s,r]=j.useState(!0),[a,i]=j.useState(!1),[l,c]=j.useState(null),[u,h]=j.useState(null),f=async()=>{if(t!=null&&t.user_id){r(!0);try{const y=await we.get(`/users/${t.user_id}/admin-profile`);n(y.data)}finally{r(!1)}}};j.useEffect(()=>{f()},[]);const p=y=>{y&&(c(y),u&&URL.revokeObjectURL(u),h(URL.createObjectURL(y)))},x=async()=>{if(!(t!=null&&t.user_id)||!l)return;const y=new FormData;y.append("file",l);try{i(!0),await we.post(`/users/${t.user_id}/admin-qr`,y,{headers:{"Content-Type":"multipart/form-data"}}),await f(),c(null),u&&(URL.revokeObjectURL(u),h(null))}finally{i(!1)}};return s?o.jsx("div",{className:"p-6",children:"Loading profile"}):e?o.jsxs("div",{className:"p-6 space-y-6",children:[o.jsx("h1",{className:"text-2xl font-bold text-slate-800",children:"Admin Profile"}),o.jsx(Lt,{className:"p-4",children:o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("img",{src:Zt(e.profile_image_url||""),onError:y=>{y.target.src=`https://ui-avatars.com/api/?name=${encodeURIComponent(e.name||"Admin")}&background=random`},alt:e.name,className:"h-16 w-16 rounded-full object-cover border",style:{aspectRatio:"1 / 1"}}),o.jsxs("div",{children:[o.jsx("div",{className:"text-slate-800 font-semibold",children:e.name}),o.jsx("div",{className:"text-slate-600 text-sm",children:e.email})]})]})}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[o.jsxs(Lt,{className:"p-4",children:[o.jsx("div",{className:"text-slate-500 text-sm",children:"University"}),o.jsx("div",{className:"text-slate-800",children:e.university_name||"N/A"})]}),o.jsxs(Lt,{className:"p-4",children:[o.jsx("div",{className:"text-slate-500 text-sm",children:"Joined"}),o.jsx("div",{className:"text-slate-800",children:e.created_at?new Date(e.created_at).toLocaleDateString():"N/A"})]})]}),o.jsxs(Lt,{className:"p-4 space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h2",{className:"text-lg font-semibold text-slate-800",children:"Admin QR Code"}),(e.qr_code_url||u)&&o.jsx("a",{href:Zt(e.qr_code_url||""),target:"_blank",rel:"noreferrer",className:"text-sm text-primary-600 hover:underline",children:"View full"})]}),o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("div",{className:"w-28 h-28 bg-white border rounded flex items-center justify-center overflow-hidden",children:u||e.qr_code_url?o.jsx("img",{src:u||Zt(e.qr_code_url||""),alt:"Admin QR",className:"w-full h-full object-contain"}):o.jsx("span",{className:"text-slate-400 text-sm",children:"No QR uploaded"})}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("input",{type:"file",accept:"image/*",onChange:y=>{var v;return p(((v=y.target.files)==null?void 0:v[0])||void 0)},disabled:a}),l&&o.jsx("div",{children:o.jsx(at,{onClick:x,disabled:a,children:a?"Saving...":"Save"})})]})]})]})]}):o.jsx("div",{className:"p-6",children:"Profile not found."})},LH=t=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),V1e=t=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m.75 12l3 3m0 0l3-3m-3 3v-6m-1.5-9H5.625a1.875 1.875 0 00-1.875 1.875v17.25a1.875 1.875 0 001.875 1.875h12.75a1.875 1.875 0 001.875-1.875V10.5M8.25 9.75h2.25M8.25 12h5.25m-5.25 3h5.25M3.375 5.25c0-1.036.84-1.875 1.875-1.875h.375a1.875 1.875 0 011.875 1.875v.375c0 1.036-.84 1.875-1.875 1.875h-.375A1.875 1.875 0 013.375 5.625v-.375z"})}),W1e="modulepreload",H1e=function(t){return"/"+t},a8={},Xm=function(e,n,s){let r=Promise.resolve();if(n&&n.length>0){let i=function(u){return Promise.all(u.map(h=>Promise.resolve(h).then(f=>({status:"fulfilled",value:f}),f=>({status:"rejected",reason:f}))))};document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));r=i(n.map(u=>{if(u=H1e(u),u in a8)return;a8[u]=!0;const h=u.endsWith(".css"),f=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const p=document.createElement("link");if(p.rel=h?"stylesheet":W1e,h||(p.as="script"),p.crossOrigin="",p.href=u,c&&p.setAttribute("nonce",c),document.head.appendChild(p),h)return new Promise((x,y)=>{p.addEventListener("load",x),p.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return r.then(i=>{for(const l of i||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G1e=1e-7,q1e=1e-4;class UA{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class hN{refCount(e){return ri("refCount")}incRef(e){return ri("incRef")}timerAvailable(){return!0}time(e){return ri("time")}read(e){return ri("read")}readSync(e){return ri("readSync")}readToGPU(e,n){return ri("readToGPU")}numDataIds(){return ri("numDataIds")}disposeData(e,n){return ri("disposeData")}write(e,n,s){return ri("write")}move(e,n,s,r,a){return ri("move")}createTensorFromGPUData(e,n,s){return ri("createTensorFromGPUData")}memory(){return ri("memory")}floatPrecision(){return ri("floatPrecision")}epsilon(){return this.floatPrecision()===32?G1e:q1e}dispose(){return ri("dispose")}}function ri(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VA(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,yc(t,e,n)}function K1e(t,e){if(t.length!==e.length)throw new Error(`Array sizes must match to be shuffled together First array length was ${t.length}Second array length was ${e.length}`);let n=t.length,s=0;for(;n>0;)s=Math.random()*n|0,n--,yc(t,n,s),yc(e,n,s)}function Ku(t,e,n){return Math.max(t,Math.min(e,n))}function mN(t){return t%2===0?t:t+1}function yc(t,e,n){const s=t[e];t[e]=t[n],t[n]=s}function MH(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function X1e(t,e){const n=Math.random();return e*n+(1-n)*t}function Y1e(t,e){let n=0;for(let s=0;s<t.length;s++){const r=Number(t[s])-Number(e[s]);n+=r*r}return n}function Z(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function Qr(t,e,n=""){Z(xn(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function Vh(t){Z(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function ze(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function Q1e(t){return t.length===0}function FH(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==null&&e[n]!==null&&t[n]!==e[n])return!1;return!0}function xn(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function vh(t){return t%1===0}function Z1e(t){if(Math.tanh!=null)return Math.tanh(t);if(t===1/0)return 1;if(t===-1/0)return-1;{const e=Math.exp(2*t);return(e-1)/(e+1)}}function Ww(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function J1e(t){const e=new Uint32Array(t);for(let n=0;n<t;++n)e[n]=n;return VA(e),e}function lh(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function X_(t,e=r=>0,n,s){return new Promise((r,a)=>{let i=0;const l=()=>{if(t()){r();return}i++;const c=e(i);if(n!=null&&i>=n){a();return}s!=null?s(l,c):setTimeout(l,c)};l()})}function WA(t,e){let n=1,s=-1;for(let a=0;a<t.length;++a)if(t[a]>=0)n*=t[a];else if(t[a]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${a}`);s=a}else if(t[a]<0)throw Error(`Shapes can not be < 0. Found ${t[a]} at dim ${a}`);if(s===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const r=t.slice();return r[s]=e/n,r}function fn(t,e){const n=e.length;return t=t==null?e.map((s,r)=>r):[].concat(t),Z(t.every(s=>s>=-n&&s<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),Z(t.every(s=>vh(s)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(s=>s<0?n+s:s)}function Xc(t,e){const n=[],s=[],r=e!=null&&Array.isArray(e)&&e.length===0,a=e==null||r?null:fn(e,t).sort();let i=0;for(let l=0;l<t.length;++l){if(a!=null){if(a[i]===l&&t[l]!==1)throw new Error(`Can't squeeze axis ${l} since its dim '${t[l]}' is not 1`);(a[i]==null||a[i]>l)&&t[l]===1&&(n.push(t[l]),s.push(l)),a[i]<=l&&i++}t[l]!==1&&(n.push(t[l]),s.push(l))}return{newShape:n,keptDims:s}}function Er(t,e){return Ms(t,e)}function Ms(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function zH(t,e){for(let n=0;n<t.length;n++){const s=t[n];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${e} being uploaded contains ${s}.`)}}function BH(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function HA(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function Jg(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function UH(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function Al(t){return typeof t=="string"||t instanceof String}function VH(t){return typeof t=="boolean"}function Hw(t){return typeof t=="number"}function Wh(t){return Array.isArray(t)?Wh(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":Hw(t)?"float32":Al(t)?"string":VH(t)?"bool":"float32"}function Xu(t){return!!(t&&t.constructor&&t.call&&t.apply)}function Gw(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function Ut(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let s=e-3;s>=0;--s)n[s]=n[s+1]*t[s+1];return n}function WH(t,e,n,s=!1){const r=new Array;if(e.length===1){const a=e[0]*(s?2:1);for(let i=0;i<a;i++)r[i]=n[t+i]}else{const a=e[0],i=e.slice(1),l=i.reduce((c,u)=>c*u)*(s?2:1);for(let c=0;c<a;c++)r[c]=WH(t+c*l,i,n,s)}return r}function qi(t,e,n=!1){if(t.length===0)return e[0];const s=t.reduce((r,a)=>r*a)*(n?2:1);if(s===0)return[];if(s!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return WH(0,t,e,n)}function HH(t,e){if(Array.isArray(t))return t;if(e==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(e==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${e}`)}function fN(t,e){const n=Gr(t,e);for(let s=0;s<n.length;s++)n[s]=1;return n}function Gr(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function GA(t,e){const n=t.reduce((s,r)=>s*r,1);if(e==null||e==="float32")return qi(t,new Float32Array(n));if(e==="int32")return qi(t,new Int32Array(n));if(e==="bool")return qi(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function Ni(t){t.forEach(e=>{Z(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function sl(t,e,n){if(e===0)return 0;if(e===1)return t[0];let s=t[t.length-1];for(let r=0;r<t.length-1;++r)s+=n[r]*t[r];return s}function Hh(t,e,n){if(e===0)return[];if(e===1)return[t];const s=new Array(e);for(let r=0;r<s.length-1;++r)s[r]=Math.floor(t/n[r]),t-=s[r]*n[r];return s[s.length-1]=t,s}function Rc(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i8="tfjsflags";class GH{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=ewe,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&($e().getBool("IS_TEST")||$e().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,s){if(this.flagRegistry[e]={evaluationFn:n,setHook:s},this.urlFlags[e]!=null){const r=this.urlFlags[e];$e().getBool("IS_TEST")||$e().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${r}.`),this.set(e,r)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(Rc(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);i8 in e&&e[i8].split(",").forEach(s=>{const[r,a]=s.split(":");this.urlFlags[r]=nwe(r,a)})}}function ewe(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...s)=>(twe(e,s[0],s[1]),s.join("="))),e}function twe(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function nwe(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function $e(){return qA}let qA=null;function swe(t){qA=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let S3;function qH(){if(S3==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");S3=t}return S3}function rwe(){const t=qH();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function KA(t,e){const n=rwe();if(n.has(t))return n.get(t);{const s=e();return n.set(t,s),n.get(t)}}const Wx="Abs",Vf="Acos",Wf="Acosh",Gh="Add",Hx="AddN",pN="All",gN="Any",Gx="ArgMax",qx="ArgMin",Hf="Asin",Gf="Asinh",qf="Atan",Kf="Atanh",Xf="Atan2",Kx="AvgPool",xN="AvgPoolGrad",Xx="AvgPool3D",yN="AvgPool3DGrad",Yx="BatchMatMul",Qx="BatchToSpaceND",bN="Bincount",Zx="BitwiseAnd",KH="BroadcastTo",vN="BroadcastArgs",Yf="Cast",Qf="Ceil",Zf="ClipByValue",wN="Complex",Jx="ComplexAbs",ey="Concat",ty="Conv2D",NN="Conv2DBackpropFilter",ny="Conv2DBackpropInput",sy="Conv3D",SN="Conv3DBackpropFilterV2",jN="Conv3DBackpropInputV2",Jf="Cos",ep="Cosh",kN="Cumprod",ry="Cumsum",CN="CropAndResize",TN="DenseBincount",_N="DepthToSpace",ay="DepthwiseConv2dNative",EN="DepthwiseConv2dNativeBackpropFilter",AN="DepthwiseConv2dNativeBackpropInput",$N="Diag",iy="Dilation2D",qw="Dilation2DBackpropInput",Kw="Dilation2DBackpropFilter",IN="Draw",tp="RealDiv",RN="Einsum",np="Elu",ON="EluGrad",sp="Erf",oy="Equal",rp="Exp",ly="ExpandDims",ap="Expm1",DN="FFT",PN="Fill",LN="FlipLeftRight",ip="Floor",op="FloorDiv",cy="FusedBatchNorm",uy="GatherV2",MN="GatherNd",dy="Greater",lp="GreaterEqual",cp="Identity",FN="IFFT",zN="Imag",up="IsFinite",dp="IsInf",hp="IsNan",hy="LeakyRelu",my="Less",fy="LessEqual",BN="LinSpace",mp="Log",fp="Log1p",py="LogicalAnd",gy="LogicalNot",xy="LogicalOr",awe="LogicalXor",XH="LogSoftmax",iwe="LowerBound",yy="LRN",UN="LRNGrad",owe="MatrixBandPart",by="Max",pp="Maximum",vy="MaxPool",VN="MaxPoolGrad",wy="MaxPool3D",WN="MaxPool3DGrad",HN="MaxPoolWithArgmax",Ny="Mean",Sy="Min",gp="Minimum",jy="MirrorPad",xp="Mod",GN="Multinomial",yp="Multiply",ky="Neg",Cy="NotEqual",qN="NonMaxSuppressionV3",KN="NonMaxSuppressionV4",XN="NonMaxSuppressionV5",Ty="OnesLike",_y="OneHot",Ey="Pack",Ay="PadV2",lwe="Pool",bp="Pow",$y="Prelu",Iy="Prod",YN="RaggedGather",QN="RaggedRange",ZN="RaggedTensorToTensor",JN="Range",eS="Real",vp="Reciprocal",wp="Relu",Ry="Reshape",Oy="ResizeNearestNeighbor",tS="ResizeNearestNeighborGrad",Dy="ResizeBilinear",nS="ResizeBilinearGrad",Np="Relu6",Py="Reverse",Sp="Round",jp="Rsqrt",sS="ScatterNd",rS="TensorScatterUpdate",aS="SearchSorted",Ly="Select",kp="Selu",My="Slice",Cp="Sin",Tp="Sinh",_p="Sign",Ep="Sigmoid",Ap="Softplus",$p="Sqrt",Fy="Sum",zy="SpaceToBatchND",By="SplitV",Uy="Softmax",iS="SparseFillEmptyRows",oS="SparseReshape",lS="SparseSegmentMean",cS="SparseSegmentSum",uS="SparseToDense",Ip="SquaredDifference",dS="Square",Vy="StaticRegexReplace",hS="StridedSlice",mS="StringNGrams",fS="StringSplit",pS="StringToHashBucketFast",Rp="Sub",Op="Tan",Dp="Tanh",Pp="Tile",gS="TopK",xS="Transform",ch="Transpose",yS="Unique",Wy="Unpack",Hy="UnsortedSegmentSum",cwe="UpperBound",Gy="ZerosLike",Lp="Step",Xw="FromPixels",bS="RotateWithOffset",ex="_FusedMatMul",tx="FusedConv2D",nx="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zi(...t){$e().getBool("IS_TEST")||$e().getBool("PROD")||console.warn(...t)}function uwe(...t){$e().getBool("IS_TEST")||$e().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mf=KA("kernelRegistry",()=>new Map),sx=KA("gradRegistry",()=>new Map);function rx(t,e){const n=XA(t,e);return mf.get(n)}function Y_(t){return sx.get(t)}function Yw(t){const e=mf.entries(),n=[];for(;;){const{done:s,value:r}=e.next();if(s)break;const[a,i]=r,[l]=a.split("_");l===t&&n.push(i)}return n}function vS(t){const{kernelName:e,backendName:n}=t,s=XA(e,n);mf.has(s)&&zi(`The kernel '${e}' for backend '${n}' is already registered`),mf.set(s,t)}function YH(t){const{kernelName:e}=t;sx.has(e)&&$e().getBool("DEBUG")&&zi(`Overriding the gradient for '${e}'`),sx.set(e,t)}function dwe(t,e){const n=XA(t,e);if(!mf.has(n))throw new Error(`The kernel '${t}' for backend '${e}' is not registered`);mf.delete(n)}function hwe(t){if(!sx.has(t))throw new Error(`The gradient '${t}' for backend is not registered`);sx.delete(t)}function mwe(t,e){Yw(t).forEach(s=>{const r=Object.assign({},s,{backendName:e});vS(r)})}function XA(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QH(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var j3,o8;function fwe(){if(o8)return j3;o8=1,j3=e;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function e($,R,F){this.low=$|0,this.high=R|0,this.unsigned=!!F}e.prototype.__isLong__,Object.defineProperty(e.prototype,"__isLong__",{value:!0});function n($){return($&&$.__isLong__)===!0}e.isLong=n;var s={},r={};function a($,R){var F,W,q;return R?($>>>=0,(q=0<=$&&$<256)&&(W=r[$],W)?W:(F=l($,($|0)<0?-1:0,!0),q&&(r[$]=F),F)):($|=0,(q=-128<=$&&$<128)&&(W=s[$],W)?W:(F=l($,$<0?-1:0,!1),q&&(s[$]=F),F))}e.fromInt=a;function i($,R){if(isNaN($))return R?S:N;if(R){if($<0)return S;if($>=y)return A}else{if($<=-v)return I;if($+1>=v)return D}return $<0?i(-$,R).neg():l($%x|0,$/x|0,R)}e.fromNumber=i;function l($,R,F){return new e($,R,F)}e.fromBits=l;var c=Math.pow;function u($,R,F){if($.length===0)throw Error("empty string");if($==="NaN"||$==="Infinity"||$==="+Infinity"||$==="-Infinity")return N;if(typeof R=="number"?(F=R,R=!1):R=!!R,F=F||10,F<2||36<F)throw RangeError("radix");var W;if((W=$.indexOf("-"))>0)throw Error("interior hyphen");if(W===0)return u($.substring(1),R,F).neg();for(var q=i(c(F,8)),X=N,z=0;z<$.length;z+=8){var K=Math.min(8,$.length-z),H=parseInt($.substring(z,z+K),F);if(K<8){var Y=i(c(F,K));X=X.mul(Y).add(i(H))}else X=X.mul(q),X=X.add(i(H))}return X.unsigned=R,X}e.fromString=u;function h($,R){return typeof $=="number"?i($,R):typeof $=="string"?u($,R):l($.low,$.high,typeof R=="boolean"?R:$.unsigned)}e.fromValue=h;var f=65536,p=1<<24,x=f*f,y=x*x,v=y/2,b=a(p),N=a(0);e.ZERO=N;var S=a(0,!0);e.UZERO=S;var k=a(1);e.ONE=k;var T=a(1,!0);e.UONE=T;var E=a(-1);e.NEG_ONE=E;var D=l(-1,2147483647,!1);e.MAX_VALUE=D;var A=l(-1,-1,!0);e.MAX_UNSIGNED_VALUE=A;var I=l(0,-2147483648,!1);e.MIN_VALUE=I;var P=e.prototype;return P.toInt=function(){return this.unsigned?this.low>>>0:this.low},P.toNumber=function(){return this.unsigned?(this.high>>>0)*x+(this.low>>>0):this.high*x+(this.low>>>0)},P.toString=function(R){if(R=R||10,R<2||36<R)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(I)){var F=i(R),W=this.div(F),q=W.mul(F).sub(this);return W.toString(R)+q.toInt().toString(R)}else return"-"+this.neg().toString(R);for(var X=i(c(R,6),this.unsigned),z=this,K="";;){var H=z.div(X),Y=z.sub(H.mul(X)).toInt()>>>0,B=Y.toString(R);if(z=H,z.isZero())return B+K;for(;B.length<6;)B="0"+B;K=""+B+K}},P.getHighBits=function(){return this.high},P.getHighBitsUnsigned=function(){return this.high>>>0},P.getLowBits=function(){return this.low},P.getLowBitsUnsigned=function(){return this.low>>>0},P.getNumBitsAbs=function(){if(this.isNegative())return this.eq(I)?64:this.neg().getNumBitsAbs();for(var R=this.high!=0?this.high:this.low,F=31;F>0&&(R&1<<F)==0;F--);return this.high!=0?F+33:F+1},P.isZero=function(){return this.high===0&&this.low===0},P.eqz=P.isZero,P.isNegative=function(){return!this.unsigned&&this.high<0},P.isPositive=function(){return this.unsigned||this.high>=0},P.isOdd=function(){return(this.low&1)===1},P.isEven=function(){return(this.low&1)===0},P.equals=function(R){return n(R)||(R=h(R)),this.unsigned!==R.unsigned&&this.high>>>31===1&&R.high>>>31===1?!1:this.high===R.high&&this.low===R.low},P.eq=P.equals,P.notEquals=function(R){return!this.eq(R)},P.neq=P.notEquals,P.ne=P.notEquals,P.lessThan=function(R){return this.comp(R)<0},P.lt=P.lessThan,P.lessThanOrEqual=function(R){return this.comp(R)<=0},P.lte=P.lessThanOrEqual,P.le=P.lessThanOrEqual,P.greaterThan=function(R){return this.comp(R)>0},P.gt=P.greaterThan,P.greaterThanOrEqual=function(R){return this.comp(R)>=0},P.gte=P.greaterThanOrEqual,P.ge=P.greaterThanOrEqual,P.compare=function(R){if(n(R)||(R=h(R)),this.eq(R))return 0;var F=this.isNegative(),W=R.isNegative();return F&&!W?-1:!F&&W?1:this.unsigned?R.high>>>0>this.high>>>0||R.high===this.high&&R.low>>>0>this.low>>>0?-1:1:this.sub(R).isNegative()?-1:1},P.comp=P.compare,P.negate=function(){return!this.unsigned&&this.eq(I)?I:this.not().add(k)},P.neg=P.negate,P.add=function(R){n(R)||(R=h(R));var F=this.high>>>16,W=this.high&65535,q=this.low>>>16,X=this.low&65535,z=R.high>>>16,K=R.high&65535,H=R.low>>>16,Y=R.low&65535,B=0,O=0,U=0,J=0;return J+=X+Y,U+=J>>>16,J&=65535,U+=q+H,O+=U>>>16,U&=65535,O+=W+K,B+=O>>>16,O&=65535,B+=F+z,B&=65535,l(U<<16|J,B<<16|O,this.unsigned)},P.subtract=function(R){return n(R)||(R=h(R)),this.add(R.neg())},P.sub=P.subtract,P.multiply=function(R){if(this.isZero())return N;if(n(R)||(R=h(R)),t){var F=t.mul(this.low,this.high,R.low,R.high);return l(F,t.get_high(),this.unsigned)}if(R.isZero())return N;if(this.eq(I))return R.isOdd()?I:N;if(R.eq(I))return this.isOdd()?I:N;if(this.isNegative())return R.isNegative()?this.neg().mul(R.neg()):this.neg().mul(R).neg();if(R.isNegative())return this.mul(R.neg()).neg();if(this.lt(b)&&R.lt(b))return i(this.toNumber()*R.toNumber(),this.unsigned);var W=this.high>>>16,q=this.high&65535,X=this.low>>>16,z=this.low&65535,K=R.high>>>16,H=R.high&65535,Y=R.low>>>16,B=R.low&65535,O=0,U=0,J=0,se=0;return se+=z*B,J+=se>>>16,se&=65535,J+=X*B,U+=J>>>16,J&=65535,J+=z*Y,U+=J>>>16,J&=65535,U+=q*B,O+=U>>>16,U&=65535,U+=X*Y,O+=U>>>16,U&=65535,U+=z*H,O+=U>>>16,U&=65535,O+=W*B+q*Y+X*H+z*K,O&=65535,l(J<<16|se,O<<16|U,this.unsigned)},P.mul=P.multiply,P.divide=function(R){if(n(R)||(R=h(R)),R.isZero())throw Error("division by zero");if(t){if(!this.unsigned&&this.high===-2147483648&&R.low===-1&&R.high===-1)return this;var F=(this.unsigned?t.div_u:t.div_s)(this.low,this.high,R.low,R.high);return l(F,t.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?S:N;var W,q,X;if(this.unsigned){if(R.unsigned||(R=R.toUnsigned()),R.gt(this))return S;if(R.gt(this.shru(1)))return T;X=S}else{if(this.eq(I)){if(R.eq(k)||R.eq(E))return I;if(R.eq(I))return k;var z=this.shr(1);return W=z.div(R).shl(1),W.eq(N)?R.isNegative()?k:E:(q=this.sub(R.mul(W)),X=W.add(q.div(R)),X)}else if(R.eq(I))return this.unsigned?S:N;if(this.isNegative())return R.isNegative()?this.neg().div(R.neg()):this.neg().div(R).neg();if(R.isNegative())return this.div(R.neg()).neg();X=N}for(q=this;q.gte(R);){W=Math.max(1,Math.floor(q.toNumber()/R.toNumber()));for(var K=Math.ceil(Math.log(W)/Math.LN2),H=K<=48?1:c(2,K-48),Y=i(W),B=Y.mul(R);B.isNegative()||B.gt(q);)W-=H,Y=i(W,this.unsigned),B=Y.mul(R);Y.isZero()&&(Y=k),X=X.add(Y),q=q.sub(B)}return X},P.div=P.divide,P.modulo=function(R){if(n(R)||(R=h(R)),t){var F=(this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,R.low,R.high);return l(F,t.get_high(),this.unsigned)}return this.sub(this.div(R).mul(R))},P.mod=P.modulo,P.rem=P.modulo,P.not=function(){return l(~this.low,~this.high,this.unsigned)},P.and=function(R){return n(R)||(R=h(R)),l(this.low&R.low,this.high&R.high,this.unsigned)},P.or=function(R){return n(R)||(R=h(R)),l(this.low|R.low,this.high|R.high,this.unsigned)},P.xor=function(R){return n(R)||(R=h(R)),l(this.low^R.low,this.high^R.high,this.unsigned)},P.shiftLeft=function(R){return n(R)&&(R=R.toInt()),(R&=63)===0?this:R<32?l(this.low<<R,this.high<<R|this.low>>>32-R,this.unsigned):l(0,this.low<<R-32,this.unsigned)},P.shl=P.shiftLeft,P.shiftRight=function(R){return n(R)&&(R=R.toInt()),(R&=63)===0?this:R<32?l(this.low>>>R|this.high<<32-R,this.high>>R,this.unsigned):l(this.high>>R-32,this.high>=0?0:-1,this.unsigned)},P.shr=P.shiftRight,P.shiftRightUnsigned=function(R){if(n(R)&&(R=R.toInt()),R&=63,R===0)return this;var F=this.high;if(R<32){var W=this.low;return l(W>>>R|F<<32-R,F>>>R,this.unsigned)}else return R===32?l(F,0,this.unsigned):l(F>>>R-32,0,this.unsigned)},P.shru=P.shiftRightUnsigned,P.shr_u=P.shiftRightUnsigned,P.toSigned=function(){return this.unsigned?l(this.low,this.high,!1):this},P.toUnsigned=function(){return this.unsigned?this:l(this.low,this.high,!0)},P.toBytes=function(R){return R?this.toBytesLE():this.toBytesBE()},P.toBytesLE=function(){var R=this.high,F=this.low;return[F&255,F>>>8&255,F>>>16&255,F>>>24,R&255,R>>>8&255,R>>>16&255,R>>>24]},P.toBytesBE=function(){var R=this.high,F=this.low;return[R>>>24,R>>>16&255,R>>>8&255,R&255,F>>>24,F>>>16&255,F>>>8&255,F&255]},e.fromBytes=function(R,F,W){return W?e.fromBytesLE(R,F):e.fromBytesBE(R,F)},e.fromBytesLE=function(R,F){return new e(R[0]|R[1]<<8|R[2]<<16|R[3]<<24,R[4]|R[5]<<8|R[6]<<16|R[7]<<24,F)},e.fromBytesBE=function(R,F){return new e(R[4]<<24|R[5]<<16|R[6]<<8|R[7],R[0]<<24|R[1]<<16|R[2]<<8|R[3],F)},j3}var ZH=fwe();const JH=Hl(ZH),pwe=o7({__proto__:null,default:JH},[ZH]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vd=JH||pwe;function qy(t){return Vd.fromString(t,!0,16)}const eG=qy("c3a5c85c97cb3127"),zd=qy("b492b66fbe98f273"),va=qy("9ae16a3b2f90404f");function Q_(t){return t.xor(t.shru(47))}function tG(t,e,n){const s=t.slice(e,e+n);return Vd.fromBytes(Array.from(s),!0,!0)}function fs(t,e){return tG(t,e,8)}function l8(t,e){return tG(t,e,4)}function Cr(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function Bu(t,e,n=qy("9ddfea08eb382d69")){let s=t.xor(e).mul(n);s=s.xor(s.shru(47));let r=e.xor(s).mul(n);return r=r.xor(r.shru(47)),r=r.mul(n),r}function gwe(t,e,n,s,r,a){r=r.add(t),a=Cr(a.add(r).add(s),21);const i=r;return r=r.add(e),r=r.add(n),a=a.add(Cr(r,44)),[r.add(s),a.add(i)]}function o1(t,e,n,s){return gwe(fs(t,e),fs(t,e+8),fs(t,e+16),fs(t,e+24),n,s)}function xwe(t,e=t.length){if(e>=8){const n=va.add(e*2),s=fs(t,0).add(va),r=fs(t,e-8),a=Cr(r,37).mul(n).add(s),i=Cr(s,25).add(r).mul(n);return Bu(a,i,n)}if(e>=4){const n=va.add(e*2),s=l8(t,0);return Bu(s.shl(3).add(e),l8(t,e-4),n)}if(e>0){const n=t[0],s=t[e>>1],r=t[e-1],a=n+(s<<8),i=e+(r<<2);return Q_(va.mul(a).xor(eG.mul(i))).mul(va)}return va}function ywe(t,e=t.length){const n=va.add(e*2),s=fs(t,0).mul(zd),r=fs(t,8),a=fs(t,e-8).mul(n),i=fs(t,e-16).mul(va);return Bu(Cr(s.add(r),43).add(Cr(a,30)).add(i),s.add(Cr(r.add(va),18)).add(a),n)}function bwe(t,e=t.length){const n=va.add(e*2),s=fs(t,0).mul(va),r=fs(t,8),a=fs(t,e-8).mul(n),i=fs(t,e-16).mul(va),l=Cr(s.add(r),43).add(Cr(a,30)).add(i),c=Bu(l,s.add(Cr(r.add(va),18)).add(a),n),u=fs(t,16).mul(n),h=fs(t,24),f=l.add(fs(t,e-32)).mul(n),p=c.add(fs(t,e-24)).mul(n);return Bu(Cr(u.add(h),43).add(Cr(f,30)).add(p),u.add(Cr(h.add(s),18)).add(f),n)}function nG(t,e=t.length){const n=Vd.fromNumber(81,!0);if(e<=32)return e<=16?xwe(t,e):ywe(t,e);if(e<=64)return bwe(t,e);let s=n,r=n.mul(zd).add(113),a=Q_(r.mul(va).add(113)).mul(va),i=[Vd.UZERO,Vd.UZERO],l=[Vd.UZERO,Vd.UZERO];s=s.mul(va).add(fs(t,0));let c=0;const u=(e-1>>6)*64,h=u+(e-1&63)-63;do s=Cr(s.add(r).add(i[0]).add(fs(t,c+8)),37).mul(zd),r=Cr(r.add(i[1]).add(fs(t,c+48)),42).mul(zd),s=s.xor(l[1]),r=r.add(i[0]).add(fs(t,c+40)),a=Cr(a.add(l[0]),33).mul(zd),i=o1(t,c,i[1].mul(zd),s.add(l[0])),l=o1(t,c+32,a.add(l[1]),r.add(fs(t,c+16))),[a,s]=[s,a],c+=64;while(c!==u);const f=zd.add(a.and(255).shl(1));return c=h,l[0]=l[0].add(e-1&63),i[0]=i[0].add(l[0]),l[0]=l[0].add(i[0]),s=Cr(s.add(r).add(i[0]).add(fs(t,c+8)),37).mul(f),r=Cr(r.add(i[1]).add(fs(t,c+48)),42).mul(f),s=s.xor(l[1].mul(9)),r=r.add(i[0].mul(9).add(fs(t,c+40))),a=Cr(a.add(l[0]),33).mul(f),i=o1(t,c,i[1].mul(f),s.add(l[0])),l=o1(t,c+32,a.add(l[1]),r.add(fs(t,c+16))),[a,s]=[s,a],Bu(Bu(i[0],l[0],f).add(Q_(r).mul(eG)).add(a),Bu(i[1],l[1],f).add(s),f)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yc(t,e){return e==="string"?Rl(t):ld([t],e)}function vwe(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function ld(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=zl(t)),$e().getBool("DEBUG")&&zH(t,e),vwe(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let s=0;s<n.length;++s)Math.round(t[s])!==0&&(n[s]=1);return n}else throw new Error(`Unknown data type ${e}`)}function zr(){return $e().platform.now()}function sG(t,e){return $e().platform.fetch(t,e)}function Rl(t,e="utf-8"){return e=e||"utf-8",$e().platform.encode(t,e)}function Oc(t,e="utf-8"){return e=e||"utf-8",$e().platform.decode(t,e)}function dr(t){return $e().platform.isTypedArray!=null?$e().platform.isTypedArray(t):QH(t)}function zl(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||Rc(t)||t==null||dr(t)&&n)e.push(t);else if(Array.isArray(t)||dr(t))for(let s=0;s<t.length;++s)zl(t[s],e,n);else{let s=-1;for(const r of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(r)&&(s=Math.max(s,Number(r)));for(let r=0;r<=s;r++)zl(t[r],e,n)}return e}const wwe=Object.freeze(Object.defineProperty({__proto__:null,arraysEqual:xn,arraysEqualWithNull:FH,assert:Z,assertNonNegativeIntegerDimensions:Ni,assertNonNull:Vh,assertShapesMatch:Qr,bytesFromStringArray:UH,bytesPerElement:Jg,checkConversionForErrors:zH,clamp:Ku,computeStrides:Ut,convertBackendValuesAndArrayBuffer:HH,createScalarValue:Yc,createShuffledIndices:J1e,decodeString:Oc,distSquared:Y1e,encodeString:Rl,fetch:sG,fingerPrint64:nG,flatten:zl,getArrayFromDType:Ms,getTypedArrayFromDType:Er,hasEncodingLoss:HA,hexToLong:qy,indexToLoc:Hh,inferDtype:Wh,inferFromImplicitShape:WA,isBoolean:VH,isFunction:Xu,isInt:vh,isNumber:Hw,isPromise:Rc,isScalarShape:Q1e,isString:Al,isTypedArray:dr,isValidDtype:BH,locToIndex:sl,makeOnesTypedArray:fN,makeZerosNestedTypedArray:GA,makeZerosTypedArray:Gr,nearestDivisor:Gw,nearestLargerEven:mN,now:zr,parseAxisParam:fn,randUniform:X1e,repeatedTry:X_,rightPad:lh,shuffle:VA,shuffleCombo:K1e,sizeFromShape:ze,sizeToSquarishShape:Ww,squeezeShape:Xc,sum:MH,swap:yc,tanh:Z1e,toNestedArray:qi,toTypedArray:ld},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nwe{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new jwe)}profileKernel(e,n,s){let r;const a=()=>{r=s()};let i;const l=zr();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(a);else{a();for(const u of r)u.dataSync();i=Promise.resolve({kernelMs:zr()-l})}if($e().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let u=0;u<r.length;u++){const h=r[u];h.data().then(f=>{Swe(f,h.dtype,e)})}return{kernelName:e,outputs:r,inputs:n,timeMs:i.then(u=>u.kernelMs),extraInfo:i.then(u=>u.getExtraProfileInfo!=null?u.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:s,timeMs:r,inputs:a,extraInfo:i}=e;s.forEach(l=>{Promise.all([l.data(),r,i]).then(c=>{this.logger.logKernelProfile(n,l,c[0],c[1],a,c[2])})})}}function Swe(t,e,n){if(e!=="float32")return!1;for(let s=0;s<t.length;s++){const r=t[s];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${n}'`),!0}return!1}class jwe{logKernelProfile(e,n,s,r,a,i){const l=typeof r=="number"?lh(`${r}ms`,9):r.error,c=lh(e,25),u=n.rank,h=n.size,f=lh(n.shape.toString(),14);let p="";for(const x in a){const y=a[x];if(y!=null){const v=y.shape||n.shape,b=v.length;p+=`${x}: ${b}D ${b>0?v:""} `}}console.log(`%c${c}	%c${l}	%c${u}D ${f}	%c${h}	%c${p}	%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kwe(t,e,n){const s={},r={};for(let c=0;c<e.length;c++)s[e[c].id]=!0;for(let c=0;c<t.length;c++){const u=t[c],h=u.inputs;for(const f in h){const p=h[f];let x=!1;for(let y=0;y<e.length;y++)if(s[p.id]){u.outputs.forEach(v=>s[v.id]=!0),x=!0,r[u.id]=!0;break}if(x)break}}const a={};a[n.id]=!0;const i={};for(let c=t.length-1;c>=0;c--){const u=t[c],h=u.inputs;for(let f=0;f<u.outputs.length;f++)if(a[u.outputs[f].id]){for(const p in h)a[h[p].id]=!0,i[u.id]=!0;break}}const l=[];for(let c=0;c<t.length;c++){const u=t[c];if(r[u.id]&&i[u.id]){const h={};for(const p in u.inputs){const x=u.inputs[p];s[x.id]&&(h[p]=x)}const f=Object.assign({},u);f.inputs=h,f.outputs=u.outputs,l.push(f)}}return l}function Cwe(t,e,n,s){for(let r=e.length-1;r>=0;r--){const a=e[r],i=[];if(a.outputs.forEach(c=>{const u=t[c.id];u!=null?i.push(u):i.push(null)}),a.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${a.kernelName}.`);const l=a.gradient(i);for(const c in a.inputs){if(!(c in l))throw new Error(`Cannot backprop through input ${c}. Available gradients found: ${Object.keys(l)}.`);const u=n(()=>l[c]());if(u.dtype!=="float32")throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input ${c} must have 'float32' dtype, but has '${u.dtype}'`);const h=a.inputs[c];if(!xn(u.shape,h.shape))throw new Error(`Error in gradient for op ${a.kernelName}. The gradient of input '${c}' has shape '${u.shape}', which does not match the shape of the input '${h.shape}'`);if(t[h.id]==null)t[h.id]=u;else{const f=t[h.id];t[h.id]=s(f,u),f.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c8=20,ug=3,k3=7;function Twe(t,e,n,s){const r=Ut(e),a=_we(t,e,n,r),i=e.length,l=L1(t,e,n,r,a),c=["Tensor"];return s&&(c.push(`  dtype: ${n}`),c.push(`  rank: ${i}`),c.push(`  shape: [${e}]`),c.push("  values:")),c.push(l.map(u=>"    "+u).join(`
`)),c.join(`
`)}function _we(t,e,n,s){const r=ze(e),a=s[s.length-1],i=new Array(a).fill(0),l=e.length,c=n==="complex64"?wg(t):t;if(l>1)for(let u=0;u<r/a;u++){const h=u*a;for(let f=0;f<a;f++)i[f]=Math.max(i[f],vg(c[h+f],0,n).length)}return i}function vg(t,e,n){let s;return Array.isArray(t)?s=`${parseFloat(t[0].toFixed(k3))} + ${parseFloat(t[1].toFixed(k3))}j`:Al(t)?s=`'${t}'`:n==="bool"?s=rG(t):s=parseFloat(t.toFixed(k3)).toString(),lh(s,e)}function rG(t){return t===0?"false":"true"}function L1(t,e,n,s,r,a=!0){const i=n==="complex64"?2:1,l=e[0],c=e.length;if(c===0){if(n==="complex64"){const v=wg(t);return[vg(v[0],0,n)]}return n==="bool"?[rG(t[0])]:[t[0].toString()]}if(c===1){if(l>c8){const b=ug*i;let N=Array.from(t.slice(0,b)),S=Array.from(t.slice((l-ug)*i,l*i));return n==="complex64"&&(N=wg(N),S=wg(S)),["["+N.map((k,T)=>vg(k,r[T],n)).join(", ")+", ..., "+S.map((k,T)=>vg(k,r[l-ug+T],n)).join(", ")+"]"]}return["["+(n==="complex64"?wg(t):Array.from(t)).map((b,N)=>vg(b,r[N],n)).join(", ")+"]"]}const u=e.slice(1),h=s.slice(1),f=s[0]*i,p=[];if(l>c8){for(let v=0;v<ug;v++){const b=v*f,N=b+f;p.push(...L1(t.slice(b,N),u,n,h,r,!1))}p.push("...");for(let v=l-ug;v<l;v++){const b=v*f,N=b+f;p.push(...L1(t.slice(b,N),u,n,h,r,v===l-1))}}else for(let v=0;v<l;v++){const b=v*f,N=b+f;p.push(...L1(t.slice(b,N),u,n,h,r,v===l-1))}const x=c===2?",":"";p[0]="["+(l>0?p[0]+x:"");for(let v=1;v<p.length-1;v++)p[v]=" "+p[v]+x;let y=`,
`;for(let v=2;v<c;v++)y+=`
`;return p[p.length-1]=" "+p[p.length-1]+"]"+(a?"":y),p}function wg(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tr{constructor(e,n,s){if(this.dtype=n,this.shape=e.slice(),this.size=ze(e),s!=null){const r=s.length;Z(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||Ms(n,this.size),this.strides=Ut(e)}set(e,...n){n.length===0&&(n=[0]),Z(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const s=this.locToIndex(n);this.values[s]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const r of e){if(r<0||r>=this.shape[n]){const a=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(a)}n++}let s=e[e.length-1];for(let r=0;r<e.length-1;++r)s+=this.strides[r]*e[r];return this.values[s]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let s=0;s<e.length-1;++s)n+=this.strides[s]*e[s];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let s=0;s<n.length-1;++s)n[s]=Math.floor(e/this.strides[s]),e-=n[s]*this.strides[s];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return Zo().makeTensor(this.values,this.shape,this.dtype)}}let Zo=null,Um=null;function Ewe(t){Zo=t}function Awe(t){Um=t}class Tn{constructor(e,n,s,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=ze(e),this.strides=Ut(e),this.dataId=s,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return Um.buffer(this.shape,this.dtype,e)}bufferSync(){return Um.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return qi(this.shape,e,this.dtype==="complex64")}arraySync(){return qi(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=Zo().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(s=>Oc(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Zo().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Zo().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>Oc(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Zo().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Zo().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return Um.print(this,e)}clone(){return this.throwIfDisposed(),Um.clone(this)}toString(e=!1){const n=this.dataSync();return Twe(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),Um.cast(this,e)}variable(e=!0,n,s){return this.throwIfDisposed(),Zo().makeVariable(this,e,n,s)}}Object.defineProperty(Tn,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function We(){return KA("Tensor",()=>Tn)}We();class ax extends Tn{constructor(e,n,s,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=n,this.name=s}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!xn(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Zo().disposeTensor(this),this.dataId=e.dataId,Zo().incRef(this,null)}dispose(){Zo().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(ax,Symbol.hasInstance,{value:t=>t instanceof Tn&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Z_;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(Z_||(Z_={}));var J_;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(J_||(J_={}));var eE;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(eE||(eE={}));var tE;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(tE||(tE={}));var nE;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(nE||(nE={}));const $we={float32:tE,int32:J_,bool:eE,complex64:nE};function Va(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return $we[t][e]}function wS(t){return Va(t,"int32")}function aG(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function iG(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rs(t,e){if(t.dtype===e.dtype)return[t,e];const n=Va(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function oG(t,e){Z(t.dtype===e.dtype,()=>`The dtypes of the first(${t.dtype}) and second(${e.dtype}) input must match`)}function NS(t,e){return e.some(n=>n.id===t.id)}function Dc(t){const e=[];return lG(t,e,new Set),e}function lG(t,e,n){if(t==null)return;if(t instanceof Tn){e.push(t);return}if(!Iwe(t))return;const s=t;for(const r in s){const a=s[r];n.has(a)||(n.add(a),lG(a,e,n))}}function Iwe(t){return Array.isArray(t)||typeof t=="object"}const Rwe=Object.freeze(Object.defineProperty({__proto__:null,assertTypesMatch:oG,getTensorsInContainer:Dc,isTensorInList:NS,makeTypesMatch:Rs},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C3(t){return t.kernelName!=null}class u8{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class ff{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new u8}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,s=1){return e in this.registryFactory?(zi(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:s},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:s}=this.initializeBackend(e);if(!(s?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new Nwe(this.backendInstance),!0}setupRegisteredKernels(){Yw(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){Yw(e).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const s=n.factory();if(s&&!(s instanceof hN)&&typeof s.then=="function"){const r=++this.pendingBackendInitId,a=s.then(i=>r<this.pendingBackendInitId?!1:(this.registry[e]=i,this.pendingBackendInit=null,!0)).catch(i=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,zi(`Initialization of backend ${e} failed`),zi(i.stack||i.message)),!1));return this.pendingBackendInit=a,{success:a,asyncInit:!0}}else return this.registry[e]=s,{success:!0,asyncInit:!1}}catch(s){return zi(`Initialization of backend ${e} failed`),zi(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n],{success:r,asyncInit:a}=this.initializeBackend(s);if(a||r)return{name:s,asyncInit:a}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const s=this.state.tensorInfo.get(n),r=s.backend,a=this.readSync(n),i=r.refCount(n);r.disposeData(n,!0),s.backend=e,e.move(n,a,s.shape,s.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let s=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}let r;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=n(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(e,n,s){e();try{const r=s();return n(),r}catch(r){throw n(),r}}nextTensorId(){return ff.nextTensorId++}nextVariableId(){return ff.nextVariableId++}clone(e){const n=de.runKernel(cp,{x:e}),s={x:e},r=i=>({x:()=>{const l="float32",c={x:i},u={dtype:l};return de.runKernel(Yf,c,u)}}),a=[];return this.addTapeNode(this.state.activeScope.name,s,[n],r,a,{}),n}runKernel(e,n,s){if(this.backendName==null&&this.backend,!(rx(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,s){const r=this.backend.numDataIds();let a=0;s.forEach(c=>{a+=c.dtype==="complex64"?3:1});const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],l=r-n-a-i;if(l>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${l} data ids) after running '${e}'`)}runKernelFunc(e){let n,s=[];const r=this.isTapeOn(),a=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let l;this.backendName==null&&this.backend;let c;const u=C3(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(C3(e)){const{kernelName:y,inputs:v,attrs:b}=e;this.backendName==null&&this.backend;const N=rx(y,this.backendName);Z(N!=null,()=>`Cannot find registered kernel '${y}' for backend '${this.backendName}'`),l=()=>{const S=this.backend.numDataIds();c=N.kernelFunc({inputs:v,attrs:b,backend:this.backend});const k=Array.isArray(c)?c:[c];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(y,S,k);const T=k.map(E=>E.rank!=null?E:this.makeTensorFromTensorInfo(E));if(r){const E=this.getTensorsForGradient(y,v,T);s=this.saveTensorsForBackwardMode(E)}return T}}else{const{forwardFunc:y}=e,v=b=>{r&&(s=b.map(N=>this.keep(this.clone(N))))};l=()=>{const b=this.backend.numDataIds();c=this.tidy(()=>y(this.backend,v));const N=Array.isArray(c)?c:[c];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(u,b,N),N}}const{inputs:h,attrs:f}=e,p=C3(e)?null:e.backwardsFunc;let x;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=l():(x=this.profiler.profileKernel(u,h,()=>l()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(x),n=x.outputs)}),r&&this.addTapeNode(u,h,n,p,s,f),this.state.profiling&&this.state.activeProfile.kernels.push({name:u,bytesAdded:this.state.numBytes-a,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(h).map(y=>h[y]!=null?h[y].shape:null),outputShapes:n.map(y=>y.shape),kernelTimeMs:x.timeMs,extraInfo:x.extraInfo}),Array.isArray(c)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(e,n,s){const r=Y_(e);if(r!=null){const a=r.inputsToSave||[],i=r.outputsToSave||[];let l;r.saveAllInputs?(Z(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),l=Object.keys(n).map(u=>n[u])):l=a.map(u=>n[u]);const c=s.filter((u,h)=>i[h]);return l.concat(c)}return[]}makeTensor(e,n,s,r){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",r=r||this.backend;let a=e;s==="string"&&Al(e[0])&&(a=e.map(c=>Rl(c)));const i=r.write(a,n,s),l=new Tn(n,s,i,this.nextTensorId());if(this.trackTensor(l,r),s==="string"){const c=this.state.tensorInfo.get(i),u=UH(a);this.state.numBytes+=u-c.bytes,c.bytes=u}return l}makeTensorFromDataId(e,n,s,r){s=s||"float32";const a={dataId:e,shape:n,dtype:s};return this.makeTensorFromTensorInfo(a,r)}makeTensorFromTensorInfo(e,n){const{dataId:s,shape:r,dtype:a}=e,i=new Tn(r,a,s,this.nextTensorId());return this.trackTensor(i,n),i}makeVariable(e,n=!0,s,r){s=s||this.nextVariableId().toString(),r!=null&&r!==e.dtype&&(e=e.cast(r));const a=new ax(e,n,s,this.nextTensorId());if(this.state.registeredVariables[a.name]!=null)throw new Error(`Variable with name ${a.name} was already registered`);return this.state.registeredVariables[a.name]=a,this.incRef(a,this.backend),a}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let s=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(s=e.size*Jg(e.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:s})),e instanceof ax||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const s=e.size*Jg(e.dtype);this.state.numBytes-=s}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,s,r,a,i){const l={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:s,saved:a},c=Y_(e);c!=null&&(r=c.gradFunc),r!=null&&(l.gradient=u=>(u=u.map((h,f)=>{if(h==null){const p=s[f],x=Gr(p.size,p.dtype);return this.makeTensor(x,p.shape,p.dtype)}return h}),r(u.length>1?u:u[0],a,i))),this.state.activeTape.push(l)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=Dc(e),s=new Set(n.map(a=>a.id));for(let a=0;a<this.state.activeScope.track.length;a++){const i=this.state.activeScope.track[a];!i.kept&&!s.has(i.id)&&i.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(a=>{!a.kept&&a.scopeId===r.id&&this.track(a)})}gradients(e,n,s,r=!1){if(Z(n.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const a=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));Z(a instanceof Tn,()=>"The result y returned by f() must be a tensor.");const i=kwe(this.state.activeTape,n,a);if(!r&&i.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const l={};l[a.id]=s??Owe(a.shape),Cwe(l,i,u=>this.tidy(u),Dwe);const c=n.map(u=>l[u.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(u=>{for(const h of u.saved)h.dispose()}),this.state.activeTape=null),{value:a,grads:c}})}customGrad(e){return Z(Xu(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{Z(n.every(l=>l instanceof Tn),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const r={};n.forEach((l,c)=>{r[c]=l});const a=(l,c)=>(s=e(...n,c),Z(s.value instanceof Tn,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),Z(Xu(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),i=(l,c)=>{const u=s.gradFunc(l,c),h=Array.isArray(u)?u:[u];Z(h.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),Z(h.every(p=>p instanceof Tn),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const f={};return h.forEach((p,x)=>{f[x]=()=>p}),f};return this.runKernelFunc({forwardFunc:a,backwardsFunc:i,inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=zr(),s=await this.backend.time(e);return s.wallMs=zr()-n,s}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new u8;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}ff.nextTensorId=0;ff.nextVariableId=0;function Owe(t){const e=fN(ze(t),"float32");return de.makeTensor(e,t,"float32")}function cG(){const t=qH();if(t._tfengine==null){const e=new GH(t);t._tfengine=new ff(e)}return swe(t._tfengine.ENV),Ewe(()=>t._tfengine),t._tfengine}const de=cG();function Dwe(t,e){const n={a:t,b:e};return de.runKernel(Gh,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pwe(){return typeof navigator<"u"&&navigator!=null}let sE;function Lwe(t){sE=t}function YA(t){if(sE!==void 0)return sE;if(t||Pwe()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function QA(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}const Mwe=Object.freeze(Object.defineProperty({__proto__:null,isBrowser:QA,isMobile:YA,mockIsMobile:Lwe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wa=$e();Wa.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Wa.registerFlag("IS_BROWSER",()=>QA());Wa.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Wa.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Wa.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));Wa.registerFlag("PROD",()=>!1);Wa.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Wa.getBool("DEBUG"));Wa.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Wa.registerFlag("IS_TEST",()=>!1);Wa.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>Wa.getBool("DEBUG"));Wa.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Wa.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Wa.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bl(t,e){let n=t;if(dr(t))return e==="string"?[]:[t.length];if(aG(t)){const r=t.channels||"RGBA";return[t.height,t.width*r.length]}else if(iG(t))return[t.buffer.size/(e==null?4:Jg(e))];if(!Array.isArray(t))return[];const s=[];for(;Array.isArray(n)||dr(n)&&e!=="string";)s.push(n.length),n=n[0];return Array.isArray(t)&&$e().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&uG(t,s,[]),s}function uG(t,e,n){if(n=n||[],!Array.isArray(t)&&!dr(t)){Z(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}Z(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),Z(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const s=e.slice(1);for(let r=0;r<t.length;++r)uG(t[r],s,n.concat(r))}function d8(t,e,n,s){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${s}' must be ${t} tensor, but got ${e} tensor`)}}function te(t,e,n,s="numeric"){if(t instanceof We())return d8(s,t.dtype,e,n),t;let r=Wh(t);if(r!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(r=s),d8(s,r,e,n),t==null||!dr(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const c=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${c}'`)}const a=Bl(t,r);!dr(t)&&!Array.isArray(t)&&(t=[t]);const l=r!=="string"?ld(t,r):zl(t,[],!0);return de.makeTensor(l,a,r)}function ix(t,e,n,s="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((a,i)=>te(a,`${e}[${i}]`,n,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZA="__op";function he(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const s=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+ZA;const r=(...a)=>{de.startScope(n);try{const i=s(...a);return Rc(i)&&console.error("Cannot return a Promise inside of tidy."),de.endScope(i),i}catch(i){throw de.endScope(null),i}};return Object.defineProperty(r,"name",{value:n,configurable:!0}),r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fwe(t,e){const n=te(t,"real","complex"),s=te(e,"imag","complex");Qr(n.shape,s.shape,`real and imag shapes, ${n.shape} and ${s.shape}, must match in call to tf.complex().`);const r={real:n,imag:s};return de.runKernel(wN,r)}const Pc=he({complex_:Fwe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cd(t,e,n,s){if(s==null)s=Wh(t);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(iG(t)||aG(t)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return de.backend.createTensorFromGPUData(t,e||n,s)}if(!dr(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){Ni(e);const r=ze(e),a=ze(n);Z(r===a,()=>`Based on the provided shape, [${e}], the tensor should have ${r} values but has ${a}`);for(let i=0;i<n.length;++i){const l=n[i],c=i===n.length-1?l!==ze(e.slice(i)):!0;Z(n[i]===e[i]||!c,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!dr(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=s!=="string"?ld(t,s):zl(t,[],!0),de.makeTensor(t,e,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pi(t,e,n){const s=Bl(t,n);return cd(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wh={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};class pl{static join(e){return new pl(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(s=>dr(s)?s.buffer:s),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let s=0;s<e.length;s++){const r=e[s];s!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const a=n+r.byteLength;this.shards.push({buffer:r,start:n,end:a}),n=a}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const s=this.findShardForByte(e);if(s===-1)throw new Error(`Could not find start shard for byte ${e}`);const r=n-e,a=new ArrayBuffer(r),i=new Uint8Array(a);let l=0;for(let c=s;c<this.shards.length;c++){const u=this.shards[c],f=e+l-u.start,p=l,y=Math.min(n,u.end)-u.start,v=new Uint8Array(u.buffer,f,y-f);if(i.set(v,p),l+=v.length,n<u.end)break}return a}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(r){return e<r.start?-1:e>=r.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=zwe(this.shards,n);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function zwe(t,e){let n=0,s=t.length;for(;n<=s;){const r=Math.floor((s-n)/2)+n,a=e(t[r]);if(a===0)return r;a<0?s=r:n=r+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bwe(){$e().set("PROD",!0)}function Uwe(){$e().set("DEBUG",!0)}function Vwe(){$e().set("DEPRECATION_WARNINGS_ENABLED",!1),console.warn("TensorFlow.js deprecation warnings have been disabled.")}function Wwe(t){$e().getBool("DEPRECATION_WARNINGS_ENABLED")&&console.warn(t+" You can disable deprecation warnings with tf.disableDeprecationWarnings().")}function Hwe(){de.disposeVariables()}function Qo(){return de}function rE(){return de.memory()}function Gwe(t){return de.profile(t)}function Ee(t,e){return de.tidy(t,e)}function Jt(t){Dc(t).forEach(n=>n.dispose())}function hr(t){return de.keep(t)}function qwe(t){return de.time(t)}function Kwe(t){return de.setBackend(t)}function Xwe(){return de.ready()}function dG(){return de.backendName}function Ywe(t){de.removeBackend(t)}function Qwe(t){return de.findBackend(t)}function Zwe(t){return de.findBackendFactory(t)}function JA(t,e,n=1){return de.registerBackend(t,e,n)}function e$(){return de.backend}function Jwe(t,e){$e().setPlatform(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yu=4;async function aE(t,e){const n=[],s=[],r=Array.isArray(t)?t.map(i=>i.name):Object.keys(t);for(let i=0;i<r.length;++i){const l=r[i],c=Array.isArray(t)?t[i].tensor:t[l];if(c.dtype!=="float32"&&c.dtype!=="int32"&&c.dtype!=="bool"&&c.dtype!=="string"&&c.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${l}': ${c.dtype}`);const u={name:l,shape:c.shape,dtype:c.dtype};if(c.dtype==="string"){const h=new Promise(async f=>{const p=await c.bytes(),x=p.reduce((b,N)=>b+N.length,0)+Yu*p.length,y=new Uint8Array(x);let v=0;for(let b=0;b<p.length;b++){const N=p[b],S=new Uint8Array(new Uint32Array([N.length]).buffer);y.set(S,v),v+=Yu,y.set(N,v),v+=N.length}f(y)});s.push(h)}else s.push(c.data());e!=null&&(u.group=e),n.push(u)}const a=await Promise.all(s);return{data:n2e(a),specs:n}}function t$(t,e){const n=new pl(t),s={};let r=0;for(const a of e){const i=e2e(a,(l,c)=>n.slice(r+l,r+c));s[a.name]=hG(a,n.slice(r,r+i)),r+=i}return s}function e2e(t,e){const n=ze(t.shape);let s;if("quantization"in t){const r=t.quantization;s=wh[r.dtype]}else if(t.dtype==="string"){let r=0;for(let a=0;a<n;a++)r+=Yu+new Uint32Array(e(r,r+Yu))[0];return r}else s=wh[t.dtype];return n*s}async function t2e(t,e){const n=ze(t.shape);let s;if("quantization"in t){const r=t.quantization;s=wh[r.dtype]}else if(t.dtype==="string"){let r=0;for(let a=0;a<n;a++)r+=Yu+new Uint32Array(await e(r,r+Yu))[0];return r}else s=wh[t.dtype];return n*s}function hG(t,e){const n=t.name,s=t.dtype,r=t.shape,a=ze(r);let i,l=0;if("quantization"in t){const c=t.quantization;if(c.dtype==="uint8"||c.dtype==="uint16"){if(!("min"in c&&"scale"in c))throw new Error(`Weight ${t.name} with quantization ${c.dtype} doesn't have corresponding metadata min and scale.`)}else if(c.dtype==="float16"){if(s!=="float32")throw new Error(`Weight ${t.name} is quantized with ${c.dtype} which only supports weights of type float32 not ${s}.`)}else throw new Error(`Weight ${t.name} has unknown quantization dtype ${c.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const u=wh[c.dtype],h=c.dtype==="uint8"?new Uint8Array(e):new Uint16Array(e);if(s==="float32")if(c.dtype==="uint8"||c.dtype==="uint16"){i=new Float32Array(h.length);for(let f=0;f<h.length;f++){const p=h[f];i[f]=p*c.scale+c.min}}else if(c.dtype==="float16")i=l2e()(h);else throw new Error(`Unsupported quantization type ${c.dtype} for weight type float32.`);else if(s==="int32"){if(c.dtype!=="uint8"&&c.dtype!=="uint16")throw new Error(`Unsupported quantization type ${c.dtype} for weight type int32.`);i=new Int32Array(h.length);for(let f=0;f<h.length;f++){const p=h[f];i[f]=Math.round(p*c.scale+c.min)}}else throw new Error(`Unsupported dtype in weight '${n}': ${s}`);l+=a*u}else if(s==="string"){const c=ze(t.shape);i=[];for(let u=0;u<c;u++){const h=new Uint32Array(e.slice(l,l+Yu))[0];l+=Yu;const f=new Uint8Array(e.slice(l,l+h));i.push(f),l+=h}}else{const c=wh[s];if(s==="float32")i=new Float32Array(e);else if(s==="int32")i=new Int32Array(e);else if(s==="bool")i=new Uint8Array(e);else if(s==="complex64"){i=new Float32Array(e);const u=new Float32Array(i.length/2),h=new Float32Array(i.length/2);for(let y=0;y<u.length;y++)u[y]=i[y*2],h[y]=i[y*2+1];const f=pi(u,r,"float32"),p=pi(h,r,"float32"),x=Pc(f,p);return f.dispose(),p.dispose(),x}else throw new Error(`Unsupported dtype in weight '${n}': ${s}`);l+=a*c}return pi(i,r,s)}async function h8(t,e,n){let s=new Uint8Array(e);for(;s.byteLength<n;){const{done:r,value:a}=await t.read();if(r&&a==null){const l=n-s.byteLength;throw new Error(`Reader is done but ${l} bytes are still expected`)}const i=new Uint8Array(s.length+a.byteLength);i.set(s,0),i.set(new Uint8Array(a),s.length),s=i}return s.buffer}async function mG(t,e){const n={},s=t.getReader();let r=new ArrayBuffer(0);for(const a of e){const i=await t2e(a,async(u,h)=>(r=await h8(s,r,h),r.slice(u,h)));r=await h8(s,r,i);const l=r.slice(0,i);r=r.slice(i);const c=hG(a,l);if(n[a.name]=c,dG()==="webgpu"){const u=e$();"uploadToGPU"in u&&ze(c.shape)>=$e().get("WEBGPU_CPU_HANDOFF_SIZE_THRESHOLD")&&u.uploadToGPU(c.dataId)}}return n}function n2e(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(a=>{if(e+=a.byteLength,n.push(a.byteLength===a.buffer.byteLength?a:new a.constructor(a)),!(a instanceof Float32Array||a instanceof Int32Array||a instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${a.constructor.name}`)});const s=new Uint8Array(e);let r=0;return n.forEach(a=>{s.set(new Uint8Array(a.buffer),r),r+=a.byteLength}),s.buffer}const n$=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function m8(t){return n$?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function s2e(t){if(n$)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let s=0,r=e.length;s<r;s++)n+=String.fromCharCode(e[s]);return btoa(n)}function r2e(t){if(n$){const s=Buffer.from(t,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let s=0;s<e.length;++s)n.set([e.charCodeAt(s)],s);return n.buffer}function fG(t){return pl.join(t)}function f8(t){for(t=t.trim();t.endsWith("/");)t=t.slice(0,t.length-1);const n=t.split("/");return n[n.length-1]}function pG(t,e){const n={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy,weightsManifest:e};return t.signature!=null&&(n.signature=t.signature),t.userDefinedMetadata!=null&&(n.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(n.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(n.initializerSignature=t.initializerSignature),t.trainingConfig!=null&&(n.trainingConfig=t.trainingConfig),n}function s$(t,e,n){const s={modelTopology:t.modelTopology,format:t.format,generatedBy:t.generatedBy,convertedBy:t.convertedBy};if(t.trainingConfig!=null&&(s.trainingConfig=t.trainingConfig),t.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!n)throw new Error("modelJSON has weightsManifest but weightData is null");s.weightSpecs=e,s.weightData=n}return t.signature!=null&&(s.signature=t.signature),t.userDefinedMetadata!=null&&(s.userDefinedMetadata=t.userDefinedMetadata),t.modelInitializer!=null&&(s.modelInitializer=t.modelInitializer),t.initializerSignature!=null&&(s.initializerSignature=t.initializerSignature),s}async function r$(t,e){let n,s;return t.weightsManifest!=null&&([n,s]=await e(t.weightsManifest)),s$(t,n,s)}function Ky(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:m8(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:m8(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new pl(t.weightData).byteLength}}function Qw(t){const e=[];for(const n of t)e.push(...n.weights);return e}function a2e(){const t=n=>{let s=n<<13,r=0;for(;(s&8388608)===0;)r-=8388608,s<<=1;return s&=-8388609,r+=947912704,s|r},e=new Uint32Array(2048);e[0]=0;for(let n=1;n<1024;n++)e[n]=t(n);for(let n=1024;n<2048;n++)e[n]=939524096+(n-1024<<13);return e}function i2e(){const t=new Uint32Array(64);t[0]=0,t[31]=1199570944,t[32]=2147483648,t[63]=3347054592;for(let e=1;e<31;e++)t[e]=e<<23;for(let e=33;e<63;e++)t[e]=2147483648+(e-32<<23);return t}function o2e(){const t=new Uint32Array(64);for(let e=0;e<64;e++)t[e]=1024;return t[0]=t[32]=0,t}function l2e(){const t=a2e(),e=i2e(),n=o2e();return s=>{const r=new ArrayBuffer(4*s.length),a=new Uint32Array(r);for(let i=0;i<s.length;i++){const l=s[i],c=t[n[l>>10]+(l&1023)]+e[l>>10];a[i]=c}return new Float32Array(r)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _s{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return _s.instance==null&&(_s.instance=new _s),_s.instance}static registerSaveRouter(e){_s.getInstance().saveRouters.push(e)}static registerLoadRouter(e){_s.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return _s.getHandlers(e,"save")}static getLoadHandlers(e,n){return _s.getHandlers(e,"load",n)}static getHandlers(e,n,s){const r=[];return(n==="load"?_s.getInstance().loadRouters:_s.getInstance().saveRouters).forEach(i=>{const l=i(e,s);l!==null&&r.push(l)}),r}}const c2e=t=>_s.registerSaveRouter(t),u2e=t=>_s.registerLoadRouter(t),gG=t=>_s.getSaveHandlers(t),xG=(t,e)=>_s.getLoadHandlers(t,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iE="tensorflowjs",oE=1,eh="models_store",Pu="model_info_store";function yG(){if(!$e().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function lE(t){const e=t.result;e.createObjectStore(eh,{keyPath:"modelPath"}),e.createObjectStore(Pu,{keyPath:"modelPath"})}class Nh{constructor(e){if(this.indexedDB=yG(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((s,r)=>{const a=this.indexedDB.open(iE,oE);a.onupgradeneeded=()=>lE(a),a.onsuccess=()=>{const i=a.result;if(n==null){const l=i.transaction(eh,"readonly"),u=l.objectStore(eh).get(this.modelPath);u.onsuccess=()=>{if(u.result==null)return i.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(u.result.modelArtifacts)},u.onerror=h=>(i.close(),r(u.error)),l.oncomplete=()=>i.close()}else{n.weightData=pl.join(n.weightData);const l=Ky(n),c=i.transaction(Pu,"readwrite");let u=c.objectStore(Pu),h;try{h=u.put({modelPath:this.modelPath,modelArtifactsInfo:l})}catch(p){return r(p)}let f;h.onsuccess=()=>{f=i.transaction(eh,"readwrite");const p=f.objectStore(eh);let x;try{x=p.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:l})}catch(y){return r(y)}x.onsuccess=()=>s({modelArtifactsInfo:l}),x.onerror=y=>{u=c.objectStore(Pu);const v=u.delete(this.modelPath);v.onsuccess=()=>(i.close(),r(x.error)),v.onerror=b=>(i.close(),r(x.error))}},h.onerror=p=>(i.close(),r(h.error)),c.oncomplete=()=>{f==null?i.close():f.oncomplete=()=>i.close()}}},a.onerror=i=>r(a.error)})}}Nh.URL_SCHEME="indexeddb://";const bG=t=>$e().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Nh.URL_SCHEME)?d2e(t.slice(Nh.URL_SCHEME.length)):null;_s.registerSaveRouter(bG);_s.registerLoadRouter(bG);function d2e(t){return new Nh(t)}function h2e(t){return t.startsWith(Nh.URL_SCHEME)?t.slice(Nh.URL_SCHEME.length):t}class m2e{constructor(){this.indexedDB=yG()}async listModels(){return new Promise((e,n)=>{const s=this.indexedDB.open(iE,oE);s.onupgradeneeded=()=>lE(s),s.onsuccess=()=>{const r=s.result,a=r.transaction(Pu,"readonly"),l=a.objectStore(Pu).getAll();l.onsuccess=()=>{const c={};for(const u of l.result)c[u.modelPath]=u.modelArtifactsInfo;e(c)},l.onerror=c=>(r.close(),n(l.error)),a.oncomplete=()=>r.close()},s.onerror=r=>n(s.error)})}async removeModel(e){return e=h2e(e),new Promise((n,s)=>{const r=this.indexedDB.open(iE,oE);r.onupgradeneeded=()=>lE(r),r.onsuccess=()=>{const a=r.result,i=a.transaction(Pu,"readwrite"),l=i.objectStore(Pu),c=l.get(e);let u;c.onsuccess=()=>{if(c.result==null)return a.close(),s(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const h=l.delete(e),f=()=>{u=a.transaction(eh,"readwrite");const x=u.objectStore(eh).delete(e);x.onsuccess=()=>n(c.result.modelArtifactsInfo),x.onerror=y=>s(c.error)};h.onsuccess=f,h.onerror=p=>(f(),a.close(),s(c.error))}},c.onerror=h=>(a.close(),s(c.error)),i.oncomplete=()=>{u==null?a.close():u.oncomplete=()=>a.close()}},r.onerror=a=>s(r.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bc="/",Vm="tensorflowjs_models",vG="info",f2e="model_topology",p2e="weight_specs",g2e="weight_data",x2e="model_metadata";function wG(t){return{info:[Vm,t,vG].join(bc),topology:[Vm,t,f2e].join(bc),weightSpecs:[Vm,t,p2e].join(bc),weightData:[Vm,t,g2e].join(bc),modelMetadata:[Vm,t,x2e].join(bc)}}function NG(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function y2e(t){const e=t.split(bc);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(bc)}function b2e(t){return t.startsWith(Sh.URL_SCHEME)?t.slice(Sh.URL_SCHEME.length):t}class Sh{constructor(e){if(!$e().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=wG(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),r=Ky(e),a=pl.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,s2e(a));const i={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:r}}catch{throw NG(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=s;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=r;const a=this.LS.getItem(this.keys.modelMetadata);if(a!=null){const l=JSON.parse(a);n.format=l.format,n.generatedBy=l.generatedBy,n.convertedBy=l.convertedBy,l.signature!=null&&(n.signature=l.signature),l.userDefinedMetadata!=null&&(n.userDefinedMetadata=l.userDefinedMetadata),l.modelInitializer!=null&&(n.modelInitializer=l.modelInitializer),l.initializerSignature!=null&&(n.initializerSignature=l.initializerSignature),l.trainingConfig!=null&&(n.trainingConfig=l.trainingConfig)}const i=this.LS.getItem(this.keys.weightData);if(i==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=r2e(i),n}}Sh.URL_SCHEME="localstorage://";const SG=t=>$e().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Sh.URL_SCHEME)?v2e(t.slice(Sh.URL_SCHEME.length)):null;_s.registerSaveRouter(SG);_s.registerLoadRouter(SG);function v2e(t){return new Sh(t)}class w2e{constructor(){Z($e().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),Z(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=Vm+bc,s=bc+vG;for(let r=0;r<this.LS.length;++r){const a=this.LS.key(r);if(a.startsWith(n)&&a.endsWith(s)){const i=y2e(a);e[i]=JSON.parse(this.LS.getItem(a))}}return e}async removeModel(e){e=b2e(e);const n=wG(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const s=JSON.parse(this.LS.getItem(n.info));return NG(n),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ym="://";class ya{constructor(){this.managers={}}static getInstance(){return ya.instance==null&&(ya.instance=new ya),ya.instance}static registerManager(e,n){Z(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(Ym)&&(e=e.slice(0,e.indexOf(Ym))),Z(e.length>0,()=>"scheme must not be an empty string.");const s=ya.getInstance();Z(s.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),s.managers[e]=n}static getManager(e){const n=ya.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(ya.getInstance().managers)}}function M1(t){if(t.indexOf(Ym)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${ya.getSchemes().join(",")}`);return{scheme:t.split(Ym)[0],path:t.split(Ym)[1]}}async function jG(t,e,n=!1){Z(t!==e,()=>`Old path and new path are the same: '${t}'`);const s=_s.getLoadHandlers(t);Z(s.length>0,()=>`Copying failed because no load handler is found for source URL ${t}.`),Z(s.length<2,()=>`Copying failed because more than one (${s.length}) load handlers for source URL ${t}.`);const r=s[0],a=_s.getSaveHandlers(e);Z(a.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),Z(a.length<2,()=>`Copying failed because more than one (${s.length}) save handlers for destination URL ${e}.`);const i=a[0],l=M1(t).scheme,c=M1(t).path,u=l===M1(t).scheme,h=await r.load();n&&u&&await ya.getManager(l).removeModel(c);const f=await i.save(h);return n&&!u&&await ya.getManager(l).removeModel(c),f.modelArtifactsInfo}async function N2e(){const t=ya.getSchemes(),e={};for(const n of t){const s=await ya.getManager(n).listModels();for(const r in s){const a=n+Ym+r;e[a]=s[r]}}return e}async function S2e(t){const e=M1(t);return ya.getManager(e.scheme).removeModel(e.path)}async function j2e(t,e){return jG(t,e,!1)}async function k2e(t,e){return jG(t,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class C2e{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!$e().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const r=this.functionRefs[s.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return QH(e)}}if($e().get("IS_BROWSER")){$e().setPlatform("browser",new C2e);try{ya.registerManager(Sh.URL_SCHEME,new w2e)}catch{}try{ya.registerManager(Nh.URL_SCHEME,new m2e)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T2e={importFetch:()=>require("node-fetch")};let T3;class _2e{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return $e().global.fetch!=null?$e().global.fetch(e,n):(T3==null&&(T3=T2e.importFetch()),T3(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}$e().get("IS_NODE")&&!$e().get("IS_BROWSER")&&$e().setPlatform("node",new _2e);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function on(t,e="float32",n){return e=e||"float32",Ni(t),new tr(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E2e(t,e){const n=te(t,"x","cast");if(!BH(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:n},r={dtype:e};return de.runKernel(Yf,s,r)}const ft=he({cast_:E2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A2e(t){const n={x:te(t,"x","clone","string_or_numeric")};return de.runKernel(cp,n)}const Ol=he({clone_:A2e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a$(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */cG();const $2e={buffer:on,cast:ft,clone:Ol,print:a$};Awe($2e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I2e(t,e){let n=te(t,"a","add"),s=te(e,"b","add");[n,s]=Rs(n,s);const r={a:n,b:s};return de.runKernel(Gh,r)}const nt=he({add_:I2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R2e(t,e){let n=te(t,"a","floorDiv"),s=te(e,"b","floorDiv");[n,s]=Rs(n,s);const r={a:n,b:s};return de.runKernel(op,r)}const SS=he({floorDiv_:R2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O2e(t,e){let n=te(t,"a","div"),s=te(e,"b","div");if([n,s]=Rs(n,s),n.dtype==="int32"&&s.dtype==="int32")return SS(n,s);const r={a:n,b:s},a={};return de.runKernel(tp,r,a)}const Mt=he({div_:O2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D2e(t,e){let n=te(t,"a","mul"),s=te(e,"b","mul");[n,s]=Rs(n,s);const r={a:n,b:s};return de.runKernel(yp,r)}const ge=he({mul_:D2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P2e(t){const e=te(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return de.runKernel(Jx,n)}else{const n={x:e};return de.runKernel(Wx,n)}}const Js=he({abs_:P2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L2e(t){const n={x:te(t,"x","acos")};return de.runKernel(Vf,n)}const i$=he({acos_:L2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M2e(t){const n={x:te(t,"x","acosh")};return de.runKernel(Wf,n)}const o$=he({acosh_:M2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F2e(t){Z(Array.isArray(t),()=>"The argument passed to tf.addN() must be a list of tensors"),Z(t.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${t.length}`);const e=t.map((r,a)=>te(r,`tensors${a}`,"addN")),n=e[0];e.forEach(r=>{if(r.dtype!==n.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(r=>{if(!xn(r.shape,n.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const s=e;return de.runKernel(Hx,s)}const kG=he({addN_:F2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z2e(t,e=null,n=!1){const r={x:te(t,"x","all","bool")},a={axis:e,keepDims:n};return de.runKernel(pN,r,a)}const jS=he({all_:z2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B2e(t,e=null,n=!1){const r={x:te(t,"x","any","bool")},a={axis:e,keepDims:n};return de.runKernel(gN,r,a)}const ox=he({any_:B2e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U2e(t,e=0){const s={x:te(t,"x","argMax")},r={axis:e};return de.runKernel(Gx,s,r)}const jh=he({argMax_:U2e});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V2e(t,e=0){const s={x:te(t,"x","argMin")},r={axis:e};return de.runKernel(qx,s,r)}const l$=he({argMin_:V2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W2e(t){const n={x:te(t,"x","asin")};return de.runKernel(Hf,n)}const c$=he({asin_:W2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H2e(t){const n={x:te(t,"x","asinh")};return de.runKernel(Gf,n)}const u$=he({asinh_:H2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G2e(t){const n={x:te(t,"x","atan")};return de.runKernel(qf,n)}const d$=he({atan_:G2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q2e(t,e){let n=te(t,"a","atan2"),s=te(e,"b","atan2");[n,s]=Rs(n,s);const r={a:n,b:s};return de.runKernel(Xf,r)}const h$=he({atan2_:q2e});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K2e(t){const n={x:te(t,"x","atanh")};return de.runKernel(Kf,n)}const m$=he({atanh_:K2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xy(t,e,n,s,r="NHWC",a){const i=t[3],l=[...e,i],c=Zc(r);return Or(t,l,n,a,s,null,null,c)}function Po(t,e,n,s,r,a,i="channelsLast"){const[l,c]=lx(e);let u;if(i==="channelsLast")u=[l,c,t[3],t[3]];else if(i==="channelsFirst")u=[l,c,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return Or(t,u,n,s,r,a,!1,i)}function Qc(t,e,n,s,r,a,i="NDHWC"){const[l,c,u]=cE(e);let h,f;if(i==="NDHWC")f="channelsLast",h=[l,c,u,t[4],t[4]];else if(i==="NCDHW")f="channelsFirst",h=[l,c,u,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return ud(t,h,n,s,r,!1,f,a)}function Or(t,e,n,s,r,a,i=!1,l="channelsLast"){let[c,u,h,f]=[-1,-1,-1,-1];if(l==="channelsLast")[c,u,h,f]=t;else if(l==="channelsFirst")[c,f,u,h]=t;else throw new Error(`Unknown dataFormat ${l}`);const[p,x,,y]=e,[v,b]=lx(n),[N,S]=lx(s),k=Qm(p,N),T=Qm(x,S),{padInfo:E,outHeight:D,outWidth:A}=Q2e(r,u,h,v,b,k,T,a,l),I=i?y*f:y;let P;return l==="channelsFirst"?P=[c,I,D,A]:l==="channelsLast"&&(P=[c,D,A,I]),{batchSize:c,dataFormat:l,inHeight:u,inWidth:h,inChannels:f,outHeight:D,outWidth:A,outChannels:I,padInfo:E,strideHeight:v,strideWidth:b,filterHeight:p,filterWidth:x,effectiveFilterHeight:k,effectiveFilterWidth:T,dilationHeight:N,dilationWidth:S,inShape:t,outShape:P,filterShape:e}}function ud(t,e,n,s,r,a=!1,i="channelsLast",l){let[c,u,h,f,p]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[c,u,h,f,p]=t;else if(i==="channelsFirst")[c,p,u,h,f]=t;else throw new Error(`Unknown dataFormat ${i}`);const[x,y,v,,b]=e,[N,S,k]=cE(n),[T,E,D]=cE(s),A=Qm(x,T),I=Qm(y,E),P=Qm(v,D),{padInfo:$,outDepth:R,outHeight:F,outWidth:W}=Z2e(r,u,h,f,N,S,k,A,I,P,l),q=a?b*p:b;let X;return i==="channelsFirst"?X=[c,q,R,F,W]:i==="channelsLast"&&(X=[c,R,F,W,q]),{batchSize:c,dataFormat:i,inDepth:u,inHeight:h,inWidth:f,inChannels:p,outDepth:R,outHeight:F,outWidth:W,outChannels:q,padInfo:$,strideDepth:N,strideHeight:S,strideWidth:k,filterDepth:x,filterHeight:y,filterWidth:v,effectiveFilterDepth:A,effectiveFilterHeight:I,effectiveFilterWidth:P,dilationDepth:T,dilationHeight:E,dilationWidth:D,inShape:t,outShape:X,filterShape:e}}function X2e(t,e,n,s,r){s==null&&(s=f$(t,e,n));const a=t[0],i=t[1],l=cx((a-e+2*s)/n+1,r),c=cx((i-e+2*s)/n+1,r);return[l,c]}function Y2e(t,e,n,s,r,a){r==null&&(r=f$(t,e[0],s[0]));const i=[0,0,0,n];for(let l=0;l<3;l++)t[l]+2*r>=e[l]&&(i[l]=cx((t[l]-e[l]+2*r)/s[l]+1,a));return i}function f$(t,e,n,s=1){const r=Qm(e,s);return Math.floor((t[0]*(n-1)-n+r)/2)}function lx(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function cE(t){return typeof t=="number"?[t,t,t]:t}function Qm(t,e){return e<=1?t:t+(t-1)*(e-1)}function Q2e(t,e,n,s,r,a,i,l,c){let u,h,f;if(typeof t=="number"){u={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const x=X2e([e,n],a,s,t,l);h=x[0],f=x[1]}else if(t==="same"){h=Math.ceil(e/s),f=Math.ceil(n/r);const p=Math.max(0,(h-1)*s+a-e),x=Math.max(0,(f-1)*r+i-n),y=Math.floor(p/2),v=p-y,b=Math.floor(x/2),N=x-b;u={top:y,bottom:v,left:b,right:N,type:"SAME"}}else if(t==="valid")u={top:0,bottom:0,left:0,right:0,type:"VALID"},h=Math.ceil((e-a+1)/s),f=Math.ceil((n-i+1)/r);else if(typeof t=="object"){const p=c==="channelsLast"?t[1][0]:t[2][0],x=c==="channelsLast"?t[1][1]:t[2][1],y=c==="channelsLast"?t[2][0]:t[3][0],v=c==="channelsLast"?t[2][1]:t[3][1];u={top:p,bottom:x,left:y,right:v,type:p===0&&x===0&&y===0&&v===0?"VALID":"EXPLICIT"},h=cx((e-a+p+x)/s+1,l),f=cx((n-i+y+v)/r+1,l)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:u,outHeight:h,outWidth:f}}function Z2e(t,e,n,s,r,a,i,l,c,u,h){let f,p,x,y;if(t==="valid"&&(t=0),typeof t=="number"){f={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const b=Y2e([e,n,s,1],[l,c,u],1,[r,a,i],t,h);p=b[0],x=b[1],y=b[2]}else if(t==="same"){p=Math.ceil(e/r),x=Math.ceil(n/a),y=Math.ceil(s/i);const v=(p-1)*r+l-e,b=(x-1)*a+c-n,N=(y-1)*i+u-s,S=Math.floor(v/2),k=v-S,T=Math.floor(b/2),E=b-T,D=Math.floor(N/2),A=N-D;f={top:T,bottom:E,left:D,right:A,front:S,back:k,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:f,outDepth:p,outHeight:x,outWidth:y}}function cx(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function Qu(t){const[e,n,s]=lx(t);return e===1&&n===1&&s===1}function Zr(t,e){return Qu(t)||Qu(e)}function kh(t){return lx(t).every(e=>e>0)}function Zc(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function Ta(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")Z(vh(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(s=>{s.forEach(r=>{Z(vh(r),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${r}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J2e(t,e){const s={x:te(t,"x","reshape","string_or_numeric")},r={shape:e};return de.runKernel(Ry,s,r)}const be=he({reshape_:J2e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eNe(t,e,n,s,r){const a=te(t,"x","avgPool","float32"),i=1;Z(Zr(n,i),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);let l=a,c=!1;a.rank===3&&(c=!0,l=be(a,[1,a.shape[0],a.shape[1],a.shape[2]])),Z(l.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${l.rank}.`),Ta("avgPool",s,r);const u={x:l},h={filterSize:e,strides:n,pad:s,dimRoundingMode:r};let f=de.runKernel(Kx,u,h);return f=ft(f,a.dtype),c?be(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const Yy=he({avgPool_:eNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tNe(t,e,n,s,r,a="NDHWC"){const i=te(t,"x","avgPool3d","float32");let l=i,c=!1;i.rank===4&&(c=!0,l=be(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),Z(l.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${l.rank}.`),Z(a==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),Z(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),Ta("avgPool3d",s,r);const u={x:l},h={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:a};let f=de.runKernel(Xx,u,h);return f=ft(f,l.dtype),c?be(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const p$=he({avgPool3d_:tNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nNe(t,e=0){Z(t.length>=1,()=>"Pass at least one tensor to concat");const n=ix(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(a=>{if(a.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${a.dtype}. `)}),n.length===1)return Ol(n[0]);const s=n,r={axis:e};return de.runKernel(ey,s,r)}const Vs=he({concat_:nNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sNe(t,e,n=!1,s=!1){let r=te(t,"a","matMul"),a=te(e,"b","matMul");[r,a]=Rs(r,a);const i={a:r,b:a},l={transposeA:n,transposeB:s};return de.runKernel(Yx,i,l)}const mn=he({matMul_:sNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rNe(t){const n={x:te(t,"x","sigmoid","float32")};return de.runKernel(Ep,n)}const rl=he({sigmoid_:rNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aNe(t,e,n){const s=te(t,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const r={x:s},a={begin:e,size:n};return de.runKernel(My,r,a)}const Nn=he({slice_:aNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iNe(t){const n={x:te(t,"x","tanh","float32")};return de.runKernel(Dp,n)}const Zu=he({tanh_:iNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oNe(t,e,n,s,r,a){const i=te(t,"forgetBias","basicLSTMCell"),l=te(e,"lstmKernel","basicLSTMCell"),c=te(n,"lstmBias","basicLSTMCell"),u=te(s,"data","basicLSTMCell"),h=te(r,"c","basicLSTMCell"),f=te(a,"h","basicLSTMCell"),p=Vs([u,f],1),x=mn(p,l),y=nt(x,c),v=y.shape[0],b=y.shape[1]/4,N=[v,b],S=Nn(y,[0,0],N),k=Nn(y,[0,b],N),T=Nn(y,[0,b*2],N),E=Nn(y,[0,b*3],N),D=nt(ge(rl(S),Zu(k)),ge(h,rl(nt(i,T)))),A=ge(Zu(D),rl(E));return[D,A]}const CG=he({basicLSTMCell_:oNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lNe(t,e,n){const s=te(t,"x","batchToSpaceND"),r=e.reduce((l,c)=>l*c);Z(s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),Z(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),Z(s.shape[0]%r===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${r}`);const a={x:s},i={blockShape:e,crops:n};return de.runKernel(Qx,a,i)}const Qy=he({batchToSpaceND_:lNe});function cNe(t){let e;return t.rank===0||t.rank===1?e=be(t,[1,1,1,t.size]):t.rank===2?e=be(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=be(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uNe(t,e,n,s,r,a){a==null&&(a=.001);const i=te(t,"x","batchNorm"),l=te(e,"mean","batchNorm"),c=te(n,"variance","batchNorm");let u;r!=null&&(u=te(r,"scale","batchNorm"));let h;s!=null&&(h=te(s,"offset","batchNorm")),Z(l.rank===c.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),Z(h==null||l.rank===h.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),Z(u==null||l.rank===u.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const p={x:cNe(i),scale:u,offset:h,mean:l,variance:c},x={varianceEpsilon:a},y=de.runKernel(cy,p,x);return be(y,i.shape)}const Mp=he({batchNorm_:uNe});function dNe(t,e,n,s,r,a){const i=te(t,"x","batchNorm"),l=te(e,"mean","batchNorm"),c=te(n,"variance","batchNorm");let u;r!=null&&(u=te(r,"scale","batchNorm"));let h;return s!=null&&(h=te(s,"offset","batchNorm")),Z(i.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${i.rank}.`),Z(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${l.rank}.`),Z(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${c.rank}.`),u!=null&&Z(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${u.rank}.`),h!=null&&Z(h.rank===2||h.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${h.rank}.`),Mp(i,l,c,h,u,a)}const g$=he({batchNorm2d_:dNe});function hNe(t,e,n,s,r,a){const i=te(t,"x","batchNorm"),l=te(e,"mean","batchNorm"),c=te(n,"variance","batchNorm");let u;r!=null&&(u=te(r,"scale","batchNorm"));let h;return s!=null&&(h=te(s,"offset","batchNorm")),Z(i.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${i.rank}.`),Z(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${l.rank}.`),Z(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${c.rank}.`),u!=null&&Z(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${u.rank}.`),h!=null&&Z(h.rank===3||h.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${h.rank}.`),Mp(i,l,c,h,u,a)}const x$=he({batchNorm3d_:hNe});function mNe(t,e,n,s,r,a){const i=te(t,"x","batchNorm"),l=te(e,"mean","batchNorm"),c=te(n,"variance","batchNorm");let u;r!=null&&(u=te(r,"scale","batchNorm"));let h;return s!=null&&(h=te(s,"offset","batchNorm")),Z(i.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${i.rank}.`),Z(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${l.rank}.`),Z(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${c.rank}.`),u!=null&&Z(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${u.rank}.`),h!=null&&Z(h.rank===4||h.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${h.rank}.`),Mp(i,l,c,h,u,a)}const y$=he({batchNorm4d_:mNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fNe(t,e,n){const s=te(t,"x","bincount"),r=te(e,"weights","bincount");Z(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),Z(n>=0,()=>`size must be non-negative, but got ${n}.`),Z(r.size===s.size||r.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${r.shape}.`);const a={x:s,weights:r},i={size:n};return de.runKernel(bN,a,i)}const b$=he({bincount_:fNe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pNe(t,e){const n=te(t,"x","bitwiseAnd"),s=te(e,"y","bitwiseAnd");if(!xn(n.shape,s.shape))throw new Error(`BitwiseAnd: Tensors must have the same shape. x: ${n.shape}, y: ${s.shape}`);if(n.dtype!=="int32"||s.dtype!=="int32")throw new Error(`BitwiseAnd: Only supports 'int32' values in tensor, found type of x: ${n.dtype} and type of y: ${s.dtype}`);const r={a:n,b:s};return de.runKernel(Zx,r)}const TG=he({bitwiseAnd_:pNe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gNe(t,e){const n=te(t,"s0","broadcastArgs","int32"),s=te(e,"s1","broadcastArgs","int32");if(n.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${n.rank}`);if(s.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${s.rank}`);const r={s0:n,s1:s};return de.runKernel(vN,r)}const _G=he({broadcastArgs_:gNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xNe(t,e){let n=te(t,"broadcastTo","x");const s=n.shape;if(Ni(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const u=n.shape.slice();for(;u.length<e.length;)u.unshift(1);n=be(n,u)}const r=n.shape,a=Array.from(e);for(let u=e.length-1;u>=0;u--)if(r[u]===e[u])a[u]=1;else if(n.shape[u]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);if(a.map((u,h)=>u>1?h:-1).filter(u=>u>=0).length===0)return Ol(n);const l={x:n},c={reps:a};return de.runKernel(Pp,l,c)}const uh=he({broadcastTo_:xNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yNe(t){const n={x:te(t,"x","ceil","float32")};return de.runKernel(Qf,n)}const v$=he({ceil_:yNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qh(t,e,n){Ni(t),n=n||Wh(e);const s={shape:t,value:e,dtype:n};return de.runKernel(PN,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bNe(t,e,n){const s=te(t,"x","clipByValue");if(Z(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return qh(s.shape,e,s.dtype);const r={x:s},a={clipValueMin:e,clipValueMax:n};return de.runKernel(Zf,r,a)}const Ha=he({clipByValue_:bNe});function vNe(t){return Vs(t,0)}const w$=he({concat1d_:vNe});function wNe(t,e){return Vs(t,e)}const N$=he({concat2d_:wNe});function NNe(t,e){return Vs(t,e)}const S$=he({concat3d_:NNe});function SNe(t,e){return Vs(t,e)}const j$=he({concat4d_:SNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jNe(t,e,n,s,r="NHWC",a=[1,1],i){const l=te(t,"x","conv2d","float32"),c=te(e,"filter","conv2d","float32");let u=l,h=!1;l.rank===3&&(h=!0,u=be(l,[1,l.shape[0],l.shape[1],l.shape[2]])),Z(u.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${u.rank}.`),Z(c.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${c.rank}.`),Ta("conv2d",s,i);const f=r==="NHWC"?u.shape[3]:u.shape[1];Z(f===c.shape[2],()=>`Error in conv2d: depth of input (${f}) must match input depth for filter ${c.shape[2]}.`),Z(Zr(n,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),Z(kh(a),()=>"Error in conv2D: Dilated rates should be larger than 0."),Z(kh(n),()=>"Error in conv2D: Strides should be larger than 0.");const p={x:u,filter:c},x={strides:n,pad:s,dataFormat:r,dilations:a,dimRoundingMode:i},y=de.runKernel(ty,p,x);return h?be(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const Lc=he({conv2d_:jNe});function kNe(t,e,n,s,r="NWC",a=1,i){const l=te(t,"x","conv1d"),c=te(e,"filter","conv1d");let u=l,h=!1;l.rank===2&&(h=!0,u=be(l,[1,l.shape[0],l.shape[1]])),Z(u.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${u.rank}.`),Z(c.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${c.rank}.`),Ta("conv1d",s,i),Z(u.shape[2]===c.shape[1],()=>`Error in conv1d: depth of input (${u.shape[2]}) must match input depth for filter ${c.shape[1]}.`),Z(Zr(n,a),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${a}'`),Z(kh(a),()=>"Error in conv1D: Dilated rates should be larger than 0."),Z(kh(n),()=>"Error in conv1D: Stride should be larger than 0."),Z(r==="NWC",()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const f=be(c,[1,c.shape[0],c.shape[1],c.shape[2]]),p=be(u,[u.shape[0],1,u.shape[1],u.shape[2]]),b=Lc(p,f,[1,n],s,"NHWC",[1,a],i);return h?be(b,[b.shape[2],b.shape[3]]):be(b,[b.shape[0],b.shape[2],b.shape[3]])}const kS=he({conv1d_:kNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CNe(t,e,n,s,r,a="NHWC",i){Z(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let l=t,c=e,u=!1;e.rank===3&&(u=!0,c=be(e,[1,e.shape[0],e.shape[1],e.shape[2]]),l=[1,t[0],t[1],t[2]]),Z(l.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${l.length}.`),Z(c.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${c.rank}`),Z(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const h=a==="NHWC"?l[3]:l[1],f=a==="NHWC"?c.shape[3]:c.shape[1];Z(h===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${h}) must match input depth for filter ${n.shape[2]}.`),Z(f===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${f}) must match output depth for filter ${n.shape[3]}.`),Ta("conv2dDerInput",r,i);const p={dy:c,filter:n},x={strides:s,pad:r,dataFormat:a,dimRoundingMode:i,inputShape:l},y=de.runKernel(ny,p,x);return u?be(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const k$=he({conv2DBackpropInput_:CNe});function TNe(t,e,n,s,r,a){const i=te(t,"x","conv2dTranspose"),l=te(e,"filter","conv2dTranspose");return k$(n,i,l,s,r,"NHWC",a)}const CS=he({conv2dTranspose_:TNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ne(t,e,n,s,r="NDHWC",a=[1,1,1]){const i=te(t,"x","conv3d"),l=te(e,"filter","conv3d");let c=i,u=!1;i.rank===4&&(u=!0,c=be(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),Z(c.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${c.rank}.`),Z(l.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${l.rank}.`),Z(c.shape[4]===l.shape[3],()=>`Error in conv3d: depth of input (${c.shape[4]}) must match input depth for filter ${l.shape[3]}.`),Z(Zr(n,a),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),Z(r==="NDHWC",()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`),Z(kh(a),()=>"Error in conv3D: Dilated rates should be larger than 0."),Z(kh(n),()=>"Error in conv3D: Strides should be larger than 0.");const h={x:c,filter:l},f={strides:n,pad:s,dataFormat:r,dilations:a},p=de.runKernel(sy,h,f);return u?be(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const C$=he({conv3d_:_Ne});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ENe(t,e,n,s,r){Z(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,i=e,l=!1;e.rank===4&&(l=!0,i=be(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),a=[1,t[0],t[1],t[2],t[3]]);const c=a[4],u=i.shape[4];Z(a.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${a.length}.`),Z(i.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${i.rank}`),Z(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),Z(c===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${c}) must match input depth for filter ${n.shape[3]}.`),Z(u===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${u}) must match output depth for filter ${n.shape[4]}.`);const h={dy:i,filter:n},f={pad:r,strides:s,inputShape:a},p=de.runKernel(jN,h,f);return l?be(p,[p.shape[1],p.shape[2],p.shape[3],p.shape[4]]):p}const EG=he({conv3DBackpropInput_:ENe});function ANe(t,e,n,s,r){const a=te(t,"x","conv3dTranspose"),i=te(e,"filter","conv3dTranspose");return EG(n,a,i,s,r)}const T$=he({conv3dTranspose_:ANe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ne(t){const n={x:te(t,"x","cos","float32")};return de.runKernel(Jf,n)}const Zy=he({cos_:$Ne});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function INe(t){const n={x:te(t,"x","cosh","float32")};return de.runKernel(ep,n)}const TS=he({cosh_:INe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RNe(t,e=0,n=!1,s=!1){const a={x:te(t,"x","cumprod")},i={axis:e,exclusive:n,reverse:s};return de.runKernel(kN,a,i)}const ux=he({cumprod_:RNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ONe(t,e=0,n=!1,s=!1){const a={x:te(t,"x","cumsum")},i={axis:e,exclusive:n,reverse:s};return de.runKernel(ry,a,i)}const _S=he({cumsum_:ONe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DNe(t,e,n,s=!1){const r=te(t,"x","denseBincount"),a=te(e,"weights","denseBincount");Z(r.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${r.dtype}`),Z(r.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${r.rank}.`),Z(n>=0,()=>`size must be non-negative, but got ${n}.`),Z(a.size===r.size||a.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${r.shape}, weights shape: ${a.shape}.`);const i={x:r,weights:a},l={size:n,binaryOutput:s};return de.runKernel(TN,i,l)}const Zw=he({denseBincount_:DNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PNe(t,e,n="NHWC"){const s=te(t,"x","depthToSpace","float32"),r=n==="NHWC"?s.shape[1]:s.shape[2],a=n==="NHWC"?s.shape[2]:s.shape[3],i=n==="NHWC"?s.shape[3]:s.shape[1];Z(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),Z(r*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${e}  for depthToSpace with input shape
    ${s.shape}`),Z(a*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${a} and ${e} for depthToSpace with input shape
        ${s.shape}`),Z(i%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${i} for depthToSpace with input shape ${s.shape}`);const l={x:s},c={blockSize:e,dataFormat:n};return de.runKernel(_N,l,c)}const _$=he({depthToSpace_:PNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LNe(t,e,n,s,r="NHWC",a=[1,1],i){const l=te(t,"x","depthwiseConv2d","float32"),c=te(e,"filter","depthwiseConv2d","float32");let u=l,h=!1;l.rank===3&&(h=!0,u=be(l,[1,l.shape[0],l.shape[1],l.shape[2]])),Z(u.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${u.rank}.`),Z(c.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${c.rank}.`);const f=r==="NHWC"?u.shape[3]:u.shape[1];Z(f===c.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${f}) must match the inChannels dimension in filter ${c.shape[2]}.`),Ta("depthwiseConv2d",s,i);const p={x:u,filter:c},x={strides:n,pad:s,dataFormat:r,dilations:a,dimRoundingMode:i},y=de.runKernel(ay,p,x);return h?be(y,[y.shape[1],y.shape[2],y.shape[3]]):y}const Fp=he({depthwiseConv2d_:LNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MNe(t){const n={x:te(t,"x","diag")};return de.runKernel($N,n)}const AG=he({diag_:MNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FNe(t,e,n,s,r=[1,1],a="NHWC"){const i=te(t,"x","dilation2d"),l=te(e,"filter","dilation2d");Z(i.rank===3||i.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${i.rank}.`),Z(l.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${l.rank}.`),Z(a==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${a}`);let c=i,u=!1;i.rank===3&&(c=be(i,[1,i.shape[0],i.shape[1],i.shape[2]]),u=!0),Z(c.shape[3]===l.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${c.shape[3]} vs ${l.shape[2]}`);const h={x:c,filter:l},f={strides:n,pad:s,dilations:r},p=de.runKernel(iy,h,f);return u?be(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const E$=he({dilation2d_:FNe});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ch(t,e){const n=t.length,s=[];for(let r=0;r<n;r++){const a=n-1-r,i=t[a]||1;(e[e.length-1-r]||1)>1&&i===1&&s.unshift(a)}return s}function sr(t,e){const n=[];for(let s=0;s<e.length;s++){const r=t[t.length-s-1],a=e.length-s-1,i=e[a];(r==null||r===1&&i>1)&&n.unshift(a)}return n}function en(t,e){const n=Math.max(t.length,e.length),s=new Array(n);for(let r=0;r<n;r++){let a=t[t.length-r-1];a==null&&(a=1);let i=e[e.length-r-1];if(i==null&&(i=1),a===1)s[n-r-1]=i;else if(i===1)s[n-r-1]=a;else if(a!==i){const l=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(l)}else s[n-r-1]=a}return s}const zNe=Object.freeze(Object.defineProperty({__proto__:null,assertAndGetBroadcastShape:en,getBroadcastDims:Ch,getReductionAxes:sr},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BNe(t,e){let n=te(t,"a","equal","string_or_numeric"),s=te(e,"b","equal","string_or_numeric");[n,s]=Rs(n,s),en(n.shape,s.shape);const r={a:n,b:s};return de.runKernel(oy,r)}const gi=he({equal_:BNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UNe(t,e,n){const s=te(e,"a","where"),r=te(n,"b","where"),a=te(t,"condition","where","bool"),i=en(en(a.shape,s.shape),r.shape),l=uh(a,i),c=uh(s,i),u=uh(r,i),h={condition:l,t:c,e:u};return de.runKernel(Ly,h)}const _r=he({where_:UNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VNe(t){const n={x:te(t,"x","zerosLike")};return de.runKernel(Gy,n)}const Sn=he({zerosLike_:VNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WNe(t,e){let n=te(t,"a","div"),s=te(e,"b","div");[n,s]=Rs(n,s);const r=Mt(n,s),a=Sn(r),i=gi(s,a);return _r(i,a,r)}const A$=he({divNoNan_:WNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HNe(t,e){const n=te(t,"t1","dot"),s=te(e,"t2","dot");Z((n.rank===1||n.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${s.rank}.`);const r=n.rank===1?n.size:n.shape[1],a=s.rank===1?s.size:s.shape[0];if(Z(r===a,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${a}.`),n.rank===1&&s.rank===1){const i=be(n,[1,-1]),l=be(s,[-1,1]),c=mn(i,l);return be(c,[])}else if(n.rank===1&&s.rank===2){const i=be(n,[1,-1]),l=be(s,[s.shape[0],s.shape[1]]),c=mn(i,l);return be(c,[c.size])}else if(n.rank===2&&s.rank===1){const i=be(s,[-1,1]),l=mn(n,i);return be(l,[l.size])}else{const i=be(s,[s.shape[0],s.shape[1]]);return mn(n,i)}}const $$=he({dot_:HNe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GNe(t,...e){const n=e.map((r,a)=>te(r,`tensors${a}`,"einsum")),s={equation:t};return de.runKernel(RN,n,s)}const Wd=he({einsum_:GNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qNe(t){const n={x:te(t,"x","elu","float32")};return de.runKernel(np,n)}const zp=he({elu_:qNe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KNe(t,e){const n=te(t,"x","ensureShape","string_or_numeric");if(!FH(n.shape,e))throw new Error(`EnsureShape: Shape of tensor ${n.shape} is not compatible with expected shape ${e}`);return t}const $G=he({ensureShape_:KNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XNe(t){let e=te(t,"x","erf");Z(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=ft(e,"float32"));const n={x:e};return de.runKernel(sp,n)}const ES=he({erf_:XNe});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I$(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function IG(t,e,n){const s=t.length+e.length,r=[];let a=0,i=0;for(let l=0;l<s;l++)n.indexOf(l)===-1?r.push(t[a++]):r.push(e[i++]);return r}function Dr(t,e){const n=[],s=t.length;for(let a=0;a<s;a++)e.indexOf(a)===-1&&n.push(t[a]);const r=e.map(a=>t[a]);return[n,r]}function Ws(t,e){const n=e.map(s=>1);return IG(t,n,e)}function Jr(t,e,n){Z(I$(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function Os(t,e){if(I$(t,e))return null;const n=[];for(let s=0;s<e;++s)t.indexOf(s)===-1&&n.push(s);return t.forEach(s=>n.push(s)),n}function dd(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function Hs(t,e){const n=[];for(let s=e-t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YNe(t,e=null,n=!1){const r={x:te(t,"x","max")},a={reductionIndices:e,keepDims:n};return de.runKernel(by,r,a)}const Ki=he({max_:YNe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QNe(t,e=null,n=!1){const r={x:te(t,"x","min")},a={axis:e,keepDims:n};return de.runKernel(Sy,r,a)}const pf=he({min_:QNe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZNe(t,e){let n=te(t,"base","pow"),s=te(e,"exp","pow");[n,s]=Rs(n,s);const r={a:n,b:s};return de.runKernel(bp,r)}const Ul=he({pow_:ZNe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bt(t,e){if((dr(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&dr(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return cd(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JNe(t){const n={x:te(t,"x","sqrt","float32")};return de.runKernel($p,n)}const Ar=he({sqrt_:JNe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eSe(t){const e=te(t,"x","square"),n={};return de.runKernel("Square",{x:e},n)}const Jn=he({square_:eSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tSe(t,e=null,n=!1){let s=te(t,"x","sum");s.dtype==="bool"&&(s=ft(s,"int32"));const r={x:s},a={axis:e,keepDims:n};return de.runKernel(Fy,r,a)}const $t=he({sum_:tSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nSe(t,e="euclidean",n=null,s=!1){t=te(t,"x","norm");const r=RG(t,e,n);let a=r.shape;if(s){const i=fn(n,t.shape);a=Ws(r.shape,i)}return be(r,a)}function RG(t,e,n=null){if(t.rank===0)return Js(t);if(t.rank!==1&&n===null)return RG(be(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return $t(Js(t),n);if(e===1/0)return Ki(Js(t),n);if(e===-1/0)return pf(Js(t),n);if(e==="euclidean"||e===2)return Ar($t(Ul(Js(t),Bt(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return Ki($t(Js(t),n[0]),n[1]-1);if(e===1/0)return Ki($t(Js(t),n[1]),n[0]);if(e===-1/0)return pf($t(Js(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return Ar($t(Jn(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const Bp=he({norm_:nSe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sSe(t,e=null,n=!1){return Bp(t,"euclidean",e,n)}const R$=he({euclideanNorm_:sSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rSe(t){const n={x:te(t,"x","exp")};return de.runKernel(rp,n)}const Ga=he({exp_:rSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aSe(t,e=0){const n=te(t,"x","expandDims","string_or_numeric");Z(e<=n.rank,()=>"Axis must be <= rank of the tensor");const s={input:n},r={dim:e};return de.runKernel(ly,s,r)}const Br=he({expandDims_:aSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iSe(t){const n={x:te(t,"x","expm1")};return de.runKernel(ap,n)}const O$=he({expm1_:iSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oSe(t,e){const n=te(t,"x","tile","string_or_numeric");Z(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const s={x:n},r={reps:e};return de.runKernel(Pp,s,r)}const Ui=he({tile_:oSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lSe(t,e,n,s="float32"){e==null&&(e=t);const r=on([t,e],s),a=t<=e?t:e;for(let l=0;l<a;++l)r.set(1,l,l);const i=be(r.toTensor(),[t,e]);if(n==null)return i;if(n.length===1)return Ui(Br(i,0),[n[0],1,1]);if(n.length===2)return Ui(Br(Br(i,0),0),[n[0],n[1],1,1]);if(n.length===3)return Ui(Br(Br(Br(i,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const AS=he({eye_:lSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cSe(t){const n={x:te(t,"x","floor","float32")};return de.runKernel(ip,n)}const Up=he({floor_:cSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uSe(t,e,n=0,s=0){const r=te(t,"x","gather"),a=te(e,"indices","gather","int32"),i={x:r,indices:a},l={axis:n,batchDims:s};return de.runKernel(uy,i,l)}const Vp=he({gather_:uSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dSe(t,e){let n=te(t,"a","greater","string_or_numeric"),s=te(e,"b","greater","string_or_numeric");[n,s]=Rs(n,s),en(n.shape,s.shape);const r={a:n,b:s};return de.runKernel(dy,r)}const _a=he({greater_:dSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hSe(t,e){let n=te(t,"a","greaterEqual","string_or_numeric"),s=te(e,"b","greaterEqual","string_or_numeric");[n,s]=Rs(n,s),en(n.shape,s.shape);const r={a:n,b:s};return de.runKernel(lp,r)}const Jc=he({greaterEqual_:hSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mSe(t){const n={input:te(t,"input","imag")};return de.runKernel(zN,n)}const Jy=he({imag_:mSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fSe(t){const n={x:te(t,"x","isFinite")};return de.runKernel(up,n)}const D$=he({isFinite_:fSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pSe(t){const n={x:te(t,"x","isInf")};return de.runKernel(dp,n)}const P$=he({isInf_:pSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gSe(t){const n={x:te(t,"x","isNaN")};return de.runKernel(hp,n)}const L$=he({isNaN_:gSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xSe(t,e=.2){const s={x:te(t,"x","leakyRelu")},r={alpha:e};return de.runKernel(hy,s,r)}const eb=he({leakyRelu_:xSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ySe(t,e){let n=te(t,"a","less","string_or_numeric"),s=te(e,"b","less","string_or_numeric");[n,s]=Rs(n,s),en(n.shape,s.shape);const r={a:n,b:s};return de.runKernel(my,r)}const gf=he({less_:ySe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bSe(t,e){let n=te(t,"a","lessEqual","string_or_numeric"),s=te(e,"b","lessEqual","string_or_numeric");[n,s]=Rs(n,s),en(n.shape,s.shape);const r={a:n,b:s};return de.runKernel(fy,r)}const hd=he({lessEqual_:bSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OG(t,e,n){if(n<=0)throw new Error("The number of values should be positive.");const s={start:t,stop:e,num:n};return de.runKernel(BN,{},s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vSe(t,e=5,n=1,s=1,r=.5){const a=te(t,"x","localResponseNormalization");Z(a.rank===4||a.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${a.rank}.`),Z(vh(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let i=a,l=!1;a.rank===3&&(l=!0,i=be(a,[1,a.shape[0],a.shape[1],a.shape[2]]));const c={x:i},u={depthRadius:e,bias:n,alpha:s,beta:r},h=de.runKernel(yy,c,u);return l?be(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const M$=he({localResponseNormalization_:vSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wSe(t){const n={x:te(t,"x","log","float32")};return de.runKernel(mp,n)}const xi=he({log_:wSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NSe(t){const n={x:te(t,"x","log1p")};return de.runKernel(fp,n)}const tb=he({log1p_:NSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SSe(t){return Z(Xu(t),()=>"The f passed in grad(f) must be a function"),(e,n)=>{const s=te(e,"x","tf.grad","string_or_numeric"),r=n!=null?te(n,"dy","tf.grad"):null;return de.tidy(()=>{const{value:a,grads:i}=de.gradients(()=>t(s),[s],r);return r!=null&&Qr(a.shape,r.shape,"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)"),$S(i),i[0]})}}function jSe(t){return Z(Xu(t),()=>"The f passed in grads(f) must be a function"),(e,n)=>{Z(Array.isArray(e),()=>"The args passed in grads(f)(args) must be an array of `Tensor`s or `TensorLike`s");const s=ix(e,"args","tf.grads","string_or_numeric"),r=n!=null?te(n,"dy","tf.grads"):null;return de.tidy(()=>{const{value:a,grads:i}=de.gradients(()=>t(...s),s,r);return r!=null&&Qr(a.shape,r.shape,"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),$S(i),i})}}function kSe(t){return Z(Xu(t),()=>"The f passed in valueAndGrad(f) must be a function"),(e,n)=>{Z(e instanceof Tn,()=>"The x passed in valueAndGrad(f)(x) must be a tensor"),Z(n==null||n instanceof Tn,()=>"The dy passed in valueAndGrad(f)(x, dy) must be a tensor");const{grads:s,value:r}=de.gradients(()=>t(e),[e],n);return $S(s),{grad:s[0],value:r}}}function CSe(t){return Z(Xu(t),()=>"The f passed in valueAndGrads(f) must be a function"),(e,n)=>{Z(Array.isArray(e)&&e.every(r=>r instanceof Tn),()=>"The args passed in valueAndGrads(f)(args) must be array of tensors"),Z(n==null||n instanceof Tn,()=>"The dy passed in valueAndGrads(f)(args, dy) must be a tensor");const s=de.gradients(()=>t(...e),e,n);return n!=null&&Qr(s.value.shape,n.shape,"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])"),$S(s.grads),s}}function DG(t,e){Z(Xu(t),()=>"The f passed in variableGrads(f) must be a function"),Z(e==null||Array.isArray(e)&&e.every(u=>u instanceof ax),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const u in de.registeredVariables)e.push(de.registeredVariables[u])}const s=n?e.filter(u=>!u.trainable):null,r=e.length;e=e.filter(u=>u.trainable),Z(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${r} variables is trainable.`);const a=!0,{value:i,grads:l}=de.gradients(t,e,null,a);Z(l.some(u=>u!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),Z(i.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${i.rank} tensor`);const c={};return e.forEach((u,h)=>{l[h]!=null&&(c[u.name]=l[h])}),s!=null&&s.forEach(u=>c[u.name]=null),{value:i,grads:c}}function Vl(t){return de.customGrad(t)}function $S(t){if(t.filter(n=>n==null).length>0)throw new Error(`Cannot compute gradient of y=f(x) with respect to x. Make sure that
    the f you passed encloses all operations that lead from x to y.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TSe(t){const n={x:te(t,"x","neg")};return de.runKernel(ky,n)}const gs=he({neg_:TSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Se(t){const n={x:te(t,"x","softplus")};return de.runKernel(Ap,n)}const Kh=he({softplus_:_Se});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ESe(t){const e=te(t,"x","logSigmoid");return Vl(s=>({value:gs(Kh(gs(s))),gradFunc:i=>ge(i,rl(gs(s)))}))(e)}const F$=he({logSigmoid_:ESe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ASe(t,e){let n=te(t,"a","sub"),s=te(e,"b","sub");[n,s]=Rs(n,s);const r={a:n,b:s};return de.runKernel(Rp,r)}const Tt=he({sub_:ASe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Se(t,e=-1){const n=te(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return Vl((r,a)=>{const l=Ki(r,e,!0),c=Tt(r,l),u=Tt(ft(c,"float32"),xi($t(Ga(c),e,!0)));return a([u]),{value:u,gradFunc:(f,p)=>{const[x]=p,y=!0,v=Ga(x);return Tt(f,ge($t(f,e,y),v))}}})(n)}const IS=he({logSoftmax_:$Se});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ISe(t,e=null,n=!1){const s=te(t,"x","logSumExp"),r=fn(e,s.shape),a=Ki(s,r,!0),i=Tt(s,a),l=Ga(i),c=$t(l,r),u=xi(c),h=nt(be(a,u.shape),u);if(n){const f=Ws(h.shape,r);return be(h,f)}return h}const nb=he({logSumExp_:ISe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RSe(t,e){const n=te(t,"a","logicalAnd","bool"),s=te(e,"b","logicalAnd","bool");en(n.shape,s.shape);const r={a:n,b:s};return de.runKernel(py,r)}const Io=he({logicalAnd_:RSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OSe(t){const n={x:te(t,"x","logicalNot","bool")};return de.runKernel(gy,n)}const sb=he({logicalNot_:OSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DSe(t,e){const n=te(t,"a","logicalOr","bool"),s=te(e,"b","logicalOr","bool");en(n.shape,s.shape);const r={a:n,b:s};return de.runKernel(xy,r)}const RS=he({logicalOr_:DSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PSe(t,e){const n=te(t,"a","logicalXor","bool"),s=te(e,"b","logicalXor","bool");return en(n.shape,s.shape),Io(RS(t,e),sb(Io(t,e)))}const z$=he({logicalXor_:PSe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l1=2147483648;function LSe(t,e,n="left"){const s=te(t,"sortedSequence","searchSorted"),r=te(e,"values","searchSorted"),a=s.shape[s.shape.length-1],i=r.shape[r.shape.length-1],l=be(s,[-1,a]),c=be(r,[-1,i]);if(l.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(l.shape[0]!==c.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(ze(c.shape)>=l1)throw new Error(`values tensor size must less than ${l1}`);if(l.shape[1]>=l1)throw new Error(`trailing dim_size must less than ${l1} for int32 output type, was ${l.shape[1]}`);const u={sortedSequence:l,values:c},h={side:n};return de.runKernel(aS,u,h)}const OS=he({searchSorted_:LSe});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PG(t,e){return OS(t,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MSe(t,e,n,s,r){const a=te(t,"x","maxPool"),i=1;let l=a,c=!1;a.rank===3&&(c=!0,l=be(a,[1,a.shape[0],a.shape[1],a.shape[2]])),Z(l.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${l.rank}.`),Z(Zr(n,i),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),Ta("maxPool",s,r);const u={x:l},h={filterSize:e,strides:n,pad:s,dimRoundingMode:r},f=de.runKernel(vy,u,h);return c?be(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const rb=he({maxPool_:MSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FSe(t,e=[1,1,1],n,s,r,a="NDHWC"){const i=te(t,"x","maxPool3d");let l=i,c=!1;i.rank===4&&(c=!0,l=be(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),Z(l.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${l.rank}.`),Z(a==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${a}`),Ta("maxPool3d",s,r);const u={x:l},h={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:a},f=de.runKernel(wy,u,h);return c?be(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const B$=he({maxPool3d_:FSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zSe(t,e,n,s,r=!1){const i={x:te(t,"x","maxPoolWithArgmax")},l={filterSize:e,strides:n,pad:s,includeBatchInIndex:r},c=de.runKernel(HN,i,l);return{result:c[0],indexes:c[1]}}const LG=he({maxPoolWithArgmax_:zSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BSe(t,e){let n=te(t,"a","maximum"),s=te(e,"b","maximum");[n,s]=Rs(n,s),n.dtype==="bool"&&(n=ft(n,"int32"),s=ft(s,"int32")),en(n.shape,s.shape);const r={a:n,b:s};return de.runKernel(pp,r)}const Gl=he({maximum_:BSe});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function USe(t,e=null,n=!1){const r={x:te(t,"x","mean")},a={axis:e,keepDims:n};return de.runKernel(Ny,r,a)}const Es=he({mean_:USe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Us(t,e="float32"){if(Ni(t),e==="complex64"){const s=Us(t,"float32"),r=Us(t,"float32");return Pc(s,r)}const n=Gr(ze(t),e);return de.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fa(t,e="float32"){if(Ni(t),e==="complex64"){const s=Fa(t,"float32"),r=Us(t,"float32");return Pc(s,r)}const n=fN(ze(t),e);return de.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MG(t,e,{indexing:n="xy"}={}){if(n!=="xy"&&n!=="ij")throw new TypeError(`${n} is not a valid third argument to meshgrid`);if(t===void 0)return[];let s=te(t,"x","meshgrid",t instanceof Tn?t.dtype:"float32");if(e===void 0)return[s];let r=te(e,"y","meshgrid",e instanceof Tn?e.dtype:"float32");const a=ze(s.shape),i=ze(r.shape);return n==="xy"?(s=be(s,[1,-1]),r=be(r,[-1,1]),[mn(Fa([i,1],s.dtype),s),mn(r,Fa([1,a],r.dtype))]):(s=be(s,[-1,1]),r=be(r,[1,-1]),[mn(s,Fa([1,i],s.dtype)),mn(Fa([a,1],r.dtype),r)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VSe(t,e){let n=te(t,"a","minimum"),s=te(e,"b","minimum");[n,s]=Rs(n,s),n.dtype==="bool"&&(n=ft(n,"int32"),s=ft(s,"int32")),en(n.shape,s.shape);const r={a:n,b:s};return de.runKernel(gp,r)}const Ju=he({minimum_:VSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WSe(t,e,n){Z(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const s=te(t,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");Z(e.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${e.length}.`);const r=n==="reflect"?1:0;for(let l=0;l<s.rank;l++)Z(e[l].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),Z(e[l][0]>=0&&e[l][0]<=s.shape[l]-r&&e[l][1]>=0&&e[l][1]<=s.shape[l]-r,()=>`Padding in dimension ${l} cannot be greater than or equal to ${s.shape[l]-r} or less than 0 for input of shape ${s.shape}`);const a={paddings:e,mode:n},i={x:s};return de.runKernel(jy,i,a)}const U$=he({mirrorPad_:WSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HSe(t,e){let n=te(t,"a","mod"),s=te(e,"b","mod");[n,s]=Rs(n,s);const r={a:n,b:s};return de.runKernel(xp,r)}const V$=he({mod_:HSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GSe(t,e=null,n=!1){t=te(t,"x","moments");const s=fn(e,t.shape),r=Es(t,s,n);let a=r.shape;n||(a=Ws(r.shape,s));const i=Jn(Tt(ft(t,"float32"),be(r,a))),l=Es(i,s,n);return{mean:r,variance:l}}const ab=he({moments_:GSe});function qSe(t,e,n,s){const r=te(e,"data","multiRNNCell"),a=ix(n,"c","multiRNNCell"),i=ix(s,"h","multiRNNCell");let l=r;const c=[];for(let f=0;f<t.length;f++){const p=t[f](l,a[f],i[f]);c.push(p[0]),c.push(p[1]),l=p[1]}const u=[],h=[];for(let f=0;f<c.length;f+=2)u.push(c[f]),h.push(c[f+1]);return[u,h]}const FG=he({multiRNNCell_:qSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KSe(t,e,n,s=!1){const r=te(t,"logits","multinomial"),a=r.size,i=r.rank;if(a<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${a}.`);if(i>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${i}`);n=n||Math.random();const c={logits:i===1?be(r,[1,-1]):r},u={numSamples:e,seed:n,normalized:s},h=de.runKernel(GN,c,u);return i===1?be(h,[h.size]):h}const zG=he({multinomial_:KSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XSe(t,e){let n=te(t,"a","notEqual","string_or_numeric"),s=te(e,"b","notEqual","string_or_numeric");[n,s]=Rs(n,s),en(n.shape,s.shape);const r={a:n,b:s};return de.runKernel(Cy,r)}const Th=he({notEqual_:XSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YSe(t,e,n=1,s=0,r="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const i={indices:te(t,"indices","oneHot","int32")},l={dtype:r,depth:e,onValue:n,offValue:s};return de.runKernel(_y,i,l)}const xf=he({oneHot_:YSe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QSe(t){const n={x:te(t,"x","onesLike")};return de.runKernel(Ty,n)}const yi=he({onesLike_:QSe});function ZSe(t,e){const n=te(t,"v1","outerProduct"),s=te(e,"v2","outerProduct");Z(n.rank===1&&s.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${n.rank} and ${s.rank}.`);const r=be(n,[-1,1]),a=be(s,[1,-1]);return mn(r,a)}const BG=he({outerProduct_:ZSe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JSe(t,e,n=0){const s=te(t,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:e,constantValue:n},a={x:s};return de.runKernel(Ay,a,r)}const eu=he({pad_:JSe});function eje(t,e,n=0){return Z(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),eu(t,[e],n)}const UG=he({pad1d_:eje});function tje(t,e,n=0){return Z(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),eu(t,e,n)}const VG=he({pad2d_:tje});function nje(t,e,n=0){return Z(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),eu(t,e,n)}const WG=he({pad3d_:nje});function sje(t,e,n=0){return Z(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),eu(t,e,n)}const HG=he({pad4d_:sje});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rje(t,e,n){const s=te(t,"x","spaceToBatchND");Z(s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),Z(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),Z(s.shape.reduce((i,l,c)=>c>0&&c<=e.length?i&&(l+n[c-1][0]+n[c-1][1])%e[c-1]===0:i,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const r={x:s},a={blockShape:e,paddings:n};return de.runKernel(zy,r,a)}const ib=he({spaceToBatchND_:rje});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aje(t,e,n,s,r,a,i){r==null&&(r=[1,1]),a==null&&(a=1),s===0&&(s="valid");const l=te(t,"x","maxPool");let c=l,u=!1;l.rank===3&&(u=!0,c=be(l,[1,l.shape[0],l.shape[1],l.shape[2]])),Z(Zr(a,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${a} and dilations '${r}'`);const h=Po(c.shape,e,a,r,s),f=[h.dilationHeight,h.dilationWidth];let p;s==="same"?p=oje([h.filterHeight,h.filterWidth],f):p=[[0,0],[0,0]];const x=f[0]===1&&f[1]===1,[y,v]=ije([h.inHeight,h.inWidth],f,p),b=x?s:"valid",N=x?c:ib(c,f,y),k=(n==="avg"?()=>Yy(N,e,a,b,i):()=>rb(N,e,a,b,i))(),T=x?k:Qy(k,f,v);return u?be(T,[T.shape[1],T.shape[2],T.shape[3]]):T}function ije(t,e,n){const s=n.map(h=>h[0]),r=n.map(h=>h[1]),a=t.concat(s,r),i=e.map((h,f)=>(h-a[f]%h)%h),l=r.map((h,f)=>h+i[f]),c=e.map((h,f)=>[s[f],l[f]]),u=e.map((h,f)=>[0,i[f]]);return[c,u]}function oje(t,e){const s=t.map((i,l)=>i+(i-1)*(e[l]-1)).map(i=>i-1),r=s.map(i=>Math.floor(i/2)),a=s.map((i,l)=>i-r[l]);return s.map((i,l)=>[r[l],a[l]])}const W$=he({pool_:aje});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lje(t,e){const n=te(t,"x","prelu"),s=te(e,"alpha","prelu"),r={x:n,alpha:s};return de.runKernel($y,r)}const ob=he({prelu_:lje});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cje(t,e=null,n=!1){let s=te(t,"x","prod");s.dtype==="bool"&&(s=ft(s,"int32"));const r={x:s},a={axis:e,keepDims:n};return de.runKernel(Iy,r,a)}const H$=he({prod_:cje});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uje(t,e,n,s){const r=t.map((h,f)=>te(h,`tensors${f}`,"raggedGather","int32")),a=te(e,"paramsDenseValues","raggedGather"),i=te(n,"indices","raggedGather","int32"),l={paramsNestedSplits:r,paramsDenseValues:a,indices:i},c={outputRaggedRank:s},u=de.runKernel(YN,l,c);return{outputNestedSplits:u.slice(0,u.length-1),outputDenseValues:u[u.length-1]}}const GG=he({raggedGather_:uje});/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dje(t,e,n){const s=te(t,"starts","raggedRange"),r=te(e,"limits","raggedRange",s.dtype),a=te(n,"deltas","raggedRange",s.dtype),i={starts:s,limits:r,deltas:a},l=de.runKernel(QN,i);return{rtNestedSplits:l[0],rtDenseValues:l[1]}}const qG=he({raggedRange_:dje});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hje(t,e,n,s,r){const a=te(t,"shape","raggedTensorToTensor","int32"),i=te(e,"values","raggedTensorToTensor"),l=te(n,"defaultValue","raggedTensorToTensor",i.dtype),c=s.map((f,p)=>te(f,`tensors${p}`,"raggedTensorToTensor","int32")),u={shape:a,values:i,defaultValue:l,rowPartitionTensors:c},h={rowPartitionTypes:r};return de.runKernel(ZN,u,h)}const KG=he({raggedTensorToTensor_:hje});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mje(t,e,n){Ni(t);const s=ze(t);let r=null;if(n==null||n==="float32")r=new Float32Array(s);else if(n==="int32")r=new Int32Array(s);else if(n==="bool")r=new Uint8Array(s);else throw new Error(`Unknown data type ${n}`);for(let a=0;a<s;a++)r[a]=e();return de.makeTensor(r,t,n)}const XG=he({rand_:mje});var F1={exports:{}},fje=F1.exports,p8;function pje(){return p8||(p8=1,(function(t){(function(e,n,s){function r(c){var u=this,h=l();u.next=function(){var f=2091639*u.s0+u.c*23283064365386963e-26;return u.s0=u.s1,u.s1=u.s2,u.s2=f-(u.c=f|0)},u.c=1,u.s0=h(" "),u.s1=h(" "),u.s2=h(" "),u.s0-=h(c),u.s0<0&&(u.s0+=1),u.s1-=h(c),u.s1<0&&(u.s1+=1),u.s2-=h(c),u.s2<0&&(u.s2+=1),h=null}function a(c,u){return u.c=c.c,u.s0=c.s0,u.s1=c.s1,u.s2=c.s2,u}function i(c,u){var h=new r(c),f=u&&u.state,p=h.next;return p.int32=function(){return h.next()*4294967296|0},p.double=function(){return p()+(p()*2097152|0)*11102230246251565e-32},p.quick=p,f&&(typeof f=="object"&&a(f,h),p.state=function(){return a(h,{})}),p}function l(){var c=4022871197,u=function(h){h=String(h);for(var f=0;f<h.length;f++){c+=h.charCodeAt(f);var p=.02519603282416938*c;c=p>>>0,p-=c,p*=c,c=p>>>0,p-=c,c+=p*4294967296}return(c>>>0)*23283064365386963e-26};return u}n&&n.exports?n.exports=i:this.alea=i})(fje,t)})(F1)),F1.exports}var z1={exports:{}},gje=z1.exports,g8;function xje(){return g8||(g8=1,(function(t){(function(e,n,s){function r(l){var c=this,u="";c.x=0,c.y=0,c.z=0,c.w=0,c.next=function(){var f=c.x^c.x<<11;return c.x=c.y,c.y=c.z,c.z=c.w,c.w^=c.w>>>19^f^f>>>8},l===(l|0)?c.x=l:u+=l;for(var h=0;h<u.length+64;h++)c.x^=u.charCodeAt(h)|0,c.next()}function a(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c}function i(l,c){var u=new r(l),h=c&&c.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var p=u.next()>>>11,x=(u.next()>>>0)/4294967296,y=(p+x)/(1<<21);while(y===0);return y},f.int32=u.next,f.quick=f,h&&(typeof h=="object"&&a(h,u),f.state=function(){return a(u,{})}),f}n&&n.exports?n.exports=i:this.xor128=i})(gje,t)})(z1)),z1.exports}var B1={exports:{}},yje=B1.exports,x8;function bje(){return x8||(x8=1,(function(t){(function(e,n,s){function r(l){var c=this,u="";c.next=function(){var f=c.x^c.x>>>2;return c.x=c.y,c.y=c.z,c.z=c.w,c.w=c.v,(c.d=c.d+362437|0)+(c.v=c.v^c.v<<4^(f^f<<1))|0},c.x=0,c.y=0,c.z=0,c.w=0,c.v=0,l===(l|0)?c.x=l:u+=l;for(var h=0;h<u.length+64;h++)c.x^=u.charCodeAt(h)|0,h==u.length&&(c.d=c.x<<10^c.x>>>4),c.next()}function a(l,c){return c.x=l.x,c.y=l.y,c.z=l.z,c.w=l.w,c.v=l.v,c.d=l.d,c}function i(l,c){var u=new r(l),h=c&&c.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var p=u.next()>>>11,x=(u.next()>>>0)/4294967296,y=(p+x)/(1<<21);while(y===0);return y},f.int32=u.next,f.quick=f,h&&(typeof h=="object"&&a(h,u),f.state=function(){return a(u,{})}),f}n&&n.exports?n.exports=i:this.xorwow=i})(yje,t)})(B1)),B1.exports}var U1={exports:{}},vje=U1.exports,y8;function wje(){return y8||(y8=1,(function(t){(function(e,n,s){function r(l){var c=this;c.next=function(){var h=c.x,f=c.i,p,x;return p=h[f],p^=p>>>7,x=p^p<<24,p=h[f+1&7],x^=p^p>>>10,p=h[f+3&7],x^=p^p>>>3,p=h[f+4&7],x^=p^p<<7,p=h[f+7&7],p=p^p<<13,x^=p^p<<9,h[f]=x,c.i=f+1&7,x};function u(h,f){var p,x=[];if(f===(f|0))x[0]=f;else for(f=""+f,p=0;p<f.length;++p)x[p&7]=x[p&7]<<15^f.charCodeAt(p)+x[p+1&7]<<13;for(;x.length<8;)x.push(0);for(p=0;p<8&&x[p]===0;++p);for(p==8?x[7]=-1:x[p],h.x=x,h.i=0,p=256;p>0;--p)h.next()}u(c,l)}function a(l,c){return c.x=l.x.slice(),c.i=l.i,c}function i(l,c){l==null&&(l=+new Date);var u=new r(l),h=c&&c.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var p=u.next()>>>11,x=(u.next()>>>0)/4294967296,y=(p+x)/(1<<21);while(y===0);return y},f.int32=u.next,f.quick=f,h&&(h.x&&a(h,u),f.state=function(){return a(u,{})}),f}n&&n.exports?n.exports=i:this.xorshift7=i})(vje,t)})(U1)),U1.exports}var V1={exports:{}},Nje=V1.exports,b8;function Sje(){return b8||(b8=1,(function(t){(function(e,n,s){function r(l){var c=this;c.next=function(){var h=c.w,f=c.X,p=c.i,x,y;return c.w=h=h+1640531527|0,y=f[p+34&127],x=f[p=p+1&127],y^=y<<13,x^=x<<17,y^=y>>>15,x^=x>>>12,y=f[p]=y^x,c.i=p,y+(h^h>>>16)|0};function u(h,f){var p,x,y,v,b,N=[],S=128;for(f===(f|0)?(x=f,f=null):(f=f+"\0",x=0,S=Math.max(S,f.length)),y=0,v=-32;v<S;++v)f&&(x^=f.charCodeAt((v+32)%f.length)),v===0&&(b=x),x^=x<<10,x^=x>>>15,x^=x<<4,x^=x>>>13,v>=0&&(b=b+1640531527|0,p=N[v&127]^=x+b,y=p==0?y+1:0);for(y>=128&&(N[(f&&f.length||0)&127]=-1),y=127,v=512;v>0;--v)x=N[y+34&127],p=N[y=y+1&127],x^=x<<13,p^=p<<17,x^=x>>>15,p^=p>>>12,N[y]=x^p;h.w=b,h.X=N,h.i=y}u(c,l)}function a(l,c){return c.i=l.i,c.w=l.w,c.X=l.X.slice(),c}function i(l,c){l==null&&(l=+new Date);var u=new r(l),h=c&&c.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var p=u.next()>>>11,x=(u.next()>>>0)/4294967296,y=(p+x)/(1<<21);while(y===0);return y},f.int32=u.next,f.quick=f,h&&(h.X&&a(h,u),f.state=function(){return a(u,{})}),f}n&&n.exports?n.exports=i:this.xor4096=i})(Nje,t)})(V1)),V1.exports}var W1={exports:{}},jje=W1.exports,v8;function kje(){return v8||(v8=1,(function(t){(function(e,n,s){function r(l){var c=this,u="";c.next=function(){var f=c.b,p=c.c,x=c.d,y=c.a;return f=f<<25^f>>>7^p,p=p-x|0,x=x<<24^x>>>8^y,y=y-f|0,c.b=f=f<<20^f>>>12^p,c.c=p=p-x|0,c.d=x<<16^p>>>16^y,c.a=y-f|0},c.a=0,c.b=0,c.c=-1640531527,c.d=1367130551,l===Math.floor(l)?(c.a=l/4294967296|0,c.b=l|0):u+=l;for(var h=0;h<u.length+20;h++)c.b^=u.charCodeAt(h)|0,c.next()}function a(l,c){return c.a=l.a,c.b=l.b,c.c=l.c,c.d=l.d,c}function i(l,c){var u=new r(l),h=c&&c.state,f=function(){return(u.next()>>>0)/4294967296};return f.double=function(){do var p=u.next()>>>11,x=(u.next()>>>0)/4294967296,y=(p+x)/(1<<21);while(y===0);return y},f.int32=u.next,f.quick=f,h&&(typeof h=="object"&&a(h,u),f.state=function(){return a(u,{})}),f}n&&n.exports?n.exports=i:this.tychei=i})(jje,t)})(W1)),W1.exports}var H1={exports:{}};const Cje={},Tje=Object.freeze(Object.defineProperty({__proto__:null,default:Cje},Symbol.toStringTag,{value:"Module"})),_je=Wee(Tje);var Eje=H1.exports,w8;function Aje(){return w8||(w8=1,(function(t){(function(e,n,s){var r=256,a=6,i=52,l="random",c=s.pow(r,a),u=s.pow(2,i),h=u*2,f=r-1,p;function x(T,E,D){var A=[];E=E==!0?{entropy:!0}:E||{};var I=N(b(E.entropy?[T,k(n)]:T??S(),3),A),P=new y(A),$=function(){for(var R=P.g(a),F=c,W=0;R<u;)R=(R+W)*r,F*=r,W=P.g(1);for(;R>=h;)R/=2,F/=2,W>>>=1;return(R+W)/F};return $.int32=function(){return P.g(4)|0},$.quick=function(){return P.g(4)/4294967296},$.double=$,N(k(P.S),n),(E.pass||D||function(R,F,W,q){return q&&(q.S&&v(q,P),R.state=function(){return v(P,{})}),W?(s[l]=R,F):R})($,I,"global"in E?E.global:this==s,E.state)}function y(T){var E,D=T.length,A=this,I=0,P=A.i=A.j=0,$=A.S=[];for(D||(T=[D++]);I<r;)$[I]=I++;for(I=0;I<r;I++)$[I]=$[P=f&P+T[I%D]+(E=$[I])],$[P]=E;(A.g=function(R){for(var F,W=0,q=A.i,X=A.j,z=A.S;R--;)F=z[q=f&q+1],W=W*r+z[f&(z[q]=z[X=f&X+F])+(z[X]=F)];return A.i=q,A.j=X,W})(r)}function v(T,E){return E.i=T.i,E.j=T.j,E.S=T.S.slice(),E}function b(T,E){var D=[],A=typeof T,I;if(E&&A=="object")for(I in T)try{D.push(b(T[I],E-1))}catch{}return D.length?D:A=="string"?T:T+"\0"}function N(T,E){for(var D=T+"",A,I=0;I<D.length;)E[f&I]=f&(A^=E[f&I]*19)+D.charCodeAt(I++);return k(E)}function S(){try{var T;return p&&(T=p.randomBytes)?T=T(r):(T=new Uint8Array(r),(e.crypto||e.msCrypto).getRandomValues(T)),k(T)}catch{var E=e.navigator,D=E&&E.plugins;return[+new Date,e,D,e.screen,k(n)]}}function k(T){return String.fromCharCode.apply(0,T)}if(N(s.random(),n),t.exports){t.exports=x;try{p=_je}catch{}}else s["seed"+l]=x})(typeof self<"u"?self:Eje,[],Math)})(H1)),H1.exports}var _3,N8;function $je(){if(N8)return _3;N8=1;var t=pje(),e=xje(),n=bje(),s=wje(),r=Sje(),a=kje(),i=Aje();return i.alea=t,i.xor128=e,i.xorwow=n,i.xorshift7=s,i.xor4096=r,i.tychei=a,_3=i,_3}var Wp=$je();/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ije=.001,YG=.1;function Rje(t,e,n){return n==null&&(n=G$()),uE(t,e,(s,r)=>q$(s,r,n))}function G$(){return de.backend.floatPrecision()===32?Ije:YG}function uE(t,e,n){let s=!0;if((dr(t)||dr(e))&&(s=!1),dr(t)&&dr(e)&&(s=!0),s){const i=t.constructor.name,l=e.constructor.name;if(i!==l)throw new Error(`Arrays are of different type. Actual: ${i}. Expected: ${l}`)}if(Array.isArray(t)&&Array.isArray(e)){const i=Bl(t),l=Bl(e);if(!xn(i,l))throw new Error(`Arrays have different shapes. Actual: [${i}]. Expected: [${l}]`)}const r=dr(t)?t:zl(t),a=dr(e)?e:zl(e);if(r.length!==a.length)throw new Error(`Arrays have different lengths actual: ${r.length} vs expected: ${a.length}.
Actual:   ${r}.
Expected: ${a}.`);for(let i=0;i<a.length;++i){const l=r[i],c=a[i];if(!n(l,c))throw new Error(`Arrays differ: actual[${i}] = ${l}, expected[${i}] = ${c}.
Actual:   ${r}.
Expected: ${a}.`)}typeof expect<"u"&&expect().nothing()}function Oje(t,e){t().then(()=>e.fail(),()=>e()),typeof expect<"u"&&expect().nothing()}function Dje(t,e){const n=typeof e=="string"||typeof e=="number"||typeof e=="boolean"?[e]:e;return Al(t)||Al(t[0])||Al(e)||Al(e[0])?uE(t,n,(s,r)=>s==r):uE(t,e,(s,r)=>q$(s,r,0))}function Pje(t,e,n){if(n==null&&(n=G$()),!q$(t,e,n))throw new Error(`Numbers differ: actual === ${t}, expected === ${e}`);typeof expect<"u"&&expect().nothing()}function q$(t,e,n){return!isFinite(t)&&!isFinite(e)?!0:!(isNaN(t)||isNaN(e)||Math.abs(t-e)>n)}function Lje(t,e,n){for(let s=0;s<t.length;s++)if(t[s]<e||t[s]>n)throw new Error(`Value out of range:${t[s]} low: ${e}, high: ${n}`)}function Mje(t,e){const n=new Float32Array(t),s=new Float32Array(e);if(n.length!==s.length)throw new Error(`Expected ArrayBuffer to be of length ${s.length}, but it was ${n.length}`);for(let r=0;r<s.length;r++)if(n[r]!==s[r])throw new Error(`Expected ArrayBuffer value at ${r} to be ${s[r]} but got ${n[r]} instead`)}function QG(t){for(let e=0;e<t.length;e++){const n=t[e];Array.isArray(n)?QG(n):t[e]=Rl(n)}return t}function Fje(t){const e=document.createElement("video");return"playsInline"in e&&(e.playsInline=!0),e.muted=!0,e.loop=!0,e.style.position="fixed",e.style.left="0px",e.style.top="0px",e.preload="auto",e.appendChild(t),new Promise(n=>{e.addEventListener("loadeddata",s=>n(e)),e.load()})}async function zje(t){await t.play(),"requestVideoFrameCallback"in t&&await new Promise(e=>{t.requestVideoFrameCallback(e)})}const Bje=Object.freeze(Object.defineProperty({__proto__:null,TEST_EPSILON_FLOAT16:YG,createVideoElement:Fje,encodeStrings:QG,expectArrayBuffersEqual:Mje,expectArraysClose:Rje,expectArraysEqual:Dje,expectNumbersClose:Pje,expectPromiseToFail:Oje,expectValuesInRange:Lje,play:zje,testEpsilon:G$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class K${constructor(e,n,s,r,a){this.mean=e,this.stdDev=n,this.dtype=s,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const i=a||Math.random();this.random=Wp.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const r=this.nextVal;return this.nextVal=NaN,r}let e,n,s=!1;for(;!s;){let r,a,i;do r=2*this.random()-1,a=2*this.random()-1,i=r*r+a*a;while(i>=1||i===0);const l=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*r*l,n=this.mean+this.stdDev*a*l,(!this.truncated||this.isValidTruncated(e))&&(s=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class Uje{constructor(e,n,s,r){this.alpha=e,this.beta=1/n,this.dtype=s;const a=r||Math.random();this.randu=Wp.alea(a.toString()),this.randn=new K$(0,1,s,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,n,s,r,a,i;for(;;){do r=this.randn.nextValue(),i=1+this.c*r;while(i<=0);if(i*=i*i,e=r*r,n=1-.331*e*e,s=.5*e+this.d*(1-i+Math.log(i)),a=this.randu(),a<n||Math.log(a)<s)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class Vje{constructor(e=0,n=1,s,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=s,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=Wp.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wje(t,e,n=1,s="float32",r){if(Ni(t),n==null&&(n=1),s==null&&(s="float32"),s!=="float32"&&s!=="int32")throw new Error(`Unsupported data type ${s}`);const a=new Uje(e,n,s,r),i=on(t,s);for(let l=0;l<i.values.length;l++)i.values[l]=a.nextValue();return i.toTensor()}const ZG=he({randomGamma_:Wje});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hje(t,e=0,n=1,s,r){if(Ni(t),s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const a=new K$(e,n,s,!1,r),i=on(t,s);for(let l=0;l<i.values.length;l++)i.values[l]=a.nextValue();return i.toTensor()}const DS=he({randomNormal_:Hje});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gje(t,e,n){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return DS(t,0,1,e,n)}const JG=he({randomStandardNormal_:Gje});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qje(t,e=0,n=1,s="float32",r){Ni(t);const a=on(t,s),i=new Vje(e,n,null,r);for(let l=0;l<a.values.length;l++)a.values[l]=i.nextValue();return a.toTensor()}const md=he({randomUniform_:qje});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kje(t,e,n,s){return md(t,e,n,"int32",s)}const eq=he({randomUniformInt_:Kje});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _h(t,e,n=1,s="float32"){if(n===0)throw new Error("Cannot have a step of zero");const r={start:t,stop:e,step:n,dtype:s};return de.runKernel(JN,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xje(t){const n={input:te(t,"input","real")};return de.runKernel(eS,n)}const yf=he({real_:Xje});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yje(t){const n={x:te(t,"x","reciprocal")};return de.runKernel(vp,n)}const X$=he({reciprocal_:Yje});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qje(t){const n={x:te(t,"x","relu")};return de.runKernel(wp,n)}const gl=he({relu_:Qje});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zje(t){const n={x:te(t,"x","relu6")};return de.runKernel(Np,n)}const PS=he({relu6_:Zje});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jje(t,e){const s={x:te(t,"x","reverse")},r={dims:e};return de.runKernel(Py,s,r)}const Ji=he({reverse_:Jje});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eke(t){const e=te(t,"x","reverse");return Z(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),Ji(e,0)}const tq=he({reverse1d_:eke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tke(t,e){const n=te(t,"x","reverse");return Z(n.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${n.rank}.`),Ji(n,e)}const nq=he({reverse2d_:tke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nke(t,e){const n=te(t,"x","reverse");return Z(n.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${n.rank}.`),Ji(n,e)}const sq=he({reverse3d_:nke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ske(t,e){const n=te(t,"x","reverse");return Z(n.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${n.rank}.`),Ji(n,e)}const rq=he({reverse4d_:ske});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rke(t){const n={x:te(t,"x","round")};return de.runKernel(Sp,n)}const LS=he({round_:rke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ake(t){const n={x:te(t,"x","rsqrt","float32")};return de.runKernel(jp,n)}const MS=he({rsqrt_:ake});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ike(t){const n={x:te(t,"x","selu")};return de.runKernel(kp,n)}const FS=he({selu_:ike});function oke(t,e,n,s,r,a=[1,1],i="NHWC"){const l=te(t,"x","separableConv2d"),c=te(e,"depthwiseFilter","separableConv2d"),u=te(n,"pointwiseFilter","separableConv2d");let h=l,f=!1;if(l.rank===3&&(f=!0,h=be(l,[1,l.shape[0],l.shape[1],l.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");Z(h.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${h.rank}.`),Z(c.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${c.rank}.`),Z(u.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${c.rank}.`),Z(u.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${u.shape[0]}.`),Z(u.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${u.shape[1]}.`);const p=c.shape[2],x=c.shape[3];Z(u.shape[2]===p*x,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${p*x}, but got ${u.shape[2]}.`);const y=Fp(h,c,s,r,i,a),b=Lc(y,u,1,"valid",i);return f?be(b,[b.shape[1],b.shape[2],b.shape[3]]):b}const zS=he({separableConv2d_:oke});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function lke(t,e){const n=te(t,"x","setdiff1d"),s=te(e,"y","setdiff1d");Z(n.dtype===s.dtype,()=>`x and y should have the same dtype, but got x (${n.dtype}) and y (${s.dtype}).`),Z(n.rank===1,()=>`x should be 1D tensor, but got x (${n.shape}).`),Z(s.rank===1,()=>`y should be 1D tensor, but got y (${s.shape}).`);const r=await n.data(),a=await s.data(),i=new Set(a);let l=0;for(let h=0;h<r.length;h++)i.has(r[h])||l++;const c=new tr([l],n.dtype),u=new tr([l],"int32");for(let h=0,f=0;h<r.length;h++)i.has(r[h])||(c.values[f]=r[h],u.values[f]=h,f++);return[c.toTensor(),u.toTensor()]}const aq=lke;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cke(t){const n={x:te(t,"x","sign")};return de.runKernel(_p,n)}const Y$=he({sign_:cke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uke(t){const n={x:te(t,"x","sin","float32")};return de.runKernel(Cp,n)}const BS=he({sin_:uke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dke(t){const n={x:te(t,"x","sinh")};return de.runKernel(Tp,n)}const US=he({sinh_:dke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hke(t,e,n){const s=te(t,"x","slice1d");return Z(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),Nn(s,[e],[n])}const lb=he({slice1d_:hke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mke(t,e,n){const s=te(t,"x","slice2d");return Z(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),Nn(s,e,n)}const VS=he({slice2d_:mke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fke(t,e,n){const s=te(t,"x","slice3d");return Z(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),Nn(s,e,n)}const cb=he({slice3d_:fke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pke(t,e,n){const s=te(t,"x","slice4d");return Z(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),Nn(s,e,n)}const bf=he({slice4d_:pke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gke(t,e=-1){const n=te(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const s={logits:n},r={dim:e};return de.runKernel(Uy,s,r)}const ub=he({softmax_:gke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xke(t){Z(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return de.runKernel(DN,e)}const db=he({fft_:xke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yke(t){Z(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return de.runKernel(FN,e)}const vf=he({ifft_:yke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bke(t){const e=t.shape[t.shape.length-1],n=t.size/e;let s;if(e<=2){const r=be(t,[n,e]);s=vf(r)}else{const r=[n,2*(e-1)],a=be(yf(t),[n,e]),i=be(Jy(t),[n,e]),l=Ji(Nn(a,[0,1],[n,e-2]),1),c=ge(Ji(Nn(i,[0,1],[n,e-2]),1),Bt(-1)),u=Vs([a,l],1),h=Vs([i,c],1),f=be(Pc(u,h),[r[0],r[1]]);s=vf(f)}if(s=yf(s),t.rank===3&&t.shape[0]!==0){const r=s,a=t.shape[0];s=be(s,[a,s.shape[0]/a,s.shape[1]]),r.dispose()}return s}const WS=he({irfft_:bke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vke(t,e,n=0){const r={x:te(t,"x","split")},a={numOrSizeSplits:e,axis:n};return de.runKernel(By,r,a)}const Ua=he({split_:vke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wke(t,e){Z(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const s=t.size/n;let r;if(e!=null&&e<n){const y=t.shape.map(b=>0),v=t.shape.map(b=>b);v[t.shape.length-1]=e,r=Nn(t,y,v),n=e}else if(e!=null&&e>n){const y=t.shape.map(v=>v);y[t.shape.length-1]=e-n,r=Vs([t,Us(y)],t.shape.length-1),n=e}else r=t;const a=Sn(r),i=be(Pc(r,a),[s,n]),l=db(i),c=Math.floor(n/2)+1,u=yf(l),h=Jy(l),f=Ua(u,[c,n-c],u.shape.length-1),p=Ua(h,[c,n-c],h.shape.length-1),x=r.shape.slice();return x[r.shape.length-1]=c,be(Pc(f[0],p[0]),x)}const hb=he({rfft_:wke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nke(t,e){let n=te(t,"a","squaredDifference"),s=te(e,"b","squaredDifference");[n,s]=Rs(n,s),en(n.shape,s.shape);const r={a:n,b:s},a={};return de.runKernel(Ip,r,a)}const HS=he({squaredDifference_:Nke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ske(t,e){const n=te(t,"x","squeeze","string_or_numeric");return be(n,Xc(n.shape,e).newShape)}const fd=he({squeeze_:Ske});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jke(t,e=0){const n=ix(t,"tensors","stack","string_or_numeric");Z(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&Z(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const s=n,r={axis:e};return de.runKernel(Ey,s,r)}const ka=he({stack_:jke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kke(t,e=0){const s={x:te(t,"x","step")},r={alpha:e};return de.runKernel(Lp,s,r)}const Xh=he({step_:kke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cke(t,e,n,s,r=0,a=0,i=0,l=0,c=0){const h={x:te(t,"x","stridedSlice","string_or_numeric")},f={begin:e,end:n,strides:s,beginMask:r,endMask:a,ellipsisMask:i,newAxisMask:l,shrinkAxisMask:c};return de.runKernel(hS,h,f)}const Q$=he({stridedSlice_:Cke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tke(t){const n={x:te(t,"x","tan","float32")};return de.runKernel(Op,n)}const Z$=he({tan_:Tke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wr(t,e){Vh(t);const n=Bl(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return cd(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uu(t,e,n){if(Vh(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=Bl(t,n);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return cd(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J$(t,e,n){if(Vh(t),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const s=Bl(t,n);if(s.length!==3&&s.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return cd(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iq(t,e,n){if(Vh(t),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const s=Bl(t,n);if(s.length!==4&&s.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return cd(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oq(t,e,n){if(Vh(t),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const s=Bl(t,n);if(s.length!==5&&s.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return cd(t,e,s,n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lq(t,e,n){if(Vh(t),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const s=Bl(t,n);if(s.length!==6&&s.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||s,cd(t,e,s,n)}function eI(t,e,n){const s=e.rank>1?e.shape[e.rank-1]:1,r=e.rank>1?e.rank-1:1,a=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${s}, and batchDim: ${r}.`;if(n.rank<r)throw new Error(a+` update.rank < ${r}. `);if(t.length<s+(n.rank-r))throw new Error(a+` Output shape length < ${s+(n.rank-r)}`);if(n.rank!==r+t.length-s)throw new Error(a+` update.rank != ${r+t.length-s}`);for(let i=0;i<r;++i)if(n.shape[i]!==e.shape[i])throw new Error(a+` updates.shape[${i}] (${n.shape[i]}) != indices.shape[${i}] (${e.shape[i]}).`);for(let i=0;i<n.rank-r;++i)if(n.shape[i+r]!==t[i+s])throw new Error(a+` updates.shape[${i+r}] (${n.shape[i+r]}) != shape[${i+r}] (${t[i+r]})`)}function GS(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}eI(n,e,t)}function pd(t,e,n){const s=e.shape.length,r=s>1?e.shape[s-1]:1,a=n.length;let i=1;for(let f=r;f<a;++f)i*=n[f];const l=r<1?1:r,c=ze(e.shape)/l,u=[...Ut(n.slice(0,r)),1],h=ze(n);return{sliceRank:r,numUpdates:c,sliceSize:i,strides:u,outputSize:h}}const _ke=Object.freeze(Object.defineProperty({__proto__:null,calculateShapes:pd,validateInput:GS,validateUpdateShape:eI},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eke(t,e,n){const s=te(t,"tensor","tensorScatterupdate"),r=te(e,"indices","tensorScatterupdate","int32"),a=te(n,"updates","tensorScatterupdate");if(GS(a,r,s.shape),s.dtype!==a.dtype)throw new Error(`tensor and updates must have the same dtype, instead they are ${s.dtype} and ${a.dtype}.`);const i={tensor:s,indices:r,updates:a},l={};return de.runKernel(rS,i,l)}const cq=he({tensorScatterUpdate_:Eke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ake(t,e=1,n=!0){const s=te(t,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const r=s.shape[s.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got ${e}`);const a={x:s},i={k:e,sorted:n},[l,c]=de.runKernel(gS,a,i);return{values:l,indices:c}}const tI=he({topk_:Ake});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ke(t,e=0,n=1,s,r){if(Ni(t),s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const a=new K$(e,n,s,!0,r),i=on(t,s);for(let l=0;l<i.values.length;l++)i.values[l]=a.nextValue();return i.toTensor()}const qS=he({truncatedNormal_:$ke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ike(t,e=0){const n=te(t,"x","unique","string_or_numeric");Z(n.rank>0,()=>"The input tensor must be at least 1D");const s={x:n},r={axis:e},[a,i]=de.runKernel(yS,s,r);return{values:a,indices:i}}const nI=he({unique_:Ike});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rke(t,e,n){const s=te(t,"x","unsortedSegmentSum"),r=te(e,"segmentIds","unsortedSegmentSum","int32");Z(vh(n),()=>"numSegments must be of dtype int");const a={x:s,segmentIds:r},i={numSegments:n};return de.runKernel(Hy,a,i)}const KS=he({unsortedSegmentSum_:Rke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oke(t,e=0){const n=te(t,"x","unstack","string_or_numeric");Z(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const s={value:n},r={axis:e};return de.runKernel(Wy,s,r)}const eo=he({unstack_:Oke});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uq(t,e){return OS(t,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sI(t,e=!0,n,s){return de.makeVariable(t,e,n,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XS(t,e){const n=[];for(let a=0;a<e.length;a++)e[a]&&n.push(a);const s=on(t,"int32"),r=on([n.length,t.length],"int32");for(let a=0;a<n.length;a++){const i=s.indexToLoc(n[a]),l=a*t.length;r.values.set(i,l)}return r.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Dke(t){const e=te(t,"condition","whereAsync","bool"),n=await e.data(),s=XS(e.shape,n);return t!==e&&e.dispose(),s}const rI=Dke;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Pke(t,e,n){const s=te(t,"tensor","boolMask"),r=te(e,"mask","boolMask","bool"),a=n??0,i=r.rank,l=s.shape;Z(i>0,()=>"mask cannot be scalar"),Qr(l.slice(a,a+i),r.shape,"mask's shape must match the first K dimensions of tensor's shape,");let c=1;for(let v=a;v<a+i;v++)c*=l[v];const u=l.slice(0,a).concat([c],l.slice(a+i)),h=be(s,u),f=be(r,[-1]),p=await rI(f),x=fd(p,[1]),y=Vp(h,x,a);return t!==s&&s.dispose(),e!==r&&r.dispose(),x.dispose(),h.dispose(),f.dispose(),p.dispose(),y}const dq=Pke;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lke(t,e,n){const s=te(t,"x","transpose");if(e==null&&(e=s.shape.map((i,l)=>l).reverse()),Z(s.rank===e.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${e}.`),e.forEach(i=>{Z(i>=0&&i<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${e}`)}),s.rank<=1)return s.clone();const r={x:s},a={perm:e};return s.dtype==="complex64"?Ee(()=>{let i=yf(s),l=Jy(s);return i=de.runKernel(ch,{x:i},a),l=de.runKernel(ch,{x:l},a),n&&(l=gs(l)),Pc(i,l)}):de.runKernel(ch,r,a)}const bn=he({transpose_:Lke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mke(t,e,n,s,r=!0){const a=te(t,"v","movingAverage"),i=te(e,"x","movingAverage"),l=te(n,"decay","movingAverage");oG(a,i),Z(xn(a.shape,i.shape),()=>"Shape mismatch in v and x");const c=Bt(1),u=Tt(c,l);let h=ge(Tt(i,a),u);if(r){Z(s!=null,()=>"When using zeroDebias: true, step is required.");const f=te(s,"step","movingAverage");h=Mt(h,Tt(c,Ul(l,f)))}return nt(a,h)}const hq=he({movingAverage_:Mke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fke(t,e,n){Ni(n);const s=te(t,"indices","scatterND","int32"),r=te(e,"updates","scatterND");GS(r,s,n);const a={indices:s,updates:r},i={shape:n};return de.runKernel(sS,a,i)}const mq=he({scatterND_:Fke});function zke(t,e,n,s){if(t.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${t.dtype}.`);if(t.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${t.shape}.`);const r=t.rank>0?t.shape[0]:1,a=t.rank>1?t.shape[1]:1;if(n.length!==a)throw new Error(`outputShape has incorrect number of elements:, ${n.length}, should be: ${a}.`);const i=e.size;if(!(e.rank===0||e.rank===1&&i===r))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${r}]`);if(e.dtype!==s.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bke(t,e,n,s=0){Ni(n);const r=te(t,"sparseIndices","sparseToDense","int32"),a=te(e,"sparseValues","sparseToDense","string_or_numeric"),i=te(s,"defaultValue","sparseToDense",a.dtype);zke(r,a,n,i);const l={sparseIndices:r,sparseValues:a,defaultValue:i},c={outputShape:n};return de.runKernel(uS,l,c)}const fq=he({sparseToDense_:Bke});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uke(t,e){const n=te(e,"indices","gatherND","int32"),r={params:te(t,"x","gatherND","string_or_numeric"),indices:n};return de.runKernel(MN,r)}const pq=he({gatherND_:Uke});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vke(t,e){if(e==null)return t.shape.slice();if(xn(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let s=0;s<t.shape.length;s++)e[s]==null&&t.shape[s]!=null?n.push(t.shape[s]):n.push(e[s]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wke(t,e,n,s){const r=te(t,"x","dropout");if(Z(r.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),Z(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof Tn?r.clone():r;const a=Vke(r,n),i=1-e,l=Mt(Up(nt(md(a,0,1,"float32",s),i)),i);return ge(r,l)}const aI=he({dropout_:Wke});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iI(t){return Math.floor(Math.pow(2,Math.ceil(Math.log(t)/Math.log(2))))}function YS(t,e,n){const s=1-t%2,r=new Float32Array(t);for(let a=0;a<t;++a){const i=2*Math.PI*a/(t+s-1);r[a]=e-n*Math.cos(i)}return Wr(r,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Hke(t,e,n=1){const s=te(t,"predictions","inTopK"),r=te(e,"targets","inTopK");Z(s.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${s.rank}`),Z(s.rank-1===r.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${s.rank} and targets rank ${r.rank}`),Qr(s.shape.slice(0,s.shape.length-1),r.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const a=s.shape[s.shape.length-1];Z(n>0&&n<=a,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${a}), but got ${n}`);const i=await s.data(),l=await r.data(),[c,u]=[i.length/a,a],h=Er("bool",c);for(let f=0;f<c;f++){const p=f*u,x=i.subarray(p,p+u),y=[];for(let v=0;v<x.length;v++)y.push({value:x[v],index:v});y.sort((v,b)=>b.value-v.value),h[f]=0;for(let v=0;v<n;v++)if(y[v].index===l[f]){h[f]=1;break}}return t!==s&&s.dispose(),e!==r&&r.dispose(),pi(h,r.shape,"bool")}const gq=Hke;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gke(t,e,n,s,r,a="NHWC",i){let l=t;t.rank===3&&(l=be(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let c=e;c.rank===3&&(c=be(e,[1,e.shape[0],e.shape[1],e.shape[2]])),Z(l.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${l.shape}.`),Z(c.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${c.shape}.`),Z(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const u=a==="NHWC"?l.shape[3]:l.shape[1],h=a==="NHWC"?c.shape[3]:c.shape[1];Z(u===n[2],()=>`Error in conv2dDerFilter: depth of input ${u}) must match input depth in filter (${n[2]}.`),Z(h===n[3],()=>`Error in conv2dDerFilter: depth of dy (${h}) must match output depth for filter (${n[3]}).`),Ta("conv2dDerFilter",r,i);const f={x:l,dy:c},p={strides:s,pad:r,dataFormat:a,dimRoundingMode:i,filterShape:n};return de.runKernel(NN,f,p)}const oI=he({conv2DBackpropFilter_:Gke});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QS(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return ge(t,Xh(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function ZS(t,e){let n=e;const s=sr(t.shape,e.shape);return s.length>0&&(n=$t(n,s)),be(n,t.shape)}function JS(t,e,n,s){if(e==="linear")return t;if(e==="relu")return gl(t);if(e==="elu")return zp(t);if(e==="relu6")return PS(t);if(e==="prelu")return ob(t,n);if(e==="leakyrelu")return eb(t,s);if(e==="sigmoid")return rl(t);throw new Error(`Unknown fused activation ${e}.`)}const ej=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qke({x:t,filter:e,strides:n,pad:s,dataFormat:r="NHWC",dilations:a=[1,1],dimRoundingMode:i,bias:l,activation:c="linear",preluActivationWeights:u,leakyreluAlpha:h}){if(c=c||"linear",ej(de.state.gradientDepth,c)===!1){Z(r==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${r} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let D=Lc(t,e,n,s,r,a,i);return l!=null&&(D=nt(D,l)),JS(D,c,u,h)}const f=te(t,"x","conv2d","float32"),p=te(e,"filter","conv2d","float32");let x=f,y=!1;f.rank===3&&(y=!0,x=be(f,[1,f.shape[0],f.shape[1],f.shape[2]])),Z(x.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${x.rank}.`),Z(p.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${p.rank}.`),Ta("fused conv2d",s,i);const v=r==="NHWC"?x.shape[3]:x.shape[1];Z(p.shape[2]===v,()=>`Error in conv2d: depth of input (${v}) must match input depth for filter ${p.shape[2]}.`),Z(Zr(n,a),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`);const b=Or(x.shape,p.shape,n,a,s,i);let N;l!=null&&(N=te(l,"bias","fused conv2d"),[N]=Rs(N,f),r==="NHWC"?en(b.outShape,N.shape):(Z(N.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${N.shape.length}.`),Z(N.shape.length===0||N.shape[0]===b.outChannels||N.shape[0]===1,()=>`Error in fused conv2d: bias shape (${N.shape}) is not compatible with the number of output channels (${b.outChannels})`)));let S;if(u!=null){const D=u.shape;if(Z(D.length<=1||D.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${D.length}.`),D.length===1)Z(D[0]===1||D[0]===b.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${D}) is not compatible with the number of output channels (${b.outChannels}).`);else if(D.length===3)try{en(D,b.outShape)}catch{const I=`Error in fused conv2d: PReLU activation weights (${D}) is not compatible with the output shape of the conv2d (${b.outShape}).`;throw Error(I)}S=te(u,"prelu weights","fused conv2d")}const k=(D,A)=>{Z(r==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${r} but only NHWC is currently supported.`);const[I,P,$,R]=A,F=QS(D,$,c);Z(Qu(a),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`);const W=k$(P.shape,F,I,n,s),q=oI(P,F,I.shape,n,s),X=[W,q];if(R!=null){const z=ZS(R,F);X.push(z)}return X},T={x,filter:p,bias:N,preluActivationWeights:S},E={strides:n,pad:s,dataFormat:r,dilations:a,dimRoundingMode:i,activation:c,leakyreluAlpha:h};return l==null?Vl((A,I,P)=>{let $=de.runKernel(tx,T,E);return P([I,A,$]),y&&($=be($,[$.shape[1],$.shape[2],$.shape[3]])),{value:$,gradFunc:k}})(x,p):Vl((A,I,P,$)=>{let R=de.runKernel(tx,T,E);return $([I,A,R,P]),y&&(R=be(R,[R.shape[1],R.shape[2],R.shape[3]])),{value:R,gradFunc:k}})(x,p,N)}const xq=he({fusedConv2d_:qke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kke(t,e,n,s,r,a=[1,1],i){let l=t;t.rank===3&&(l=be(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let c=e;c.rank===3&&(c=be(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={x:l,dy:c},h={strides:s,pad:r,dimRoundingMode:i,dilations:a,filterShape:n};return de.runKernel(EN,u,h)}const yq=he({depthwiseConv2dNativeBackpropFilter_:Kke});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xke(t,e,n,s,r,a=[1,1],i){let l=e,c=!1;e.rank===3&&(c=!0,l=be(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const u={dy:l,filter:n},h={strides:s,pad:r,dimRoundingMode:i,dilations:a,inputShape:t},f=de.runKernel(AN,u,h);return c?be(f,[f.shape[1],f.shape[2],f.shape[3]]):f}const bq=he({depthwiseConv2dNativeBackpropInput_:Xke});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yke({x:t,filter:e,strides:n,pad:s,dataFormat:r="NHWC",dilations:a=[1,1],dimRoundingMode:i,bias:l,activation:c="linear",preluActivationWeights:u,leakyreluAlpha:h}){if(ej(de.state.gradientDepth,c)===!1){let E=Fp(t,e,n,s,r,a,i);return l!=null&&(E=nt(E,l)),JS(E,c,u,h)}const f=te(t,"x","depthwiseConv2d","float32"),p=te(e,"filter","depthwiseConv2d","float32");let x=f,y=!1;f.rank===3&&(y=!0,x=be(f,[1,f.shape[0],f.shape[1],f.shape[2]])),Z(x.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${x.rank}.`),Z(p.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${p.rank}.`),Z(x.shape[3]===p.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${x.shape[3]}) must match the inChannels dimension in filter ${p.shape[2]}.`),a==null&&(a=[1,1]),Z(Zr(n,a),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${n} and dilations '${a}'`),Ta("fused depthwiseConv2d",s,i);const v=Or(x.shape,p.shape,n,a,s,i,!0);let b;l!=null&&(b=te(l,"bias","fused conv2d"),[b]=Rs(b,f),en(v.outShape,b.shape));let N;u!=null&&(N=te(u,"prelu weights","fused depthwiseConv2d"));const S=(E,D)=>{Z(Qu(a),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[A,I,P,$]=D,R=QS(E,P,c),F=bq(I.shape,R,A,n,s,a,i),W=yq(I,R,A.shape,n,s,a,i);if($!=null){const q=ZS(b,R);return[F,W,q]}return[F,W]},k={x,filter:p,bias:b,preluActivationWeights:N},T={strides:n,pad:s,dataFormat:r,dilations:a,dimRoundingMode:i,activation:c,leakyreluAlpha:h};return l==null?Vl((D,A,I)=>{let P=de.runKernel(nx,k,T);return I([A,D,P]),y&&(P=be(P,[P.shape[1],P.shape[2],P.shape[3]])),{value:P,gradFunc:S}})(x,p):Vl((D,A,I,P)=>{let $=de.runKernel(nx,k,T);return P([A,D,$,I]),y&&($=be($,[$.shape[1],$.shape[2],$.shape[3]])),{value:$,gradFunc:S}})(x,p,b)}const Qke=he({fusedDepthwiseConv2d_:Yke});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zke({a:t,b:e,transposeA:n=!1,transposeB:s=!1,bias:r,activation:a="linear",preluActivationWeights:i,leakyreluAlpha:l=.2}){if(ej(de.state.gradientDepth,a)===!1){let R=mn(t,e,n,s);return r!=null&&(R=nt(R,r)),JS(R,a,i,l)}let c=te(t,"a","fused matMul"),u=te(e,"b","fused matMul");[c,u]=Rs(c,u);const h=n?c.shape[c.rank-2]:c.shape[c.rank-1],f=s?u.shape[u.rank-1]:u.shape[u.rank-2],p=n?c.shape[c.rank-1]:c.shape[c.rank-2],x=s?u.shape[u.rank-2]:u.shape[u.rank-1],y=c.shape.slice(0,-2),v=u.shape.slice(0,-2),b=ze(y),N=ze(v);Z(h===f,()=>`Error in fused matMul: inner shapes (${h}) and (${f}) of Tensors with shapes ${c.shape} and ${u.shape} and transposeA=${n} and transposeB=${s} must match.`);const k=en(c.shape.slice(0,-2),u.shape.slice(0,-2)).concat([p,x]),T=n?be(c,[b,h,p]):be(c,[b,p,h]),E=s?be(u,[N,x,f]):be(u,[N,f,x]);let D;r!=null&&(D=te(r,"bias","fused matMul"),[D]=Rs(D,c),en(k,D.shape));let A;i!=null&&(A=te(i,"prelu weights","fused matMul"));const I=(R,F)=>{const[W,q,X,z]=F,K=QS(be(R,X.shape),X,a);let H,Y;if(!n&&!s?(H=mn(K,q,!1,!0),Y=mn(W,K,!0,!1)):!n&&s?(H=mn(K,q,!1,!1),Y=mn(K,W,!0,!1)):n&&!s?(H=mn(q,K,!1,!0),Y=mn(W,K,!1,!1)):(H=mn(q,K,!0,!0),Y=mn(K,W,!0,!0)),r!=null){const B=ZS(z,K);return[H,Y,B]}else return[H,Y]},P={a:T,b:E,bias:D,preluActivationWeights:A},$={transposeA:n,transposeB:s,activation:a,leakyreluAlpha:l};return r==null?Vl((F,W,q)=>{const X=de.runKernel(ex,P,$);return q([F,W,X]),{value:be(X,k),gradFunc:I}})(T,E):Vl((F,W,q,X)=>{const z=de.runKernel(ex,P,$);return X([F,W,z,q]),{value:be(z,k),gradFunc:I}})(T,E,D)}const dE=he({fusedMatMul_:Zke});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vq=Object.freeze(Object.defineProperty({__proto__:null,conv2d:xq,depthwiseConv2d:Qke,matMul:dE},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jke(t){return YS(t,.54,.46)}const eCe=he({hammingWindow_:Jke});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tCe(t){return YS(t,.5,.5)}const wq=he({hannWindow_:tCe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nCe(t,e,n,s=!1,r=0){let a=0;const i=[];for(;a+e<=t.size;)i.push(Nn(t,a,e)),a+=n;if(s)for(;a<t.size;){const l=a+e-t.size,c=Vs([Nn(t,a,e-l),qh([l],r)]);i.push(c),a+=n}return i.length===0?Uu([],[0,e]):be(Vs(i),[i.length,e])}const Nq=he({frame_:nCe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sCe(t,e,n,s,r=wq){s==null&&(s=iI(e));const a=Nq(t,e,n),i=ge(a,r(e));return hb(i,s)}const rCe=he({stft_:sCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aCe(t,e,n,s,r="bilinear",a=0){const i=te(t,"image","cropAndResize"),l=te(e,"boxes","cropAndResize","float32"),c=te(n,"boxInd","cropAndResize","int32"),u=l.shape[0];Z(i.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${i.rank}.`),Z(l.rank===2&&l.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${u},4] but had shape ${l.shape}.`),Z(c.rank===1&&c.shape[0]===u,()=>`Error in cropAndResize: boxInd must be have size [${u}] but had shape ${l.shape}.`),Z(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),Z(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),Z(r==="bilinear"||r==="nearest",()=>`method must be bilinear or nearest, but was ${r}`);const h={image:i,boxes:l,boxInd:c},f={method:r,extrapolationValue:a,cropSize:s};return de.runKernel(CN,h,f)}const iCe=he({cropAndResize_:aCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oCe(t){const e=te(t,"image","flipLeftRight","float32");Z(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return de.runKernel(LN,n,{})}const lCe=he({flipLeftRight_:oCe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cCe(t){const e=te(t,"image","grayscaleToRGB"),n=e.rank-1,s=e.shape[n];Z(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),Z(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const r=new Array(e.rank);return r.fill(1,0,n),r[n]=3,Ui(e,r)}const uCe=he({grayscaleToRGB_:cCe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dCe(t){const e=te(t,"image","RGBToGrayscale"),n=e.rank-1,s=e.shape[n];Z(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),Z(s===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${s}.`);const r=e.dtype,a=ft(e,"float32"),i=Wr([.2989,.587,.114]);let l;switch(e.rank){case 2:l=Wd("ij,j->i",a,i);break;case 3:l=Wd("ijk,k->ij",a,i);break;case 4:l=Wd("ijkl,l->ijk",a,i);break;case 5:l=Wd("ijklm,m->ijkl",a,i);break;case 6:l=Wd("ijklmn,n->ijklm",a,i);break;default:throw new Error("Not a valid tensor rank.")}return l=Br(l,-1),ft(l,r)}const hCe=he({rgbToGrayscale_:dCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mCe(t,e,n=0,s=.5){const r=te(t,"image","rotateWithOffset","float32");Z(r.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${r.rank}.`);const a={image:r},i={radians:e,fillValue:n,center:s};return de.runKernel(bS,a,i)}const fCe=he({rotateWithOffset_:mCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hp(t,e,n,s,r,a){s==null&&(s=.5),r==null&&(r=Number.NEGATIVE_INFINITY),a==null&&(a=0);const i=t.shape[0];return n=Math.min(n,i),Z(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),Z(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),Z(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),Z(e.rank===1,()=>"scores must be a 1D tensor"),Z(e.shape[0]===i,()=>`scores has incompatible shape with boxes. Expected ${i}, but was ${e.shape[0]}`),Z(0<=a&&a<=1,()=>`softNmsSigma must be in [0, 1], but was '${a}'`),{maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pCe(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const a=te(t,"boxes","nonMaxSuppression","float32"),i=te(e,"scores","nonMaxSuppression","float32"),l=Hp(a,i,n,s,r);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold;const c={maxOutputSize:n,iouThreshold:s,scoreThreshold:r};return de.runKernel(qN,{boxes:a,scores:i},c)}const gCe=he({nonMaxSuppression_:pCe});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xCe(t,e,n){const s=yCe(t,e,n),r=s<0?-(s+1):s;t.splice(r,0,e)}function yCe(t,e,n){return vCe(t,e,n||bCe)}function bCe(t,e){return t>e?1:t<e?-1:0}function vCe(t,e,n){let s=0,r=t.length,a=0,i=!1;for(;s<r;){a=s+(r-s>>>1);const l=n(e,t[a]);l>0?s=a+1:(r=a,i=!l)}return i?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tj(t,e,n,s,r){return lI(t,e,n,s,r,0)}function nj(t,e,n,s,r,a){return lI(t,e,n,s,r,0,!1,a,!0)}function sj(t,e,n,s,r,a){return lI(t,e,n,s,r,a,!0)}function lI(t,e,n,s,r,a,i=!1,l=!1,c=!1){const u=[];for(let b=0;b<e.length;b++)e[b]>r&&u.push({score:e[b],boxIndex:b,suppressBeginIndex:0});u.sort(S8);const h=a>0?-.5/a:0,f=[],p=[];for(;f.length<n&&u.length>0;){const b=u.pop(),{score:N,boxIndex:S,suppressBeginIndex:k}=b;if(N<r)break;let T=!1;for(let E=f.length-1;E>=k;--E){const D=wCe(t,S,f[E]);if(D>=s){T=!0;break}if(b.score=b.score*NCe(s,h,D),b.score<=r)break}b.suppressBeginIndex=f.length,T||(b.score===N?(f.push(S),p.push(b.score)):b.score>r&&xCe(u,b,S8))}const x=f.length,y=n-x;l&&y>0&&(f.push(...new Array(y).fill(0)),p.push(...new Array(y).fill(0)));const v={selectedIndices:f};return i&&(v.selectedScores=p),c&&(v.validOutputs=x),v}function wCe(t,e,n){const s=t.subarray(e*4,e*4+4),r=t.subarray(n*4,n*4+4),a=Math.min(s[0],s[2]),i=Math.min(s[1],s[3]),l=Math.max(s[0],s[2]),c=Math.max(s[1],s[3]),u=Math.min(r[0],r[2]),h=Math.min(r[1],r[3]),f=Math.max(r[0],r[2]),p=Math.max(r[1],r[3]),x=(l-a)*(c-i),y=(f-u)*(p-h);if(x<=0||y<=0)return 0;const v=Math.max(a,u),b=Math.max(i,h),N=Math.min(l,f),S=Math.min(c,p),k=Math.max(N-v,0)*Math.max(S-b,0);return k/(x+y-k)}function NCe(t,e,n){const s=Math.exp(e*n*n);return n<=t?s:0}function S8(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function SCe(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const a=te(t,"boxes","nonMaxSuppressionAsync"),i=te(e,"scores","nonMaxSuppressionAsync"),l=Hp(a,i,n,s,r);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold;const c=await Promise.all([a.data(),i.data()]),u=c[0],h=c[1],{selectedIndices:f}=tj(u,h,n,s,r);return a!==t&&a.dispose(),i!==e&&i.dispose(),Wr(f,"int32")}const jCe=SCe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kCe(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,a=0){const i=te(t,"boxes","nonMaxSuppression"),l=te(e,"scores","nonMaxSuppression"),c=Hp(i,l,n,s,r,a);n=c.maxOutputSize,s=c.iouThreshold,r=c.scoreThreshold,a=c.softNmsSigma;const u={boxes:i,scores:l},h={maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:a},f=de.runKernel(XN,u,h);return{selectedIndices:f[0],selectedScores:f[1]}}const CCe=he({nonMaxSuppressionWithScore_:kCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function TCe(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,a=0){const i=te(t,"boxes","nonMaxSuppressionAsync"),l=te(e,"scores","nonMaxSuppressionAsync"),c=Hp(i,l,n,s,r,a);n=c.maxOutputSize,s=c.iouThreshold,r=c.scoreThreshold,a=c.softNmsSigma;const u=await Promise.all([i.data(),l.data()]),h=u[0],f=u[1],{selectedIndices:p,selectedScores:x}=sj(h,f,n,s,r,a);return i!==t&&i.dispose(),l!==e&&l.dispose(),{selectedIndices:Wr(p,"int32"),selectedScores:Wr(x)}}const _Ce=TCe;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ECe(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,a=!1){const i=te(t,"boxes","nonMaxSuppression"),l=te(e,"scores","nonMaxSuppression"),c=Hp(i,l,n,s,r,null),u=c.maxOutputSize,h=c.iouThreshold,f=c.scoreThreshold,p={boxes:i,scores:l},x={maxOutputSize:u,iouThreshold:h,scoreThreshold:f,padToMaxOutputSize:a},y=de.runKernel(KN,p,x);return{selectedIndices:y[0],validOutputs:y[1]}}const ACe=he({nonMaxSuppressionPadded_:ECe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function $Ce(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,a=!1){const i=te(t,"boxes","nonMaxSuppressionAsync"),l=te(e,"scores","nonMaxSuppressionAsync"),c=Hp(i,l,n,s,r,null),u=c.maxOutputSize,h=c.iouThreshold,f=c.scoreThreshold,[p,x]=await Promise.all([i.data(),l.data()]),{selectedIndices:y,validOutputs:v}=nj(p,x,u,h,f,a);return i!==t&&i.dispose(),l!==e&&l.dispose(),{selectedIndices:Wr(y,"int32"),validOutputs:Bt(v,"int32")}}const ICe=$Ce;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RCe(t,e,n=!1,s=!1){const r=te(t,"images","resizeBilinear");Z(r.rank===3||r.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${r.rank}.`),Z(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),Z(s===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let a=r,i=!1;r.rank===3&&(i=!0,a=be(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const l={images:a},c={alignCorners:n,halfPixelCenters:s,size:e},u=de.runKernel(Dy,l,c);return i?be(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const Sq=he({resizeBilinear_:RCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OCe(t,e,n=!1,s=!1){const r=te(t,"images","resizeNearestNeighbor");Z(r.rank===3||r.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${r.rank}.`),Z(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),Z(r.dtype==="float32"||r.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),Z(s===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let a=r,i=!1;r.rank===3&&(i=!0,a=be(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const l={images:a},c={alignCorners:n,halfPixelCenters:s,size:e},u=de.runKernel(Oy,l,c);return i?be(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const jq=he({resizeNearestNeighbor_:OCe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DCe(t,e="binary",n=!1,s=.5){const r=te(t,"image","threshold"),a=.2989,i=.587,l=.114,c=r.shape[0]*r.shape[1];let u=ge(Wr([s]),255),h,f,p,x;if(Z(r.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${r.rank}.`),Z(r.shape[2]===3||r.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${r.shape[2]}.`),Z(r.dtype==="int32"||r.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${r.dtype}.`),Z(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),r.shape[2]===3){[h,f,p]=Ua(r,[1,1,1],-1);const b=ge(h,a),N=ge(f,i),S=ge(p,l);x=nt(nt(b,N),S)}else x=t;if(e==="otsu"){const b=b$(ft(LS(x),"int32"),pi([]),256);u=PCe(b,c)}const y=n?hd(x,u):_a(x,u);return ft(ge(y,255),"int32")}function PCe(t,e){let n=Wr([-1]),s=Wr([0]),r=Wr([0]),a,i,l,c,u,h;for(let f=0;f<t.size-1;f++){a=Nn(t,0,f+1),i=Nn(t,f+1),u=Mt($t(a),e),h=Mt($t(i),e);const p=$t(ge(a,_h(0,a.size)));l=Mt(p,$t(a));const x=qh(i.shape,a.size),y=nt(_h(0,i.size),x),v=ge(i,y);c=Mt($t(v),$t(i));const b=Tt(l,c),N=Tt(l,c),S=ge(u,h);r=ge(ge(S,b),N);const k=_a(r,s);s=_r(k,r,s),n=_r(k,Wr([f]),n)}return n}const LCe=he({threshold_:DCe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MCe(t,e,n="nearest",s="constant",r=0,a){const i=te(t,"image","transform","float32"),l=te(e,"transforms","transform","float32");Z(i.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${i.rank}.`),Z(l.rank===2&&(l.shape[0]===i.shape[0]||l.shape[0]===1)&&l.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),Z(a==null||a.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${a}.`);const c={image:i,transforms:l},u={interpolation:n,fillMode:s,fillValue:r,outputShape:a};return de.runKernel(xS,c,u)}const FCe=he({transform_:MCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zCe(t,e,n){const s=te(t,"a","bandPart");Z(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const r=s.shape,[a,i]=s.shape.slice(-2);let l,c;typeof e=="number"?(Z(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),Z(e<=a,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${a}).`),l=te(e<0?a:e,"numLower","bandPart")):(Z(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),l=_r(gf(e,0),a,Ju(e,a))),typeof n=="number"?(Z(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),Z(n<=i,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${i}).`),c=te(n<0?i:n,"numUpper","bandPart")):(Z(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),c=_r(gf(n,0),i,Ju(n,i)));const u=be(_h(0,a,1,"int32"),[-1,1]),h=_h(0,i,1,"int32"),f=Tt(u,h),p=Io(hd(f,l),Jc(f,gs(c))),x=Us([a,i],s.dtype);return be(ka(eo(be(s,[-1,a,i])).map(y=>_r(p,y,x))),r)}const BCe=he({bandPart_:zCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UCe(t){let e;if(Array.isArray(t)){e=!1,Z(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=t[0].shape[0];for(let a=1;a<t.length;++a)Z(t[a].shape[0]===r,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[a].shape[0]} vs. ${r})`)}else e=!0,t=Ua(t,t.shape[0],0).map(r=>fd(r,[0]));Z(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],s=t;for(let r=0;r<t.length;++r)n.push(de.tidy(()=>{let a=s[r];if(r>0)for(let i=0;i<r;++i){const l=ge($t(ge(n[i],a)),n[i]);a=Tt(a,l)}return Mt(a,Bp(a,"euclidean"))}));return e?ka(n,0):n}const VCe=he({gramSchmidt_:UCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WCe(t,e=!1){if(Z(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return j8(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((c,u)=>c*u),s=eo(be(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),r=[],a=[];s.forEach(c=>{const[u,h]=j8(c,e);r.push(u),a.push(h)});const i=be(ka(r,0),t.shape),l=be(ka(a,0),t.shape);return[i,l]}}function j8(t,e=!1){return de.tidy(()=>{Z(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],s=t.shape[1];let r=AS(n),a=Ol(t);const i=Uu([[1]],[1,1]);let l=Ol(i);const c=n>=s?s:n;for(let u=0;u<c;++u){const h=a,f=l,p=r;[l,a,r]=de.tidy(()=>{const x=Nn(a,[u,u],[n-u,1]),y=Bp(x),v=Nn(a,[u,u],[1,1]),b=_r(_a(v,0),Uu([[-1]]),Uu([[1]])),N=Tt(v,ge(b,y)),S=Mt(x,N);S.shape[0]===1?l=Ol(i):l=Vs([i,Nn(S,[1,0],[S.shape[0]-1,S.shape[1]])],0);const k=gs(Mt(mn(b,N),y)),T=Nn(a,[u,0],[n-u,s]),E=ge(k,l),D=bn(l);if(u===0)a=Tt(T,mn(E,mn(D,T)));else{const P=Tt(T,mn(E,mn(D,T)));a=Vs([Nn(a,[0,0],[u,s]),P],0)}const A=bn(E),I=Nn(r,[0,u],[n,r.shape[1]-u]);if(u===0)r=Tt(I,mn(mn(I,l),A));else{const P=Tt(I,mn(mn(I,l),A));r=Vs([Nn(r,[0,0],[n,u]),P],1)}return[l,a,r]}),Jt([h,f,p])}return!e&&n>s&&(r=Nn(r,[0,0],[n,s]),a=Nn(a,[0,0],[s,s])),[r,a]})}const HCe=he({qr_:WCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Na;(function(t){t[t.NONE=0]="NONE",t[t.MEAN=1]="MEAN",t[t.SUM=2]="SUM",t[t.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(Na||(Na={}));function GCe(t,e,n=Na.SUM_BY_NONZERO_WEIGHTS){const s=te(t,"losses","computeWeightedLoss");let r=null;e!=null&&(r=te(e,"weights","computeWeightedLoss"));const a=r==null?s:ge(s,r);if(n===Na.NONE)return a;if(n===Na.SUM)return $t(a);if(n===Na.MEAN){if(r==null)return Es(a);{const i=s.size/r.size,l=Mt($t(a),$t(r));return i>1?Mt(l,Bt(i)):l}}if(n===Na.SUM_BY_NONZERO_WEIGHTS){if(r==null)return Mt($t(a),Bt(s.size));{const i=ge(r,Fa(s.shape)),l=ft($t(Th(i,Bt(0))),"float32");return Mt($t(a),l)}}throw Error(`Unknown reduction: ${n}`)}const tu=he({computeWeightedLoss_:GCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qCe(t,e,n,s=Na.SUM_BY_NONZERO_WEIGHTS){const r=te(t,"labels","absoluteDifference"),a=te(e,"predictions","absoluteDifference");let i=null;n!=null&&(i=te(n,"weights","absoluteDifference")),Qr(r.shape,a.shape,"Error in absoluteDifference: ");const l=Js(Tt(r,a));return tu(l,i,s)}const KCe=he({absoluteDifference_:qCe});function XCe(t,e,n,s,r=Na.SUM_BY_NONZERO_WEIGHTS){const a=te(t,"labels","cosineDistance"),i=te(e,"predictions","cosineDistance");let l=null;s!=null&&(l=te(s,"weights","cosineDistance")),Qr(a.shape,i.shape,"Error in cosineDistance: ");const c=Bt(1),u=Tt(c,$t(ge(a,i),n,!0));return tu(u,l,r)}const YCe=he({cosineDistance_:XCe});function QCe(t,e,n,s=Na.SUM_BY_NONZERO_WEIGHTS){let r=te(t,"labels","hingeLoss");const a=te(e,"predictions","hingeLoss");let i=null;n!=null&&(i=te(n,"weights","hingeLoss")),Qr(r.shape,a.shape,"Error in hingeLoss: ");const l=Bt(1);r=Tt(ge(Bt(2),r),l);const c=gl(Tt(l,ge(r,a)));return tu(c,i,s)}const ZCe=he({hingeLoss_:QCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JCe(t,e,n,s=1,r=Na.SUM_BY_NONZERO_WEIGHTS){const a=te(t,"labels","huberLoss"),i=te(e,"predictions","huberLoss");let l=null;n!=null&&(l=te(n,"weights","huberLoss")),Qr(a.shape,i.shape,"Error in huberLoss: ");const c=Bt(s),u=Js(Tt(i,a)),h=Ju(u,c),f=Tt(u,h),p=nt(ge(Bt(.5),Jn(h)),ge(c,f));return tu(p,l,r)}const eTe=he({huberLoss_:JCe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tTe(t,e,n,s=1e-7,r=Na.SUM_BY_NONZERO_WEIGHTS){const a=te(t,"labels","logLoss"),i=te(e,"predictions","logLoss");let l=null;n!=null&&(l=te(n,"weights","logLoss")),Qr(a.shape,i.shape,"Error in logLoss: ");const c=Bt(1),u=Bt(s),h=gs(ge(a,xi(nt(i,u)))),f=ge(Tt(c,a),xi(nt(Tt(c,i),u))),p=Tt(h,f);return tu(p,l,r)}const nTe=he({logLoss_:tTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sTe(t,e,n,s=Na.SUM_BY_NONZERO_WEIGHTS){const r=te(t,"labels","meanSquaredError"),a=te(e,"predictions","meanSquaredError");let i=null;n!=null&&(i=te(n,"weights","meanSquaredError")),Qr(r.shape,a.shape,"Error in meanSquaredError: ");const l=HS(r,a);return tu(l,i,s)}const rTe=he({meanSquaredError_:sTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aTe(t,e){const n=te(t,"labels","sigmoidCrossEntropyWithLogits"),s=te(e,"logits","sigmoidCrossEntropyWithLogits");Qr(n.shape,s.shape,"Error in sigmoidCrossEntropyWithLogits: ");const r=gl(s),a=ge(s,n),i=tb(Ga(gs(Js(s))));return nt(Tt(r,a),i)}function iTe(t,e,n,s=0,r=Na.SUM_BY_NONZERO_WEIGHTS){let a=te(t,"multiClassLabels","sigmoidCrossEntropy");const i=te(e,"logits","sigmoidCrossEntropy");let l=null;if(n!=null&&(l=te(n,"weights","sigmoidCrossEntropy")),Qr(a.shape,i.shape,"Error in sigmoidCrossEntropy: "),s>0){const u=Bt(s),h=Bt(1),f=Bt(.5);a=nt(ge(a,Tt(h,u)),ge(f,u))}const c=aTe(a,i);return tu(c,l,r)}const oTe=he({sigmoidCrossEntropy_:iTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lTe(t,e,n=-1){if(n===-1&&(n=e.rank-1),n!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${n}`);return Vl((r,a,i)=>{const c=nb(a,[n],!0),u=Tt(ft(a,"float32"),c);i([r,u]);const h=gs(ge(u,r));return{value:$t(h,[n]),gradFunc:(x,y)=>{const[v,b]=y,N=Ws(x.shape,[n]);return[ge(be(x,N),Tt(ft(v,"float32"),Ga(b))),ge(be(x,N),Tt(Ga(b),ft(v,"float32")))]}}})(t,e)}function cTe(t,e,n,s=0,r=Na.SUM_BY_NONZERO_WEIGHTS){let a=te(t,"onehotLabels","softmaxCrossEntropy");const i=te(e,"logits","softmaxCrossEntropy");let l=null;if(n!=null&&(l=te(n,"weights","softmaxCrossEntropy")),Qr(a.shape,i.shape,"Error in softmaxCrossEntropy: "),s>0){const u=Bt(s),h=Bt(1),f=Bt(a.shape[1]);a=nt(ge(a,Tt(h,u)),Mt(u,f))}const c=lTe(a,i);return tu(c,l,r)}const uTe=he({softmaxCrossEntropy_:cTe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dTe(t,e,n,s){const r=te(t,"indices","sparseFillEmptyRows","int32"),a=te(e,"values","sparseFillEmptyRows"),i=te(n,"denseShape","sparseFillEmptyRows","int32"),l=te(s,"defaultValue","sparseFillEmptyRows",a.dtype);if(r.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${r.shape}`);if(a.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${a.shape}`);if(i.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${i.shape}`);if(l.rank!==0)throw new Error(`Default value should be a scalar but received shape ${l.shape}`);const c={indices:r,values:a,denseShape:i,defaultValue:l},u=de.runKernel(iS,c);return{outputIndices:u[0],outputValues:u[1],emptyRowIndicator:u[2],reverseIndexMap:u[3]}}const hTe=he({sparseFillEmptyRows_:dTe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mTe(t,e,n){const s=te(t,"inputIndices","sparseReshape","int32"),r=te(e,"inputShape","sparseReshape","int32"),a=te(n,"newShape","sparseReshape","int32");if(s.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${s.shape}`);if(r.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${r.shape}`);if(a.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${a.shape}`);const i={inputIndices:s,inputShape:r,newShape:a},l=de.runKernel(oS,i);return{outputIndices:l[0],outputShape:l[1]}}const fTe=he({sparseReshape_:mTe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pTe(t,e,n){const s=te(t,"data","sparseSegmentMean"),r=te(e,"indices","sparseSegmentMean","int32"),a=te(n,"segmentIds","sparseSegmentMean","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${r.shape}`);if(a.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${a.shape}`);const i={data:s,indices:r,segmentIds:a};return de.runKernel(lS,i)}const gTe=he({sparseSegmentMean_:pTe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xTe(t,e,n){const s=te(t,"data","sparseSegmentSum"),r=te(e,"indices","sparseSegmentSum","int32"),a=te(n,"segmentIds","sparseSegmentSum","int32");if(s.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${r.shape}`);if(a.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${a.shape}`);const i={data:s,indices:r,segmentIds:a};return de.runKernel(cS,i)}const yTe=he({sparseSegmentSum_:xTe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bTe(t,e,n,s,r,a,i,l){const c=te(t,"data","stringNGrams","string");if(c.dtype!=="string")throw new Error("Data must be of datatype string");if(c.shape.length!==1)throw new Error(`Data must be a vector, saw: ${c.shape}`);const u=te(e,"dataSplits","stringNGrams");if(u.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const h={separator:n,nGramWidths:s,leftPad:r,rightPad:a,padWidth:i,preserveShortSequences:l},f={data:c,dataSplits:u},p=de.runKernel(mS,f,h);return{nGrams:p[0],nGramsSplits:p[1]}}const vTe=he({stringNGrams_:bTe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wTe(t,e,n=!0){const s=te(t,"input","stringSplit","string"),r=te(e,"delimiter","stringSplit","string");if(s.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${s.shape}`);if(r.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${r.shape}`);const a={skipEmpty:n},i={input:s,delimiter:r},l=de.runKernel(fS,i,a);return{indices:l[0],values:l[1],shape:l[2]}}const NTe=he({stringSplit_:wTe});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function STe(t,e){const n=te(t,"input","stringToHashBucketFast","string"),s={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const r={input:n};return de.runKernel(pS,r,s)}const jTe=he({stringToHashBucketFast_:STe});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kTe(t,e,n,s=!0){const r=te(t,"input","staticRegexReplace","string"),a={pattern:e,rewrite:n,replaceGlobal:s};return de.runKernel(Vy,{x:r},a)}const CTe=he({staticRegexReplace_:kTe});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kq={fft:db,ifft:vf,rfft:hb,irfft:WS},Cq={hammingWindow:eCe,hannWindow:wq,frame:Nq,stft:rCe},Vi={flipLeftRight:lCe,grayscaleToRGB:uCe,resizeNearestNeighbor:jq,resizeBilinear:Sq,rgbToGrayscale:hCe,rotateWithOffset:fCe,cropAndResize:iCe,nonMaxSuppression:gCe,nonMaxSuppressionAsync:jCe,nonMaxSuppressionWithScore:CCe,nonMaxSuppressionWithScoreAsync:_Ce,nonMaxSuppressionPadded:ACe,nonMaxSuppressionPaddedAsync:ICe,threshold:LCe,transform:FCe},cI={bandPart:BCe,gramSchmidt:VCe,qr:HCe},Tq={absoluteDifference:KCe,computeWeightedLoss:tu,cosineDistance:YCe,hingeLoss:ZCe,huberLoss:eTe,logLoss:nTe,meanSquaredError:rTe,sigmoidCrossEntropy:oTe,softmaxCrossEntropy:uTe},_q={sparseFillEmptyRows:hTe,sparseReshape:fTe,sparseSegmentMean:gTe,sparseSegmentSum:yTe},Eq={stringNGrams:vTe,stringSplit:NTe,stringToHashBucketFast:jTe,staticRegexReplace:CTe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TTe=new Map,hE=new Map;class Yh{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class Bi{constructor(){this.classNameMap={}}static getMap(){return Bi.instance==null&&(Bi.instance=new Bi),Bi.instance}static register(e){Bi.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function it(t,e,n){Z(t.className!=null,()=>"Class being registered does not have the static className property defined."),Z(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),Z(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const s=n,r=e+">"+s;return Bi.register(t),TTe.set(r,t),hE.set(t,r),t}function _Te(t){return hE.has(t)?hE.get(t):t.className}const ETe=Object.freeze(Object.defineProperty({__proto__:null,Serializable:Yh,SerializationMap:Bi,getRegisteredName:_Te,registerClass:it},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nu extends Yh{minimize(e,n=!1,s){const{value:r,grads:a}=this.computeGradients(e,s);if(s!=null){const i=s.map(l=>({name:l.name,tensor:a[l.name]}));this.applyGradients(i)}else this.applyGradients(a);return Jt(a),n?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return DG(e,n)}dispose(){this.iterations_!=null&&Jt(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:Bt(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(nu,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uI extends nu{static get className(){return"Adadelta"}constructor(e,n,s=null){super(),this.learningRate=e,this.rho=n,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=de.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const a=de.registeredVariables[s],i=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accum_grad`,variable:Ee(()=>Sn(a).variable(i))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${s}/accum_var`,variable:Ee(()=>Sn(a).variable(i))});const l=Array.isArray(e)?e[r].tensor:e[s];if(l==null)return;const c=this.accumulatedGrads[r].variable,u=this.accumulatedUpdates[r].variable;Ee(()=>{const h=nt(ge(c,this.rho),ge(Jn(l),1-this.rho)),f=ge(Mt(Ar(nt(u,this.epsilon)),Ar(nt(c,this.epsilon))),l),p=nt(ge(u,this.rho),ge(Jn(f),1-this.rho));c.assign(h),u.assign(p);const x=nt(ge(f,-this.learningRate),a);a.assign(x)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Jt(this.accumulatedGrads.map(e=>e.variable)),Jt(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,s=!1;this.accumulatedGrads=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedUpdates=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dI extends nu{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const a=de.registeredVariables[s];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accumulator`,variable:Ee(()=>qh(a.shape,this.initialAccumulatorValue).variable(!1))});const i=Array.isArray(e)?e[r].tensor:e[s];if(i==null)return;const l=this.accumulatedGrads[r].variable;Ee(()=>{const c=nt(l,Jn(i));l.assign(c);const u=nt(ge(Mt(i,Ar(nt(c,de.backend.epsilon()))),-this.learningRate),a);a.assign(u)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Jt(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hI extends nu{static get className(){return"Adam"}constructor(e,n,s,r=null){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],Ee(()=>{this.accBeta1=Bt(n).variable(),this.accBeta2=Bt(s).variable()}),r==null&&(this.epsilon=de.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);Ee(()=>{const s=Tt(1,this.accBeta1),r=Tt(1,this.accBeta2);n.forEach((a,i)=>{const l=de.registeredVariables[a],c=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${a}/m`,variable:Ee(()=>Sn(l).variable(c))}),this.accumulatedSecondMoment[i]==null&&(this.accumulatedSecondMoment[i]={originalName:`${a}/v`,variable:Ee(()=>Sn(l).variable(c))});const u=Array.isArray(e)?e[i].tensor:e[a];if(u==null)return;const h=this.accumulatedFirstMoment[i].variable,f=this.accumulatedSecondMoment[i].variable,p=nt(ge(h,this.beta1),ge(u,1-this.beta1)),x=nt(ge(f,this.beta2),ge(Jn(u),1-this.beta2)),y=Mt(p,s),v=Mt(x,r);h.assign(p),f.assign(x);const b=nt(ge(Mt(y,nt(Ar(v),this.epsilon)),-this.learningRate),l);l.assign(b)}),this.accBeta1.assign(ge(this.accBeta1,this.beta1)),this.accBeta2.assign(ge(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Jt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Jt(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),Ee(()=>{this.accBeta1.assign(Ul(this.beta1,this.iterations_+1)),this.accBeta2.assign(Ul(this.beta2,this.iterations_+1))});const n=e.length/2,s=!1;this.accumulatedFirstMoment=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mI extends nu{static get className(){return"Adamax"}constructor(e,n,s,r=null,a=0){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.decay=a,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],Ee(()=>{this.iteration=Bt(0).variable(),this.accBeta1=Bt(n).variable()}),r==null&&(this.epsilon=de.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);Ee(()=>{const s=Tt(1,this.accBeta1),r=Mt(-this.learningRate,nt(ge(this.iteration,this.decay),1));n.forEach((a,i)=>{const l=de.registeredVariables[a],c=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${a}/m`,variable:Sn(l).variable(c)}),this.accumulatedWeightedInfNorm[i]==null&&(this.accumulatedWeightedInfNorm[i]={originalName:`${a}/v`,variable:Sn(l).variable(c)});const u=Array.isArray(e)?e[i].tensor:e[a];if(u==null)return;const h=this.accumulatedFirstMoment[i].variable,f=this.accumulatedWeightedInfNorm[i].variable,p=nt(ge(h,this.beta1),ge(u,1-this.beta1)),x=ge(f,this.beta2),y=Js(u),v=Gl(x,y);h.assign(p),f.assign(v);const b=nt(ge(Mt(r,s),Mt(p,nt(v,this.epsilon))),l);l.assign(b)}),this.iteration.assign(nt(this.iteration,1)),this.accBeta1.assign(ge(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Jt(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Jt(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rj extends nu{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const i=de.registeredVariables[s];Ee(()=>{const l=nt(ge(this.c,a),i);i.assign(l)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=hr(Bt(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fI extends rj{static get className(){return"Momentum"}constructor(e,n,s=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=s,this.accumulations=[],this.m=Bt(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const a=de.registeredVariables[s];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${s}/momentum`,variable:Ee(()=>Sn(a).variable(!1))});const i=this.accumulations[r].variable,l=Array.isArray(e)?e[r].tensor:e[s];l!=null&&Ee(()=>{let c;const u=nt(ge(this.m,i),l);this.useNesterov?c=nt(ge(this.c,nt(l,ge(u,this.m))),a):c=nt(ge(this.c,u),a),i.assign(u),a.assign(c)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Jt(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pI extends nu{static get className(){return"RMSProp"}constructor(e,n=.9,s=0,r=null,a=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=s,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=a,r==null&&(this.epsilon=de.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const a=de.registeredVariables[s],i=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${s}/rms`,variable:Ee(()=>Sn(a).variable(i))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${s}/momentum`,variable:Ee(()=>Sn(a).variable(i))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${s}/mg`,variable:Ee(()=>Sn(a).variable(i))});const l=Array.isArray(e)?e[r].tensor:e[s];if(l==null)return;const c=this.accumulatedMeanSquares[r].variable,u=this.accumulatedMoments[r].variable;Ee(()=>{const h=nt(ge(c,this.decay),ge(Jn(l),1-this.decay));if(this.centered){const f=this.accumulatedMeanGrads[r].variable,p=nt(ge(f,this.decay),ge(l,1-this.decay)),x=Mt(ge(l,this.learningRate),Ar(Tt(h,nt(Jn(p),this.epsilon)))),y=nt(ge(u,this.momentum),x);c.assign(h),f.assign(p),u.assign(y);const v=Tt(a,y);a.assign(v)}else{const f=nt(ge(c,this.decay),ge(Jn(l),1-this.decay)),p=nt(ge(u,this.momentum),Mt(ge(l,this.learningRate),Ar(nt(f,this.epsilon))));c.assign(f),u.assign(p);const x=Tt(a,p);a.assign(x)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Jt(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Jt(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Jt(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,s=!1;this.accumulatedMeanSquares=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedMoments=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ATe=[uI,dI,hI,mI,fI,pI,rj];function $Te(){for(const t of ATe)it(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ITe="model",RTe=".json",OTe=".weights.bin";function k8(t){return new Promise(e=>setTimeout(e)).then(t)}class Eh{constructor(e){if(!$e().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(Eh.URL_SCHEME)&&(e=e.slice(Eh.URL_SCHEME.length)),(e==null||e.length===0)&&(e=ITe),this.modelJsonFileName=e+RTe,this.weightDataFileName=e+OTe}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const n=pl.join(e.weightData),s=window.URL.createObjectURL(new Blob([n],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],a=pG(e,r),i=window.URL.createObjectURL(new Blob([JSON.stringify(a)],{type:"application/json"})),l=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(l.download=this.modelJsonFileName,l.href=i,await k8(()=>l.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const c=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;c.download=this.weightDataFileName,c.href=s,await k8(()=>c.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:Ky(e)}}}}Eh.URL_SCHEME="downloads://";class DTe{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,n)=>{const s=new FileReader;s.onload=r=>{const a=JSON.parse(r.target.result),i=a.modelTopology;if(i==null){n(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(a.weightsManifest==null){n(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:i});return}const c=r$(a,u=>this.loadWeights(u));e(c)},s.onerror=r=>n(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),s.readAsText(this.jsonFile)})}loadWeights(e){const n=[],s=[];for(const i of e)n.push(...i.weights),s.push(...i.paths);const r=this.checkManifestAndWeightFiles(e),a=s.map(i=>this.loadWeightsFile(i,r[i]));return Promise.all(a).then(i=>[n,i])}loadWeightsFile(e,n){return new Promise((s,r)=>{const a=new FileReader;a.onload=i=>{const l=i.target.result;s(l)},a.onerror=i=>r(`Failed to weights data from file of path '${e}'.`),a.readAsArrayBuffer(n)})}checkManifestAndWeightFiles(e){const n=[],s=this.weightsFiles.map(a=>f8(a.name)),r={};for(const a of e)a.paths.forEach(i=>{const l=f8(i);if(n.indexOf(l)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${l}'`);if(n.push(l),s.indexOf(l)===-1)throw new Error(`Weight file with basename '${l}' is not provided.`);r[i]=this.weightsFiles[s.indexOf(l)]});if(n.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${n.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return r}}const PTe=t=>$e().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(Eh.URL_SCHEME)?LTe(t.slice(Eh.URL_SCHEME.length)):null;_s.registerSaveRouter(PTe);function LTe(t="model"){return new Eh(t)}function MTe(t){return new DTe(t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C8(t,e,n,s){i(t),n=n??0,s=s??1,l(n,s);let r=0;const a=c=>(c.then(u=>{const h=n+ ++r/t.length*(s-n);return e(h),u}),c);function i(c){Z(c!=null&&Array.isArray(c)&&c.length>0,()=>"promises must be a none empty array")}function l(c,u){Z(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${c}`),Z(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${u}`),Z(u>=c,()=>`startFraction must be no more than endFraction, but got startFraction ${c} and endFraction ${u}`)}return Promise.all(t.map(a))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Aq(t,e){e==null&&(e={});const n=e.fetchFunc==null?$e().platform.fetch:e.fetchFunc,s=t.map(f=>n(f,e.requestInit,{isBinary:!0})),l=(e.onProgress==null?await Promise.all(s):await C8(s,e.onProgress,0,.5)).map(f=>f.arrayBuffer());return e.onProgress==null?await Promise.all(l):await C8(l,e.onProgress,.5,1)}function FTe(t,e){var n;const s=e.fetchFunc==null?$e().platform.fetch:e.fetchFunc;let r=0,a;return(n=e.onProgress)===null||n===void 0||n.call(e,0),new ReadableStream({pull:async i=>{for(var l;r<t.length;){a||(a=(await s(t[r],e.requestInit,{isBinary:!0})).body.getReader());const{done:c,value:u}=await a.read();if(c){r++,a=void 0,(l=e.onProgress)===null||l===void 0||l.call(e,r/t.length);continue}i.enqueue(u);return}i.close()}})}async function $q(t,e="",n,s){return Iq(i=>Aq(i,{requestInit:s}))(t,e,n)}function Iq(t){return async(e,n="",s)=>{const r=e.map(()=>!1),a={},i=s!=null?s.map(()=>!1):[],l=[];if(e.forEach((x,y)=>{let v=0;x.weights.forEach(b=>{const N="quantization"in b?b.quantization.dtype:b.dtype,S=wh[N]*ze(b.shape),k=()=>{r[y]=!0,a[y]==null&&(a[y]=[]),a[y].push({manifestEntry:b,groupOffset:v,sizeBytes:S})};s!=null?s.forEach((T,E)=>{T===b.name&&(k(),i[E]=!0)}):k(),l.push(b.name),v+=S})}),!i.every(x=>x)){const x=s.filter((y,v)=>!i[v]);throw new Error(`Could not find weights in manifest with names: ${x.join(", ")}. 
Manifest JSON has weights with names: ${l.join(", ")}.`)}const c=r.reduce((x,y,v)=>(y&&x.push(v),x),[]),u=[];c.forEach(x=>{e[x].paths.forEach(y=>{const v=n+(n.endsWith("/")?"":"/")+y;u.push(v)})});const h=await t(u),f={};let p=0;return c.forEach(x=>{const y=e[x].paths.length,v=new pl(h.slice(p,p+y));a[x].forEach(N=>{const S=v.slice(N.groupOffset,N.groupOffset+N.sizeBytes),k=t$(S,[N.manifestEntry]);for(const T in k)f[T]=k[T]}),p+=y}),f}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zTe="application/octet-stream",BTe="application/json";class gI{constructor(e,n){if(this.DEFAULT_METHOD="POST",n==null&&(n={}),this.weightPathPrefix=n.weightPathPrefix,this.weightUrlConverter=n.weightUrlConverter,n.fetchFunc!=null?(Z(typeof n.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=n.fetchFunc):this.fetch=$e().platform.fetch,Z(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&Z(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,n.requestInit!=null&&n.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=n.requestInit||{},this.loadOptions=n}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const n=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);n.body=new FormData;const s=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],r=pG(e,s);if(n.body.append("model.json",new Blob([JSON.stringify(r)],{type:BTe}),"model.json"),e.weightData!=null){const i=pl.join(e.weightData);n.body.append("model.weights.bin",new Blob([i],{type:zTe}),"model.weights.bin")}const a=await this.fetch(this.path,n);if(a.ok)return{modelArtifactsInfo:Ky(e),responses:[a]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${a.status}.`)}async loadModelJSON(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let n;try{n=await e.json()}catch{let i=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?i+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":i+=" Please make sure the server is serving valid JSON for this request.",new Error(i)}const s=n.modelTopology,r=n.weightsManifest;if(s==null&&r==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return n}async load(){if(this.loadOptions.streamWeights)return this.loadStream();const e=await this.loadModelJSON();return r$(e,n=>this.loadWeights(n))}async loadStream(){const e=await this.loadModelJSON(),n=await this.getWeightUrls(e.weightsManifest),s=Qw(e.weightsManifest),r=()=>FTe(n,this.loadOptions);return Object.assign(Object.assign({},e),{weightSpecs:s,getWeightStream:r})}async getWeightUrls(e){const n=Array.isArray(this.path)?this.path[1]:this.path,[s,r]=UTe(n),a=this.weightPathPrefix||s,i=[],l=[];for(const c of e)for(const u of c.paths)this.weightUrlConverter!=null?l.push(this.weightUrlConverter(u)):i.push(a+u+r);return this.weightUrlConverter&&i.push(...await Promise.all(l)),i}async loadWeights(e){const n=await this.getWeightUrls(e),s=Qw(e),r=await Aq(n,this.loadOptions);return[s,r]}}gI.URL_SCHEME_REGEX=/^https?:\/\//;function UTe(t){const e=t.lastIndexOf("/"),n=t.lastIndexOf("?"),s=t.substring(0,e),r=n>e?t.substring(n):"";return[s+"/",r]}function mE(t){return t.match(gI.URL_SCHEME_REGEX)!=null}const Rq=(t,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let n=!0;if(Array.isArray(t)?n=t.every(s=>mE(s)):n=mE(t),n)return xI(t,e)}return null};_s.registerSaveRouter(Rq);_s.registerLoadRouter(Rq);function xI(t,e){return new gI(t,e)}function Oq(t,e){return xI(t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class E3{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class Dq{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class VTe{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=n=>Promise.resolve(e.save(n)))}}function WTe(t,e,n,s){const r=arguments;return new VTe(Jw(...r))}function Jw(t,e,n,s){return arguments.length===1?t.modelTopology!=null||t.weightSpecs!=null?new E3(t):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new E3({modelTopology:t})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new E3({modelTopology:t,weightSpecs:e,weightData:n,trainingConfig:s}))}function HTe(t){return new Dq(t)}function GTe(t){return new Dq(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yI=Object.freeze(Object.defineProperty({__proto__:null,CompositeArrayBuffer:pl,browserFiles:MTe,browserHTTPRequest:Oq,concatenateArrayBuffers:fG,copyModel:j2e,decodeWeights:t$,decodeWeightsStream:mG,encodeWeights:aE,fromMemory:WTe,fromMemorySync:Jw,getLoadHandlers:xG,getModelArtifactsForJSON:r$,getModelArtifactsForJSONSync:s$,getModelArtifactsInfoForJSON:Ky,getSaveHandlers:gG,getWeightSpecs:Qw,http:xI,isHTTPScheme:mE,listModels:N2e,loadWeights:$q,moveModel:k2e,registerLoadRouter:u2e,registerSaveRouter:c2e,removeModel:S2e,weightsLoaderFactory:Iq,withSaveHandler:HTe,withSaveHandlerSync:GTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qTe(t,e,n){const s=te(t,"labels","confusionMatrix"),r=te(e,"predictions","confusionMatrix");Z(n==null||n>0&&Number.isInteger(n),()=>`If provided, numClasses must be a positive integer, but got ${n}`),Z(s.rank===1,()=>`Expected the rank of labels to be 1, but got ${s.rank}`),Z(r.rank===1,()=>`Expected the rank of predictions to be 1, but got ${r.rank}`),Z(s.shape[0]===r.shape[0],()=>`Mismatch in the number of examples: ${s.shape[0]} vs. ${r.shape[0]}. Labels and predictions should have the same number of elements.`),Z(n>0&&Number.isInteger(n),()=>`numClasses is required to be a positive integer, but got ${n}`);const a=xf(ft(s,"int32"),n),i=xf(ft(r,"int32"),n),l=bn(a),c=mn(l,i);return ft(c,"int32")}const KTe=he({confusionMatrix_:qTe});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XTe=Object.freeze(Object.defineProperty({__proto__:null,confusionMatrix:KTe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Od,T8=!1;function Pq(t,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(t==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let n=!1,s=!1,r=!1,a=!1,i=!1,l=!1;if(t.data instanceof Uint8Array)n=!0;else if(typeof ImageData<"u"&&t instanceof ImageData)s=!0;else if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)r=!0;else if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)a=!0;else if(t.getContext!=null)i=!0;else if(typeof ImageBitmap<"u"&&t instanceof ImageBitmap)l=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${t.constructor.name}`);if(rx(Xw,de.backendName)!=null){const y={pixels:t},v={numChannels:e};return de.runKernel(Xw,y,v)}const[u,h]=r?[t.videoWidth,t.videoHeight]:[t.width,t.height];let f;if(i)f=t.getContext("2d").getImageData(0,0,u,h).data;else if(s||n)f=t.data;else if(a||r||l){if(Od==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")Od=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else Od=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});Od.canvas.width=u,Od.canvas.height=h,Od.drawImage(t,0,0,u,h),f=Od.getImageData(0,0,u,h).data}let p;if(e===4)p=new Int32Array(f);else{const y=u*h;p=new Int32Array(y*e);for(let v=0;v<y;v++)for(let b=0;b<e;++b)p[v*e+b]=f[v*4+b]}return J$(p,[h,u,e],"int32")}function YTe(t){return t!=null&&t.data instanceof Uint8Array}function QTe(){return typeof window<"u"&&typeof ImageBitmap<"u"&&window.hasOwnProperty("createImageBitmap")}function ZTe(t){return t!=null&&t.width!==0&&t.height!==0}function JTe(t){return QTe()&&!(t instanceof ImageBitmap)&&ZTe(t)&&!YTe(t)}async function e3e(t,e=3){let n=null;if($e().getBool("WRAP_TO_IMAGEBITMAP")&&JTe(t)){let s;try{s=await createImageBitmap(t,{premultiplyAlpha:"none"})}catch{s=null}s!=null&&s.width===t.width&&s.height===t.height?n=s:n=t}else n=t;return Pq(n,e)}function Lq(t){if(t.rank!==2&&t.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${t.rank}.`);const e=t.rank===2?1:t.shape[2];if(e>4||e===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${e}`);if(t.dtype!=="float32"&&t.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${t.dtype}. Please use float32 or int32 tensors.`)}function t3e(t){const e=(t==null?void 0:t.alpha)||1;if(e>1||e<0)throw new Error(`Alpha value ${e} is suppoed to be in range [0 - 1].`)}async function n3e(t,e){let n=te(t,"img","toPixels");if(!(t instanceof Tn)){const u=n;n=ft(u,"int32"),u.dispose()}Lq(n);const[s,r]=n.shape.slice(0,2),a=n.rank===2?1:n.shape[2],i=await n.data(),l=n.dtype==="float32"?255:1,c=new Uint8ClampedArray(r*s*4);for(let u=0;u<s*r;++u){const h=[0,0,0,255];for(let p=0;p<a;p++){const x=i[u*a+p];if(n.dtype==="float32"){if(x<0||x>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${x}.`)}else if(n.dtype==="int32"&&(x<0||x>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${x}.`);a===1?(h[0]=x*l,h[1]=x*l,h[2]=x*l):h[p]=x*l}const f=u*4;c[f+0]=Math.round(h[0]),c[f+1]=Math.round(h[1]),c[f+2]=Math.round(h[2]),c[f+3]=Math.round(h[3])}if(e!=null){T8||rx(IN,de.backendName)!=null&&(console.warn("tf.browser.toPixels is not efficient to draw tensor on canvas. Please try tf.browser.draw instead."),T8=!0),e.width=r,e.height=s;const u=e.getContext("2d"),h=new ImageData(c,r,s);u.putImageData(h,0,0)}return n!==t&&n.dispose(),c}function s3e(t,e,n){let s=te(t,"img","draw");if(!(t instanceof Tn)){const i=s;s=ft(i,"int32"),i.dispose()}Lq(s),t3e(n==null?void 0:n.imageOptions);const r={image:s},a={canvas:e,options:n};de.runKernel(IN,r,a)}const bI=he({fromPixels_:Pq}),r3e=Object.freeze(Object.defineProperty({__proto__:null,draw:s3e,fromPixels:bI,fromPixelsAsync:e3e,toPixels:n3e},Symbol.toStringTag,{value:"Module"}));function aj(t,e){const n=t.shape.length,s=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[s-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[s-1]} vs. ${n}`);if(ze(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const r=e.shape,a=r[r.length-1];let i=1;for(let f=0;f<r.length-1;++f)i*=r[f];const l=t.shape,c=r.slice();c.pop();let u=1;for(let f=a;f<n;++f)u*=l[f],c.push(l[f]);const h=[...Ut(t.shape).map(f=>f/u),1].slice(0,a);return[c,i,u,h]}const a3e=Object.freeze(Object.defineProperty({__proto__:null,prepareAndValidate:aj},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fE=-2,i3e=-1;function vI(t,e,n){const s=t.shape.length;Z(s===e.length,()=>`Error in slice${s}D: Length of begin ${e} must match the rank of the array (${s}).`),Z(s===n.length,()=>`Error in slice${s}D: Length of size ${n} must match the rank of the array (${s}).`);for(let r=0;r<s;++r)Z(e[r]+n[r]<=t.shape[r],()=>`Error in slice${s}D: begin[${r}] + size[${r}] (${e[r]+n[r]}) would overflow input.shape[${r}] (${t.shape[r]})`)}function o3e(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function wI(t,e,n){const s=[];for(let r=0;r<t.length;r++)s[r]=Math.ceil((e[r]-t[r])/n[r]);return s}function Mq(t,e,n,s){const r=[...t];for(let a=r.length;a<s.length;a++)r.push(1);for(let a=0;a<n;a++)a===0?r[e]=1:(r.splice(e,0,1),r.pop());return r}function Fq(t,e,n){return n<=t?n:n-(e-1)}function zq(t,e){const n=[];for(let s=0;s<t;s++)n.push(e+s);return n}function l3e(t,e,n,s,r,a,i,l,c){const u=t.length;let h=new Array(u),f=new Array(u),p=new Array(u);if(e.length&&n>0){const x=e[0],y=n+1;h=Bq(i,x,y,s,t),f=Uq(l,x,y,r,t),p=Mq(a,x,y,t)}else for(let x=0;x<u;x++)h[x]=Wq(i,s,a,t,x,c),f[x]=Hq(l,r,a,t,x,c),p[x]=Vq(a,x,c);return{begin:h,end:f,strides:p}}function Bq(t,e,n,s,r){const a=[...r],i=zq(n,e);for(let l=0;l<a.length;l++)if(i.indexOf(l)>-1)a[l]=0;else{const c=Fq(e,n,l);let u=s[c];t&1<<c&&(u=0),a[l]=u}return a}function Uq(t,e,n,s,r){const a=[...r],i=zq(n,e);for(let l=0;l<a.length;l++)if(i.indexOf(l)>-1)a[l]=Number.MAX_SAFE_INTEGER;else{const c=Fq(e,n,l);let u=s[c];t&1<<c&&(u=Number.MAX_SAFE_INTEGER),a[l]=u}for(let l=0;l<a.length;l++){const c=r[l];a[l]<0&&(a[l]+=c),a[l]=Ku(0,a[l],r[l])}return a}function Vq(t,e,n){let s=t[e];return(n&1<<e||s==null)&&(s=1),s}function Wq(t,e,n,s,r,a){let i=e[r];const l=n[r]||1;(t&1<<r||a&1<<r||i==null)&&(l>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);const c=s[r];return i<0&&(i+=c),i=Ku(0,i,c-1),i}function Hq(t,e,n,s,r,a){let i=e[r];const l=n[r]||1;(t&1<<r||a&1<<r||i==null)&&(l>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);const c=s[r];return i<0&&(i+=c),l>0?i=Ku(0,i,c):i=Ku(-1,i,c-1),i}function NI(t,e,n){let s=n.length;for(let r=0;r<n.length;r++)if(n[r]>1){s=r;break}for(let r=s+1;r<n.length;r++)if(e[r]>0||n[r]!==t[r])return!1;return!0}function SI(t,e){let n=t.length>0?t[t.length-1]:1;for(let s=0;s<t.length-1;s++)n+=t[s]*e[s];return n}function ij(t,e,n){let s;const r=t.shape.length;typeof e=="number"?s=[e,...new Array(r-1).fill(0)]:e.length<r?s=e.concat(new Array(r-e.length).fill(0)):s=e.slice(),s.forEach(i=>{Z(i!==-1,()=>"slice() does not support negative begin indexing.")});let a;return n==null?a=new Array(r).fill(-1):typeof n=="number"?a=[n,...new Array(r-1).fill(-1)]:n.length<r?a=n.concat(new Array(r-n.length).fill(-1)):a=n,a=a.map((i,l)=>i>=0?i:(Z(i===-1,()=>`Negative size values should be exactly -1 but got ${i} for the slice() size at index ${l}.`),t.shape[l]-s[l])),[s,a]}function jI(t,e,n,s,r,a,i,l,c){let u;if(s==null?(u=new Array(e.length),u.fill(1)):u=s,i!=null&&(i&i-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let h=!1;const f={dims:u.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:u.slice(),beginMask:r,endMask:a,ellipsisMask:i,newAxisMask:l,shrinkAxisMask:c};for(let k=0;k<f.dims;k++)h&&(1<<k&l)!==0&&f.numAddAxisAfterEllipsis++,1<<k&i&&(h=!0);h||(f.ellipsisMask|=1<<f.dims,f.dims++);const p={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};c3e(f,p);let x=!0,y=!0,v=!0;const b=[],N=[];for(let k=0;k<t.length;++k){if(p.strides[k]===0)throw Error(`strides[${k}] must be non-zero`);const T=!!(p.shrinkAxisMask&1<<k),E=t[k];if(E===-1){b.push(T?1:-1);continue}const D=[p.beginMask&1<<k,p.endMask&1<<k],A=[p.strides[k]>0?0:-1,p.strides[k]>0?E:E-1];if(T&&p.strides[k]<=0)throw Error("only stride 1 allowed on non-range indexing.");v=v&&p.strides[k]===1;const I=!!(p.beginMask&1<<k&&p.endMask&1<<k);if(p.beginValid&&p.endValid){if(T){const F=p.begin[k]<0?E+p.begin[k]:p.begin[k];if(p.begin[k]=F,p.end[k]=p.begin[k]+1,F<0||F>=E)throw Error(`slice index ${p.begin[k]} of dimension ${k} out of bounds.`)}else p.begin[k]=_8(p.begin[k],0,p.strides[k],E,D,A),p.end[k]=_8(p.end[k],1,p.strides[k],E,D,A);const R=p.strides[k]===1&&p.begin[k]===0&&p.end[k]===E;x=x&&R,y=y&&(k===0&&p.strides[k]===1||R)}else x=x&&p.strides[k]===1&&I,y=y&&(k===0&&p.strides[k]===1||I);let P,$=!1;if(p.beginValid&&p.endValid?(P=p.end[k]-p.begin[k],$=!0):T?(P=1,$=!0):I&&E>=0&&(p.strides[k]<0?P=-E:P=E,$=!0),$){let R;P===0||P<0!=p.strides[k]<0?R=0:R=Math.trunc(P/p.strides[k])+(P%p.strides[k]!==0?1:0),b.push(R)}else b.push(-1)}for(let k=0;k<p.finalShapeGatherIndices.length;++k){const T=p.finalShapeGatherIndices[k];T>=0?N.push(b[T]):T===fE&&N.push(1)}return{finalShapeSparse:N.filter((k,T)=>p.finalShapeGatherIndices[T]!==fE),finalShape:N,isIdentity:x,sliceDim0:y,isSimpleSlice:v,begin:p.begin,end:p.end,strides:p.strides}}function c3e(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let s=0;s<t.dims;s++)if(1<<s&t.ellipsisMask){const r=Math.min(e.dims-(t.dims-s)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<r;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=s}else if(1<<s&t.newAxisMask)e.finalShapeGatherIndices.push(fE),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[s]),t.end!=null&&(e.end[n]=t.end[s]),e.strides[n]=t.strides[s],t.beginMask&1<<s&&(e.beginMask|=1<<n),t.endMask&1<<s&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<s?(e.finalShapeGatherIndices.push(i3e),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(s)),e.inputShapeGatherIndicesSparse[n]=s,n++}}function _8(t,e,n,s,r,a){if(r[e])return n>0?a[e]:a[e+1&1];{const i=t<0?s+t:t;return i<a[0]?a[0]:i>a[1]?a[1]:i}}const Gq=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:vI,computeFlatOffset:SI,computeOutShape:wI,getNormalizedAxes:l3e,isSliceContinous:NI,maskToAxes:o3e,parseSliceParams:ij,sliceInfo:jI,startForAxis:Wq,startIndicesWithElidedDims:Bq,stopForAxis:Hq,stopIndicesWithElidedDims:Uq,stridesForAxis:Vq,stridesWithElidedDims:Mq},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const qq="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kq{static sgd(e){return new rj(e)}static momentum(e,n,s=!1){return new fI(e,n,s)}static rmsprop(e,n=.9,s=0,r=null,a=!1){return new pI(e,n,s,r,a)}static adam(e=.001,n=.9,s=.999,r=null){return new hI(e,n,s,r)}static adadelta(e=.001,n=.95,s=null){return new uI(e,n,s)}static adamax(e=.002,n=.9,s=.999,r=null,a=0){return new mI(e,n,s,r,a)}static adagrad(e,n=.1){return new dI(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bd=Kq;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u3e=typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t();function kI(){return new Promise(t=>u3e(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CI(t,e){const n=t[0].length;t.forEach((r,a)=>{Z(r.length===n,()=>`Error in concat${n}D: rank of tensors[${a}] must be the same as the rank of the rest (${n})`)}),Z(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const s=t[0];t.forEach((r,a)=>{for(let i=0;i<n;i++)Z(i===e||r[i]===s[i],()=>`Error in concat${n}D: Shape of tensors[${a}] (${r}) does not match the shape of the rest (${s}) along the non-concatenated axis ${a}.`)})}function Dl(t,e){const n=t[0].slice();for(let s=1;s<t.length;s++)n[e]+=t[s][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Jo;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(Jo||(Jo={}));function Xq(t,e,n){let s=new Array;if(n==null&&e==null)return s;if(e==null)for(;s.length<t+n.length;)s.push(-1);else s=e.slice();if(n==null)return s;if(t+n.length!==s.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${s.length}`);for(let r=1;r<n.length;++r){const a=n[r],i=s[s.length-n.length+r],l=s[i];if(a>=0)if(l>=0){if(l!==a)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${r+t}] = ${a} but shape[${r+t}] = ${l}`)}else s[i]=a}return s}function Yq(t){const e={FIRST_DIM_SIZE:Jo.FIRST_DIM_SIZE,VALUE_ROWIDS:Jo.VALUE_ROWIDS,ROW_LENGTHS:Jo.ROW_LENGTHS,ROW_SPLITS:Jo.ROW_SPLITS,ROW_LIMITS:Jo.ROW_LIMITS,ROW_STARTS:Jo.ROW_STARTS},n=[];for(const s of t)if(s in e)n.push(e[s]);else break;return n}function Qq(t){return t.length===0?0:t[0]===Jo.FIRST_DIM_SIZE?t.length-1:t.length}function Zq(t,e){if(t==null||e==null)return;const n=t.length,s=e.length;if(n>=s)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${s})`);for(let r=0;r<Math.min(n,s-1);++r){const a=t[r],i=e[r+1];if(a>=0&&i>=0&&a!==1&&a!==i)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${r-t.length}] = ${a} but ragged tensor input.flatValues.shape[${r-t.length}] = ${i}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TI=30;function oj(t){return t<=TI?t:Gw(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _I(t,e,n){const s=n*(typeof t=="number"?t:t[0]),r=e*(typeof t=="number"?t:t[1]);return[s,r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mb(t,e,n,s=!0){let r=[];if(s)r=r.concat(e.slice(0)),r.push(t[0]/n),r=r.concat(t.slice(1));else{r=r.concat(t[0]);const a=e.length;for(let i=0;i<a;++i)r=r.concat([t[i+1]/e[i],e[i]]);r=r.concat(t.slice(a+1))}return r}function fb(t,e,n=!0){const s=[];if(n){s.push(e);for(let r=e+1;r<t;++r)r<=2*e?(s.push(r),s.push(r-(e+1))):s.push(r)}else{const r=[],a=[];for(let i=1;i<t;++i)i>=e*2+1||i%2===1?a.push(i):r.push(i);s.push(...r),s.push(0),s.push(...a)}return s}function pb(t,e,n,s=!0){const r=[];s?r.push(t[0]/n):r.push(t[0]*n);for(let a=1;a<t.length;++a)a<=e.length?s?r.push(e[a-1]*t[a]):r.push(t[a]/e[a-1]):r.push(t[a]);return r}function EI(t,e){const n=[0];for(let s=0;s<e;++s)n.push(t[s][0]);return n}function AI(t,e,n){const s=t.slice(0,1);for(let r=0;r<n;++r)s.push(t[r+1]-e[r][0]-e[r][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lj=1.7580993408473768,cj=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $I=.3275911,II=.254829592,RI=-.284496736,OI=1.421413741,DI=-1.453152027,PI=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mc(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let s=0;s<n.length;s+=2)n[s]=t[s/2],n[s+1]=e[s/2];return n}function Jq(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let s=0;s<t.length;s+=2)e[s/2]=t[s],n[s/2]=t[s+1];return{real:e,imag:n}}function eK(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=0;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function tK(t){const e=Math.floor(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=2;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function LI(t,e){const n=t[e*2],s=t[e*2+1];return{real:n,imag:s}}function nK(t,e,n,s){t[s*2]=e,t[s*2+1]=n}function sK(t,e){const n=new Float32Array(t/2),s=new Float32Array(t/2);for(let r=0;r<Math.ceil(t/2);r++){const a=(e?2:-2)*Math.PI*(r/t);n[r]=Math.cos(a),s[r]=Math.sin(a)}return{real:n,imag:s}}function rK(t,e,n){const s=(n?2:-2)*Math.PI*(t/e),r=Math.cos(s),a=Math.sin(s);return{real:r,imag:a}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A3="->",d3e=/->/g,E8=",",A8="...";function MI(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(d3e,"").length)/A3.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${A3}").`);const[s,r]=t.split(A3);Z(s.indexOf(A8)===-1,()=>`The ellipsis notation ("${A8}") is not supported yet.`);const a=s.split(E8),i=a.length;if(e!==i)throw new Error(`Expected ${i} input tensors, received ${e}`);if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const l=[];for(let p=0;p<r.length;++p){const x=r[p];if(!a.some(y=>y.indexOf(x)!==-1))throw new Error(`Output subscripts contain the label ${x} not present in the input subscripts.`);l.indexOf(x)===-1&&l.push(x)}for(let p=0;p<s.length;++p){const x=s[p];l.indexOf(x)===-1&&x!==E8&&l.push(x)}const c=new Array(a.length);for(let p=0;p<i;++p){if(new Set(a[p].split("")).size!==a[p].length)throw new Error(`Found duplicate axes in input component ${a[p]}. Support for duplicate axes in input is not implemented yet.`);c[p]=[];for(let x=0;x<a[p].length;++x)c[p].push(l.indexOf(a[p][x]))}const u=l.length,h=r.length,f=[];for(let p=h;p<u;++p)f.push(p);return{allDims:l,summedDims:f,idDims:c}}function FI(t,e){let n=new Array(t);n.fill(-1);for(let r=0;r<e.length;++r)n[e[r]]=r;const s=[];for(let r=0;r<t;++r)n[r]===-1&&s.push(r);return n=n.filter(r=>r!==-1),{permutationIndices:n,expandDims:s}}function zI(t,e,n){const s=new Array(t);for(let r=0;r<n.length;++r){const a=n[r].shape;for(let i=0;i<e[r].length;++i)s[e[r][i]]===void 0?s[e[r][i]]=a[i]:Z(s[e[r][i]]===a[i],()=>`Expected dimension ${s[e[r][i]]} at axis ${i} of input shaped ${JSON.stringify(a)}, but got dimension ${a[i]}`)}}function BI(t,e){const n=t,s=[];let r=0;t.length===0&&n.push(-1),r=t.length+1;for(let i=0;i<r;++i)s.push([]);const a=[];for(let i=0;i<n.length;++i){const l=n[i],c=h3e(e,l);for(const u of c)a.indexOf(u)===-1&&(s[i].push(u),a.push(u))}return{path:n,steps:s}}function UI(t){return t.every((e,n)=>e===n)}function h3e(t,e){const n=[];for(let s=0;s<t.length;++s)(t[s].length===0||t[s].indexOf(e)!==-1||e===-1)&&n.push(s);return n}function VI(t,e,n=0){let s=[];if(typeof e=="number")Z(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),s=new Array(e).fill(t.shape[n]/e);else{const r=e.reduce((i,l)=>(l===-1&&(i+=1),i),0);Z(r<=1,()=>"There should be only one negative value in split array.");const a=e.indexOf(-1);if(a!==-1){const i=e.reduce((l,c)=>c>0?l+c:l);e[a]=t.shape[n]-i}Z(t.shape[n]===e.reduce((i,l)=>i+l),()=>"The sum of sizes must match the size of the axis dimension."),s=e}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aK(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function iK(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function oK(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lK(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function cK(t,e){return`size ${t} must be non-negative, not ${e}`}function uK(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function dK(t,e){const n=ze(t),s=ze(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${t} outputShape= ${e}`}function hK(t,e){const n=ze(t),s=ze(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${s}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pE(){return"segment ids must be >= 0"}function mK(){return"segment ids are not increasing"}function fK(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function pK(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gK(t,e){let n=!1,s;for(t<=TI?(s=t,n=!0):s=Gw(t,Math.floor(Math.sqrt(t)));!n;)s>e||s===t?n=!0:s=Gw(t,s+1);return s}function xK(t,e,n){const s=[],r=t.length;for(let a=0;a<r;a++)a!==e?s.push(t[a]):s.push(n);return s}function WI(t,e,n,s){const r=e.shape.length,a=t.shape.length;if(s!==0&&(s<-r||s>r))throw new Error(`Expect batchDims in the range of [-${r}, ${r}], but got ${s}`);if(s<0&&(s+=r),s>a)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${a}).`);if(n<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${n}).`);for(let f=0;f<s;++f)if(t.shape[f]!==e.shape[f])throw new Error(`x.shape[${f}]: ${t.shape[f]} should be equal to indices.shape[${f}]: ${e.shape[f]}.`);const i=t.shape[n],l=[];let c=1,u=1,h=1;for(let f=0;f<s;++f)l.push(t.shape[f]),c*=t.shape[f];for(let f=s;f<n;f++)l.push(t.shape[f]),u*=t.shape[f];for(let f=s;f<r;f++)l.push(e.shape[f]);for(let f=n+1;f<a;f++)l.push(t.shape[f]),h*=t.shape[f];return{batchSize:c,sliceSize:h,outerSize:u,dimSize:i,outputShape:l}}const m3e=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:WI,computeOutShape:xK,segOpComputeOptimalWindowSize:gK},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fc(t){try{return t.map(e=>Oc(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function yK(t){return t.map(e=>Rl(e))}const bK=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:II,ERF_A2:RI,ERF_A3:OI,ERF_A4:DI,ERF_A5:PI,ERF_P:$I,PARALLELIZE_THRESHOLD:TI,get RowPartitionType(){return Jo},SELU_SCALE:cj,SELU_SCALEALPHA:lj,applyActivation:JS,assertAndGetBroadcastShape:en,assertAxesAreInnerMostDims:Jr,assertParamsConsistent:CI,assignToTypedArray:nK,axesAreInnerMostDims:I$,calculateShapes:pd,checkEinsumDimSizes:zI,checkPadOnDimRoundingMode:Ta,combineLocations:IG,combineRaggedTensorToTensorShapes:Xq,complexWithEvenIndex:eK,complexWithOddIndex:tK,computeConv2DInfo:Or,computeConv3DInfo:ud,computeDefaultPad:f$,computeDilation2DInfo:Xy,computeOptimalWindowSize:oj,computeOutAndReduceShapes:Dr,computeOutShape:Dl,computePool2DInfo:Po,computePool3DInfo:Qc,convertConv2DDataFormat:Zc,decodeEinsumEquation:MI,eitherStridesOrDilationsAreOne:Zr,expandShapeToKeepDim:Ws,exponent:rK,exponents:sK,fromStringArrayToUint8:yK,fromUint8ToStringArray:Fc,getAxesPermutation:Os,getBroadcastDims:Ch,getComplexWithIndex:LI,getEinsumComputePath:BI,getEinsumPermutation:FI,getFusedBiasGradient:ZS,getFusedDyActivation:QS,getImageCenter:_I,getInnerMostAxes:Hs,getPermuted:fb,getRaggedRank:Qq,getReductionAxes:sr,getReshaped:mb,getReshapedPermuted:pb,getRowPartitionTypesHelper:Yq,getSliceBeginCoords:EI,getSliceSize:AI,getSparseFillEmptyRowsIndicesDenseShapeMismatch:aK,getSparseFillEmptyRowsNegativeIndexErrorMessage:iK,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:oK,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:uK,getSparseReshapeInputOutputMismatchErrorMessage:hK,getSparseReshapeInputOutputMultipleErrorMessage:dK,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:lK,getSparseReshapeNegativeOutputDimErrorMessage:cK,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:pK,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:pE,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:mK,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:fK,getUndoAxesPermutation:dd,isIdentityPermutation:UI,log:uwe,mergeRealAndImagArrays:Mc,prepareAndValidate:aj,prepareSplitSize:VI,segment_util:m3e,shouldFuse:ej,slice_util:Gq,splitRealAndImagArrays:Jq,stridesOrDilationsArePositive:kh,tupleValuesAreOne:Qu,upcastType:Va,validateDefaultValueShape:Zq,validateInput:GS,validateUpdateShape:eI,warn:zi},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f3e=Object.freeze(Object.defineProperty({__proto__:null,nonMaxSuppressionV3Impl:tj,nonMaxSuppressionV4Impl:nj,nonMaxSuppressionV5Impl:sj,whereImpl:XS},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */$Te();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vK={kernelName:Wx,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ge(t,Xh(ft(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p3e={kernelName:Vf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Jn(ft(n,"float32")),r=Ar(Tt(Bt(1),s));return gs(Mt(t,r))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g3e={kernelName:Wf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Ar(Tt(Jn(ft(n,"float32")),1));return Mt(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x3e={kernelName:Gh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=en(n.shape,s.shape);return{a:()=>{let l=t;const c=sr(n.shape,r);return c.length>0&&(l=$t(l,c)),be(l,n.shape)},b:()=>{let l=t;const c=sr(s.shape,r);return c.length>0&&(l=$t(l,c)),be(l,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y3e={kernelName:Hx,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((s,r)=>{n[r]=()=>t.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b3e={kernelName:Gx,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Sn(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v3e={kernelName:qx,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Sn(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w3e={kernelName:Hf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Mt(t,Ar(Tt(Bt(1),Jn(ft(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N3e={kernelName:Gf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Ar(nt(Bt(1),Jn(ft(n,"float32"))));return Mt(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S3e={kernelName:Xf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=en(n.shape,s.shape);return{a:()=>{const l=nt(Jn(n),Jn(s));let c=ge(t,Mt(s,l));const u=sr(n.shape,r);return u.length>0&&(c=$t(c,u)),be(c,n.shape)},b:()=>{const l=nt(Jn(n),Jn(s));let c=gs(ge(t,Mt(n,l)));const u=sr(s.shape,r);return u.length>0&&(c=$t(c,u)),be(c,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j3e={kernelName:qf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Mt(t,nt(Jn(ft(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k3e={kernelName:Kf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Mt(t,Tt(Bt(1),Jn(ft(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C3e(t,e,n,s,r,a){const i=te(t,"dy","avgPool3dGrad"),l=te(e,"input","avgPool3dGrad");let c=i,u=l,h=!1;l.rank===4&&(h=!0,c=be(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),u=be(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]])),Z(c.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${c.rank}.`),Z(u.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${u.rank}.`),Ta("avgPool3dGrad",r,a);const f={dy:c,input:u},p={filterSize:n,strides:s,pad:r,dimRoundingMode:a},x=de.runKernel(yN,f,p);return h?be(x,[x.shape[1],x.shape[2],x.shape[3],x.shape[4]]):x}const T3e=he({avgPool3dGrad_:C3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _3e={kernelName:Xx,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:a,pad:i,dimRoundingMode:l}=n;return{x:()=>T3e(t,s,r,a,i,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E3e(t,e,n,s,r){const a=te(t,"dy","avgPoolGrad"),i=te(e,"input","avgPoolGrad");Z(i.rank===a.rank,()=>`Rank of input (${i.rank}) does not match rank of dy (${a.rank})`);let l=i,c=a,u=!1;i.rank===3&&(u=!0,l=be(i,[1,i.shape[0],i.shape[1],i.shape[2]]),c=be(a,[1,a.shape[0],a.shape[1],a.shape[2]])),Z(c.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${c.rank}.`),Z(l.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${l.rank}.`);const h={dy:c,input:l},f={filterSize:n,strides:s,pad:r},p=de.runKernel(xN,h,f);return u?be(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const A3e=he({avgPoolGrad_:E3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $3e={kernelName:Kx,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:a,pad:i}=n;return{x:()=>A3e(t,s,r,a,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I3e={kernelName:Yx,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[s,r]=e,{transposeA:a,transposeB:i}=n;return!a&&!i?{a:()=>mn(t,r,!1,!0),b:()=>mn(s,t,!0,!1)}:!a&&i?{a:()=>mn(t,r,!1,!1),b:()=>mn(t,s,!0,!1)}:a&&!i?{a:()=>mn(r,t,!1,!0),b:()=>mn(s,t,!1,!1)}:{a:()=>mn(r,t,!0,!0),b:()=>mn(t,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R3e={kernelName:Qx,gradFunc:(t,e,n)=>{const{blockShape:s,crops:r}=n;return{x:()=>ib(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O3e={kernelName:KH,gradFunc:(t,e,n)=>{const s=n,r=s.inputShape,a=s.shape,i=Array.from(a);for(let c=r.length-1;c>=0;c--)if(r[c]===a[c])i[c]=1;else if(r[c]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${a}].`);const l=[];for(let c=0;c<i.length;c++)i[c]>1&&l.push(c);return{x:()=>$t(t,l,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D3e={kernelName:Yf,gradFunc:t=>({x:()=>t.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P3e={kernelName:Qf,gradFunc:t=>({x:()=>Sn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L3e={kernelName:Zf,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{clipValueMin:r,clipValueMax:a}=n;return{x:()=>_r(Io(Jc(s,r),hd(s,a)),t,Sn(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M3e={kernelName:Jx,inputsToSave:["x"],gradFunc:vK.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F3e={kernelName:ey,saveAllInputs:!0,gradFunc:(t,e,n)=>{const s=e.map(c=>c.shape),{axis:r}=n,a=fn(r,e[0].shape)[0],i=s.map(c=>c[a]);return Ua(t,i,a).map(c=>()=>c)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z3e={kernelName:ty,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{dilations:a,strides:i,pad:l,dataFormat:c}=n;return Z(Qu(a),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${a}'`),{x:()=>k$(s.shape,t,r,i,l,c),filter:()=>oI(s,t,r.shape,i,l,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B3e={kernelName:ny,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{strides:a,pad:i,dataFormat:l,dimRoundingMode:c}=n;return{dy:()=>Lc(t,r,a,i,l,1,c),filter:()=>oI(t,s,r.shape,a,i,l,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U3e(t,e,n,s,r){let a=t;t.rank===4&&(a=be(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let i=e;i.rank===4&&(i=be(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),Z(a.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${a.shape}.`),Z(i.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${i.shape}.`),Z(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),Z(a.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${a.shape[4]}) must match input depth in filter (${n[3]}.`),Z(i.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${i.shape[4]}) must match output depth for filter (${n[4]}).`);const l={x:a,dy:i},c={strides:s,pad:r,filterShape:n};return de.runKernel(SN,l,c)}const V3e=he({conv3DBackpropFilter_:U3e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W3e={kernelName:sy,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:a}=n;Z(Qu(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[i,l]=e;return{x:()=>EG(i.shape,t,l,r,a),filter:()=>V3e(i,t,l.shape,r,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H3e={kernelName:Jf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ge(gs(BS(ft(n,"float32"))),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G3e={kernelName:ep,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ge(US(ft(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q3e={kernelName:ry,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r,exclusive:a,reverse:i}=n;return{x:()=>{const l=Os([r],s.rank);let c=_S(t,r,a,!i);return l!=null&&(c=bn(c,l)),c}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K3e={kernelName:ay,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:a,dimRoundingMode:i}=n,l=s??[1,1];Z(Qu(l),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${l}'`);const[c,u]=e;return Z(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${c.rank}.`),Z(u.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${u.rank}.`),Z(c.shape[3]===u.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${c.shape[3]}) must match the inChannels dimension in filter ${u.shape[2]}.`),Z(Zr(r,l),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${r} and dilations '${l}'.`),Ta("depthwiseConv2d",a,i),{x:()=>bq(c.shape,t,u,r,a,l,i),filter:()=>yq(c,t,u.shape,r,a,l,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X3e={kernelName:iy,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,a={x:s,filter:r,dy:t},i={x:s,filter:r,dy:t};return{x:()=>de.runKernel(qw,a,n),filter:()=>de.runKernel(Kw,i,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y3e={kernelName:np,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,s={dy:t,y:n};return{x:()=>de.runKernel(ON,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q3e={kernelName:sp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=ge(Ga(gs(Jn(n))),2/Math.sqrt(Math.PI));return{x:()=>ge(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z3e={kernelName:rp,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ge(t,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J3e={kernelName:ly,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>be(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e_e={kernelName:ap,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ge(t,Ga(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t_e={kernelName:ip,gradFunc:t=>({x:()=>Sn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n_e={kernelName:op,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=en(n.shape,s.shape);return{a:()=>{const l=Mt(t,ft(s,"float32")),c=sr(n.shape,r);return c.length>0?be($t(l,c),n.shape):l},b:()=>{let l=ge(t,ft(n,"float32"));const c=sr(s.shape,r);c.length>0&&(l=be($t(l,c),s.shape));const u=Jn(s);return gs(Mt(l,ft(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s_e={kernelName:cy,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:s}=n,[r,a,i,l]=e,c=l??Bt(1),u=sr(a.shape,r.shape),h=[];if(a.rank===1){for(let T=0;T<r.shape.length-1;++T)h.push(r.shape[T]);h.push(1)}const f=Tt(r,a),p=ge(t,c),x=MS(nt(i,Bt(s))),y=ge(ge(ge(x,x),x),Bt(-.5));return{x:()=>a.rank===1?be(ge(ge(t,Ui(be(x,[1,1,1,a.shape[0]]),h)),c),r.shape):be(ge(ge(t,x),c),r.shape),mean:()=>{let T=ge(ge(x,Bt(-1)),p);return a.rank===1&&(T=$t(T,u)),be(T,a.shape)},variance:()=>{let T=ge(ge(y,f),p);return a.rank===1&&(T=$t(T,u)),be(T,a.shape)},scale:()=>{const T=ge(f,x);let E=ge(t,T);return a.rank===1&&(E=$t(E,u)),be(E,a.shape)},offset:()=>{let T=t;return a.rank===1&&(T=$t(T,u)),be(T,a.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r_e={kernelName:uy,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[s,r]=e,{axis:a,batchDims:i}=n,l=fn(a,s.shape)[0],c=(u,h,f)=>()=>{const p=u.shape,x=h.size,y=p.slice(0,l),v=y.length,b=p.slice(a,p.length).slice(1),N=b.length,S=$8(0,v),k=$8(v+1,v+1+N),T=I8([y,[x],b]),E=be(f,T),D=be(h,[x]),A=I8([[v],S,k]),I=bn(E,A);let P=KS(I,D,u.shape[l]);const $=dd(A);return P=bn(P,$),P};if(i===1){const u=s.shape[0],h=s.split(u,0);return{x:()=>ka(h.map((x,y)=>c(x,r.slice(y,1),t.slice(y,1))())).reshape(s.shape),indices:()=>r}}else return{x:c(s,r,t),indices:()=>r}}};function $8(t,e){const n=[];for(let s=t;s<e;++s)n.push(s);return n}function I8(t){const e=[];for(let n=0;n<t.length;++n)for(let s=0;s<t[n].length;++s)e.push(t[n][s]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a_e={kernelName:lp,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>Sn(n),b:()=>Sn(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i_e={kernelName:cp,gradFunc:t=>({x:()=>ft(t,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o_e={kernelName:up,gradFunc:t=>({x:()=>Sn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l_e={kernelName:dp,gradFunc:t=>({x:()=>Sn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c_e={kernelName:hp,gradFunc:t=>({x:()=>Sn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u_e={kernelName:hy,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{alpha:r}=n,a=_a(s,0);return{x:()=>_r(a,t,ge(t,r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d_e={kernelName:fp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Mt(t,nt(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h_e={kernelName:mp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Mt(t,ft(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m_e={kernelName:XH,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;return{logits:()=>{const i=Ga(s);return Tt(t,ge($t(t,r,!0),i))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f_e(t,e,n,s=5,r=1,a=1,i=.5){const l={x:t,y:e,dy:n},c={depthRadius:s,bias:r,alpha:a,beta:i};return de.runKernel(UN,l,c)}const p_e=he({localResponseNormalizationBackprop_:f_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g_e={kernelName:yy,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{depthRadius:a,bias:i,alpha:l,beta:c}=n;return{x:()=>p_e(s,r,t,a,i,l,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wK(t,e,n,s){return e.rank<n.rank&&(e=be(e,Ws(e.shape,s))),t.rank<n.rank&&(t=be(t,Ws(t.shape,s))),{x:()=>ge(t,ft(gi(n,e),t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R8={kernelName:by,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{reductionIndices:r}=s,a=e[0],i=e[1],l=fn(r,a.shape),c=wK(t,i,a,l);return{x:()=>c.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x_e={kernelName:pp,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>ge(t,ft(Jc(n,s),"float32")),b:()=>ge(t,ft(gf(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y_e(t,e,n,s,r,a,i){const l=te(t,"dy","maxPool3dGrad"),c=te(e,"input","maxPool3dGrad"),u=te(n,"output","maxPool3dGrad");let h=l,f=c,p=u,x=!1;c.rank===4&&(x=!0,h=be(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),f=be(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]]),p=be(u,[1,u.shape[0],u.shape[1],u.shape[2],u.shape[3]])),Z(h.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${h.rank}.`),Z(f.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${f.rank}.`),Z(p.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${p.rank}.`),Ta("maxPool3dGrad",a,i);const y={dy:h,input:f,output:p},v={filterSize:s,strides:r,pad:a,dimRoundingMode:i},b=de.runKernel(WN,y,v);return x?be(b,[b.shape[1],b.shape[2],b.shape[3],b.shape[4]]):b}const b_e=he({maxPool3dGrad_:y_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v_e={kernelName:wy,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:a,strides:i,pad:l,dimRoundingMode:c}=n;return{x:()=>b_e(t,s,r,a,i,l,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w_e(t,e,n,s,r,a,i){const l=te(t,"dy","maxPoolGrad"),c=te(e,"input","maxPoolGrad"),u=te(n,"output","maxPoolGrad");Z(c.rank===l.rank,()=>`Rank of input (${c.rank}) does not match rank of dy (${l.rank})`),Z(l.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),Z(c.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${c.rank}.`),Ta("maxPoolGrad",a,i);const h={dy:l,input:c,output:u},f={filterSize:s,strides:r,pad:a,dimRoundingMode:i};return de.runKernel(VN,h,f)}const N_e=he({maxPoolGrad_:w_e});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S_e={kernelName:vy,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:a,strides:i,pad:l}=n;return{x:()=>N_e(t,s,r,a,i,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j_e={kernelName:Ny,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n,a=fn(r,s.shape),l=Dr(s.shape,a)[1],c=ze(l);return{x:()=>{const h=s.shape.slice();a.forEach(x=>{h[x]=1});const f=be(t,h);return Mt(ge(f,Fa(s.shape,"float32")),c)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k_e={kernelName:Sy,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{axis:r}=s,[a,i]=e,l=fn(r,a.shape),c=wK(t,i,a,l);return{x:()=>c.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C_e={kernelName:gp,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>ge(t,ft(hd(n,s),"float32")),b:()=>ge(t,ft(_a(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T_e={kernelName:jy,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,a=r.map(i=>i[0]);return{x:()=>Nn(t,a,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const __e={kernelName:xp,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=en(n.shape,s.shape);return{a:()=>{const l=sr(n.shape,r);return l.length>0?be($t(t,l),n.shape):t},b:()=>{const l=ge(t,gs(Up(Mt(n,s)))),c=sr(s.shape,r);return c.length>0?be($t(l,c),s.shape):l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E_e={kernelName:yp,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=en(n.shape,s.shape);return{a:()=>{const l=ge(t,ft(s,"float32")),c=sr(n.shape,r);return c.length>0?be($t(l,c),n.shape):l},b:()=>{const l=ge(t,ft(n,"float32")),c=sr(s.shape,r);return c.length>0?be($t(l,c),s.shape):l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A_e={kernelName:ky,gradFunc:t=>({x:()=>gs(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $_e={kernelName:_y,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>Us(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I_e={kernelName:Ty,gradFunc:t=>({x:()=>Sn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R_e={kernelName:Ey,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:s}=n;return eo(t,s).map(a=>()=>a)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O8={kernelName:Ay,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,a=r.map(i=>i[0]);return{x:()=>Nn(t,a,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O_e={kernelName:bp,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,s,r]=e,a=n,i=s,l=en(a.shape,i.shape);return{a:()=>{const h=ft(i,"float32");let f=ge(t,ge(h,Ul(a,Tt(h,Bt(1)))));const p=sr(a.shape,l);return p.length>0&&(f=$t(f,p)),be(f,a.shape)},b:()=>{const h=_a(a,0),f=_r(h,xi(a),Sn(a));let p=ge(t,ge(r,f));const x=sr(i.shape,l);return x.length>0&&(p=$t(p,x)),be(p,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D_e={kernelName:$y,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,s]=e,r=_a(n,0);return{x:()=>_r(r,t,ge(t,s)),alpha:()=>{let a=_r(r,Sn(t),ge(t,n));const i=sr(s.shape,t.shape);return i.length>0&&(a=$t(a,i)),be(a,s.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P_e(t,e,n){const s=t.shape.slice();s[n]=1;const r=be(e,s),a=ux(t,n,!0,!1),i=ux(t,n,!0,!0),l=ge(a,i);return ge(r,l)}function L_e(t,e,n){const s=t.shape.length,r=s-n.length,a=Os(n,s);let i=t;a!=null&&(i=bn(t,a));const l=i.shape.slice(),u=l.splice(s-n.length,n.length).reduce((p,x)=>p*x,1);l.push(u);const h=i.reshape(l);let f=P_e(h,e,r);if(f=f.reshape(i.shape),a!=null){const p=dd(a);f=bn(f,p)}return f}const M_e={kernelName:Iy,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;let a=[];return r==null?a=s.shape.map((i,l)=>l):typeof r=="number"?a=[r]:a=r,{x:()=>L_e(s,t,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F_e={kernelName:tp,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=en(n.shape,s.shape);return{a:()=>{const l=Mt(t,ft(s,"float32")),c=sr(n.shape,r);return c.length>0?be($t(l,c),n.shape):l},b:()=>{let l=ge(t,ft(n,"float32"));const c=sr(s.shape,r);c.length>0&&(l=be($t(l,c),s.shape));const u=Jn(s);return gs(Mt(l,ft(u,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z_e={kernelName:vp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Mt(t,gs(Jn(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B_e={kernelName:Np,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=ge(hd(n,6),Xh(n));return{x:()=>ge(t,ft(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U_e={kernelName:wp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ge(t,ft(Xh(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V_e={kernelName:Ry,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>be(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W_e={kernelName:Dy,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>de.runKernel(nS,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H_e={kernelName:Oy,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>de.runKernel(tS,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G_e={kernelName:Py,gradFunc:(t,e,n)=>{const{dims:s}=n,r=fn(s,t.shape);return{x:()=>Ji(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q_e={kernelName:Sp,gradFunc:t=>({x:()=>Sn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K_e={kernelName:jp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>gs(Mt(t,ge(Ul(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const X_e={kernelName:Ly,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>ft(Sn(n),"float32"),t:()=>ge(t,ft(n,t.dtype)),e:()=>ge(t,ft(sb(n),t.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y_e={kernelName:kp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=_a(n,Bt(0)),r=Bt(lj),a=Bt(cj),i=ge(t,a),l=ge(ge(t,r),Ga(ft(n,"float32")));return _r(s,i,l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q_e={kernelName:Ep,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ge(t,ge(n,Tt(Bt(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z_e={kernelName:_p,gradFunc:t=>({x:()=>Sn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J_e={kernelName:Cp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ge(Zy(ft(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eEe={kernelName:Tp,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ge(TS(ft(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tEe={kernelName:My,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{begin:r,size:a}=n,i=s.shape,[l,c]=ij(s,r,a),u=[];for(let h=0;h<t.rank;h++)u.push([l[h],i[h]-l[h]-c[h]]);return{x:()=>eu(t,u)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nEe={kernelName:Uy,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{dim:r}=n,a=!0,i=ge(t,s);return{logits:()=>Tt(i,ge($t(i,[r],a),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sEe={kernelName:Ap,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ge(t,rl(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D8={kernelName:zy,gradFunc:(t,e,n)=>{const{blockShape:s,paddings:r}=n;return{x:()=>Qy(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P8={kernelName:By,gradFunc:(t,e,n)=>{const{axis:s}=n;return{x:()=>Vs(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rEe={kernelName:$p,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Mt(t,ge(Ar(ft(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aEe={kernelName:dS,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ge(t,ge(ft(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iEe={kernelName:Ip,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Bt(2);return{a:()=>ge(t,ge(r,Tt(n,s))),b:()=>ge(t,ge(r,Tt(s,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oEe={kernelName:Lp,gradFunc:t=>({x:()=>Sn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lEe={kernelName:Rp,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=en(n.shape,s.shape);return{a:()=>{let l=t;const c=sr(n.shape,r);return c.length>0&&(l=$t(l,c)),be(l,n.shape)},b:()=>{let l=t;const c=sr(s.shape,r);return c.length>0&&(l=$t(l,c)),be(gs(l),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cEe={kernelName:Fy,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,r=s.shape.slice(),{axis:a}=n;fn(a,s.shape).forEach(u=>{r[u]=1});const l=be(t,r),c=ge(l,Fa(s.shape,"float32"));return{x:()=>c}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uEe={kernelName:Op,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Mt(t,Jn(Zy(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dEe={kernelName:Dp,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>ge(Tt(Bt(1),Jn(n)),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hEe={kernelName:Pp,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{reps:r}=n;return{x:()=>{let i=Sn(s);if(s.rank===1)for(let l=0;l<r[0];++l)i=nt(i,Nn(t,[l*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let l=0;l<r[0];++l)for(let c=0;c<r[1];++c)i=nt(i,Nn(t,[l*s.shape[0],c*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let l=0;l<r[0];++l)for(let c=0;c<r[1];++c)for(let u=0;u<r[2];++u)i=nt(i,Nn(t,[l*s.shape[0],c*s.shape[1],u*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let l=0;l<r[0];++l)for(let c=0;c<r[1];++c)for(let u=0;u<r[2];++u)for(let h=0;h<r[3];++h)i=nt(i,Nn(t,[l*s.shape[0],c*s.shape[1],u*s.shape[2],h*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return i}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mEe={kernelName:ch,gradFunc:(t,e,n)=>{const s=n,{perm:r}=s,a=dd(r);return{x:()=>bn(t,a)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fEe={kernelName:Wy,gradFunc:(t,e,n)=>{const s=n,{axis:r}=s;return{value:()=>ka(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pEe={kernelName:Hy,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>gEe(t,n)}}};function gEe(t,e){const n=Gl(e,Sn(e)),s=Vp(t,n);let r=Jc(e,Bt(0,"int32"));const a=s.rank-r.rank;for(let l=0;l<a;++l)r=Br(r,l+1);r=Io(r,Fa(s.shape,"bool"));const i=Sn(s);return _r(r,s,i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xEe={kernelName:Gy,gradFunc:t=>({x:()=>Sn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yEe=[vK,p3e,g3e,x3e,y3e,b3e,v3e,w3e,N3e,S3e,j3e,k3e,_3e,$3e,I3e,R3e,O3e,D3e,P3e,L3e,M3e,F3e,B3e,z3e,W3e,H3e,G3e,q3e,K3e,X3e,F_e,Y3e,Q3e,Z3e,J3e,e_e,n_e,t_e,s_e,r_e,a_e,i_e,o_e,l_e,c_e,u_e,d_e,h_e,m_e,g_e,R8,R8,x_e,v_e,S_e,j_e,k_e,C_e,T_e,__e,E_e,A_e,$_e,I_e,R_e,O8,O8,O_e,D_e,M_e,z_e,B_e,U_e,V_e,W_e,H_e,G_e,q_e,K_e,X_e,Y_e,Q_e,Z_e,J_e,eEe,tEe,nEe,sEe,D8,D8,P8,P8,rEe,iEe,aEe,oEe,lEe,cEe,uEe,dEe,hEe,mEe,fEe,pEe,xEe];for(const t of yEe)YH(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.abs=function(){return this.throwIfDisposed(),Js(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.acos=function(){return this.throwIfDisposed(),i$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.acosh=function(){return this.throwIfDisposed(),o$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.add=function(t){return this.throwIfDisposed(),nt(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.all=function(t,e){return this.throwIfDisposed(),jS(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.any=function(t,e){return this.throwIfDisposed(),ox(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.argMax=function(t){return this.throwIfDisposed(),jh(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.argMin=function(t){return this.throwIfDisposed(),l$(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.asScalar=function(){return this.throwIfDisposed(),Z(this.size===1,()=>"The array must have only 1 element."),be(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.asType=function(t){return this.throwIfDisposed(),ft(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.as1D=function(){return this.throwIfDisposed(),be(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.as2D=function(t,e){return this.throwIfDisposed(),be(this,[t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),be(this,[t,e,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.as4D=function(t,e,n,s){return this.throwIfDisposed(),be(this,[t,e,n,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.as5D=function(t,e,n,s,r){return this.throwIfDisposed(),be(this,[t,e,n,s,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.asin=function(){return this.throwIfDisposed(),c$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.asinh=function(){return this.throwIfDisposed(),u$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.atan=function(){return this.throwIfDisposed(),d$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.atan2=function(t){return this.throwIfDisposed(),h$(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.atanh=function(){return this.throwIfDisposed(),m$(this)};We().prototype.avgPool=function(t,e,n,s){return this.throwIfDisposed(),Yy(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),Qy(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.batchNorm=function(t,e,n,s,r){return this.throwIfDisposed(),Mp(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.broadcastTo=function(t){return this.throwIfDisposed(),uh(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.cast=function(t){return this.throwIfDisposed(),ft(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.ceil=function(){return this.throwIfDisposed(),v$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),Ha(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof Tn&&(t=[t]),Vs([this,...t],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.conv1d=function(t,e,n,s,r,a){return this.throwIfDisposed(),kS(this,t,e,n,s,r,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.conv2dTranspose=function(t,e,n,s,r){return this.throwIfDisposed(),CS(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.conv2d=function(t,e,n,s,r,a){return this.throwIfDisposed(),Lc(this,t,e,n,s,r,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.cos=function(){return this.throwIfDisposed(),Zy(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.cosh=function(){return this.throwIfDisposed(),TS(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),ux(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),_S(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),_$(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.depthwiseConv2d=function(t,e,n,s,r,a){return this.throwIfDisposed(),Fp(this,t,e,n,s,r,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.dilation2d=function(t,e,n,s,r){return this.throwIfDisposed(),E$(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.divNoNan=function(t){return this.throwIfDisposed(),A$(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.div=function(t){return this.throwIfDisposed(),Mt(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.dot=function(t){return this.throwIfDisposed(),$$(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.elu=function(){return this.throwIfDisposed(),zp(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.equal=function(t){return this.throwIfDisposed(),gi(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.erf=function(){return this.throwIfDisposed(),ES(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),R$(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.exp=function(){return this.throwIfDisposed(),Ga(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.expandDims=function(t){return this.throwIfDisposed(),Br(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.expm1=function(){return this.throwIfDisposed(),O$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.fft=function(){return this.throwIfDisposed(),db(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.flatten=function(){return this.throwIfDisposed(),be(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.floor=function(){return this.throwIfDisposed(),Up(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.floorDiv=function(t){return this.throwIfDisposed(),SS(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.gather=function(t,e,n){return this.throwIfDisposed(),Vp(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.greaterEqual=function(t){return this.throwIfDisposed(),Jc(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.greater=function(t){return this.throwIfDisposed(),_a(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.ifft=function(){return this.throwIfDisposed(),vf(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.irfft=function(){return this.throwIfDisposed(),WS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.isFinite=function(){return this.throwIfDisposed(),D$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.isInf=function(){return this.throwIfDisposed(),P$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.isNaN=function(){return this.throwIfDisposed(),L$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.leakyRelu=function(t){return this.throwIfDisposed(),eb(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.lessEqual=function(t){return this.throwIfDisposed(),hd(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.less=function(t){return this.throwIfDisposed(),gf(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.localResponseNormalization=function(t,e,n,s){return this.throwIfDisposed(),M$(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.logSigmoid=function(){return this.throwIfDisposed(),F$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.logSoftmax=function(t){return this.throwIfDisposed(),IS(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),nb(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.log=function(){return this.throwIfDisposed(),xi(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.log1p=function(){return this.throwIfDisposed(),tb(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.logicalAnd=function(t){return this.throwIfDisposed(),Io(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.logicalNot=function(){return this.throwIfDisposed(),sb(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.logicalOr=function(t){return this.throwIfDisposed(),RS(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.logicalXor=function(t){return this.throwIfDisposed(),z$(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),mn(this,t,e,n)};We().prototype.maxPool=function(t,e,n,s){return this.throwIfDisposed(),rb(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.max=function(t,e){return this.throwIfDisposed(),Ki(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.maximum=function(t){return this.throwIfDisposed(),Gl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.mean=function(t,e){return this.throwIfDisposed(),Es(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.min=function(t,e){return this.throwIfDisposed(),pf(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.minimum=function(t){return this.throwIfDisposed(),Ju(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),U$(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.mod=function(t){return this.throwIfDisposed(),V$(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.mul=function(t){return this.throwIfDisposed(),ge(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.neg=function(){return this.throwIfDisposed(),gs(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.norm=function(t,e,n){return this.throwIfDisposed(),Bp(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.notEqual=function(t){return this.throwIfDisposed(),Th(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),xf(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.onesLike=function(){return this.throwIfDisposed(),yi(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.pad=function(t,e){return this.throwIfDisposed(),eu(this,t,e)};We().prototype.pool=function(t,e,n,s,r,a){return this.throwIfDisposed(),W$(this,t,e,n,s,r,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.pow=function(t){return this.throwIfDisposed(),Ul(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.prelu=function(t){return this.throwIfDisposed(),ob(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.prod=function(t,e){return this.throwIfDisposed(),H$(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.reciprocal=function(){return this.throwIfDisposed(),X$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.relu=function(){return this.throwIfDisposed(),gl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.relu6=function(){return this.throwIfDisposed(),PS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.reshapeAs=function(t){return this.throwIfDisposed(),be(this,t.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.reshape=function(t){return this.throwIfDisposed(),be(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),Sq(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),jq(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.reverse=function(t){return this.throwIfDisposed(),Ji(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.rfft=function(){return this.throwIfDisposed(),hb(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.round=function(){return this.throwIfDisposed(),LS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.rsqrt=function(){return this.throwIfDisposed(),MS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.selu=function(){return this.throwIfDisposed(),FS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.separableConv2d=function(t,e,n,s,r,a){return this.throwIfDisposed(),zS(this,t,e,n,s,r,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.sigmoid=function(){return this.throwIfDisposed(),rl(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.sign=function(){return this.throwIfDisposed(),Y$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.sin=function(){return this.throwIfDisposed(),BS(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.sinh=function(){return this.throwIfDisposed(),US(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.slice=function(t,e){return this.throwIfDisposed(),Nn(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.softmax=function(t){return this.throwIfDisposed(),ub(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.softplus=function(){return this.throwIfDisposed(),Kh(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),ib(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.split=function(t,e){return this.throwIfDisposed(),Ua(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.sqrt=function(){return this.throwIfDisposed(),Ar(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.square=function(){return this.throwIfDisposed(),Jn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.squaredDifference=function(t){return this.throwIfDisposed(),HS(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.squeeze=function(t){return this.throwIfDisposed(),fd(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof Tn?[this,t]:[this,...t];return ka(n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.step=function(t){return this.throwIfDisposed(),Xh(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.stridedSlice=function(t,e,n,s,r,a,i,l){return this.throwIfDisposed(),Q$(this,t,e,n,s,r,a,i,l)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.sub=function(t){return this.throwIfDisposed(),Tt(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.sum=function(t,e){return this.throwIfDisposed(),$t(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.tan=function(){return this.throwIfDisposed(),Z$(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.tanh=function(){return this.throwIfDisposed(),Zu(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.tile=function(t){return this.throwIfDisposed(),Ui(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.toBool=function(){return this.throwIfDisposed(),ft(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.toFloat=function(){return this.throwIfDisposed(),ft(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.toInt=function(){return this.throwIfDisposed(),ft(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.topk=function(t,e){return this.throwIfDisposed(),tI(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.transpose=function(t){return this.throwIfDisposed(),bn(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.unique=function(t){return this.throwIfDisposed(),nI(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),KS(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.unstack=function(t){return this.throwIfDisposed(),eo(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.where=function(t,e){return this.throwIfDisposed(),_r(t,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */We().prototype.zerosLike=function(){return this.throwIfDisposed(),Sn(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class kl extends Error{constructor(e){super(e),Object.setPrototypeOf(this,kl.prototype)}}class Eo extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Eo.prototype)}}class ve extends Error{constructor(e){super(e),Object.setPrototypeOf(this,ve.prototype)}}class an extends Error{constructor(e){super(e),Object.setPrototypeOf(this,an.prototype)}}class HI extends Error{constructor(e){super(e),Object.setPrototypeOf(this,HI.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class NK{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let n;return this.cache.has(e)&&(n=this.cache.get(e),this.cache.delete(e),this.cache.set(e,n)),n}put(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(e,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let n=0;n<this.maxEntries-e;n++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ah(t,e){if(Array.isArray(t)){let n=[];for(let s=0;s<e;s++)n=n.concat(t);return n}else{const n=new Array(e);return n.fill(t),n}}function Cl(t,e){if(!t)throw new HI(e)}function L8(t,e){let n=0;for(const s of t)s===e&&n++;return n}function Pa(t){return t.length===1?t[0]:t}function Hn(t){return Array.isArray(t)?t:[t]}function mc(t){const n=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function Hd(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(e,n)=>n.toUpperCase())}let No={};function GI(t){if(t==null)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function gE(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(e=>gE(e));else{const e=Object.keys(t);for(const n of e){const s=t[n];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?t[n]=s.value:gE(s))}}}function gb(t,e={},n={},s="object",r=!1){if(typeof t=="string"){const a=t;let i;if(a in n)i=n[a];else if(a in No)i=No[a];else if(i=e[a],i==null)throw new ve(`Unknown ${s}: ${t}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return i}else{const a=t;if(a.className==null||a.config==null)throw new ve(`${s}: Improper config format: ${JSON.stringify(a)}.
'className' and 'config' must set.`);const i=a.className;let l,c;if(i in n?[l,c]=n[i]:i in No?[l,c]=No.className:i in e&&([l,c]=e[i]),l==null)throw new ve(`Unknown ${s}: ${i}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(c!=null){const u={};for(const x of Object.keys(No))u[x]=No[x];for(const x of Object.keys(n))u[x]=n[x];const h=a.config;h.customObjects=u;const f=Object.assign({},No);for(const x of Object.keys(n))No[x]=n[x];gE(a.config);const p=c(l,a.config,n,r);return No=Object.assign({},f),p}else{const u=Object.assign({},No);for(const f of Object.keys(n))No[f]=n[f];const h=new l(a.config);return No=Object.assign({},u),h}}}function bEe(t,e){return t<e?-1:t>e?1:0}function c1(t,e){return-1*bEe(t,e)}function Vu(t){if(t==null)return t;const e=[];for(const n of t)e.indexOf(n)===-1&&e.push(n);return e}function vEe(t){if(t==null)throw new ve(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function Qh(t,e,n){if(n!=null&&t.indexOf(n)<0)throw new ve(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function qI(t,e,n=0,s=1/0){return Cl(n>=0),Cl(s>=n),Array.isArray(t)&&t.length>=n&&t.length<=s&&t.every(r=>typeof r===e)}function Tr(t,e){Array.isArray(t)?(Z(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((n,s)=>Tr(n,`element ${s+1} of ${e}`))):Z(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got ${SK(t)}.`)}function SK(t){return t===null?"null":Array.isArray(t)?"["+t.map(e=>SK(e)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function wEe(t,e,n){let s=n!=null?n():zr(),r;return(...i)=>{const l=n!=null?n():zr();return l-s<e||(s=l,r=t(...i)),r}}function jK(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let NEe=0;function kK(){return NEe++}const u1={};function uj(t=""){return t in u1||(u1[t]=0),u1[t]+=1,t+u1[t].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const SEe=["channelsFirst","channelsLast"],jEe=["nearest","bilinear"],kEe=["valid","same","causal"],CEe=["max","avg"],TEe=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const zm=new Map;function Gs(t){Qh(SEe,"DataFormat",t)}function _Ee(t){Qh(jEe,"InterpolationFormat",t)}function so(t){Qh(kEe,"PaddingMode",t)}function CK(t){Qh(CEe,"PoolMode",t)}const Og=[],M8="/";function dh(t,e){Og.push(t);try{const n=e();return Og.pop(),n}catch(n){throw Og.pop(),n}}function EEe(){return Og.length===0?"":Og.join(M8)+M8}function TK(t){if(!EK(t))throw new Error("Not a valid tensor name: '"+t+"'");return EEe()+t}function _K(t){if(!EK(t))throw new Error("Not a valid tensor name: '"+t+"'");zm.has(t)||zm.set(t,0);const e=zm.get(t);if(zm.set(t,zm.get(t)+1),e>0){const n=`${t}_${e}`;return zm.set(n,1),n}else return t}const AEe=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function EK(t){return!!t.match(AEe)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function $Ee(t){return t===parseInt(t.toString(),10)}function Wu(t,e,n){e==null&&(e=0),n==null&&(n=t.length);let s=1;for(let r=e;r<n;++r)s*=t[r];return s}function wf(t){if(t.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s<e&&(e=s)}return e}function ed(t){if(t.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s>e&&(e=s)}return e}function ll(t,e){if(e<t)throw new ve(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let s=t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let $3;function mr(){return $3==null&&($3=e$().epsilon()),$3}function cl(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Pl(t,e){return ft(t,e)}function xb(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),be(t,n)}function IEe(t,e){return Ee(()=>{if(t.shape.length!==2)throw new ve(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=xb(t,1);return xE(n,[1,e,1])})}function REe(t){const e=[Wu(t.shape)];return be(t,e)}function OEe(t){if(t.rank<=1)throw new ve(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],Wu(t.shape,1)];return be(t,e)}function hh(t,e,n){return Ee(()=>{switch(t.rank){case 1:return lb(t,e,n);case 2:return VS(t,[e,0],[n,t.shape[1]]);case 3:return cb(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return bf(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return Nn(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return Nn(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new ve(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function I3(t,e,n){return Ee(()=>{switch(t.rank){case 1:return lb(t,e,n);case 2:return VS(t,[0,e],[t.shape[0],n]);case 3:return cb(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return bf(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new ve(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function d1(t,e,n,s){return Ee(()=>{switch(t.rank){case 1:return lb(t,e,n);case 2:switch(s){case 1:return hh(t,e,n);case 2:return I3(t,e,n);default:throw new ve(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return hh(t,e,n);case 2:return cb(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return I3(t,e,n);default:throw new ve(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return hh(t,e,n);case 2:return bf(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return bf(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return I3(t,e,n);default:throw new ve(`The axis is not within the rank of the tensor ${s}`)}default:throw new ve(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function KI(t,e=-1){let n;return e<0&&(n=t[0].rank,n!==0?e=n:e=0),e===t[0].rank&&(e=-1),Vs(t,e)}function F8(t,e){switch(t.rank){case 1:return w$([t,e]);case 2:return N$([t,e],0);case 3:return S$([t,e],0);case 4:return j$([t,e],0);default:throw new ve(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function xE(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new ve(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return Ui(t,e)}function dj(t,e=0,n=1,s,r){return DS(t,e,n,s,r)}function Ll(t,e,n,s){if(t.rank<2||e.rank<2)throw new an(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const r=t.shape.slice(-1)[0],a=e.shape.slice(-2)[0];if(r!==a)throw new an(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`)}if(t.rank===2&&e.rank===2)return dE({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?yE(t.rank,s,cl()):null,activation:n});{const r=t.shape.slice(),a=r.pop();t=be(t,[-1,a]);const i=e.shape.slice(),l=i.pop(),c=i.pop(),u=[...i,l],h=Array.from({length:e.rank},(y,v)=>v===0?e.rank-2:v<=e.rank-2?v-1:v);e=be(bn(e,h),[c,-1]);const f=[...r,...u];return be(dE({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?yE(t.rank,s,cl()):null,activation:n}),f)}}function AK(t,e,n){return Ee(()=>(Array.isArray(e)?e=Wr(e,"int32"):e=ft(e,"int32"),Vp(t,e,n)))}function yb(t){return ge(t,t)}function yE(t,e,n){const s=e.shape;if(e.rank!==1&&e.rank!==t)throw new ve(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(t===5){if(n==="channelsFirst")return s.length===1?be(e,[1,s[0],1,1,1]):be(e,[1,s[3],s[0],s[1],s[2]]);if(n==="channelsLast")return s.length===1?be(e,[1,1,1,1,s[0]]):be(e,[1].concat(s))}else if(t===4){if(n==="channelsFirst")return s.length===1?be(e,[1,s[0],1,1]):be(e,[1,s[2],s[0],s[1]]);if(n==="channelsLast")return s.length===1?be(e,[1,1,1,s[0]]):be(e,[1].concat(s))}else if(t===3){if(n==="channelsFirst")return s.length===1?be(e,[1,s[0],1]):be(e,[1,s[1],s[0]]);if(n==="channelsLast")return s.length===1?be(e,[1,1,s[0]]):be(e,[1].concat(s))}else if(t<3)return e;throw new ve(`Unsupported input rank by biasAdd: ${e.rank}`)}function xl(t,e,n){return Ee(()=>(n==null&&(n=cl()),Gs(n),nt(t,yE(t.rank,e,n))))}function DEe(t,e=1){if(e!==1)throw new an(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return zp(t)}function PEe(t){return Ee(()=>Mt(t,nt(Js(t),1)))}function $K(t,e,n,s){return Ee(()=>aI(t,e,n,s))}function LEe(t){return Ee(()=>{const e=nt(.5,ge(.2,t));return Ha(e,0,1)})}function bb(t,e,n=!1){return n?t():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const MEe=["fanIn","fanOut","fanAvg"],FEe=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function zEe(t){Qh(MEe,"FanMode",t)}function BEe(t){Qh(FEe,"Distribution",t)}class Lo extends Yh{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class XI extends Lo{apply(e,n){return Us(e,n)}}XI.className="Zeros";it(XI);class hj extends Lo{apply(e,n){return Fa(e,n)}}hj.className="Ones";it(hj);class YI extends Lo{constructor(e){if(super(),typeof e!="object")throw new ve(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new ve(`config must have value set but got ${e}`);this.value=e.value}apply(e,n){return Ee(()=>ge(Bt(this.value),Fa(e,n)))}getConfig(){return{value:this.value}}}YI.className="Constant";it(YI);class QI extends Lo{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,n){return md(e,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}QI.className="RandomUniform";it(QI);class ZI extends Lo{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new an(`randomNormal does not support dType ${n}.`);return dj(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}ZI.className="RandomNormal";it(ZI);class JI extends Lo{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new an(`truncatedNormal does not support dType ${n}.`);return qS(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}JI.className="TruncatedNormal";it(JI);class e5 extends Lo{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,n){return Ee(()=>{if(e.length!==2||e[0]!==e[1])throw new ve("Identity matrix initializer can only be used for 2D square matrices.");return ge(this.gain,AS(e[0]))})}getConfig(){return{gain:this.gain}}}e5.className="Identity";it(e5);function UEe(t,e="channelsLast"){let n,s;if(Gs(e),t.length===2)n=t[0],s=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(e==="channelsFirst"){const r=Wu(t,2);n=t[1]*r,s=t[0]*r}else if(e==="channelsLast"){const r=Wu(t,0,t.length-2);n=t[t.length-2]*r,s=t[t.length-1]*r}}else{const r=Wu(t);n=Math.sqrt(r),s=Math.sqrt(r)}return[n,s]}class qa extends Lo{constructor(e){if(super(),e.scale<0)throw new ve(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,zEe(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,BEe(this.distribution),this.seed=e.seed}apply(e,n){const s=UEe(e),r=s[0],a=s[1];let i=this.scale;if(this.mode==="fanIn"?i/=Math.max(1,r):this.mode==="fanOut"?i/=Math.max(1,a):i/=Math.max(1,(r+a)/2),this.distribution==="normal"){const l=Math.sqrt(i);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new an(`${this.getClassName()} does not support dType ${n}.`);return qS(e,0,l,n,this.seed)}else{const l=Math.sqrt(3*i);return md(e,-l,l,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}qa.className="VarianceScaling";it(qa);class mj extends qa{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return qa.className}}mj.className="GlorotUniform";it(mj);class fj extends qa{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return qa.className}}fj.className="GlorotNormal";it(fj);class pj extends qa{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return qa.className}}pj.className="HeNormal";it(pj);class gj extends qa{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return qa.className}}gj.className="HeUniform";it(gj);class xj extends qa{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return qa.className}}xj.className="LeCunNormal";it(xj);class yj extends qa{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return qa.className}}yj.className="LeCunUniform";it(yj);class t5 extends Lo{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,n){return Ee(()=>{if(e.length<2)throw new an("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const s=ze(e.slice(0,-1)),r=e[e.length-1],a=s*r;a>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${a}) elements: Slowness may result.`);const i=[Math.max(r,s),Math.min(r,s)],l=dj(i,0,1,n,this.seed),c=cI.qr(l,!1);let u=c[0];const f=c[1].flatten().stridedSlice([0],[Math.min(r,s)*Math.min(r,s)],[Math.min(r,s)+1]);return u=ge(u,f.sign()),s<r&&(u=u.transpose()),ge(Bt(this.gain),u.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}t5.className="Orthogonal";it(t5);const z8={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function B8(t,e={}){return gb(t,Bi.getMap().classNameMap,e,"initializer")}function $s(t){return GI(t)}function ks(t){if(typeof t=="string"){const e=t in z8?z8[t]:t;if(e==="GlorotNormal")return new fj;if(e==="GlorotUniform")return new mj;if(e==="HeNormal")return new pj;if(e==="HeUniform")return new gj;if(e==="LeCunNormal")return new xj;if(e==="LeCunUniform")return new yj;{const n={};return n.className=e,n.config={},B8(n)}}else return t instanceof Lo?t:B8(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function bE(t){return Array.isArray(t)&&Array.isArray(t[0])}function e2(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function Yt(t){let e;if(Array.isArray(t)){if(t.length!==1)throw new ve(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function $n(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new ve(`Expected exactly 1 Shape; got ${t.length}`)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function t2(t){let e=0;for(const n of t)n.shape.length===0?e+=1:e+=n.shape.reduce((s,r)=>s*r);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const U8="Variable";class IK{constructor(e,n="float32",s=U8,r=!0,a=null){this.dtype=n??"float32",this.shape=e.shape,this.id=kK(),s=s??U8,this.originalName=TK(s),this.name=_K(this.originalName),this.trainable_=r,this.constraint=a,this.val=sI(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),VEe(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function VEe(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function vE(t){return t.map(e=>e.read())}function n5(t){t.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class er{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class ul{constructor(e,n,s,r,a,i,l){this.dtype=e,this.shape=n,this.sourceLayer=s,this.inputs=r,this.callArgs=a,this.outputTensorIndex=l,this.id=kK(),i!=null&&(this.originalName=TK(i),this.name=_K(this.originalName)),this.rank=n.length}}let WEe=0;class bj{constructor(e,n){this.callArgs=n,this.id=WEe++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const s of e.inboundLayers)s!=null&&s.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const n of this.inboundLayers)n!=null?e.push(n.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let HEe=0;class pn extends Yh{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=HEe++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=e.name;if(!n){const s=this.getClassName();n=mc(s)+"_"+uj(s)}if(this.name=n,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let s;if(e.batchInputShape!=null)s=e.batchInputShape;else if(e.inputShape!=null){let a=null;e.batchSize!=null&&(a=e.batchSize),s=[a].concat(e.inputShape)}this.batchInputShape=s;let r=e.dtype;r==null&&(r=e.inputDType),r==null&&(r="float32"),this.dtype=r}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,n){return e.name+"_ib-"+n.toString()}getNodeAtIndex(e,n){if(this.inboundNodes.length===0)throw new Eo(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=e)throw new ve(`Asked to get ${n} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return Pa(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return Pa(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new kl(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new kl(`Layer ${this.name} is not connected, no input to return.`);return Pa(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new kl(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new kl(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return Pa(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(n=>n.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const n=Hn(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const s=Hn(this.inputSpec);if(n.length!==s.length)throw new ve(`Layer ${this.name} expects ${s.length} inputs, but it received ${n.length} input tensors. Input received: ${e}`);for(let r=0;r<n.length;r++){const a=n[r],i=s[r];if(i==null)continue;const l=a.rank;if(i.ndim!=null&&l!==i.ndim)throw new ve(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${i.ndim}, found ndim=${l}`);if(i.maxNDim!=null&&l>i.maxNDim)throw new ve(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${i.maxNDim}, found ndim=${l}`);if(i.minNDim!=null&&l<i.minNDim)throw new ve(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${i.minNDim}, found ndim=${l}.`);if(i.dtype!=null&&a.dtype!==i.dtype)throw new ve(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${i.dtype}, found dtype=${a.dtype}.`);if(i.axes){const c=a.shape;for(const u in i.axes){const h=Number(u),f=i.axes[u],p=h>=0?c[h]:c[c.length+h];if(f!=null&&[f,null].indexOf(p)===-1)throw new ve(`Input ${r} is incompatible with layer ${this.name}: expected axis ${h} of input shape to have value ${f} but got shape ${c}.`)}}if(i.shape!=null)for(let c=0;c<i.shape.length;++c){const u=i.shape[c],h=a.shape[c];if(u!=null&&h!=null&&u!==h)throw new ve(`Input ${r} is incompatible with layer ${this.name}: expected shape=${i.shape}, found shape=${a.shape}.`)}}}call(e,n){return e}invokeCallHook(e,n){this._callHook!=null&&this._callHook(e,n)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,n){n=n||{},this.assertNotDisposed();const s=Hn(e),r=KEe(e),a=XEe(e);if(r===a)throw new ve("Arguments to apply() must be all SymbolicTensors or all Tensors");return dh(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const i=[];for(const l of Hn(e))i.push(l.shape);this.build(Pa(i)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&a&&(this._refCount=1)}if(this.assertInputCompatibility(e),a){let i=this.call(e,n);this.supportsMasking&&this.setMaskMetadata(e,i);const l=Hn(i),c=[];for(let u of l)s.indexOf(u)!==-1&&(u=u.clone()),c.push(u);if(i=Pa(c),this.activityRegularizer!=null)throw new an("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}else{const i=GEe(e),l=this.computeOutputShape(i);let c;const u=qEe(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?i[0]:i),l!=null&&l.length>0&&Array.isArray(l[0])?c=l.map((h,f)=>new ul(u,h,this,Hn(e),n,this.name,f)):c=new ul(u,l,this,Hn(e),n,this.name),this.addInboundNode(e,c,null,null,i,l,n),this._refCount++,this.activityRegularizer!=null)throw new an("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return c}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((s,r)=>{s!=null&&e[r]!=null&&e[r]!==s&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new kl(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const n of this.inboundNodes){const s=JSON.stringify(n.outputShapes);e.indexOf(s)===-1&&e.push(s)}if(e.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new kl(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Eo(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return t2(this.weights)}build(e){this.built=!0}getWeights(e=!1){return vE(e?this.trainableWeights:this.weights)}setWeights(e){Ee(()=>{const n=this.weights;if(n.length!==e.length)throw new ve(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${n.length} weights. Provided weights: ${e}...`);if(n.length===0)return;const s=[],r=vE(n);for(let a=0;a<r.length;++a){const i=r[a],l=n[a],c=e[a];if(!xn(i.shape,c.shape))throw new ve(`Layer weight shape ${i.shape} not compatible with provided weight shape ${c.shape}`);s.push([l,c])}n5(s)})}addWeight(e,n,s,r,a,i,l,c){if(this._addedWeightNames.indexOf(e)!==-1)throw new ve(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(r=c!=null?c():ks("zeros"));const u=r.apply(n,s),h=new IK(u,s,e,i,l);return u.dispose(),a!=null&&this.addLoss(()=>a.apply(h.read())),i==null&&(i=!0),i?this._trainableWeights.push(h):this._nonTrainableWeights.push(h),h}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=Hn(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}setMaskMetadata(e,n,s){if(!this.supportsMasking)return;const r=this.computeMask(e,s),a=Hn(n),i=Hn(r);if(a.length!==i.length)throw new Error(`${this.name} outputs ${a.length} tensors but ${a.length} masks for those tensors`);for(let l=0;l<a.length;l++)a[l].kerasMask=i[l]}addInboundNode(e,n,s,r,a,i,l=null){const c=Hn(e);n=Hn(n),s=Hn(s),r=Hn(r),a=e2(a),i=e2(i);const u=[],h=[],f=[];for(const p of c)u.push(p.sourceLayer),h.push(p.nodeIndex),f.push(p.tensorIndex);new bj({outboundLayer:this,inboundLayers:u,nodeIndices:h,tensorIndices:f,inputTensors:c,outputTensors:n,inputMasks:s,outputMasks:r,inputShapes:a,outputShapes:i},l);for(let p=0;p<n.length;p++)n[p].sourceLayer=this,n[p].nodeIndex=this.inboundNodes.length-1,n[p].tensorIndex=p}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function GEe(t){t=Hn(t);const e=[];for(const n of t)e.push(n.shape);return Pa(e)}function qEe(t){return"float32"}function RK(t,e,n){if((e==null||n!=null&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),e.inboundNodes.length===0)return[t];{const s=e.inboundNodes[n];if(s.inboundLayers.length===0)return s.inputTensors;{const r=[];for(let a=0;a<s.inboundLayers.length;a++){const i=s.inputTensors[a],l=s.inboundLayers[a],c=s.nodeIndices[a],u=RK(i,l,c);for(const h of u)r.indexOf(h)===-1&&r.push(h)}return r}}}function KEe(t){let e=!0;for(const n of Hn(t))if(!(n instanceof ul)){e=!1;break}return e}function XEe(t){let e=!0;for(const n of Hn(t))if(n instanceof ul){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Gp extends pn{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:uj("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new ve("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=e.batchInputShape;if(n==null){if(e.inputShape==null)throw new ve("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new ve("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=e.dtype||"float32";this.batchInputShape=n,this.dtype=s,this.inputSpec=[{shape:n}];const r=new ul(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new bj({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(e,n){throw new ve(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}Gp.className="InputLayer";it(Gp);function OK(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new ve("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;t.shape!=null&&e==null&&(e=[null].concat(t.shape));let n=t.dtype;return n==null&&(n="float32"),new Gp({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function YEe(t,e){if(t.dtype==null||t.dtype===e.dtype)return e;try{return ft(e,t.dtype)}catch{throw new ve(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}class Lu{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof Lu)for(const n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(e==null)return;for(const n of e)this.add(n.key,n.value)}}add(e,n,s){if(this.id2Value[e.id]==null)this.id2Value[e.id]=YEe(e,n),this.name2Id[e.name]=e.id,s!=null&&(this.id2Mask[e.id]=s);else throw new ve(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof ul){if(this.id2Value[e.id]==null)throw new ve(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const n=this.name2Id[e];if(n==null)throw new ve(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[n]}}getMask(e){if(e instanceof ul){if(this.id2Value[e.id]==null)throw new ve(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const n=this.name2Id[e];if(n==null)throw new ve(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&Jt(this.id2Mask)}}const n2=new NK,s2=new NK;function QEe(t){n2!=null&&n2.setMaxEntries(t),s2!=null&&s2.setMaxEntries(t)}function Ng(t,e,n,s){const r=n==null?!1:n.training,a=Array.isArray(t),i=a?t:[t],l=i.map(y=>y.name),c=[],u=e.names();for(const y of l)u.indexOf(y)!==-1?c.push(e.getValue(y)):c.push(null);const h=l.join(",")+"|"+e.names().sort().join(",");let f=n2.get(h),p;if(f==null){const y=ZEe(i,e);f=y.sorted,p=y.recipientCounts,n2.put(h,f),s2.put(h,p)}p={},r||Object.assign(p,s2.get(h));const x=new Lu(e);for(let y=0;y<f.length;++y){const v=f[y],b=v.sourceLayer;if(b instanceof Gp)continue;const N=[],S=[],k=[];let T=!1;for(const P of v.inputs){const $=x.getValue(P),R=x.getMask(P);N.push($),S.push(R),R!=null&&(T=!0),r||(p[P.name]--,p[P.name]===0&&!e.hasKey(P)&&l.indexOf(P.name)===-1&&!$.isDisposed&&P.sourceLayer.stateful!==!0&&k.push($))}T&&(n=n||{},n.mask=S[0]);const E=Hn(b.apply(N,n));let D=null;b.supportsMasking&&(D=b.computeMask(N,S));const A=e4e(v),I=Array.isArray(A)?A:[A];for(let P=0;P<I.length;++P){x.hasKey(I[P])||x.add(I[P],E[P],Array.isArray(D)?D[0]:D);const $=l.indexOf(I[P].name);$!==-1&&(c[$]=E[P])}r||Jt(k)}return x.disposeMasks(),a?c:c[0]}function ZEe(t,e){Z(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],s={};if(t.length===1){const r=V8(t[0],e);n=r.sorted,s=r.recipientMap}else{const r=new Set;for(const a of t){const{sorted:i,recipientMap:l}=V8(a,e);for(const c of i)r.has(c.name)||(n.push(c),r.add(c.name));for(const c in l)s[c]==null&&(s[c]=new Set),l[c].forEach(u=>s[c].add(u))}}return{sorted:n,recipientCounts:JEe(s)}}function JEe(t){const e={};for(const n in t)e[n]=t[n].size;return e}function V8(t,e){const n=new Set,s=[],r={};for(const l of e.names())n.add(l);const a=[],i=[];for(a.push(t);a.length>0;){const l=a[a.length-1];if(n.has(l.name)){a.pop();continue}const c=i[i.length-1]===a.length-1;if(l.inputs.length===0||c)a.pop(),s.push(l),n.add(l.name),c&&i.pop();else{i.push(a.length-1);for(const u of l.inputs)r[u.name]==null&&(r[u.name]=new Set),r[u.name].add(l.name),!n.has(u.name)&&a.push(u)}}return{sorted:s,recipientMap:r}}function e4e(t){let e;if(t.sourceLayer.inboundNodes.length===1)e=t.sourceLayer.output;else{let n=null;for(let s=0;s<t.sourceLayer.inboundNodes.length;++s)for(const r of t.sourceLayer.inboundNodes[s].outputTensors)if(r.id===t.id){n=s;break}e=t.sourceLayer.getOutputAt(n)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t4e=$e();t4e.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,QEe);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function s5(t,e){return Ee(()=>Ar($t(ge(t,t),e,!0)))}class vb extends Yh{getConfig(){return{}}}class r5 extends vb{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return Ee(()=>{const n=s5(e,this.axis),s=Ha(n,0,this.maxValue);return ge(e,Mt(s,nt(mr(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}r5.className="MaxNorm";it(r5);class a5 extends vb{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return Ee(()=>Mt(e,nt(mr(),s5(e,this.axis))))}getConfig(){return{axis:this.axis}}}a5.className="UnitNorm";it(a5);class i5 extends vb{apply(e){return gl(e)}}i5.className="NonNeg";it(i5);class o5 extends vb{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return Ee(()=>{const n=s5(e,this.axis),s=nt(ge(this.rate,Ha(n,this.minValue,this.maxValue)),ge(1-this.rate,n));return ge(e,Mt(s,nt(mr(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}o5.className="MinMaxNorm";it(o5);const W8={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function pr(t){return GI(t)}function H8(t,e={}){return gb(t,Bi.getMap().classNameMap,e,"constraint")}function gr(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in W8?W8[t]:t,config:{}};return H8(n)}else return t instanceof vb?t:H8(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function n4e(t){return new r5(t)}function s4e(t){return new a5(t)}function r4e(){return new i5}function a4e(t){return new o5(t)}const i4e=Object.freeze(Object.defineProperty({__proto__:null,maxNorm:n4e,minMaxNorm:a4e,nonNeg:r4e,unitNorm:s4e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function o4e(){return new XI}function l4e(){return new hj}function c4e(t){return new YI(t)}function u4e(t){return new QI(t)}function d4e(t){return new ZI(t)}function h4e(t){return new JI(t)}function m4e(t){return new e5(t)}function f4e(t){return new qa(t)}function p4e(t){return new mj(t)}function g4e(t){return new fj(t)}function x4e(t){return new pj(t)}function y4e(t){return new gj(t)}function b4e(t){return new xj(t)}function v4e(t){return new yj(t)}function w4e(t){return new t5(t)}const N4e=Object.freeze(Object.defineProperty({__proto__:null,constant:c4e,glorotNormal:g4e,glorotUniform:p4e,heNormal:x4e,heUniform:y4e,identity:m4e,leCunNormal:b4e,leCunUniform:v4e,ones:l4e,orthogonal:w4e,randomNormal:d4e,randomUniform:u4e,truncatedNormal:h4e,varianceScaling:f4e,zeros:o4e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function _u(t){if(t==null)return;const e=[],n=[],s=[];for(const r in t){const a=t[r];if(typeof a!="number"){const i=a;e.push(i.data()),n.push(r),s.push(i)}}if(e.length>0){const r=await Promise.all(e);for(let a=0;a<r.length;++a)t[n[a]]=r[a][0];Jt(s)}}function DK(t){if(t!=null)for(const e in t){const n=t[e];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var G8;(function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"})(G8||(G8={}));const S4e=125;class Nf{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,n){}async onEpochEnd(e,n){}async onBatchBegin(e,n){}async onBatchEnd(e,n){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class PK{constructor(e,n=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=n}append(e){this.callbacks.push(e)}setParams(e){for(const n of this.callbacks)n.setParams(e)}setModel(e){for(const n of this.callbacks)n.setModel(e)}async onEpochBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochBegin(e,n)}async onEpochEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochEnd(e,n)}async onBatchBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchBegin(e,n)}async onBatchEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchEnd(e,n)}async onTrainBegin(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainEnd(e)}}class j4e extends Nf{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,n){n==null&&(n={});const s=n.size==null?0:n.size;this.seen+=s;for(const r in n){const a=n[r];if(typeof a=="number")this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+a*s;else{let i;r in this.totals?i=this.totals[r]:this.totals[r]=0;const l=Ee(()=>nt(this.totals[r],ge(a,s)));this.totals[r]=l,i!=null&&i.dispose()}}}async onEpochEnd(e,n){if(n!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?n[s]=this.totals[s]/this.seen:Ee(()=>{const r=ge(Mt(1,this.seen),this.totals[s]);n[s]=r,this.totals[s].dispose(),hr(n[s])}))}}class LK extends Nf{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,n){n==null&&(n={}),this.epoch.push(e);for(const s in n)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(n[s])}async syncData(){const e=[],n=[],s=[];for(const a in this.history){const i=this.history[a];for(let l=0;l<i.length;++l)if(typeof i[l]!="number"){const c=i[l];e.push(c.data()),n.push(a),s.push(l)}}const r=await Promise.all(e);for(let a=0;a<r.length;++a)this.history[n[a]][s[a]].dispose(),this.history[n[a]][s[a]]=r[a][0]}}class MK extends Nf{constructor(e,n){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||kI,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=S4e),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");Hw(this.yieldEvery)&&(this.maybeWait=wEe(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,n,s){const r=[];this.yield!=null&&(await _u(s),r.push(this.yield(e,n,s))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,n){this.currentEpoch=e,this.epochBegin!=null&&(await _u(n),await this.epochBegin(e,n))}async onEpochEnd(e,n){const s=[];this.epochEnd!=null&&(await _u(n),s.push(this.epochEnd(e,n))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(e,n){this.batchBegin!=null&&(await _u(n),await this.batchBegin(e,n))}async onBatchEnd(e,n){const s=[];this.batchEnd!=null&&(await _u(n),s.push(this.batchEnd(e,n))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):Hw(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,e,n)),await Promise.all(s)}async onTrainBegin(e){this.trainBegin!=null&&(await _u(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await _u(e),await this.trainEnd(e))}}function FK(t,e){return t==null&&(t={}),t instanceof Nf?[t]:Array.isArray(t)&&t[0]instanceof Nf?t:Hn(t).map(s=>new MK(s,e))}class Pi{constructor(){}static registerCallbackConstructor(e,n){Z(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),Pi.checkForDuplicate(n),Pi.constructors[e]==null&&(Pi.constructors[e]=[]),Pi.constructors[e].push(n)}static checkForDuplicate(e){for(const n in Pi.constructors)Pi.constructors[+n].forEach(r=>{if(r===e)throw new ve("Duplicate callback constructor.")})}static clear(){Pi.constructors={}}static createCallbacks(e){const n=[];for(const s in Pi.constructors){const r=+s;e>=r&&n.push(...Pi.constructors[r])}return n.map(s=>new s)}}Pi.constructors={};function zK(t,e,n,s,r,a,i,l,c){const u=new LK,h=[new j4e,...Pi.createCallbacks(e)];t!=null&&h.push(...t),h.push(u);const f=new PK(h);return f.setParams({epochs:n,initialEpoch:s,samples:r,steps:a,batchSize:i,verbose:e,doValidation:l,metrics:c}),{callbackList:f,history:u}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function al(t,e={},n=!1){return gb(t,Bi.getMap().classNameMap,e,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function r2(t,e){return Ee(()=>{t.dtype!=="float32"&&(t=ft(t,"float32"));const n=$t(yb(t),e,!0),s=qh(n.shape,mr()),r=Ar(Gl(n,s));return Mt(t,r)})}function Zh(t,e){return Ee(()=>Es(yb(Tt(e,t)),-1))}function vj(t,e){return Ee(()=>Es(Js(Tt(e,t)),-1))}function qp(t,e){return Ee(()=>{const n=Tt(t,e),s=Ha(Js(t),mr(),Number.MAX_VALUE),r=Js(Mt(n,s));return ge(100,Es(r,-1))})}function k4e(t,e){return Ee(()=>{const n=Ha(e,mr(),Number.MAX_VALUE),s=xi(nt(1,n)),r=Ha(t,mr(),Number.MAX_VALUE),a=xi(nt(1,r));return Es(yb(Tt(s,a)),-1)})}function C4e(t,e){return Ee(()=>{const n=Gl(0,Tt(1,ge(t,e)));return Es(yb(n),-1)})}function T4e(t,e){return Ee(()=>{const n=Gl(0,Tt(1,ge(t,e)));return Es(n,-1)})}function _4e(t,e){return Ee(()=>{const n=$t(ge(t,e),-1),s=Ki(ge(Tt(1,t),e),-1);return Gl(0,nt(1,Tt(s,n)))})}function E4e(t,e){return Ee(()=>{const n=Math.log(2),s=Tt(e,t),r=Tt(nt(s,Kh(ge(-2,s))),n);return Es(r,-1)})}function dx(t,e,n=!1){return Ee(()=>{if(n)e=ub(e);else{const s=$t(e,e.shape.length-1,!0);e=Mt(e,s)}return e=Ha(e,mr(),1-mr()),gs($t(ge(ft(t,"float32"),xi(e)),e.shape.length-1))})}function a2(t,e,n=!1){return Ee(()=>{const s=ft(Up(REe(t)),"int32");e=Ha(e,mr(),1-mr());const r=e.shape,a=be(xf(s,r[r.length-1]),r);return dx(a,e,n)})}function A4e(t,e){if(!xn(t.shape,e.shape))throw new ve(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return Ee(()=>{const n=gl(e),s=gs(Js(e));return nt(Tt(n,ge(e,t)),tb(Ga(s)))})}function wj(t,e){return Ee(()=>{let n;return n=Ha(e,mr(),1-mr()),n=xi(Mt(n,Tt(1,n))),Es(A4e(t,n),-1)})}function $4e(t,e){return Ee(()=>{const n=Ha(t,mr(),1),s=Ha(e,mr(),1);return $t(ge(t,xi(Mt(n,s))),-1)})}function I4e(t,e){return Ee(()=>{const n=xi(nt(mr(),e));return Es(Tt(e,ge(t,n)),-1)})}function l5(t,e){return Ee(()=>{const n=r2(t,-1),s=r2(e,-1),r=ge(n,s);return gs($t(r,-1))})}const i2={meanSquaredError:Zh,meanAbsoluteError:vj,meanAbsolutePercentageError:qp,meanSquaredLogarithmicError:k4e,squaredHinge:C4e,hinge:T4e,categoricalHinge:_4e,logcosh:E4e,categoricalCrossentropy:dx,sparseCategoricalCrossentropy:a2,binaryCrossentropy:wj,kullbackLeiblerDivergence:$4e,poisson:I4e,cosineProximity:l5};function R3(t){if(typeof t=="string"){if(t in i2)return i2[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new ve(e)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function c5(t,e){return Ee(()=>{const n=ge(.5,yi(e)),s=Pl(_a(e,n),t.dtype);return Es(gi(t,s),-1)})}function u5(t,e){return Ee(()=>Pl(gi(jh(t,-1),jh(e,-1)),"float32"))}function BK(t,e){return Ee(()=>ft($t(Io(gi(t,1),gi(e,1))),"float32"))}function R4e(t,e){return Ee(()=>ft($t(Io(gi(t,1),gi(e,0))),"float32"))}function O4e(t,e){return Ee(()=>ft($t(Io(gi(t,0),gi(e,1))),"float32"))}function UK(t,e){return Ee(()=>{const n=BK(t,e),s=O4e(t,e),r=nt(n,s);return ft(_r(_a(r,0),Mt(n,r),0),"float32")})}function D4e(t,e){return Ee(()=>{const n=BK(t,e),s=R4e(t,e),r=nt(n,s);return ft(_r(_a(r,0),Mt(n,r),0),"float32")})}function VK(t,e){return wj(t,e)}function WK(t,e){return t.rank===e.rank&&(t=fd(t,[t.rank-1])),e=jh(e,-1),e.dtype!==t.dtype&&(e=ft(e,t.dtype)),ft(gi(t,e),"float32")}function P4e(t,e){return Ee(()=>{const n=t.sub(e).square().sum(),s=t.sub(t.mean()).square().sum();return Bt(1).sub(n.div(s))})}const L4e=Zh,M4e=Zh,F4e=vj,z4e=vj,B4e=qp,U4e=qp,d5=dx,V4e=l5,HK=a2,o2={binaryAccuracy:c5,categoricalAccuracy:u5,precision:UK,categoricalCrossentropy:d5,sparseCategoricalCrossentropy:HK,mse:L4e,MSE:M4e,mae:F4e,MAE:z4e,mape:B4e,MAPE:U4e,cosine:V4e};function W4e(t){if(typeof t=="string"&&t in o2)return o2[t];if(typeof t!="string"&&t!=null)return t;throw new ve(`Unknown metric ${t}`)}function h1(t){if(Cl(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let e;for(const n of Object.keys(i2))if(i2[n]===t){e=n;break}if(e!==void 0)return e;for(const n of Object.keys(o2))if(o2[n]===t){e=n;break}return e!==void 0?e:t.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function H4e(t){const e={Adagrad:()=>Bd.adagrad(.01),Adadelta:()=>Bd.adadelta(1,.95,mr()),Adam:()=>Bd.adam(.001,.9,.999,mr()),Adamax:()=>Bd.adamax(.002,.9,.999,mr(),0),RMSProp:()=>Bd.rmsprop(.001,.9,0,mr()),SGD:()=>Bd.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new ve(`Unknown Optimizer ${t}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const q8=1*1024*1024;function K8(t,e,n=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!wE(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const s=JSON.stringify(t);s.length>q8&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${q8}.`)}}function wE(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e)if(typeof n!="string"||!wE(t[n]))return!1;return!0}else if(Array.isArray(t)){for(const e of t)if(!wE(e))return!1;return!0}else return!1;else{const e=typeof t;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function G4e(t,e,n,s=console.log){const r=K4e(t),a=["Layer (type)","Input Shape","Output shape","Param #"];r?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(h=>Math.floor(e*h)));let i;if(!r){a.push("Receives inputs"),i=[];for(const h in t.nodesByDepth)i.push(...t.nodesByDepth[h])}s("_".repeat(e)),l2(a,n,s),s("=".repeat(e));const l=t.layers;for(let h=0;h<l.length;++h)r?X4e(l[h],n,s):Y4e(l[h],n,i,s),s((h===l.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const c=q4e(t),u=t2(t.nonTrainableWeights);s(`Total params: ${c+u}`),s(`Trainable params: ${c}`),s(`Non-trainable params: ${u}`),s("_".repeat(e))}function q4e(t){let e;return t.collectedTrainableWeights!=null?e=t2(t.collectedTrainableWeights):e=t2(t.trainableWeights),e}function K4e(t){let e=!0;const n=[],s=[];for(const r in t.nodesByDepth)n.push(t.nodesByDepth[r]);for(const r of n){if(r.length>1||r.length===1&&r[0].inboundLayers.length>1){e=!1;break}s.push(...r)}if(e)for(const r of t.layers){let a=!1;for(const i of r.inboundNodes)if(s.indexOf(i)!==-1)if(a){e=!1;break}else a=!0;if(!e)break}return e}function l2(t,e,n=console.log){let s="";for(let r=0;r<t.length;++r)r>0&&(s=s.slice(0,s.length-1)+" "),s+=t[r],s=s.slice(0,e[r]),s+=" ".repeat(e[r]-s.length);n(s)}function X4e(t,e,n){let s,r;try{r=t.inboundNodes.map(c=>JSON.stringify(c.inputShapes)).join(",")}catch{r="multiple"}try{s=JSON.stringify(t.outputShape)}catch{s="multiple"}const a=t.name,i=t.getClassName(),l=[`${a} (${i})`,r,s,t.countParams().toString()];l2(l,e,n)}function Y4e(t,e,n,s){let r,a;try{a=t.inboundNodes.map(f=>JSON.stringify(f.inputShapes)).join(",")}catch{a="multiple"}try{r=JSON.stringify(t.outputShape)}catch{r="multiple"}const i=[];for(const f of t.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(f)===-1))for(let p=0;p<f.inboundLayers.length;++p){const x=f.inboundLayers[p].name,y=f.nodeIndices[p],v=f.tensorIndices[p];i.push(`${x}[${y}][${v}]`)}const l=t.name,c=t.getClassName(),u=i.length===0?"":i[0],h=[`${l} (${c})`,a,r,t.countParams().toString(),u];l2(h,e,s);for(let f=1;f<i.length;++f)l2(["","","","",i[f]],e,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function GK(t,e,n){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&e===0&&typeof n=="string"}function hx(t,e){if(t===null)return null;if(typeof t=="string")return Hd(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const a=t[r];GK(e,r,a)?n.push(a):n.push(hx(a,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s];if(s==="name"&&typeof r=="string")n[s]=r;else{const a=Hd(s);n[a]=hx(r,a)}}return n}}function NE(t,e){if(t==null)return null;if(typeof t=="string")return mc(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const a=t[r];GK(e,r,a)?n.push(a):n.push(NE(a,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s],a=mc(s);(s==="name"||s==="className")&&typeof r=="string"?n[a]=r:n[a]=NE(r,s)}return n}}/** @license See the LICENSE file. */const Nj="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const Q4e=t=>{const e=Object.keys(t);if(e.length===0)return!1;const n=e[0].split("/");return!isNaN(parseInt(n[n.length-1],10))};class Yo extends pn{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const S=this.getClassName().toLowerCase();this.name=uj(S)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],Vu(this.inputs).length!==this.inputs.length)throw new ve(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(S=>S.name)}`);Vu(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(S=>S.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const S of this.outputs){const k=S.sourceLayer,T=S.nodeIndex,E=S.tensorIndex;this.outputLayers.push(k),this.outputLayersNodeIndices.push(T),this.outputLayersTensorIndices.push(E)}for(const S of this.inputs){const k=S.sourceLayer,T=S.nodeIndex,E=S.tensorIndex;Cl(T===0,"input layer has >1 nodes"),Cl(E===0,"input layer has >1 tensors"),this.inputLayers.push(k),this.inputLayersNodeIndices.push(T),this.inputLayersTensorIndices.push(E)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let S=0;S<this.inputLayers.length;S++){const k=this.inputLayers[S];if(!(k instanceof Gp))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${S} (0-based) originates from layer type ${k.getClassName()}.`);this.inputNames.push(k.name),this.feedInputShapes.push(k.batchInputShape),this.feedInputNames.push(k.name)}for(const S of this.outputLayers)this.outputNames.push(S.name);this.internalInputShapes=this.inputs.map(S=>S.shape),this.internalOutputShapes=this.outputs.map(S=>S.shape);const n={},s={},r={},a={},i={},l=[],c=(S,k,T,E,D,A)=>{(E==null||D==null||A==null)&&(E=S.sourceLayer,D=S.nodeIndex,A=S.tensorIndex);const I=E.inboundNodes[D];if(T.indexOf(I)!==-1)throw new Eo(`The tensor ${S.name} at layer "${E.name}" is part of a cycle.`);if(k.indexOf(I)!==-1)return;this.containerNodes.add(Yo.nodeKey(E,D)),E.id in i||(i[E.id]=Object.keys(i).length),T.indexOf(I)===-1&&T.push(I);const P=I.inboundLayers.length;for(let $=0;$<P;$++){const R=I.inputTensors[$],F=I.inboundLayers[$],W=I.nodeIndices[$],q=I.tensorIndices[$];c(R,k,T,F,W,q)}for(k.push(I);T.indexOf(I)>=0;)T.splice(T.indexOf(I),1);l.push(I)},u=[],h=[];for(const S of this.outputs)c(S,u,h);const f=l.slice().reverse();for(const S of f){s[S.id]=S,S.id in n||(n[S.id]=0);let k=n[S.id];const T=r[S.outboundLayer.id]==null?0:r[S.outboundLayer.id];k=Math.max(k,T),r[S.outboundLayer.id]=k,a[S.outboundLayer.id]=S.outboundLayer,n[S.id]=k;for(let E=0;E<S.inboundLayers.length;E++){const D=S.inboundLayers[E],A=S.nodeIndices[E],I=D.inboundNodes[A],P=n[I.id]==null?0:n[I.id];n[I.id]=Math.max(k+1,P),s[I.id]=I}}const p={};for(const S in n){const k=n[S];k in p||(p[k]=[]),p[k].push(s[S])}const x={};for(const S in r){const k=r[S];k in x||(x[k]=[]),x[k].push(a[S])}let y=Object.keys(x).map(S=>parseInt(S,10)).sort(c1);this.layers=[];for(const S of y){const k=x[S];k.sort((T,E)=>{const D=i[T.id],A=i[E.id];return D<A?-1:D>A?1:0});for(const T of k)T instanceof Yo&&this.internalContainerRefs.push(T),this.layers.push(T)}this.layersByDepth=x,y=Object.keys(p).map(S=>parseInt(S,10)).sort(c1);const v=this.inputs.slice(),b=[];for(const S of y)for(const k of p[S]){const T=k.outboundLayer;if(T!=null){for(const E of k.inputTensors)if(v.indexOf(E)===-1)throw new Eo(`Graph disconnected: cannot obtain value for tensor ${E} at layer "${T.name}". The following previous layers were accessed without issue: ${b}`);for(const E of k.outputTensors)v.push(E);b.push(T.name)}}this.nodesByDepth=p;const N=this.layers.map(S=>S.name);for(const S of N){const k=N.filter(T=>T===S).length;if(k!==1)throw new Eo(`The name "${S}" is used ${k} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(N))}this.outboundNodes=[],this.inboundNodes=[],new bj({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(S=>null),outputMasks:this.outputs.map(S=>null),inputShapes:this.inputs.map(S=>S.shape),outputShapes:this.outputs.map(S=>S.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)e.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)e.numDisposedVariables+=n.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(n=>{n._trainableWeights.forEach(s=>s.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new ve("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const n of this.layers)e=e.concat(n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.layers)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.layers)n.push(...s.trainableWeights);return n.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,n=!0){const s={};let r=0;const a=Q4e(e);a&&this.parseWeights(e);for(const l of this.layers)for(const[c,u]of l.weights.entries()){const h=a?`${u.name.split("/").slice(0,-1).join("/")+"/"}${c}`:u.originalName;if(s[h]!=null)throw new ve(`Duplicate weight name: ${h}`);s[h]=u,r++}const i=[];for(const l in e){let c=l;if(s[l]==null){const u=l.split("/");c=u.slice(0,-2).concat([u[u.length-1]]).join("/")}if(s[c]!=null)i.push([s[c],e[l]]);else if(n)throw new ve(`Provided weight data has no target variable: ${l}`);delete s[c]}if(n){const l=[];for(const c in s)l.push(c);if(l.length>0)throw new ve(`${l.length} of ${r} weights are not set: ${l}`)}n5(i)}parseWeights(e){for(const n in Object.keys(e)){const s=n.split("/"),r=["vars","layer_checkpoint_dependencies"],a=s.map(i=>i.startsWith("_")?i.slice(1):i).filter(i=>!r.includes(i)).join("/");a!==n&&(e[a]=e[n],delete e[n])}}updatedConfig(){const e=this.getConfig(),n={};return n.className=this.getClassName(),n.config=e,n.kerasVersion=`tfjs-layers ${Nj}`,n.backend="TensorFlow.js",n}toJSON(e,n=!0){const s=NE(this.updatedConfig());return n?JSON.stringify(s):s}call(e,n){return Ee(()=>{e=Hn(e);const s=new Lu;for(let r=0;r<this.inputs.length;++r)s.add(this.inputs[r],e[r]);return Ng(this.outputs,s,n)})}computeMask(e,n){return Ee(()=>{e=Hn(e);let s;return n==null?s=Ah(null,e.length):s=Hn(n),this.runInternalGraph(e,s)[1]})}computeOutputShape(e){const n=e2(e);if(n.length!==this.inputLayers.length)throw new ve(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let l=0;l<n.length;l++){const c=this.inputLayers[l],u=n[l],h=c.name+"_0_0";s[h]=u}const r=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(c1);if(r.length>1)for(const l of r){const c=this.nodesByDepth[l];for(const u of c){const h=u.outboundLayer;if(this.inputLayers.map(v=>v.id).indexOf(h.id)!==-1)continue;const f=[];for(let v=0;v<u.inboundLayers.length;v++){const b=u.inboundLayers[v],N=u.nodeIndices[v],S=u.tensorIndices[v],k=`${b.name}_${N}_${S}`,T=s[k];f.push(T)}const p=h.computeOutputShape(Pa(f)),x=e2(p),y=h.inboundNodes.indexOf(u);for(let v=0;v<x.length;v++){const b=`${h.name}_${y}_${v}`;s[b]=x[v]}}}const a=[],i=[];for(let l=0;l<this.outputLayers.length;l++){const c=this.outputLayers[l],u=this.outputLayersNodeIndices[l],h=this.outputLayersTensorIndices[l],f=`${c.name}_${u}_${h}`;i.push(f)}for(let l=0;l<i.length;l++){const c=i[l];Cl(c in s),a.push(s[c])}return Pa(a)}runInternalGraph(e,n){n==null&&(n=Ah(null,e.length));const s={};for(let c=0;c<this.inputs.length;++c){const u=this.inputs[c],h=e[c],f=n[c];s[u.id]=[h,f]}const r=Object.keys(this.nodesByDepth).map(c=>parseInt(c,10)).sort(c1);for(const c of r){const u=this.nodesByDepth[c];for(const h of u){const f=h.outboundLayer,p=h.inputTensors,x=h.outputTensors,y=new Array;for(const v of p)v.id in s&&y.push(s[v.id]);if(y.length===p.length){let v={},b,N,S,k;if(h.callArgs!=null&&(v=h.callArgs),y.length===1){const[T,E]=y[0];v.mask==null&&(v.mask=E),S=Hn(f.call(T,v)),k=Hn(f.computeMask(T,E)),b=[T],N=[E]}else b=y.map(T=>T[0]),N=y.map(T=>T[1]),v.mask==null&&(v.mask=N),S=Hn(f.call(b,v)),k=Hn(f.computeMask(b,N));if(f.activityRegularizer)throw new an("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let T=0;T<x.length;++T){const E=x[T],D=S[T],A=k[T];s[E.id]=[D,A]}}}}const a=[],i=[],l=[];for(const c of this.outputs){Cl(c.id in s,`Could not compute output ${c.name} : ${c.id}`);const[u,h]=s[c.id];l.push(u.shape),a.push(u),i.push(h)}return[a,i,l]}buildNodeConversionMap(e){const n={};let s;for(const r of this.layers){s=r instanceof Yo?1:0;for(let a=0;a<r.inboundNodes.length;a++){const i=Yo.nodeKey(r,a);this.containerNodes.has(i)&&(n[i]=s,s+=1)}}return n}getLayer(e,n){if(n!=null)return this.findLayer(n);if(e==null)throw new ve("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const s of this.layers)if(s.name===e)return s;throw new ve(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new ve(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return Ee(()=>{const e=[];for(const n of this.layers)for(let s=0;s<n.inboundNodes.length;++s){const r=Yo.nodeKey(n,s);this.containerNodes.has(r)&&e.push(...n.calculateLosses())}return e})}getConfig(){const e={name:this.name},n=this.buildNodeConversionMap(this.layers),s=[];for(const i of this.layers){const l=i.getClassName(),c=i.getConfig(),u=[];for(let f=0;f<i.inboundNodes.length;f++){const p=i.inboundNodes[f],x=Yo.nodeKey(i,f);let y={};if(this.containerNodes.has(x)){if(p.callArgs)try{JSON.stringify(p.callArgs),y=p.callArgs}catch{console.warn(`Layer ${i.name} was passed non-serializable keyword arguments: ${p.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),y={}}if(p.inboundLayers.length>0){const v=[];for(let b=0;b<p.inboundLayers.length;b++){const N=p.inboundLayers[b],S=p.nodeIndices[b],k=p.tensorIndices[b],T=Yo.nodeKey(N,S);let E=n[T];E==null&&(E=0),v.push([N.name,E,k,y])}u.push(v)}}}const h={};h.name=i.name,h.className=l,h.config=c,h.inboundNodes=u,s.push(h)}e.layers=s;const r=[];for(let i=0;i<this.inputLayers.length;i++){const l=this.inputLayers[i],c=this.inputLayersNodeIndices[i],u=Yo.nodeKey(l,c);if(!this.containerNodes.has(u))continue;let h=n[u];h==null&&(h=0);const f=this.inputLayersTensorIndices[i];r.push([l.name,h,f])}e.inputLayers=r;const a=[];for(let i=0;i<this.outputLayers.length;i++){const l=this.outputLayers[i],c=this.outputLayersNodeIndices[i],u=Yo.nodeKey(l,c);if(!this.containerNodes.has(u))continue;let h=n[u];h==null&&(h=0);const f=this.outputLayersTensorIndices[i];a.push([l.name,h,f])}return e.outputLayers=a,e}static fromConfig(e,n,s={},r=!1){const a={},i={};function l(b,N){b.name in i?i[b.name].push(N):i[b.name]=[N]}function c(b,N){const S=[];let k;for(const T of N){const E=T[0],D=T[1],A=T[2];if(k=T[3]==null?{}:T[3],!(E in a)){l(b,N);return}const I=a[E];if(I.inboundNodes.length<=D){l(b,N);return}const P=I.inboundNodes[D];S.push(P.outputTensors[A])}S.length>0&&b.apply(Pa(S),k)}function u(b){const N=b.name,S=al(b,n.customObjects!=null?n.customObjects:{});S.setFastWeightInitDuringBuild(r),a[N]=S,b.inboundNodes.forEach(T=>{if(!(T instanceof Array))throw new ve(`Corrupted configuration, expected array for nodeData: ${T}`);l(S,T)})}const h=n.name,f=n.layers;for(const b of f)u(b);for(;!vEe(i);)for(const b of f){const N=a[b.name];if(N.name in i){const S=i[N.name];delete i[N.name];for(const k of S)c(N,k)}}const p=[],x=[],y=n.inputLayers;for(const b of y){const N=b[0],S=b[1],k=b[2];Cl(N in a);const E=a[N].inboundNodes[S].outputTensors;p.push(E[k])}const v=n.outputLayers;for(const b of v){const N=b[0],S=b[1],k=b[2];Cl(N in a);const E=a[N].inboundNodes[S].outputTensors;x.push(E[k])}return new e({inputs:p,outputs:x,name:h})}get stateful(){if(this._stateful)throw new ve("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){Ee(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Z4e(t,e,n){const s=e.length;if(t==null||Array.isArray(t)&&t.length===0)return e.map(r=>null);if(s===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==s)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){const r=[];return e.forEach(a=>{a in t?r.push(t[a]):r.push(null)}),r}else throw new Error(`The model has multiple (${s}) outputs, so ${n} must be either an array with ${s} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function qK(t,e){return Z4e(t,e,"classWeight")}async function KK(t,e,n,s){if(n!=null){const r=Ee(()=>{if(t.shape.length===1)return Ol(t);if(t.shape.length===2){if(t.shape[1]>1)return jh(t,1);if(t.shape[1]===1)return be(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),a=Array.from(await r.data());Jt(r);const i=[];return a.forEach(l=>{if(n[l]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${l} exists in the data but not in classWeight`);i.push(n[l])}),Wr(i,"float32")}else return null}function J4e(t,e){return ge(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const eAe=32;function XK(t,e){let n,s;const r=e;n=r.xs,s=r.ys,Z(n!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const a=X8("input",t.inputNames,n),i=X8("output",t.outputNames,s),l=a[0].shape[0];Z(a.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${a.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),Z(i.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${i.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let c=0;c<a.length;c++)Z(a[c].shape[0]===l,()=>`Batch size mismatch: input ${t.inputNames[c]} has ${a[c].shape[0]}; expected  ${l} based on input ${t.inputNames[0]}.`);for(let c=0;c<i.length;c++)Z(i[c].shape[0]===l,()=>`Batch size mismatch: output ${t.outputNames[c]} has ${i[c].shape[0]}; expected  ${l} based on input ${t.inputNames[0]}.`);return{xs:a,ys:i}}function X8(t,e,n){if(n instanceof Tn)return[n];if(Array.isArray(n))return Z(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const s=[];for(const r of e){if(n[r]==null)throw new ve(`The feature data generated by the dataset lacks the required ${t} key '${r}'.`);s.push(n[r])}return s}}function tAe(t){if(t.length===3)throw new an("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function nAe(t,e,n){const s=n.batchesPerEpoch!=null;if(Z(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),Z(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),Z(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),Z(!s||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),Z(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const r=n.validationData!=null;let a,i;if(r)if(Y8(n.validationData))Z(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const b=tAe(n.validationData);a=b.xs,i=b.ys}const l=t.makeTrainFunction(),c=t.getDedupedMetricsNames();let u;r?u=c.slice().concat(c.map(b=>"val_"+b)):u=c.slice();const h=FK(n.callbacks,n.yieldEvery),f=n.verbose==null?1:n.verbose,{callbackList:p,history:x}=zK(h,f,n.epochs,null,null,sAe(e,n),null,r,u);p.setModel(t),t.history=x,await p.onTrainBegin(),t.stopTraining_=!1;let y=n.initialEpoch==null?0:n.initialEpoch,v=await e.iterator();for(;y<n.epochs;){const b={};await p.onEpochBegin(y);let N=0,S=0;for(s||(v=await e.iterator());!s||N<n.batchesPerEpoch;){const k=await v.next();if(s&&k.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${N} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(k.value!=null){const{xs:T,ys:E}=XK(t,k.value),D={};D.batch=S,D.size=T[0].shape[0],await p.onBatchBegin(S,D);const A=[];if(n.classWeight!=null){const $=qK(n.classWeight,t.outputNames);for(let R=0;R<$.length;++R)A.push(await KK(E[R],null,$[R]))}const I=T.concat(E).concat(A),P=l(I);Jt(I);for(let $=0;$<c.length;++$){const R=c[$],F=P[$];D[R]=F,hr(F)}await p.onBatchEnd(S,D),DK(D),S++,N++}if(s?N>=n.batchesPerEpoch:k.done){if(r){let T;Y8(n.validationData)?T=Hn(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):T=Hn(t.evaluate(a,i,{batchSize:n.validationBatchSize==null?eAe:n.validationBatchSize,verbose:0}));for(let E=0;E<t.metricsNames.length;++E)b[`val_${t.metricsNames[E]}`]=T[E]}break}if(t.stopTraining_)break}if(await p.onEpochEnd(y,b),y++,t.stopTraining_)break}return await p.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function sAe(t,e){let n=null;return e.batchesPerEpoch!=null?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function Y8(t){return typeof t.iterator=="function"}function rAe(t){return typeof t.next=="function"}async function aAe(t,e,n){n=n||{};const s=n.batches!=null,r=t.testFunction;let a=[];if(n.verbose>0)throw new an("Verbose mode is not implemented yet.");Z(!s||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const i=rAe(e)?e:await e.iterator();let l=0,c=0;for(;!s||c<n.batches;){const u=await i.next();if(a=Ee(()=>{if(u.value){const{xs:h,ys:f}=XK(t,u.value),p=h.concat(f),x=Ee(()=>r(p));if(Jt(p),c===0)for(let v=0;v<x.length;++v)a.push(Bt(0));const y=p[0].shape[0];for(let v=0;v<x.length;++v){const b=x[v],N=a[v];a[v]=Ee(()=>nt(a[v],ge(y,b))),c>0&&Jt(N)}Jt(x),l+=y,++c}return a}),u.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let u=0;u<a.length;++u){const h=a[u];a[u]=Mt(a[u],l),Jt(h)}return Pa(a)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function O3(t){Z(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function dg(t,e,n){return t==null?[null]:Array.isArray(t)?t.map(s=>hh(s,e,n-e)):hh(t,e,n-e)}function SE(t,e){return Ee(()=>t==null?null:Array.isArray(t)?t.map(n=>SE(n,e)):AK(t,e.dtype==="int32"?e:ft(e,"int32")))}function D3(t,e){const n=[];let s=0,r=null;for(;s<t;)r=s+e,r>=t&&(r=t),n.push([s,r]),s=r;return n}function YK(t){const e=[];t instanceof Tn&&(t=[t]);for(let n=0;n<t.length;++n){const s=t[n];if(s.rank===1)e.push(xb(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(s)}}return e}function Ko(t,e){if(t==null)return;const n=[];if(e instanceof Tn)n.push(e.id);else if(Array.isArray(e))e.forEach(r=>n.push(r.id));else if(e!=null)for(const r in e){const a=e[r];n.push(a.id)}const s=[];if(t instanceof Tn)n.indexOf(t.id)===-1&&s.push(t);else if(Array.isArray(t))t.forEach(r=>{n.indexOf(r.id)===-1&&s.push(r)});else if(t!=null)for(const r in t){const a=t[r];n.indexOf(a.id)===-1&&s.push(a)}s.forEach(r=>{r.isDisposed||r.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function iAe(t){return t instanceof Tn}function jE(t){return Array.isArray(t)}function Q8(t){return!iAe(t)&&!jE(t)}function Z8(t,e,n,s=!0,r=""){if(e==null||e.length===0){if(t!=null){let i=!1;if(jE(t)&&t.length>0)i=!0;else if(Q8(t)){for(const l in t)if(t.hasOwnProperty(l)){i=!0;break}}else i=!0;if(i)throw new ve(`Error when checking model ${r} expected no data, but got ${t}`)}return[]}if(t==null)return e.map(i=>null);let a;if(Q8(t)){t=t,a=[];for(const i of e){if(t[i]==null)throw new ve(`No data provided for "${i}". Need data for each key in: ${e}`);a.push(t[i])}}else if(jE(t)){if(t=t,t.length!==e.length)throw new ve(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);a=t}else{if(t=t,e.length>1)throw new ve(`The model ${r} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);a=[t]}if(a=YK(a),n!=null)for(let i=0;i<e.length;++i){if(n[i]==null)continue;const l=a[i];if(l.shape.length!==n[i].length)throw new ve(`Error when checking ${r}: expected ${e[i]} to have ${n[i].length} dimension(s). but got array with shape ${l.shape}`);for(let c=0;c<n[i].length;++c){if(c===0&&!s)continue;const u=l.shape[c],h=n[i][c];if(h!=null&&h>=0&&u!==h)throw new ve(`${r} expected a batch of elements where each example has shape [${n[i].slice(1,n[i].length)}] (i.e.,tensor shape [*,${n[i].slice(1,n[i].length)}]) but the ${r} received an input with ${l.shape[0]} examples, each with shape [${l.shape.slice(1,l.shape.length)}] (tensor shape [${l.shape}])`)}}return a}function oAe(t,e,n){const s=Vu(t.map(a=>a.shape[0]));s.sort();const r=Vu(e.map(a=>a.shape[0]));if(r.sort(),s.length>1)throw new ve(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(a=>a.shape))}`);if(r.length>1)throw new ve(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(a=>a.shape))}`);if(s.length>0&&r.length>0&&!xn(s,r))throw new ve(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${r[0]} target sample(s).`)}function lAe(t,e,n){const s=[Zh,wj,dx];for(let r=0;r<t.length;++r){const a=t[r],i=e[r],l=n[r];if(i!=null){if(i===dx&&a.shape[a.shape.length-1]===1)throw new ve(`You are passing a target array of shape ${a.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(i)!==-1){const c=a.shape.slice(1),u=l.slice(1);for(let h=0;h<c.length;++h){const f=c[h],p=u[h];if(p!=null&&f!==p)throw new ve(`A target Tensor with shape ${a.shape} was passed for an output of shape ${l}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function J8(t,e,n,s=!0,r=""){let a;if(Array.isArray(t)){if(t.length!==e.length)throw new ve(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);a=t}else{if(e.length>1)throw new ve(`The model expects ${e.length} ${r} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);a=[t]}if(n!=null)for(let i=0;i<e.length;++i){if(n[i]==null)continue;const l=a[i];if(l.shape.length!==n[i].length)throw new ve(`Error when checking ${r}: expected ${e[i]} to have ${n[i].length} dimension(s), but got array with shape ${JSON.stringify(l.shape)}`);for(let c=0;c<n[i].length;++c){if(c===0&&!s)continue;const u=l.shape[c],h=n[i][c];if(h!=null&&h!==u)throw new ve(`Error when checking ${r}: expected ${e[i]} to have shape ${JSON.stringify(n[i])} but got array with shape ${JSON.stringify(l.shape)}.`)}}}function cAe(t,e){if(t==null||Array.isArray(t)&&t.length===0)return e.map(s=>[]);let n;if(typeof t=="string"||typeof t=="function")n=[t];else if(Array.isArray(t)||typeof t=="object")n=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(n))return e.map(s=>n);{const s=[];for(const r of e){let a=n.hasOwnProperty(r)?n[r]:[];Array.isArray(a)||(a=[a]),s.push(a)}return s}}const uAe="layers-model";class Cc extends Yo{constructor(e){super(e),this.isTraining=!1}summary(e,n,s=console.log){if(!this.built)throw new ve("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");G4e(this,e,n,s)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=H4e(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof nu))throw new ve("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const i in e.loss)if(this.outputNames.indexOf(i)===-1)throw new ve(`Unknown entry in loss dictionary: "${i}". Only expected the following keys: ${this.outputNames}`);for(const i of this.outputNames)e.loss[i]==null&&console.warn(`Output "${i}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${i} during training`),n.push(R3(e.loss[i]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new ve(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);n=e.loss.map(l=>R3(l))}else{const i=R3(e.loss);this.outputs.forEach(l=>{n.push(i)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){const l=this.internalOutputShapes[i],c=this.outputNames[i];this.feedOutputNames.push(c),this.feedOutputShapes.push(l),this.feedLossFns.push(this.lossFunctions[i])}const s=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],dh("loss",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const l=this.lossFunctions[i];this.outputs.length>1&&(this.metricsTensors.push([l,i]),this.metricsNames.push(this.outputNames[i]+"_loss"))}});const r=cAe(e.metrics,this.outputNames),a=(i,l,c)=>{this.outputNames.length>1&&(l=this.outputNames[i]+"_"+l),this.metricsNames.push(l),this.metricsTensors.push([c,i])};dh("metric",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const l=r[i];(u=>{let f,p,x;for(const y of u){if(typeof y=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(y)!==-1){const b=this.internalOutputShapes[i];b[b.length-1]===1||this.lossFunctions[i]===wj?["accuracy","acc"].indexOf(y)!==-1?p=c5:["crossentropy","ce"].indexOf(y)!==-1&&(p=VK):this.lossFunctions[i]===a2?["accuracy","acc"].indexOf(y)!==-1?p=WK:["crossentropy","ce"].indexOf(y)!==-1&&(p=HK):["accuracy","acc"].indexOf(y)!==-1?p=u5:["crossentropy","ce"].indexOf(y)!==-1&&(p=d5);let N;["accuracy","acc"].indexOf(y)!==-1?N="acc":["crossentropy","ce"].indexOf(y)!==-1&&(N="ce"),x=p,f=""+N}else x=W4e(y),f=""+h1(y);let v;dh(f,()=>{v=x}),a(i,f,v)}})(l)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,n,s={}){const r=s.batchSize==null?32:s.batchSize;O3(r);const i=this.standardizeUserDataXY(e,n,!0,r);try{const l=i[0].concat(i[1]);this.makeTestFunction();const c=this.testFunction,u=this.testLoop(c,l,r,s.verbose,s.steps);return Pa(u)}finally{Ko(i[0],e),Ko(i[1],n)}}async evaluateDataset(e,n){return this.makeTestFunction(),aAe(this,e,n)}checkNumSamples(e,n,s,r="steps"){let a;if(s!=null){if(a=null,n!=null)throw new ve(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(e!=null)Array.isArray(e)?a=e[0].shape[0]:a=e.shape[0];else throw new ve(`Either the input data should have a defined shape, or ${r} shoud be specified.`);return a}execute(e,n){if(Array.isArray(n)&&n.length===0)throw new ve("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(n),r=s?n:[n],a=this.retrieveSymbolicTensors(r),i=new Lu;if(e instanceof Tn&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new ve(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let c=0;c<this.inputs.length;++c)i.add(this.inputs[c],e[c])}else for(const c of this.inputs){const u=e[c.name];if(u==null)throw new ve(`No value is provided for the model's input ${c.name}`);i.add(c,u)}const l=Ng(a,i);return s?l:l[0]}retrieveSymbolicTensors(e){const n=Ah(null,e.length);let s=e.length;for(const r of this.layers){const a=Array.isArray(r.output)?r.output:[r.output],i=a.map(l=>l.name);for(let l=0;l<e.length;++l){const c=i.indexOf(e[l]);if(c!==-1&&(n[l]=a[c],s--),s===0)break}if(s===0)break}if(s>0){const r=[];throw n.forEach((a,i)=>{a==null&&r.push(e[i])}),new ve(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(r)}`)}return n}predictLoop(e,n=32,s=!1){return Ee(()=>{const r=this.checkNumSamples(e);if(s)throw new an("Verbose predictLoop() is not implemented yet.");const a=D3(r,n),i=this.outputs.map(l=>[]);for(let l=0;l<a.length;++l)Ee(()=>{const u=a[l][0],h=a[l][1],f=dg(e,u,h),p=[];if(Array.isArray(f))for(let y=0;y<f.length;++y)p.push({key:this.inputs[y],value:f[y]});else p.push({key:this.inputs[0],value:f});const x=new Lu(p);return Ng(this.outputs,x)}).forEach((u,h)=>i[h].push(u));return Pa(i.map(l=>Vs(l,0)))})}predict(e,n={}){const s=YK(e);J8(s,this.inputNames,this.feedInputShapes,!1);try{const r=n.batchSize==null?32:n.batchSize;return O3(r),this.predictLoop(s,r)}finally{Ko(s,e)}}predictOnBatch(e){J8(e,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,n)}standardizeUserDataXY(e,n,s=!0,r){if(this.optimizer_==null)throw new Eo("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const a=[];for(let i=0;i<this.feedOutputShapes.length;++i){const l=this.feedOutputShapes[i];this.feedLossFns[i]===a2?a.push(l.slice(0,l.length-1).concat([1])):a.push(l)}if(e=Z8(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=Z8(n,this.feedOutputNames,a,!1,"target"),oAe(e,n),lAe(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&e[0].shape[0]%r!==0)throw new ve(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${e[0].shape[0]} sample(s).`);return[e,n]}async standardizeUserData(e,n,s,r,a=!0,i){const[l,c]=this.standardizeUserDataXY(e,n,a,i);if(s!=null)throw new Error("sample weight is not supported yet.");let u=null;if(r!=null){const h=qK(r,this.outputNames);u=[];for(let f=0;f<h.length;++f)u.push(await KK(c[f],null,h[f]))}return[l,c,u]}testLoop(e,n,s,r=0,a){return Ee(()=>{const i=this.checkNumSamples(n,s,a,"steps"),l=[];if(r>0)throw new an("Verbose mode is not implemented yet.");if(a!=null)throw new an("steps mode in testLoop() is not implemented yet");{const c=D3(i,s),u=Wr(ll(0,i));for(let h=0;h<c.length;++h){const f=c[h][0],p=c[h][1],x=hh(u,f,p-f),y=SE(n,x),v=e(y);if(h===0)for(let b=0;b<v.length;++b)l.push(Bt(0));for(let b=0;b<v.length;++b){const N=v[b];l[b]=nt(l[b],ge(p-f,N))}}for(let h=0;h<l.length;++h)l[h]=Mt(l[h],i)}return l})}getDedupedMetricsNames(){const e=this.metricsNames,n=[];for(let s=0;s<e.length;++s){const r=e[s];let a=r;if(L8(e,r)>1){const i=L8(e.slice(0,s),r);a+=`_${i}`}n.push(a)}return n}makeTrainFunction(){return e=>{const n=[],s=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),a=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),i=[],l=()=>{const f=[];for(let v=0;v<this.inputs.length;++v)f.push({key:this.inputs[v],value:s[v]});const p=new Lu(f),x=Ng(this.outputs,p,{training:!0});let y;for(let v=0;v<this.lossFunctions.length;++v){const b=this.lossFunctions[v];let N=b(r[v],x[v]);a[v]!=null&&(N=J4e(N,a[v]));const S=Es(N);n.push(S),v===0?y=N:y=nt(y,N)}for(let v=0;v<this.metricsTensors.length;++v){let b;if(this.outputs.length>1&&v<this.outputs.length)b=n[v];else{const N=this.metricsTensors[v][0],S=this.metricsTensors[v][1];b=Es(N(r[S],x[S]))}hr(b),i.push(b)}return y=Es(y),this.calculateLosses().forEach(v=>{y=nt(y,v)}),y},c=this.collectedTrainableWeights.map(f=>f.read());return[this.optimizer_.minimize(l,!0,c)].concat(i)}}makeTestFunction(){this.testFunction=e=>Ee(()=>{const n=[];let s;const r=e.slice(0,this.inputs.length),a=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let u=0;u<this.inputs.length;++u)i.push({key:this.inputs[u],value:r[u]});const l=new Lu(i),c=Ng(this.outputs,l);for(let u=0;u<this.lossFunctions.length;++u){const h=this.lossFunctions[u],f=Es(h(a[u],c[u]));u===0?s=f:s=nt(s,f),n.push(s)}for(let u=0;u<this.metricsTensors.length;++u){const h=this.metricsTensors[u][0],f=this.metricsTensors[u][1],p=Es(h(a[f],c[f]));n.push(p)}return n})}async fit(e,n,s={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let r,a,i,l,c,u,h,f,p;try{const x=s.batchSize==null?32:s.batchSize;O3(x);const v=await this.standardizeUserData(e,n,s.sampleWeight,s.classWeight,!1,x);r=v[0],a=v[1],p=v[2];let b=!1,N;if(s.validationData!=null&&s.validationData.length>0){if(b=!0,s.validationData.length===2)c=s.validationData[0],u=s.validationData[1];else throw s.validationData.length===3?new an("validationData including sample weights is not supported yet."):new ve(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const $=await this.standardizeUserData(c,u,null,null,!0,x);h=$[0],f=$[1],N=h.concat(f)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){b=!0;const P=Math.floor(r[0].shape[0]*(1-s.validationSplit)),$=r[0].shape[0];h=dg(r,P,$),i=r,r=dg(r,0,P),f=dg(a,P,$),l=a,a=dg(a,0,P),N=h.concat(f)}else s.validationSteps!=null&&(b=!0);const S=r.concat(a).concat(p);this.checkTrainableWeightsConsistency();const k=this.makeTrainFunction(),T=this.getDedupedMetricsNames();let E,D;b?(this.makeTestFunction(),E=this.testFunction,D=T.slice().concat(T.map(P=>"val_"+P))):(E=null,N=[],D=T.slice());const A=FK(s.callbacks,s.yieldEvery);return await this.fitLoop(k,S,T,x,s.epochs,s.verbose,A,E,N,s.shuffle,D,s.initialEpoch,null,null)}finally{this.isTraining=!1,Ko(r,e),Ko(a,n),Ko(i,e),Ko(l,n),Ko(h,c),Ko(f,u),p!=null&&Jt(p)}}async fitLoop(e,n,s,r,a,i,l,c,u,h,f,p,x,y){r==null&&(r=32),a==null&&(a=1),h==null&&(h=!0),p==null&&(p=0);let v=!1;if(c!=null&&u!=null&&(v=!0),y!=null&&(v=!0,x==null))throw new ve("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const b=this.checkNumSamples(n,r,x,"steps_per_epoch");let N;b!=null&&(N=ll(0,b)),i==null&&(i=1);const{callbackList:S,history:k}=zK(l,i,a,p,b,x,r,v,f);S.setModel(this),this.history=k,await S.onTrainBegin(),this.stopTraining_=!1;for(let T=p;T<a;++T){await S.onEpochBegin(T);const E={};if(x!=null)throw new an("stepsPerEpoch mode is not implemented yet.");{if(h==="batch")throw new an("batch shuffling is not implemneted yet");h&&VA(N);const D=Wr(N),A=D3(b,r);for(let I=0;I<A.length;++I){const P={};if(await S.onBatchBegin(I,P),Ee(()=>{const $=A[I][0],R=A[I][1],F=hh(D,$,R-$);P.batch=I,P.size=R-$;const W=SE(n,F),q=e(W);for(let X=0;X<s.length;++X){const z=s[X],K=q[X];P[z]=K,hr(K)}if(I===A.length-1&&v){const X=this.testLoop(c,u,r);for(let z=0;z<s.length;++z){const K=s[z],H=X[z];hr(H),E["val_"+K]=H}}}),await S.onBatchEnd(I,P),DK(P),this.stopTraining_)break}D.dispose()}if(await S.onEpochEnd(T,E),this.stopTraining_)break}return await S.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,n){return nAe(this,e,n)}async trainOnBatch(e,n){const s=await this.standardizeUserData(e,n),r=s[0],a=s[1],l=this.makeTrainFunction()(r.concat(a)),c=[];for(const u of l){const h=await u.data();c.push(h[0])}return Jt(l),Ko(s[0],e),Ko(s[1],n),Pa(c)}getNamedWeights(e){const n=[],s=e!=null&&e.trainableOnly,r=s?this.trainableWeights:this.weights,a=this.getWeights(s);for(let i=0;i<r.length;++i)s&&!r[i].trainable||n.push({name:r[i].originalName,tensor:a[i]});return n}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=rE().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-rE().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=mc(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(n=>mc(n))}else{const n=Object.keys(this.loss);e={};const s=this.loss;for(const r of n)if(typeof s[r]=="string")e[r]=mc(s[r]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[mc(h1(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>mc(h1(e)));{const e={};for(const n in this.metrics)e[n]=mc(h1(this.metrics[n]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=hx(e.optimizer_config),s=al(n);let r;if(typeof e.loss=="string")r=Hd(e.loss);else if(Array.isArray(e.loss))r=e.loss.map(i=>Hd(i));else if(e.loss!=null){r={};for(const i in e.loss)r[i]=Hd(e.loss[i])}let a;if(Array.isArray(e.metrics))a=e.metrics.map(i=>Hd(i));else if(e.metrics!=null){a={};for(const i in e.metrics)a[i]=Hd(e.metrics[i])}this.compile({loss:r,metrics:a,optimizer:s})}async save(e,n){if(typeof e=="string"){const u=gG(e);if(u.length===0)throw new ve(`Cannot find any save handlers for URL '${e}'`);if(u.length>1)throw new ve(`Found more than one (${u.length}) save handlers for URL '${e}'`);e=u[0]}if(e.save==null)throw new ve("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await aE(this.getNamedWeights(n)),l={modelTopology:this.toJSON(null,!1),format:uAe,generatedBy:`TensorFlow.js tfjs-layers v${Nj}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){l.trainingConfig=this.getTrainingConfig();const u="optimizer",{data:h,specs:f}=await aE(await this.optimizer.getWeights(),u);s.specs.push(...f),s.data=fG([s.data,h])}return this.userDefinedMetadata!=null&&(K8(this.userDefinedMetadata,this.name,!0),l.userDefinedMetadata=this.userDefinedMetadata),l.weightData=s.data,l.weightSpecs=s.specs,e.save(l)}setUserDefinedMetadata(e){K8(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}Cc.className="Model";it(Cc);class QK extends Cc{}QK.className="Functional";it(QK);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function dAe(t,e){"modelTopology"in t||(t={modelTopology:t}),t=t;let n=t.modelTopology;n.model_config!=null&&(n=n.model_config);const s=hx(n),r=al(s,e);if(t.weightsManifest!=null){const a=await $q(t.weightsManifest,t.pathPrefix,r.weights.map(l=>l.originalName)),i={};for(const l of r.weights)i[l.originalName]=a[l.originalName];r.loadWeights(i),Jt(a)}return r}async function ZK(t,e){if(e==null&&(e={}),typeof t=="string"){const n=xG(t,e);if(n.length===0)n.push(Oq(t,e));else if(n.length>1)throw new ve(`Found more than one (${n.length}) load handlers for URL '${t}'`);t=n[0]}return hAe(t,void 0,e)}async function hAe(t,e,n){if(n==null&&(n={}),t.load==null)throw new ve("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const s=await t.load();let r=s.modelTopology;r.model_config!=null&&(r=r.model_config);const a=n.strict==null?!0:n.strict,i=s.weightData!=null&&s.weightSpecs!=null&&a,l=al(hx(r),e,i),c=s.trainingConfig;if(c!=null&&l.loadTrainingConfig(c),s.userDefinedMetadata!=null&&l.setUserDefinedMetadata(s.userDefinedMetadata),s.weightData!=null){if(s.weightSpecs==null)throw new ve("LayersModel artifacts contains weight data, but not weight specs. Therefore loading of weights cannot proceed.");const{modelWeights:u,optimizerWeights:h}=mAe(s.weightData,s.weightSpecs);l.loadWeights(u,a),l.optimizer!=null&&h.length>0&&await l.optimizer.setWeights(h),Jt(u),Jt(h.map(f=>f.tensor))}return l}function mAe(t,e){const n=t$(t,e),s={},r=[];return e.forEach(a=>{a.group==="optimizer"?r.push({name:a.name,tensor:n[a.name]}):s[a.name]=n[a.name]}),{modelWeights:s,optimizerWeights:r}}class $h extends Cc{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:uj("sequential_"),e.layers!=null)for(const n of e.layers)this.add(n)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new ve(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const n=e instanceof $h||e instanceof Cc;let s;if(n){if(s=e,s.outputs.length!==1)throw new ve("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new ve("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new ve("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const r=OK({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(r)}if(n)this.outputs=s.outputs,this.inputs=s.inputs;else{if(e.inboundNodes.length!==1)throw new ve(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new ve("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=RK(this.outputs[0])}this.inboundNodes=[],new bj({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:Ah(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(r=>r.shape),outputShapes:this.outputs[0].shape})}else{const r=e.apply(this.outputs[0]);if(Array.isArray(r))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[r],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,n){return this.model==null&&this.build(),this.model.call(e,n)}build(e){if($n(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new Cc({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,n,s=console.log){this.built||this.build(),super.summary(e,n,s)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,n,s={}){if(!this.built)throw new Eo("The model needs to be compiled before being used.");return this.model.evaluate(e,n,s)}async evaluateDataset(e,n){if(!this.built)throw new Eo("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,n)}predict(e,n={}){return this.model==null&&this.build(),this.model.predict(e,n)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,n,s={}){if(!this.built)throw new Eo("The model needs to be compiled before being used.");return this.model.fit(e,n,s)}async fitDataset(e,n){if(!this.built)throw new Eo("The model needs to be compiled before being used.");return this.model.fitDataset(e,n)}async trainOnBatch(e,n){return this.model.trainOnBatch(e,n)}static fromConfig(e,n,s={},r=!1){let a,i={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new ve("Legacy serialization format not supported yet.");a=n}else Z(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),a=n.layers,delete n.layers,i=n;const l=new e(i);if(!(l instanceof $h))throw new an(`Sequential.fromConfig called on non-Sequential input: ${l}`);for(const c of a){const h=al(c,void 0,r);r&&h.setFastWeightInitDuringBuild(!0),l.add(h)}return l}set stopTraining(e){if(this.model==null)throw new ve("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new ve("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const n of this.layers){const s={};s.className=n.getClassName(),s.config=n.getConfig(),e.push(s)}return{name:this.name,layers:e}}}$h.className="Sequential";it($h);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function JK(t){return new Cc(t)}function fAe(t){return new $h(t)}function eX(t){return OK(t)}function pAe(t,e){Pi.registerCallbackConstructor(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let ma=class extends Yh{getConfig(){return{}}};class tX extends ma{apply(e,n=1){return DEe(e,n)}}tX.className="elu";it(tX);class nX extends ma{apply(e){return FS(e)}}nX.className="selu";it(nX);class sX extends ma{apply(e){return gl(e)}}sX.className="relu";it(sX);class rX extends ma{apply(e){return Ee(()=>Ju(6,gl(e)))}}rX.className="relu6";it(rX);class aX extends ma{apply(e){return e}}aX.className="linear";it(aX);class iX extends ma{apply(e){return rl(e)}}iX.className="sigmoid";it(iX);class oX extends ma{apply(e){return LEe(e)}}oX.className="hardSigmoid";it(oX);class lX extends ma{apply(e){return Kh(e)}}lX.className="softplus";it(lX);class cX extends ma{apply(e){return PEe(e)}}cX.className="softsign";it(cX);class uX extends ma{apply(e){return Zu(e)}}uX.className="tanh";it(uX);let h5=class extends ma{apply(e,n=-1){return ub(e,n)}};h5.className="softmax";it(h5);class dX extends ma{apply(e,n=-1){return IS(e,n)}}dX.className="logSoftmax";it(dX);class hX extends ma{apply(e){return Ee(()=>Ee(()=>{const n=Math.sqrt(2),s=ge(.5,nt(1,ES(Mt(e,n))));return ge(e,s)}))}}hX.className="gelu";it(hX);class mX extends ma{apply(e){return Ee(()=>ge(.5,ge(e,nt(1,Zu(ge(Ar(Mt(2,Math.PI)),nt(e,ge(.044715,Ul(e,3)))))))))}}mX.className="gelu_new";it(mX);class fX extends ma{apply(e){return Ee(()=>ge(e,Zu(Kh(e))))}}fX.className="mish";it(fX);class pX extends ma{apply(e,n=1){return Ee(()=>ge(rl(ge(e,n)),e))}}pX.className="swish";it(pX);function td(t){return t.getClassName()}function P3(t,e={}){return gb(t,Bi.getMap().classNameMap,e,"activation")}function nd(t){if(t==null){const e={};return e.className="linear",e.config={},P3(e)}if(typeof t=="string"){const e={};return e.className=t,e.config={},P3(e)}else return t instanceof ma?t:P3(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function m5(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}class gX extends Yh{}class wb extends gX{constructor(e){super(),m5(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return Ee(()=>{let n=Us([1]);return this.hasL1&&(n=nt(n,$t(ge(this.l1,Js(e))))),this.hasL2&&(n=nt(n,$t(ge(this.l2,yb(e))))),be(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,n){return new e({l1:n.l1,l2:n.l2})}}wb.className="L1L2";it(wb);function gAe(t){return m5(t),new wb({l1:t!=null?t.l1:null,l2:0})}function xAe(t){return m5(t),new wb({l2:t!=null?t.l2:null,l1:0})}const eB={l1l2:"L1L2"};function cs(t){return GI(t)}function tB(t,e={}){return gb(t,Bi.getMap().classNameMap,e,"regularizer")}function Cs(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in eB?eB[t]:t,config:{}};return tB(n)}else return t instanceof gX?t:tB(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class f5 extends pn{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,n){e=Yt(e);let s=gl(e);return this.maxValue!=null&&(s=Ha(s,0,this.maxValue)),s}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},n=super.getConfig();return Object.assign(e,n),e}}f5.className="ReLU";it(f5);class p5 extends pn{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=Yt(e);return eb(s,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}p5.className="LeakyReLU";it(p5);class g5 extends pn{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=ks(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Cs(e.alphaRegularizer),this.alphaConstraint=gr(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new ve(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=$n(e);const n=e.slice(1);if(this.sharedAxes!=null)for(const r of this.sharedAxes)n[r-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let r=1;r<e.length;++r)s[r]=e[r];this.inputSpec=[new er({ndim:e.length,axes:s})],this.built=!0}call(e,n){return e=Yt(e),ob(e,this.alpha.read())}getConfig(){const e={alphaInitializer:$s(this.alphaInitializer),alphaRegularizer:cs(this.alphaRegularizer),alphaConstraint:pr(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(e,n),e}}g5.className="PReLU";it(g5);let x5=class extends pn{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new an(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=Yt(e);return zp(s)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}};x5.className="ELU";it(x5);class y5 extends pn{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,n){const s=Yt(e);return ge(s,ft(_a(s,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},n=super.getConfig();return Object.assign(e,n),e}}y5.className="ThresholdedReLU";it(y5);class b5 extends pn{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new h5().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,n){return Ee(()=>{let s=Yt(e);const r=n.mask;if(r!=null){const a=ge(Tt(Fa(s.shape),ft(r,s.dtype)),Bt(-1e9));s=nt(s,a)}return this.axis instanceof Array?this.axis.length>1?Ga(Tt(s,nb(s,this.axis,!0))):this.softmax(s,this.axis[0]):this.softmax(s,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}b5.className="Softmax";it(b5);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Zm(t,e,n){if(typeof t=="number")return Ah(t,e);if(t.length!==e)throw new ve(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let s=0;s<e;++s){const r=t[s];if(!$Ee(r))throw new ve(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${r}`)}return t}function il(t,e,n,s,r=1){if(t==null)return t;const a=e+(e-1)*(r-1);let i;return n==="same"?i=t:i=t-a+1,Math.floor((i+s-1)/s)}function Tl(t,e,n,s){if(t==null)return null;if(s==="valid")t=t*e+ed([n-e,0]);else if(s==="same")t=t*e;else throw new ve(`Unsupport padding mode: ${s}.`);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function v5(t,e){return Ee(()=>(Gs(e),e==="channelsFirst"?bn(t,[0,2,3,1]):t))}function xX(t,e){return Ee(()=>(Gs(e),e==="channelsFirst"?bn(t,[0,2,3,4,1]):t))}function yAe(t,e,n,s=1,r="valid",a,i=1){return Ee(()=>{if(a==null&&(a=cl()),Gs(a),t.shape.length!==3)throw new ve(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(e.shape.length!==3)throw new ve(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new ve(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(a==="channelsFirst"&&(t=bn(t,[0,2,1])),r==="causal")throw new an("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let l=kS(t,e,s,r==="same"?"same":"valid","NWC",i);return n!=null&&(l=xl(l,n)),l})}function nB(t,e,n,s=[1,1],r="valid",a,i,l=null){return Ee(()=>{if(a==null&&(a=cl()),Gs(a),t.rank!==3&&t.rank!==4)throw new ve(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(e.rank!==3&&e.rank!==4)throw new ve(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let c=v5(t,a);if(r==="causal")throw new an("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return c=xq({x:c,filter:e,strides:s,pad:r==="same"?"same":"valid",dilations:i,dataFormat:"NHWC",bias:n,activation:l}),a==="channelsFirst"&&(c=bn(c,[0,3,1,2])),c})}function bAe(t,e,n,s=[1,1,1],r="valid",a,i){return Ee(()=>{if(a==null&&(a=cl()),Gs(a),t.rank!==4&&t.rank!==5)throw new ve(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(e.rank!==4&&e.rank!==5)throw new ve(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let l=xX(t,a);if(r==="causal")throw new an("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return l=C$(l,e,s,r==="same"?"same":"valid","NDHWC",i),n!=null&&(l=xl(l,n)),a==="channelsFirst"&&(l=bn(l,[0,4,1,2,3])),l})}class Sj extends pn{constructor(e,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",Sj.verifyArgs(n),this.rank=e,Tr(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new an(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Zm(n.kernelSize,e,"kernelSize"),this.strides=Zm(n.strides==null?1:n.strides,e,"strides"),this.padding=n.padding==null?"valid":n.padding,so(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,Gs(this.dataFormat),this.activation=nd(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=ks(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=gr(n.biasConstraint),this.biasRegularizer=Cs(n.biasRegularizer),this.activityRegularizer=Cs(n.activityRegularizer),this.dilationRate=Zm(n.dilationRate==null?1:n.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new ve(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new ve(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new ve(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(Cl("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!qI(e.kernelSize,"number",1,3))throw new ve(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:td(this.activation),useBias:this.useBias,biasInitializer:$s(this.biasInitializer),biasRegularizer:cs(this.biasRegularizer),activityRegularizer:cs(this.activityRegularizer),biasConstraint:pr(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}class Kp extends Sj{constructor(e,n){super(e,n),this.kernel=null,Kp.verifyArgs(n),this.filters=n.filters,Tr(this.filters,"filters"),this.kernelInitializer=ks(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=gr(n.kernelConstraint),this.kernelRegularizer=Cs(n.kernelRegularizer)}build(e){e=$n(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new ve(`The channel dimension of the input should be defined. Found ${e[n]}`);const s=e[n],r=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:s}}],this.built=!0}call(e,n){return Ee(()=>{e=Yt(e);let s;const r=this.bias==null?null:this.bias.read(),a=jK(this.activation.getClassName());if(a!=null&&this.rank===2)s=nB(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate,a);else{if(this.rank===1)s=yAe(e,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=nB(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=bAe(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new an("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(e){e=$n(e);const n=[],s=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let a=0;a<s.length;++a){const i=il(s[a],this.kernelSize[a],this.padding,this.strides[a],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[a]);n.push(i)}let r=[e[0]];return this.dataFormat==="channelsLast"?(r=r.concat(n),r.push(this.filters)):(r.push(this.filters),r=r.concat(n)),r}getConfig(){const e={filters:this.filters,kernelInitializer:$s(this.kernelInitializer),kernelRegularizer:cs(this.kernelRegularizer),kernelConstraint:pr(this.kernelConstraint)},n=super.getConfig();return Object.assign(e,n),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new ve(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class Xp extends Kp{constructor(e){super(2,e),Xp.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!qI(e.kernelSize,"number",1,2))throw new ve(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}Xp.className="Conv2D";it(Xp);class Yp extends Kp{constructor(e){super(3,e),Yp.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new ve(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}Yp.className="Conv3D";it(Yp);class w5 extends Xp{constructor(e){if(super(e),this.inputSpec=[new er({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new ve(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=$n(e),e.length!==4)throw new ve("Input should have rank 4; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new ve("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new er({ndim:4,axes:{[n]:s}})],this.built=!0}call(e,n){return Ee(()=>{let s=Yt(e);if(s.shape.length!==4)throw new ve(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,a=r[0];let i,l;this.dataFormat==="channelsFirst"?(i=2,l=3):(i=1,l=2);const c=r[i],u=r[l],h=this.kernelSize[0],f=this.kernelSize[1],p=this.strides[0],x=this.strides[1],y=Tl(c,p,h,this.padding),v=Tl(u,x,f,this.padding),b=[a,y,v,this.filters];this.dataFormat!=="channelsLast"&&(s=bn(s,[0,2,3,1]));let N=CS(s,this.kernel.read(),b,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(N=bn(N,[0,3,1,2])),this.bias!=null&&(N=xl(N,this.bias.read(),this.dataFormat)),this.activation!=null&&(N=this.activation.apply(N)),N})}computeOutputShape(e){e=$n(e);const n=e.slice();let s,r,a;this.dataFormat==="channelsFirst"?(s=1,r=2,a=3):(s=3,r=1,a=2);const i=this.kernelSize[0],l=this.kernelSize[1],c=this.strides[0],u=this.strides[1];return n[s]=this.filters,n[r]=Tl(n[r],c,i,this.padding),n[a]=Tl(n[a],u,l,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}w5.className="Conv2DTranspose";it(w5);class N5 extends Yp{constructor(e){if(super(e),this.inputSpec=[new er({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new ve(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=$n(e),e.length!==5)throw new ve("Input should have rank 5; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new ve("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new er({ndim:5,axes:{[n]:s}})],this.built=!0}call(e,n){return Ee(()=>{let s=Yt(e);if(s.shape.length!==5)throw new ve(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,a=r[0];let i,l,c;this.dataFormat==="channelsFirst"?(c=2,i=3,l=4):(c=1,i=2,l=3);const u=r[c],h=r[i],f=r[l],p=this.kernelSize[0],x=this.kernelSize[1],y=this.kernelSize[2],v=this.strides[0],b=this.strides[1],N=this.strides[2],S=Tl(u,v,p,this.padding),k=Tl(h,b,x,this.padding),T=Tl(f,N,y,this.padding),E=[a,S,k,T,this.filters];this.dataFormat!=="channelsLast"&&(s=bn(s,[0,2,3,4,1]));let D=T$(s,this.kernel.read(),E,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(D=bn(D,[0,4,1,2,3])),this.bias!==null&&(D=xl(D,this.bias.read(),this.dataFormat)),this.activation!==null&&(D=this.activation.apply(D)),D})}computeOutputShape(e){e=$n(e);const n=e.slice();let s,r,a,i;this.dataFormat==="channelsFirst"?(s=1,r=2,a=3,i=4):(s=4,r=1,a=2,i=3);const l=this.kernelSize[0],c=this.kernelSize[1],u=this.kernelSize[2],h=this.strides[0],f=this.strides[1],p=this.strides[2];return n[s]=this.filters,n[r]=Tl(n[r],h,l,this.padding),n[a]=Tl(n[a],f,c,this.padding),n[i]=Tl(n[i],p,u,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}N5.className="Conv3DTranspose";it(N5);class yX extends Kp{constructor(e,n){if(super(e,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new ve("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new ve("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new ve(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=ks(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Cs(n.depthwiseRegularizer),this.depthwiseConstraint=gr(n.depthwiseConstraint),this.pointwiseInitializer=ks(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Cs(n.pointwiseRegularizer),this.pointwiseConstraint=gr(n.pointwiseConstraint)}build(e){if(e=$n(e),e.length<this.rank+2)throw new ve(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null||e[n]<0)throw new ve(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[n])}`);const s=e[n],r=this.kernelSize.concat([s,this.depthMultiplier]),a=[];for(let l=0;l<this.rank;++l)a.push(1);a.push(s*this.depthMultiplier,this.filters);const i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",a,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):this.bias=null,this.inputSpec=[new er({ndim:this.rank+2,axes:{[n]:s}})],this.built=!0}call(e,n){return Ee(()=>{e=Yt(e);let s;if(this.rank===1)throw new an("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=bn(e,[0,2,3,1])),s=zS(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=xl(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=bn(s,[0,3,1,2])),s})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=$s(this.depthwiseInitializer),e.pointwiseInitializer=$s(this.pointwiseInitializer),e.depthwiseRegularizer=cs(this.depthwiseRegularizer),e.pointwiseRegularizer=cs(this.pointwiseRegularizer),e.depthwiseConstraint=pr(this.depthwiseConstraint),e.pointwiseConstraint=pr(this.pointwiseConstraint),e}}yX.className="SeparableConv";class S5 extends yX{constructor(e){super(2,e)}}S5.className="SeparableConv2D";it(S5);class Nb extends Kp{constructor(e){super(1,e),Nb.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!qI(e.kernelSize,"number",1,1))throw new ve(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}Nb.className="Conv1D";it(Nb);class j5 extends pn{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,n){return Ee(()=>{if(e=Yt(e),this.dataFormat==="channelsLast"){const s=d1(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return d1(s,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=d1(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return d1(s,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}j5.className="Cropping2D";it(j5);class k5 extends pn{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Gs(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,_Ee(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const n=e[2]==null?null:this.size[0]*e[2],s=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],n,s]}else{const n=e[1]==null?null:this.size[0]*e[1],s=e[2]==null?null:this.size[1]*e[2];return[e[0],n,s,e[3]]}}call(e,n){return Ee(()=>{let s=Yt(e);const r=s.shape;if(this.dataFormat==="channelsFirst"){s=bn(s,[0,2,3,1]);const a=this.size[0]*r[2],i=this.size[1]*r[3],l=this.interpolation==="nearest"?Vi.resizeNearestNeighbor(s,[a,i]):Vi.resizeBilinear(s,[a,i]);return bn(l,[0,3,1,2])}else{const a=this.size[0]*r[1],i=this.size[1]*r[2];return this.interpolation==="nearest"?Vi.resizeNearestNeighbor(s,[a,i]):Vi.resizeBilinear(s,[a,i])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}}k5.className="UpSampling2D";it(k5);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function vAe(t,e,n=[1,1],s="valid",r,a){return Ee(()=>{r==null&&(r=cl()),Gs(r);let i=v5(t,r);if(t.rank!==4)throw new ve(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(e.rank!==4)throw new ve(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return i=Fp(i,e,n,s==="same"?"same":"valid","NHWC",a),r==="channelsFirst"&&(i=bn(i,[0,3,1,2])),i})}class C5 extends Sj{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=ks(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=gr(e.depthwiseConstraint),this.depthwiseRegularizer=Cs(e.depthwiseRegularizer)}build(e){if(e=$n(e),e.length<4)throw new ve(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(e[n]==null||e[n]<0)throw new ve(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[n]}).`);const s=e[n],r=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return Ee(()=>{e=Yt(e);let s=vAe(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=xl(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(e){e=$n(e);const n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,a=il(n,this.kernelSize[0],this.padding,this.strides[0]),i=il(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],r,a,i]:[e[0],a,i,r]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=$s(this.depthwiseInitializer),e.depthwiseRegularizer=cs(this.depthwiseRegularizer),e.depthwiseConstraint=pr(this.depthwiseRegularizer),e}}C5.className="DepthwiseConv2D";it(C5);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function bX(t,e,n,s){if(Array.isArray(t)){if(e!=null||n!=null)throw new ve("When inputs is an array, neither initialState or constants should be provided");s!=null&&(n=t.slice(t.length-s,t.length),t=t.slice(0,t.length-s)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function r(a){return a==null||Array.isArray(a)?a:[a]}return e=r(e),n=r(n),{inputs:t,initialState:e,constants:n}}function vX(t,e,n,s=!1,r,a,i=!1,l=!1){return Ee(()=>{const c=e.shape.length;if(c<3)throw new ve(`Input should be at least 3D, but is ${c}D.`);const u=[1,0].concat(ll(2,c));e=bn(e,u),i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),r!=null&&(r=ft(ft(r,"bool"),"float32"),r.rank===c-1&&(r=Br(r,-1)),r=bn(r,u)),s&&(e=Ji(e,0),r!=null&&(r=Ji(r,0)));const h=[];let f,p=n;const x=e.shape[0],y=eo(e);let v;r!=null&&(v=eo(r));for(let N=0;N<x;++N){const S=y[N],k=Ee(()=>t(S,p));if(r==null)f=k[0],p=k[1];else{const T=Ee(()=>{const E=v[N],D=Tt(yi(E),E),A=nt(ge(k[0],E),ge(p[0],D)),I=p.map((P,$)=>nt(ge(k[1][$],E),ge(P,D)));return{output:A,newStates:I}});f=T.output,p=T.newStates}l&&h.push(f)}let b;return l&&(b=ka(h,1)),[f,b,p]})}class yl extends pn{constructor(e){super(e);let n;if(e.cell==null)throw new ve("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?n=new Cj({cells:e.cell}):n=e.cell,n.stateSize==null)throw new ve("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new er({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return ll(0,e).map(n=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){bE(e)&&(e=e[0]),e=e;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const s=n[0];let r;if(this.returnSequences?r=[e[0],e[1],s]:r=[e[0],s],this.returnState){const a=[];for(const i of n)a.push([e[0],i]);return[r].concat(a)}else return r}computeMask(e,n){return Ee(()=>{Array.isArray(n)&&(n=n[0]);const s=this.returnSequences?n:null;if(this.returnState){const r=this.states.map(a=>null);return[s].concat(r)}else return s})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let s=0;s<e;++s)n.push(null);return n}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new an("Constants support is not implemented in RNN yet.");bE(e)&&(e=e[0]),e=e;const n=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new er({shape:[n,null,...s]});const r=[e[0]].concat(e.slice(2));this.cell.build(r);let a;if(Array.isArray(this.cell.stateSize)?a=this.cell.stateSize:a=[this.cell.stateSize],this.stateSpec!=null){if(!xn(this.stateSpec.map(i=>i.shape[i.shape.length-1]),a))throw new ve(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=a.map(i=>new er({shape:[null,i]}));this.stateful&&this.resetStates()}resetStates(e,n=!1){Ee(()=>{if(!this.stateful)throw new kl("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new ve("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>Us([s,r])):this.states_=[Us([s,this.cell.stateSize])];else if(e==null)Jt(this.states_),this.keptStates!=null&&(Jt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>Us([s,r])):this.states_[0]=Us([s,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new ve(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n===!0?this.keptStates.push(this.states_.slice()):Jt(this.states_);for(let r=0;r<this.states_.length;++r){const a=e[r],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[r]:this.cell.stateSize,l=[s,i];if(!xn(a.shape,l))throw new ve(`State ${r} is incompatible with layer ${this.name}: expected shape=${l}, received shape=${a.shape}`);this.states_[r]=a}}this.states_=this.states_.map(r=>hr(r.clone()))})}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const a=bX(e,s,r,this.numConstants);e=a.inputs,s=a.initialState,r=a.constants;let i=[],l=[];if(s!=null){n.initialState=s,i=i.concat(s),this.stateSpec=[];for(const u of s)this.stateSpec.push(new er({shape:u.shape}));l=l.concat(this.stateSpec)}if(r!=null&&(n.constants=r,i=i.concat(r),this.numConstants=r.length),i[0]instanceof ul){const u=[e].concat(i),h=this.inputSpec.concat(l),f=this.inputSpec;this.inputSpec=h;const p=super.apply(u,n);return this.inputSpec=f,p}else return super.apply(e,n)}call(e,n){return Ee(()=>{const s=n==null?null:n.mask,r=n==null?null:n.training;let a=n==null?null:n.initialState;e=Yt(e),a==null&&(this.stateful?a=this.states_:a=this.getInitialState(e));const i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(a.length!==i)throw new ve(`RNN Layer has ${i} state(s) but was passed ${a.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const l={training:r},u=vX((y,v)=>{const b=this.cell.call([y].concat(v),l);return[b[0],b.slice(1)]},e,a,this.goBackwards,s,null,this.unroll,this.returnSequences),h=u[0],f=u[1],p=u[2];this.stateful&&this.resetStates(p,r);const x=this.returnSequences?f:h;return this.returnState?[x].concat(p):x})}getInitialState(e){return Ee(()=>{let n=Us(e.shape);return n=$t(n,[1,2]),n=xb(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?xE(n,[1,s]):n):this.cell.stateSize>1?[xE(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===yl.className&&(n.cell={className:this.cell.getClassName(),config:s}),Object.assign(Object.assign(Object.assign({},s),e),n)}static fromConfig(e,n,s={}){const r=n.cell,a=al(r,s);return new e(Object.assign(n,{cell:a}))}}yl.className="RNN";it(yl);class Sb extends pn{}class jj extends Sb{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Tr(this.units,"units"),this.activation=nd(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=ks(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=ks(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=ks(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Cs(e.kernelRegularizer),this.recurrentRegularizer=Cs(e.recurrentRegularizer),this.biasRegularizer=Cs(e.biasRegularizer),this.kernelConstraint=gr(e.kernelConstraint),this.recurrentConstraint=gr(e.recurrentConstraint),this.biasConstraint=gr(e.biasConstraint),this.dropout=wf([1,ed([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=wf([1,ed([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=$n(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return Ee(()=>{if(e=e,e.length!==2)throw new ve(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let s=e[1];e=e[0];const r=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=sd({ones:()=>yi(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=sd({ones:()=>yi(s),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let a;const i=this.dropoutMask,l=this.recurrentDropoutMask;i!=null?a=Ll(ge(e,i),this.kernel.read()):a=Ll(e,this.kernel.read()),this.bias!=null&&(a=xl(a,this.bias.read())),l!=null&&(s=ge(s,l));let c=nt(a,Ll(s,this.recurrentKernel.read()));return this.activation!=null&&(c=this.activation.apply(c)),[c,c]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:td(this.activation),useBias:this.useBias,kernelInitializer:$s(this.kernelInitializer),recurrentInitializer:$s(this.recurrentInitializer),biasInitializer:$s(this.biasInitializer),kernelRegularizer:cs(this.kernelRegularizer),recurrentRegularizer:cs(this.recurrentRegularizer),biasRegularizer:cs(this.biasRegularizer),activityRegularizer:cs(this.activityRegularizer),kernelConstraint:pr(this.kernelConstraint),recurrentConstraint:pr(this.recurrentConstraint),biasConstraint:pr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),n)}}jj.className="SimpleRNNCell";it(jj);class T5 extends yl{constructor(e){e.cell=new jj(e),super(e)}call(e,n){return Ee(()=>{this.cell.dropoutMask!=null&&(Jt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Jt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,a=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:a})})}static fromConfig(e,n){return new e(n)}}T5.className="SimpleRNN";it(T5);class kj extends Sb{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new ve("GRUCell does not support reset_after parameter set to true.");this.units=e.units,Tr(this.units,"units"),this.activation=nd(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=nd(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=ks(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=ks(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=ks(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Cs(e.kernelRegularizer),this.recurrentRegularizer=Cs(e.recurrentRegularizer),this.biasRegularizer=Cs(e.biasRegularizer),this.kernelConstraint=gr(e.kernelConstraint),this.recurrentConstraint=gr(e.recurrentConstraint),this.biasConstraint=gr(e.biasConstraint),this.dropout=wf([1,ed([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=wf([1,ed([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=$n(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return Ee(()=>{if(e=e,e.length!==2)throw new ve(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training==null?!1:n.training;let r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=sd({ones:()=>yi(e),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=sd({ones:()=>yi(r),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const a=this.dropoutMask,i=this.recurrentDropoutMask;let l,c,u;0<this.dropout&&this.dropout<1&&(e=ge(e,a[0]));let h=Ll(e,this.kernel.read());this.useBias&&(h=xl(h,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=ge(r,i[0]));const f=this.recurrentKernel.read(),[p,x]=Ua(f,[2*this.units,this.units],f.rank-1),y=Ll(r,p),[v,b,N]=Ua(h,3,h.rank-1),[S,k]=Ua(y,2,y.rank-1);l=this.recurrentActivation.apply(nt(v,S)),c=this.recurrentActivation.apply(nt(b,k));const T=Ll(ge(c,r),x);u=this.activation.apply(nt(N,T));const E=nt(ge(l,r),ge(nt(1,gs(l)),u));return[E,E]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:td(this.activation),recurrentActivation:td(this.recurrentActivation),useBias:this.useBias,kernelInitializer:$s(this.kernelInitializer),recurrentInitializer:$s(this.recurrentInitializer),biasInitializer:$s(this.biasInitializer),kernelRegularizer:cs(this.kernelRegularizer),recurrentRegularizer:cs(this.recurrentRegularizer),biasRegularizer:cs(this.biasRegularizer),activityRegularizer:cs(this.activityRegularizer),kernelConstraint:pr(this.kernelConstraint),recurrentConstraint:pr(this.recurrentConstraint),biasConstraint:pr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),n)}}kj.className="GRUCell";it(kj);class _5 extends yl{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new kj(e),super(e)}call(e,n){return Ee(()=>{this.cell.dropoutMask!=null&&(Jt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Jt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,a=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:a})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}_5.className="GRU";it(_5);class jb extends Sb{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,Tr(this.units,"units"),this.activation=nd(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=nd(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=ks(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=ks(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=ks(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=Cs(e.kernelRegularizer),this.recurrentRegularizer=Cs(e.recurrentRegularizer),this.biasRegularizer=Cs(e.biasRegularizer),this.kernelConstraint=gr(e.kernelConstraint),this.recurrentConstraint=gr(e.recurrentConstraint),this.biasConstraint=gr(e.biasConstraint),this.dropout=wf([1,ed([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=wf([1,ed([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var n;e=$n(e);const s=e[e.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){const a=this.biasInitializer,i=this.units;r=new(n=class extends Lo{apply(c,u){const h=a.apply([i]),f=new hj().apply([i]),p=a.apply([i*2]);return F8(F8(h,f),p)}},n.className="CustomInit",n)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,n){return Ee(()=>{const s=n.training==null?!1:n.training;if(e=e,e.length!==3)throw new ve(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1];const a=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=sd({ones:()=>yi(e),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=sd({ones:()=>yi(r),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,l=this.recurrentDropoutMask;let c,u,h,f;0<this.dropout&&this.dropout<1&&(e=ge(e,i[0]));let p=Ll(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=ge(r,l[0])),p=nt(p,Ll(r,this.recurrentKernel.read())),this.useBias&&(p=xl(p,this.bias.read()));const[x,y,v,b]=Ua(p,4,p.rank-1);c=this.recurrentActivation.apply(x),u=this.recurrentActivation.apply(y),h=nt(ge(u,a),ge(c,this.activation.apply(v))),f=this.recurrentActivation.apply(b);const N=ge(f,this.activation.apply(h));return[N,N,h]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:td(this.activation),recurrentActivation:td(this.recurrentActivation),useBias:this.useBias,kernelInitializer:$s(this.kernelInitializer),recurrentInitializer:$s(this.recurrentInitializer),biasInitializer:$s(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:cs(this.kernelRegularizer),recurrentRegularizer:cs(this.recurrentRegularizer),biasRegularizer:cs(this.biasRegularizer),activityRegularizer:cs(this.activityRegularizer),kernelConstraint:pr(this.kernelConstraint),recurrentConstraint:pr(this.recurrentConstraint),biasConstraint:pr(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),n)}}jb.className="LSTMCell";it(jb);class E5 extends yl{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new jb(e),super(e)}call(e,n){return Ee(()=>{this.cell.dropoutMask!=null&&(Jt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Jt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,a=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:a})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}E5.className="LSTM";it(E5);class Cj extends Sb{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?e.push(...n.stateSize):e.push(n.stateSize);return e}call(e,n){return Ee(()=>{e=e;let s=e.slice(1);const r=[];for(const l of this.cells.slice().reverse())Array.isArray(l.stateSize)?r.push(s.splice(0,l.stateSize.length)):r.push(s.splice(0,1));r.reverse();const a=[];let i;for(let l=0;l<this.cells.length;++l){const c=this.cells[l];s=r[l],l===0?i=[e[0]].concat(s):i=[i[0]].concat(s),i=c.call(i,n),a.push(i.slice(1))}s=[];for(const l of a.slice().reverse())s.push(...l);return[i[0]].concat(s)})}build(e){bE(e)&&(e=e[0]),e=e;let n;this.cells.forEach((s,r)=>{dh(`RNNCell_${r}`,()=>{s.build(e),Array.isArray(s.stateSize)?n=s.stateSize[0]:n=s.stateSize,e=[e[0],n]})}),this.built=!0}getConfig(){const e=super.getConfig(),n=a=>({className:a.getClassName(),config:a.getConfig()}),r={cells:this.cells.map(n)};return Object.assign(Object.assign({},e),r)}static fromConfig(e,n,s={}){const r=[];for(const a of n.cells)r.push(al(a,s));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const n of this.cells)e.push(...n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.cells)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.cells)n.push(...s.trainableWeights);return n.concat(e)}return e}getWeights(){const e=[];for(const n of this.cells)e.push(...n.weights);return vE(e)}setWeights(e){const n=[];for(const s of this.cells){const r=s.weights.length,a=e.splice(r);for(let i=0;i<s.weights.length;++i)n.push([s.weights[i],a[i]])}n5(n)}}Cj.className="StackedRNNCells";it(Cj);function sd(t){const{ones:e,rate:n,training:s=!1,count:r=1,dropoutFunc:a}=t,i=()=>a!=null?a(e(),n):$K(e(),n),l=()=>bb(i,e,s);return!r||r<=1?hr(l().clone()):Array(r).fill(void 0).map(l).map(u=>hr(u.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var wAe=function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n};class wX extends yl{constructor(e){if(e.unroll)throw new an("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new an("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new er({ndim:5})]}call(e,n){return Ee(()=>{if(this.cell.dropoutMask!=null&&(Jt(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Jt(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new ve("ConvRNN2D cell does not support constants");const s=n==null?null:n.mask,r=n==null?null:n.training,a=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:a})})}computeOutputShape(e){let n=this.computeSingleOutputShape(e);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([e[0],...n.slice(-3)])]),n}getInitialState(e){return Ee(()=>{const{stateSize:n}=this.cell,s=e.shape,r=this.computeSingleOutputShape(s),a=[r[0],...r.slice(2)],i=Us(a);return Array.isArray(n)?Array(n.length).fill(i):[i]})}resetStates(e,n=!1){Ee(()=>{if(!this.stateful)throw new kl("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,r=this.computeSingleOutputShape(s),a=[r[0],...r.slice(2)];if(s[0]==null)throw new ve("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Us(a)):this.states_=[Us(a)];else if(e==null)Jt(this.states_),this.keptStates!=null&&(Jt(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>Us(a)):this.states_[0]=Us(a);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new ve(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n?this.keptStates.push(this.states_.slice()):Jt(this.states_);for(let l=0;l<this.states_.length;++l){const c=e[l],u=a;if(!xn(c.shape,u))throw new ve(`State ${l} is incompatible with layer ${this.name}: expected shape=${u}, received shape=${c.shape}`);this.states_[l]=c}}this.states_=this.states_.map(l=>hr(l.clone()))})}computeSingleOutputShape(e){const{dataFormat:n,filters:s,kernelSize:r,padding:a,strides:i,dilationRate:l}=this.cell,c=n==="channelsFirst",u=e[c?3:2],h=e[c?4:3],f=il(u,r[0],a,i[0],l[0]),p=il(h,r[1],a,i[1],l[1]);return[...e.slice(0,2),...c?[s,f,p]:[f,p,s]]}}wX.className="ConvRNN2D";class Tj extends jb{constructor(e){const{filters:n,kernelSize:s,strides:r,padding:a,dataFormat:i,dilationRate:l}=e;super(Object.assign(Object.assign({},e),{units:n})),this.filters=n,Tr(this.filters,"filters"),this.kernelSize=Zm(s,2,"kernelSize"),this.kernelSize.forEach(c=>Tr(c,"kernelSize")),this.strides=Zm(r||1,2,"strides"),this.strides.forEach(c=>Tr(c,"strides")),this.padding=a||"valid",so(this.padding),this.dataFormat=i||"channelsLast",Gs(this.dataFormat),this.dilationRate=Zm(l||1,2,"dilationRate"),this.dilationRate.forEach(c=>Tr(c,"dilationRate"))}build(e){var n;e=$n(e);const s=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[s]==null)throw new ve(`The channel dimension of the input should be defined. Found ${e[s]}`);const r=e[s],a=4,i=this.kernelSize.concat([r,this.filters*a]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const l=this.kernelSize.concat([this.filters,this.filters*a]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",l,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let c;if(this.unitForgetBias){const u=this.biasInitializer,h=this.filters;c=new(n=class extends Lo{apply(p,x){const y=u.apply([h]),v=Fa([h]),b=u.apply([h*2]);return KI([y,v,b])}},n.className="CustomInit",n)}else c=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*a],null,c,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,n){return Ee(()=>{if(e.length!==3)throw new ve(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training||!1,r=e[0],a=e[1],i=e[2],l=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=sd({ones:()=>yi(r),rate:this.dropout,training:s,count:l,dropoutFunc:this.dropoutFunc}));const c=this.dropoutMask,u=(B,O,U)=>!O||!O[U]?B:ge(O[U],B);let h=u(r,c,0),f=u(r,c,1),p=u(r,c,2),x=u(r,c,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=sd({ones:()=>yi(a),rate:this.recurrentDropout,training:s,count:l,dropoutFunc:this.dropoutFunc}));const y=this.recurrentDropoutMask;let v=u(a,y,0),b=u(a,y,1),N=u(a,y,2),S=u(a,y,3);const k=3,[T,E,D,A]=Ua(this.kernel.read(),l,k),[I,P,$,R]=this.useBias?Ua(this.bias.read(),l):[null,null,null,null];h=this.inputConv(h,T,I,this.padding),f=this.inputConv(f,E,P,this.padding),p=this.inputConv(p,D,$,this.padding),x=this.inputConv(x,A,R,this.padding);const[F,W,q,X]=Ua(this.recurrentKernel.read(),l,k);v=this.recurrentConv(v,F),b=this.recurrentConv(b,W),N=this.recurrentConv(N,q),S=this.recurrentConv(S,X);const z=this.recurrentActivation.apply(nt(h,v)),K=this.recurrentActivation.apply(nt(f,b)),H=nt(ge(K,i),ge(z,this.activation.apply(nt(p,N)))),Y=ge(this.recurrentActivation.apply(nt(x,S)),this.activation.apply(H));return[Y,Y,H]})}getConfig(){const e=super.getConfig(),{units:n}=e,s=wAe(e,["units"]),r={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},s),r)}inputConv(e,n,s,r){const a=Lc(e,n,this.strides,r||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?xl(a,s,this.dataFormat):a}recurrentConv(e,n){return Lc(e,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}Tj.className="ConvLSTM2DCell";it(Tj);class A5 extends wX{constructor(e){const n=new Tj(e);super(Object.assign(Object.assign({},e),{cell:n}))}static fromConfig(e,n){return new e(n)}}A5.className="ConvLSTM2D";it(A5);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class _j extends pn{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const n=e.shape,s=[];for(let r=0;r<this.noiseShape.length;++r)s.push(this.noiseShape[r]==null?n[r]:this.noiseShape[r]);return s}call(e,n){return Ee(()=>{this.invokeCallHook(e,n);const s=Yt(e);if(0<this.rate&&this.rate<1){const r=n.training==null?!1:n.training,a=this.getNoiseShape(s);return bb(()=>$K(s,this.rate,a,this.seed),()=>s,r)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(e,n),e}dispose(){return super.dispose()}}_j.className="Dropout";it(_j);class $5 extends _j{constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const n=e.shape;return[n[0],1,n[2]]}}$5.className="SpatialDropout1D";it($5);class I5 extends pn{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let n=null;e.batchSize!=null&&(n=e.batchSize),this.batchInputShape=[n,e.inputDim]}this.units=e.units,Tr(this.units,"units"),this.activation=nd(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=ks(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=ks(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=gr(e.kernelConstraint),this.biasConstraint=gr(e.biasConstraint),this.kernelRegularizer=Cs(e.kernelRegularizer),this.biasRegularizer=Cs(e.biasRegularizer),this.activityRegularizer=Cs(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=$n(e);const n=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(e){e=$n(e);const n=e.slice();return n[n.length-1]=this.units,n}call(e,n){return Ee(()=>{this.invokeCallHook(e,n);const s=Yt(e),r=jK(this.activation.getClassName());let a;return r!=null?a=Ll(s,this.kernel.read(),r,this.bias?this.bias.read():null):(a=Ll(s,this.kernel.read()),this.bias!=null&&(a=xl(a,this.bias.read())),this.activation!=null&&(a=this.activation.apply(a))),a})}getConfig(){const e={units:this.units,activation:td(this.activation),useBias:this.useBias,kernelInitializer:$s(this.kernelInitializer),biasInitializer:$s(this.biasInitializer),kernelRegularizer:cs(this.kernelRegularizer),biasRegularizer:cs(this.biasRegularizer),activityRegularizer:cs(this.activityRegularizer),kernelConstraint:pr(this.kernelConstraint),biasConstraint:pr(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}I5.className="Dense";it(I5);class R5 extends pn{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=$n(e);for(const n of e.slice(1))if(n==null)throw new ve(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],Wu(e,1)]}call(e,n){return Ee(()=>{this.invokeCallHook(e,n);let s=Yt(e);if(this.dataFormat==="channelsFirst"&&s.rank>1){const r=[0];for(let a=2;a<s.rank;++a)r.push(a);r.push(1),s=bn(s,r)}return OEe(s)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(e,n),e}}R5.className="Flatten";it(R5);class O5 extends pn{constructor(e){super(e),this.supportsMasking=!0,this.activation=nd(e.activation)}call(e,n){return Ee(()=>{this.invokeCallHook(e,n);const s=Yt(e);return this.activation.apply(s)})}getConfig(){const e={activation:td(this.activation)},n=super.getConfig();return Object.assign(e,n),e}}O5.className="Activation";it(O5);class D5 extends pn{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,n){return Ee(()=>(e=Yt(e),IEe(e,this.n)))}getConfig(){const e={n:this.n},n=super.getConfig();return Object.assign(e,n),e}}D5.className="RepeatVector";it(D5);class P5 extends pn{constructor(e){super(e),this.targetShape=e.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,n){const s="Total size of new array must be unchanged.",r=n.slice();let a=1,i=null;for(let c=0;c<r.length;++c){const u=r[c];if(this.isUnknown(u))if(i===null)i=c;else throw new ve("Can only specifiy one unknown dimension.");else a*=u}const l=Wu(e);if(i!==null){if(a===0||l%a!==0)throw new ve(s);r[i]=l/a}else if(l!==a)throw new ve(s);return r}computeOutputShape(e){let n=!1;for(let s=0;s<e.length;++s)if(this.isUnknown(e[s])){n=!0;break}return n?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,n){return Ee(()=>{this.invokeCallHook(e,n);const s=Yt(e),r=s.shape,a=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return be(s,a)})}getConfig(){const e={targetShape:this.targetShape},n=super.getConfig();return Object.assign(e,n),e}}P5.className="Reshape";it(P5);class L5 extends pn{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const n=ll(1,e.dims.length+1);if(!xn(e.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new er({ndim:this.dims.length+1})]}computeOutputShape(e){e=$n(e);const n=e.slice();return this.dims.forEach((s,r)=>{n[r+1]=e[s]}),n}call(e,n){return bn(Yt(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},n=super.getConfig();return Object.assign(e,n),e}}L5.className="Permute";it(L5);class M5 extends pn{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,e),n}computeMask(e,n){const s=Yt(e);return ox(Th(s,this.maskValue),-1)}call(e,n){return Ee(()=>{this.invokeCallHook(e,n);const s=Yt(e),i=ox(Th(s,this.maskValue),-1,!0);return ge(s,ft(i,s.dtype))})}}M5.className="Masking";it(M5);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class F5 extends pn{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let n=null;e.batchSize!=null&&(n=e.batchSize),e.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(Hn(e.inputLength))}this.inputDim=e.inputDim,Tr(this.inputDim,"inputDim"),this.outputDim=e.outputDim,Tr(this.outputDim,"outputDim"),this.embeddingsInitializer=ks(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Cs(e.embeddingsRegularizer),this.activityRegularizer=Cs(e.activityRegularizer),this.embeddingsConstraint=gr(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,n){return Ee(()=>this.maskZero?(e=Yt(e),Th(e,Sn(e))):null)}computeOutputShape(e){if(e=$n(e),this.inputLength==null)return[...e,this.outputDim];const n=Hn(this.inputLength);if(n.length!==e.length-1)throw new ve(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let s=0;for(let r=0;r<n.length;++r){const a=n[r],i=e[r+1];if(a!=null&&i!=null&&a!==i)throw new ve(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);a==null&&(n[s]=i),s++}}return[e[0],...n,this.outputDim]}call(e,n){return Ee(()=>{this.invokeCallHook(e,n);let s=Yt(e);s.dtype!=="int32"&&(s=Pl(s,"int32"));const r=AK(this.embeddings.read(),be(s,[s.size]));return be(r,$n(this.computeOutputShape(s.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:$s(this.embeddingsInitializer),embeddingsRegularizer:cs(this.embeddingsRegularizer),activityRegularizer:cs(this.activityRegularizer),embeddingsConstraint:pr(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(e,n),e}}F5.className="Embedding";it(F5);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Jh extends pn{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new an}computeElementwiseOpOutputShape(e,n){if(e==null||n==null)return null;if(e.length<n.length)return this.computeElementwiseOpOutputShape(n,e);if(n.length===0)return e;const s=e.slice(0,e.length-n.length);for(let r=0;r<n.length;++r){const a=e[e.length-n.length+r],i=n[r];if(a==null||i==null||a<0||i<0)s.push(null);else if(a===1)s.push(i);else if(i===1)s.push(a);else{if(a!==i)throw new ve("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(n));s.push(a)}}return s}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[$n(e)]),e=e,e.length<2)throw new ve(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let n=[];for(const a of e)a!=null&&a[0]!==null&&n.push(a[0]);if(n=Vu(n),n.length>1)throw new ve(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let s=e[0]==null?null:e[0].slice(1);for(let a=1;a<e.length;++a){const i=e[a]==null?null:e[a].slice(1);s=this.computeElementwiseOpOutputShape(s,i)}const r=e.map(a=>a.length);e.indexOf(null)===-1&&Vu(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,n){return Ee(()=>{if(e=e,this.reshapeRequired){const s=[],r=e.map(a=>a.rank);if(r.indexOf(null)===-1){const a=ed(r);for(let i of e){const l=i.rank;for(let c=0;c<a-l;++c)i=xb(i,1);s.push(i)}return this.mergeFunction(s)}else{let a=!1;for(const c of e){const u=c.rank;if(u==null){const h=c.shape,f=h[0],p=h.slice(1).concat([f]);let x=be(c,[f].concat(Wu(h.slice(1))));x=bn(x,[1,0]),x=be(x,p),s.push(x),a=!0}else if(u>1){const h=ll(1,u).concat([0]);s.push(bn(c,h)),a=!0}else s.push(c)}let i=this.mergeFunction(s);const l=i.rank;if(a){if(l==null){const c=i.shape,u=c.length,h=c[u-1],f=[h].concat(c.slice(0,c.length-1));i=be(bn(be(i,[-1,h]),[1,0]),f)}else if(l>1){const c=[l-1].concat(ll(0,l-1));i=bn(i,c)}}return i}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let n;e[0]==null?n=null:n=e[0].slice(1);for(let r=1;r<e.length;++r){const a=e[r]==null?null:e[r].slice(1);n=this.computeElementwiseOpOutputShape(n,a)}let s=[];for(const r of e)r!=null&&r[0]!==null&&s.push(r[0]);return s=Vu(s),s.length===1?n=s.concat(n):n=[null].concat(n),n}computeMask(e,n){return Ee(()=>{if(n==null)return null;if(!Array.isArray(n))throw new ve("`mask` should be an Array");if(!Array.isArray(e))throw new ve("`inputs` should be an Array");if(n.length!==e.length)throw new ve(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${n.length})`);if(n.every(r=>r==null))return null;n=n.map(r=>r==null?r:Br(r,0));let s=n[0];for(let r=1;r<n.length-1;++r)s=Io(s,n[r]);return s})}}class z5 extends Jh{constructor(e){super(e)}mergeFunction(e){return Ee(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=nt(n,e[s]);return n})}}z5.className="Add";it(z5);class B5 extends Jh{constructor(e){super(e)}mergeFunction(e){return Ee(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=ge(n,e[s]);return n})}}B5.className="Multiply";it(B5);class U5 extends Jh{constructor(e){super(e)}mergeFunction(e){return Ee(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=nt(n,e[s]);return ge(1/e.length,n)})}}U5.className="Average";it(U5);class V5 extends Jh{constructor(e){super(e)}mergeFunction(e){return Ee(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=Gl(n,e[s]);return n})}}V5.className="Maximum";it(V5);class W5 extends Jh{constructor(e){super(e)}mergeFunction(e){return Ee(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=Ju(n,e[s]);return n})}}W5.className="Minimum";it(W5);class H5 extends Jh{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new ve("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let n=!0;for(const r of e)if(r!=null){n=!1;break}if(n)return;const s=[];for(let r=0;r<e.length;++r){const a=e[r].slice();a.splice(this.axis,1);let i=!1;for(const l of s)if(xn(l,a)){i=!0;break}i||s.push(a)}if(s.length>1)throw new ve("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return Ee(()=>KI(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new ve("A `Concatenate` layer should be called on a list of inputs.");const n=e,s=n[0].slice(),r=this.axis<0?s.length+this.axis:this.axis;for(const a of n.slice(1)){if(s[r]==null||a[r]==null){s[r]=null;break}s[r]+=a[r]}return s}computeMask(e,n){if(n==null)return null;if(!Array.isArray(n))throw new ve("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new ve("`inputs` should be an array for Concatenate");if(n.length!==e.length)throw new ve(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${e.length})`);return Ee(()=>{let s=!0;if(n.forEach(i=>{if(i!=null){s=!1;return}}),s)return null;const r=[];for(let i=0;i<e.length;++i)n[i]==null?r.push(ft(yi(e[i]),"bool")):n[i].rank<e[i].rank?r.push(Br(n[i],-1)):r.push(n[i]);const a=Vs(r,this.axis);return jS(a,-1,!1)})}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}H5.className="Concatenate";it(H5);function hg(t,e){for(;t<0;)t+=e;return t}function NAe(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new an("batchDot is not implemented for tensors of 4D or higher rank yet");if(Z(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),Z(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof n=="number"&&(n=[n,n]),t.dtype==="complex64"||e.dtype==="complex64")throw new an("batchDot is not implemented for complex64-type Tensors yet.");const s=t.shape.length,r=e.shape.length;n==null&&(n=[s-1,r-2]);const a=n;return Ee(()=>{let i;if(s>r){i=s-r;const c=[];for(let u=0;u<i;++u)c.push(1);e=be(e,e.shape.concat(c))}else if(r>s){i=r-s;const c=[];for(let u=0;u<i;++u)c.push(1);t=be(t,t.shape.concat(c))}else i=0;let l;if(t.shape.length===2&&e.shape.length===2)a[0]===a[1]?l=$t(ge(t,e),a[0]):l=$t(ge(bn(t,[1,0]),e),a[1]);else{const c=a[0]!==t.shape.length-1,u=a[1]===e.shape.length-1;l=mn(t,e,c,u)}if(i>0){let c;s>r?c=s+r-3:c=s-1;const u=[];for(let h=c;h<c+i;++h)u.push(h);l=fd(l,u)}return l.shape.length===1&&(l=Br(l,1)),l})}class G5 extends Jh{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){Z(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0],s=e[1];if(n.length>3||s.length>3)throw new an("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);if(n[r[0]]!==s[r[1]])throw new ve(`Dimension incompatibility: ${n[r[0]]} !== ${s[r[1]]}`)}mergeFunction(e){if(e.length!==2)throw new ve(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let n=e[0],s=e[1],r;return Array.isArray(this.axes)?r=this.axes.map((a,i)=>hg(a,e[i].shape.length)):r=[hg(this.axes,n.shape.length),hg(this.axes,s.shape.length)],this.normalize&&(n=r2(n,r[0]),s=r2(s,r[1])),NAe(n,s,r)}interpretAxes(e,n){let s;return Array.isArray(this.axes)?s=this.axes:s=[hg(this.axes,e.length),hg(this.axes,n.length)],s}computeOutputShape(e){Z(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0].slice(),s=e[1].slice();if(n.length>3||s.length>3)throw new an("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);n.splice(r[0],1),s.splice(r[1],1),s.splice(0,1);const a=n.concat(s);return a.length===1&&a.push(1),a}computeMask(e,n){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(e,n),e}}G5.className="Dot";it(G5);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class q5 extends pn{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,e),n}call(e,n){return Ee(()=>{this.invokeCallHook(e,n);const s=Yt(e);return bb(()=>nt(dj(s.shape,0,this.stddev),s),()=>s,n.training||!1)})}}q5.className="GaussianNoise";it(q5);class K5 extends pn{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return Ee(()=>{this.invokeCallHook(e,n);const s=Yt(e);return this.rate>0&&this.rate<1?bb(()=>{const a=Math.sqrt(this.rate/(1-this.rate));return ge(s,dj(s.shape,1,a))},()=>s,n.training||!1):s})}}K5.className="GaussianDropout";it(K5);class X5 extends pn{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||Yt(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return Ee(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(e);return bb(()=>{const a=Yt(e),l=-1.6732632423543772*1.0507009873554805;let c=Jc(md(s),this.rate);c=Pl(c,"float32");const u=((1-this.rate)*(1+this.rate*l**2))**-.5,h=-u*l*this.rate,f=nt(ge(a,c),ge(nt(c,-1),l));return nt(ge(f,u),h)},()=>Yt(e),n.training||!1)}return e})}}X5.className="AlphaDropout";it(X5);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function mx(t,e,n,s,r,a=.001){let i;if(t.rank===2)i=g$(t,e,n,s,r,a);else if(t.rank===3)i=x$(t,e,n,s,r,a);else if(t.rank===4)i=y$(t,e,n,s,r,a);else throw new an(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return i}function SAe(t,e,n,s,r=.001){return Ee(()=>{const a=ab(t,s),i=a.mean,l=a.variance;return[mx(t,i,l,n,e,r),i,l]})}function jAe(t,e,n,s,r=.001){return Ee(()=>{const a=ab(t,s),i=a.mean,l=a.variance,c=[];for(const y of ll(0,t.rank))s.indexOf(y)!==-1?c.push(1):c.push(t.shape[y]);const u=be(i,c),h=be(l,c),f=e==null?null:be(e,c),p=n==null?null:be(n,c);return[mx(t,u,h,p,f,r),i,l]})}function kAe(t,e,n,s,r=.001){return xn(s.slice().sort(),ll(0,t.rank-1))?SAe(t,e,n,s,r):jAe(t,e,n,s,r)}class Y5 extends pn{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=ks(e.betaInitializer||"zeros"),this.gammaInitializer=ks(e.gammaInitializer||"ones"),this.movingMeanInitializer=ks(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=ks(e.movingVarianceInitializer||"ones"),this.betaConstraint=gr(e.betaConstraint),this.gammaConstraint=gr(e.gammaConstraint),this.betaRegularizer=Cs(e.betaRegularizer),this.gammaRegularizer=Cs(e.gammaRegularizer)}build(e){e=$n(e);const n=this.axis>=0?this.axis:this.axis+e.length,s=e[n];if(s==null)throw new ve(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new er({ndim:e.length,axes:{[n]:s}})];const r=[s];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,n){return Ee(()=>{const s=n.training==null?!1:n.training,r=Yt(e),a=r.shape,i=a.length,l=ll(0,i),c=this.axis>=0?this.axis:this.axis+i;l.splice(c,1);const u=Ah(1,i);u[c]=a[c];const h=l.slice();h.sort();const f=!xn(h,ll(0,i).slice(0,i-1)),p=()=>{if(f){const S=be(this.movingMean.read(),u),k=be(this.movingVariance.read(),u),T=this.center?be(this.beta.read(),u):null,E=this.scale?be(this.gamma.read(),u):null;return mx(r,S,k,T,E,this.epsilon)}else return mx(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return p();const[x,y,v]=kAe(r,this.gamma.read(),this.beta.read(),l,this.epsilon),b=(S,k,T)=>{Ee(()=>{const E=1-T,D=S.read(),A=ge(Tt(D,k),E);S.write(Tt(D,A))})};return(()=>{b(this.movingMean,y,this.momentum),b(this.movingVariance,v,this.momentum)})(),x})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:$s(this.betaInitializer),gammaInitializer:$s(this.gammaInitializer),movingMeanInitializer:$s(this.movingMeanInitializer),movingVarianceInitializer:$s(this.movingVarianceInitializer),betaRegularizer:cs(this.betaRegularizer),gammaRegularizer:cs(this.gammaRegularizer),betaConstraint:pr(this.betaConstraint),gammaConstraint:pr(this.gammaConstraint)},n=super.getConfig();return Object.assign(e,n),e}}Y5.className="BatchNormalization";it(Y5);class Q5 extends pn{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=ks(e.betaInitializer||"zeros"),this.gammaInitializer=ks(e.gammaInitializer||"ones"),this.betaRegularizer=Cs(e.betaRegularizer),this.gammaRegularizer=Cs(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=$n(e);const n=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let a=0;a<this.axis.length;++a)this.axis[a]<0&&(this.axis[a]+=n);for(const a of this.axis)if(a<0||a>=n)throw new Error(`Invalid axis: ${a}`);if(this.axis.length!==Vu(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(a=>e[a]),r=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,n){const s=Yt(e),r=s.shape,a=r.length;return Ee(()=>{let{mean:l,variance:c}=ab(s,this.axis,!0);const u=Ah(1,a);for(const v of this.axis)u[v]=r[v];const h=v=>v!=null&&v.shape.length!==a?be(v,u):v;let f=this.scale?h(this.gamma.read()):null,p=this.center?h(this.beta.read()):null;const x=[],y=[];for(let v=0;v<a;++v)this.axis.indexOf(v)!==-1?(x.push(r[v]),y.push(1)):(x.push(1),y.push(r[v]));return l=Ui(l,x),c=Ui(c,x),f!=null&&(f=Ui(f,y)),p!=null&&(p=Ui(p,y)),mx(s,l,c,p,f,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:$s(this.betaInitializer),gammaInitializer:$s(this.gammaInitializer),betaRegularizer:cs(this.betaRegularizer),gammaRegularizer:cs(this.gammaRegularizer)},n=super.getConfig();return Object.assign(e,n),e}}Q5.className="LayerNormalization";it(Q5);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function CAe(t,e,n){return Ee(()=>{if(t.rank!==4)throw new ve(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new ve("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=cl()),n!=="channelsLast"&&n!=="channelsFirst")throw new ve(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return n==="channelsFirst"?s=[[0,0],[0,0],e[0],e[1]]:s=[[0,0],e[0],e[1],[0,0]],eu(t,s)})}class Z5 extends pn{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?cl():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new ve(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let n,s;if(typeof e.padding[0]=="number")n=[e.padding[0],e.padding[0]],s=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new ve(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(n=e.padding[0],e.padding[1].length!==2)throw new ve(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);s=e.padding[1]}this.padding=[n,s]}this.inputSpec=[new er({ndim:4})]}computeOutputShape(e){e=$n(e);let n,s;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?n=e[2]+this.padding[0][0]+this.padding[0][1]:n=null,e[3]!=null&&e[3]>=0?s=e[3]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],e[1],n,s]):(e[1]!=null&&e[1]>=0?n=e[1]+this.padding[0][0]+this.padding[0][1]:n=null,e[2]!=null&&e[2]>=0?s=e[2]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],n,s,e[3]])}call(e,n){return Ee(()=>CAe(Yt(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}Z5.className="ZeroPadding2D";it(Z5);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ej(t,e,n,s,r,a){return Ee(()=>{Gs(r),CK(a),so(s),n==null&&(n=[1,1]),s==null&&(s="valid"),r==null&&(r=cl()),a==null&&(a="max"),t=v5(t,r);let i;const l=s==="same"?"same":"valid";return a==="max"?i=rb(t,e,n,l):i=Yy(t,e,n,l),r==="channelsFirst"&&(i=bn(i,[0,3,1,2])),i})}function NX(t,e,n,s,r,a){return Ee(()=>{Gs(r),CK(a),so(s),n==null&&(n=[1,1,1]),s==null&&(s="valid"),r==null&&(r=cl()),a==null&&(a="max"),t=xX(t,r);let i;const l=s==="same"?"same":"valid";return a==="max"?i=B$(t,e,n,l):i=p$(t,e,n,l),r==="channelsFirst"&&(i=bn(i,[0,4,1,2,3])),i})}class SX extends pn{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new ve(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(Tr(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new ve(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);Tr(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,so(this.padding),this.inputSpec=[new er({ndim:3})]}computeOutputShape(e){e=$n(e);const n=il(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],n,e[2]]}call(e,n){return Ee(()=>{this.invokeCallHook(e,n),e=xb(Yt(e),2);const s=this.poolingFunction(Yt(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return fd(s,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(e,n),e}}class J5 extends SX{constructor(e){super(e)}poolingFunction(e,n,s,r,a){return Gs(a),so(r),Ej(e,n,s,r,a,"max")}}J5.className="MaxPooling1D";it(J5);class eR extends SX{constructor(e){super(e)}poolingFunction(e,n,s,r,a){return Gs(a),so(r),Ej(e,n,s,r,a,"avg")}}eR.className="AveragePooling1D";it(eR);class jX extends pn{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new ve(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];Tr(this.poolSize,"poolSize"),Tr(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Gs(this.dataFormat),so(this.padding),this.inputSpec=[new er({ndim:4})]}computeOutputShape(e){e=$n(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2];return n=il(n,this.poolSize[0],this.padding,this.strides[0]),s=il(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s]:[e[0],n,s,e[3]]}call(e,n){return Ee(()=>(this.invokeCallHook(e,n),this.poolingFunction(Yt(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class tR extends jX{constructor(e){super(e)}poolingFunction(e,n,s,r,a){return Gs(a),so(r),Ej(e,n,s,r,a,"max")}}tR.className="MaxPooling2D";it(tR);class nR extends jX{constructor(e){super(e)}poolingFunction(e,n,s,r,a){return Gs(a),so(r),Ej(e,n,s,r,a,"avg")}}nR.className="AveragePooling2D";it(nR);class kX extends pn{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new ve(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];Tr(this.poolSize,"poolSize"),Tr(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Gs(this.dataFormat),so(this.padding),this.inputSpec=[new er({ndim:5})]}computeOutputShape(e){e=$n(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[4]:e[3];return n=il(n,this.poolSize[0],this.padding,this.strides[0]),s=il(s,this.poolSize[1],this.padding,this.strides[1]),r=il(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s,r]:[e[0],n,s,r,e[4]]}call(e,n){return Ee(()=>(this.invokeCallHook(e,n),this.poolingFunction(Yt(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class sR extends kX{constructor(e){super(e)}poolingFunction(e,n,s,r,a){return Gs(a),so(r),NX(e,n,s,r,a,"max")}}sR.className="MaxPooling3D";it(sR);class rR extends kX{constructor(e){super(e)}poolingFunction(e,n,s,r,a){return Gs(a),so(r),NX(e,n,s,r,a,"avg")}}rR.className="AveragePooling3D";it(rR);class CX extends pn{constructor(e){super(e),this.inputSpec=[new er({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,n){throw new an}}class aR extends CX{constructor(e){super(e||{})}call(e,n){return Ee(()=>{const s=Yt(e);return Es(s,1)})}}aR.className="GlobalAveragePooling1D";it(aR);class iR extends CX{constructor(e){super(e||{})}call(e,n){return Ee(()=>{const s=Yt(e);return Ki(s,1)})}}iR.className="GlobalMaxPooling1D";it(iR);class TX extends pn{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,Gs(this.dataFormat),this.inputSpec=[new er({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,n){throw new an}getConfig(){const e={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class oR extends TX{call(e,n){return Ee(()=>{const s=Yt(e);return this.dataFormat==="channelsLast"?Es(s,[1,2]):Es(s,[2,3])})}}oR.className="GlobalAveragePooling2D";it(oR);class lR extends TX{call(e,n){return Ee(()=>{const s=Yt(e);return this.dataFormat==="channelsLast"?Ki(s,[1,2]):Ki(s,[2,3])})}}lR.className="GlobalMaxPooling2D";it(lR);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class _X extends pn{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(e,n),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,n,s={}){const r=n.layer,a=al(r,s);delete n.layer;const i={layer:a};return Object.assign(i,n),new e(i)}}class cR extends _X{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=$n(e),e.length<3)throw new ve(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=$n(e);const n=[e[0]].concat(e.slice(2)),s=this.layer.computeOutputShape(n),r=e[1];return[s[0],r].concat(s.slice(1))}call(e,n){return Ee(()=>(e=Yt(e),vX((i,l)=>[Yt(this.layer.call(i,n)),[]],e,[],!1,null,null,!1,!0)[1]))}}cR.className="TimeDistributed";it(cR);function TAe(t){Qh(TEe,"BidirectionalMergeMode",t)}const _Ae="concat";class uR extends _X{constructor(e){super(e);const n=e.layer.getConfig(),s={};s.className=e.layer.getClassName(),s.config=n,this.forwardLayer=al(s),n.goBackwards=n.goBackwards!==!0;const r={};if(r.className=e.layer.getClassName(),r.config=n,this.backwardLayer=al(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?_Ae:e.mergeMode,TAe(this.mergeMode),e.weights)throw new an("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const n=e.length,s=Math.floor(n/2);this.forwardLayer.setWeights(e.slice(0,s)),this.backwardLayer.setWeights(e.slice(s))}computeOutputShape(e){let n=this.forwardLayer.computeOutputShape(e);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let s,r,a;return this.returnState&&(a=n.slice(1)),s=n[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,r=[s]):this.mergeMode==null?r=[s,s.slice()]:r=[s],this.returnState?this.mergeMode==null?r.concat(a).concat(a.slice()):[s].concat(a).concat(a.slice()):Pa(r)}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const a=bX(e,s,r,this.numConstants);if(e=a.inputs,s=a.initialState,r=a.constants,Array.isArray(e)&&(s=e.slice(1),e=e[0]),(s==null||s.length===0)&&r==null)return super.apply(e,n);const i=[],l=[];if(s!=null){const u=s.length;if(u%2>0)throw new ve("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=s,i.push(...s);const h=s.map(f=>new er({shape:f.shape}));this.forwardLayer.stateSpec=h.slice(0,u/2),this.backwardLayer.stateSpec=h.slice(u/2),l.push(...h)}if(r!=null)throw new an("Support for constants in Bidirectional layers is not implemented yet.");const c=i[0]instanceof ul;for(const u of i)if(u instanceof ul!==c)throw new ve("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(c){const u=[e].concat(i),h=this.inputSpec.concat(l),f=this.inputSpec;this.inputSpec=h;const p=super.apply(u,n);return this.inputSpec=f,p}else return super.apply(e,n)}call(e,n){return Ee(()=>{const s=n.initialState;let r,a;if(s==null)r=this.forwardLayer.call(e,n),a=this.backwardLayer.call(e,n);else{const c=s.slice(0,s.length/2),u=s.slice(s.length/2);r=this.forwardLayer.call(e,Object.assign(n,{initialState:c})),a=this.backwardLayer.call(e,Object.assign(n,{initialState:u}))}let i;this.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(a.slice(1))),r=r[0],a=a[0]),this.returnSequences&&(a=Ji(a,1));let l;return this.mergeMode==="concat"?l=KI([r,a]):this.mergeMode==="sum"?l=nt(r,a):this.mergeMode==="ave"?l=ge(.5,nt(r,a)):this.mergeMode==="mul"?l=ge(r,a):this.mergeMode==null&&(l=[r,a]),this.returnState?this.mergeMode==null?l.concat(i):[l].concat(i):l})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){dh(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),dh(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,n){Array.isArray(n)&&(n=n[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[n,n]:s=n:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const a=this.forwardLayer.states.map(i=>null);return Array.isArray(s)?s.concat(a).concat(a):[s].concat(a).concat(a)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(e,n){const s=al(n.layer);if(delete n.layer,n.numConstants!=null)throw new an("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=n;return r.layer=s,new e(r)}}uR.className="Bidirectional";it(uR);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class dR extends pn{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return Ee(()=>(e=Yt(e),e.dtype!=="float32"&&(e=Pl(e,"float32")),nt(ge(e,this.scale),this.offset)))}}dR.className="Rescaling";it(dR);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:EAe,cropAndResize:AAe}=Vi;class hR extends pn{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,n,s,r,a,i,l,c){return Ee(()=>{let u,h=!1;const f=n/i,p=s/l,x=(r+n)/i,y=(a+s)/l,v=[f,p,x,y],b=[];e.rank===3?(h=!0,u=ka([e])):u=e;for(let E=0;E<u.shape[0];E++)b.push(v);const N=pi(b,[b.length,4]),S=_h(0,b.length,1,"int32"),T=AAe(u,N,S,[r,a],"nearest");return Pl(h?Yt(eo(T)):T,c)})}upsize(e,n,s,r){return Ee(()=>{const a=EAe(e,[n,s]);return Pl(a,r)})}call(e,n){return Ee(()=>{const s=Yt(e),r=s.dtype,a=s.shape,i=a[a.length-3],l=a[a.length-2];let c=0;i!==this.height&&(c=Math.floor((i-this.height)/2));let u=0;return l!==this.width&&(u=Math.floor((l-this.width)/2),u===0&&(u=1)),c>=0&&u>=0?this.centerCrop(s,c,u,this.height,this.width,i,l,r):this.upsize(e,this.height,this.width,r)})}getConfig(){const e={height:this.height,width:this.width},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=$n(e);const n=e.length-3,s=e.length-2;return e[n]=this.height,e[s]=this.width,e}}hR.className="CenterCrop";it(hR);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function $Ae(t,e,n,s){let r=Yt(t);if(r.dtype!=="int32"&&(r=Pl(r,"int32")),e==="int")return r;const a=r.shape;if(r.rank===0&&(r=Br(r,-1)),e==="oneHot"&&r.shape[r.shape.length-1]!==1&&(r=Br(r,-1)),r.rank>2)throw new ve(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${a} which would result in output rank ${r.rank}.`);const i=["multiHot","oneHot"].includes(e),l=r;let c;if(typeof s<"u"&&e==="count"?c=Zw(l,s,n,i):c=Zw(l,[],n,i),e!=="tfIdf")return c;if(s)return ge(c,s);throw new ve("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class mR extends pn{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){return e=$n(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,n){return Ee(()=>{e=Yt(e),e.dtype!=="int32"&&(e=Pl(e,"int32"));let s;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new ve(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);s=Yt(n.countWeights)}const r=Ki(e),a=pf(e),i=_a(this.numTokens,r).bufferSync().get(0),l=Jc(a,0).bufferSync().get(0);if(!(i&&l))throw new ve(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return $Ae(e,this.outputMode,this.numTokens,s)})}}mR.className="CategoryEncoding";it(mR);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const IAe=["bilinear","nearest"],sB=new Set(IAe);class fR extends pn{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(sB.has(e.interpolation))this.interpolation=e.interpolation;else throw new ve(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=$n(e);const n=e[2];return[this.height,this.width,n]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return Ee(()=>{const s=[this.height,this.width];if(this.interpolation==="bilinear")return Vi.resizeBilinear(e,s,!this.cropToAspectRatio);if(this.interpolation==="nearest")return Vi.resizeNearestNeighbor(e,s,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[...sB]} are supported`)})}}fR.className="Resizing";it(fR);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class EX{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}EX.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class AX extends pn{constructor(e){super(e),this.randomGenerator=new EX(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(e,n),e}}AX.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const RAe=["bilinear","nearest"],rB=new Set(RAe);class pR extends AX{constructor(e){super(e);const{factor:n,interpolation:s="bilinear"}=e;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new ve(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new ve(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new ve(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(s)if(rB.has(s))this.interpolation=s;else throw new ve(`Invalid interpolation parameter: ${s} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=$n(e);const n=e[2];return[this.imgHeight,-1,n]}call(e,n){return Ee(()=>{const s=Yt(e);this.imgHeight=s.shape[s.shape.length-3];const r=s.shape[s.shape.length-2];this.widthFactor=md([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let a=this.widthFactor.dataSync()[0]*r;a=Math.round(a);const i=[this.imgHeight,a];switch(this.interpolation){case"bilinear":return Vi.resizeBilinear(e,i);case"nearest":return Vi.resizeNearestNeighbor(e,i);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...rB]} are supported`)}})}}pR.className="RandomWidth";it(pR);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function OAe(t){return new Gp(t)}function DAe(t){return new x5(t)}function PAe(t){return new f5(t)}function LAe(t){return new p5(t)}function MAe(t){return new g5(t)}function FAe(t){return new b5(t)}function zAe(t){return new y5(t)}function BAe(t){return new Nb(t)}function UAe(t){return new Xp(t)}function VAe(t){return new w5(t)}function WAe(t){return new Yp(t)}function HAe(t){return new N5(t)}function GAe(t){return new S5(t)}function qAe(t){return new j5(t)}function KAe(t){return new k5(t)}function XAe(t){return new C5(t)}function YAe(t){return new O5(t)}function QAe(t){return new I5(t)}function ZAe(t){return new _j(t)}function JAe(t){return new $5(t)}function e$e(t){return new R5(t)}function t$e(t){return new D5(t)}function n$e(t){return new P5(t)}function s$e(t){return new L5(t)}function r$e(t){return new F5(t)}function a$e(t){return new z5(t)}function i$e(t){return new U5(t)}function o$e(t){return new H5(t)}function l$e(t){return new V5(t)}function c$e(t){return new W5(t)}function u$e(t){return new B5(t)}function d$e(t){return new G5(t)}function h$e(t){return new Y5(t)}function m$e(t){return new Q5(t)}function f$e(t){return new Z5(t)}function gR(t){return new eR(t)}function p$e(t){return gR(t)}function g$e(t){return gR(t)}function xR(t){return new nR(t)}function x$e(t){return xR(t)}function y$e(t){return xR(t)}function yR(t){return new rR(t)}function b$e(t){return yR(t)}function v$e(t){return yR(t)}function w$e(t){return new aR(t)}function N$e(t){return new oR(t)}function $X(t){return new iR(t)}function IX(t){return new lR(t)}function RX(t){return new J5(t)}function OX(t){return new tR(t)}function S$e(t){return new sR(t)}function j$e(t){return new _5(t)}function k$e(t){return new kj(t)}function C$e(t){return new E5(t)}function T$e(t){return new jb(t)}function _$e(t){return new T5(t)}function E$e(t){return new jj(t)}function A$e(t){return new A5(t)}function $$e(t){return new Tj(t)}function I$e(t){return new yl(t)}function R$e(t){return new Cj(t)}function O$e(t){return new uR(t)}function D$e(t){return new cR(t)}const P$e=$X,L$e=IX,M$e=RX,F$e=OX;function z$e(t){return new q5(t)}function B$e(t){return new K5(t)}function U$e(t){return new X5(t)}function V$e(t){return new M5(t)}function W$e(t){return new dR(t)}function H$e(t){return new hR(t)}function G$e(t){return new fR(t)}function q$e(t){return new mR(t)}function K$e(t){return new pR(t)}const X$e=Object.freeze(Object.defineProperty({__proto__:null,Layer:pn,RNN:yl,RNNCell:Sb,activation:YAe,add:a$e,alphaDropout:U$e,average:i$e,averagePooling1d:gR,averagePooling2d:xR,averagePooling3d:yR,avgPool1d:p$e,avgPool2d:x$e,avgPool3d:b$e,avgPooling1d:g$e,avgPooling2d:y$e,avgPooling3d:v$e,batchNormalization:h$e,bidirectional:O$e,categoryEncoding:q$e,centerCrop:H$e,concatenate:o$e,conv1d:BAe,conv2d:UAe,conv2dTranspose:VAe,conv3d:WAe,conv3dTranspose:HAe,convLstm2d:A$e,convLstm2dCell:$$e,cropping2D:qAe,dense:QAe,depthwiseConv2d:XAe,dot:d$e,dropout:ZAe,elu:DAe,embedding:r$e,flatten:e$e,gaussianDropout:B$e,gaussianNoise:z$e,globalAveragePooling1d:w$e,globalAveragePooling2d:N$e,globalMaxPool1d:P$e,globalMaxPool2d:L$e,globalMaxPooling1d:$X,globalMaxPooling2d:IX,gru:j$e,gruCell:k$e,input:eX,inputLayer:OAe,layerNormalization:m$e,leakyReLU:LAe,lstm:C$e,lstmCell:T$e,masking:V$e,maxPool1d:M$e,maxPool2d:F$e,maxPooling1d:RX,maxPooling2d:OX,maxPooling3d:S$e,maximum:l$e,minimum:c$e,multiply:u$e,permute:s$e,prelu:MAe,randomWidth:K$e,reLU:PAe,repeatVector:t$e,rescaling:W$e,reshape:n$e,resizing:G$e,rnn:I$e,separableConv2d:GAe,simpleRNN:_$e,simpleRNNCell:E$e,softmax:FAe,spatialDropout1d:JAe,stackedRNNCells:R$e,thresholdedReLU:zAe,timeDistributed:D$e,upSampling2d:KAe,zeroPadding2d:f$e},Symbol.toStringTag,{value:"Module"}));function Y$e(t,e){return c5(t,e)}function Q$e(t,e){return VK(t,e)}function Z$e(t,e){return WK(t,e)}function J$e(t,e){return u5(t,e)}function eIe(t,e){return d5(t,e)}function tIe(t,e){return UK(t,e)}function nIe(t,e){return D4e(t,e)}function sIe(t,e){return l5(t,e)}function rIe(t,e){return vj(t,e)}function aIe(t,e){return qp(t,e)}function iIe(t,e){return qp(t,e)}function oIe(t,e){return qp(t,e)}function lIe(t,e){return Zh(t,e)}function cIe(t,e){return Zh(t,e)}function uIe(t,e){return Zh(t,e)}function dIe(t,e){return P4e(t,e)}const hIe=Object.freeze(Object.defineProperty({__proto__:null,MAPE:iIe,MSE:cIe,binaryAccuracy:Y$e,binaryCrossentropy:Q$e,categoricalAccuracy:J$e,categoricalCrossentropy:eIe,cosineProximity:sIe,mape:oIe,meanAbsoluteError:rIe,meanAbsolutePercentageError:aIe,meanSquaredError:lIe,mse:uIe,precision:tIe,r2Score:dIe,recall:nIe,sparseCategoricalAccuracy:Z$e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const mIe=Object.freeze(Object.defineProperty({__proto__:null,modelFromJSON:dAe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function fIe(t){return new wb(t)}function pIe(t){return gAe(t)}function gIe(t){return xAe(t)}const xIe=Object.freeze(Object.defineProperty({__proto__:null,l1:pIe,l1l2:fIe,l2:gIe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class DX extends Nf{constructor(){super(...arguments),this.model=null}setModel(e){if(!(e instanceof Cc))throw new Error("model must be a LayersModel, not some other Container");this.model=e}}function m1(t,e){return t<e}function aB(t,e){return t>e}class PX extends DX{constructor(e){if(super(),e==null&&(e={}),e.restoreBestWeights)throw new an("restoreBestWeights = True is not implemented in EarlyStopping yet.");this.monitor=e.monitor||"val_loss",this.minDelta=Math.abs(e.minDelta||0),this.patience=e.patience||0,this.verbose=e.verbose||0,this.mode=e.mode||"auto",this.baseline=e.baseline,["auto","min","max"].indexOf(this.mode)===-1&&(console.warn(`EarlyStopping mode '${this.mode}' is invalid. Falling back to mode 'auto'.`),this.mode="auto"),this.mode==="min"?this.monitorFunc=m1:this.mode==="max"?this.monitorFunc=aB:this.monitor.indexOf("acc")!==-1?this.monitorFunc=aB:this.monitorFunc=m1,this.monitorFunc===m1&&(this.minDelta*=-1)}async onTrainBegin(e){this.wait=0,this.stoppedEpoch=0,this.baseline!=null?this.best=this.baseline:this.best=this.monitorFunc===m1?1/0:-1/0}async onEpochEnd(e,n){await _u(n);const s=this.getMonitorValue(n);s!=null&&(this.monitorFunc(s-this.minDelta,this.best)?(this.best=s,this.wait=0):(this.wait++,this.wait>=this.patience&&(this.stoppedEpoch=e,this.model.stopTraining=!0)))}async onTrainEnd(e){this.stoppedEpoch>0&&this.verbose&&console.log(`Epoch ${this.stoppedEpoch}: early stopping.`)}getMonitorValue(e){e==null&&(e={});const n=e[this.monitor];return n==null&&console.warn(`Metric for EarlyStopping ${this.monitor} is not available. Available metrics are: ${Object.keys(e)}`),n}}function yIe(t){return new PX(t)}const bIe={earlyStopping:yIe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vIe=$e();vIe.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var ai;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(ai||(ai={}));var iB;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(iB||(iB={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bR={};function wIe(t,e){const n={tfOpName:t,category:"custom",inputs:[],attrs:[],customExecutor:e};bR[t]=n}function LX(t){return bR[t]}function NIe(t){delete bR[t]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V(t,e,n,s,r){const a=e.inputParams[t];if(a&&a.inputIndexStart!==void 0){const l=a.inputIndexStart,c=a.inputIndexEnd===0?void 0:a.inputIndexEnd===void 0?l+1:a.inputIndexEnd,u=l<0?e.inputNames.length+l:l;if(a.type==="tensor")return Ur(e.inputNames[u],n,s,r);if(a.type==="tensors"){const p=e.inputs.slice(l,c);return e.inputNames.slice(l,c).filter((y,v)=>{var b;return((b=p[v])===null||b===void 0?void 0:b.op)!=="NoOp"}).map(y=>Ur(y,n,s,r))}const h=Ur(e.inputNames[u],n,s,r),f=h.dataSync();return a.type==="number"?f[0]:qi(h.shape,f)}const i=e.attrParams[t];return i&&i.value}function Ur(t,e,n,s){const[r,a]=li(t,n);if(s!=null){const l=s.getHashTableHandleByName(r);if(l!=null)return l}const i=n.currentContextIds.find(l=>!!e[c2(r,l)]);return i!==void 0?e[c2(r,i)][a]:void 0}function oB(t,e,n){return e[c2(t,n.currentContextId)]}function fc(t,e){const[n,s,r]=li(t,e);return[c2(n,e&&e.currentContextId),s,r]}function c2(t,e){return e?`${t}-${e}`:t}function li(t,e){if(t==="")return["",0,void 0];const n=e!=null&&e.parseNodeNameCache!=null;if(n){const a=e.parseNodeNameCache.get(t);if(a!=null)return a}const s=t.split(":");let r;if(s.length===1)r=[t,0,void 0];else{const a=s[0],i=s.length===3?s[1]:void 0,l=Number(s[s.length-1]);r=[a,l,i]}return n&&e.parseNodeNameCache.set(t,r),r}function G1(t,e,n){let s=V("pad",t,e,n);if(s==="explicit"){s=V("explicitPaddings",t,e,n);const r=[[0,0],[0,0],[0,0],[0,0]];for(let a=0;a<4;a++)r[a][0]=s[a*2],r[a][1]=s[a*2+1];return r}return s}function pc(t){return t.kept?t:Ol(t)}/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SIe=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],jIe=Object.freeze(Object.defineProperty({__proto__:null,json:SIe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kIe=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsFinite",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsInf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],CIe=Object.freeze(Object.defineProperty({__proto__:null,json:kIe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TIe=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],_Ie=Object.freeze(Object.defineProperty({__proto__:null,json:TIe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EIe=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],AIe=Object.freeze(Object.defineProperty({__proto__:null,json:EIe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Ie=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniformInt",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number"},{tfName:"maxval",name:"maxval",type:"number"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],IIe=Object.freeze(Object.defineProperty({__proto__:null,json:$Ie},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RIe=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],OIe=Object.freeze(Object.defineProperty({__proto__:null,json:RIe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DIe=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],PIe=Object.freeze(Object.defineProperty({__proto__:null,json:DIe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LIe=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],MIe=Object.freeze(Object.defineProperty({__proto__:null,json:LIe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FIe=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"InitializeTable",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]},{tfOpName:"InitializeTableV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],zIe=Object.freeze(Object.defineProperty({__proto__:null,json:FIe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BIe=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],UIe=Object.freeze(Object.defineProperty({__proto__:null,json:BIe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VIe=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BitwiseAnd",category:"logical",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}]}],WIe=Object.freeze(Object.defineProperty({__proto__:null,json:VIe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HIe=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"MatrixBandPart",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"numLower",type:"tensor"},{start:1,name:"numUpper",type:"tensor"}]}],GIe=Object.freeze(Object.defineProperty({__proto__:null,json:HIe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qIe=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]}],KIe=Object.freeze(Object.defineProperty({__proto__:null,json:qIe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XIe=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],YIe=Object.freeze(Object.defineProperty({__proto__:null,json:XIe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QIe=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]},{tfOpName:"TensorScatterUpdate",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"values",type:"tensor"}]}],ZIe=Object.freeze(Object.defineProperty({__proto__:null,json:QIe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JIe=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],e5e=Object.freeze(Object.defineProperty({__proto__:null,json:JIe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const t5e=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],n5e=Object.freeze(Object.defineProperty({__proto__:null,json:t5e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s5e=[{tfOpName:"StaticRegexReplace",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"pattern",name:"pattern",type:"string"},{tfName:"rewrite",name:"rewrite",type:"string"},{tfName:"replace_global",name:"replaceGlobal",type:"bool"}]},{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],r5e=Object.freeze(Object.defineProperty({__proto__:null,json:s5e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2023 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a5e=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"EnsureShape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],i5e=Object.freeze(Object.defineProperty({__proto__:null,json:a5e},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lB{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[jIe,CIe,_Ie,AIe,IIe,OIe,PIe,MIe,zIe,UIe,WIe,GIe,KIe,YIe,ZIe,e5e,n5e,r5e,i5e],n=[].concat(...e.map(s=>s.json));this.opMappers=n.reduce((s,r)=>(s[r.tfOpName]=r,s),{})}transformGraph(e,n={}){const s=e.node,r=[],a=[],i=[],l=s.reduce((v,b)=>(v[b.name]=this.mapNode(b),b.op.startsWith("Placeholder")?r.push(v[b.name]):b.op==="Const"?a.push(v[b.name]):(b.input==null||b.input.length===0)&&i.push(v[b.name]),v),{});let c=[];const u=[];let h={},f={};n!=null&&(h=this.mapSignatureEntries(n.inputs),f=this.mapSignatureEntries(n.outputs));const p=Object.keys(l);p.forEach(v=>{const b=l[v];b.inputNames.forEach((N,S)=>{const[k,,T]=fc(N),E=l[k];if(E.outputs!=null){const D=E.outputs.indexOf(T);if(D!==-1){const A=`${k}:${D}`;b.inputNames[S]=A}}b.inputs.push(E),E.children.push(b)})}),Object.keys(f).length===0?p.forEach(v=>{const b=l[v];b.children.length===0&&u.push(b)}):Object.keys(f).forEach(v=>{const[b]=fc(v),N=l[b];N!=null&&(N.signatureKey=f[v],u.push(N))}),Object.keys(h).length>0?Object.keys(h).forEach(v=>{const[b]=fc(v),N=l[b];N&&(N.signatureKey=h[v],c.push(N))}):c=r;let x={};e.library!=null&&e.library.function!=null&&(x=e.library.function.reduce((v,b)=>(v[b.signature.name]=this.mapFunction(b),v),{}));const y={nodes:l,inputs:c,outputs:u,weights:a,placeholders:r,signature:n,functions:x};return i.length>0&&(y.initNodes=i),y}mapSignatureEntries(e){return Object.keys(e||{}).reduce((n,s)=>(n[e[s].name]=s,n),{})}mapNode(e){const n=LX(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const s={name:e.name,op:e.op,category:n.category,inputNames:(e.input||[]).map(r=>r.startsWith("^")?r.slice(1):r),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:n.outputs};return n.inputs!=null&&(s.inputParams=n.inputs.reduce((r,a)=>(r[a.name]={type:a.type,inputIndexStart:a.start,inputIndexEnd:a.end},r),{})),n.attrs!=null&&(s.attrParams=n.attrs.reduce((r,a)=>{const i=a.type;let l;switch(a.type){case"string":l=kE(e.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=kE(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"string[]":l=IE(e.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=IE(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"number":l=TE(e.attr,a.tfName,a.defaultValue||0),l===void 0&&a.tfDeprecatedName&&(l=TE(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"number[]":l=$E(e.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=$E(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool":l=CE(e.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=CE(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"bool[]":l=OE(e.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=OE(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape":l=AE(e.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=AE(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"shape[]":l=RE(e.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=RE(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype":l=_E(e.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=_E(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"dtype[]":l=EE(e.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=EE(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"func":l=cB(e.attr,a.tfName,a.defaultValue),l===void 0&&a.tfDeprecatedName&&(l=cB(e.attr,a.tfDeprecatedName,a.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${a.type} for op: ${e.op}`)}return r[a.name]={value:l,type:i},r},{})),s}mapFunction(e){const n=e.nodeDef,s=[],r=[];let a={};n!=null&&(a=n.reduce((f,p)=>(f[p.name]=this.mapNode(p),p.op==="Const"&&r.push(f[p.name]),f),{}));const i=[],l=[];e.signature.inputArg.forEach(f=>{const[p]=fc(f.name),x={name:p,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:vR(f.type),type:"dtype"}},children:[]};x.signatureKey=f.name,i.push(x),a[p]=x}),Object.keys(a).forEach(f=>{const p=a[f];p.inputNames.forEach((x,y)=>{const[v,,b]=fc(x),N=a[v];if(N.outputs!=null){const S=N.outputs.indexOf(b);if(S!==-1){const k=`${v}:${S}`;p.inputNames[y]=k}}p.inputs.push(N),N.children.push(p)})});const u=e.ret;e.signature.outputArg.forEach(f=>{const[p,x]=fc(u[f.name]),y=a[p];y!=null&&(y.defaultOutput=x,l.push(y))});const h=this.mapArgsToSignature(e);return{nodes:a,inputs:i,outputs:l,weights:r,placeholders:s,signature:h}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((n,s)=>(n[s.name]=this.mapArgToTensorInfo(s),n),{}),outputs:e.signature.outputArg.reduce((n,s)=>(n[s.name]=this.mapArgToTensorInfo(s,e.ret),n),{})}}mapArgToTensorInfo(e,n){let s=e.name;return n!=null&&(s=n[s]),{name:s,dtype:e.type}}}function o5e(t){const e=$e().global;if(typeof e.atob<"u")return e.atob(t);if(typeof Buffer<"u")return new Buffer(t,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function MX(t,e){const n=Array.isArray(t)?String.fromCharCode.apply(null,t):o5e(t);return e?n:n.toLowerCase()}function kE(t,e,n,s=!1){const r=t[e];return r!=null?MX(r.s,s):n}function CE(t,e,n){const s=t[e];return s?s.b:n}function TE(t,e,n){const s=t[e]||{},r=s.i!=null?s.i:s.f!=null?s.f:n;return typeof r=="number"?r:parseInt(r,10)}function vR(t){switch(typeof t=="string"&&(t=ai[t]),t){case ai.DT_FLOAT:case ai.DT_HALF:return"float32";case ai.DT_INT32:case ai.DT_INT64:case ai.DT_INT8:case ai.DT_UINT8:return"int32";case ai.DT_BOOL:return"bool";case ai.DT_DOUBLE:return"float32";case ai.DT_STRING:return"string";case ai.DT_COMPLEX64:case ai.DT_COMPLEX128:return"complex64";default:return null}}function cB(t,e,n){const s=t[e];return s&&s.func?s.func.name:n}function _E(t,e,n){const s=t[e];return s&&s.type?vR(s.type):n}function EE(t,e,n){const s=t[e];return s&&s.list&&s.list.type?s.list.type.map(r=>vR(r)):n}function FX(t){if(!t.unknownRank)return t.dim!=null?t.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function AE(t,e,n){const s=t[e];return s&&s.shape?FX(s.shape):n}function $E(t,e,n){const s=t[e];return s?((s.list.f&&s.list.f.length?s.list.f:s.list.i)||[]).map(r=>typeof r=="number"?r:parseInt(r,10)):n}function IE(t,e,n,s=!1){const r=t[e];return r&&r.list&&r.list.s?r.list.s.map(a=>MX(a,s)):n}function RE(t,e,n){const s=t[e];return s&&s.list&&s.list.shape?s.list.shape.map(r=>FX(r)):n}function OE(t,e,n){const s=t[e];return s&&s.list&&s.list.b?s.list.b:n}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class l5e{constructor(e,n,s){this.node=e,this.tensorMap=n,this.context=s,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(r=>this.getInput(r)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((r,a)=>(r[a]=this.getAttr(a),r),{}))}getInput(e){return Ur(e,this.tensorMap,this.context)}getAttr(e,n){const s=this.node.rawAttrs[e];if(s.tensor!=null)return Ur(e,this.tensorMap,this.context);if(s.i!=null||s.f!=null)return TE(this.node.rawAttrs,e,n);if(s.s!=null)return kE(this.node.rawAttrs,e,n);if(s.b!=null)return CE(this.node.rawAttrs,e,n);if(s.shape!=null)return AE(this.node.rawAttrs,e,n);if(s.type!=null)return _E(this.node.rawAttrs,e,n);if(s.list!=null){if(s.list.i!=null||s.list.f!=null)return $E(this.node.rawAttrs,e,n);if(s.list.s!=null)return IE(this.node.rawAttrs,e,n);if(s.list.shape!=null)return RE(this.node.rawAttrs,e,n);if(s.list.b!=null)return OE(this.node.rawAttrs,e,n);if(s.list.type!=null)return EE(this.node.rawAttrs,e,n)}return n}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ea=Object.freeze(Object.defineProperty({__proto__:null,OP_SCOPE_SUFFIX:ZA,abs:Js,acos:i$,acosh:o$,add:nt,addN:kG,all:jS,any:ox,argMax:jh,argMin:l$,asin:c$,asinh:u$,atan:d$,atan2:h$,atanh:m$,avgPool:Yy,avgPool3d:p$,basicLSTMCell:CG,batchNorm:Mp,batchNorm2d:g$,batchNorm3d:x$,batchNorm4d:y$,batchToSpaceND:Qy,bincount:b$,bitwiseAnd:TG,booleanMaskAsync:dq,broadcastArgs:_G,broadcastTo:uh,buffer:on,cast:ft,ceil:v$,clipByValue:Ha,clone:Ol,complex:Pc,concat:Vs,concat1d:w$,concat2d:N$,concat3d:S$,concat4d:j$,conv1d:kS,conv2d:Lc,conv2dTranspose:CS,conv3d:C$,conv3dTranspose:T$,cos:Zy,cosh:TS,cosineWindow:YS,cumprod:ux,cumsum:_S,denseBincount:Zw,depthToSpace:_$,depthwiseConv2d:Fp,diag:AG,dilation2d:E$,div:Mt,divNoNan:A$,dot:$$,dropout:aI,einsum:Wd,elu:zp,enclosingPowerOfTwo:iI,ensureShape:$G,equal:gi,erf:ES,euclideanNorm:R$,exp:Ga,expandDims:Br,expm1:O$,eye:AS,fft:db,fill:qh,floor:Up,floorDiv:SS,fused:vq,gather:Vp,gatherND:pq,greater:_a,greaterEqual:Jc,ifft:vf,imag:Jy,image:Vi,inTopKAsync:gq,irfft:WS,isFinite:D$,isInf:P$,isNaN:L$,leakyRelu:eb,less:gf,lessEqual:hd,linalg:cI,linspace:OG,localResponseNormalization:M$,log:xi,log1p:tb,logSigmoid:F$,logSoftmax:IS,logSumExp:nb,logicalAnd:Io,logicalNot:sb,logicalOr:RS,logicalXor:z$,losses:Tq,lowerBound:PG,matMul:mn,max:Ki,maxPool:rb,maxPool3d:B$,maxPoolWithArgmax:LG,maximum:Gl,mean:Es,meshgrid:MG,min:pf,minimum:Ju,mirrorPad:U$,mod:V$,moments:ab,movingAverage:hq,mul:ge,multiRNNCell:FG,multinomial:zG,neg:gs,norm:Bp,notEqual:Th,oneHot:xf,ones:Fa,onesLike:yi,op:he,outerProduct:BG,pad:eu,pad1d:UG,pad2d:VG,pad3d:WG,pad4d:HG,pool:W$,pow:Ul,prelu:ob,print:a$,prod:H$,raggedGather:GG,raggedRange:qG,raggedTensorToTensor:KG,rand:XG,randomGamma:ZG,randomNormal:DS,randomStandardNormal:JG,randomUniform:md,randomUniformInt:eq,range:_h,real:yf,reciprocal:X$,relu:gl,relu6:PS,reshape:be,reverse:Ji,reverse1d:tq,reverse2d:nq,reverse3d:sq,reverse4d:rq,rfft:hb,round:LS,rsqrt:MS,scalar:Bt,scatterND:mq,searchSorted:OS,selu:FS,separableConv2d:zS,setdiff1dAsync:aq,sigmoid:rl,sign:Y$,signal:Cq,sin:BS,sinh:US,slice:Nn,slice1d:lb,slice2d:VS,slice3d:cb,slice4d:bf,softmax:ub,softplus:Kh,spaceToBatchND:ib,sparse:_q,sparseToDense:fq,spectral:kq,split:Ua,sqrt:Ar,square:Jn,squaredDifference:HS,squeeze:fd,stack:ka,step:Xh,stridedSlice:Q$,string:Eq,sub:Tt,sum:$t,tan:Z$,tanh:Zu,tensor:pi,tensor1d:Wr,tensor2d:Uu,tensor3d:J$,tensor4d:iq,tensor5d:oq,tensor6d:lq,tensorScatterUpdate:cq,tile:Ui,topk:tI,transpose:bn,truncatedNormal:qS,unique:nI,unsortedSegmentSum:KS,unstack:eo,upperBound:uq,variable:sI,where:_r,whereAsync:rI,zeros:Us,zerosLike:Sn},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c5e=(t,e,n,s=ea)=>{switch(t.op){case"BiasAdd":case"AddV2":case"Add":return[s.add(V("a",t,e,n),V("b",t,e,n))];case"AddN":return[s.addN(V("tensors",t,e,n))];case"FloorMod":case"Mod":return[s.mod(V("a",t,e,n),V("b",t,e,n))];case"Mul":return[s.mul(V("a",t,e,n),V("b",t,e,n))];case"RealDiv":case"Div":return[s.div(V("a",t,e,n),V("b",t,e,n))];case"DivNoNan":return[s.divNoNan(V("a",t,e,n),V("b",t,e,n))];case"FloorDiv":return[s.floorDiv(V("a",t,e,n),V("b",t,e,n))];case"Sub":return[s.sub(V("a",t,e,n),V("b",t,e,n))];case"Minimum":return[s.minimum(V("a",t,e,n),V("b",t,e,n))];case"Maximum":return[s.maximum(V("a",t,e,n),V("b",t,e,n))];case"Pow":return[s.pow(V("a",t,e,n),V("b",t,e,n))];case"SquaredDifference":return[s.squaredDifference(V("a",t,e,n),V("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u5e=(t,e,n,s=ea)=>{switch(t.op){case"Abs":case"ComplexAbs":return[s.abs(V("x",t,e,n))];case"Acos":return[s.acos(V("x",t,e,n))];case"Acosh":return[s.acosh(V("x",t,e,n))];case"Asin":return[s.asin(V("x",t,e,n))];case"Asinh":return[s.asinh(V("x",t,e,n))];case"Atan":return[s.atan(V("x",t,e,n))];case"Atan2":return[s.atan2(V("x",t,e,n),V("y",t,e,n))];case"Atanh":return[s.atanh(V("x",t,e,n))];case"Ceil":return[s.ceil(V("x",t,e,n))];case"Complex":return[s.complex(V("real",t,e,n),V("imag",t,e,n))];case"Cos":return[s.cos(V("x",t,e,n))];case"Cosh":return[s.cosh(V("x",t,e,n))];case"Elu":return[s.elu(V("x",t,e,n))];case"Erf":return[s.erf(V("x",t,e,n))];case"Exp":return[s.exp(V("x",t,e,n))];case"Expm1":return[s.expm1(V("x",t,e,n))];case"Floor":return[s.floor(V("x",t,e,n))];case"Log":return[s.log(V("x",t,e,n))];case"Log1p":return[s.log1p(V("x",t,e,n))];case"Imag":return[s.imag(V("x",t,e,n))];case"Neg":return[s.neg(V("x",t,e,n))];case"Reciprocal":return[s.reciprocal(V("x",t,e,n))];case"Real":return[s.real(V("x",t,e,n))];case"Relu":return[s.relu(V("x",t,e,n))];case"Round":return[s.round(V("x",t,e,n))];case"Selu":return[s.selu(V("x",t,e,n))];case"Sigmoid":return[s.sigmoid(V("x",t,e,n))];case"Sin":return[s.sin(V("x",t,e,n))];case"Sign":return[s.sign(V("x",t,e,n))];case"Sinh":return[s.sinh(V("x",t,e,n))];case"Softplus":return[s.softplus(V("x",t,e,n))];case"Sqrt":return[s.sqrt(V("x",t,e,n))];case"Square":return[s.square(V("x",t,e,n))];case"Tanh":return[s.tanh(V("x",t,e,n))];case"Tan":return[s.tan(V("x",t,e,n))];case"ClipByValue":return[s.clipByValue(V("x",t,e,n),V("clipValueMin",t,e,n),V("clipValueMax",t,e,n))];case"Relu6":return[s.relu6(V("x",t,e,n))];case"Rsqrt":return[s.rsqrt(Ur(t.inputNames[0],e,n))];case"LeakyRelu":return[s.leakyRelu(V("x",t,e,n),V("alpha",t,e,n))];case"Prelu":return[s.prelu(V("x",t,e,n),V("alpha",t,e,n))];case"IsNan":return[s.isNaN(Ur(t.inputNames[0],e,n))];case"IsInf":return[s.isInf(Ur(t.inputNames[0],e,n))];case"IsFinite":return[s.isFinite(Ur(t.inputNames[0],e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ko(t,e,n=""){if(!(typeof t=="number"||typeof e=="number")){Z(t.length===e.length,()=>n+` Shapes ${t} and ${e} must match`);for(let s=0;s<t.length;s++){const r=t[s],a=e[s];Z(r<0||a<0||r===a,()=>n+` Shapes ${t} and ${e} must match`)}}}function uB(t){return!(typeof t=="number"||t.some(e=>e<0))}function mg(t,e,n){let s=DE(t,n);const r=!uB(s);if(r&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${s}`);if(r&&e.forEach(a=>{s=DE(a.shape,s)}),!uB(s))throw new Error(`Non-fully-defined elementShape: ${s}`);return s}function DE(t,e){if(typeof t=="number")return e;if(typeof e=="number")return t;if(t.length!==e.length)throw new Error(`Incompatible ranks during merge: ${t} vs. ${e}`);const n=[];for(let s=0;s<t.length;++s){const r=t[s],a=e[s];if(r>=0&&a>=0&&r!==a)throw new Error(`Incompatible shape during merge: ${t} vs. ${e}`);n[s]=r>=0?r:a}return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class d5e{constructor(e,n,s,r,a,i,l){this.name=e,this.dtype=n,this.maxSize=s,this.elementShape=r,this.identicalElementShapes=a,this.dynamicSize=i,this.clearAfterRead=l,this.tensors=[],this.closed_=!1,this.idTensor=Bt(0),hr(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.tensor.id))&&n.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const n=this.tensors[e];if(n.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(n.cleared=!0),n.read=!0,n.tensor}readMany(e){return e.map(n=>this.read(n))}write(e,n){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const s=this.tensors[e]||{};if(n.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${n.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=n.shape),ko(this.elementShape,n.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),s.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(s.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);s.tensor=n,hr(n),s.written=!0,this.tensors[e]=s}writeMany(e,n){if(e.length!==n.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${n.length}.`);e.forEach((s,r)=>this.write(s,n[r]))}gather(e,n){if(n&&n!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${n}`);if(e)e=e.slice(0,this.size());else{e=[];for(let r=0;r<this.size();r++)e.push(r)}if(e.length===0)return pi([],[0].concat(this.elementShape));const s=this.readMany(e);return ko(this.elementShape,s[0].shape,"TensorArray shape mismatch: "),ka(s,0)}concat(e){if(e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return pi([],[0].concat(this.elementShape));const n=[];for(let r=0;r<this.size();r++)n.push(r);const s=this.readMany(n);return ko(this.elementShape,s[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${s[0].shape})`),Vs(s,0)}scatter(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const s=Math.max(...e);if(!this.dynamicSize&&s>=this.maxSize)throw new Error(`Max index must be < array size (${s}  vs. ${this.maxSize})`);this.writeMany(e,eo(n,0))}split(e,n){if(n.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${n.dtype}`);let s=0;const r=e.map(c=>(s+=c,s));if(s!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${n.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const a=s===0?0:n.size/s,i=[];Ee(()=>{n=be(n,[1,s,a]);for(let c=0;c<e.length;++c){const h=[0,c===0?0:r[c-1],0],f=[1,e[c],a];i[c]=be(Nn(n,h,f),this.elementShape)}return i});const l=[];for(let c=0;c<e.length;c++)l[c]=c;this.writeMany(l,i)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ih{get id(){return this.idTensor.id}constructor(e,n,s,r=-1){this.tensors=e,this.elementShape=n,this.elementDtype=s,e!=null&&e.forEach(a=>{if(s!==a.dtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${a.dtype}`);ko(n,a.shape,"TensorList shape mismatch: "),hr(a)}),this.idTensor=Bt(0),this.maxNumElements=r,hr(this.idTensor)}copy(){return new Ih([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(n=>{(e==null||!e.has(n.id))&&n.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,n,s=-1){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(s!==-1&&this.tensors.length!==s)throw new Error(`Operation expected a list with ${s} elements but got a list with ${this.tensors.length} elements.`);ko(e,this.elementShape,"TensorList shape mismatch: ");const r=mg(this.elementShape,this.tensors,e);return Ee(()=>{const a=this.tensors.map(i=>be(i,r));return ka(a,0)})}popBack(e,n){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const s=mg(this.elementShape,this.tensors,e),r=this.tensors.pop();return r.kept=!1,ko(r.shape,e,"TensorList shape mismatch: "),be(r,s)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(ko(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");hr(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const n=new Ih([],this.elementShape,this.elementDtype,this.maxNumElements);n.tensors.length=e;for(let s=0;s<Math.min(this.tensors.length,e);++s)n.tensors[s]=this.tensors[s];return n}getItem(e,n,s){if(s!==this.elementDtype)throw new Error(`Invalid data types; op elements ${s}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);ko(this.tensors[e].shape,n,"TensorList shape mismatch: ");const r=mg(this.elementShape,this.tensors,n);return be(this.tensors[e],r)}setItem(e,n){if(n.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);ko(this.elementShape,n.shape,"TensorList shape mismatch: "),hr(n),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=n}gather(e,n,s){if(n!==this.elementDtype)throw new Error(`Invalid data types; op elements ${n}, but list elements ${this.elementDtype}`);ko(this.elementShape,s,"TensorList shape mismatch: "),e=e.slice(0,this.size());const r=mg(this.elementShape,this.tensors,s);return e.length===0?pi([],[0].concat(r)):Ee(()=>{const a=e.map(i=>be(this.tensors[i],r));return ka(a,0)})}concat(e,n){if(e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);ko(this.elementShape,n,"TensorList shape mismatch: ");const s=mg(this.elementShape,this.tensors,n);return this.size()===0?pi([],[0].concat(s)):Ee(()=>{const r=this.tensors.map(a=>be(a,s));return Vs(r,0)})}}function h5e(t,e,n){const s=t.dtype;if(t.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${t.shape}`);if(t.dtype!==n)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${n}`);const r=t.shape.slice(1);ko(r,e,"TensorList shape mismatch: ");const a=eo(t);return new Ih(a,e,s)}function m5e(t,e,n,s){return new Ih([],t,e,s)}function f5e(t,e,n,s){if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const r=Math.max(...e);if(s!=null&&s!==-1&&r>=s)throw new Error(`Max index must be < array size (${r}  vs. ${s})`);const a=new Ih([],n,t.dtype,s),i=eo(t,0);return e.forEach((l,c)=>{a.setItem(l,i[c])}),a}function p5e(t,e,n){let s=0;const r=e.map(h=>(s+=h,s));if(s!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${s}, and tensor's shape is: ${t.shape}`);const a=t.shape.slice(1),i=DE(a,n),l=s===0?0:t.size/s,c=Ee(()=>{const h=[];t=be(t,[1,s,l]);for(let f=0;f<e.length;++f){const x=[0,f===0?0:r[f-1],0],y=[1,e[f],l];h[f]=be(Nn(t,x,y),i)}return t.dispose(),h}),u=new Ih([],n,t.dtype,e.length);for(let h=0;h<c.length;h++)u.setItem(h,c[h]);return u}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g5e=async(t,e,n)=>{switch(t.op){case"If":case"StatelessIf":{const s=V("thenBranch",t,e,n),r=V("elseBranch",t,e,n),a=V("cond",t,e,n),i=V("args",t,e,n);return(await a.data())[0]?n.functionMap[s].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap):n.functionMap[r].executeFunctionAsync(i,n.tensorArrayMap,n.tensorListMap)}case"While":case"StatelessWhile":{const s=V("body",t,e,n),r=V("cond",t,e,n),a=V("args",t,e,n),i=await n.functionMap[r].executeFunctionAsync(a,n.tensorArrayMap,n.tensorListMap),l=a.map(h=>h.id);let c=await i[0].data();i.forEach(h=>{!h.kept&&l.indexOf(h.id)===-1&&h.dispose()});let u=a;for(;c[0];){const h=u;u=await n.functionMap[s].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);const f=u.map(x=>x.id);h.forEach(x=>{!x.kept&&l.indexOf(x.id)===-1&&f.indexOf(x.id)===-1&&x.dispose()});const p=await n.functionMap[r].executeFunctionAsync(u,n.tensorArrayMap,n.tensorListMap);c=await p[0].data(),p.forEach(x=>{!x.kept&&l.indexOf(x.id)===-1&&f.indexOf(x.id)===-1&&x.dispose()})}return u}case"LoopCond":{const s=V("pred",t,e,n);return[pc(s)]}case"Switch":{const s=V("pred",t,e,n);let r=V("data",t,e,n);return r.kept||(r=pc(r)),(await s.data())[0]?[void 0,r]:[r,void 0]}case"Merge":{const s=t.inputNames.find(r=>Ur(r,e,n)!==void 0);if(s){const r=Ur(s,e,n);return[pc(r)]}return}case"Enter":{const s=V("frameName",t,e,n),r=V("tensor",t,e,n);return n.enterFrame(s),[pc(r)]}case"Exit":{const s=V("tensor",t,e,n);return n.exitFrame(),[pc(s)]}case"NextIteration":{const s=V("tensor",t,e,n);return n.nextIteration(),[pc(s)]}case"TensorArrayV3":{const s=V("size",t,e,n),r=V("dtype",t,e,n),a=V("elementShape",t,e,n),i=V("dynamicSize",t,e,n),l=V("clearAfterRead",t,e,n),c=V("identicalElementShapes",t,e,n),u=V("name",t,e,n),h=new d5e(u,r,s,a,c,i,l);return n.addTensorArray(h),[h.idTensor,Bt(1)]}case"TensorArrayWriteV3":{const s=V("tensorArrayId",t,e,n),r=V("index",t,e,n),a=V("tensor",t,e,n),i=n.getTensorArray(s.id);return i.write(r,a),[i.idTensor]}case"TensorArrayReadV3":{const s=V("tensorArrayId",t,e,n),r=V("index",t,e,n);return[n.getTensorArray(s.id).read(r)]}case"TensorArrayGatherV3":{const s=V("tensorArrayId",t,e,n),r=V("indices",t,e,n),a=V("dtype",t,e,n);return[n.getTensorArray(s.id).gather(r,a)]}case"TensorArrayScatterV3":{const s=V("tensorArrayId",t,e,n),r=V("indices",t,e,n),a=V("tensor",t,e,n),i=n.getTensorArray(s.id);return i.scatter(r,a),[i.idTensor]}case"TensorArrayConcatV3":{const s=V("tensorArrayId",t,e,n),r=n.getTensorArray(s.id),a=V("dtype",t,e,n);return[r.concat(a)]}case"TensorArraySplitV3":{const s=V("tensorArrayId",t,e,n),r=V("tensor",t,e,n),a=V("lengths",t,e,n),i=n.getTensorArray(s.id);return i.split(a,r),[i.idTensor]}case"TensorArraySizeV3":{const s=V("tensorArrayId",t,e,n),r=n.getTensorArray(s.id);return[Bt(r.size(),"int32")]}case"TensorArrayCloseV3":{const s=V("tensorArrayId",t,e,n),r=n.getTensorArray(s.id);return r.clearAndClose(),[r.idTensor]}case"TensorListSetItem":{const s=V("tensorListId",t,e,n),r=V("index",t,e,n),a=V("tensor",t,e,n),i=n.getTensorList(s.id);return i.setItem(r,a),[i.idTensor]}case"TensorListGetItem":{const s=V("tensorListId",t,e,n),r=V("index",t,e,n),a=V("elementShape",t,e,n),i=V("elementDType",t,e,n);return[n.getTensorList(s.id).getItem(r,a,i)]}case"TensorListScatterV2":case"TensorListScatter":{const s=V("indices",t,e,n),r=V("tensor",t,e,n),a=V("elementShape",t,e,n),i=V("numElements",t,e,n),l=f5e(r,s,a,i);return n.addTensorList(l),[l.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const s=V("elementShape",t,e,n),r=V("elementDType",t,e,n);let a;t.op==="TensorListReserve"?a="numElements":a="maxNumElements";const i=V(a,t,e,n),l=t.op==="TensorListReserve"?-1:i,c=m5e(s,r,i,l);return n.addTensorList(c),[c.idTensor]}case"TensorListGather":{const s=V("tensorListId",t,e,n),r=V("indices",t,e,n),a=V("elementShape",t,e,n),i=V("elementDType",t,e,n);return[n.getTensorList(s.id).gather(r,i,a)]}case"TensorListStack":{const s=V("tensorListId",t,e,n),r=V("elementShape",t,e,n),a=V("elementDType",t,e,n),i=V("numElements",t,e,n);return[n.getTensorList(s.id).stack(r,a,i)]}case"TensorListFromTensor":{const s=V("tensor",t,e,n),r=V("elementShape",t,e,n),a=V("elementDType",t,e,n),i=h5e(s,r,a);return n.addTensorList(i),[i.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const s=V("tensorListId",t,e,n),r=n.getTensorList(s.id),a=V("dtype",t,e,n),i=V("elementShape",t,e,n);return[r.concat(a,i)]}case"TensorListPushBack":{const s=V("tensorListId",t,e,n),r=V("tensor",t,e,n),a=n.getTensorList(s.id);return a.pushBack(r),[a.idTensor]}case"TensorListPopBack":{const s=V("tensorListId",t,e,n),r=V("elementShape",t,e,n),a=V("elementDType",t,e,n);return[n.getTensorList(s.id).popBack(r,a)]}case"TensorListSplit":{const s=V("tensor",t,e,n),r=V("elementShape",t,e,n),a=V("lengths",t,e,n),i=p5e(s,a,r);return n.addTensorList(i),[i.idTensor]}case"TensorListLength":{const s=V("tensorListId",t,e,n),r=n.getTensorList(s.id);return[Bt(r.size(),"int32")]}case"TensorListResize":{const s=V("tensorListId",t,e,n),r=V("size",t,e,n),i=n.getTensorList(s.id).resize(r);return n.addTensorList(i),[i.idTensor]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dB(t,e,n){const[s,r]=V("fusedOps",t,e,n),a=s==="biasadd",i=!a,l=r==="prelu",c=s==="fusedbatchnorm",u=V("numArgs",t,e,n);if(a){if(l&&u!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!l&&a&&u!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(c)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const h=V("strides",t,e,n),f=G1(t,e,n),p=V("dataFormat",t,e,n).toUpperCase(),x=V("dilations",t,e,n);let[y,v]=V("args",t,e,n);i&&(v=y,y=void 0);const b=V("leakyreluAlpha",t,e,n);return{stride:h,pad:f,dataFormat:p,dilations:x,biasArg:y,preluArg:v,activationFunc:r,leakyreluAlpha:b}}const x5e=(t,e,n,s=ea)=>{switch(t.op){case"Conv1D":{const r=V("stride",t,e,n),a=V("pad",t,e,n),i=V("dataFormat",t,e,n).toUpperCase(),l=V("dilation",t,e,n);return[s.conv1d(V("x",t,e,n),V("filter",t,e,n),r,a,i,l)]}case"Conv2D":{const r=V("strides",t,e,n),a=G1(t,e,n),i=V("dataFormat",t,e,n).toUpperCase(),l=V("dilations",t,e,n);return[s.conv2d(V("x",t,e,n),V("filter",t,e,n),[r[1],r[2]],a,i,[l[1],l[2]])]}case"_FusedConv2D":{const{stride:r,pad:a,dataFormat:i,dilations:l,biasArg:c,preluArg:u,activationFunc:h,leakyreluAlpha:f}=dB(t,e,n);return[s.fused.conv2d({x:V("x",t,e,n),filter:V("filter",t,e,n),strides:[r[1],r[2]],pad:a,dataFormat:i,dilations:[l[1],l[2]],bias:c,activation:h,preluActivationWeights:u,leakyreluAlpha:f})]}case"FusedDepthwiseConv2dNative":{const{stride:r,pad:a,dataFormat:i,dilations:l,biasArg:c,preluArg:u,activationFunc:h,leakyreluAlpha:f}=dB(t,e,n);return[s.fused.depthwiseConv2d({x:V("x",t,e,n),filter:V("filter",t,e,n),strides:[r[1],r[2]],pad:a,dataFormat:i,dilations:[l[1],l[2]],bias:c,activation:h,preluActivationWeights:u,leakyreluAlpha:f})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const r=V("outputShape",t,e,n),a=V("strides",t,e,n),i=G1(t,e,n);return[s.conv2dTranspose(V("x",t,e,n),V("filter",t,e,n),r,[a[1],a[2]],i)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const r=V("strides",t,e,n),a=G1(t,e,n),i=V("dilations",t,e,n),l=V("dataFormat",t,e,n).toUpperCase();return[s.depthwiseConv2d(V("input",t,e,n),V("filter",t,e,n),[r[1],r[2]],a,l,[i[1],i[2]])]}case"Conv3D":{const r=V("strides",t,e,n),a=V("pad",t,e,n),i=V("dataFormat",t,e,n).toUpperCase(),l=V("dilations",t,e,n);return[s.conv3d(V("x",t,e,n),V("filter",t,e,n),[r[1],r[2],r[3]],a,i,[l[1],l[2],l[3]])]}case"AvgPool":{const r=V("strides",t,e,n),a=V("pad",t,e,n),i=V("kernelSize",t,e,n);return[s.avgPool(V("x",t,e,n),[i[1],i[2]],[r[1],r[2]],a)]}case"MaxPool":{const r=V("strides",t,e,n),a=V("pad",t,e,n),i=V("kernelSize",t,e,n);return[s.maxPool(V("x",t,e,n),[i[1],i[2]],[r[1],r[2]],a)]}case"MaxPoolWithArgmax":{const r=V("strides",t,e,n),a=V("pad",t,e,n),i=V("kernelSize",t,e,n),l=V("includeBatchInIndex",t,e,n),{result:c,indexes:u}=s.maxPoolWithArgmax(V("x",t,e,n),[i[1],i[2]],[r[1],r[2]],a,l);return[c,u]}case"AvgPool3D":{const r=V("strides",t,e,n),a=V("pad",t,e,n),i=V("kernelSize",t,e,n);return[s.avgPool3d(V("x",t,e,n),[i[1],i[2],i[3]],[r[1],r[2],r[3]],a)]}case"MaxPool3D":{const r=V("strides",t,e,n),a=V("pad",t,e,n),i=V("kernelSize",t,e,n);return[s.maxPool3d(V("x",t,e,n),[i[1],i[2],i[3]],[r[1],r[2],r[3]],a)]}case"Dilation2D":{const r=V("strides",t,e,n),a=V("pad",t,e,n),i=V("dilations",t,e,n),l=r[1],c=r[2],u=i[1],h=i[2];return[s.dilation2d(V("x",t,e,n),V("filter",t,e,n),[l,c],a,[u,h],"NHWC")]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y5e=(t,e,n,s=ea)=>{switch(t.op){case"Fill":{const r=V("shape",t,e,n),a=V("dtype",t,e,n),i=V("value",t,e,n);return[s.fill(r,i,a)]}case"LinSpace":{const r=V("start",t,e,n),a=V("stop",t,e,n),i=V("num",t,e,n);return[s.linspace(r,a,i)]}case"Multinomial":{const r=V("logits",t,e,n),a=V("numSamples",t,e,n),i=V("seed",t,e,n);return[s.multinomial(r,a,i)]}case"OneHot":{const r=V("indices",t,e,n),a=V("depth",t,e,n),i=V("onValue",t,e,n),l=V("offValue",t,e,n),c=V("dtype",t,e,n);return[s.oneHot(r,a,i,l,c)]}case"Ones":return[s.ones(V("shape",t,e,n),V("dtype",t,e,n))];case"OnesLike":return[s.onesLike(V("x",t,e,n))];case"RandomStandardNormal":return[s.randomStandardNormal(V("shape",t,e,n),V("dtype",t,e,n),V("seed",t,e,n))];case"RandomUniform":return[s.randomUniform(V("shape",t,e,n),V("minval",t,e,n),V("maxval",t,e,n),V("dtype",t,e,n))];case"RandomUniformInt":return[s.randomUniformInt(V("shape",t,e,n),V("minval",t,e,n),V("maxval",t,e,n),V("seed",t,e,n))];case"Range":{const r=V("start",t,e,n),a=V("stop",t,e,n),i=V("step",t,e,n);return[s.range(r,a,i,V("dtype",t,e,n))]}case"TruncatedNormal":{const r=V("shape",t,e,n),a=V("mean",t,e,n),i=V("stdDev",t,e,n),l=V("seed",t,e,n);return[s.truncatedNormal(r,a,i,V("dtype",t,e,n),l)]}case"Zeros":return[s.zeros(V("shape",t,e,n),V("dtype",t,e,n))];case"ZerosLike":return[s.zerosLike(V("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L3(t,e,n){const s=V("boxes",t,e,n),r=V("scores",t,e,n),a=V("maxOutputSize",t,e,n),i=V("iouThreshold",t,e,n),l=V("scoreThreshold",t,e,n),c=V("softNmsSigma",t,e,n);return{boxes:s,scores:r,maxOutputSize:a,iouThreshold:i,scoreThreshold:l,softNmsSigma:c}}const b5e=async(t,e,n,s,r=ea)=>{switch(t.op){case"NonMaxSuppressionV5":{const{boxes:a,scores:i,maxOutputSize:l,iouThreshold:c,scoreThreshold:u,softNmsSigma:h}=L3(t,e,n),f=await r.image.nonMaxSuppressionWithScoreAsync(a,i,l,c,u,h);return[f.selectedIndices,f.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:a,scores:i,maxOutputSize:l,iouThreshold:c,scoreThreshold:u}=L3(t,e,n),h=V("padToMaxOutputSize",t,e,n),f=await r.image.nonMaxSuppressionPaddedAsync(a,i,l,c,u,h);return[f.selectedIndices,f.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:a,scores:i,maxOutputSize:l,iouThreshold:c,scoreThreshold:u}=L3(t,e,n);return[await r.image.nonMaxSuppressionAsync(a,i,l,c,u)]}case"Where":{const a=r.cast(V("condition",t,e,n),"bool"),i=[await r.whereAsync(a)];return a.dispose(),i}case"ListDiff":return r.setdiff1dAsync(V("x",t,e,n),V("y",t,e,n));default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v5e=(t,e,n,s=ea)=>{switch(t.op){case"LowerBound":{const r=V("sortedSequence",t,e,n),a=V("values",t,e,n);return[s.lowerBound(r,a)]}case"TopKV2":{const r=V("x",t,e,n),a=V("k",t,e,n),i=V("sorted",t,e,n),l=s.topk(r,a,i);return[l.values,l.indices]}case"UpperBound":{const r=V("sortedSequence",t,e,n),a=V("values",t,e,n);return[s.upperBound(r,a)]}case"Unique":{const r=V("x",t,e,n),a=s.unique(r);return[a.values,a.indices]}case"UniqueV2":{const r=V("x",t,e,n),a=V("axis",t,e,n),i=s.unique(r,a);return[i.values,i.indices]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const w5e=(t,e,n,s=ea)=>{switch(t.op){case"Const":return e[t.name];case"PlaceholderWithDefault":const r=V("default",t,e,n);return[Ur(t.name,e,n)||r];case"Placeholder":return[Ur(t.name,e,n)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const h=V("x",t,e,n);return[pc(h)]}case"IdentityN":return V("x",t,e,n).map(h=>pc(h));case"Snapshot":const a=V("x",t,e,n);return[pc(a)];case"Shape":return[s.tensor1d(V("x",t,e,n).shape,"int32")];case"ShapeN":return V("x",t,e,n).map(h=>s.tensor1d(h.shape));case"Size":return[s.scalar(V("x",t,e,n).size,"int32")];case"Rank":return[s.scalar(V("x",t,e,n).rank,"int32")];case"NoOp":return[s.scalar(1)];case"Print":const i=V("x",t,e,n),l=V("data",t,e,n),c=V("message",t,e,n),u=V("summarize",t,e,n);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(c);for(let h=0;h<l.length;h++)console.log(Array.prototype.slice.call(l[h].dataSync()).slice(0,u));return[i];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class N5e{get id(){return this.handle.id}constructor(e,n){this.keyDType=e,this.valueDType=n,this.handle=Bt(0),this.tensorMap=new Map,hr(this.handle)}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return Bt(this.size(),"int32")}async import(e,n){this.checkKeyAndValueTensor(e,n);const s=await e.data();return this.tensorMap.forEach(r=>r.dispose()),this.tensorMap.clear(),Ee(()=>{const r=eo(n),a=s.length,i=r.length;Z(a===i,()=>`The number of elements doesn't match, keys has ${a} elements, the values has ${i} elements.`);for(let l=0;l<a;l++){const c=s[l],u=r[l];hr(u),this.tensorMap.set(c,u)}return this.handle})}async find(e,n){this.checkKeyAndValueTensor(e,n);const s=await e.data();return Ee(()=>{const r=[];for(let a=0;a<s.length;a++){const i=s[a],l=this.findWithDefault(i,n);r.push(l)}return ka(r)})}findWithDefault(e,n){const s=this.tensorMap.get(e);return s??n}checkKeyAndValueTensor(e,n){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(n.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${n.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S5e=async(t,e,n,s)=>{switch(t.op){case"HashTable":case"HashTableV2":{const r=s.getHashTableHandleByName(t.name);if(r!=null)return[r];{const a=V("keyDType",t,e,n),i=V("valueDType",t,e,n),l=new N5e(a,i);return s.addHashTable(t.name,l),[l.handle]}}case"InitializeTable":case"InitializeTableV2":case"LookupTableImport":case"LookupTableImportV2":{const r=V("tableHandle",t,e,n,s),a=V("keys",t,e,n),i=V("values",t,e,n);return[await s.getHashTableById(r.id).import(a,i)]}case"LookupTableFind":case"LookupTableFindV2":{const r=V("tableHandle",t,e,n,s),a=V("keys",t,e,n),i=V("defaultValue",t,e,n);return[await s.getHashTableById(r.id).find(a,i)]}case"LookupTableSize":case"LookupTableSizeV2":{const r=V("tableHandle",t,e,n,s);return[s.getHashTableById(r.id).tensorSize()]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j5e=(t,e,n,s=ea)=>{switch(t.op){case"ResizeBilinear":{const r=V("images",t,e,n),a=V("size",t,e,n),i=V("alignCorners",t,e,n),l=V("halfPixelCenters",t,e,n);return[s.image.resizeBilinear(r,[a[0],a[1]],i,l)]}case"ResizeNearestNeighbor":{const r=V("images",t,e,n),a=V("size",t,e,n),i=V("alignCorners",t,e,n),l=V("halfPixelCenters",t,e,n);return[s.image.resizeNearestNeighbor(r,[a[0],a[1]],i,l)]}case"CropAndResize":{const r=V("image",t,e,n),a=V("boxes",t,e,n),i=V("boxInd",t,e,n),l=V("cropSize",t,e,n),c=V("method",t,e,n),u=V("extrapolationValue",t,e,n);return[s.image.cropAndResize(r,a,i,l,c,u)]}case"ImageProjectiveTransformV3":{const r=V("images",t,e,n),a=V("transforms",t,e,n),i=V("outputShape",t,e,n),l=V("fillValue",t,e,n),c=V("interpolation",t,e,n),u=V("fillMode",t,e,n);return[s.image.transform(r,a,c.toLowerCase(),u.toLowerCase(),l,i)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k5e=(t,e,n,s=ea)=>{switch(t.op){case"Equal":return[s.equal(V("a",t,e,n),V("b",t,e,n))];case"NotEqual":return[s.notEqual(V("a",t,e,n),V("b",t,e,n))];case"Greater":return[s.greater(V("a",t,e,n),V("b",t,e,n))];case"GreaterEqual":return[s.greaterEqual(V("a",t,e,n),V("b",t,e,n))];case"Less":return[s.less(V("a",t,e,n),V("b",t,e,n))];case"LessEqual":return[s.lessEqual(V("a",t,e,n),V("b",t,e,n))];case"LogicalAnd":return[s.logicalAnd(V("a",t,e,n),V("b",t,e,n))];case"LogicalNot":return[s.logicalNot(V("a",t,e,n))];case"LogicalOr":return[s.logicalOr(V("a",t,e,n),V("b",t,e,n))];case"Select":case"SelectV2":return[s.where(V("condition",t,e,n),V("a",t,e,n),V("b",t,e,n))];case"BitwiseAnd":return[s.bitwiseAnd(V("a",t,e,n),V("b",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C5e=(t,e,n,s=ea)=>{switch(t.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[s.matMul(V("a",t,e,n),V("b",t,e,n),V("transposeA",t,e,n),V("transposeB",t,e,n))];case"Einsum":return[s.einsum(V("equation",t,e,n),...V("tensors",t,e,n))];case"Transpose":return[s.transpose(V("x",t,e,n),V("perm",t,e,n))];case"_FusedMatMul":const[r,a]=V("fusedOps",t,e,n),i=r==="biasadd",l=a==="prelu",c=V("numArgs",t,e,n),u=V("leakyreluAlpha",t,e,n);if(i){if(l&&c!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!l&&c!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[h,f]=V("args",t,e,n);return[s.fused.matMul({a:V("a",t,e,n),b:V("b",t,e,n),transposeA:V("transposeA",t,e,n),transposeB:V("transposeB",t,e,n),bias:h,activation:a,preluActivationWeights:f,leakyreluAlpha:u})];case"MatrixBandPart":return[s.linalg.bandPart(V("a",t,e,n),V("numLower",t,e,n),V("numUpper",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T5e=(t,e,n,s=ea)=>{switch(t.op){case"EuclideanNorm":return[s.euclideanNorm(V("x",t,e,n),V("axis",t,e,n),V("keepDims",t,e,n))];case"FusedBatchNorm":case"FusedBatchNormV2":return[s.batchNorm(V("x",t,e,n),V("mean",t,e,n),V("variance",t,e,n),V("offset",t,e,n),V("scale",t,e,n),V("epsilon",t,e,n))];case"FusedBatchNormV3":return[s.batchNorm(V("x",t,e,n),V("mean",t,e,n),V("variance",t,e,n),V("offset",t,e,n),V("scale",t,e,n),V("epsilon",t,e,n))];case"LRN":return[s.localResponseNormalization(V("x",t,e,n),V("radius",t,e,n),V("bias",t,e,n),V("alpha",t,e,n),V("beta",t,e,n))];case"Softmax":return[s.softmax(V("x",t,e,n))];case"LogSoftmax":return[s.logSoftmax(V("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _5e=(t,e,n,s=ea)=>{switch(t.op){case"RaggedGather":{const{outputNestedSplits:r,outputDenseValues:a}=s.raggedGather(V("paramsNestedSplits",t,e,n),V("paramsDenseValues",t,e,n),V("indices",t,e,n),V("outputRaggedRank",t,e,n));return r.concat(a)}case"RaggedRange":{const{rtNestedSplits:r,rtDenseValues:a}=s.raggedRange(V("starts",t,e,n),V("limits",t,e,n),V("splits",t,e,n));return[r,a]}case"RaggedTensorToTensor":return[s.raggedTensorToTensor(V("shape",t,e,n),V("values",t,e,n),V("defaultValue",t,e,n),V("rowPartitionTensors",t,e,n),V("rowPartitionTypes",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E5e=(t,e,n,s=ea)=>{switch(t.op){case"Max":{const l=V("axis",t,e,n),c=V("keepDims",t,e,n);return[s.max(V("x",t,e,n),l,c)]}case"Mean":{const l=V("axis",t,e,n),c=V("keepDims",t,e,n);return[s.mean(V("x",t,e,n),l,c)]}case"Min":{const l=V("axis",t,e,n),c=V("keepDims",t,e,n);return[s.min(V("x",t,e,n),l,c)]}case"Sum":{const l=V("axis",t,e,n),c=V("keepDims",t,e,n);return[s.sum(V("x",t,e,n),l,c)]}case"All":{const l=V("axis",t,e,n),c=V("keepDims",t,e,n);return[s.all(V("x",t,e,n),l,c)]}case"Any":{const l=V("axis",t,e,n),c=V("keepDims",t,e,n);return[s.any(V("x",t,e,n),l,c)]}case"ArgMax":{const l=V("axis",t,e,n);return[s.argMax(V("x",t,e,n),l)]}case"ArgMin":{const l=V("axis",t,e,n);return[s.argMin(V("x",t,e,n),l)]}case"Prod":{const l=V("axis",t,e,n),c=V("keepDims",t,e,n);return[s.prod(V("x",t,e,n),l,c)]}case"Cumprod":{const l=V("axis",t,e,n),c=V("exclusive",t,e,n),u=V("reverse",t,e,n);return[s.cumprod(V("x",t,e,n),l,c,u)]}case"Cumsum":{const l=V("axis",t,e,n),c=V("exclusive",t,e,n),u=V("reverse",t,e,n);return[s.cumsum(V("x",t,e,n),l,c,u)]}case"Bincount":const r=V("x",t,e,n),a=V("weights",t,e,n),i=V("size",t,e,n);return[s.bincount(r,a,i)];case"DenseBincount":{const l=V("x",t,e,n),c=V("weights",t,e,n),u=V("size",t,e,n),h=V("binaryOutput",t,e,n);return[s.denseBincount(l,c,u,h)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A5e=(t,e,n,s=ea)=>{switch(t.op){case"ConcatV2":case"Concat":{const r=V("n",t,e,n),a=V("axis",t,e,n);let i=V("tensors",t,e,n);return i=i.slice(0,r),[s.concat(i,a)]}case"Gather":{const r=V("x",t,e,n),a=V("indices",t,e,n);return[s.gather(r,s.cast(a,"int32"),0)]}case"GatherV2":{const r=V("axis",t,e,n),a=V("batchDims",t,e,n),i=V("x",t,e,n),l=V("indices",t,e,n);return[s.gather(i,s.cast(l,"int32"),r,a)]}case"Reverse":{const r=V("dims",t,e,n),a=[];for(let l=0;l<r.length;l++)r[l]&&a.push(l);const i=V("x",t,e,n);return[s.reverse(i,a)]}case"ReverseV2":{const r=V("axis",t,e,n),a=V("x",t,e,n);return[s.reverse(a,r)]}case"Slice":{const r=V("begin",t,e,n),a=V("size",t,e,n);return[s.slice(V("x",t,e,n),r,a)]}case"StridedSlice":{const r=V("begin",t,e,n),a=V("end",t,e,n),i=V("strides",t,e,n),l=V("beginMask",t,e,n),c=V("endMask",t,e,n),u=V("ellipsisMask",t,e,n),h=V("newAxisMask",t,e,n),f=V("shrinkAxisMask",t,e,n),p=V("x",t,e,n);return[s.stridedSlice(p,r,a,i,l,c,u,h,f)]}case"Pack":return Ee(()=>{const r=V("axis",t,e,n),a=V("tensors",t,e,n),i=a[0].shape,l=s.squeeze(a[0]).shape,c=a.map(u=>{const h=xn(u.shape,i);if(!h&&!xn(s.squeeze(u).shape,l))throw new Error("the input tensors shape does not match");return h?u:s.reshape(u,i)});return[s.stack(c,r)]});case"Unpack":{const r=V("axis",t,e,n),a=V("tensor",t,e,n);return s.unstack(a,r)}case"Tile":{const r=V("reps",t,e,n);return[s.tile(V("x",t,e,n),r)]}case"Split":case"SplitV":{const r=V("axis",t,e,n),a=V("numOrSizeSplits",t,e,n),i=V("x",t,e,n);return s.split(i,a,r)}case"ScatterNd":{const r=V("indices",t,e,n),a=V("values",t,e,n),i=V("shape",t,e,n);return[s.scatterND(r,a,i)]}case"GatherNd":{const r=V("x",t,e,n),a=V("indices",t,e,n);return[s.gatherND(r,a)]}case"SparseToDense":{const r=V("sparseIndices",t,e,n),a=V("outputShape",t,e,n),i=V("sparseValues",t,e,n),l=V("defaultValue",t,e,n);return[s.sparseToDense(r,i,a,i.dtype===l.dtype?l:s.cast(l,i.dtype))]}case"TensorScatterUpdate":{const r=V("indices",t,e,n),a=V("values",t,e,n),i=V("tensor",t,e,n);return[s.tensorScatterUpdate(i,r,a)]}default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $5e=(t,e,n,s=ea)=>{switch(t.op){case"SparseFillEmptyRows":{const{outputIndices:r,outputValues:a,emptyRowIndicator:i,reverseIndexMap:l}=s.sparse.sparseFillEmptyRows(V("indices",t,e,n),V("values",t,e,n),V("denseShape",t,e,n),V("defaultValue",t,e,n));return[r,a,i,l]}case"SparseReshape":{const{outputIndices:r,outputShape:a}=s.sparse.sparseReshape(V("inputIndices",t,e,n),V("inputShape",t,e,n),V("newShape",t,e,n));return[r,a]}case"SparseSegmentMean":return[s.sparse.sparseSegmentMean(V("data",t,e,n),V("indices",t,e,n),V("segmentIds",t,e,n))];case"SparseSegmentSum":return[s.sparse.sparseSegmentSum(V("data",t,e,n),V("indices",t,e,n),V("segmentIds",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I5e=(t,e,n,s=ea)=>{switch(t.op){case"FFT":return[s.fft(V("x",t,e,n))];case"IFFT":return[s.ifft(V("x",t,e,n))];case"RFFT":return[s.rfft(V("x",t,e,n))];case"IRFFT":return[s.irfft(V("x",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const R5e=(t,e,n,s=ea)=>{switch(t.op){case"StaticRegexReplace":return[s.string.staticRegexReplace(V("input",t,e,n),V("pattern",t,e,n),V("rewrite",t,e,n),V("replaceGlobal",t,e,n))];case"StringNGrams":{const{nGrams:r,nGramsSplits:a}=s.string.stringNGrams(V("data",t,e,n),V("dataSplits",t,e,n),V("separator",t,e,n),V("nGramWidths",t,e,n),V("leftPad",t,e,n),V("rightPad",t,e,n),V("padWidth",t,e,n),V("preserveShortSequences",t,e,n));return[r,a]}case"StringSplit":{const{indices:r,values:a,shape:i}=s.string.stringSplit(V("input",t,e,n),V("delimiter",t,e,n),V("skipEmpty",t,e,n));return[r,a,i]}case"StringToHashBucketFast":return[s.string.stringToHashBucketFast(V("input",t,e,n),V("numBuckets",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O5e=(t,e,n,s=ea)=>{switch(t.op){case"Cast":return[s.cast(V("x",t,e,n),V("dtype",t,e,n))];case"ExpandDims":{const r=V("axis",t,e,n);return[s.expandDims(V("x",t,e,n),r)]}case"Squeeze":{const r=V("axis",t,e,n);return[s.squeeze(V("x",t,e,n),r)]}case"Reshape":return[s.reshape(V("x",t,e,n),V("shape",t,e,n))];case"EnsureShape":return[s.ensureShape(V("x",t,e,n),V("shape",t,e,n))];case"MirrorPad":return[s.mirrorPad(V("x",t,e,n),V("padding",t,e,n),V("mode",t,e,n))];case"PadV2":case"Pad":return[s.pad(V("x",t,e,n),V("padding",t,e,n),V("constantValue",t,e,n))];case"SpaceToBatchND":{const r=V("blockShape",t,e,n),a=V("paddings",t,e,n);return[s.spaceToBatchND(V("x",t,e,n),r,a)]}case"BatchToSpaceND":{const r=V("blockShape",t,e,n),a=V("crops",t,e,n);return[s.batchToSpaceND(V("x",t,e,n),r,a)]}case"DepthToSpace":{const r=V("blockSize",t,e,n),a=V("dataFormat",t,e,n).toUpperCase();return[s.depthToSpace(V("x",t,e,n),r,a)]}case"BroadcastTo":return[s.broadcastTo(V("x",t,e,n),V("shape",t,e,n))];case"BroadcastArgs":return[s.broadcastArgs(V("s0",t,e,n),V("s1",t,e,n))];default:throw TypeError(`Node type ${t.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hB(t,e,n,s,r=Ee){const a=((i,l,c)=>{switch(i.category){case"arithmetic":return r(()=>c5e(i,l,c));case"basic_math":return r(()=>u5e(i,l,c));case"control":return g5e(i,l,c);case"convolution":return r(()=>x5e(i,l,c));case"creation":return r(()=>y5e(i,l,c));case"dynamic":return b5e(i,l,c);case"evaluation":return r(()=>v5e(i,l,c));case"image":return r(()=>j5e(i,l,c));case"graph":return r(()=>w5e(i,l,c));case"logical":return r(()=>k5e(i,l,c));case"matrices":return r(()=>C5e(i,l,c));case"normalization":return r(()=>T5e(i,l,c));case"ragged":return r(()=>_5e(i,l,c));case"reduction":return r(()=>E5e(i,l,c));case"slice_join":return r(()=>A5e(i,l,c));case"sparse":return r(()=>$5e(i,l,c));case"spectral":return r(()=>I5e(i,l,c));case"string":return r(()=>R5e(i,l,c));case"transformation":return r(()=>O5e(i,l,c));case"hash_table":return S5e(i,l,c,s);case"custom":const u=LX(i.op);if(u&&u.customExecutor)return u.customExecutor(new l5e(i,l,c));throw TypeError(`Custom op ${i.op} is not registered.`);default:throw TypeError(`Unknown op '${i.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(t,e,n);return Rc(a)?a.then(i=>[].concat(i)):[].concat(a)}class mB{constructor(e={},n={},s={},r={},a){this.weightMap=e,this.tensorArrayMap=n,this.tensorListMap=s,this.functionMap=r,this.parseNodeNameCache=a,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,n){return{id:e,frameName:n,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let n=0;n<this.contexts.length-1;n++){const s=this.contexts.slice(0,this.contexts.length-n);e.push(this.contextIdforContexts(s))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(n=>n.id===0&&n.iterationId===0?"":`${n.frameName}-${n.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const n in this.tensorArrayMap)this.tensorArrayMap[n].clearAndClose(e);for(const n in this.tensorListMap)this.tensorListMap[n].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fB(t,e,n,s){const r=new Set,a=[];let i=null,l=null;const c=new Set,u=new Set(Object.keys(t).map(p=>li(p)[0]));s=s||[];const h=new Set(s.map(p=>li(p.name)[0])),f=[...e];for(;f.length>0;){const p=f.pop();if((Gd(p)||U5e(p)||V5e(p))&&i==null&&(i=p,l=i.children.map(x=>x.name).filter(x=>r.has(x))),r.add(p.name),n[p.name]==null&&!u.has(p.name)&&!h.has(p.name)){if(p.inputs.length===0){a.push(p.name);continue}p.inputs.forEach(x=>{c.has(x.name)||(c.add(x.name),f.push(x))})}}return{inputs:t,outputs:e,usedNodes:r,missingInputs:a,dynamicNode:i,syncInputs:l}}function D5e(t,e){const{usedNodes:n,inputs:s}=e,r=Object.keys(s).map(b=>li(b)[0]).map(b=>t.nodes[b]),a=t.initNodes||[],i=b=>n.has(typeof b=="string"?b:b.name);function l(b){return[...new Map(b.map(N=>[N.name,N])).values()]}const c=l([...r,...t.weights,...a]).filter(i),u=l([...c,...Object.values(t.nodes)]).filter(i),h=new Map(u.map(b=>[b.name,b])),f={};for(const b of u){f[b.name]=f[b.name]||0;for(const N of b.children)i(N)||(f[N.name]=Number.POSITIVE_INFINITY),f[N.name]=(f[N.name]||0)+1}const p=Object.entries(f).filter(([,b])=>b===0).map(([b])=>b),x=[...p];for(;p.length>0;){const b=p.pop(),N=h.get(b);for(const S of N.children.filter(i))--f[S.name]===0&&(x.push(S.name),p.push(S.name))}const y=x.map(b=>h.get(b)),v=P5e(y,c);return L5e(v,c),v}function P5e(t,e){const n=new Map(t.map(i=>[i.name,i])),s=e.map(i=>i.name),r=new Set(s);for(;s.length>0;){const i=s.pop(),l=n.get(i);for(const c of l.children)!n.has(c.name)||r.has(c.name)||(r.add(c.name),s.push(c.name))}return t.filter(i=>r.has(i.name))}class f1 extends Error{constructor(e){super(`NodesExecutionOrderError: ${e}`)}}function L5e(t,e){const n=new Map(t.map((l,c)=>[l.name,c])),s=new Set(e.map(l=>l.name)),r=l=>s.has(typeof l=="string"?l:l.name),a=new Set(t.map(l=>l.name)),i=l=>a.has(typeof l=="string"?l:l.name);for(const l of t){for(const c of l.children.filter(i)){if(!n.has(c.name))throw new f1(`Child ${c.name} of node ${l.name} is unreachable.`);if(n.get(l.name)>n.get(c.name))throw new f1(`Node ${l.name} is scheduled to run after its child ${c.name}.`)}if(!r(l))for(const c of l.inputs){if(!n.has(c.name))throw new f1(`Input ${c.name} of node ${l.name} is unreachable.`);if(n.get(c.name)>n.get(l.name))throw new f1(`Node ${l.name} is scheduled to run before its input ${c.name}.`)}}}function M5e(t){const e=new Map(t.map((l,c)=>[l.name,c])),n=Number.MAX_SAFE_INTEGER,s=t.map((l,c)=>Gd(l)?n:c),r=l=>{const c=s[e.get(l.name)];return c??-1},a=t.map((l,c)=>l.children.map(r).reduce((u,h)=>Math.max(u,h),s[c])),i=new Map;for(let l=0;l<t.length;++l){const c=a[l];if(c===n)continue;const u=t[l],h=t[c];i.has(h.name)||i.set(h.name,[]),i.get(h.name).push(u)}return i}const F5e=new Set(["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"]),z5e=new Set(["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"]),B5e=new Set(["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"]);function Gd(t){return F5e.has(t.op)}function U5e(t){return z5e.has(t.op)}function V5e(t){return B5e.has(t.op)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class u2{get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const n=Object.keys(e).map(s=>e[s].map(r=>r.id));this._weightIds=[].concat(...n),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const n=e.signatureKey||e.name;return e.defaultOutput?`${n}:${e.defaultOutput}`:n})}get functions(){return Object.keys(this._functions).reduce((e,n)=>(e[n]=this._functions[n].signature,e),{})}constructor(e,n){this.graph=e,this.parent=n,this.compiledMap=new Map,this.parseNodeNameCache=new Map,this._weightMap={},this.SEPARATOR=",",this._functions={},this._functionExecutorMap={},this.keepIntermediateTensors=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(s=>{this._functionExecutorMap[s]=new u2(e.functions[s],this)})}getCompilationKey(e,n){const s=e.map(a=>a.name).sort(),r=n.map(a=>a.name).sort();return s.join(this.SEPARATOR)+"--"+r.join(this.SEPARATOR)}compile(e,n){const s=fB(e,n,this.weightMap,this._initNodes),{missingInputs:r,dynamicNode:a,syncInputs:i}=s;if(a!=null)throw new Error(`This execution contains the node '${a.name}', which has the dynamic op '${a.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${i}]`);if(r.length>0){const u=n.map(f=>f.name),h=Object.keys(e);throw new Error(`Cannot compute the outputs [${u}] from the provided inputs [${h}]. Missing the following inputs: [${r}]`)}const l=D5e(this.graph,s),c=M5e(l);return{orderedNodes:l,nodeLiveUntilMap:c}}cloneAndKeepTensor(e){if(e==null)return null;const n=e.clone();return hr(n),n}cloneTensorList(e){return e?e.map(s=>this.cloneAndKeepTensor(s)):null}cloneTensorMap(e){return Object.fromEntries(Object.entries(e).map(([n,s])=>[n,this.cloneTensorList(s)]))}execute(e,n){this.disposeIntermediateTensors(),e=this.mapInputs(e);const s=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n);const r=s.map(p=>this.graph.nodes[li(p)[0]]),a=n.map(p=>li(p)[0]),i=new Set(a);let l=a.map(p=>this.graph.nodes[p]);l.length===0&&(l=this._outputs);const c=this.getCompilationKey(r,l);let u=this.compiledMap.get(c);u==null&&(u=this.compile(e,l),this.compiledMap.set(c,u));try{this.keepIntermediateTensors=$e().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(p){this.keepIntermediateTensors=!1,console.warn(p.message)}const h={},f={};return Ee(()=>{const p=new mB(this.weightMap,h,f,this.functionExecutorMap,this.parseNodeNameCache),x=Object.assign({},this.weightMap);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap)),Object.keys(e).forEach(N=>{const[S,k]=li(N,p),T=[];T[k]=e[N],x[S]=T,this.keepIntermediateTensors&&(this.clonedTensorsMap[S]=this.cloneTensorList(T))});const y=this.getFrozenTensorIds(x),{orderedNodes:v,nodeLiveUntilMap:b}=u;for(const N of v){if(x[N.name])continue;const S=hB(N,x,p,this._resourceManager);if(Rc(S))throw new Error(`The execution of the op '${N.op}' returned a promise. Please use model.executeAsync() instead.`);x[N.name]=S,this.keepIntermediateTensors&&(this.clonedTensorsMap[N.name]=this.cloneTensorList(S)),this.checkTensorForDisposalWithNodeLiveUntilInfo(N,x,p,y,i,b.get(N.name))}return this.parent==null&&p.dispose(y),n.map(N=>Ur(N,x,p))})}getFrozenTensorIds(e){const n=[].concat.apply([],Object.keys(e).map(s=>e[s]).map(s=>s.map(r=>r.id)));return new Set(n)}checkTensorForDisposal(e,n,s,r,a,i,l){if(!(Gd(n)||i.has(e))){for(const c of s[e])c!=null&&(l[c.id]=(l[c.id]||0)+n.children.length);for(const c of n.inputs){if(Gd(c))continue;const u=oB(c.name,s,r);if(u!=null)for(const h of u){if(!h||h.kept||a.has(h.id))continue;const f=l[h.id];f===1?(h.dispose(),delete l[h.id]):f!=null&&l[h.id]--}}}}checkTensorForDisposalWithNodeLiveUntilInfo(e,n,s,r,a,i){function l(c){return Gd(c)||a.has(c.name)}if(!(Gd(e)||i==null))for(const c of i){if(l(c))continue;const u=oB(c.name,n,s);for(const h of u)!h||h.kept||r.has(h.id)||h.dispose()}}async executeAsync(e,n){return this._executeAsync(e,n)}disposeIntermediateTensors(){this.clonedTensorsMap&&(Object.values(this.clonedTensorsMap).forEach(e=>{for(const n of e)n&&!n.isDisposed&&n.dispose()}),this.clonedTensorsMap=null)}getIntermediateTensors(){return this.clonedTensorsMap}async _executeAsync(e,n,s=!1,r={},a={}){this.disposeIntermediateTensors(),s||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),n=this.mapOutputs(n),this.checkOutputs(n));try{this.keepIntermediateTensors=$e().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(p){this.keepIntermediateTensors=!1,console.warn(p.message)}const i=new mB(this.weightMap,r,a,this.functionExecutorMap,this.parseNodeNameCache);this.keepIntermediateTensors&&(this.clonedTensorsMap=this.cloneTensorMap(this.weightMap));const l=await this.executeWithControlFlow(e,i,n,s),c=n.map(p=>Ur(p,l,i)),u=c.map(p=>p.id),h=Object.keys(e).map(p=>e[p].id),f=new Set([...u,...h,...this.weightIds]);return Object.values(l).forEach(p=>{p.forEach(x=>{x&&!x.isDisposed&&!f.has(x.id)&&x.dispose()})}),this.parent==null&&i.dispose(f),c}async executeFunctionAsync(e,n,s){const r=e.reduce((a,i,l)=>(a[this.inputs[l].name]=i,a),{});return this._executeAsync(r,this.outputNodes,!0,n,s)}async executeWithControlFlow(e,n,s,r){const a=Object.keys(e),i=a.map(T=>this.graph.nodes[li(T)[0]]),l=s.map(T=>li(T)[0]),c=new Set(l);let u=l.map(T=>this.graph.nodes[T]);u.length===0&&(u=this._outputs);const{usedNodes:h,missingInputs:f,dynamicNode:p,syncInputs:x}=fB(e,u,this.weightMap,this._initNodes),y=[...i,...this.graph.weights,...this._initNodes||[]].map(T=>({node:T,contexts:n.currentContext})),v=Object.assign({},this.weightMap);Object.keys(e).forEach(T=>{const[E,D]=li(T),A=[];A[D]=e[T],v[E]=A});const b={},N=this.getFrozenTensorIds(v),S={};for(;y.length>0;){const T=this.processStack(i,y,n,v,S,N,c,b,h);await Promise.all(T)}p==null&&!r&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const k=u.filter(T=>!Gd(T)&&!Ur(T.name,v,n)).map(T=>T.name);if(k.length>0){let T="";throw p!=null&&(T=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${x}]`),new Error(`Cannot compute the outputs [${k}] from the provided inputs [${a}]. Consider providing the following inputs: [${f}]. ${T}`)}return v}processStack(e,n,s,r,a,i,l,c,u){const h=[];for(;n.length>0;){const f=n.pop();s.currentContext=f.contexts;let p="";if(f.node.op==="Enter"&&V("isConstant",f.node,r,s)&&([p]=fc(f.node.name,s)),r[f.node.name]==null){const x=hB(f.node,r,s,this._resourceManager);p||([p]=fc(f.node.name,s));const y=s.currentContext;Rc(x)?h.push(x.then(v=>(r[p]=v,this.keepIntermediateTensors&&(this.clonedTensorsMap[p]=this.cloneTensorList(v)),s.currentContext=y,this.checkTensorForDisposal(p,f.node,r,s,i,l,c),this.processChildNodes(f.node,n,s,r,a,u),v))):(r[p]=x,this.keepIntermediateTensors&&(this.clonedTensorsMap[p]=this.cloneTensorList(x)),this.checkTensorForDisposal(p,f.node,r,s,i,l,c),this.processChildNodes(f.node,n,s,r,a,u))}else this.processChildNodes(f.node,n,s,r,a,u)}return h}processChildNodes(e,n,s,r,a,i){e.children.forEach(l=>{const[c]=fc(l.name,s);a[c]||!i.has(l.name)||(l.op==="Merge"?l.inputNames.some(u=>!!Ur(u,r,s))&&(a[c]=!0,n.push({contexts:s.currentContext,node:l})):l.inputNames.every(u=>!!Ur(u,r,s))&&(a[c]=!0,n.push({contexts:s.currentContext,node:l})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(n=>n.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(n=>{const s=e[n],[r]=li(n),a=this.graph.nodes[r];if(a.attrParams.shape&&a.attrParams.shape.value){const i=a.attrParams.shape.value,l=i.length===s.shape.length&&s.shape.every((c,u)=>i[u]===-1||i[u]===c);Z(l,()=>`The shape of dict['${a.name}'] provided in model.execute(dict) must be [${i}], but was [${s.shape}]`)}a.attrParams.dtype&&a.attrParams.dtype.value&&Z(s.dtype===a.attrParams.dtype.value,()=>`The dtype of dict['${a.name}'] provided in model.execute(dict) must be ${a.attrParams.dtype.value}, but was ${s.dtype}`)})}mapInputs(e){var n,s;const r={};for(const a in e){const i=(s=(n=this._signature)===null||n===void 0?void 0:n.inputs)===null||s===void 0?void 0:s[a];i!=null?r[i.name]=e[a]:r[a]=e[a]}return r}checkInputs(e){const n=Object.keys(e).filter(s=>{const[r]=li(s);return this.graph.nodes[r]==null});if(n.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${n}] that are not part of graph`)}mapOutputs(e){return e.map(n=>{var s,r;const a=(r=(s=this._signature)===null||s===void 0?void 0:s.outputs)===null||r===void 0?void 0:r[n];return a!=null?a.name:n},{})}checkOutputs(e){e.forEach(n=>{const[s]=li(n);if(!this.graph.nodes[s])throw new Error(`The output '${n}' is not found in the graph`)})}}class W5e{constructor(e={},n={}){this.hashTableNameToHandle=e,this.hashTableMap=n}addHashTable(e,n){this.hashTableNameToHandle[e]=n.handle,this.hashTableMap[n.id]=n}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H5e="?tfjs-format=file",G5e="model.json";class wR{get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}constructor(e,n={},s=yI){this.modelUrl=e,this.loadOptions=n,this.version="n/a",this.io=s,n==null&&(this.loadOptions={}),this.resourceManager=new W5e}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const n=this.io.getLoadHandlers(e,this.loadOptions);if(n.length===0)n.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(n.length>1)throw new Error(`Found more than one (${n.length}) load handlers for URL '${[e]}'`);this.handler=n[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return Rc(e)?e.then(n=>n.getWeightStream==null?this.loadSync(n):this.loadStreaming(n)):this.loadSync(e)}loadSync(e){const n=this.io.decodeWeights(e.weightData,e.weightSpecs);return this.loadWithWeightMap(e,n)}async loadStreaming(e){if(e.getWeightStream==null)throw new Error("Model artifacts missing streamWeights function");const n=await mG(e.getWeightStream(),e.weightSpecs);return this.loadWithWeightMap(e,n)}loadWithWeightMap(e,n){this.artifacts=e;const s=this.artifacts.modelTopology;let r=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const a=this.artifacts.userDefinedMetadata;a.signature!=null&&(r=a.signature),a.structuredOutputKeys!=null&&(this.structuredOutputKeys=a.structuredOutputKeys)}if(this.signature=r,this.version=`${s.versions.producer}.${s.versions.minConsumer}`,this.executor=new u2(lB.Instance.transformGraph(s,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(n),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const a=lB.Instance.transformGraph(e.modelInitializer);this.initializer=new u2(a),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializerSignature=e.initializerSignature}return!0}async save(e,n){if(typeof e=="string"){const s=this.io.getSaveHandlers(e);if(s.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(s.length>1)throw new Error(`Found more than one (${s.length}) save handlers for URL '${e}'`);e=s[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}addStructuredOutputNames(e){if(this.structuredOutputKeys){const n=e instanceof Tn?[e]:e,s={};return n.forEach((r,a)=>s[this.structuredOutputKeys[a]]=r),s}return e}predict(e,n){const s=this.execute(e,this.outputNodes);return this.addStructuredOutputNames(s)}async predictAsync(e,n){const s=await this.executeAsync(e,this.outputNodes);return this.addStructuredOutputNames(s)}normalizeInputs(e){var n;if(!(e instanceof Tn)&&!Array.isArray(e)){const a=(n=this.signature)===null||n===void 0?void 0:n.inputs;if(a!=null)for(const i in a){const l=a[i];l.resourceId!=null&&(e[i]=this.resourceIdToCapturedInput[l.resourceId])}return e}e=Array.isArray(e)?e:[e];const s=Object.keys(this.resourceIdToCapturedInput).length;if(e.length+s!==this.inputNodes.length)throw new Error(`Input tensor count mismatch, the graph model has ${this.inputNodes.length-s} non-resource placeholders, while there are ${e.length} input tensors provided.`);let r=0;return this.inputNodes.reduce((a,i)=>{var l,c,u;const h=(u=(c=(l=this.signature)===null||l===void 0?void 0:l.inputs)===null||c===void 0?void 0:c[i])===null||u===void 0?void 0:u.resourceId;return h!=null?a[i]=this.resourceIdToCapturedInput[h]:a[i]=e[r++],a},{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}executeInitializerGraph(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.execute({},[]):this.initializer.execute({},Object.keys(this.initializerSignature.outputs))}async executeInitializerGraphAsync(){return this.initializer==null?[]:this.initializerSignature==null?this.initializer.executeAsync({},[]):this.initializer.executeAsync({},Object.keys(this.initializerSignature.outputs))}setResourceIdToCapturedInput(e){if(this.resourceIdToCapturedInput={},this.initializerSignature){const n=this.initializerSignature.outputs,s=Object.keys(n);for(let r=0;r<s.length;r++){const a=s[r],i=n[a];this.resourceIdToCapturedInput[i.resourceId]=e[r]}}}execute(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(this.executeInitializerGraph()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const s=this.executor.execute(e,n);return s.length>1?s:s[0]}async executeAsync(e,n){this.resourceIdToCapturedInput==null&&this.setResourceIdToCapturedInput(await this.executeInitializerGraphAsync()),e=this.normalizeInputs(e),n=this.normalizeOutputs(n);const s=await this.executor.executeAsync(e,n);return s.length>1?s:s[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((n,s)=>(n[s]=[e[s]],n),{})}dispose(){this.executor.dispose(),this.initializer&&(this.initializer.dispose(),this.resourceIdToCapturedInput&&Jt(this.resourceIdToCapturedInput)),this.resourceManager.dispose()}}async function zX(t,e={},n=yI){if(t==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof t=="string"&&(t=K5e(t));const s=new wR(t,e,n);return await s.load(),s}function q5e(t){if(t==null)throw new Error("modelUrl in loadGraphModelSync() cannot be null. Please provide model artifacts or an IOHandler that loads the model");let e;if(t instanceof Array){const[s,r]=t;if(!s)throw new Error("modelJSON must be the first element of the array");if(!r||!(r instanceof ArrayBuffer))throw new Error("An ArrayBuffer of weights must be the second element of the array");if(!("modelTopology"in s))throw new Error("Model JSON is missing 'modelTopology'");if(!("weightsManifest"in s))throw new Error("Model JSON is missing 'weightsManifest'");const a=Qw(s.weightsManifest),i=s$(s,a,r);e=Jw(i)}else if("load"in t)e=t;else if("modelTopology"in t&&"weightSpecs"in t&&"weightData"in t)e=Jw(t);else throw new Error("Unknown model format");const n=new wR(e);return n.load(),n}function K5e(t){return t.endsWith("/")||(t=t+"/"),`${t}${G5e}${H5e}`}/** @license See the LICENSE file. */const BX="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function X5e(t,e){return d2(t,e)}function d2(t,e,n=new Map,s=new Set){if(t==null)return null;if(typeof Blob=="function"&&t instanceof Blob)return t.slice();if(s.has(t))throw new Error("Circular references are not supported.");if(n.has(t))return n.get(t);const r=e(t);if(r.recurse&&r.value!==null)throw new Error("A deep map function may not return both a value and recurse=true.");if(r.recurse)if(Sf(t)){const a=Array.isArray(t)?[]:{};s.add(t);for(const i in t){const l=t[i],c=d2(l,e,n,s);a[i]=c}return s.delete(t),t.__proto__&&(a.__proto__=t.__proto__),a}else throw new Error(`Can't recurse into non-iterable type: ${t}`);else return n.set(t,r.value),r.value}function Y5e(t,e=VX){return UX(t,e)}function UX(t,e,n=new Set){const s=t[0];if(n.has(s))throw new Error("Circular references are not supported.");const r=e(t);if(r.recurse&&r.value!==null)throw new Error("A deep zip function may not return both a value and recurse=true.");if(r.recurse)if(Sf(s)){const a=Array.isArray(s)?[]:{};n.add(s);for(const i in s){const l=t.map(u=>u[i]),c=UX(l,e,n);a[i]=c}return n.delete(s),a}else throw new Error(`Can't recurse into non-iterable type: ${s}`);else return r.value}function VX(t){return t===null?null:Sf(t[0])?{value:null,recurse:!0}:{value:t,recurse:!1}}async function WX(t,e){const n=new Map;d2(t,e,n);for(const r of Array.from(n.keys())){const a=n.get(r);if(Rc(a)){const i=await a;n.set(r,i)}}return d2(t,e,n)}function Sf(t){let e=!1;if($e().get("IS_BROWSER"))e=t instanceof TextDecoder;else{const{StringDecoder:n}=require("string_decoder");e=t instanceof n}return t!=null&&!ArrayBuffer.isView(t)&&(Array.isArray(t)||typeof t=="object"&&!(t instanceof Tn)&&!(t instanceof Promise)&&!e)}function Q5e(t){return t==null||Z5e(t)||Array.isArray(t)||typeof t=="object"&&t instanceof Tn||dr(t)}function Z5e(t){return t===null||typeof t!="object"&&typeof t!="function"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function J5e(t){return X5e(t,eRe)}function eRe(t){return t instanceof Tn?{value:t.clone(),recurse:!1}:Sf(t)?{value:null,recurse:!0}:{value:t,recurse:!1}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class HX{constructor(e){if(this.capacity=e,this.begin=0,this.end=0,e==null)throw new RangeError("Can't create a ring buffer of unknown capacity.");if(e<1)throw new RangeError("Can't create ring buffer of capacity < 1.");this.data=new Array(e),this.doubledCapacity=2*e}wrap(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity}get(e){if(e<0)throw new RangeError("Can't get item at a negative index.");return this.data[e%this.capacity]}set(e,n){if(e<0)throw new RangeError("Can't set item at a negative index.");this.data[e%this.capacity]=n}length(){let e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e}isFull(){return this.length()===this.capacity}isEmpty(){return this.length()===0}push(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.set(this.end,e),this.end=this.wrap(this.end+1)}pushAll(e){for(const n of e)this.push(n)}pop(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");this.end=this.wrap(this.end-1);const e=this.get(this.end);return this.set(this.end,void 0),e}unshift(e){if(this.isFull())throw new RangeError("Ring buffer is full.");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)}shift(){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e}shuffleExcise(e){if(this.isEmpty())throw new RangeError("Ring buffer is empty.");const n=this.wrap(this.begin+e),s=this.get(n);return this.set(n,this.pop()),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class Aj extends HX{constructor(){super(Aj.INITIAL_CAPACITY)}isFull(){return!1}push(e){super.isFull()&&this.expand(),super.push(e)}unshift(e){super.isFull()&&this.expand(),super.unshift(e)}expand(){const e=this.capacity*2,n=new Array(e),s=this.length();for(let r=0;r<s;r++)n[r]=this.get(this.wrap(this.begin+r));this.data=n,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=s}}Aj.INITIAL_CAPACITY=32;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function GX(t){return new sRe(t)}function NR(t){return new rRe(t)}function tRe(t,e){return new qX(t,e)}function nRe(t,e=Mu.FAIL){return new mRe(t,e)}class $r{async toArray(){const e=[];let n=await this.next();for(;!n.done;)e.push(n.value),n=await this.next();return e}async toArrayForTest(){const e=this.prefetch(100),n=[];let s=await e.next();for(;!s.done;)n.push(s.value),s=await e.next();return n}async resolveFully(){let e=await this.next();for(;!e.done;)e=await this.next()}async resolveWhile(e){let n=await this.next(),s=e(n.value);for(;!n.done&&s;)n=await this.next(),s=e(n.value)}handleErrors(e){return new dRe(this,e)}filter(e){return new cRe(this,e)}map(e){return new uRe(this,e)}mapAsync(e){return new pB(this,e)}serialMapAsync(e){return new pB(this,e).serial()}flatmap(e){return new hRe(this,e)}async forEachAsync(e){return this.map(e).resolveFully()}async serialForEach(e){return this.serialMapAsync(e).resolveWhile(n=>n===!0)}rowMajorBatch(e,n=!0){return new lRe(this,e,n)}columnMajorBatch(e,n=!0,s=VX){return this.rowMajorBatch(e,n).map(a=>Y5e(a,s))}concatenate(e,n){return new qX(GX([this,e]),n)}take(e){return e<0||e==null?this:new oRe(this,e)}skip(e){return e<0||e==null?this:new iRe(this,e)}prefetch(e){return new KX(this,e)}shuffle(e,n){return new fRe(this,e,n)}serial(){return new aRe(this)}}class sRe extends $r{constructor(e){super(),this.items=e,this.trav=0}summary(){return`Array of ${this.items.length} items`}async next(){if(this.trav>=this.items.length)return{value:null,done:!0};const e=this.items[this.trav];return this.trav++,{value:J5e(e),done:!1}}}class rRe extends $r{constructor(e){super(),this.nextFn=e}summary(){return"Function call"}async next(){try{return this.nextFn()}catch(e){throw e.message=`Error thrown while iterating through a dataset: ${e.message}`,e}}}class aRe extends $r{constructor(e){super(),this.upstream=e,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Serial`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){return this.upstream.next()}}class iRe extends $r{constructor(e,n){super(),this.upstream=e,this.maxCount=n,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Skip`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.count++<this.maxCount;){const e=await this.upstream.next();if(e.done)return e;Jt(e.value)}return this.upstream.next()}}class oRe extends $r{constructor(e,n){super(),this.upstream=e,this.maxCount=n,this.count=0}summary(){return`${this.upstream.summary()} -> Take`}async next(){return this.count++>=this.maxCount?{value:null,done:!0}:this.upstream.next()}}class lRe extends $r{constructor(e,n,s=!0){super(),this.upstream=e,this.batchSize=n,this.enableSmallLastBatch=s,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> RowMajorBatch`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){const e=[];for(;e.length<this.batchSize;){const n=await this.upstream.next();if(n.done)return this.enableSmallLastBatch&&e.length>0?{value:e,done:!1}:{value:null,done:!0};e.push(n.value)}return{value:e,done:!1}}}class cRe extends $r{constructor(e,n){super(),this.upstream=e,this.predicate=n,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> Filter`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;){const e=await this.upstream.next();if(e.done||this.predicate(e.value))return e;Jt(e.value)}}}class uRe extends $r{constructor(e,n){super(),this.upstream=e,this.transform=n}summary(){return`${this.upstream.summary()} -> Map`}async next(){const e=await this.upstream.next();if(e.done)return{value:null,done:!0};const n=Dc(e.value),s=this.transform(e.value),r=Dc(s);for(const a of n)NS(a,r)||a.dispose();return{value:s,done:!1}}}class dRe extends $r{constructor(e,n){super(),this.upstream=e,this.handler=n,this.count=0,this.lastRead=Promise.resolve({value:null,done:!1})}summary(){return`${this.upstream.summary()} -> handleErrors`}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;;)try{return await this.upstream.next()}catch(e){if(!this.handler(e))return{value:null,done:!0}}}}class pB extends $r{constructor(e,n){super(),this.upstream=e,this.transform=n}summary(){return`${this.upstream.summary()} -> AsyncMap`}async next(){const e=await this.upstream.next();if(e.done)return{value:null,done:!0};const n=Dc(e.value),s=await this.transform(e.value),r=Dc(s);for(const a of n)NS(a,r)||a.dispose();return{value:s,done:!1}}}class SR extends $r{constructor(){super(),this.outputQueue=new Aj,this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}async serialNext(){for(;this.outputQueue.length()===0;)if(!await this.pump())return{value:null,done:!0};return{value:this.outputQueue.shift(),done:!1}}}class hRe extends SR{constructor(e,n){super(),this.upstream=e,this.transform=n}summary(){return`${this.upstream.summary()} -> Flatmap`}async pump(){const e=await this.upstream.next();if(e.done)return!1;const n=Dc(e.value),s=this.transform(e.value),r=Dc(s);this.outputQueue.pushAll(s);for(const a of n)NS(a,r)||a.dispose();return!0}}class qX extends $r{constructor(e,n){super(),this.baseErrorHandler=n,this.lastRead=null,this.iterator=null,this.moreIterators=e}summary(){return"TODO: fill in upstream of chained summaries -> Chained"}async next(){return this.lastRead=this.readFromChain(this.lastRead),this.lastRead}async readFromChain(e){if(await e,this.iterator==null){const s=await this.moreIterators.next();if(s.done)return{value:null,done:!0};this.iterator=s.value,this.baseErrorHandler!=null&&(this.iterator=this.iterator.handleErrors(this.baseErrorHandler))}const n=await this.iterator.next();return n.done?(this.iterator=null,this.readFromChain(e)):n}}var Mu;(function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"})(Mu||(Mu={}));class mRe extends $r{constructor(e,n=Mu.FAIL){super(),this.iterators=e,this.mismatchMode=n,this.count=0,this.currentPromise=null}summary(){return"{TODO: fill in upstream of zip summaries} -> Zip"}async nextState(e){await e;let n=0,s=0;function r(i){return i instanceof $r?{value:i.next().then(c=>(n++,c.done&&s++,c.value)),recurse:!1}:{value:null,recurse:!0}}const a=await WX(this.iterators,r);if(n===s)return{value:null,done:!0};if(s>0)switch(this.mismatchMode){case Mu.FAIL:throw new Error(`Zipped streams should have the same length. Mismatched at element ${this.count}.`);case Mu.SHORTEST:return{value:null,done:!0};case Mu.LONGEST:}return this.count++,{value:a,done:!1}}async next(){return this.currentPromise=this.nextState(this.currentPromise),this.currentPromise}}class KX extends $r{constructor(e,n){super(),this.upstream=e,this.bufferSize=n,this.buffer=new HX(n)}summary(){return`${this.upstream.summary()} -> Prefetch`}refill(){for(;!this.buffer.isFull();){const e=this.upstream.next();this.buffer.push(e)}}next(){return this.refill(),this.buffer.shift()}}class fRe extends KX{constructor(e,n,s){super(e,n),this.upstream=e,this.windowSize=n,this.upstreamExhausted=!1,this.random=Wp.alea(s||zr().toString()),this.lastRead=Promise.resolve({value:null,done:!1})}async next(){return this.lastRead=this.lastRead.then(()=>this.serialNext()),this.lastRead}randomInt(e){return Math.floor(this.random()*e)}chooseIndex(){return this.randomInt(this.buffer.length())}async serialNext(){for(this.upstreamExhausted||this.refill();!this.buffer.isEmpty();){const e=this.chooseIndex(),n=await this.buffer.shuffleExcise(e);if(n.done)this.upstreamExhausted=!0;else return this.refill(),n}return{value:null,done:!0}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class Qp{constructor(){this.size=null}batch(e,n=!0){const s=this;Z(e>0,()=>`batchSize needs to be positive, but it is
      ${e}`);let r;return this.size===1/0||this.size==null?r=this.size:n?r=Math.ceil(this.size/e):r=Math.floor(this.size/e),ii(async()=>(await s.iterator()).columnMajorBatch(e,n,xRe),r)}concatenate(e){const n=this;let s;return this.size===1/0||e.size===1/0?s=1/0:this.size!=null&&e.size!=null?s=this.size+e.size:s=null,ii(async()=>(await n.iterator()).concatenate(await e.iterator()),s)}filter(e){const n=this;let s;return this.size===1/0?s=1/0:s=null,ii(async()=>(await n.iterator()).filter(r=>Ee(()=>e(r))),s)}async forEachAsync(e){return(await this.iterator()).forEachAsync(e)}map(e){const n=this;return ii(async()=>(await n.iterator()).map(s=>Ee(()=>e(s))),this.size)}mapAsync(e){const n=this;return ii(async()=>(await n.iterator()).mapAsync(e),this.size)}prefetch(e){if(e==null)throw new RangeError("`Dataset.prefetch()` requires bufferSize to be specified.");const n=this;return ii(async()=>(await n.iterator()).prefetch(e),this.size)}repeat(e){const n=this;let s;return this.size!=null&&e>0?s=this.size*e:e===0?s=0:this.size!=null&&(e===void 0||e<0)?s=1/0:s=null,ii(async()=>{const r=NR(async()=>({value:await n.iterator(),done:!1}));return tRe(r.take(e))},s)}skip(e){const n=this;let s;return this.size!=null&&e>=0&&this.size>=e?s=this.size-e:this.size!=null&&(this.size<e||e===void 0||e<0)?s=0:s=null,ii(async()=>(await n.iterator()).skip(e),s)}shuffle(e,n,s=!0){if(e==null||e<0)throw this.size==null?new RangeError("`Dataset.shuffle()` requires bufferSize to be specified."):new RangeError(`\`Dataset.shuffle()\` requires bufferSize to be specified.  If your data fits in main memory (for regular JS objects), and/or GPU memory (for \`tf.Tensor\`s), consider setting bufferSize to the dataset size (${this.size} elements)`);const r=this,a=Wp.alea(n||zr().toString());return ii(async()=>{let i=a.int32();return s&&(i+=a.int32()),(await r.iterator()).shuffle(e,i.toString())},this.size)}take(e){const n=this;let s;return this.size!=null&&this.size>e?s=e:this.size!=null&&this.size<=e?s=this.size:s=null,ii(async()=>(await n.iterator()).take(e),s)}async toArray(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArray()}async toArrayForTest(){if(this.size===1/0)throw new Error("Can not convert infinite data stream to array.");return(await this.iterator()).toArrayForTest()}}Qp.MAX_BUFFER_SIZE=1e4;function ii(t,e=null){return new class extends Qp{constructor(){super(...arguments),this.size=e}async iterator(){return t()}}}function pRe(t){return ii(async()=>GX(t),t.length)}function gRe(t){if(!Sf(t))throw new Error("The argument to zip() must be an object or array.");let e;if(Array.isArray(t))for(let n=0;n<t.length;n++)e=e==null?t[n].size:Math.min(e,t[n].size);else if(t instanceof Object)for(const n in t)e=e==null?t[n].size:Math.min(e,t[n].size);return ii(async()=>{const n=await WX(t,s=>{if(s instanceof Qp)return{value:s.iterator(),recurse:!1};if(Sf(s))return{value:null,recurse:!0};throw new Error("Leaves of the structure passed to zip() must be Datasets, not primitives.")});return nRe(n,Mu.SHORTEST)},e)}function xRe(t){if(t===null)return null;const e=t[0];return Q5e(e)?{value:yRe(t),recurse:!1}:{value:null,recurse:!0}}function yRe(t){if(t.length===0)throw new Error("Can't make a batch of zero elements.");return t[0]instanceof Tn?ka(t):pi(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class XX extends Qp{constructor(e){super(),this.input=e}async iterator(){return(await this.input.iterator()).decodeUTF8().split(`
`).map(r=>(r.endsWith("\r")&&(r=r.slice(0,-1)),r))}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */const p1='"',fg=Symbol("out"),gB=Symbol("field"),g1=Symbol("quote"),M3=Symbol("quoteafterquote"),xB=Symbol("quoteinquote");class YX extends Qp{async columnNames(){return this.columnNamesValidated||await this.setColumnNames(),this.configuredColumnsOnly?Object.keys(this.columnConfigs):this.fullColumnNames}async setColumnNames(){const e=await this.maybeReadHeaderLine();if(!this.fullColumnNames&&!e)throw new Error("Column names must be provided if there is no header line.");this.fullColumnNames&&e&&Z(e.length===this.fullColumnNames.length,()=>"The length of provided columnNames ("+this.fullColumnNames.length.toString()+") does not match the length of the header line read from file ("+e.length.toString()+")."),this.fullColumnNames||(this.fullColumnNames=e);const n=this.fullColumnNames.reduce((r,a)=>(r[a]=r[a]+1||1,r),{}),s=Object.keys(n).filter(r=>n[r]>1);if(Z(s.length===0,()=>"Duplicate column names found: "+s.toString()),this.columnConfigs){for(const r of Object.keys(this.columnConfigs))if(this.fullColumnNames.indexOf(r)===-1)throw new Error('The key "'+r+'" provided in columnConfigs does not match any of the column names ('+this.fullColumnNames.toString()+").")}this.columnNamesValidated=!0}async maybeReadHeaderLine(){if(this.hasHeader){const n=await(await this.base.iterator()).next();if(n.done)throw new Error("No data was found for CSV parsing.");const s=n.value;return this.parseRow(s,!1)}else return null}constructor(e,n){super(),this.input=e,this.hasHeader=!0,this.fullColumnNames=null,this.columnNamesValidated=!1,this.columnConfigs=null,this.configuredColumnsOnly=!1,this.delimiter=",",this.delimWhitespace=!1,this.base=new XX(e),n||(n={}),this.hasHeader=n.hasHeader!==!1,this.fullColumnNames=n.columnNames,this.columnConfigs=n.columnConfigs,this.configuredColumnsOnly=n.configuredColumnsOnly,n.delimWhitespace?(Z(n.delimiter==null,()=>"Delimiter should not be provided when delimWhitespace is true."),this.delimWhitespace=!0,this.delimiter=" "):this.delimiter=n.delimiter?n.delimiter:","}async iterator(){this.columnNamesValidated||await this.setColumnNames();let e=await this.base.iterator();return this.hasHeader&&(e=e.skip(1)),e.map(n=>this.makeDataElement(n))}makeDataElement(e){const n=this.parseRow(e),s={},r={};for(let a=0;a<this.fullColumnNames.length;a++){const i=this.fullColumnNames[a],l=this.columnConfigs?this.columnConfigs[i]:null;if(!(this.configuredColumnsOnly&&!l)){const c=n[a];let u=null;if(c==="")if(l&&l.default!==void 0)u=l.default;else{if(l&&(l.required||l.isLabel))throw new Error(`Required column ${i} is empty in this line: ${e}`);u=void 0}else{const h=Number(c);if(isNaN(h))l&&l.dtype==="bool"?u=this.getBoolean(c):u=c;else if(!l||!l.dtype)u=h;else switch(l.dtype){case"float32":u=h;break;case"int32":u=Math.floor(h);break;case"bool":u=this.getBoolean(c);break;default:u=h}}l&&l.isLabel?r[i]=u:s[i]=u}}return Object.keys(r).length===0?s:{xs:s,ys:r}}getBoolean(e){return e==="1"||e.toLowerCase()==="true"?1:0}parseRow(e,n=!0){const s=[];let r=0;const a=e.length;let i=fg;for(let l=0;l<a;l++)switch(i){case fg:switch(e.charAt(l)){case p1:r=l+1,i=g1;break;case this.delimiter:if(r=l+1,this.delimiter===" "&&this.delimWhitespace)break;s.push(""),i=fg;break;default:i=gB,r=l;break}break;case gB:switch(e.charAt(l)){case this.delimiter:s.push(e.substring(r,l)),i=fg,r=l+1;break}break;case g1:switch(e.charAt(l)){case p1:i=M3;break}break;case M3:switch(e.charAt(l)){case this.delimiter:s.push(e.substring(r,l-1)),i=fg,r=l+1;break;case p1:i=g1;break;default:i=xB;break}break;case xB:switch(e.charAt(l)){case p1:i=g1;break}break}if(i===M3?s.push(e.substring(r,a-1)):s.push(e.substring(r)),n&&s.length!==this.fullColumnNames.length)throw new Error(`Invalid row in csv file. Should have ${this.fullColumnNames.length} elements in a row, but got ${s}`);return s}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class jR extends $r{constructor(e){super(),this.microphoneConfig=e,this.isClosed=!1,this.fftSize=e.fftSize||1024;const n=Math.log2(this.fftSize);if(this.fftSize<0||n<4||n>14||!Number.isInteger(n))throw new Error(`Invalid fftSize: it must be a power of 2 between 2 to 4 and 2 to 14, but got ${this.fftSize}`);if(this.numFrames=e.numFramesPerSpectrogram||43,this.sampleRateHz=e.sampleRateHz,this.columnTruncateLength=e.columnTruncateLength||this.fftSize,this.audioTrackConstraints=e.audioTrackConstraints,this.smoothingTimeConstant=e.smoothingTimeConstant||0,this.includeSpectrogram=e.includeSpectrogram!==!1,this.includeWaveform=e.includeWaveform===!0,!this.includeSpectrogram&&!this.includeWaveform)throw new Error("Both includeSpectrogram and includeWaveform are false. At least one type of data should be returned.")}summary(){return"microphone"}static async create(e={}){if(!$e().get("IS_BROWSER"))throw new Error("microphone API is only supported in browser environment.");const n=new jR(e);return await n.start(),n}async start(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:this.audioTrackConstraints==null?!0:this.audioTrackConstraints,video:!1})}catch(s){throw new Error(`Error thrown while initializing video stream: ${s.message}`)}if(!this.stream)throw new Error("Could not obtain audio from microphone.");const e=window.AudioContext||window.webkitAudioContext;if(this.audioContext=new e,!this.sampleRateHz)this.sampleRateHz=this.audioContext.sampleRate;else if(this.audioContext.sampleRate!==this.sampleRateHz)throw new Error(`Mismatch in sampling rate: Expected: ${this.sampleRateHz}; Actual: ${this.audioContext.sampleRate}`);const n=this.audioContext.createMediaStreamSource(this.stream);this.analyser=this.audioContext.createAnalyser(),this.analyser.fftSize=this.fftSize*2,this.analyser.smoothingTimeConstant=this.smoothingTimeConstant,n.connect(this.analyser),this.freqData=new Float32Array(this.fftSize),this.timeData=new Float32Array(this.fftSize)}async next(){if(this.isClosed)return{value:null,done:!0};let e,n;const s=await this.getAudioData();if(this.includeSpectrogram){const r=this.flattenQueue(s.freqDataQueue);e=this.getTensorFromAudioDataArray(r,[this.numFrames,this.columnTruncateLength,1])}if(this.includeWaveform){const r=this.flattenQueue(s.timeDataQueue);n=this.getTensorFromAudioDataArray(r,[this.numFrames*this.fftSize,1])}return{value:{spectrogram:e,waveform:n},done:!1}}async capture(){return(await this.next()).value}async getAudioData(){const e=[],n=[];let s=0;return new Promise(r=>{const a=setInterval(()=>{this.includeSpectrogram&&(this.analyser.getFloatFrequencyData(this.freqData),this.freqData[0]===-1/0&&r({freqDataQueue:e,timeDataQueue:n}),e.push(this.freqData.slice(0,this.columnTruncateLength))),this.includeWaveform&&(this.analyser.getFloatTimeDomainData(this.timeData),n.push(this.timeData.slice())),++s===this.numFrames&&(clearInterval(a),r({freqDataQueue:e,timeDataQueue:n}))},this.fftSize/this.sampleRateHz*1e3)})}stop(){this.isClosed||(this.isClosed=!0,this.analyser.disconnect(),this.audioContext.close(),this.stream!=null&&this.stream.getTracks().length>0&&this.stream.getTracks()[0].stop())}toArray(){throw new Error("Can not convert infinite audio stream to array.")}getSampleRate(){return this.sampleRateHz}flattenQueue(e){const n=e[0].length,s=new Float32Array(e.length*n);return e.forEach((r,a)=>s.set(r,a*n)),s}getTensorFromAudioDataArray(e,n){const s=new Float32Array(ze(n));return s.set(e,s.length-e.length),pi(s,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class kR extends $r{constructor(e,n){if(super(),this.webcamVideoElement=e,this.webcamConfig=n,this.isClosed=!0,this.resize=!1,this.needToResize())if(this.resize=!0,this.cropSize=[this.webcamConfig.resizeHeight,this.webcamConfig.resizeWidth],this.cropBoxInd=Wr([0],"int32"),this.webcamConfig.centerCrop){const s=this.webcamConfig.resizeWidth*1/this.webcamVideoElement.width,r=this.webcamConfig.resizeHeight*1/this.webcamVideoElement.height,a=(1-s)/2,i=(1-r)/2,l=a+s,c=r+i;this.cropBox=Uu([i,a,c,l],[1,4])}else this.cropBox=Uu([0,0,1,1],[1,4])}summary(){return"webcam"}static async create(e,n={}){if(!$e().get("IS_BROWSER"))throw new Error("tf.data.webcam is only supported in browser environment.");if(!e){if(e=document.createElement("video"),!n.resizeWidth||!n.resizeHeight)throw new Error("Please provide webcam video element, or resizeWidth and resizeHeight to create a hidden video element.");e.width=n.resizeWidth,e.height=n.resizeHeight}const s=new kR(e,n);return await s.start(),s}async start(){this.webcamConfig.facingMode&&Z(this.webcamConfig.facingMode==="user"||this.webcamConfig.facingMode==="environment",()=>`Invalid webcam facing mode: ${this.webcamConfig.facingMode}. Please provide 'user' or 'environment'`);try{this.stream=await navigator.mediaDevices.getUserMedia({video:{deviceId:this.webcamConfig.deviceId,facingMode:this.webcamConfig.facingMode?this.webcamConfig.facingMode:"user",width:this.webcamVideoElement.width,height:this.webcamVideoElement.height}})}catch(e){throw e.message=`Error thrown while initializing video stream: ${e.message}`,e}if(!this.stream)throw new Error("Could not obtain video from webcam.");try{this.webcamVideoElement.srcObject=this.stream}catch(e){console.log(e),this.webcamVideoElement.src=window.URL.createObjectURL(this.stream)}return this.webcamVideoElement.play(),this.isClosed=!1,new Promise(e=>{this.webcamVideoElement.onloadedmetadata=()=>{e()}})}async next(){if(this.isClosed)return{value:null,done:!0};let e;try{e=bI(this.webcamVideoElement)}catch(n){throw new Error(`Error thrown converting video to pixels: ${JSON.stringify(n)}`)}if(this.resize)try{return{value:this.cropAndResizeFrame(e),done:!1}}catch(n){throw new Error(`Error thrown cropping the video: ${n.message}`)}finally{e.dispose()}else return{value:e,done:!1}}needToResize(){return!!(this.webcamConfig.resizeWidth&&this.webcamConfig.resizeHeight&&(this.webcamVideoElement.width!==this.webcamConfig.resizeWidth||this.webcamVideoElement.height!==this.webcamConfig.resizeHeight))}cropAndResizeFrame(e){return Ee(()=>{const n=Br(ft(e,"float32"),0);let s;s=Vi.cropAndResize(n,this.cropBox,this.cropBoxInd,this.cropSize,"bilinear");const r=s.shape;return be(s,r.slice(1))})}async capture(){return(await this.next()).value}stop(){this.stream.getTracks().forEach(n=>n.stop());try{this.webcamVideoElement.srcObject=null}catch(n){console.log(n),this.webcamVideoElement.src=null}this.isClosed=!0}toArray(){throw new Error("Can not convert infinite video stream to array.")}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class QX{}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class ZX extends $r{split(e){return new bRe(this,e)}}class bRe extends ZX{constructor(e,n){super(),this.upstream=e,this.impl=new vRe(e,n)}summary(){return this.impl.summary()}async next(){return this.impl.next()}}class vRe extends SR{constructor(e,n){super(),this.upstream=e,this.separator=n,this.carryover=""}summary(){return`${this.upstream.summary()} -> Split('${this.separator}')`}async pump(){const e=await this.upstream.next();if(e.done)return this.carryover===""?!1:(this.outputQueue.push(this.carryover),this.carryover="",!0);const n=e.value.split(this.separator);n[0]=this.carryover+n[0];for(const s of n.slice(0,-1))this.outputQueue.push(s);return this.carryover=n[n.length-1],!0}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class wRe extends $r{decodeUTF8(){return new NRe(this)}}class NRe extends ZX{constructor(e){super(),this.upstream=e,this.impl=new SRe(e)}summary(){return this.impl.summary()}async next(){return this.impl.next()}}class SRe extends SR{constructor(e){if(super(),this.upstream=e,$e().get("IS_BROWSER"))this.decoder=new TextDecoder("utf-8");else{const{StringDecoder:n}=require("string_decoder");this.decoder=new n("utf8")}}summary(){return`${this.upstream.summary()} -> Utf8`}async pump(){const e=await this.upstream.next();let n;if(e.done)return!1;n=e.value;let s;return $e().get("IS_BROWSER")?s=this.decoder.decode(n,{stream:!0}):s=this.decoder.write(Buffer.from(n.buffer)),this.outputQueue.push(s),!0}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class JX extends wRe{constructor(e,n={}){super(),this.file=e,this.options=n,Z(e instanceof Uint8Array||($e().get("IS_BROWSER")?e instanceof File||e instanceof Blob:!1),()=>"FileChunkIterator only supports File, Blob and Uint8Array right now."),this.offset=n.offset||0,this.chunkSize=n.chunkSize||1024*1024}summary(){return`FileChunks ${this.file}`}async next(){return this.offset>=(this.file instanceof Uint8Array?this.file.byteLength:this.file.size)?{value:null,done:!0}:{value:await new Promise((n,s)=>{const r=this.offset+this.chunkSize;if(this.file instanceof Uint8Array)n(new Uint8Array(this.file.slice(this.offset,r)));else{const a=new FileReader;a.onload=l=>{let c=a.result;if(c instanceof ArrayBuffer&&(c=new Uint8Array(c)),!(c instanceof Uint8Array))return s(new TypeError("FileReader returned unknown type."));n(c)},a.onabort=l=>s(new Error("Aborted")),a.onerror=l=>s(new Error(l.type));const i=this.file.slice(this.offset,r);a.readAsArrayBuffer(i)}this.offset=r}),done:!1}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */async function jRe(t,e={},n){let s,r;typeof t=="string"?s=t:(s=t.url,r=kRe(t));const a=await sG(s,r);if(a.ok){const i=new Uint8Array(await a.arrayBuffer());return new JX(i,e)}else throw new Error(a.statusText)}const kRe=t=>({method:t.method,headers:t.headers,body:t.body,mode:t.mode,credentials:t.credentials,cache:t.cache,redirect:t.redirect,referrer:t.referrer,integrity:t.integrity});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function eY(t){return typeof t=="string"&&t.slice(0,7)==="file://"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class tY extends QX{constructor(e,n={}){super(),this.input=e,this.options=n}async iterator(){if(eY(this.input)&&$e().get("IS_NODE")){const e=require("fs");this.input=e.readFileSync(this.input.slice(7))}return new JX(this.input,this.options)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */class nY extends QX{constructor(e,n={}){super(),this.url=e,this.fileOptions=n}async iterator(){return eY(this.url)?new tY(this.url,this.fileOptions).iterator():jRe(this.url,this.fileOptions)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */function CRe(t,e={}){return new YX(new nY(t),e)}function TRe(t){const e=NR(t);return ii(async()=>e)}function _Re(t){return ii(async()=>{const e=await t();return NR(()=>e.next())})}async function ERe(t,e){return kR.create(t,e)}async function ARe(t){return jR.create(t)}/** @license See the LICENSE file. */const sY="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Re=Object.freeze(Object.defineProperty({__proto__:null,CSVDataset:YX,Dataset:Qp,FileDataSource:tY,TextLineDataset:XX,URLDataSource:nY,array:pRe,csv:CRe,func:TRe,generator:_Re,microphone:ARe,version_data:sY,webcam:ERe,zip:gRe},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ot(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&Z(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IRe=XS;class kb extends hN{nextDataId(){return kb.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new UA(this,Qo())}write(e,n,s){this.firstUse&&(this.firstUse=!1,$e().get("IS_NODE")&&zi(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:s,refCount:1}),r}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&Al(s[0])){const a=s.map(i=>Rl(i));r=this.write(a,e,n)}else r=this.write(s,e,n);return{dataId:r,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,s,r,a){this.data.set(e,{values:n,dtype:r,refCount:a})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:s}=this.data.get(e);if(n==="complex64"){const r=this.readSync(s.real.dataId),a=this.readSync(s.imag.dataId);return Mc(r,a)}return HH(this.data.get(e).values,n)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>Oc(r));return on(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return on(e.shape,e.dtype,n)}makeOutput(e,n,s){return Qo().makeTensorFromTensorInfo(this.makeTensorInfo(n,s,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(e);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=zr();return e(),{kernelMs:zr()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){Ot([e],"where");const n=this.readSync(e.dataId);return IRe(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}kb.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rY(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const RRe=t=>{const{x:e}=t.inputs,n=t.backend;Ot(e,"abs");let s=new Float32Array(ze(e.shape));const r=n.data.get(e.dataId).values;return s=rY(r),n.makeOutput(s,e.shape,e.dtype)},ORe={kernelName:Wx,backendName:"cpu",kernelFunc:RRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qs(t){return(e,n,s,r,a)=>{const i=en(e,n),l=i.length,c=Ut(i),u=ze(i),h=Er(a,u),f=e.length,p=n.length,x=Ut(e),y=Ut(n),v=Ch(e,i),b=Ch(n,i);if(v.length+b.length===0)for(let N=0;N<h.length;++N)h[N]=t(s[N%s.length],r[N%r.length]);else for(let N=0;N<h.length;++N){const S=Hh(N,l,c),k=S.slice(-f);v.forEach(A=>k[A]=0);const T=sl(k,f,x),E=S.slice(-p);b.forEach(A=>E[A]=0);const D=sl(E,p,y);h[N]=t(s[T],r[D])}return[h,i]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ui(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,a=n.data.get(s.dataId).values,i=n.data.get(r.dataId).values,l=n.makeTensorInfo(s.shape,"complex64"),c=n.data.get(l.dataId);return c.complexTensorInfos={real:n.makeTensorInfo(s.shape,"float32",a),imag:n.makeTensorInfo(r.shape,"float32",i)},l}const DRe={kernelName:wN,backendName:"cpu",kernelFunc:ui};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h2(t,e,n="float32"){if(n==="complex64"){const r=h2(t,e,"float32"),a=h2(t,e,"float32");return ui({inputs:{real:r,imag:a},backend:t})}const s=Gr(ze(e),n);return t.makeTensorInfo(e,n,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wl(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const PRe={kernelName:cp,backendName:"cpu",kernelFunc:Wl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rh(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.real,a=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,a)}const LRe={kernelName:eS,backendName:"cpu",kernelFunc:Rh};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aY(t,e,n,s){if(s==="int32"){const r=Int32Array.from(t);return[e,"int32",r]}if(s==="bool"){const r=ld([0],n),[a,i]=qs((l,c)=>l!==c?1:0)(e,[],t,r,"bool");return[i,"bool",a]}throw new Error(`Error in Cast: failed to cast ${n} to ${s}`)}function rd(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:a}=s;if(a==="complex64"){if(r.dtype==="complex64")return Wl({inputs:{x:r},backend:n});const h=h2(n,r.shape,r.dtype),f=rd({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),p=ui({inputs:{real:f,imag:h},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),p}if(r.dtype==="complex64"){const h=Rh({inputs:{input:r},backend:n}),f=rd({inputs:{x:h},backend:n,attrs:{dtype:a}});return n.disposeIntermediateTensorInfo(h),f}if(!HA(r.dtype,a)){const h=Wl({inputs:{x:r},backend:n});return{dataId:h.dataId,shape:h.shape,dtype:a}}const i=n.data.get(r.dataId).values,[l,c,u]=aY(i,r.shape,r.dtype,a);return n.makeTensorInfo(l,c,u)}const MRe={kernelName:Yf,backendName:"cpu",kernelFunc:rd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function br(t,e,n,s){return n==null?({inputs:r,backend:a})=>{const{a:i,b:l}=r,c=a;Ot([i,l],t);const u=c.data.get(i.dataId).values,h=c.data.get(l.dataId).values,f=i.dtype==="string"?Fc(u):u,p=i.dtype==="string"?Fc(h):h,x=s||i.dtype,[y,v]=e(i.shape,l.shape,f,p,x);return c.makeTensorInfo(v,x,y)}:({inputs:r,backend:a})=>{const{a:i,b:l}=r,c=a;if(i.dtype==="complex64"||l.dtype==="complex64"){const u=rd({inputs:{x:i},backend:c,attrs:{dtype:"complex64"}}),h=c.data.get(u.dataId),f=h.complexTensorInfos.real,p=h.complexTensorInfos.imag,x=c.data.get(f.dataId).values,y=c.data.get(p.dataId).values,v=rd({inputs:{x:l},backend:c,attrs:{dtype:"complex64"}}),b=c.data.get(v.dataId),N=b.complexTensorInfos.real,S=b.complexTensorInfos.imag,k=c.data.get(N.dataId).values,T=c.data.get(S.dataId).values,[E,D,A]=n(i.shape,l.shape,x,y,k,T),I=c.makeTensorInfo(A,"float32",E),P=c.makeTensorInfo(A,"float32",D),$=ui({inputs:{real:I,imag:P},backend:c});return c.disposeIntermediateTensorInfo(u),c.disposeIntermediateTensorInfo(v),c.disposeIntermediateTensorInfo(I),c.disposeIntermediateTensorInfo(P),$}else{const u=c.data.get(i.dataId).values,h=c.data.get(l.dataId).values,f=s||i.dtype,[p,x]=e(i.shape,l.shape,u,h,f);return c.makeTensorInfo(x,f,p)}}}function CR(t){return(e,n,s,r,a,i)=>{const l=en(e,n),c=ze(l),u=l.length,h=Ut(l),f=Er("float32",c),p=Er("float32",c),x=Ch(e,l),y=Ch(n,l),v=Mc(s,r),b=Mc(a,i),N=e.length,S=Ut(e),k=n.length,T=Ut(n);if(x.length+y.length===0)for(let E=0;E<f.length;E++){const D=E%v.length,A=E%b.length,I=t(v[D*2],v[D*2+1],b[A*2],b[A*2+1]);f[E]=I.real,p[E]=I.imag}else for(let E=0;E<f.length;E++){const D=Hh(E,u,h),A=D.slice(-N);x.forEach(F=>A[F]=0);const I=sl(A,N,S),P=D.slice(-k);y.forEach(F=>P[F]=0);const $=sl(P,k,T),R=t(v[I*2],v[I*2+1],b[$*2],b[$*2+1]);f[E]=R.real,p[E]=R.imag}return[f,p,l]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iY=qs(((t,e)=>t+e)),FRe=CR(((t,e,n,s)=>({real:t+n,imag:e+s}))),jf=br(Gh,iY,FRe),zRe={kernelName:Gh,backendName:"cpu",kernelFunc:jf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TR(t,e,n,s,r){const a=ze(s),i=Gr(r,n);for(let l=0;l<t.length;l++){const c=t[l];if(c<0)throw new Error("Input x must be non-negative!");c>=r||(a>0?i[c]+=e[l]:i[c]+=1)}return i}function oY(t,e,n,s=!1){const r=t.shape[0],a=t.shape[1],i=on([r,n],e.dtype);for(let l=0;l<r;l++)for(let c=0;c<a;c++){const u=t.get(l,c);if(u<0)throw new Error("Input x must be non-negative!");u>=n||(s?i.set(1,l,u):e.size>0?i.set(i.get(l,u)+e.get(l,c),l,u):i.set(i.get(l,u)+1,l,u))}return i}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lY=qs(((t,e)=>t&e)),BRe=br(Zx,lY),URe={kernelName:Zx,backendName:"cpu",kernelFunc:BRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ql(t){return(e,n,s)=>{const r=Ms(n,e.length);for(let a=0;a<e.length;++a)r[a]=t(e[a],s);return r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gn(t,e,n){const s=ql(e);return gd(t,s,n)}function gd(t,e,n){return({inputs:s,attrs:r,backend:a})=>{const{x:i}=s;Ot(i,t);const l=a,c=l.data.get(i.dataId).values;let u;if(i.dtype==="string"){if(!Array.isArray(c))throw new Error("String tensor's value was not an instance of Array");u=Fc(c)}else u=c;const h=n||i.dtype,f=e(u,h,r);return l.makeTensorInfo(i.shape,h,f)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cY=ql(t=>Math.ceil(t)),VRe=gd(Qf,cY),WRe={kernelName:Qf,backendName:"cpu",kernelFunc:VRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uY(t,e,n,s){const r=Ms(n,ze(e));if(s&&n!=="string"){let a=0;t.forEach(i=>{const l=ze(i.shape);r.set(i.vals,a),a+=l})}else{let a=0;t.forEach(i=>{const l=n==="string"?Fc(i.vals):i.vals;let c=0;for(let u=0;u<i.shape[0];++u){const h=u*e[1]+a;for(let f=0;f<i.shape[1];++f)r[h+f]=l[c++]}a+=i.shape[1]})}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dY=qs((t,e)=>t===e?1:0),hY=br(oy,dY,null,"bool"),HRe={kernelName:oy,backendName:"cpu",kernelFunc:hY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mY=ql(t=>Math.exp(t)),fY=gd(rp,mY,"float32"),GRe={kernelName:rp,backendName:"cpu",kernelFunc:fY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pY=ql(t=>Math.expm1(t)),qRe=gd(ap,pY),KRe={kernelName:ap,backendName:"cpu",kernelFunc:qRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gY=ql(t=>Math.floor(t)),XRe=gd(ip,gY),YRe={kernelName:ip,backendName:"cpu",kernelFunc:XRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xY=qs((t,e)=>Math.floor(t/e)),QRe=br(op,xY,null,"int32"),ZRe={kernelName:op,backendName:"cpu",kernelFunc:QRe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yY(t,e,n,s,r,a,i,l,c){const u=on([s,a],n);for(let h=0;h<s;h++){const f=[];let p=0;for(let x=0;x<r;x++){const y=t[h*r+x];p+=y*i[x],f.push(y)}if(p<0||p>=c/a)throw new Error(`Invalid indices: ${f} does not index into ${l}`);for(let x=0;x<a;x++)u.values[h*a+x]=e.get(...e.indexToLoc(p*a+x))}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bY(t,e,n){const s=on(n,t.dtype);for(let r=0;r<s.size;++r){const i=s.indexToLoc(r).slice(),l=i[0],c=i[2],u=e.locToIndex([l,c]);i[2]=e.values[u];const h=t.locToIndex(i);0<=h&&h<t.values.length&&(s.values[r]=t.values[h])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vY=qs((t,e)=>t>e?1:0),JRe=br(dy,vY,null,"bool"),eOe={kernelName:dy,backendName:"cpu",kernelFunc:JRe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wY=qs((t,e)=>t>=e?1:0),tOe=br(lp,wY,null,"bool"),nOe={kernelName:lp,backendName:"cpu",kernelFunc:tOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NY=qs((t,e)=>t<e?1:0),sOe=br(my,NY,null,"bool"),rOe={kernelName:my,backendName:"cpu",kernelFunc:sOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SY=qs((t,e)=>t<=e?1:0),aOe=br(fy,SY,null,"bool"),iOe={kernelName:fy,backendName:"cpu",kernelFunc:aOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jY(t,e,n){const s=(e-t)/(n-1),r=Gr(n,"float32");r[0]=t;for(let a=1;a<r.length;a++)r[a]=r[a-1]+s;return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kY=ql(t=>Math.log(t)),oOe=gd(mp,kY),lOe={kernelName:mp,backendName:"cpu",kernelFunc:oOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CY(t,e,n,s){const r=Er(s,ze(n));for(let a=0;a<r.length;++a){const i=a*e;let l=t[i];for(let c=0;c<e;++c){const u=t[i+c];(Number.isNaN(u)||u>l)&&(l=u)}r[a]=l}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TY=qs(((t,e)=>Math.max(t,e))),cOe=br(pp,TY),uOe={kernelName:pp,backendName:"cpu",kernelFunc:cOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Y=qs(((t,e)=>Math.min(t,e))),dOe=br(gp,_Y),hOe={kernelName:gp,backendName:"cpu",kernelFunc:dOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _R=qs(((t,e)=>t*e)),mOe=CR(((t,e,n,s)=>({real:t*n-e*s,imag:t*s+e*n}))),$j=br(yp,_R,mOe),fOe={kernelName:yp,backendName:"cpu",kernelFunc:$j};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EY(t,e,n){const s=Yc(-1,n);return _R([],e,s,t,n)}function pOe(t){const{inputs:e,backend:n}=t,{x:s}=e;Ot(s,"neg");const r=n.data.get(s.dataId).values,[a,i]=EY(r,s.shape,s.dtype);return n.makeTensorInfo(i,s.dtype,a)}const gOe={kernelName:ky,backendName:"cpu",kernelFunc:pOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AY=qs(((t,e)=>t!==e?1:0)),xOe=br(Cy,AY,null,"bool"),yOe={kernelName:Cy,backendName:"cpu",kernelFunc:xOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ER(t,e,n,s,r){const a=e.length,i=ze(e),l=Ut(e),c=Ut(r),u=Er(n,ze(r));for(let h=0;h<i;++h){const f=Hh(h,a,l),p=new Array(f.length);for(let y=0;y<p.length;y++)p[y]=f[s[y]];const x=sl(p,a,c);u[x]=t[h]}return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ka(t){const{inputs:e,attrs:n,backend:s}=t,{x:r}=e,{perm:a}=n;Ot(r,"transpose");const i=r.shape.length,l=new Array(i);for(let f=0;f<l.length;f++)l[f]=r.shape[a[f]];const c=s.data.get(r.dataId).values,u=ER(c,r.shape,r.dtype,a,l);return{dataId:s.write(u,l,r.dtype),shape:l,dtype:r.dtype}}const bOe={kernelName:ch,backendName:"cpu",kernelFunc:Ka};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Y(t,e,n,s){const[r,a]=Dr(t,s),i=Va(e,"int32"),l=Gr(ze(r),i),c=ze(a);for(let u=0;u<l.length;++u){const h=u*c;let f=1;for(let p=0;p<c;++p)f*=n[h+p];l[u]=f}return{outVals:l,outShape:r,outDtype:i}}function vOe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:i}=s;Ot(r,"prod");const l=r.shape.length,c=fn(a,r.shape),u=Os(c,l);let h=c,f=r;const p=[];u!=null&&(f=Ka({inputs:{x:r},backend:n,attrs:{perm:u}}),p.push(f),h=Hs(h.length,l));const x=n.data.get(f.dataId).values,{outVals:y,outShape:v,outDtype:b}=$Y(f.shape,f.dtype,x,h);let N=v;return i&&(N=Ws(v,c)),p.forEach(S=>n.disposeIntermediateTensorInfo(S)),n.makeTensorInfo(N,b,y)}const wOe={kernelName:Iy,backendName:"cpu",kernelFunc:vOe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NOe(t,e,n){t.forEach((s,r)=>{if(s<0||s>=n){const a=Hh(r,e.length,Ut(e)).join(",");throw new Error(`indices[${a}] = ${s} is not in [0, ${n})`)}})}function SOe(t,e){for(let n=0;n<t.length;++n){const s=t[n],r=n===t.length-1?e:t[n+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>r)throw new Error("Ragged splits must not point past values");for(let a=1;a<s.length;++a)if(s[a-1]>s[a])throw new Error("Ragged splits must be sorted in ascending order")}}function jOe(t,e,n,s){const r=[];let a=0;const i=e.length-1+n.length,l=new Array(i).fill(null).map(()=>[0]);SOe(n,s);let c=1;for(let u=0;u<e.length-1;++u){c*=e[u];const h=e[u+1];for(let f=1;f<c+1;++f)l[u].push(f*h)}for(let u=0;u<t.length;++u){let h=t[u],f=t[u]+1;for(let p=0;p<n.length;++p){const x=n[p],y=p+e.length-1;if(y>=0){const v=l[y],b=v[v.length-1]-x[h];for(let N=h;N<f;++N)l[y].push(x[N+1]+b)}h=x[h],f=x[f]}f!==h&&(r.push([h,f]),a+=f-h)}return{outSplits:l,valueSlices:r,numValues:a}}function kOe(t){const e=[];for(let n=0;n<t.length;++n){const s=t[n].length,r=Ms("int32",s);e.push(r),t[n].forEach((a,i)=>r[i]=a)}return e}function yB(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let s=e;s<t.length;s++)n[e-1]*=t[s];return n}function COe(t,e,n,s,r,a){const i=yB(e,2)[1],l=yB(a,2)[1];let c=0;for(const u of n)for(let h=u[0];h<u[1];++h){for(let f=0;f<s;++f)r[c*l+f]=t[h*i+f];++c}}function TOe(t,e,n,s,r){const a=e.slice();a[0]=r;const i=Ms(n,ze(a)),l=t.length,c=l===0?0:l/e[0];return COe(t,e,s,c,i,a),[i,a]}function IY(t,e,n,s,r,a,i,l){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const c=e[0][0]-1;if(NOe(a,i,c),s.length===0)throw new Error("params.rank must be nonzero");const u=s[0],{outSplits:h,valueSlices:f,numValues:p}=jOe(a,i,t,u),x=kOe(h),y=TOe(n,s,r,f,p);return[x,y[0],y[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bB=2147483647;function RY(t,e,n,s,r,a,i){if(e.length>1)throw new Error("starts must be a scalar or vector");if(r.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");const l=e.length===0,c=r.length===0,u=i.length===0,h=[];l||h.push(e[0]),c||h.push(r[0]),u||h.push(i[0]);for(let b=1;b<h.length;++b)if(h[b]!==h[b-1])throw new Error("starts, limits, and deltas must have the same shape");const f=h.length===0?1:h[0],p=Ms("int32",f+1);p[0]=0;for(let b=0;b<f;++b){const N=l?t[0]:t[b],S=c?s[0]:s[b],k=u?a[0]:a[b];if(k===0)throw new Error("Requires delta != 0");let T;if(k>0&&S<N||k<0&&S>N)T=0;else if(T=Math.ceil(Math.abs((S-N)/k)),T>bB)throw new Error(`Requires ((limit - start) / delta) <= ${bB}`);p[b+1]=p[b]+T}const x=p[f],y=Ms(n,x);let v=0;for(let b=0;b<f;++b){const N=p[b+1]-p[b];let S=l?t[0]:t[b];const k=u?a[0]:a[b];for(let T=0;T<N;++T)y[v++]=S,S+=k}return[p,y]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var So=Jo;class m2{constructor(e,n,s,r,a,i,l,c,u,h){this.shape=e,this.shapeShape=n,this.values=s,this.valuesShape=r,this.valuesDType=a,this.defaultValue=i,this.defaultValueShape=l,this.rowPartitionValues=c,this.rowPartitionValuesShapes=u,this.rowPartitionTypes=Yq(h),this.raggedRank=Qq(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===So.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===So.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case So.VALUE_ROWIDS:return m2.getMaxWidthValueRowID(n);case So.ROW_SPLITS:return m2.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${So[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let s=0;for(let r=0;r<n-1;++r){const a=e[r+1]-e[r];a>s&&(s=a)}return s}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let s=0,r=e[0],a=0;for(let i=1;i<n;++i){const l=e[i];l!==r&&(r=l,a=Math.max(i-s,a),s=i)}return Math.max(n-s,a)}tensorShapeFromTensor(e,n,s=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return wB(e,s)}calculateOutputSize(e){const n=this.valuesShape,s=this.defaultValueShape;Zq(s,n);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=Xq(this.raggedRank,r,n);i[0]<0&&(i[0]=e);for(let l=1;l<=this.raggedRank;++l)i[l]<0&&(i[l]=this.getMaxWidth(l));return i}calculateFirstParentOutputIndex(e,n,s){const r=Math.min(e,s),a=[];let i=0;for(let l=0;l<r;++l,i+=n)a.push(i);for(let l=r;l<e;++l)a.push(-1);return Z(a.length===e,()=>"Final length of result must be equal to firstDimension."),a}calculateOutputIndexRowSplit(e,n,s,r){const a=e.length,i=[];for(let l=0;l<a-1;++l){const c=e[l+1]-e[l];let u=Math.min(r,c),h=n[l];h===-1&&(u=0);for(let f=0;f<u;++f)i.push(h),h+=s;for(let f=0;f<c-u;++f)i.push(-1)}if(a>0&&i.length!==e[a-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,n,s,r){const a=e.length,i=[];if(a===0)return[];let l=0,c=e[0];if(c>=n.length)throw new Error(`Got currentValueRowId=${c}, which is not less than ${n.length}`);let u=n[c];i.push(u);for(let h=1;h<a;++h){const f=e[h];if(f===c)u>=0&&(++l,l<r?u+=s:u=-1);else{if(l=0,c=f,f>=n.length)throw new Error(`Got nextValueRowId=${f} which is not less than ${n.length}`);u=n[f]}i.push(u)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(e,n,s,r){const a=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case So.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(a,n,s,r);case So.ROW_SPLITS:if(a.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${a.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(a,n,s,r);default:throw new Error(`Unsupported partition type: ${So[i]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case So.FIRST_DIM_SIZE:return e[0];case So.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case So.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${So[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),s=this.calculateOutputSize(n),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let c=r.length-2;c>=0;--c)r[c]=r[c+1]*s[c+1];const a=wB(s,!1),i=Ms(this.valuesDType,ze(a));if(r[0]*s[0]>0){let c=this.calculateFirstParentOutputIndex(n,r[0],s[0]);for(let u=1;u<=this.raggedRank;++u)c=this.calculateOutputIndex(u-1,c,r[u],s[u]);this.setOutput(this.raggedRank,c,i,a)}return[a,i]}setOutput(e,n,s,r){if(s.length===0)return;const a=this.values,i=s;let l=r.slice();l=l.slice(e+1);const c=ze(l),u=n.length;let h=this.defaultValue;if(h.length!==c&&h.length!==1){const y=this.defaultValueShape;Ee(()=>{const v=be(h,y);h=uh(v,l).dataSync()})}let f=0,p=0,x=0;for(let y=0;y<=u;++y){let v=y<u?n[y]:-1;if(v===x){++x;continue}if(p<x){const b=a.subarray(f*c),N=i.subarray(p*c),S=(x-p)*c;vB(N,b,S)}if(y>=u){const b=s.length;v=Math.floor(b/c)}if(v>x)if(this.defaultValue.length===1)i.subarray(x*c,v*c).fill(this.defaultValue[0]),x=v;else for(;v>x;){const b=i.slice(x*c);vB(b,h,c),++x}v<0?(f=y+1,p=x):(f=y,p=x,x=p+1)}}}function vB(t,e,n){for(let s=0;s<n;s++)t[s]=e[s]}function wB(t,e){const n=[];for(let s of t){if(s<0){if(!e)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}n.push(s)}return n}function OY(t,e,n,s,r,a,i,l,c,u){return new m2(t,e,n,s,r,a,i,l,c,u).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DY(t,e,n,s){const r=t===e,a=t<e&&n<0,i=e<t&&n>1;if(r||a||i)return Gr(0,s);const l=Math.abs(Math.ceil((e-t)/n)),c=Gr(l,s);e<t&&n===1&&(n=-1),c[0]=t;for(let u=1;u<c.length;u++)c[u]=c[u-1]+n;return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PY=ql(t=>1/Math.sqrt(t)),_Oe=gd(jp,PY),EOe={kernelName:jp,backendName:"cpu",kernelFunc:_Oe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function th(t,e,n,s,r,a,i,l,c,u){const h=[s/r,r],f=t.values,p=e.values;if(s===0)return on(n,e.dtype);const x=c instanceof tr?c:on(h,e.dtype);typeof c=="string"||typeof c=="number"?x.values.fill(c):typeof c=="boolean"&&x.values.fill(+c);for(let y=0;y<a;y++){const v=[];let b=0;for(let N=0;N<i;N++){const S=f[y*i+N];v.push(S),b+=S*l[N]}if(b<0||b>=s/r)throw new Error(`Invalid indices: ${v} does not index into ${n}`);for(let N=0;N<r;N++)u?x.values[b*r+N]+=p[y*r+N]:x.values[b*r+N]=e.rank===0?p[0]:p[y*r+N]}return x}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AOe=ql(t=>1/(1+Math.exp(-t))),LY=Gn(Ep,t=>1/(1+Math.exp(-t))),$Oe={kernelName:Ep,backendName:"cpu",kernelFunc:LY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MY(t,e,n,s,r){const a=NI(s,e,n),i=ze(n),l=Ut(s);if(a){const f=SI(e,l);return r==="string"?t.slice(f,f+i):t.subarray(f,f+i)}const c=r==="string"?Fc(t):t,u=on(s,r,c),h=on(n,r);for(let f=0;f<h.size;++f){const p=h.indexToLoc(f),x=p.map((y,v)=>y+e[v]);h.set(u.get(...x),...p)}return r==="string"?yK(h.values):h.values}function Oh(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:a,size:i}=s;Ot(r,"slice");const[l,c]=ij(r,a,i);vI(r,l,c);const u=n.data.get(r.dataId).values,h=MY(u,l,c,r.shape,r.dtype);return n.makeTensorInfo(c,r.dtype,h)}const IOe={kernelName:My,backendName:"cpu",kernelFunc:Oh};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FY(t,e,n,s,r,a,i){const l=e[0],c=a[0],u=new Array(c),h=new Array(l),f=e[1];if(c===0){if(l!==0)throw new Error(aK(l));const b=Ms(n,0),N=Ms(r,0);return[b,[0,f],N,u,h]}let p=!0,x=0;const y=new Array(c).fill(0);for(let b=0;b<l;++b){const N=t[b*f];if(N<0)throw new Error(iK(b,N));if(N>=c)throw new Error(oK(b,N,c));++y[N],p=p&&N>=x,x=N}let v=!0;for(let b=0;b<c;++b){const N=y[b]===0;u[b]=N,v=v&&!N,y[b]=Math.max(y[b],1),b>0&&(y[b]+=y[b-1])}if(v&&p){const b=t,N=s;for(let S=0;S<l;++S)h[S]=S;return[b,[l,f],N,u,h]}else{const b=y[c-1],N=Ms(n,b*f),S=Ms(r,b),k=new Array(c).fill(0);for(let T=0;T<l;++T){const E=t[T*f],D=k[E],A=(E===0?0:y[E-1])+D;k[E]++;for(let I=0;I<f;++I)N[A*f+I]=t[T*f+I];S[A]=s[T],h[T]=A}for(let T=0;T<c;++T)if(k[T]===0){const D=T===0?0:y[T-1];N[D*f+0]=T;for(let A=1;A<f;++A)N[D*f+A]=0;S[D]=i}return[N,[b,f],S,u,h]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zY(t,e,n,s,r){const a=ze(s),i=e[0],l=r.length,c=[];let u=1,h=-1;for(let b=0;b<l;++b){const N=r[b];if(N===-1){if(h!==-1)throw new Error(lK(h,b));h=b,c.push(1)}else{if(N<0)throw new Error(cK(b,N));u*=N,c.push(N)}}if(h!==-1){if(u<=0)throw new Error(uK());const b=Math.trunc(a/u);if(u*b!==a)throw new Error(dK(s,c));c[h]=b}if(ze(c)!==a)throw new Error(hK(s,c));const p=s.length,x=[];if(p>0){x[p-1]=1;for(let b=p-2;b>=0;--b)x[b]=x[b+1]*s[b+1]}const y=[];if(l>0){y[l-1]=1;for(let b=l-2;b>=0;--b)y[b]=y[b+1]*c[b+1]}const v=Ms(n,i*l);for(let b=0;b<i;++b){let N=0;for(let S=0;S<p;++S)N+=t[b*p+S]*x[S];for(let S=0;S<l;++S)v[b*l+S]=Math.trunc(N/y[S]),N%=y[S]}return[v,[i,l],c]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AR(t,e,n,s,r,a=!1,i=0){const l=s.length,c=[e[0],t.length/e[0]],u=c[1],f=l>0?r[l-1]+1:0;if(f<0)throw new Error(pE());const p=e.slice();p[0]=f;const x=p.reduce((k,T)=>k*T,1),y=Ms(n,x);if(l===0)return f>0&&y.fill(i),[y,p];if(f<=0)throw new Error(pE());let v=0,b=1,N=0,S=r[v];for(;;){let k=0;if(b<l){if(k=r[b],S===k){++b;continue}if(S>=k)throw new Error(mK())}if(S<0||S>=f)throw new Error(fK(S,f));S>N&&y.fill(i,N*u,S*u);for(let T=v;T<b;++T){const E=s[T];if(E<0||E>=c[0])throw new Error(pK(T,s[T],c[0]));for(let D=0;D<u;D++)y[S*u+D]+=t[E*u+D]}if(a)for(let T=0;T<u;T++)y[S*u+T]/=b-v;if(v=b,++b,N=S+1,S=k,b>l)break}return N<f&&y.fill(i,N*u,f*u),[y,p]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ROe=ql(t=>Math.sqrt(t)),OOe=Gn($p,t=>Math.sqrt(t)),DOe={kernelName:$p,backendName:"cpu",kernelFunc:OOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BY=qs(((t,e)=>{const n=t-e;return n*n})),POe=br(Ip,BY),LOe={kernelName:Ip,backendName:"cpu",kernelFunc:POe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UY=ql((t,e)=>{const{pattern:n,replaceGlobal:s,rewrite:r}=e;return t.replace(new RegExp(n,s?"g":""),r)}),MOe=gd(Vy,UY),FOe={kernelName:Vy,backendName:"cpu",kernelFunc:MOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VY(t,e,n,s){const r=on(t,e.dtype);for(let a=0;a<r.size;a++){const i=r.indexToLoc(a),l=new Array(i.length);for(let c=0;c<l.length;c++)l[c]=i[c]*n[c]+s[c];r.set(e.get(...l),...i)}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class zOe{constructor(e,n,s,r,a,i){this.separator=Rl(e),this.nGramWidths=n,this.leftPad=Rl(s),this.rightPad=Rl(r),this.padWidth=a,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const s=this.getPadWidth(n);return Math.max(0,e+2*s-n+1)}createNGrams(e,n,s,r,a,i){for(let l=0;l<a;++l){const c=this.getPadWidth(i),u=Math.max(0,c-l),h=Math.max(0,c-(a-(l+1))),f=i-(u+h),p=n+(u>0?0:l-c);let x=0;x+=u*this.leftPad.length;for(let S=0;S<f;++S)x+=e[p+S].length;x+=h*this.rightPad.length;const y=u+h+f-1;x+=y*this.separator.length,s[r+l]=new Uint8Array(x);const v=s[r+l];let b=0;const N=S=>S.forEach(k=>v[b++]=k);for(let S=0;S<u;++S)N(this.leftPad),N(this.separator);for(let S=0;S<f-1;++S)N(e[p+S]),N(this.separator);if(f>0){N(e[p+f-1]);for(let S=0;S<h;++S)N(this.separator),N(this.rightPad)}else{for(let S=0;S<h-1;++S)N(this.rightPad),N(this.separator);N(this.rightPad)}}}compute(e,n){const s=e.length,r=n.length;if(r>0){let c=n[0];if(c!==0)throw new Error(`First split value must be 0, got ${c}`);for(let u=1;u<r;++u){let h=n[u]>=c;if(h=h&&n[u]<=s,!h)throw new Error(`Invalid split value ${n[u]}, must be in [${c}, ${s}]`);c=n[u]}if(c!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${c}`)}const a=r-1,i=Ms("int32",r);if(s===0||r===0){const c=new Array(s);for(let u=0;u<=a;++u)i[u]=0;return[c,i]}i[0]=0;for(let c=1;c<=a;++c){const u=n[c]-n[c-1];let h=0;this.nGramWidths.forEach(f=>{h+=this.getNumNGrams(u,f)}),this.preserveShort&&u>0&&h===0&&(h=1),i[c]=i[c-1]+h}const l=new Array(i[a]);for(let c=0;c<a;++c){const u=n[c];let h=i[c];if(this.nGramWidths.forEach(f=>{const p=n[c+1]-n[c],x=this.getNumNGrams(p,f);this.createNGrams(e,u,l,h,x,f),h+=x}),this.preserveShort&&h===i[c]){const f=n[c+1]-n[c];if(f===0)continue;const p=f+2*this.padWidth;this.createNGrams(e,u,l,h,1,p)}}return[l,i]}}function WY(t,e,n,s,r,a,i,l){return new zOe(n,s,r,a,i,l).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BOe(t,e,n,s){if(!t.length)return;if(e.length===0){for(let a=0;a<t.length;++a)s.push(t.subarray(a,a+1));return}if(e.length===1){const a=e[0];let i=t.indexOf(a);for(;i!==-1;){const l=t.subarray(0,i);(!n||l.length!==0)&&s.push(l),t=t.subarray(i+1),i=t.indexOf(a)}(!n||t.length!==0)&&s.push(t);return}let r=0;for(let a=0;a<t.length+1;a++)if(a===t.length||e.indexOf(t[a])!==-1){const i=t.subarray(r,a);(!n||i.length!==0)&&s.push(i),r=a+1}}function HY(t,e,n){const s=t.length,r=[];let a=0,i=0;const l=new Array(s);for(let p=0;p<s;++p){const x=r.length;BOe(t[p],e,n,r);const y=r.length-x;l[p]=y,a+=y,i=Math.max(i,y)}const c=Ms("int32",a*2),u=new Array(a),h=[s,i];let f=0;for(let p=0;p<s;++p)for(let x=0;x<l[p];++x)c[f*2]=p,c[f*2+1]=x,u[f]=r[f],++f;return[c,u,h]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GY(t,e){const n=Ms("int32",t.length);for(let s=0;s<t.length;++s)n[s]=nG(t[s]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qY=qs(((t,e)=>t-e)),UOe=CR(((t,e,n,s)=>({real:t-n,imag:e-s}))),$R=br(Rp,qY,UOe),VOe={kernelName:Rp,backendName:"cpu",kernelFunc:$R};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KY(t,e){const n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];const s=on(n,t.dtype);for(let r=0;r<s.values.length;++r){const a=s.indexToLoc(r),i=new Array(t.rank);for(let c=0;c<i.length;c++)i[c]=a[c]%t.shape[c];const l=t.locToIndex(i);s.values[r]=t.values[l]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sg=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function XY(t,e,n=0,s=t.length-1){for(;s>n;){if(s-n>600){const l=s-n+1,c=e-n+1,u=Math.log(l),h=.5*Math.exp(2*u/3),f=.5*Math.sqrt(u*h*(l-h)/l)*Math.sign(c-l/2),p=Math.max(n,Math.floor(e-c*h/l+f)),x=Math.min(s,Math.floor(e+(l-c)*h/l+f));XY(t,e,p,x)}const r=t[e];let a=n,i=s;for(yc(t,n,e),Sg(t[s],r)>0&&yc(t,n,s);a<i;){for(yc(t,a,i),a++,i--;Sg(t[a],r)<0;)a=a+1;for(;Sg(t[i],r)>0;)i=i-1}Sg(t[n],r)===0?yc(t,n,i):(i=i+1,yc(t,i,s)),i<=e&&(n=i+1),e<=i&&(s=i-1)}}function YY(t,e,n,s,r){const a=e[e.length-1],[i,l]=[t.length/a,a],c=Er(n,i*s),u=Er("int32",i*s);for(let f=0;f<i;f++){const p=f*l,x=t.subarray(p,p+l);let y=new Array(x.length);x.forEach((S,k)=>y[k]={value:S,index:k}),s<y.length&&(XY(y,s),y=y.slice(0,s)),r&&y.sort(Sg);const v=f*s,b=c.subarray(v,v+s),N=u.subarray(v,v+s);for(let S=0;S<s;S++)b[S]=y[S].value,N[S]=y[S].index}const h=e.slice();return h[h.length-1]=s,[on(h,n,c),on(h,"int32",u)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QY(t,e,n,s){const r=fn(e,n)[0],a=[1,n[0],1];for(let y=0;y<r;y++)a[0]*=n[y];a[1]=n[r];for(let y=r+1;y<n.length;y++)a[2]*=n[y];const i=new Map,l=new Int32Array(n[r]),c=new tr(a,s,t),u=[],h=a[0]===1&&a[2]===1;for(let y=0;y<n[r];y++){let v;if(h)v=t[y].toString();else{const N=[];for(let S=0;S<a[0];S++)for(let k=0;k<a[2];k++)N.push(c.get(S,y,k));v=N.join(",")}const b=i.get(v);if(b!=null)l[y]=b;else{const N=i.size;i.set(v,N),l[y]=N,u.push(y)}}const f=a.slice();f[1]=i.size;const p=new tr(f,s);u.forEach((y,v)=>{for(let b=0;b<a[0];b++)for(let N=0;N<a[2];N++)p.set(c.get(b,y,N),b,v,N)});const x=n.slice();return x[r]=f[1],{outputValues:p.values,outputShape:x,indices:l}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZY=Object.freeze(Object.defineProperty({__proto__:null,addImpl:iY,bincountImpl:TR,bincountReduceImpl:oY,bitwiseAndImpl:lY,castImpl:aY,ceilImpl:cY,concatImpl:uY,equalImpl:dY,expImpl:mY,expm1Impl:pY,floorDivImpl:xY,floorImpl:gY,gatherNdImpl:yY,gatherV2Impl:bY,greaterEqualImpl:wY,greaterImpl:vY,lessEqualImpl:SY,lessImpl:NY,linSpaceImpl:jY,logImpl:kY,maxImpl:CY,maximumImpl:TY,minimumImpl:_Y,multiplyImpl:_R,negImpl:EY,notEqualImpl:AY,prodImpl:$Y,raggedGatherImpl:IY,raggedRangeImpl:RY,raggedTensorToTensorImpl:OY,rangeImpl:DY,rsqrtImpl:PY,scatterImpl:th,sigmoidImpl:AOe,simpleAbsImpl:rY,sliceImpl:MY,sparseFillEmptyRowsImpl:FY,sparseReshapeImpl:zY,sparseSegmentReductionImpl:AR,sqrtImpl:ROe,squaredDifferenceImpl:BY,staticRegexReplaceImpl:UY,stridedSliceImpl:VY,stringNGramsImpl:WY,stringSplitImpl:HY,stringToHashBucketFastImpl:GY,subImpl:qY,tileImpl:KY,topKImpl:YY,transposeImpl:ER,uniqueImpl:QY},Symbol.toStringTag,{value:"Module"}));/** @license See the LICENSE file. */const JY="4.22.0";/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */JA("cpu",()=>new kb,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eQ=Gn(np,t=>t>=0?t:Math.exp(t)-1),WOe={kernelName:np,backendName:"cpu",kernelFunc:eQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tQ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:a}=s;Ot([r],"leakyRelu");const i=ze(r.shape),l=n.data.get(r.dataId).values,c=Er("float32",i);for(let u=0;u<l.length;u++)c[u]=l[u]<0?a*l[u]:l[u];return n.makeTensorInfo(r.shape,"float32",c)}const HOe={kernelName:hy,backendName:"cpu",kernelFunc:tQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GOe=qs((t,e)=>t<0?e*t:t);function nQ(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e;Ot([s,r],"prelu");const a=n.data.get(s.dataId).values,i=n.data.get(r.dataId).values,[l,c]=GOe(s.shape,r.shape,a,i,"float32");return n.makeTensorInfo(c,"float32",l)}const qOe={kernelName:$y,backendName:"cpu",kernelFunc:nQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sQ=Gn(wp,t=>Math.max(0,t)),KOe={kernelName:wp,backendName:"cpu",kernelFunc:sQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rQ=Gn(Np,t=>Math.min(Math.max(0,t),6)),XOe={kernelName:Np,backendName:"cpu",kernelFunc:rQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f2(t,e,n,s,r){if(n==="linear")return Wl({inputs:{x:e},backend:t});if(n==="relu")return sQ({inputs:{x:e},backend:t});if(n==="elu")return eQ({inputs:{x:e},backend:t});if(n==="relu6")return rQ({inputs:{x:e},backend:t});if(n==="prelu")return nQ({inputs:{x:e,alpha:s},backend:t});if(n==="leakyrelu")return tQ({inputs:{x:e},backend:t,attrs:{alpha:r}});if(n==="sigmoid")return LY({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xs(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:a}=s,i=ze(r.shape),l=WA(a,i),c=ze(l);Z(i===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${r.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`),n.incRef(r.dataId);const u=n.data.get(r.dataId);if(u.complexTensorInfos!=null){const h=u.complexTensorInfos.real,f=u.complexTensorInfos.imag;h.shape=l,f.shape=l}return{dataId:r.dataId,shape:l,dtype:r.dtype}}const YOe={kernelName:Ry,backendName:"cpu",kernelFunc:xs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aQ(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:a}=e,{transposeA:i,transposeB:l}=s;Ot([r,a],"matMul");const c=r.shape.length,u=a.shape.length,h=i?r.shape[c-2]:r.shape[c-1],f=l?a.shape[u-1]:a.shape[u-2],p=i?r.shape[c-1]:r.shape[c-2],x=l?a.shape[u-2]:a.shape[u-1],y=r.shape.slice(0,-2),v=a.shape.slice(0,-2),b=ze(y),N=ze(v),k=en(r.shape.slice(0,-2),a.shape.slice(0,-2)).concat([p,x]);Z(h===f,()=>`Error in matMul: inner shapes (${h}) and (${f}) of Tensors with shapes ${r.shape} and ${a.shape} and transposeA=${i} and transposeB=${l} must match.`);const T=i?[b,h,p]:[b,p,h],E=l?[N,x,f]:[N,f,x],D=xs({inputs:{x:r},backend:n,attrs:{shape:T}}),A=xs({inputs:{x:a},backend:n,attrs:{shape:E}}),I=i?D.shape[1]:D.shape[2],P=i?D.shape[2]:D.shape[1],$=l?A.shape[1]:A.shape[2],R=Math.max(b,N),F=n.data.get(D.dataId).values,W=n.data.get(A.dataId).values,q=Ut(D.shape),X=Ut(A.shape),[z,K,H]=i?[q[0],1,q[1]]:[q[0],q[1],1],[Y,B,O]=l?[1,X[1],X[0]]:[X[1],1,X[0]],U=P*$,J=on([R,P,$],D.dtype),se=J.values,ae=n.blockSize;for(let fe=0;fe<R;fe++){const ye=fe%b,Te=fe%N;for(let oe=0;oe<P;oe+=ae){const Se=Math.min(oe+ae,P);for(let ke=0;ke<$;ke+=ae){const me=Math.min(ke+ae,$);for(let re=0;re<I;re+=ae){const je=Math.min(re+ae,I);for(let ie=oe;ie<Se;ie++)for(let Re=ke;Re<me;Re++){let Ve=0;for(let Ze=re;Ze<je;Ze++){const bt=F[ye*z+ie*K+Ze*H],tt=W[Ze*Y+Re*B+Te*O];Ve+=bt*tt}se[fe*U+(ie*$+Re)]+=Ve}}}}}return n.disposeIntermediateTensorInfo(D),n.disposeIntermediateTensorInfo(A),n.makeTensorInfo(k,J.dtype,J.values)}const QOe={kernelName:Yx,backendName:"cpu",kernelFunc:aQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZOe(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:a,bias:i,preluActivationWeights:l}=e,{transposeA:c,transposeB:u,activation:h,leakyreluAlpha:f}=s;let p,x,y;const v=[];p=aQ({inputs:{a:r,b:a},attrs:{transposeA:c,transposeB:u},backend:n}),i&&(x=jf({inputs:{a:p,b:i},backend:n}),v.push(p),p=x),h&&(y=f2(n,p,h,l,f),v.push(p),p=y);for(const N of v)n.disposeIntermediateTensorInfo(N);return p}const JOe={kernelName:ex,backendName:"cpu",kernelFunc:ZOe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eDe=Gn(Vf,t=>Math.acos(t)),tDe={kernelName:Vf,backendName:"cpu",kernelFunc:eDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nDe=Gn(Wf,t=>Math.acosh(t)),sDe={kernelName:Wf,backendName:"cpu",kernelFunc:nDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rDe(t){const{inputs:e,backend:n}=t,s=e;Ot(e,"addN");const r=s.map(l=>n.data.get(l.dataId).values),a=on(s[0].shape,s[0].dtype),i=a.values;for(let l=0;l<s.length;l++){const c=r[l];for(let u=0;u<i.length;u++)i[u]+=c[u]}return n.makeTensorInfo(a.shape,a.dtype,a.values)}const aDe={kernelName:Hx,backendName:"cpu",kernelFunc:rDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iDe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:i}=s;Ot(r,"all");const l=fn(a,r.shape);let c=l;const u=Os(c,r.shape.length);let h=r;u!=null&&(h=Ka({inputs:{x:r},backend:n,attrs:{perm:u}}),c=Hs(c.length,r.shape.length)),Jr("all",c,h.shape.length);const[f,p]=Dr(h.shape,c),x=ze(p),y=Gr(ze(f),h.dtype),v=n.data.get(h.dataId).values;for(let N=0;N<y.length;++N){const S=N*x;let k=v[S];for(let T=0;T<x;++T){const E=v[S+T];k=k&&E}y[N]=k}u!=null&&n.disposeIntermediateTensorInfo(h);const b=n.makeTensorInfo(f,h.dtype,y);if(i){const N=Ws(f,l),S=xs({inputs:{x:b},backend:n,attrs:{shape:N}});return n.disposeIntermediateTensorInfo(b),S}return b}const oDe={kernelName:pN,backendName:"cpu",kernelFunc:iDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lDe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:i}=s;Ot(r,"any");const l=fn(a,r.shape);let c=l;const u=Os(c,r.shape.length);let h=r;u!=null&&(h=Ka({inputs:{x:r},backend:n,attrs:{perm:u}}),c=Hs(c.length,r.shape.length)),Jr("any",c,h.shape.length);const[f,p]=Dr(h.shape,c),x=ze(p),y=Gr(ze(f),h.dtype),v=n.data.get(h.dataId).values;for(let N=0;N<y.length;++N){const S=N*x;let k=v[S];for(let T=0;T<x;++T){const E=v[S+T];k=k||E}y[N]=k}u!=null&&n.disposeIntermediateTensorInfo(h);const b=n.makeTensorInfo(f,h.dtype,y);if(i){const N=Ws(f,l),S=xs({inputs:{x:b},backend:n,attrs:{shape:N}});return n.disposeIntermediateTensorInfo(b),S}return b}const cDe={kernelName:gN,backendName:"cpu",kernelFunc:lDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uDe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a}=s;Ot(r,"argMax");let i=fn(a,r.shape);const l=Os(i,r.shape.length);let c=r;const u=[];l!=null&&(c=Ka({inputs:{x:r},backend:n,attrs:{perm:l}}),u.push(c),i=Hs(i.length,c.shape.length)),i=[i[0]],Jr("argMax",i,c.shape.length);const[h,f]=Dr(c.shape,i),p=ze(h),x=Gr(p,"int32"),y=ze(f),v=n.data.get(c.dataId).values;for(let b=0;b<x.length;++b){const N=b*y;let S=v[N],k=0;for(let T=0;T<y;++T){const E=v[N+T];E>S&&(S=E,k=T)}x[b]=k}return u.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.makeTensorInfo(h,"int32",x)}const dDe={kernelName:Gx,backendName:"cpu",kernelFunc:uDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hDe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a}=s;Ot(r,"argMin");let i=fn(a,r.shape);const l=Os(i,r.shape.length);let c=r;const u=[];l!=null&&(c=Ka({inputs:{x:r},backend:n,attrs:{perm:l}}),u.push(c),i=Hs(i.length,c.shape.length)),i=[i[0]],Jr("argMin",i,c.shape.length);const[h,f]=Dr(c.shape,i),p=ze(h),x=Gr(p,"int32"),y=ze(f),v=n.data.get(c.dataId).values;for(let b=0;b<x.length;++b){const N=b*y;let S=v[N],k=0;for(let T=0;T<y;++T){const E=v[N+T];E<S&&(S=E,k=T)}x[b]=k}return u.forEach(b=>n.disposeIntermediateTensorInfo(b)),n.makeTensorInfo(h,"int32",x)}const mDe={kernelName:qx,backendName:"cpu",kernelFunc:hDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fDe=Gn(Hf,t=>Math.asin(t)),pDe={kernelName:Hf,backendName:"cpu",kernelFunc:fDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gDe=Gn(Gf,t=>Math.asinh(t)),xDe={kernelName:Gf,backendName:"cpu",kernelFunc:gDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yDe=Gn(qf,t=>Math.atan(t)),bDe={kernelName:qf,backendName:"cpu",kernelFunc:yDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vDe=qs((t,e)=>Math.atan2(t,e)),wDe=br(Xf,vDe),NDe={kernelName:Xf,backendName:"cpu",kernelFunc:wDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SDe=Gn(Kf,t=>Math.atanh(t)),jDe={kernelName:Kf,backendName:"cpu",kernelFunc:SDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IR(t,e,n,s,r,a){const i=r.strideHeight,l=r.strideWidth,c=r.dilationHeight,u=r.dilationWidth,h=r.effectiveFilterHeight,f=r.effectiveFilterWidth,p=r.padInfo.top,x=r.padInfo.left,y=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,v=on(r.outShape,n),b=v.values,N=r.outShape[1]*r.outShape[2]*r.outShape[3],S=r.outShape[2]*r.outShape[3],k=r.outShape[3];for(let T=0;T<r.batchSize;++T){const E=T*N,D=T*s[0];for(let A=0;A<r.inChannels;++A)for(let I=0;I<r.outHeight;++I){const P=I*i-p,$=Math.max(0,P),R=Math.min(r.inHeight,h+P),F=E+I*S;for(let W=0;W<r.outWidth;++W){const q=W*l-x,X=Math.max(0,q),z=Math.min(r.inWidth,f+q);let K=y,H=0,Y=0;for(let O=$;O<R;O+=c){const U=D+O*s[1];for(let J=X;J<z;J+=u){const se=U+J*s[2],ae=t[se+A];a==="max"&&ae>K?K=ae:a==="avg"&&(H+=ae,Y++)}if(isNaN(K))break}const B=F+W*k+A;b[B]=a==="avg"?H/Y:K}}}return v}function iQ(t,e,n,s,r=!1,a=!1){const i=on(s.outShape,"int32"),l=s.strideHeight,c=s.strideWidth,u=s.dilationHeight,h=s.dilationWidth,f=s.effectiveFilterHeight,p=s.effectiveFilterWidth,x=s.padInfo.top,y=s.padInfo.left,v=on(e,n,t);for(let b=0;b<s.batchSize;++b)for(let N=0;N<s.inChannels;++N)for(let S=0;S<s.outHeight;++S){const k=S*l-x;let T=k;for(;T<0;)T+=u;const E=Math.min(s.inHeight,f+k);for(let D=0;D<s.outWidth;++D){const A=D*c-y;let I=A;for(;I<0;)I+=h;const P=Math.min(s.inWidth,p+A);let $=Number.NEGATIVE_INFINITY,R=-1;for(let F=T;F<E;F+=u){const W=F-k;for(let q=I;q<P;q+=h){const X=q-A,z=v.get(b,F,q,N);z>$&&($=z,r?R=a?((b*s.inHeight+F)*s.inWidth+q)*s.inChannels+N:(F*s.inWidth+q)*s.inChannels+N:R=W*p+X)}}i.set(R,b,S,D,N)}}return i}function oQ(t,e,n,s,r,a){const i=r.strideDepth,l=r.strideHeight,c=r.strideWidth,u=r.dilationDepth,h=r.dilationHeight,f=r.dilationWidth,p=r.effectiveFilterDepth,x=r.effectiveFilterHeight,y=r.effectiveFilterWidth,v=r.padInfo.front,b=r.padInfo.top,N=r.padInfo.left,S=a==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,k=on(r.outShape,n),T=k.values,E=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],D=r.outShape[2]*r.outShape[3]*r.outShape[4],A=r.outShape[3]*r.outShape[4],I=r.outShape[4];for(let P=0;P<r.batchSize;++P){const $=P*E,R=P*s[0];for(let F=0;F<r.inChannels;++F)for(let W=0;W<r.outDepth;++W){const q=W*i-v;let X=q;for(;X<0;)X+=u;const z=Math.min(r.inDepth,p+q),K=$+W*D;for(let H=0;H<r.outHeight;++H){const Y=H*l-b;let B=Y;for(;B<0;)B+=h;const O=Math.min(r.inHeight,x+Y),U=K+H*A;for(let J=0;J<r.outWidth;++J){const se=J*c-N;let ae=se;for(;ae<0;)ae+=f;const fe=Math.min(r.inWidth,y+se),ye=U+J*I;let Te=S,oe=0,Se=0;for(let me=X;me<z;me+=u){const re=R+me*s[1];for(let je=B;je<O;je+=h){const ie=re+je*s[2];for(let Re=ae;Re<fe;Re+=f){const Ve=ie+Re*s[3],Ze=t[Ve+F];if(a==="max"&&Ze>Te?Te=Ze:a==="avg"&&(oe+=Ze,Se++),isNaN(Te))break}if(isNaN(Te))break}if(isNaN(Te))break}const ke=ye+F;T[ke]=a==="avg"?oe/Math.max(Se,1):Te}}}}return k}function kDe(t,e){const n=on(e.outShape,"int32"),s=e.strideDepth,r=e.strideHeight,a=e.strideWidth,i=e.dilationDepth,l=e.dilationHeight,c=e.dilationWidth,u=e.effectiveFilterDepth,h=e.effectiveFilterHeight,f=e.effectiveFilterWidth,p=e.padInfo.front,x=e.padInfo.top,y=e.padInfo.left;for(let v=0;v<e.batchSize;++v)for(let b=0;b<e.inChannels;++b)for(let N=0;N<e.outDepth;++N){const S=N*s-p;let k=S;for(;k<0;)k+=i;const T=Math.min(e.inDepth,u+S);for(let E=0;E<e.outHeight;++E){const D=E*r-x;let A=D;for(;A<0;)A+=l;const I=Math.min(e.inHeight,h+D);for(let P=0;P<e.outWidth;++P){const $=P*a-y;let R=$;for(;R<0;)R+=c;const F=Math.min(e.inWidth,f+$);let W=Number.NEGATIVE_INFINITY,q=-1;for(let X=k;X<T;X+=i){const z=X-S;for(let K=A;K<I;K+=l){const H=K-D;for(let Y=R;Y<F;Y+=c){const B=Y-$,O=t.get(v,X,K,Y,b);O>=W&&(W=O,q=z*h*f+H*h+B)}}}n.set(q,v,N,E,P,b)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CDe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Ot(r,"avgPool");const{filterSize:a,strides:i,pad:l,dimRoundingMode:c}=s,u=1;Z(Zr(i,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const h=Po(r.shape,a,i,u,l,c);let f;if(h.filterWidth===1&&h.filterHeight===1&&xn(h.inShape,h.outShape))f=Wl({inputs:{x:r},backend:n});else{const p=n.data.get(r.dataId).values,x=Ut(r.shape),y=IR(p,r.shape,r.dtype,x,h,"avg");f=n.makeTensorInfo(h.outShape,r.dtype,y.values)}return f}const TDe={kernelName:Kx,backendName:"cpu",kernelFunc:CDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _De(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:a,strides:i,pad:l,dimRoundingMode:c,dataFormat:u}=s;Ot(r,"avgPool3d");const h=Qc(r.shape,a,i,1,l,c,u),f=n.data.get(r.dataId).values,p=oQ(f,r.shape,r.dtype,Ut(r.shape),h,"avg");return n.makeTensorInfo(p.shape,"float32",p.values)}const EDe={kernelName:Xx,backendName:"cpu",kernelFunc:_De};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ADe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:a}=e,{filterSize:i,strides:l,pad:c,dimRoundingMode:u}=s;Ot([r,a],"avgPool3DGrad");const h=Qc(a.shape,i,l,1,c,u),f=h.strideDepth,p=h.strideHeight,x=h.strideWidth,y=h.filterDepth,v=h.filterHeight,b=h.filterWidth,N=h.dilationDepth,S=h.dilationHeight,k=h.dilationWidth,T=h.effectiveFilterDepth,E=h.effectiveFilterHeight,D=h.effectiveFilterWidth,A=T-1-h.padInfo.front,I=D-1-h.padInfo.left,P=E-1-h.padInfo.top,$=on(a.shape,"float32"),R=1/(y*v*b),F=n.bufferSync(r);for(let W=0;W<h.batchSize;++W)for(let q=0;q<h.inChannels;++q)for(let X=0;X<h.inDepth;++X)for(let z=0;z<h.inHeight;++z)for(let K=0;K<h.inWidth;++K){const H=X-A,Y=z-P,B=K-I;let O=0;for(let U=0;U<T;U+=N){const J=(H+U)/f;if(!(J<0||J>=h.outDepth||Math.floor(J)!==J))for(let se=0;se<E;se+=S){const ae=(Y+se)/p;if(!(ae<0||ae>=h.outHeight||Math.floor(ae)!==ae))for(let fe=0;fe<D;fe+=k){const ye=(B+fe)/x;if(ye<0||ye>=h.outWidth||Math.floor(ye)!==ye)continue;const Te=F.get(W,J,ae,ye,q);O+=Te}}}$.set(O*R,W,X,z,K,q)}return n.makeTensorInfo($.shape,$.dtype,$.values)}const $De={kernelName:yN,backendName:"cpu",kernelFunc:ADe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IDe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:a}=e,i=a;Ot([r,a],"avgPoolGrad");const{filterSize:l,strides:c,pad:u}=s,h=Po(i.shape,l,c,1,u),f=h.strideHeight,p=h.strideWidth,x=h.filterHeight,y=h.filterWidth,v=h.dilationHeight,b=h.dilationWidth,N=h.effectiveFilterHeight,S=h.effectiveFilterWidth,k=S-1-h.padInfo.left,T=N-1-h.padInfo.top,E=on(i.shape,"float32"),D=1/(x*y),A=n.data.get(r.dataId).values,I=on(r.shape,"float32",A);for(let P=0;P<h.batchSize;++P)for(let $=0;$<h.inChannels;++$)for(let R=0;R<h.inHeight;++R)for(let F=0;F<h.inWidth;++F){const W=R-T,q=F-k;let X=0;for(let z=0;z<N;z+=v){const K=(W+z)/f;if(!(K<0||K>=h.outHeight||Math.floor(K)!==K))for(let H=0;H<S;H+=b){const Y=(q+H)/p;if(Y<0||Y>=h.outWidth||Math.floor(Y)!==Y)continue;const B=I.get(P,K,Y,$);X+=B}}E.set(X*D,P,R,F,$)}return n.makeTensorInfo(E.shape,E.dtype,E.values)}const RDe={kernelName:xN,backendName:"cpu",kernelFunc:IDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ODe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,scale:a,offset:i,mean:l,variance:c}=e;Z(l.shape.length===c.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),Z(i==null||l.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),Z(a==null||l.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Ot([r,l,c,a,i],"batchNorm");let{varianceEpsilon:u}=s;u==null&&(u=.001);const h=n.data.get(r.dataId).values,f=n.data.get(l.dataId).values,p=n.data.get(c.dataId).values,x=a?n.data.get(a.dataId).values:new Float32Array([1]),y=i?n.data.get(i.dataId).values:new Float32Array([0]),v=new Float32Array(h.length),b=y.length,N=x.length,S=p.length,k=f.length;let T=0,E=0,D=0,A=0;for(let I=0;I<h.length;++I)v[I]=y[T++]+(h[I]-f[E++])*x[D++]/Math.sqrt(p[A++]+u),T>=b&&(T=0),E>=k&&(E=0),D>=N&&(D=0),A>=S&&(A=0);return n.makeTensorInfo(r.shape,r.dtype,v)}const DDe={kernelName:cy,backendName:"cpu",kernelFunc:ODe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PDe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:a,crops:i}=s;Ot([r],"batchToSpaceND");const l=a.reduce((N,S)=>N*S),c=mb(r.shape,a,l),u=fb(c.length,a.length),h=pb(r.shape,a,l),f=EI(i,a.length),p=AI(h,i,a.length),x=xs({inputs:{x:r},backend:n,attrs:{shape:c}}),y=Ka({inputs:{x},backend:n,attrs:{perm:u}}),v=xs({inputs:{x:y},backend:n,attrs:{shape:h}}),b=Oh({inputs:{x:v},backend:n,attrs:{begin:f,size:p}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(v),b}const LDe={kernelName:Qx,backendName:"cpu",kernelFunc:PDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MDe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:a}=e,{size:i}=s,l=n.data.get(r.dataId).values,c=n.data.get(a.dataId).values,u=TR(l,c,a.dtype,a.shape,i);return n.makeTensorInfo([i],a.dtype,u)}const FDe={kernelName:bN,backendName:"cpu",kernelFunc:MDe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zDe(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,a=n.data.get(s.dataId).values,i=n.data.get(r.dataId).values,l=en(Array.from(a),Array.from(i));return n.makeTensorInfo([l.length],"int32",Int32Array.from(l))}const BDe={kernelName:vN,backendName:"cpu",kernelFunc:zDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UDe=Gn(Zf,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),VDe={kernelName:Zf,backendName:"cpu",kernelFunc:UDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WDe=t=>{const{x:e}=t.inputs,n=t.backend,s=new Float32Array(ze(e.shape)),r=n.data.get(e.dataId),a=r.complexTensorInfos.real,i=r.complexTensorInfos.imag,l=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values;for(let u=0;u<l.length;u++){const h=l[u],f=c[u];s[u]=Math.hypot(h,f)}return n.makeOutput(s,e.shape,"float32")},HDe={kernelName:Jx,backendName:"cpu",kernelFunc:WDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kf(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.imag,a=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,a)}const GDe={kernelName:zN,backendName:"cpu",kernelFunc:kf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cf(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,a=fn(r,e[0].shape)[0],i=e.map(v=>v.shape);CI(i,a);let l=Dl(e.map(v=>v.shape),a);if(ze(l)===0)return n.makeTensorInfo(l,e[0].dtype,[]);const c=e.filter(v=>ze(v.shape)>0);if(c.length===1)return Wl({inputs:{x:c[0]},backend:n});if(c[0].dtype==="complex64"){const v=c.map(T=>Rh({inputs:{input:T},backend:n})),b=c.map(T=>kf({inputs:{input:T},backend:n})),N=Cf({inputs:v,backend:n,attrs:{axis:a}}),S=Cf({inputs:b,backend:n,attrs:{axis:a}}),k=ui({inputs:{real:N,imag:S},backend:n});return v.forEach(T=>n.disposeIntermediateTensorInfo(T)),b.forEach(T=>n.disposeIntermediateTensorInfo(T)),n.disposeIntermediateTensorInfo(N),n.disposeIntermediateTensorInfo(S),k}const u=c.map(v=>{const N=[-1,ze(v.shape.slice(a))];return xs({inputs:{x:v},backend:n,attrs:{shape:N}})}),h=u.map(v=>({vals:n.data.get(v.dataId).values,shape:v.shape}));l=Dl(u.map(v=>v.shape),1);const f=u[0].shape[0]===1,p=uY(h,l,e[0].dtype,f),x=Dl(c.map(v=>v.shape),a),y=n.makeTensorInfo(x,e[0].dtype,p);return u.forEach(v=>n.disposeIntermediateTensorInfo(v)),y}const qDe={kernelName:ey,backendName:"cpu",kernelFunc:Cf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lQ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a}=e,{strides:i,pad:l,dataFormat:c,dilations:u,dimRoundingMode:h}=s;Ot([r,a],"conv2d");const f=Zc(c),p=Or(r.shape,a.shape,i,u,l,h,!1,f),x=p.filterHeight,y=p.filterWidth,v=p.dilationHeight,b=p.dilationWidth,N=p.padInfo.left,S=p.padInfo.top,k=p.dataFormat==="channelsLast",T=new tr(p.outShape,r.dtype),E=Ut(r.shape),D=Ut(a.shape),A=E[0],I=k?E[1]:E[2],P=k?E[2]:1,$=k?1:E[1],R=T.strides[0],F=k?T.strides[1]:T.strides[2],W=k?T.strides[2]:1,q=k?1:T.strides[1],X=n.data.get(r.dataId).values,z=n.data.get(a.dataId).values,K=T.values;for(let H=0;H<p.batchSize;++H){const Y=H*A,B=H*R;for(let O=0;O<p.outHeight;++O){const U=B+O*F,J=O*p.strideHeight-S;for(let se=0;se<x;++se){const ae=J+se*v;if(ae<0||ae>=p.inHeight)continue;const fe=se*D[0],ye=Y+ae*I;for(let Te=0;Te<p.outWidth;++Te){const oe=U+Te*W,Se=Te*p.strideWidth-N;for(let ke=0;ke<y;++ke){const me=Se+ke*b;if(me<0||me>=p.inWidth)continue;const re=fe+ke*D[1],je=ye+me*P;let ie=re;for(let Re=0;Re<p.inChannels;++Re){const Ve=X[je+Re*$];for(let Ze=0;Ze<p.outChannels;++Ze)K[oe+Ze*q]+=Ve*z[ie+Ze];ie+=p.outChannels}}}}}}return n.makeTensorInfo(T.shape,T.dtype,K)}const KDe={kernelName:ty,backendName:"cpu",kernelFunc:lQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XDe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:a}=e,{strides:i,pad:l,dataFormat:c,dimRoundingMode:u,filterShape:h}=s;Ot([r,a],"conv2dBackpropFilter");const f=Zc(c),p=Or(r.shape,h,i,1,l,u,!1,f),{strideHeight:x,strideWidth:y,filterHeight:v,filterWidth:b}=p,N=p.dataFormat==="channelsLast",S=new tr(p.filterShape,"float32"),k=p.padInfo.left,T=p.padInfo.top,E=n.data.get(r.dataId).values,D=n.data.get(a.dataId).values,A=new tr(r.shape,r.dtype,E),I=new tr(a.shape,a.dtype,D);for(let P=0;P<v;++P){const $=Math.max(0,Math.ceil((T-P)/x)),R=Math.min(p.outHeight,(p.inHeight+T-P)/x);for(let F=0;F<b;++F){const W=Math.max(0,Math.ceil((k-F)/y)),q=Math.min(p.outWidth,(p.inWidth+k-F)/y);for(let X=0;X<p.inChannels;++X)for(let z=0;z<p.outChannels;++z){let K=0;for(let H=0;H<p.batchSize;++H)for(let Y=$;Y<R;++Y){const B=P+Y*x-T;for(let O=W;O<q;++O){const U=F+O*y-k;N?K+=A.get(H,B,U,X)*I.get(H,Y,O,z):K+=A.get(H,X,B,U)*I.get(H,z,Y,O)}}S.set(K,P,F,X,z)}}}return n.makeTensorInfo(S.shape,S.dtype,S.values)}const YDe={kernelName:NN,backendName:"cpu",kernelFunc:XDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QDe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:a}=e,{inputShape:i,strides:l,pad:c,dataFormat:u,dimRoundingMode:h}=s;Ot([r,a],"conv2dBackpropInput");const f=Ut(a.shape),p=Ut(r.shape);let x=Zc(u);const y=Or(i,a.shape,l,1,c,h,!1,x),v=new tr(y.inShape,"float32"),b=v.values,N=n.data.get(r.dataId).values,S=n.data.get(a.dataId).values,[k,T,E]=f,{batchSize:D,filterHeight:A,filterWidth:I,inChannels:P,inHeight:$,inWidth:R,outChannels:F,outHeight:W,outWidth:q,strideHeight:X,strideWidth:z}=y;x=y.dataFormat;const K=A-1-y.padInfo.top,H=I-1-y.padInfo.left,Y=x==="channelsLast",B=v.strides[0],O=Y?v.strides[1]:v.strides[2],U=Y?v.strides[2]:1,J=Y?1:v.strides[1],se=p[0],ae=Y?p[1]:p[2],fe=Y?p[2]:1,ye=Y?1:p[1];for(let Te=0;Te<D;++Te)for(let oe=0;oe<P;++oe)for(let Se=0;Se<$;++Se){const ke=Se-K,me=Math.max(0,Math.ceil(ke/X)),re=Math.min(W,(A+ke)/X);for(let je=0;je<R;++je){const ie=je-H,Re=Math.max(0,Math.ceil(ie/z)),Ve=Math.min(q,(I+ie)/z);let Ze=0;for(let tt=me;tt<re;++tt){const St=tt*X-ke;for(let mt=Re;mt<Ve;++mt){const jt=mt*z-ie,Oe=se*Te+ae*tt+fe*mt,ht=k*(A-1-St)+T*(I-1-jt)+E*oe;for(let ut=0;ut<F;++ut){const Q=N[Oe+ye*ut],L=S[ht+ut];Ze+=Q*L}}}const bt=B*Te+O*Se+U*je+J*oe;b[bt]=Ze}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const ZDe={kernelName:ny,backendName:"cpu",kernelFunc:QDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JDe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a}=e,{strides:i,pad:l,dilations:c}=s;Ot([r,a],"conv3d");const u=ud(r.shape,a.shape,i,c,l),{filterDepth:h,filterHeight:f,filterWidth:p,dilationDepth:x,dilationHeight:y,dilationWidth:v,padInfo:b}=u,N=b.front,S=b.left,k=b.top,T=new tr(u.outShape,r.dtype),E=n.data.get(r.dataId).values,D=n.data.get(a.dataId).values,A=T.values,I=Ut(r.shape),P=Ut(a.shape);for(let $=0;$<u.batchSize;++$){const R=$*I[0],F=$*T.strides[0];for(let W=0;W<u.outDepth;++W){const q=F+W*T.strides[1],X=W*u.strideDepth-N;for(let z=0;z<h;++z){const K=X+z*x;if(K<0||K>=u.inDepth)continue;const H=z*P[0],Y=R+K*I[1];for(let B=0;B<u.outHeight;++B){const O=q+B*T.strides[2],U=B*u.strideHeight-k;for(let J=0;J<f;++J){const se=U+J*y;if(se<0||se>=u.inHeight)continue;const ae=H+J*P[1],fe=Y+se*I[2];for(let ye=0;ye<u.outWidth;++ye){const Te=O+ye*u.outChannels,oe=ye*u.strideWidth-S;for(let Se=0;Se<p;++Se){const ke=oe+Se*v;if(ke<0||ke>=u.inWidth)continue;const me=ae+Se*P[2],re=fe+ke*u.inChannels;let je=me;for(let ie=0;ie<u.inChannels;++ie){const Re=E[re+ie];for(let Ve=0;Ve<u.outChannels;++Ve)A[Te+Ve]+=Re*D[je+Ve];je+=u.outChannels}}}}}}}}return n.makeTensorInfo(T.shape,T.dtype,T.values)}const e6e={kernelName:sy,backendName:"cpu",kernelFunc:JDe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t6e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:a}=e,{strides:i,pad:l,filterShape:c}=s;Ot([r,a],"conv3dBackpropFilterV2");const u=Ut(r.shape),h=Ut(a.shape),f=ud(r.shape,c,i,1,l),p=f.strideDepth,x=f.strideHeight,y=f.strideWidth,v=f.filterDepth,b=f.filterHeight,N=f.filterWidth,S=new tr(f.filterShape,"float32"),k=S.values,[T,E,D,A]=S.strides,I=n.data.get(a.dataId).values,[P,$,R,F]=h,W=n.data.get(r.dataId).values,[q,X,z,K]=u,H=f.padInfo.front,Y=f.padInfo.left,B=f.padInfo.top;for(let O=0;O<v;++O){const U=Math.max(0,Math.ceil((H-O)/p)),J=Math.min(f.outDepth,(f.inDepth+H-O)/p),se=O*T;for(let ae=0;ae<b;++ae){const fe=Math.max(0,Math.ceil((B-ae)/x)),ye=Math.min(f.outHeight,(f.inHeight+B-ae)/x),Te=ae*E+se;for(let oe=0;oe<N;++oe){const Se=Math.max(0,Math.ceil((Y-oe)/y)),ke=Math.min(f.outWidth,(f.inWidth+Y-oe)/y),me=oe*D+Te;for(let re=0;re<f.inChannels;++re){const je=re*A+me;for(let ie=0;ie<f.outChannels;++ie){let Re=0;for(let Ve=0;Ve<f.batchSize;++Ve){const Ze=Ve*q,bt=Ve*P;for(let tt=U;tt<J;++tt){const mt=(O+tt*p-H)*X+Ze,jt=tt*$+bt;for(let Oe=fe;Oe<ye;++Oe){const ut=(ae+Oe*x-B)*z+mt,Q=Oe*R+jt;for(let L=Se;L<ke;++L){const ee=(oe+L*y-Y)*K+ut,ce=L*F+Q;Re+=W[ee+re]*I[ce+ie]}}}}k[je+ie]=Re}}}}}return n.makeTensorInfo(S.shape,S.dtype,S.values)}const n6e={kernelName:SN,backendName:"cpu",kernelFunc:t6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s6e(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:a}=e,{pad:i,strides:l,inputShape:c}=s;Ot([r],"conv3dBackpropInputV2");const u=Ut(r.shape),h=Ut(a.shape),f=ud(c,a.shape,l,1,i),p=new tr(f.inShape,"float32"),x=p.values,[y,v,b,N]=p.strides,S=n.data.get(r.dataId).values,[k,T,E,D]=u,A=n.data.get(a.dataId).values,[I,P,$,R]=h,{batchSize:F,filterDepth:W,filterHeight:q,filterWidth:X,inChannels:z,inDepth:K,inHeight:H,inWidth:Y,outChannels:B,outDepth:O,outHeight:U,outWidth:J,strideDepth:se,strideHeight:ae,strideWidth:fe}=f,ye=W-1-f.padInfo.front,Te=q-1-f.padInfo.top,oe=X-1-f.padInfo.left;for(let Se=0;Se<F;++Se)for(let ke=0;ke<z;++ke)for(let me=0;me<K;++me){const re=me-ye,je=Math.max(0,Math.ceil(re/se)),ie=Math.min(O,(W+re)/se);for(let Re=0;Re<H;++Re){const Ve=Re-Te,Ze=Math.max(0,Math.ceil(Ve/ae)),bt=Math.min(U,(q+Ve)/ae);for(let tt=0;tt<Y;++tt){const St=tt-oe,mt=Math.max(0,Math.ceil(St/fe)),jt=Math.min(J,(X+St)/fe);let Oe=0;for(let ht=je;ht<ie;++ht){const ut=ht*se-re;for(let Q=Ze;Q<bt;++Q){const L=Q*ae-Ve;for(let M=mt;M<jt;++M){const ee=M*fe-St,ce=k*Se+T*ht+E*Q+D*M,Ce=I*(W-1-ut)+P*(q-1-L)+$*(X-1-ee)+R*ke;for(let De=0;De<B;++De){const xt=S[ce+De],Ie=A[Ce+De];Oe+=xt*Ie}}}}x[y*Se+v*me+b*Re+N*tt+ke]=Oe}}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const r6e={kernelName:jN,backendName:"cpu",kernelFunc:s6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a6e=Gn(Jf,t=>Math.cos(t)),i6e={kernelName:Jf,backendName:"cpu",kernelFunc:a6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o6e=Gn(ep,t=>Math.cosh(t)),l6e={kernelName:ep,backendName:"cpu",kernelFunc:o6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c6e(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:a,boxInd:i}=e,{cropSize:l,method:c,extrapolationValue:u}=s,[h,f,p,x]=r.shape,y=a.shape[0],[v,b]=l,N=on([y,v,b,x],"float32"),S=n.data.get(a.dataId).values,k=n.data.get(i.dataId).values,T=n.data.get(r.dataId).values,E=Ut(r.shape),D=Ut(N.shape);for(let A=0;A<y;A++){const I=A*4,P=S[I],$=S[I+1],R=S[I+2],F=S[I+3],W=k[A];if(W>=h)continue;const q=v>1?(R-P)*(f-1)/(v-1):0,X=b>1?(F-$)*(p-1)/(b-1):0;for(let z=0;z<v;z++){const K=v>1?P*(f-1)+z*q:.5*(P+R)*(f-1);if(K<0||K>f-1){for(let H=0;H<b;H++)for(let Y=0;Y<x;Y++){const B=Y+H*D[2]+z*D[1]+A*D[0];N.values[B]=u}continue}if(c==="bilinear"){const H=Math.floor(K),Y=Math.ceil(K),B=K-H;for(let O=0;O<b;O++){const U=b>1?$*(p-1)+O*X:.5*($+F)*(p-1);if(U<0||U>p-1){for(let fe=0;fe<x;fe++){const ye=fe+O*D[2]+z*D[1]+A*D[0];N.values[ye]=u}continue}const J=Math.floor(U),se=Math.ceil(U),ae=U-J;for(let fe=0;fe<x;fe++){let ye=fe+J*E[2]+H*E[1]+W*E[0];const Te=T[ye];ye=fe+se*E[2]+H*E[1]+W*E[0];const oe=T[ye];ye=fe+J*E[2]+Y*E[1]+W*E[0];const Se=T[ye];ye=fe+se*E[2]+Y*E[1]+W*E[0];const ke=T[ye],me=Te+(oe-Te)*ae,re=Se+(ke-Se)*ae;ye=fe+O*D[2]+z*D[1]+A*D[0],N.values[ye]=me+(re-me)*B}}}else for(let H=0;H<b;++H){const Y=b>1?$*(p-1)+H*X:.5*($+F)*(p-1);if(Y<0||Y>p-1){for(let U=0;U<x;U++){const J=U+H*D[2]+z*D[1]+A*D[0];N.values[J]=u}continue}const B=Math.round(Y),O=Math.round(K);for(let U=0;U<x;U++){const J=U+B*E[2]+O*E[1]+W*E[0],se=U+H*D[2]+z*D[1]+A*D[0];N.values[se]=T[J]}}}}return n.makeTensorInfo(N.shape,N.dtype,N.values)}const u6e={kernelName:CN,backendName:"cpu",kernelFunc:c6e};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d6e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,exclusive:i,reverse:l}=s;Ot(r,"cumprod");const c=Os([a],r.shape.length);let u=r;c!=null&&(u=Ka({inputs:{x:r},backend:n,attrs:{perm:c}}));const h=Hs(1,r.shape.length)[0];if(h!==u.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${h}`);const f=Va(u.dtype,"int32"),p=fN(ze(u.shape),f),x=n.data.get(u.dataId).values,y=u.shape[u.shape.length-1],v=l?(N,S)=>N+y-S-1:(N,S)=>N+S;for(let N=0;N<x.length;N+=y)for(let S=0;S<y;S++){const k=v(N,S);if(S===0)p[k]=i?1:x[k];else{const T=v(N,S-1);p[k]=i?x[T]*p[T]:x[k]*p[T]}}const b=n.makeTensorInfo(u.shape,f,p);if(c!=null){const N=dd(c),S=Ka({inputs:{x:b},backend:n,attrs:{perm:N}});return n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(u),S}return b}const h6e={kernelName:kN,backendName:"cpu",kernelFunc:d6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m6e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,exclusive:i,reverse:l}=s;Ot(r,"cumsum");const c=Os([a],r.shape.length);let u=r;c!=null&&(u=Ka({inputs:{x:r},backend:n,attrs:{perm:c}}));const h=Hs(1,r.shape.length)[0];if(h!==u.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${u.shape.length-1} but got axis=${h}`);const f=Va(u.dtype,"int32"),p=Gr(ze(u.shape),f),x=n.data.get(u.dataId).values,y=u.shape[u.shape.length-1],v=l?(N,S)=>N+y-S-1:(N,S)=>N+S;for(let N=0;N<x.length;N+=y)for(let S=0;S<y;S++){const k=v(N,S);if(S===0)p[k]=i?0:x[k];else{const T=v(N,S-1);p[k]=i?x[T]+p[T]:x[k]+p[T]}}const b=n.makeTensorInfo(u.shape,f,p);if(c!=null){const N=dd(c),S=Ka({inputs:{x:b},backend:n,attrs:{perm:N}});return n.disposeIntermediateTensorInfo(b),n.disposeIntermediateTensorInfo(u),S}return b}const f6e={kernelName:ry,backendName:"cpu",kernelFunc:m6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p6e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:a}=e,{size:i,binaryOutput:l}=s;if(r.shape.length===1){const c=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,h=TR(c,u,a.dtype,a.shape,i);return n.makeTensorInfo([i],a.dtype,h)}else if(r.shape.length===2){const c=n.bufferSync(r),u=n.bufferSync(a),h=oY(c,u,i,l);return n.makeTensorInfo(h.shape,a.dtype,h.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const g6e={kernelName:TN,backendName:"cpu",kernelFunc:p6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x6e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:a,dataFormat:i}=s;Z(i==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${i}`);const l=r.shape[0],c=r.shape[1],u=r.shape[2],h=r.shape[3],f=c*a,p=u*a,x=h/(a*a),y=n.data.get(r.dataId).values,v=new Float32Array(l*f*p*x);let b=0;for(let N=0;N<l;++N)for(let S=0;S<f;++S){const k=Math.floor(S/a),T=S%a;for(let E=0;E<p;++E){const D=Math.floor(E/a),A=E%a,I=(T*a+A)*x;for(let P=0;P<x;++P){const R=P+I+h*(D+u*(k+c*N));v[b++]=y[R]}}}return n.makeTensorInfo([l,f,p,x],r.dtype,v)}const y6e={kernelName:_N,backendName:"cpu",kernelFunc:x6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cQ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a}=e,{strides:i,pad:l,dilations:c,dimRoundingMode:u}=s;Ot([r,a],"depthwiseConv2DNative");const h=Ut(r.shape),f=Ut(a.shape);let p=c;p==null&&(p=[1,1]),Z(Zr(i,p),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${p}'`);const x=Or(r.shape,a.shape,i,p,l,u,!0),{filterHeight:y,filterWidth:v,dilationHeight:b,dilationWidth:N,padInfo:S}=x,k=S.left,T=S.top,E=x.outChannels/x.inChannels,D=new tr(x.outShape,r.dtype),A=n.data.get(r.dataId).values,I=n.data.get(a.dataId).values,P=D.values;for(let $=0;$<x.batchSize;++$){const R=$*h[0],F=$*D.strides[0];for(let W=0;W<x.outHeight;++W){const q=F+W*D.strides[1],X=W*x.strideHeight-T;for(let z=0;z<y;++z){const K=X+z*b;if(K<0||K>=x.inHeight)continue;const H=z*f[0],Y=R+K*h[1];for(let B=0;B<x.outWidth;++B){const O=q+B*D.strides[2],U=B*x.strideWidth-k;for(let J=0;J<v;++J){const se=U+J*N;if(se<0||se>=x.inWidth)continue;const ae=H+J*f[1],fe=Y+se*x.inChannels;let ye=O,Te=ae;for(let oe=0;oe<x.inChannels;++oe){const Se=A[fe+oe];for(let ke=0;ke<E;++ke)P[ye+ke]+=Se*I[Te+ke];ye+=E,Te+=E}}}}}}return n.makeTensorInfo(D.shape,D.dtype,D.values)}const b6e={kernelName:ay,backendName:"cpu",kernelFunc:cQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v6e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:a}=e,{strides:i,dilations:l,pad:c,dimRoundingMode:u,filterShape:h}=s;Ot([r,a],"depthwiseConv2dNativeBackpropFilter");const f=Or(r.shape,h,i,l,c,u,!0),{strideHeight:p,strideWidth:x,filterHeight:y,filterWidth:v}=f,b=new tr(f.filterShape,"float32"),N=f.padInfo.left,S=f.padInfo.top,k=f.outChannels/f.inChannels,T=n.data.get(r.dataId).values,E=new tr(r.shape,r.dtype,T),D=n.data.get(a.dataId).values,A=new tr(a.shape,a.dtype,D);for(let I=0;I<y;++I){const P=Math.max(0,Math.ceil((S-I)/p)),$=Math.min(f.outHeight,(f.inHeight+S-I)/p);for(let R=0;R<v;++R){const F=Math.max(0,Math.ceil((N-R)/x)),W=Math.min(f.outWidth,(f.inWidth+N-R)/x);for(let q=0;q<f.outChannels;++q){const X=Math.trunc(q/k),z=q%k;let K=0;for(let H=0;H<f.batchSize;++H)for(let Y=P;Y<$;++Y){const B=I+Y*p-S;for(let O=F;O<W;++O){const U=R+O*x-N;K+=E.get(H,B,U,X)*A.get(H,Y,O,q)}}b.set(K,I,R,X,z)}}}return n.makeTensorInfo(b.shape,b.dtype,b.values)}const w6e={kernelName:EN,backendName:"cpu",kernelFunc:v6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N6e(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:a}=e,{strides:i,dilations:l,pad:c,dimRoundingMode:u,inputShape:h}=s;Ot([r,a],"depthwiseConv2DNativeBackpropInput");const f=Ut(r.shape),p=Ut(a.shape),x=Or(h,a.shape,i,l,c,u,!0),y=new tr(x.inShape,"float32"),v=y.values,[b,N,S]=y.strides,k=n.data.get(r.dataId).values,[T,E,D]=f,A=n.data.get(a.dataId).values,[I,P,$]=p,{batchSize:R,filterHeight:F,filterWidth:W,inChannels:q,inHeight:X,inWidth:z,outChannels:K,outHeight:H,outWidth:Y,strideHeight:B,strideWidth:O}=x,U=F-1-x.padInfo.top,J=W-1-x.padInfo.left,se=K/q;for(let ae=0;ae<R;++ae)for(let fe=0;fe<q;++fe)for(let ye=0;ye<X;++ye){const Te=ye-U,oe=Math.max(0,Math.ceil(Te/B)),Se=Math.min(H,(F+Te)/B);for(let ke=0;ke<z;++ke){const me=ke-J,re=Math.max(0,Math.ceil(me/O)),je=Math.min(Y,(W+me)/O);let ie=0;for(let Re=oe;Re<Se;++Re){const Ve=Re*B-Te;for(let Ze=re;Ze<je;++Ze){const bt=Ze*O-me,tt=T*ae+E*Re+D*Ze,St=I*(F-1-Ve)+P*(W-1-bt)+$*fe;for(let mt=0;mt<se;++mt){const jt=fe*se+mt,Oe=k[tt+jt],ht=A[St+mt];ie+=Oe*ht}}}v[b*ae+N*ye+S*ke+fe]=ie}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const S6e={kernelName:AN,backendName:"cpu",kernelFunc:N6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j6e(t){const{inputs:e,backend:n}=t,{x:s}=e,r=ze(s.shape),a=n.data.get(s.dataId).values,i=on([r,r],s.dtype),l=i.values;for(let u=0;u<a.length;u++)l[u*r+u]=a[u];const c=[...s.shape,...s.shape];return n.makeTensorInfo(c,i.dtype,i.values)}const k6e={kernelName:$N,backendName:"cpu",kernelFunc:j6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C6e={kernelName:iy,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r}=t,{strides:a,pad:i,dilations:l}=n,c=e,u=c.data.get(s.dataId).values,h=s.shape.length,f=c.data.get(r.dataId).values,p=r.shape.length,{batchSize:x,inHeight:y,inWidth:v,inChannels:b,outHeight:N,outWidth:S,padInfo:k,strideHeight:T,strideWidth:E,filterHeight:D,filterWidth:A,dilationHeight:I,dilationWidth:P,outShape:$}=Xy(s.shape,r.shape,a,i,"NHWC",l),R=ze($),F=$.length,W=Ms(s.dtype,R);for(let X=0;X<x;++X)for(let z=0;z<N;++z){const K=z*T-k.top;for(let H=0;H<S;++H){const Y=H*E-k.left;for(let B=0;B<b;++B){let O=Number.MIN_SAFE_INTEGER;for(let J=0;J<D;++J){const se=K+J*I;if(se>=0&&se<y)for(let ae=0;ae<A;++ae){const fe=Y+ae*P;if(fe>=0&&fe<v){const ye=sl([X,se,fe,B],h,Ut(s.shape)),Te=sl([J,ae,B],p,Ut(r.shape)),oe=u[ye]+f[Te];oe>O&&(O=oe)}}}const U=sl([X,z,H,B],F,Ut($));W[U]=O}}}return{dataId:c.write(ld(W,s.dtype),$,s.dtype),shape:$,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T6e={kernelName:Kw,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:a}=t,{strides:i,pad:l,dilations:c}=n,u=e,h=qi(s.shape,u.data.get(s.dataId).values),f=qi(r.shape,u.data.get(r.dataId).values),{batchSize:p,inHeight:x,inWidth:y,inChannels:v,outHeight:b,outWidth:N,padInfo:S,strideHeight:k,strideWidth:T,filterHeight:E,filterWidth:D,dilationHeight:A,dilationWidth:I,outShape:P}=Xy(s.shape,r.shape,i,l,"NHWC",c);Z(a.rank===P.length,()=>`Error in ${Kw}, dy must have the same rank as output ${P.length}, but got ${a.rank}`);const $=qi(P,u.data.get(a.dataId).values),R=GA(r.shape,r.dtype);for(let W=0;W<p;++W)for(let q=0;q<b;++q){const X=q*k-S.top;for(let z=0;z<N;++z){const K=z*T-S.left;for(let H=0;H<v;++H){let Y=Number.MIN_SAFE_INTEGER,B=0,O=0;for(let U=0;U<E;++U){const J=X+U*A;if(J>=0&&J<x)for(let se=0;se<D;++se){const ae=K+se*I;if(ae>=0&&ae<y){const fe=h[W][J][ae][H]+f[U][se][H];fe>Y&&(Y=fe,B=U,O=se)}}}R[B][O][H]+=$[W][q][z][H]}}}return{dataId:u.write(ld(R,s.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _6e={kernelName:qw,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:a}=t,{strides:i,pad:l,dilations:c}=n,u=e,h=qi(s.shape,u.data.get(s.dataId).values),f=qi(r.shape,u.data.get(r.dataId).values),{batchSize:p,inHeight:x,inWidth:y,inChannels:v,outHeight:b,outWidth:N,padInfo:S,strideHeight:k,strideWidth:T,filterHeight:E,filterWidth:D,dilationHeight:A,dilationWidth:I,outShape:P}=Xy(s.shape,r.shape,i,l,"NHWC",c);Z(a.rank===P.length,()=>`Error in ${qw}, dy must have the same rank as output ${P.length}, but got ${a.rank}`);const $=qi(P,u.data.get(a.dataId).values),R=GA(s.shape,s.dtype);for(let W=0;W<p;++W)for(let q=0;q<b;++q){const X=q*k-S.top;for(let z=0;z<N;++z){const K=z*T-S.left;for(let H=0;H<v;++H){let Y=Number.MIN_SAFE_INTEGER,B=X<0?0:X,O=K<0?0:K;for(let U=0;U<E;++U){const J=X+U*A;if(J>=0&&J<x)for(let se=0;se<D;++se){const ae=K+se*I;if(ae>=0&&ae<y){const fe=h[W][J][ae][H]+f[U][se][H];fe>Y&&(Y=fe,B=J,O=ae)}}}R[W][B][O][H]+=$[W][q][z][H]}}}return{dataId:u.write(ld(R,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E6e(t){const{inputs:e,backend:n,attrs:s}=t,{image:r}=e,{canvas:a,options:i}=s,{contextOptions:l,imageOptions:c}=i||{},u=(c==null?void 0:c.alpha)||1,h=(l==null?void 0:l.contextType)||"2d";if(h!=="2d")throw new Error(`Context type ${l.contextType} is not supported by the CPU backend.`);const f=a.getContext(h,(l==null?void 0:l.contextAttributes)||{});if(f==null)throw new Error(`Could not get the context with ${h} type.`);const[p,x]=r.shape.slice(0,2),y=r.shape.length===2?1:r.shape[2],v=n.data.get(r.dataId).values,b=r.dtype==="float32"?255:1,N=new Uint8ClampedArray(x*p*4);for(let k=0;k<p*x;++k){const T=[0,0,0,255*u];for(let D=0;D<y;D++){const A=v[k*y+D];if(r.dtype==="float32"){if(A<0||A>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${A}.`)}else if(r.dtype==="int32"&&(A<0||A>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${A}.`);y===1?(T[0]=A*b,T[1]=A*b,T[2]=A*b):T[D]=A*b}const E=k*4;N[E+0]=Math.round(T[0]),N[E+1]=Math.round(T[1]),N[E+2]=Math.round(T[2]),N[E+3]=Math.round(T[3])}a.width=x,a.height=p;const S=new ImageData(N,x,p);return f.putImageData(S,0,0),r}const A6e={kernelName:IN,backendName:"cpu",kernelFunc:E6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cb(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:i}=s;Ot(r,"sum");let l;r.dtype==="bool"?l=rd({inputs:{x:r},backend:n,attrs:{dtype:"int32"}}):l=Wl({inputs:{x:r},backend:n});const c=l.shape.length,u=fn(a,l.shape),h=Os(u,c);let f=u,p=l;h!=null&&(p=Ka({inputs:{x:l},backend:n,attrs:{perm:h}}),f=Hs(f.length,c)),Jr("sum",f,p.shape.length);const[x,y]=Dr(p.shape,f),v=Va(p.dtype,"int32");let b=h2(n,x,v);const N=ze(y),S=n.data.get(b.dataId).values,k=n.data.get(p.dataId).values;for(let T=0;T<S.length;++T){const E=T*N;let D=0;for(let A=0;A<N;++A)D+=k[E+A];S[T]=D}if(i){const T=Ws(b.shape,u),E=b;b=xs({inputs:{x:b},backend:n,attrs:{shape:T}}),n.disposeIntermediateTensorInfo(E)}return n.disposeIntermediateTensorInfo(l),h!=null&&n.disposeIntermediateTensorInfo(p),b}const $6e={kernelName:Fy,backendName:"cpu",kernelFunc:Cb};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I6e(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,a=e,{allDims:i,summedDims:l,idDims:c}=MI(r,a.length);zI(i.length,c,a);const{path:u,steps:h}=BI(l,c),f=h.length;let p=null,x=i.length;const y=[];for(let v=0;v<f;++v){for(const b of h[v]){const{permutationIndices:N,expandDims:S}=FI(x,c[b]);let k;UI(N)?k=a[b]:(k=Ka({inputs:{x:a[b]},backend:n,attrs:{perm:N}}),y.push(k));const T=k.shape.slice();for(let E=0;E<S.length;++E)T.splice(S[E],0,1);xn(k.shape,T)||(k=xs({inputs:{x:k},backend:n,attrs:{shape:T}}),y.push(k)),p===null?p=k:(p=$j({inputs:{a:k,b:p},backend:n}),y.push(p))}v<f-1&&(u[v]>=0&&(p=Cb({inputs:{x:p},backend:n,attrs:{axis:u[v]-(i.length-x),keepDims:!1}}),y.push(p)),x--)}for(const v of y)v!==p&&n.disposeIntermediateTensorInfo(v);return p}const R6e={kernelName:RN,backendName:"cpu",kernelFunc:I6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O6e(t){const{inputs:e,backend:n}=t,{dy:s,y:r}=e;Ot([s,r],"eluGrad");const a=new Float32Array(ze(r.shape)),i=n.data.get(r.dataId).values,l=n.data.get(s.dataId).values;for(let c=0;c<i.length;++c){const u=i[c];u>=0?a[c]=l[c]:a[c]=l[c]*(u+1)}return n.makeTensorInfo(r.shape,"float32",a)}const D6e={kernelName:ON,backendName:"cpu",kernelFunc:O6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P6e=$I,L6e=II,M6e=RI,F6e=OI,z6e=DI,B6e=PI,U6e=Gn(sp,t=>{const e=Math.sign(t),n=Math.abs(t),s=1/(1+P6e*n);return e*(1-((((B6e*s+z6e)*s+F6e)*s+M6e)*s+L6e)*s*Math.exp(-n*n))}),V6e={kernelName:sp,backendName:"cpu",kernelFunc:U6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p2(t){const{inputs:e,backend:n,attrs:s}=t,{input:r}=e,{dim:a}=s,i=r.shape.length,l=r.shape.slice();let c=a;return a<0&&(Z(-(i+1)<=a,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),c=i+a+1),l.splice(c,0,1),xs({inputs:{x:r},backend:n,attrs:{shape:l}})}const W6e={kernelName:ly,backendName:"cpu",kernelFunc:p2};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H6e=qs((t,e)=>t/e),RR=br(tp,H6e),PE={kernelName:tp,backendName:"cpu",kernelFunc:RR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uQ(t,e,n){const s=t.shape,r=s[0],a=s[1],i=n.data.get(t.dataId),l=i.complexTensorInfos.real,c=i.complexTensorInfos.imag,u=[r,a],h=ze(u),f=Er("float32",h),p=Er("float32",h);for(let b=0;b<r;b++){const N=Oh({inputs:{x:l},backend:n,attrs:{begin:[b,0],size:[1,a]}}),S=Oh({inputs:{x:c},backend:n,attrs:{begin:[b,0],size:[1,a]}}),k=ui({inputs:{real:N,imag:S},backend:n}),{real:T,imag:E}=G6e(k,e,n),D=Mc(T,E);for(let A=0;A<a;A++){const I=LI(D,A);f[b*a+A]=I.real,p[b*a+A]=I.imag}n.disposeIntermediateTensorInfo(N),n.disposeIntermediateTensorInfo(S),n.disposeIntermediateTensorInfo(k)}const x=n.makeTensorInfo(u,"float32",f),y=n.makeTensorInfo(u,"float32",p),v=ui({inputs:{real:x,imag:y},backend:n});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(y),v}function G6e(t,e,n){const s=ze(t.shape),r=n.data.get(t.dataId),a=n.data.get(r.complexTensorInfos.real.dataId).values,i=n.data.get(r.complexTensorInfos.imag.dataId).values;if(q6e(s)){const l=LE(a,i,s,e,n),c=[t.shape[0],t.shape[1]];if(e){const u=n.makeTensorInfo(c,"float32",l.real),h=n.makeTensorInfo(c,"float32",l.imag),f=n.makeTensorInfo([],"float32",Yc(s,"float32")),p=Wl({inputs:{x:f},backend:n}),x=PE.kernelFunc({inputs:{a:u,b:f},backend:n}),y=PE.kernelFunc({inputs:{a:h,b:p},backend:n}),v=n.data.get(x.dataId).values,b=n.data.get(y.dataId).values;return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(y),{real:v,imag:b}}return l}else{const l=Mc(a,i),c=K6e(l,s,e);return Jq(c)}}function q6e(t){return(t&t-1)===0}function LE(t,e,n,s,r){if(n===1)return{real:t,imag:e};const a=Mc(t,e),i=n/2,l=eK(a),c=l.real,u=l.imag,h=[c.length],f=r.makeTensorInfo(h,"float32",c),p=r.makeTensorInfo(h,"float32",u),x=ui({inputs:{real:f,imag:p},backend:r}),y=tK(a),v=y.real,b=y.imag,N=[v.length],S=r.makeTensorInfo(N,"float32",v),k=r.makeTensorInfo(N,"float32",b),T=ui({inputs:{real:S,imag:k},backend:r}),E=LE(c,u,i,s,r),D=E.real,A=E.imag,I=[D.length],P=r.makeTensorInfo(I,"float32",D),$=r.makeTensorInfo(I,"float32",A),R=ui({inputs:{real:P,imag:$},backend:r}),F=LE(v,b,i,s,r),W=F.real,q=F.imag,X=[W.length],z=r.makeTensorInfo(X,"float32",W),K=r.makeTensorInfo(X,"float32",q),H=ui({inputs:{real:z,imag:K},backend:r}),Y=sK(n,s),B=[Y.real.length],O=r.makeTensorInfo(B,"float32",Y.real),U=r.makeTensorInfo(B,"float32",Y.imag),J=ui({inputs:{real:O,imag:U},backend:r}),se=$j({inputs:{a:J,b:H},backend:r}),ae=jf({inputs:{a:R,b:se},backend:r}),fe=$R({inputs:{a:R,b:se},backend:r}),ye=Rh({inputs:{input:ae},backend:r}),Te=Rh({inputs:{input:fe},backend:r}),oe=kf({inputs:{input:ae},backend:r}),Se=kf({inputs:{input:fe},backend:r}),ke=Cf({inputs:[ye,Te],backend:r,attrs:{axis:0}}),me=Cf({inputs:[oe,Se],backend:r,attrs:{axis:0}}),re=r.data.get(ke.dataId).values,je=r.data.get(me.dataId).values;return r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(p),r.disposeIntermediateTensorInfo(x),r.disposeIntermediateTensorInfo(S),r.disposeIntermediateTensorInfo(k),r.disposeIntermediateTensorInfo(T),r.disposeIntermediateTensorInfo(P),r.disposeIntermediateTensorInfo($),r.disposeIntermediateTensorInfo(R),r.disposeIntermediateTensorInfo(z),r.disposeIntermediateTensorInfo(K),r.disposeIntermediateTensorInfo(H),r.disposeIntermediateTensorInfo(O),r.disposeIntermediateTensorInfo(U),r.disposeIntermediateTensorInfo(J),r.disposeIntermediateTensorInfo(se),r.disposeIntermediateTensorInfo(ae),r.disposeIntermediateTensorInfo(fe),r.disposeIntermediateTensorInfo(ye),r.disposeIntermediateTensorInfo(oe),r.disposeIntermediateTensorInfo(Te),r.disposeIntermediateTensorInfo(Se),r.disposeIntermediateTensorInfo(ke),r.disposeIntermediateTensorInfo(me),{real:re,imag:je}}function K6e(t,e,n){const s=new Float32Array(e*2);for(let r=0;r<e;r++){let a=0,i=0;for(let l=0;l<e;l++){const c=rK(r*l,e,n),u=LI(t,l);a+=u.real*c.real-u.imag*c.imag,i+=u.real*c.imag+u.imag*c.real}n&&(a/=e,i/=e),nK(s,a,i,r)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X6e(t){const{inputs:e,backend:n}=t,{input:s}=e,r=ze(s.shape),a=s.shape[s.shape.length-1],i=r/a,l=xs({inputs:{x:s},backend:n,attrs:{shape:[i,a]}}),c=uQ(l,!1,n),u=xs({inputs:{x:c},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(c),u}const Y6e={kernelName:DN,backendName:"cpu",kernelFunc:X6e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OR(t){const{backend:e,attrs:n}=t,{shape:s,value:r,dtype:a}=n,i=a||Wh(r),l=Ms(i,ze(s));return Z6e(l,r,i),e.makeTensorInfo(s,i,l)}const Q6e={kernelName:PN,backendName:"cpu",kernelFunc:OR};function Z6e(t,e,n){t.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J6e={kernelName:LN,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,r=n,a=Er(s.dtype,ze(s.shape)),[i,l,c,u]=s.shape,h=r.data.get(s.dataId).values;for(let p=0;p<i;p++){const x=p*c*l*u;for(let y=0;y<l;y++){const v=y*(c*u);for(let b=0;b<c;b++){const N=b*u;for(let S=0;S<u;S++){const k=Math.round(c-b-1),T=x+v+N+S;let E=h[T];if(k>=0&&k<c){const D=k*u,A=x+v+D+S;E=h[A]}a[T]=E}}}}return{dataId:r.write(a,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ePe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a,bias:i,preluActivationWeights:l}=e,{strides:c,pad:u,dataFormat:h,dilations:f,dimRoundingMode:p,activation:x,leakyreluAlpha:y}=s;let v=lQ({inputs:{x:r,filter:a},backend:n,attrs:{strides:c,pad:u,dataFormat:h,dilations:f,dimRoundingMode:p}});if(i){const b=v;if(h==="NCHW"&&i.shape.length===1&&i.shape[0]!==1){const N=xs({inputs:{x:i},backend:n,attrs:{shape:[i.shape[0],1,1]}});v=jf({inputs:{a:v,b:N},backend:n}),n.disposeIntermediateTensorInfo(N)}else v=jf({inputs:{a:v,b:i},backend:n});n.disposeIntermediateTensorInfo(b)}if(x){const b=v;if(h==="NCHW"&&x==="prelu"&&l.shape.length===1&&l.shape[0]!==1){const N=xs({inputs:{x:l},backend:n,attrs:{shape:[l.shape[0],1,1]}});v=f2(n,v,x,N,y),n.disposeIntermediateTensorInfo(N)}else v=f2(n,v,x,l,y);n.disposeIntermediateTensorInfo(b)}return v}const tPe={kernelName:tx,backendName:"cpu",kernelFunc:ePe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nPe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a,bias:i,preluActivationWeights:l}=e,{strides:c,pad:u,dataFormat:h,dilations:f,dimRoundingMode:p,activation:x,leakyreluAlpha:y}=s;let v=cQ({inputs:{x:r,filter:a},backend:n,attrs:{strides:c,pad:u,dataFormat:h,dilations:f,dimRoundingMode:p}});if(i){const b=v;v=jf({inputs:{a:v,b:i},backend:n}),n.disposeIntermediateTensorInfo(b)}if(x){const b=v;v=f2(n,v,x,l,y),n.disposeIntermediateTensorInfo(b)}return v}const sPe={kernelName:nx,backendName:"cpu",kernelFunc:nPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rPe(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,a=ze(s.shape),i=r.shape,l=i[i.length-1],[c,u,h,f]=aj(s,r);if(u===0)return n.makeTensorInfo(c,s.dtype,[]);const p=n.data.get(r.dataId).values,x=n.bufferSync(s),y=yY(p,x,s.dtype,u,l,h,f,s.shape,a);return n.makeTensorInfo(c,s.dtype,y.values)}const aPe={kernelName:MN,backendName:"cpu",kernelFunc:rPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iPe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:a}=e,{axis:i,batchDims:l}=s;Ot([r,a],"gatherV2");const c=fn(i,r.shape)[0],u=n.data.get(a.dataId).values,h=r.shape[c];for(let T=0;T<u.length;++T){const E=u[T];Z(E<=h-1&&E>=0,()=>`GatherV2: the index value ${E} is not in [0, ${h-1}]`)}let f=l;l==null&&(f=0);const p=ze(a.shape),x=WI(r,a,c,f),y=xs({inputs:{x:r},backend:n,attrs:{shape:[x.batchSize,x.outerSize,x.dimSize,x.sliceSize]}}),v=xs({inputs:{x:a},backend:n,attrs:{shape:[x.batchSize,p/x.batchSize]}}),b=[x.batchSize,x.outerSize,p/x.batchSize,x.sliceSize],N=n.bufferSync(v),S=n.bufferSync(y),k=bY(S,N,b);return n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(v),n.makeTensorInfo(x.outputShape,k.dtype,k.values)}const oPe={kernelName:uy,backendName:"cpu",kernelFunc:iPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lPe(t){const{inputs:e,backend:n}=t,{input:s}=e,r=ze(s.shape),a=s.shape[s.shape.length-1],i=r/a,l=xs({inputs:{x:s},backend:n,attrs:{shape:[i,a]}}),c=uQ(l,!0,n),u=xs({inputs:{x:c},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(c),u}const cPe={kernelName:FN,backendName:"cpu",kernelFunc:lPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uPe=Gn(up,t=>Number.isFinite(t)?1:0,"bool"),dPe={kernelName:up,backendName:"cpu",kernelFunc:uPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hPe=Gn(dp,t=>Math.abs(t)===1/0?1:0,"bool"),mPe={kernelName:dp,backendName:"cpu",kernelFunc:hPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fPe=Gn(hp,t=>Number.isNaN(t)?1:0,"bool"),pPe={kernelName:hp,backendName:"cpu",kernelFunc:fPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gPe(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:a}=n,i=jY(s,r,a);return e.makeTensorInfo([i.length],"float32",i)}const xPe={kernelName:BN,backendName:"cpu",kernelFunc:gPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yPe=Gn(fp,t=>Math.log1p(t)),bPe={kernelName:fp,backendName:"cpu",kernelFunc:yPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vPe=qs((t,e)=>t&&e),wPe=br(py,vPe,null,"bool"),NPe={kernelName:py,backendName:"cpu",kernelFunc:wPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SPe=Gn(gy,t=>t?0:1,"bool"),jPe={kernelName:gy,backendName:"cpu",kernelFunc:SPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kPe=qs((t,e)=>t||e),CPe=br(xy,kPe,null,"bool"),TPe={kernelName:xy,backendName:"cpu",kernelFunc:CPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Pe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:a,bias:i,alpha:l,beta:c}=s;Ot(r,"LRN");const u=r.shape[3],h=u-1,f=n.data.get(r.dataId).values,p=ze(r.shape),x=new Float32Array(p);function y(v){const b=v%u;let N=v-b+Math.max(0,b-a);const S=v-b+Math.min(b+a,h);let k=0;for(;N<=S;N++){const T=f[N];k+=T*T}return k}for(let v=0;v<p;v++){const b=y(v),N=f[v]*Math.pow(i+l*b,-c);x[v]=N}return n.makeTensorInfo(r.shape,r.dtype,x)}const EPe={kernelName:yy,backendName:"cpu",kernelFunc:_Pe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function APe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,y:a,dy:i}=e,{depthRadius:l,bias:c,alpha:u,beta:h}=s;Ot(i,"LRNGrad");const f=ze(i.shape),p=i.shape[3],x=n.data.get(i.dataId).values,y=n.data.get(r.dataId).values,v=n.data.get(a.dataId).values,b=new Float32Array(f),N=f;for(let S=0;S<N;S++){const k=S%p,T=S-k+Math.max(0,k-l),E=S-k+Math.min(p,k+l+1);let D=0;for(let A=T;A<E;A++)D+=Math.pow(y[A],2);D=u*D+c;for(let A=T;A<E;A++){let I=-2*u*h*y[A]*v[S]/D;S===A&&(I+=Math.pow(D,-h)),I*=x[S],b[A]+=I}}return n.makeTensorInfo(i.shape,r.dtype,b)}const $Pe={kernelName:UN,backendName:"cpu",kernelFunc:APe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dQ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:a,keepDims:i}=s,l=n;let c=r.shape;const u=c.length,h=fn(a,c);let f=h;const p=Os(f,u);let x=l.data.get(r.dataId).values;if(p!=null){const T=new Array(u);for(let E=0;E<T.length;E++)T[E]=c[p[E]];x=ER(x,c,r.dtype,p,T),f=Hs(f.length,u),c=T}Ot(r,"max"),Jr("max",f,u);const[y,v]=Dr(c,f),b=ze(v),N=CY(x,b,y,r.dtype),S=l.write(N,y,r.dtype);let k=y;return i&&(k=Ws(y,h)),{dataId:S,shape:k,dtype:r.dtype}}const IPe={kernelName:by,backendName:"cpu",kernelFunc:dQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RPe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Ot(r,"maxPool");const{filterSize:a,strides:i,pad:l,dimRoundingMode:c}=s,u=1;Z(Zr(i,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const h=Po(r.shape,a,i,u,l,c);let f;if(h.filterWidth===1&&h.filterHeight===1&&xn(h.inShape,h.outShape))f=Wl({inputs:{x:r},backend:n});else{const p=n.data.get(r.dataId).values,x=Ut(r.shape),y=IR(p,r.shape,r.dtype,x,h,"max");f=n.makeTensorInfo(h.outShape,r.dtype,y.values)}return f}const OPe={kernelName:vy,backendName:"cpu",kernelFunc:RPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DPe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:a,strides:i,pad:l,dimRoundingMode:c,dataFormat:u}=s;Ot(r,"maxPool3d");const h=Qc(r.shape,a,i,1,l,c,u),f=n.data.get(r.dataId).values,p=oQ(f,r.shape,r.dtype,Ut(r.shape),h,"max");return n.makeTensorInfo(p.shape,"float32",p.values)}const PPe={kernelName:wy,backendName:"cpu",kernelFunc:DPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LPe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:a}=e,{filterSize:i,strides:l,pad:c,dimRoundingMode:u}=s;Ot([r,a],"maxPool3DGrad");const h=Qc(a.shape,i,l,1,c,u),f=n.bufferSync(a),p=kDe(f,h),x=h.strideDepth,y=h.strideHeight,v=h.strideWidth,b=h.dilationDepth,N=h.dilationHeight,S=h.dilationWidth,k=h.effectiveFilterDepth,T=h.effectiveFilterHeight,E=h.effectiveFilterWidth,D=k-1-h.padInfo.front,A=E-1-h.padInfo.left,I=T-1-h.padInfo.top,P=on(a.shape,"float32"),$=n.bufferSync(r);for(let R=0;R<h.batchSize;++R)for(let F=0;F<h.inChannels;++F)for(let W=0;W<h.inDepth;++W)for(let q=0;q<h.inHeight;++q)for(let X=0;X<h.inWidth;++X){const z=W-D,K=q-I,H=X-A;let Y=0;for(let B=0;B<k;B+=b){const O=(z+B)/x;if(!(O<0||O>=h.outDepth||Math.floor(O)!==O))for(let U=0;U<T;U+=N){const J=(K+U)/y;if(!(J<0||J>=h.outHeight||Math.floor(J)!==J))for(let se=0;se<E;se+=S){const ae=(H+se)/v;if(ae<0||ae>=h.outWidth||Math.floor(ae)!==ae)continue;const fe=k*T*E-1-p.get(R,O,J,ae,F),ye=B*T*E+U*E+se,Te=fe===ye?1:0;if(Te===0)continue;const oe=$.get(R,O,J,ae,F);Y+=oe*Te}}}P.set(Y,R,W,q,X,F)}return n.makeTensorInfo(P.shape,P.dtype,P.values)}const MPe={kernelName:WN,backendName:"cpu",kernelFunc:LPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FPe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:a,output:i}=e,l=a;Ot([a,i],"maxPoolGrad");const{filterSize:c,strides:u,pad:h,dimRoundingMode:f}=s,p=Po(l.shape,c,u,1,h,f),x=n.data.get(l.dataId).values,y=on(p.outShape,l.dtype,iQ(x,l.shape,l.dtype,p).values),v=p.strideHeight,b=p.strideWidth,N=p.dilationHeight,S=p.dilationWidth,k=p.effectiveFilterHeight,T=p.effectiveFilterWidth,E=T-1-p.padInfo.left,D=k-1-p.padInfo.top,A=on(l.shape,"float32"),I=n.data.get(r.dataId).values,P=on(r.shape,"float32",I);for(let $=0;$<p.batchSize;++$)for(let R=0;R<p.inChannels;++R)for(let F=0;F<p.inHeight;++F)for(let W=0;W<p.inWidth;++W){const q=F-D,X=W-E;let z=0;for(let K=0;K<k;K+=N){const H=(q+K)/v;if(!(H<0||H>=p.outHeight||Math.floor(H)!==H))for(let Y=0;Y<T;Y+=S){const B=(X+Y)/b;if(B<0||B>=p.outWidth||Math.floor(B)!==B)continue;const O=k*T-1-y.get($,H,B,R),U=K*T+Y,J=O===U?1:0;if(J===0)continue;const se=P.get($,H,B,R);z+=se*J}}A.set(z,$,F,W,R)}return n.makeTensorInfo(A.shape,A.dtype,A.values)}const zPe={kernelName:VN,backendName:"cpu",kernelFunc:FPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BPe(t,e,n,s,r){const a=Ut(e),i=IR(t,e,n,a,r,"max"),l=iQ(t,e,n,r,!0,s);return[i.values,l.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UPe={kernelName:HN,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:a,pad:i,includeBatchInIndex:l}=e,c=n;Ot(s,"MaxPoolWithArgmax");const u=c.data.get(s.dataId).values,h=Po(s.shape,r,a,[1,1],i),[f,p]=BPe(u,s.shape,s.dtype,l,h),x=c.write(f,h.outShape,s.dtype),y=c.write(p,h.outShape,s.dtype);return[{dataId:x,shape:h.outShape,dtype:s.dtype},{dataId:y,shape:h.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VPe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:i}=s,l=fn(a,r.shape),u=Dr(r.shape,l)[1],h=ze(u),f=[],p=n.makeTensorInfo([],"float32",new Float32Array([h]));f.push(p);const x=rd({inputs:{x:r},backend:n,attrs:{dtype:"float32"}});f.push(x);const y=RR({inputs:{a:x,b:p},backend:n});f.push(y);const v=Cb({inputs:{x:y},backend:n,attrs:{axis:a,keepDims:i}});return f.forEach(b=>n.disposeIntermediateTensorInfo(b)),v}const WPe={kernelName:Ny,backendName:"cpu",kernelFunc:VPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HPe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:i}=s;Ot(r,"min");const l=fn(a,r.shape);let c=l;const u=Os(c,r.shape.length);let h=r;u!=null&&(h=Ka({inputs:{x:r},backend:n,attrs:{perm:u}}),c=Hs(c.length,r.shape.length)),Jr("min",c,h.shape.length);const[f,p]=Dr(h.shape,c),x=ze(p),y=Gr(ze(f),h.dtype),v=n.data.get(h.dataId).values;for(let N=0;N<y.length;++N){const S=N*x;let k=v[S];for(let T=0;T<x;++T){const E=v[S+T];(Number.isNaN(E)||E<k)&&(k=E)}y[N]=k}u!=null&&n.disposeIntermediateTensorInfo(h);const b=n.makeTensorInfo(f,h.dtype,y);if(i){const N=Ws(f,l),S=xs({inputs:{x:b},backend:n,attrs:{shape:N}});return n.disposeIntermediateTensorInfo(b),S}return b}const GPe={kernelName:Sy,backendName:"cpu",kernelFunc:HPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qPe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:a,mode:i}=s;Ot(r,"mirrorPad");const l=a.map((k,T)=>k[0]+r.shape[T]+k[1]),c=a.map(k=>k[0]),u=a.map((k,T)=>k[0]+r.shape[T]),h=i==="reflect"?0:1,f=n.data.get(r.dataId).values,p=r.shape.length,x=Ut(r.shape),y=ze(l),v=l.length,b=Ut(l),N=Er(r.dtype,y);for(let k=0;k<y;k++){let T=Hh(k,v,b);for(let D=0;D<v;D++)T[D]<c[D]?T[D]=c[D]*2-T[D]-h:T[D]>=u[D]&&(T[D]=(u[D]-1)*2-T[D]+h);T=T.map((D,A)=>D-c[A]);const E=sl(T,p,x);N[k]=f[E]}return{dataId:n.write(N,l,r.dtype),shape:l,dtype:r.dtype}}const KPe={kernelName:jy,backendName:"cpu",kernelFunc:qPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XPe=qs(((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e})),YPe=br(xp,XPe),QPe={kernelName:xp,backendName:"cpu",kernelFunc:YPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hQ(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:a}=s,i=r.shape.length;let l=a;if(l===-1&&(l=i-1),l!==i-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${i} and dim was ${l}`);const c=fn([l],r.shape),u=dQ({inputs:{x:r},backend:n,attrs:{reductionIndices:c,keepDims:!1}}),h=Ws(u.shape,c),f=xs({inputs:{x:u},backend:n,attrs:{shape:h}}),p=$R({inputs:{a:r,b:f},backend:n}),x=fY({inputs:{x:p},backend:n}),y=Cb({inputs:{x},backend:n,attrs:{axis:c,keepDims:!1}}),v=xs({inputs:{x:y},backend:n,attrs:{shape:h}}),b=RR({inputs:{a:x,b:v},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(v),b}const ZPe={kernelName:Uy,backendName:"cpu",kernelFunc:hQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JPe(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:a,seed:i,normalized:l}=s;Ot(r,"multinomial");const c=l?r:hQ({inputs:{logits:r},backend:n,attrs:{dim:-1}}),u=c.shape[0],h=c.shape[1],f=n.data.get(c.dataId).values,p=[u,a],x=Gr(ze(p),"int32");for(let y=0;y<u;++y){const v=y*h,b=new Float32Array(h-1);b[0]=f[v];for(let k=1;k<b.length;++k)b[k]=b[k-1]+f[v+k];const N=Wp.alea(i.toString()),S=y*a;for(let k=0;k<a;++k){const T=N();x[S+k]=b.length;for(let E=0;E<b.length;E++)if(T<b[E]){x[S+k]=E;break}}}return l||n.disposeIntermediateTensorInfo(c),n.makeTensorInfo(p,"int32",x)}const eLe={kernelName:GN,backendName:"cpu",kernelFunc:JPe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tLe=tj;function nLe(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:a}=e,{maxOutputSize:i,iouThreshold:l,scoreThreshold:c}=s;Ot(r,"NonMaxSuppression");const u=n.data.get(r.dataId).values,h=n.data.get(a.dataId).values,{selectedIndices:f}=tLe(u,h,i,l,c);return n.makeTensorInfo([f.length],"int32",new Int32Array(f))}const sLe={kernelName:qN,backendName:"cpu",kernelFunc:nLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rLe=nj;function aLe(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:a}=e,{maxOutputSize:i,iouThreshold:l,scoreThreshold:c,padToMaxOutputSize:u}=s;Ot(r,"NonMaxSuppressionPadded");const h=n.data.get(r.dataId).values,f=n.data.get(a.dataId).values,{selectedIndices:p,validOutputs:x}=rLe(h,f,i,l,c,u);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([x]))]}const iLe={kernelName:KN,backendName:"cpu",kernelFunc:aLe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oLe=sj;function lLe(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:a}=e,{maxOutputSize:i,iouThreshold:l,scoreThreshold:c,softNmsSigma:u}=s;Ot(r,"NonMaxSuppressionWithScore");const h=n.data.get(r.dataId).values,f=n.data.get(a.dataId).values,p=i,x=l,y=c,v=u,{selectedIndices:b,selectedScores:N}=oLe(h,f,p,x,y,v);return[n.makeTensorInfo([b.length],"int32",new Int32Array(b)),n.makeTensorInfo([N.length],"float32",new Float32Array(N))]}const cLe={kernelName:XN,backendName:"cpu",kernelFunc:lLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uLe(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:a,depth:i,onValue:l,offValue:c}=s;Ot(r,"oneHot");const u=ze(r.shape),h=new Float32Array(u*i);h.fill(c);const f=n.data.get(r.dataId).values;for(let p=0;p<u;++p)f[p]>=0&&f[p]<i&&(h[p*i+f[p]]=l);return n.makeTensorInfo([...r.shape,i],a,h)}const dLe={kernelName:_y,backendName:"cpu",kernelFunc:uLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g2(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Rh({inputs:{input:s},backend:n}),a=g2({inputs:{x:r},backend:n}),i=kf({inputs:{input:s},backend:n}),l=g2({inputs:{x:i},backend:n}),c=ui({inputs:{real:a,imag:l},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(l),c}else return OR({backend:n,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const hLe={kernelName:Gy,backendName:"cpu",kernelFunc:g2};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mQ(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const r=Rh({inputs:{input:s},backend:n}),a=mQ({inputs:{x:r},backend:n}),i=kf({inputs:{input:s},backend:n}),l=g2({inputs:{x:i},backend:n}),c=ui({inputs:{real:a,imag:l},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(l),c}else return OR({backend:n,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const mLe={kernelName:Ty,backendName:"cpu",kernelFunc:mQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fQ(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return p2({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const a=e[0].shape,i=e[0].dtype;e.forEach(h=>{Qr(a,h.shape,"All tensors passed to stack must have matching shapes"),Z(i===h.dtype,()=>"All tensors passed to stack must have matching dtypes")});const l=[],c=e.map(h=>{const f=p2({inputs:{input:h},backend:n,attrs:{dim:r}});return l.push(f),f}),u=Cf({inputs:c,backend:n,attrs:{axis:r}});return l.forEach(h=>n.disposeIntermediateTensorInfo(h)),u}const fLe={kernelName:Ey,backendName:"cpu",kernelFunc:fQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pLe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:a,constantValue:i}=s;Ot(r,"pad");const l=a.map((S,k)=>S[0]+r.shape[k]+S[1]),c=a.map(S=>S[0]),u=n.data.get(r.dataId).values,h=ze(r.shape),f=r.shape.length,p=Ut(r.shape),x=ze(l),y=l.length,v=Ut(l),b=Er(r.dtype,x);i!==0&&b.fill(i);for(let S=0;S<h;S++){const T=Hh(S,f,p).map((D,A)=>D+c[A]),E=sl(T,y,v);b[E]=u[S]}return{dataId:n.write(b,l,r.dtype),shape:l,dtype:r.dtype}}const pQ={kernelName:Ay,backendName:"cpu",kernelFunc:pLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gLe=qs((t,e)=>Math.pow(t,e)),xLe=br(bp,gLe),yLe={kernelName:bp,backendName:"cpu",kernelFunc:xLe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bLe(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:a,indices:i}=e,{outputRaggedRank:l}=s,c=r.map(N=>n.data.get(N.dataId).values),u=r.map(N=>N.shape),h=n.data.get(a.dataId).values,f=n.data.get(i.dataId).values,[p,x,y]=IY(c,u,h,a.shape,a.dtype,f,i.shape),v=p.map(N=>n.makeTensorInfo([N.length],"int32",N)),b=n.makeTensorInfo(y,a.dtype,x);return v.concat([b])}const vLe={kernelName:YN,backendName:"cpu",kernelFunc:bLe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wLe(t){const{inputs:e,backend:n}=t,{starts:s,limits:r,deltas:a}=e,i=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(a.dataId).values,[u,h]=RY(i,s.shape,s.dtype,l,r.shape,c,a.shape),f=n.makeTensorInfo([u.length],"int32",u),p=n.makeTensorInfo([h.length],s.dtype,h);return[f,p]}const NLe={kernelName:QN,backendName:"cpu",kernelFunc:wLe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SLe(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:a,defaultValue:i,rowPartitionTensors:l}=e,{rowPartitionTypes:c}=s,u=n.data.get(r.dataId).values,h=n.data.get(a.dataId).values,f=n.data.get(i.dataId).values,p=l.map(b=>n.data.get(b.dataId).values),x=l.map(b=>b.shape),[y,v]=OY(u,r.shape,h,a.shape,a.dtype,f,i.shape,p,x,c);return n.makeTensorInfo(y,a.dtype,v)}const jLe={kernelName:ZN,backendName:"cpu",kernelFunc:SLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kLe(t){const{backend:e,attrs:n}=t,{start:s,stop:r,dtype:a,step:i}=n,l=DY(s,r,i,a);return e.makeTensorInfo([l.length],a,l)}const CLe={kernelName:JN,backendName:"cpu",kernelFunc:kLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TLe=Gn(vp,t=>1/t),_Le={kernelName:vp,backendName:"cpu",kernelFunc:TLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ELe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:a,halfPixelCenters:i,size:l}=s;Ot(r,"resizeBilinear");const c=Ut(r.shape),[u,h]=l,[f,p,x,y]=r.shape,v=n.data.get(r.dataId).values,b=new Float32Array(ze([f,u,h,y])),N=[a&&u>1?p-1:p,a&&h>1?x-1:x],S=[a&&u>1?u-1:u,a&&h>1?h-1:h];let k=0;const T=N[0]/S[0],E=N[1]/S[1];for(let D=0;D<f;D++)for(let A=0;A<u;A++){let I;i?I=T*(A+.5)-.5:I=T*A;const P=Math.max(0,Math.floor(I)),$=I-P,R=Math.min(p-1,Math.ceil(I)),F=D*c[0]+P*c[1],W=D*c[0]+R*c[1];for(let q=0;q<h;q++){let X;i?X=E*(q+.5)-.5:X=E*q;const z=Math.max(0,Math.floor(X)),K=X-z,H=Math.min(x-1,Math.ceil(X)),Y=F+z*c[2],B=W+z*c[2],O=F+H*c[2],U=W+H*c[2];for(let J=0;J<y;J++){const se=v[Y+J],ae=v[B+J],fe=v[O+J],ye=v[U+J],Te=se+(fe-se)*K,oe=ae+(ye-ae)*K,Se=Te+(oe-Te)*$;b[k++]=Se}}}return n.makeTensorInfo([f,u,h,y],"float32",b)}const ALe={kernelName:Dy,backendName:"cpu",kernelFunc:ELe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Le(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:a}=e,{alignCorners:i}=s;Ot([a,r],"resizeBilinearGrad");const l=Ut(r.shape),[c,u,h,f]=r.shape,[,p,x]=a.shape,y=new Float32Array(c*u*h*f),v=[i&&p>1?u-1:u,i&&x>1?h-1:h],b=[i&&p>1?p-1:p,i&&x>1?x-1:x],N=v[0]/b[0],S=v[1]/b[1],k=n.data.get(a.dataId).values;let T=0;for(let E=0;E<c;E++){const D=E*l[0];for(let A=0;A<p;A++){const I=A*N,P=Math.floor(I),$=Math.min(Math.ceil(I),u-1),R=D+P*l[1],F=D+$*l[1],W=I-P,q=1-W;for(let X=0;X<x;X++){const z=X*S,K=Math.floor(z),H=Math.min(Math.ceil(z),h-1),Y=z-K,B=1-Y,O=R+K*l[2],U=R+H*l[2],J=F+K*l[2],se=F+H*l[2],ae=q*B,fe=q*Y,ye=W*B,Te=W*Y;for(let oe=0;oe<f;oe++){const Se=k[T++];y[O+oe]+=Se*ae,y[U+oe]+=Se*fe,y[J+oe]+=Se*ye,y[se+oe]+=Se*Te}}}}return n.makeTensorInfo([c,h,u,f],"float32",y)}const ILe={kernelName:nS,backendName:"cpu",kernelFunc:$Le};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RLe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:a,halfPixelCenters:i,size:l}=s;Ot(r,"resizeNearestNeighbor");const c=Ut(r.shape),[u,h]=l,[f,p,x,y]=r.shape,v=n.data.get(r.dataId).values,b=new Float32Array(f*u*h*y),N=[a&&u>1?p-1:p,a&&h>1?x-1:x],S=[a&&u>1?u-1:u,a&&h>1?h-1:h],k=N[0]/S[0],T=N[1]/S[1];let E=0;for(let D=0;D<f;D++){const A=D*c[0];for(let I=0;I<u;I++){const P=i?k*(I+.5):k*I;let $=Math.min(p-1,a?Math.round(P):Math.floor(P));i&&($=Math.max(0,$));const R=A+$*c[1];for(let F=0;F<h;F++){const W=i?T*(F+.5):T*F;let q=Math.min(x-1,a?Math.round(W):Math.floor(W));i&&(q=Math.max(0,q));const X=R+q*c[2];for(let z=0;z<y;z++){const K=v[X+z];b[E++]=K}}}}return n.makeTensorInfo([f,u,h,y],r.dtype,b)}const OLe={kernelName:Oy,backendName:"cpu",kernelFunc:RLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DLe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:a}=e,{alignCorners:i}=s;Ot([a,r],"resizeNearestNeighborGrad");const l=Ut(r.shape),c=Ut(a.shape),[u,h,f,p]=r.shape,[,x,y]=a.shape,v=new Float32Array(u*h*f*p),b=n.data.get(a.dataId).values,N=[i&&x>1?h-1:h,i&&y>1?f-1:f],S=[i&&x>1?x-1:x,i&&y>1?y-1:y],k=N[0]/S[0],T=N[1]/S[1],E=1/k,D=1/T,A=Math.ceil(E)*2+2,I=Math.ceil(D)*2+2;for(let P=0;P<u;P++){const $=P*l[0];for(let R=0;R<h;R++){const F=$+R*l[1],W=Math.floor(R*E),q=Math.floor(W-A/2);for(let X=0;X<f;X++){const z=F+X*l[2],K=Math.floor(X*D),H=Math.floor(K-I/2);for(let Y=0;Y<p;Y++){let B=0;for(let O=0;O<A;O++){const U=O+q;if(U<0||U>=x)continue;const J=$+U*c[1],se=U*k,ae=Math.min(h-1,i?Math.round(se):Math.floor(se));if(R===ae)for(let fe=0;fe<I;fe++){const ye=fe+H;if(ye<0||ye>=y)continue;const Te=J+ye*c[2],oe=ye*T,Se=Math.min(f-1,i?Math.round(oe):Math.floor(oe));X===Se&&(B+=b[Te+Y])}}v[z+Y]=B}}}}return n.makeTensorInfo(r.shape,r.dtype,v)}const PLe={kernelName:tS,backendName:"cpu",kernelFunc:DLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LLe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:a}=s;Ot(r,"reverse");const i=r.shape.length,l=fn(a,r.shape);if(i===0)return Wl({inputs:{x:r},backend:n});const c=new tr(r.shape,r.dtype),u=n.bufferSync(r);for(let h=0;h<c.size;h++){const f=c.indexToLoc(h),p=f.slice();l.forEach(x=>p[x]=r.shape[x]-1-p[x]),c.set(u.get(...p),...f)}return n.makeTensorInfo(c.shape,c.dtype,c.values)}const MLe={kernelName:Py,backendName:"cpu",kernelFunc:LLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FLe={kernelName:bS,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:a,center:i}=e,l=n,c=Er(s.dtype,ze(s.shape)),[u,h,f,p]=s.shape,[x,y]=_I(i,h,f),v=255,b=Math.sin(r),N=Math.cos(r),S=l.data.get(s.dataId).values;for(let T=0;T<u;T++){const E=T*f*h*p;for(let D=0;D<h;D++){const A=D*(f*p);for(let I=0;I<f;I++){const P=I*p;for(let $=0;$<p;$++){const R=[u,D,I,$],F=R[2],W=R[1];let q=(F-x)*N-(W-y)*b,X=(F-x)*b+(W-y)*N;q=Math.round(q+x),X=Math.round(X+y);let z=a;if(typeof a!="number"&&($===3?z=v:z=a[$]),q>=0&&q<f&&X>=0&&X<h){const H=X*(f*p),Y=q*p,B=E+H+Y+$;z=S[B]}const K=E+A+P+$;c[K]=z}}}}return{dataId:l.write(c,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zLe=Gn(Sp,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),BLe={kernelName:Sp,backendName:"cpu",kernelFunc:zLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ULe(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:a}=e,{shape:i}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:h,outputSize:f}=pd(a,r,i),p=!0,x=n.bufferSync(r),y=n.bufferSync(a),v=th(x,y,i,f,u,c,l,h,0,p);return n.makeTensorInfo(i,v.dtype,v.values)}const VLe={kernelName:sS,backendName:"cpu",kernelFunc:ULe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WLe(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<e?n=r+1:s=r;return s}function HLe(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<=e?n=r+1:s=r;return s}function GLe(t,e,n,s,r,a){const i=Ms("int32",n*r);for(let l=0;l<n;++l){const c=t.slice(l*s,(l+1)*s),u=l*r;for(let h=0;h<r;++h)i[u+h]=a==="left"?WLe(c,e[h+u]):HLe(c,e[h+u])}return i}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qLe(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:a}=e,{side:i}=s,l=n.data.get(r.dataId).values,c=n.data.get(a.dataId).values,u=GLe(l,c,r.shape[0],r.shape[1],a.shape[1],i);return n.makeTensorInfo(a.shape,"int32",u)}const KLe={kernelName:aS,backendName:"cpu",kernelFunc:qLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XLe(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:a}=e;Ot([s,r,a],"select");const i=s.shape.length,l=n.data.get(s.dataId).values,c=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,h=Va(r.dtype,a.dtype),f=Gr(ze(r.shape),h);let p=0;const x=i===0||i>1||r.shape.length===1?1:ze(r.shape.slice(1));for(let y=0;y<l.length;y++)for(let v=0;v<x;v++)l[y]===1?f[p++]=c[y]:f[p++]=u[y];return n.makeTensorInfo(r.shape,h,f)}const YLe={kernelName:Ly,backendName:"cpu",kernelFunc:XLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QLe=lj,ZLe=cj,JLe=Gn(kp,t=>t>=0?ZLe*t:QLe*(Math.exp(t)-1)),eMe={kernelName:kp,backendName:"cpu",kernelFunc:JLe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tMe=Gn(_p,t=>t<0?-1:t>0?1:0),nMe={kernelName:_p,backendName:"cpu",kernelFunc:tMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sMe=Gn(Cp,t=>Math.sin(t)),rMe={kernelName:Cp,backendName:"cpu",kernelFunc:sMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aMe=Gn(Tp,t=>Math.sinh(t)),iMe={kernelName:Tp,backendName:"cpu",kernelFunc:aMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oMe=11920928955078125e-23,NB=Math.log(oMe)+2,lMe=Gn(Ap,t=>{const e=t>-NB,n=t<NB,s=Math.exp(t);let r;return n?r=s:e?r=t:r=Math.log(1+s),r}),cMe={kernelName:Ap,backendName:"cpu",kernelFunc:lMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uMe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:a,paddings:i}=s;Ot([r],"spaceToBatchND");const l=ze(a),c=[[0,0]];c.push(...i);for(let D=1+a.length;D<r.shape.length;++D)c.push([0,0]);const u=pQ.kernelFunc({inputs:{x:r},backend:n,attrs:{paddings:c,constantValue:0}}),h=mb(u.shape,a,l,!1),f=fb(h.length,a.length,!1),p=pb(u.shape,a,l,!1),v=xs({inputs:{x:u},backend:n,attrs:{shape:h}}),S=Ka({inputs:{x:v},backend:n,attrs:{perm:f}}),E=xs({inputs:{x:S},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(S),E}const dMe={kernelName:zy,backendName:"cpu",kernelFunc:uMe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hMe(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:a,defaultValue:i}=e;if(a.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${a.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${r.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const l=n.data.get(s.dataId).values,c=n.data.get(r.dataId).values,u=n.data.get(a.dataId).values,h=n.data.get(i.dataId).values[0],[f,p,x,y,v]=FY(l,s.shape,s.dtype,c,r.dtype,u,h);return[n.makeTensorInfo(p,s.dtype,f),n.makeTensorInfo([p[0]],r.dtype,x),n.makeTensorInfo([y.length],"bool",new Uint8Array(y.map(b=>Number(b)))),n.makeTensorInfo([v.length],s.dtype,new Int32Array(v))]}const mMe={kernelName:iS,backendName:"cpu",kernelFunc:hMe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fMe(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:a}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${r.shape}`);if(a.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);const i=Array.from(n.data.get(r.dataId).values),l=n.data.get(s.dataId).values,c=Array.from(n.data.get(a.dataId).values),[u,h,f]=zY(l,s.shape,s.dtype,i,c);return[n.makeTensorInfo(h,s.dtype,u),n.makeTensorInfo([f.length],a.dtype,new Int32Array(f))]}const pMe={kernelName:oS,backendName:"cpu",kernelFunc:fMe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gMe(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:a}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${a.shape}`);if(r.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(a.dataId).values,[u,h]=AR(i,s.shape,s.dtype,l,c,!0);return n.makeTensorInfo(h,s.dtype,u)}const xMe={kernelName:lS,backendName:"cpu",kernelFunc:gMe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yMe(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:a}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${a.shape}`);if(r.shape[0]!==a.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(a.dataId).values,[u,h]=AR(i,s.shape,s.dtype,l,c);return n.makeTensorInfo(h,s.dtype,u)}const bMe={kernelName:cS,backendName:"cpu",kernelFunc:yMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vMe(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:a,defaultValue:i}=e,{outputShape:l}=s,{sliceRank:c,numUpdates:u,sliceSize:h,strides:f,outputSize:p}=pd(a,r,l),x=!1,y=n.bufferSync(r);let v;switch(a.dtype){case"bool":{const b=n.bufferSync(a),N=!!n.data.get(i.dataId).values[0];v=th(y,b,l,p,h,u,c,f,N,x);break}case"float32":{const b=n.bufferSync(a),N=n.data.get(i.dataId).values[0];v=th(y,b,l,p,h,u,c,f,N,x);break}case"int32":{const b=n.bufferSync(a),N=n.data.get(i.dataId).values[0];v=th(y,b,l,p,h,u,c,f,N,x);break}case"string":{const b=n.bufferSync(a),N=Oc(n.data.get(i.dataId).values[0]);v=th(y,b,l,p,h,u,c,f,N,x);break}default:throw new Error(`Unsupported type ${a.dtype}`)}return n.makeTensorInfo(l,v.dtype,v.values)}const wMe={kernelName:uS,backendName:"cpu",kernelFunc:vMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NMe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:a,axis:i}=s,l=fn(i,r.shape)[0],c=VI(r,a,l),u=new Array(r.shape.length).fill(0),h=r.shape.slice();return c.map(f=>{const p=[...h];p[l]=f;const x=Oh({inputs:{x:r},backend:n,attrs:{begin:u,size:p}});return u[l]+=f,x})}const SMe={kernelName:By,backendName:"cpu",kernelFunc:NMe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jMe={kernelName:dS,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,s=e;Ot(n,"square");const r=s.data.get(n.dataId).values,a=new Float32Array(r.length);for(let l=0;l<r.length;++l){const c=r[l];a[l]=c*c}return{dataId:s.write(a,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kMe=Gn(Lp,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),CMe={kernelName:Lp,backendName:"cpu",kernelFunc:kMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TMe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:a,end:i,strides:l,beginMask:c,endMask:u,ellipsisMask:h,newAxisMask:f,shrinkAxisMask:p}=s;Ot(r,"stridedSlice");const{finalShapeSparse:x,finalShape:y,isIdentity:v,sliceDim0:b,isSimpleSlice:N,begin:S,end:k,strides:T}=jI(r.shape,a,i,l,c,u,h,f,p);let E;if(v)E=xs({inputs:{x:r},backend:n,attrs:{shape:y}});else if(b||N){Z(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const D=wI(S,k,T),A=Oh({inputs:{x:r},backend:n,attrs:{begin:S,size:D}});E=xs({inputs:{x:A},backend:n,attrs:{shape:y}}),n.disposeIntermediateTensorInfo(A)}else{const D=n.bufferSync(r),A=VY(x,D,T,S);E=n.makeTensorInfo(y,A.dtype,A.values)}return E}const _Me={kernelName:hS,backendName:"cpu",kernelFunc:TMe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EMe(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:a,leftPad:i,rightPad:l,padWidth:c,preserveShortSequences:u}=s,{data:h,dataSplits:f}=e,p=n.data.get(h.dataId).values,x=n.data.get(f.dataId).values,[y,v]=WY(p,x,r,a,i,l,c,u);return[n.makeTensorInfo([y.length],"string",y),n.makeTensorInfo(f.shape,"int32",v)]}const AMe={kernelName:mS,backendName:"cpu",kernelFunc:EMe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Me(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:a,delimiter:i}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(a.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${a.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const l=n.data.get(a.dataId).values,c=n.data.get(i.dataId).values[0],[u,h,f]=HY(l,c,r),p=h.length;return[n.makeTensorInfo([p,2],"int32",u),n.makeTensorInfo([p],"string",h),n.makeTensorInfo([2],"int32",new Int32Array(f))]}const IMe={kernelName:fS,backendName:"cpu",kernelFunc:$Me};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RMe(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:a}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const i=n.data.get(a.dataId).values,l=GY(i,r);return n.makeTensorInfo(a.shape,"int32",l)}const OMe={kernelName:pS,backendName:"cpu",kernelFunc:RMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DMe=Gn(Op,t=>Math.tan(t)),PMe={kernelName:Op,backendName:"cpu",kernelFunc:DMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LMe=Gn(Dp,t=>Math.tanh(t)),MMe={kernelName:Dp,backendName:"cpu",kernelFunc:LMe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FMe(t){const{inputs:e,backend:n}=t,{tensor:s,indices:r,updates:a}=e,{sliceRank:i,numUpdates:l,sliceSize:c,strides:u,outputSize:h}=pd(a,r,s.shape),f=!1,p=n.bufferSync(r),x=n.bufferSync(a),y=n.bufferSync(s),v=th(p,x,s.shape,h,c,l,i,u,y,f);return n.makeTensorInfo(s.shape,v.dtype,v.values)}const zMe={kernelName:rS,backendName:"cpu",kernelFunc:FMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BMe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:a}=s;Ot(r,"tile");const i=KY(n.bufferSync(r),a);return n.makeTensorInfo(i.shape,i.dtype,i.values)}const UMe={kernelName:Pp,backendName:"cpu",kernelFunc:BMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VMe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:a,sorted:i}=s;Ot(r,"topk");const l=n.data.get(r.dataId).values,[c,u]=YY(l,r.shape,r.dtype,a,i);return[n.makeTensorInfo(c.shape,c.dtype,c.values),n.makeTensorInfo(u.shape,u.dtype,u.values)]}const WMe={kernelName:gS,backendName:"cpu",kernelFunc:VMe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HMe(t){const{inputs:e,attrs:n,backend:s}=t,{image:r,transforms:a}=e,{interpolation:i,fillMode:l,fillValue:c,outputShape:u}=n,[h,f,p,x]=r.shape,[y,v]=u??[f,p],b=[h,y,v,x],N=Ut(r.shape),S=N[0],k=N[1],T=N[2],E=Ut(b),D=E[0],A=E[1],I=E[2],P=Er(r.dtype,ze(b));P.fill(c);const $=s.data.get(r.dataId).values,R=s.data.get(a.dataId).values;for(let W=0;W<h;++W){const q=a.shape[0]===1?R:R.subarray(W*8,W*8+8);for(let X=0;X<y;++X)for(let z=0;z<v;++z)for(let K=0;K<x;++K){let H;const Y=q[6]*z+q[7]*X+1;if(Y===0)continue;const B=(q[0]*z+q[1]*X+q[2])/Y,O=(q[3]*z+q[4]*X+q[5])/Y,U=SB(B,p,l),J=SB(O,f,l);switch(i){case"nearest":H=QMe($,f,p,S,k,T,W,J,U,K,c);break;case"bilinear":H=ZMe($,f,p,S,k,T,W,J,U,K,c);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${i}`)}const se=W*D+X*A+z*I+K;P[se]=H}return s.makeTensorInfo(b,r.dtype,P)}return{dataId:s.write(P,b,r.dtype),shape:r.shape,dtype:r.dtype}}const GMe={kernelName:xS,backendName:"cpu",kernelFunc:HMe};function SB(t,e,n){switch(n){case"reflect":return qMe(t,e);case"wrap":return KMe(t,e);case"nearest":return YMe(t,e);case"constant":default:return XMe(t)}}function qMe(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=2*e;n<s&&(n=s*Math.trunc(-n/s)+n),n=n<-e?n+s:-n-1}else if(n>e-1)if(e<=1)n=0;else{const s=2*e;n-=s*Math.trunc(n/s),n>=e&&(n=s-n-1)}return Ku(0,n,e-1)}function KMe(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=e-1;n+=e*(Math.trunc(-n/s)+1)}else if(n>e-1)if(e<=1)n=0;else{const s=e-1;n-=e*Math.trunc(n/s)}return Ku(0,n,e-1)}function XMe(t,e){return t}function YMe(t,e){return Ku(0,t,e-1)}function jg(t,e,n,s,r,a,i,l,c,u,h){const f=i*s+l*r+c*a+u;return 0<=l&&l<e&&0<=c&&c<n?t[f]:h}function QMe(t,e,n,s,r,a,i,l,c,u,h){const f=Math.round(l),p=Math.round(c);return jg(t,e,n,s,r,a,i,f,p,u,h)}function ZMe(t,e,n,s,r,a,i,l,c,u,h){const f=Math.floor(l),p=Math.floor(c),x=f+1,y=p+1,v=(y-c)*jg(t,e,n,s,r,a,i,f,p,u,h)+(c-p)*jg(t,e,n,s,r,a,i,f,y,u,h),b=(y-c)*jg(t,e,n,s,r,a,i,x,p,u,h)+(c-p)*jg(t,e,n,s,r,a,i,x,y,u,h);return(x-l)*v+(l-f)*b}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JMe(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:a}=e;Ot(a,"unique");const i=s.data.get(a.dataId).values,{outputValues:l,outputShape:c,indices:u}=QY(i,r,a.shape,a.dtype);return[s.makeTensorInfo(c,a.dtype,l),s.makeTensorInfo([u.length],"int32",u)]}const eFe={kernelName:yS,backendName:"cpu",kernelFunc:JMe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tFe(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:a}=s;a<0&&(a+=r.shape.length);const i=r.shape.length,l=r.shape[a],c=new Array(i-1);let u=0;for(let x=0;x<i;x++)x!==a&&(c[u++]=r.shape[x]);const h=new Array(i).fill(0),f=r.shape.slice();f[a]=1;const p=new Array(l);for(let x=0;x<p.length;x++){h[a]=x;const y=Oh({inputs:{x:r},backend:n,attrs:{begin:h,size:f}});p[x]=xs({inputs:{x:y},backend:n,attrs:{shape:c}}),n.disposeIntermediateTensorInfo(y)}return p}const nFe={kernelName:Wy,backendName:"cpu",kernelFunc:tFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sFe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:a}=e,{numSegments:i}=s;Ot(r,"unsortedSegmentSum");const l=r.shape.length,c=a.shape.length,u=[],h=[],f=l-c;let p=a;for(let y=0;y<f;++y){const v=p2({inputs:{input:p},backend:n,attrs:{dim:y+1}});p=v,h.push(v)}for(let y=0;y<i;++y){const v=Yc(y,"int32"),b=n.makeTensorInfo([],"int32",v),N=hY({inputs:{a:b,b:p},backend:n}),S=rd({inputs:{x:N},backend:n,attrs:{dtype:"float32"}}),k=$j({inputs:{a:S,b:r},backend:n}),T=Cb({inputs:{x:k},backend:n,attrs:{axis:0,keepDims:!1}});u.push(T),h.push(b),h.push(N),h.push(S),h.push(k),h.push(T)}const x=fQ({inputs:u,backend:n,attrs:{axis:0}});return h.forEach(y=>n.disposeIntermediateTensorInfo(y)),x}const rFe={kernelName:Hy,backendName:"cpu",kernelFunc:sFe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aFe=[JOe,ORe,tDe,sDe,zRe,aDe,oDe,cDe,dDe,mDe,pDe,xDe,bDe,NDe,jDe,TDe,EDe,$De,RDe,QOe,DDe,LDe,FDe,URe,BDe,MRe,WRe,VDe,DRe,HDe,qDe,KDe,YDe,ZDe,e6e,n6e,r6e,i6e,l6e,u6e,h6e,f6e,g6e,y6e,b6e,w6e,S6e,k6e,C6e,T6e,_6e,A6e,R6e,WOe,D6e,HRe,V6e,GRe,W6e,KRe,Y6e,Q6e,J6e,YRe,ZRe,tPe,sPe,aPe,oPe,eOe,nOe,PRe,cPe,GDe,dPe,mPe,pPe,HOe,rOe,iOe,xPe,lOe,bPe,NPe,jPe,TPe,EPe,$Pe,IPe,uOe,OPe,PPe,MPe,zPe,UPe,WPe,GPe,hOe,KPe,QPe,eLe,fOe,gOe,sLe,iLe,cLe,yOe,dLe,mLe,fLe,pQ,yLe,qOe,wOe,vLe,NLe,jLe,CLe,LRe,PE,_Le,KOe,XOe,YOe,ALe,ILe,OLe,PLe,MLe,FLe,BLe,EOe,VLe,KLe,YLe,eMe,$Oe,nMe,rMe,iMe,IOe,ZPe,cMe,dMe,mMe,pMe,xMe,bMe,wMe,SMe,DOe,jMe,LOe,FOe,CMe,_Me,AMe,IMe,OMe,VOe,$6e,PMe,MMe,zMe,UMe,WMe,GMe,bOe,eFe,nFe,rFe,hLe];for(const t of aFe)vS(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qd={},x1={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function gQ(t,e){qd[t]=e}function dl(t,e){if(!(t in qd)||e!=null){const s=oFe(t,e);if(s!==null)qd[t]=s;else return console.log("Could not get context for WebGL version",t),null}const n=qd[t];return n==null||n.isContextLost()?(delete qd[t],dl(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),qd[t])}function iFe(t){if(!$e().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function oFe(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??iFe(t);return n.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete qd[t]},!1),$e().getBool("SOFTWARE_WEBGL_ENABLED")&&(x1.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",x1)||n.getContext("experimental-webgl",x1):n.getContext("webgl2",x1)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var fx;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(fx||(fx={}));var Wi;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(Wi||(Wi={}));var Vr;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Vr||(Vr={}));function Tb(t,e){return[e,t]}function lFe(t,e){return t*e}function y1(t){const e=ze(t),n=Math.ceil(e/4);return Ww(n)}function Zp(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function cFe(t,e){const[n,s]=Zp(t,e);return n*s*4}function DR(t,e){const n=t;let s,r,a,i,l,c,u,h,f,p;return $e().getNumber("WEBGL_VERSION")===2?(s=n.R32F,r=n.R16F,a=n.RGBA16F,i=n.RGBA32F,l=n.RED,u=4,h=1,f=n.HALF_FLOAT,p=n.FLOAT,c=n.RGBA8):(s=t.RGBA,r=t.RGBA,a=t.RGBA,i=n.RGBA,l=t.RGBA,u=4,h=4,f=e!=null?e.HALF_FLOAT_OES:null,p=t.FLOAT,c=t.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:a,internalFormatPackedFloat:i,textureFormatFloat:l,downloadTextureFormat:c,downloadUnpackNumChannels:u,defaultNumChannels:h,textureTypeHalfFloat:f,textureTypeFloat:p}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wt(t,e){const n=e();return $e().getBool("DEBUG")&&uFe(t),n}function uFe(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+yQ(t,e))}const dFe=596e-10,hFe=65504;function xQ(t){return!!($e().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||dFe<Math.abs(t)&&Math.abs(t)<hFe)}function yQ(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function kg(t,e){return su(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function bQ(t,e){const n=su(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(wt(t,()=>t.shaderSource(n,e)),wt(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function vQ(t,e){const n=su(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(wt(t,()=>t.shaderSource(n,e)),wt(t,()=>t.compileShader(n)),$e().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw PR(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const mFe=/ERROR: [0-9]+:([0-9]+):/g;function PR(t,e){const n=mFe.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const s=+n[1],r=t.split(`
`),a=r.length.toString().length+2,i=r.map((f,p)=>lh((p+1).toString(),a)+f);let l=0;for(let f=0;f<i.length;f++)l=Math.max(i[f].length,l);const c=i.slice(0,s-1),u=i.slice(s-1,s),h=i.slice(s);console.log(c.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${lh(u[0],l)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(h.join(`
`))}function wQ(t){return su(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function NQ(t,e){if(wt(t,()=>t.linkProgram(e)),!$e().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function q1(t,e){if(wt(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function SQ(t,e){const n=su(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return wt(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),wt(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function jQ(t,e){const n=su(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return wt(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),wt(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function fFe(){return $e().getNumber("WEBGL_VERSION")===2?1:4}function kQ(t){return su(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function CQ(t,e){const n=$e().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const s=`[${t}x${e}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(t>n||e>n){const s=`[${t}x${e}]`,r=`[${n}x${n}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+r+".")}}function TQ(t){return su(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function ME(t,e,n,s,r,a,i){const l=t.getAttribLocation(e,n);return l===-1?!1:(wt(t,()=>t.bindBuffer(t.ARRAY_BUFFER,s)),wt(t,()=>t.vertexAttribPointer(l,r,t.FLOAT,!1,a,i)),wt(t,()=>t.enableVertexAttribArray(l)),!0)}function _Q(t,e,n){RQ(t,n),wt(t,()=>t.activeTexture(t.TEXTURE0+n)),wt(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function pFe(t,e){RQ(t,e),wt(t,()=>t.activeTexture(t.TEXTURE0+e)),wt(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function EQ(t,e,n){return su(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function AQ(t,e,n){return t.getUniformLocation(e,n)}function $Q(t,e,n,s){wt(t,()=>_Q(t,e,s)),wt(t,()=>t.uniform1i(n,s))}function gFe(t){wt(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,null)),wt(t,()=>t.viewport(0,0,t.canvas.width,t.canvas.height)),wt(t,()=>t.scissor(0,0,t.canvas.width,t.canvas.height))}function K1(t,e,n){wt(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),wt(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function FE(t,e){wt(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),wt(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function Cg(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+IQ(t,e))}function IQ(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function su(t,e,n){const s=wt(t,()=>e());if(s==null)throw new Error(n);return s}function RQ(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=e+t.TEXTURE0;if(s<t.TEXTURE0||s>n){const r=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${r}.`)}}function Dh(t,e=2){return ze(t.slice(0,t.length-e))}function Ph(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function Tg(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[Dh(t),...Ph(t)]),e}function OQ(t,e=!1){let n=$e().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=$e().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&$e().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=n/2),e&&(n=n*2,s=s*2,t=t.map((l,c)=>c>=t.length-2?mN(t[c]):t[c]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=Xc(t).newShape);let r=ze(t),a=null;t.length<=1&&r<=n?a=[1,r]:t.length===2&&t[0]<=n&&t[1]<=n?a=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?a=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?a=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?a=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(a=[t[0],t[1]*t[2]*t[3]]);const i=a!=null&&Math.max(...a)>s&&Math.min(...a)<=(e?2:1)&&Math.min(...a)>0;if(a==null||i)if(e){const l=Dh(t);let c=2,u=2;t.length&&([c,u]=Ph(t)),r=l*(c/2)*(u/2),a=Ww(r).map(h=>h*2)}else a=Ww(r);return a}function b1(t){return t%2===0}function px(t,e){if(t=t.slice(-2),e=e.slice(-2),xn(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],s=e[e.length-1];if(n===s||b1(n)&&b1(s)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&b1(t[0])&&b1(e[0])}let X1,Y1;function DQ(t){if(X1==null){const e=dl(t);X1=e.getParameter(e.MAX_TEXTURE_SIZE)}return X1}function xFe(){X1=null}function yFe(){Y1=null}function PQ(t){if(Y1==null){const e=dl(t);Y1=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Y1)}function LQ(t){if(t===0)return 0;let e;const n=dl(t);return Hi(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:Hi(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function Hi(t,e){return t.getExtension(e)!=null}function zE(t){try{if(dl(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function MQ(t){if(t===0)return!1;const e=dl(t);if(t===1){if(!Hi(e,"OES_texture_float"))return!1}else if(!Hi(e,"EXT_color_buffer_float"))return!1;return BE(e)}function FQ(t){if(t===0)return!1;const e=dl(t);if(t===1){if(!Hi(e,"OES_texture_float")||!Hi(e,"WEBGL_color_buffer_float"))return!1}else{if(Hi(e,"EXT_color_buffer_float"))return BE(e);const s="EXT_color_buffer_half_float";if(Hi(e,s)){const r=e.getExtension(s);return bFe(e,r)}return!1}return BE(e)}function BE(t){const e=DR(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,1,1,0,e.textureFormatFloat,e.textureTypeFloat,null);const a=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,a),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(a),i}function bFe(t,e){const n=DR(t,e),s=t.createTexture();t.bindTexture(t.TEXTURE_2D,s),t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,1,1,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s,0);const l=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(s),t.deleteFramebuffer(i),l}function zQ(t){return t!==2?!1:dl(t).fenceSync!=null}function Jp(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&Z(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}const vFe=Object.freeze(Object.defineProperty({__proto__:null,assertNotComplex:Jp,bindCanvasToFramebuffer:gFe,bindColorTextureToFramebuffer:K1,bindTextureToProgramUniformSampler:$Q,bindTextureUnit:_Q,bindVertexBufferToProgramAttribute:ME,callAndCheck:wt,canBeRepresented:xQ,createFragmentShader:vQ,createFramebuffer:TQ,createProgram:wQ,createStaticIndexBuffer:jQ,createStaticVertexBuffer:SQ,createTexture:kQ,createVertexShader:bQ,getBatchDim:Dh,getExtensionOrThrow:kg,getFramebufferErrorMessage:IQ,getMaxTexturesInShader:PQ,getNumChannels:fFe,getProgramUniformLocation:AQ,getProgramUniformLocationOrThrow:EQ,getRowsCols:Ph,getShapeAs3D:Tg,getTextureShapeFromLogicalShape:OQ,getWebGLDisjointQueryTimerVersion:LQ,getWebGLErrorMessage:yQ,getWebGLMaxTextureSize:DQ,hasExtension:Hi,isCapableOfRenderingToFloatTexture:MQ,isDownloadFloatTextureEnabled:FQ,isReshapeFree:px,isWebGLFenceEnabled:zQ,isWebGLVersionEnabled:zE,linkProgram:NQ,logShaderSourceAndInfoLog:PR,resetMaxTextureSize:xFe,resetMaxTexturesInShader:yFe,unbindColorTextureFromFramebuffer:FE,unbindTextureUnit:pFe,validateFramebuffer:Cg,validateProgram:q1,validateTextureSize:CQ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ft=$e();Ft.registerFlag("HAS_WEBGL",()=>Ft.getNumber("WEBGL_VERSION")>0);Ft.registerFlag("WEBGL_VERSION",()=>zE(2)?2:zE(1)?1:0);Ft.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Ft.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Ft.get("WEBGL_VERSION")===2);Ft.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Ft.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Ft.registerFlag("WEBGL_PACK",()=>Ft.getBool("HAS_WEBGL"));Ft.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Ft.getBool("WEBGL_PACK"));Ft.registerFlag("WEBGL_PACK_CLIP",()=>Ft.getBool("WEBGL_PACK"));Ft.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Ft.getBool("WEBGL_PACK"));Ft.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Ft.getBool("WEBGL_PACK"));Ft.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Ft.getBool("WEBGL_PACK"));Ft.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Ft.getBool("WEBGL_PACK"));Ft.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Ft.getBool("WEBGL_PACK"));Ft.registerFlag("WEBGL_PACK_REDUCE",()=>Ft.getBool("WEBGL_PACK"));Ft.registerFlag("WEBGL_LAZILY_UNPACK",()=>Ft.getBool("WEBGL_PACK"));Ft.registerFlag("WEBGL_CONV_IM2COL",()=>Ft.getBool("WEBGL_PACK"));Ft.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Ft.getBool("WEBGL_PACK"));Ft.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>DQ(Ft.getNumber("WEBGL_VERSION")));Ft.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>PQ(Ft.getNumber("WEBGL_VERSION")));Ft.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=Ft.getNumber("WEBGL_VERSION");return t===0?0:LQ(t)});Ft.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Ft.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!YA());Ft.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>MQ(Ft.getNumber("WEBGL_VERSION")));Ft.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Ft.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Ft.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Ft.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>FQ(Ft.getNumber("WEBGL_VERSION")));Ft.registerFlag("WEBGL_FENCE_API_ENABLED",()=>zQ(Ft.getNumber("WEBGL_VERSION")));Ft.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Ft.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Ft.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});Ft.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>YA()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});Ft.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Ft.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Ft.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Ft.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Ft.registerFlag("WEBGL_EXP_CONV",()=>!1);Ft.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Ft.getBool("IS_TEST"));Ft.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Ft.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Ft.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Ft.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ea(){let t,e,n,s,r,a,i,l,c,u;return $e().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",s="in",r="texture",a="outputColor",i="out vec4 outputColor;",l=$e().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",c="",u=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",s="varying",r="texture2D",a="gl_FragColor",i="",l=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,c=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,u=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:s,texture2D:r,output:a,defineOutput:i,defineSpecialNaN:l,defineSpecialInf:c,defineRound:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function em(t,e,n="index"){const s=Ut(e);return s.map((r,a)=>{const i=`int ${t[a]} = ${n} / ${r}`,l=a===s.length-1?`int ${t[a+1]} = ${n} - ${t[a]} * ${r}`:`index -= ${t[a]} * ${r}`;return`${i}; ${l};`}).join("")}function Ij(t,e,n="index"){const s=Ut(e);return s.map((r,a)=>{const i=`int ${t[a]} = ${n} / outShapeStrides[${a}]`,l=a===s.length-1?`int ${t[a+1]} = ${n} - ${t[a]} * outShapeStrides[${a}]`:`index -= ${t[a]} * outShapeStrides[${a}]`;return`${i}; ${l};`}).join("")}function wFe(t,e){const n=t.length,s=t.map(a=>`${e}[${a}]`),r=new Array(n-1);r[n-2]=s[n-1];for(let a=n-3;a>=0;--a)r[a]=`(${r[a+1]} * ${s[a+1]})`;return r}function NFe(t,e,n="index"){const s=t.map((a,i)=>i),r=wFe(s,e);return r.map((a,i)=>{const l=`int ${t[i]} = ${n} / ${r[i]}`,c=i===r.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${r[i]}`:`index -= ${t[i]} * ${r[i]}`;return`${l}; ${c};`}).join("")}function LR(t){const e=Ut(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function MR(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const BQ=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:UQ}=bK;function SFe(t,e,n){const s=[];if(t.forEach(x=>{const y=ze(x.shapeInfo.logicalShape);if(x.shapeInfo.isUniform?s.push(`uniform float ${x.name}${y>1?`[${y}]`:""};`):(s.push(`uniform sampler2D ${x.name};`),s.push(`uniform int offset${x.name};`)),n.enableShapeUniforms){const{uniformShape:v}=FR(n.packedInputs,x.shapeInfo.logicalShape,x.shapeInfo.texShape);switch(v.length){case 1:s.push(`uniform int ${x.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${x.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${x.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${x.name}Shape;`);break}s.push(`uniform ivec2 ${x.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(x=>{s.push(`uniform ${x.type} ${x.name}${x.arrayIndex?`[${x.arrayIndex}]`:""};`)});const r=s.join(`
`),a=t.map(x=>jFe(x,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),i=e.texShape,l=Ea(),c=TFe(l);let u,h,f=AFe(l);return e.isPacked?(u=kFe(e.logicalShape,i,n.enableShapeUniforms),h=EFe(l)):(u=CFe(e.logicalShape,i,n.enableShapeUniforms),h=_Fe(l)),n.packedInputs&&(f+=OFe),[f,c,h,r,u,a,n.userCode].join(`
`)}function e0(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return GFe(t,e);case 1:return KFe(t,e);case 2:return YFe(t,e);case 3:return ZFe(t,e);case 4:return eze(t,e);case 5:return tze(t);case 6:return nze(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function VQ(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return HFe(t);case 1:return qFe(t,e);case 2:return XFe(t,e);case 3:return QFe(t,e);default:return JFe(t,e)}}function jFe(t,e,n=!1,s){let r="";n?r+=VQ(t,s):r+=e0(t,s);const a=t.shapeInfo.logicalShape,i=e.logicalShape;return a.length<=i.length&&(n?r+=sze(t,e):r+=rze(t,e)),r}function kFe(t,e,n){switch(t.length){case 0:return WQ();case 1:return DFe(t,e,n);case 2:return VFe(t,e,n);case 3:return LFe(t,e,n);default:return FFe(t,e,n)}}function CFe(t,e,n){switch(t.length){case 0:return WQ();case 1:return PFe(t,e,n);case 2:return WFe(t,e,n);case 3:return MFe(t,e,n);case 4:return zFe(t,e,n);case 5:return BFe(t,e);case 6:return UFe(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function TFe(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function _Fe(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function EFe(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function AFe(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${$Fe}
    ${IFe}
    ${RFe}
  `}const $Fe=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,IFe=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,RFe=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,OFe=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function WQ(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function DFe(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return s[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function PFe(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function LFe(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[2]/2),a=r*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${a};
      index -= b * ${a};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec3(b, r, c);
    }
  `}function MFe(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${Ij(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const s=em(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function FFe(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),a=r*Math.ceil(t[t.length-2]/2);let i=a,l="",c="b, r, c";for(let u=2;u<t.length-1;u++)i*=t[t.length-u-1],l=`
      int b${u} = index / ${i};
      index -= b${u} * ${i};
    `+l,c=`b${u}, `+c;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${l}

      int b = index / ${a};
      index -= b * ${a};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec${t.length}(${c});
    }
  `}function zFe(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${Ij(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const s=em(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function BFe(t,e){const n=em(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function UFe(t,e){const n=em(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function VFe(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(xn(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const r=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec2(r, c);
    }
  `}function WFe(t,e,n){return xn(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function tm(t){return`offset${t}`}function HFe(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),s=Ea();return`
    vec4 ${n}() {
      return ${s.texture2D}(${e}, halfCR);
    }
  `}function GFe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${s}() {return ${n};}`;const[r,a]=t.shapeInfo.texShape;if(r===1&&a===1)return`
      float ${s}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const i=tm(n);if(e)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${i});
      return sampleTexture(${n}, uv);
    }
  `;const[l,c]=t.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${l}, ${c}, ${i});
      return sampleTexture(${n}, uv);
    }
  `}function qFe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=t.shapeInfo.texShape,a=Ea();if(e)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${a.texture2D}(${n}, uv);
    }
  `;const i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${i[0]}, ${i[1]}, index);
      return ${a.texture2D}(${n}, uv);
    }
  `}function KFe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${t0(t)}
      }
    `;const r=t.shapeInfo.texShape,a=r[0],i=r[1];if(i===1&&a===1)return`
      float ${s}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const l=tm(n);return i===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${l}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${l}) + 0.5) / ${a}.0);
        return sampleTexture(${n}, uv);
      }
    `:a===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${l}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${l}) + 0.5) / ${i}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${l});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${a}, ${i}, index + ${l});
      return sampleTexture(${n}, uv);
    }
  `}function XFe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=t.shapeInfo.texShape,i=a[0],l=a[1],c=Ea();if(a!=null&&xn(n,a))return e?`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${c.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${l}.0, ${i}.0);

        return ${c.texture2D}(${s}, uv);
      }
    `;if(e)return`
    vec4 ${r}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${c.texture2D}(${s}, uv);
    }
  `;const u=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],h=Math.ceil(n[1]/2);return`
    vec4 ${r}(int row, int col) {
      vec2 uv = packedUVfrom2D(${h}, ${u[0]}, ${u[1]}, row, col);
      return ${c.texture2D}(${s}, uv);
    }
  `}function YFe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=t.shapeInfo.texShape;if(a!=null&&xn(n,a)){if(e)return`
      float ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const p=a[0],x=a[1];return`
    float ${r}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${x}.0, ${p}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:i,keptDims:l}=Xc(n),c=i;if(c.length<n.length){const p=n0(t,c),x=["row","col"];return`
      ${e0(p,e)}
      float ${r}(int row, int col) {
        return ${r}(${s0(x,l)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${t0(t)}
      }
    `;const u=a[0],h=a[1],f=tm(s);return h===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${f}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${f}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${u}.0);
      return sampleTexture(${s}, uv);
    }
  `:u===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${f}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${f}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${h}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:e?`
      float ${r}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${f};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${r}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${f};
    vec2 uv = uvFromFlat(${u}, ${h}, index);
    return sampleTexture(${s}, uv);
  }
`}function QFe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=t.shapeInfo.texShape,i=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)];if(n[0]===1){const p=n.slice(1),x=[1,2],y=n0(t,p),v=["b","row","col"];return`
        ${VQ(y,e)}
        vec4 ${r}(int b, int row, int col) {
          return ${r}(${s0(v,x)});
        }
      `}const l=Ea();if(e)return`
    vec4 ${r}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const c=i[0],u=i[1],h=Math.ceil(n[2]/2),f=h*Math.ceil(n[1]/2);return`
    vec4 ${r}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${c}, ${u}, ${f}, ${h}, b, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function ZFe(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=n[1]*n[2],i=n[2],{newShape:l,keptDims:c}=Xc(n),u=l;if(u.length<n.length){const v=n0(t,u),b=["row","col","depth"];return`
        ${e0(v,e)}
        float ${r}(int row, int col, int depth) {
          return ${r}(${s0(b,c)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${a}, ${i}, 1)));
        ${t0(t)}
      }
    `;const h=t.shapeInfo.texShape,f=h[0],p=h[1],x=t.shapeInfo.flatOffset;if(p===a&&x==null)return e?`
      float ${r}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${r}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${i}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${p}.0, ${f}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(p===i&&x==null)return e?`
      float ${r}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${p}.0, ${f}.0);
      return sampleTexture(${s}, uv);
    }
  `;const y=tm(s);return e?`
    float ${r}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${y};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${r}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${a} + col * ${i} + depth + ${y};
        vec2 uv = uvFromFlat(${f}, ${p}, index);
        return sampleTexture(${s}, uv);
      }
  `}function JFe(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=Ea();if(e)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${r.texture2D}(${n}, uv);
    }
  `;const a=t.shapeInfo.logicalShape,i=a.length,l=t.shapeInfo.texShape,c=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)],u=c[0],h=c[1],f=Math.ceil(a[i-1]/2);let p=f*Math.ceil(a[i-2]/2),x="int b, int row, int col",y=`b * ${p} + (row / 2) * ${f} + (col / 2)`;for(let v=2;v<i-1;v++)x=`int b${v}, `+x,p*=a[i-v-1],y=`b${v} * ${p} + `+y;return`
    vec4 ${s}(${x}) {
      int index = ${y};
      int texR = index / ${h};
      int texC = index - texR * ${h};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}, ${u});
      return ${r.texture2D}(${n}, uv);
    }
  `}function eze(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),a=n[3],i=n[2]*a,l=n[1]*i,{newShape:c,keptDims:u}=Xc(n);if(c.length<n.length){const S=n0(t,c),k=["row","col","depth","depth2"];return`
      ${e0(S,e)}
      float ${r}(int row, int col, int depth, int depth2) {
        return ${r}(${s0(k,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${l}, ${i}, ${a}, 1)));
        ${t0(t)}
      }
    `;const h=t.shapeInfo.flatOffset,f=t.shapeInfo.texShape,p=f[0],x=f[1],y=`int stride2 = ${s}Shape[3];`,v=`int stride1 = ${s}Shape[2] * stride2;`,b=`int stride0 = ${s}Shape[1] * stride1;`;if(x===l&&h==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        ${y}
        ${v}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${i}, ${a}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${x}.0, ${p}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(x===a&&h==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${x}.0, ${p}.0);
        return sampleTexture(${s}, uv);
      }
    `;const N=tm(s);return e?`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${y}
      ${v}
      ${b}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${N});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${l} + col * ${i} +
          depth * ${a} + depth2;
      vec2 uv = uvFromFlat(${p}, ${x}, index + ${N});
      return sampleTexture(${s}, uv);
    }
  `}function tze(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=e[4],a=e[3]*r,i=e[2]*a,l=e[1]*i,{newShape:c,keptDims:u}=Xc(e);if(c.length<e.length){const v=n0(t,c),b=["row","col","depth","depth2","depth3"];return`
      ${e0(v)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${s0(b,u)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${l}, ${i}, ${a}, ${r})) +
          depth3;
        ${t0(t)}
      }
    `;const h=t.shapeInfo.flatOffset,f=t.shapeInfo.texShape,p=f[0],x=f[1];if(x===l&&h==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${i}, ${a}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${x}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(x===r&&h==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${x}.0, ${p}.0);
        return sampleTexture(${n}, uv);
      }
    `;const y=tm(n);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${l} + col * ${i} + depth * ${a} +
          depth2 * ${r} + depth3 + ${y};
      vec2 uv = uvFromFlat(${p}, ${x}, index);
      return sampleTexture(${n}, uv);
    }
  `}function nze(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:r,keptDims:a}=Xc(e);if(r.length<e.length){const b=n0(t,r),N=["row","col","depth","depth2","depth3","depth4"];return`
      ${e0(b)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${s0(N,a)});
      }
    `}const i=e[5],l=e[4]*i,c=e[3]*l,u=e[2]*c,h=e[1]*u;if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${h}, ${u}, ${c}, ${l})) +
          dot(
            vec2(depth3, depth4),
            vec2(${i}, 1)));
        ${t0(t)}
      }
    `;const f=t.shapeInfo.flatOffset,p=t.shapeInfo.texShape,x=p[0],y=p[1];if(y===h&&f==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${u}, ${c}, ${l}, ${i})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${y}.0, ${x}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(y===i&&f==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${y}.0, ${x}.0);
        return sampleTexture(${n}, uv);
      }
    `;const v=tm(n);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${h} + col * ${u} + depth * ${c} +
          depth2 * ${l} + depth3 * ${i} + depth4 + ${v};
      vec2 uv = uvFromFlat(${x}, ${y}, index);
      return sampleTexture(${n}, uv);
    }
  `}function t0(t){const e=t.name,n=ze(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function sze(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",a=t.shapeInfo.logicalShape.length,i=e.logicalShape.length,l=UQ(t.shapeInfo.logicalShape,e.logicalShape),c=es(i),u=i-a;let h;const f=["x","y","z","w","u","v"];a===0?h="":i<2&&l.length>=1?h="coords = 0;":h=l.map(S=>`coords.${f[S+u]} = 0;`).join(`
`);let p="";i<2&&a>0?p="coords":p=t.shapeInfo.logicalShape.map((S,k)=>`coords.${f[k+u]}`).join(", ");let x="return outputValue;";const v=ze(t.shapeInfo.logicalShape)===1,N=ze(e.logicalShape)===1;if(a===1&&!v&&!N)x=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(v&&!N)i===1?x=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:x=`
        return vec4(outputValue.x);
      `;else if(l.length){const S=a-2,k=a-1;l.indexOf(S)>-1&&l.indexOf(k)>-1?x="return vec4(outputValue.x);":l.indexOf(S)>-1?x="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":l.indexOf(k)>-1&&(x="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${r}() {
      ${c} coords = getOutputCoords();
      ${h}
      vec4 outputValue = get${s}(${p});
      ${x}
    }
  `}function rze(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",a=e.texShape,i=t.shapeInfo.texShape,l=t.shapeInfo.logicalShape.length,c=e.logicalShape.length;if(!t.shapeInfo.isUniform&&l===c&&t.shapeInfo.flatOffset==null&&xn(i,a))return`
      float ${r}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const u=es(c),h=UQ(t.shapeInfo.logicalShape,e.logicalShape),f=c-l;let p;const x=["x","y","z","w","u","v"];l===0?p="":c<2&&h.length>=1?p="coords = 0;":p=h.map(v=>`coords.${x[v+f]} = 0;`).join(`
`);let y="";return c<2&&l>0?y="coords":y=t.shapeInfo.logicalShape.map((v,b)=>`coords.${x[b+f]}`).join(", "),`
    float ${r}() {
      ${u} coords = getOutputCoords();
      ${p}
      return get${s}(${y});
    }
  `}function es(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function FR(t,e,n){const{newShape:s,keptDims:r}=Xc(e),a=e.length,i=t&&a===3&&e[0]===1,l=i?e.slice(1):s,c=!t&&a>1&&!xn(e,n)&&s.length<a||i;return{useSqueezeShape:c,uniformShape:c?l:e,keptDims:r}}function n0(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function s0(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aze(t,e,n,s){const r=n.map((h,f)=>{const p={logicalShape:h.shape,texShape:h.isUniform?null:h.texData.texShape,isUniform:h.isUniform,isPacked:h.isUniform?!1:h.texData.isPacked,flatOffset:null};return h.texData!=null&&h.texData.slice!=null&&h.texData.slice.flatOffset>0&&(p.flatOffset=h.texData.slice.flatOffset),{name:e.variableNames[f],shapeInfo:p}}),a=r.map(h=>h.shapeInfo),i={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},l=SFe(r,i,e),c=vQ(t.gl,l),u=t.createProgram(c);return $e().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:c,source:l,webGLProgram:u,inShapeInfos:a,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(u),Object.assign({program:e,fragmentShader:c,source:l,webGLProgram:u,inShapeInfos:a,outShapeInfo:i},HQ(t,e,u)))}function HQ(t,e,n){const s=[],r=[];let a,i,l,c=null,u=null;u=t.getUniformLocation(n,"NAN",!1),$e().getNumber("WEBGL_VERSION")===1&&(c=t.getUniformLocation(n,"INFINITY",!1));const h=!1;for(const f of e.variableNames){const p={name:f,uniform:t.getUniformLocation(n,f,h),offset:t.getUniformLocation(n,`offset${f}`,h)};e.enableShapeUniforms&&(p.shape=t.getUniformLocation(n,`${f}Shape`,h),p.texShape=t.getUniformLocation(n,`${f}TexShape`,h)),s.push(p)}if(e.enableShapeUniforms&&(a=t.getUniformLocation(n,"outShape",h),l=t.getUniformLocation(n,"outShapeStrides",h),i=t.getUniformLocation(n,"outTexShape",h)),e.customUniforms)for(const f of e.customUniforms)r.push(t.getUniformLocation(n,f.name,h));return{variablesLocations:s,customUniformLocations:r,infLoc:c,nanLoc:u,outShapeLocation:a,outShapeStridesLocation:l,outTexShapeLocation:i}}function jB(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,s)=>{const r=n.logicalShape,a=e[s],i=a.shape;if(!xn(r,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${i} must match`);if(n.isUniform&&a.isUniform)return;const l=n.texShape,c=a.isUniform?null:a.texData.texShape;if(!xn(l,c))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${l} and ${c} must match`)})}function ize(t,e,n,s,r){e.program.enableShapeUniforms||(jB(e.inShapeInfos,n),jB([e.outShapeInfo],[s]));const a=s.texData.texture,i=s.texData.texShape;s.texData.isPacked?t.setOutputPackedMatrixTexture(a.texture,i[0],i[1]):t.setOutputMatrixTexture(a.texture,i[0],i[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),$e().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let c=0;c<n.length;++c){const u=n[c],{uniform:h,offset:f,shape:p,texShape:x}=e.variablesLocations[c];if(p){const{uniformShape:y}=FR(e.program.packedInputs,u.shape,u.texData.texShape);switch(y.length){case 1:t.gl.uniform1iv(p,new Int32Array(y));break;case 2:t.gl.uniform2iv(p,new Int32Array(y));break;case 3:t.gl.uniform3iv(p,new Int32Array(y));break;case 4:t.gl.uniform4iv(p,new Int32Array(y));break}}if(x&&t.gl.uniform2i(x,u.texData.texShape[0],u.texData.texShape[1]),h!=null){if(u.isUniform){if(ze(u.shape)<2)t.gl.uniform1f(h,u.uniformValues[0]);else{let y=u.uniformValues;y instanceof Float32Array||(y=new Float32Array(y)),t.gl.uniform1fv(h,y)}continue}u.texData.slice!=null&&f!=null&&t.gl.uniform1i(f,u.texData.slice.flatOffset),t.setInputMatrixTexture(u.texData.texture.texture,h,c)}}const l=e.outShapeLocation;if(l)switch(s.shape.length){case 1:t.gl.uniform1iv(l,new Int32Array(s.shape));break;case 2:t.gl.uniform2iv(l,new Int32Array(s.shape));break;case 3:t.gl.uniform3iv(l,new Int32Array(s.shape));break;case 4:t.gl.uniform4iv(l,new Int32Array(s.shape));break}if(e.outShapeStridesLocation){const c=Ut(s.shape);switch(s.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(c));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(c));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(c));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),e.program.customUniforms&&r)for(let c=0;c<e.program.customUniforms.length;++c){const u=e.program.customUniforms[c],h=e.customUniformLocations[c],f=r[c];if(u.type==="float")t.gl.uniform1fv(h,f);else if(u.type==="vec2")t.gl.uniform2fv(h,f);else if(u.type==="vec3")t.gl.uniform3fv(h,f);else if(u.type==="vec4")t.gl.uniform4fv(h,f);else if(u.type==="int")t.gl.uniform1iv(h,f);else if(u.type==="ivec2")t.gl.uniform2iv(h,f);else if(u.type==="ivec3")t.gl.uniform3iv(h,f);else if(u.type==="ivec4")t.gl.uniform4iv(h,f);else throw Error(`uniform type ${u.type} is not supported yet.`)}t.executeProgram()}function oze(t,e,n){let s="";e.concat(n).forEach(i=>{const l=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!i.isUniform){const c=i.texData.texShape,{useSqueezeShape:u,uniformShape:h,keptDims:f}=FR(t.packedInputs,i.shape,c);let p="",x="",y="";if(h.length===1&&t.packedInputs){const E=[Math.ceil(c[0]/2),Math.ceil(c[1]/2)];p=`${E[0]>1}_${E[1]>1}`}else if(h.length===2&&!t.packedInputs)x=`${h[0]>1}_${h[1]>1}`;else if(h.length>2&&!t.packedInputs){const E=Ut(h);y=`${E[0]===c[1]}_${E[E.length-1]===c[1]}`}const v=i.shape.length,b=h.length===2&&xn(i.shape,c),N=ze(i.shape)===1,S=Ch(i.shape,n.shape),k=!t.packedInputs&&v===n.shape.length&&xn(c,n.texData.texShape),T=t.packedInputs||h.length>2?"":`${c[0]>1}_${c[1]>1}`;s+=`${v}_${k}_${u?f:""}_${h.length}_${N}_${S}_${b}_${p}_${x}_${y}_${T}_${l}`}else{const c=i.isUniform?"uniform":i.texData.texShape;s+=`${i.shape}_${c}_${l}`}});const r=t.userCode;let a=t.constructor.name;return a+="_"+s+"_"+r+`${$e().getNumber("WEBGL_VERSION")}`,a}function fa(t){return $e().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lze{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=fx.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Ea();this.outputShape=e,this.enableShapeUniforms=fa(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Ij(["r","c","d"],e):em(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cze{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=fx.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=Ea();this.outputShape=e,this.enableShapeUniforms=fa(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?Ij(["r","c","d"],e):em(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uze{constructor(e){this.variableNames=["A"],this.outTexUsage=Wi.DOWNLOAD;const n=Ea();this.outputShape=e,this.userCode=`
      ${BQ}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class dze{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Wi.DOWNLOAD;const n=Ea();this.outputShape=e,this.userCode=`
      ${BQ}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hze={R:0,G:1,B:2,A:3};class kB{constructor(e,n=!1,s="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=Ea();this.outputShape=e,this.enableShapeUniforms=fa(this.outputShape.length);let a="result";n&&(a="floor(result * 255. + 0.5)");let i="";for(let l=0;l<s.length;l++){const c=s[l];i+=`
          if(offset == ${l}) {
            result = values[${hze[c]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?MR():LR(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${s.length});

        flatIndex = idiv(flatIndex, ${s.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${r.texture2D}(A, uv);
          ${i}
        }
        ${r.output} = vec4(${a}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mze{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=Ea();this.outputShape=e,this.enableShapeUniforms=fa(this.outputShape.length);let r="",a="result";n&&(a="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let l=0;l<=1;l++){const c=i*2+l;r+=`
          localCoords = coords;
          if(localCoords[2] + ${l} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${l};
          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${i};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${c}] = values[0];
            } else if (offset == 1) {
              result[${c}] = values[1];
            } else if (offset == 2) {
              result[${c}] = values[2];
            } else {
              result[${c}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?MR():LR(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${s.output} = ${a};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GQ(t){const e=Ea(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return bQ(t,n)}function qQ(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return SQ(t,e)}function KQ(t){const e=new Uint16Array([0,1,2,2,1,3]);return jQ(t,e)}function _b(t,e,n,s,r,a){CQ(e,n);const i=kQ(t),l=t.TEXTURE_2D;return wt(t,()=>t.bindTexture(l,i)),wt(t,()=>t.texParameteri(l,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),wt(t,()=>t.texParameteri(l,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),wt(t,()=>t.texParameteri(l,t.TEXTURE_MIN_FILTER,t.NEAREST)),wt(t,()=>t.texParameteri(l,t.TEXTURE_MAG_FILTER,t.NEAREST)),$e().getNumber("WEBGL_VERSION")===1?wt(t,()=>t.texImage2D(l,0,s,e,n,0,r,a,null)):wt(t,()=>t.texStorage2D(l,1,s,e,n)),wt(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:i,texShape:[n,e]}}function zR(t){return t.internalFormatFloat}function XQ(t,e,n,s){const[r,a]=Tb(e,n);return _b(t,r,a,zR(s),s.textureFormatFloat,t.FLOAT)}function BR(t){return t.internalFormatHalfFloat}function YQ(t,e,n,s){const[r,a]=Tb(e,n);return _b(t,r,a,BR(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function UR(t){return t.downloadTextureFormat}function QQ(t,e,n,s){const[r,a]=Tb(e,n);return _b(t,r,a,UR(s),t.RGBA,t.UNSIGNED_BYTE)}function VR(t){return t.internalFormatPackedFloat}function ZQ(t,e,n,s){const[r,a]=Zp(e,n);return _b(t,r,a,VR(s),t.RGBA,t.FLOAT)}function WR(t){return t.internalFormatPackedHalfFloat}function JQ(t,e,n,s){const[r,a]=Zp(e,n);return _b(t,r,a,WR(s),t.RGBA,s.textureTypeHalfFloat)}function eZ(t,e,n){return wt(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),ME(t,e,"clipSpacePos",n,3,20,0)&&ME(t,e,"uv",n,2,20,12)}function tZ(t,e,n,s,r,a){wt(t,()=>t.bindTexture(t.TEXTURE_2D,e));let i,l,c;r instanceof Uint8Array?(i=new Uint8Array(n*s*4),l=t.UNSIGNED_BYTE,c=t.RGBA):(i=new Float32Array(n*s*4),l=t.FLOAT,c=a.internalFormatPackedFloat),i.set(r),$e().getNumber("WEBGL_VERSION")===2?wt(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,s,t.RGBA,l,i)):wt(t,()=>t.texImage2D(t.TEXTURE_2D,0,c,n,s,0,t.RGBA,l,i)),wt(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function nZ(t,e,n){wt(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?$e().getNumber("WEBGL_VERSION")===2?wt(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):wt(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):$e().getNumber("WEBGL_VERSION")===2?wt(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):wt(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),wt(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function sZ(t,e,n,s){const r=t.createBuffer();wt(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,r));const l=4*4*e*n;return wt(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,l,t.STREAM_READ)),wt(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),wt(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),r}function rZ(t,e,n){const s=t,r=new Float32Array(n);return s.bindBuffer(s.PIXEL_PACK_BUFFER,e),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,r),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),r}function aZ(t,e,n,s){const[r,a]=Tb(e,n),i=4,l=new Uint8Array(lFe(e*n,i));return wt(t,()=>t.readPixels(0,0,r,a,s.downloadTextureFormat,t.UNSIGNED_BYTE,l)),new Float32Array(l.buffer)}function iZ(t,e,n,s,r,a,i,l){const c=t,u=new Float32Array(cFe(a,i));return c.bindBuffer(c.PIXEL_PACK_BUFFER,e),c.getBufferSubData(c.PIXEL_PACK_BUFFER,0,u),c.bindBuffer(c.PIXEL_PACK_BUFFER,null),u}function oZ(t,e,n){const s=new Float32Array(e*n*4);return wt(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,s)),s}const fze=Object.freeze(Object.defineProperty({__proto__:null,bindVertexProgramAttributeStreams:eZ,createBufferFromOutputTexture:sZ,createFloat16MatrixTexture:YQ,createFloat16PackedMatrixTexture:JQ,createFloat32MatrixTexture:XQ,createIndexBuffer:KQ,createPackedMatrixTexture:ZQ,createUnsignedBytesMatrixTexture:QQ,createVertexBuffer:qQ,createVertexShader:GQ,downloadByteEncodedFloatMatrixFromOutputTexture:aZ,downloadFloat32MatrixFromBuffer:rZ,downloadMatrixFromPackedOutputTexture:oZ,downloadPackedMatrixFromBuffer:iZ,getInternalFormatForFloat16MatrixTexture:BR,getInternalFormatForFloat16PackedMatrixTexture:WR,getInternalFormatForFloat32MatrixTexture:zR,getInternalFormatForPackedMatrixTexture:VR,getInternalFormatForUnsignedBytesMatrixTexture:UR,uploadDenseMatrixToTexture:tZ,uploadPixelDataToTexture:nZ},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Q1{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=$e().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,gQ(n,e)):this.gl=dl(n),e=this.gl,$e().getNumber("WEBGL_VERSION")===2){const a=e;this.createVertexArray=()=>wt(a,()=>a.createVertexArray()),this.bindVertexArray=i=>wt(a,()=>a.bindVertexArray(i)),this.deleteVertexArray=i=>wt(a,()=>a.deleteVertexArray(i)),this.getVertexArray=()=>wt(a,()=>a.getParameter(a.VERTEX_ARRAY_BINDING))}else if(e!=null){const a=e.getExtension("OES_vertex_array_object");if(a==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>wt(e,()=>a.createVertexArrayOES()),this.bindVertexArray=i=>wt(e,()=>a.bindVertexArrayOES(i)),this.deleteVertexArray=i=>wt(e,()=>a.deleteVertexArrayOES(i)),this.getVertexArray=()=>wt(e,()=>e.getParameter(a.VERTEX_ARRAY_BINDING_OES))}let s="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),$e().getNumber("WEBGL_VERSION")===1){const a="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=kg(this.gl,a),Hi(this.gl,i))this.textureHalfFloatExtension=kg(this.gl,i);else if($e().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),Hi(this.gl,r))this.colorBufferHalfFloatExtension=kg(this.gl,r);else if($e().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",Hi(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if(Hi(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=qQ(this.gl),this.indexBuffer=KQ(this.gl),this.framebuffer=TQ(this.gl),this.textureConfig=DR(this.gl,this.textureHalfFloatExtension)}get debug(){return $e().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;wt(e,()=>e.finish()),wt(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),wt(e,()=>e.deleteFramebuffer(this.framebuffer)),wt(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),wt(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),wt(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),XQ(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),YQ(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),QQ(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),nZ(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,s,r){this.throwIfDisposed(),tZ(this.gl,e,n,s,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),JQ(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),ZQ(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(FE(this.gl,this.framebuffer),this.outputTexture=null),wt(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,s){return this.downloadMatrixDriver(e,()=>aZ(this.gl,n,s,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,s,r,a,i){return iZ(this.gl,e,n,s,r,a,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return rZ(this.gl,e,n)}createBufferFromTexture(e,n,s){this.bindTextureToFrameBuffer(e);const r=sZ(this.gl,n,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,s;if($e().getBool("WEBGL_FENCE_API_ENABLED")){const r=e,a=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),s=()=>{const i=r.clientWaitSync(a,0,0);return i===r.ALREADY_SIGNALED||i===r.CONDITION_SATISFIED},n=a}else $e().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(n,$e().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:n,isFencePassed:s}}downloadMatrixFromPackedTexture(e,n,s){return this.downloadMatrixDriver(e,()=>oZ(this.gl,n,s))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=GQ(n));const s=wQ(n);wt(n,()=>n.attachShader(s,this.vertexShader)),wt(n,()=>n.attachShader(s,e)),NQ(n,s);const r=Object.assign(s,{vao:this.createVertexArray()});return this.debug&&q1(n,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;wt(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),eZ(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(wt(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&q1(this.gl,this.program),wt(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,s=!0){return this.throwIfDisposed(),s?EQ(this.gl,e,n):AQ(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),wt(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,s){this.throwIfDisposed(),this.throwIfNoProgram(),$Q(this.gl,e,n,s)}setOutputMatrixTexture(e,n,s){this.setOutputMatrixTextureDriver(e,s,n)}setOutputPackedMatrixTexture(e,n,s){this.throwIfDisposed();const[r,a]=Zp(n,s);this.setOutputMatrixTextureDriver(e,r,a)}setOutputMatrixWriteRegion(e,n,s,r){this.setOutputMatrixWriteRegionDriver(s,e,r,n)}setOutputPackedMatrixWriteRegion(e,n,s,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&q1(this.gl,this.program),Cg(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}wt(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),wt(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=kg(this.gl,$e().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if($e().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=s.createQuery();return s.beginQuery(r.TIME_ELAPSED_EXT,a),a}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if($e().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,s=this.getQueryTimerExtensionWebGL2();n.endQuery(s.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await X_(()=>this.disposed||this.isQueryAvailable(e,$e().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,$e().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const s=this.gl;return s.getQueryParameter(e,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(e,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),a=s.getQueryParameter(e,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),a&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),r=s.getQueryObjectEXT(e,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=pze(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:s}=this.itemsToPoll[n];s()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in $e().platform&&(s=$e().platform.setTimeoutCustom.bind($e().platform)),X_(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),K1(this.gl,e,this.framebuffer),this.debug&&Cg(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(K1(this.gl,this.outputTexture,this.framebuffer),this.debug&&Cg(this.gl)):FE(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const s=n();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(e,n,s){this.throwIfDisposed();const r=this.gl;K1(r,e,this.framebuffer),this.debug&&Cg(r),this.outputTexture=e,wt(r,()=>r.viewport(0,0,n,s)),wt(r,()=>r.scissor(0,0,n,s))}setOutputMatrixWriteRegionDriver(e,n,s,r){this.throwIfDisposed(),wt(this.gl,()=>this.gl.scissor(e,n,s,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function pze(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:gze,bincountImpl:lZ,bincountReduceImpl:xze,bitwiseAndImpl:yze,castImpl:bze,ceilImpl:vze,concatImpl:wze,equalImpl:Nze,expImpl:Sze,expm1Impl:jze,floorImpl:kze,gatherNdImpl:Cze,gatherV2Impl:Tze,greaterImpl:_ze,greaterEqualImpl:Eze,lessImpl:Aze,lessEqualImpl:$ze,linSpaceImpl:Ize,logImpl:Rze,maxImpl:Oze,maximumImpl:Dze,minimumImpl:Pze,multiplyImpl:Lze,negImpl:Mze,notEqualImpl:Fze,prodImpl:zze,raggedGatherImpl:Bze,raggedRangeImpl:Uze,raggedTensorToTensorImpl:Vze,rangeImpl:Wze,rsqrtImpl:Hze,scatterImpl:Gze,sigmoidImpl:qze,simpleAbsImpl:cZ,sliceImpl:Kze,sparseFillEmptyRowsImpl:Xze,sparseReshapeImpl:Yze,sparseSegmentReductionImpl:uZ,sqrtImpl:Qze,staticRegexReplaceImpl:Zze,stridedSliceImpl:Jze,stringNGramsImpl:e8e,stringSplitImpl:t8e,stringToHashBucketFastImpl:n8e,subImpl:s8e,tileImpl:r8e,topKImpl:a8e,transposeImpl:HR,uniqueImpl:i8e}=ZY;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dZ(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function Sa(t,e){return e===1?[t]:dZ(t,e)}function o8e(t,e){if(t===1)return"rc";let n="";for(let s=0;s<t;s++)n+=e[s],s<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class l8e{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=fa(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=Sa("rc",this.rank),s=es(this.rank),r=this.getOutOfBoundsCondition(n),a=this.getSetup(n),i=this.getOutput(n);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${r}) {
            setOutput(vec4(0));
          } else {
            ${a}

            setOutput(vec4(${i}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let s=0;s<=1;s++)for(let r=0;r<=1;r++){let a=`${s===0?"r":"rp1"}, ${r===0?"c":"cp1"}`;for(let i=2;i<this.rank;i++)a=`${e[e.length-1-i]},`+a;n.push(a)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let s=this.rank-2;s<this.rank;s++)n+=`${e[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${r};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hZ{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=fa(this.outputShape.length);let s="";for(let r=0;r<4;r++){let a="thisRC = rc;";r%2===1&&(a+="thisRC.z += 1;"),r>1&&(a+="thisRC.y += 1;"),s+=`
        ${a}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${c8e(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?MR():LR(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${s}

        setOutput(result);
      }
    `}}function c8e(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?NFe(["r","c","d"],"inputShape"):em(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class u8e{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,s){const r=TB(n,s),a=_B(e,r,s);a in this.freeTextures||(this.freeTextures[a]=[]),a in this.usedTextures||(this.usedTextures[a]=[]);const i=CB(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[a].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const c=this.freeTextures[a].pop();return this.usedTextures[a].push(c),c}let l;return r===Vr.PACKED_2X2_FLOAT32?l=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===Vr.PACKED_2X2_FLOAT16?l=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===Vr.UNPACKED_FLOAT32?l=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===Vr.UNPACKED_FLOAT16?l=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===Vr.PACKED_4X1_UNSIGNED_BYTE&&(l=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[a].push(l),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),l}releaseTexture(e,n,s,r){if(this.freeTextures==null)return;const a=TB(s,r),i=_B(n,a,r);i in this.freeTextures||(this.freeTextures[i]=[]);const l=CB(n,a,this.gpgpu.gl,this.gpgpu.textureConfig,r),c=$e().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");c!==-1&&this._numBytesAllocated>c?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=l):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=l),this.numUsedTextures--;const u=this.usedTextures[i],h=u&&u.indexOf(e);if(h==null||h<0)throw new Error("Cannot release a texture that was never provided by this texture manager");u[h]=u[u.length-1],u.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function d8e(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function CB(t,e,n,s,r){const a=h8e(e,s);let i;if(r){const[c,u]=Zp(t[0],t[1]);i=c*u}else{const[c,u]=Tb(t[0],t[1]);i=c*u}const l=d8e(n,a);return i*l}function h8e(t,e){switch(t){case Vr.PACKED_2X2_FLOAT32:return VR(e);case Vr.PACKED_2X2_FLOAT16:return WR(e);case Vr.UNPACKED_FLOAT32:return zR(e);case Vr.UNPACKED_FLOAT16:return BR(e);case Vr.PACKED_4X1_UNSIGNED_BYTE:return UR(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function m8e(t){return $e().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?Vr.PACKED_2X2_FLOAT32:Vr.UNPACKED_FLOAT32:t?Vr.PACKED_2X2_FLOAT16:Vr.UNPACKED_FLOAT16}function TB(t,e){if(t===Wi.UPLOAD)return Vr.PACKED_2X2_FLOAT32;if(t===Wi.RENDER||t==null)return m8e(e);if(t===Wi.DOWNLOAD||t===Wi.PIXELS)return Vr.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function _B(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $l{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=fa(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Mo="if (isnan(x)) return x;",f8e="return x;",EB="return abs(x);",p8e="return (x >= 0.0) ? x : (exp(x) - 1.0);",g8e=Mo+`
  return (x < 0.0) ? 0.0 : x;
`,x8e=Mo+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Ru="return x;",y8e="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b8e="return x;",v8e=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,w8e=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,N8e=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,S8e="return 1.0 / (1.0 + exp(-1.0 * x));";class Fu{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=fa(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class j8e{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=fa(this.outputShape.length);const n=e.length,s=Sa("rc",n),r=es(n),a=o8e(n,s),i=s.slice(-2),l=n<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${a});

        setOutput(getChannel(packedInput, ${l}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const k8e=XS,C8e=1e-7,T8e=1e-4,v1={};function _8e(t){return t in v1||(v1[t]={}),v1[t]}const E8e=$e().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),A8e=600;function $8e(){return $e().global.screen==null?1024:$e().global.screen.height*$e().global.screen.width*window.devicePixelRatio*A8e/1024/1024}class Eb extends hN{nextDataId(){return Eb.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!$e().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof Q1)n=e;else{const s=dl($e().getNumber("WEBGL_VERSION"),e);n=new Q1(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=dl($e().getNumber("WEBGL_VERSION"));n=new Q1(s),this.binaryCache=_8e($e().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new u8e(this.gpgpu),this.numMBBeforeWarning=$8e(),this.texData=new UA(this,Qo())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,s,r,a,i){const l=this.makeTensorInfo(n,s),c=this.texData.get(l.dataId);c.isPacked=!1,c.texture={texture:e,texShape:[r,a]},c.texShape=[r,a];const u=Tg(n),h=new kB(u,!1,i),f=this.runWebGLProgram(h,[l],s,[[r,a]]);return f.shape=n,c.texture=null,this.disposeIntermediateTensorInfo(l),f.dataId}write(e,n,s){if(($e().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||$e().getBool("DEBUG"))&&this.checkNumericalProblems(e),s==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:n,dtype:s,values:e,usage:Wi.UPLOAD,refCount:1}),r}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,s,r,a){if($e().getBool("DEBUG")&&this.checkNumericalProblems(n),r==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:s,dtype:r,values:n,usage:Wi.UPLOAD,refCount:a})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:s,dtype:r,complexTensorInfos:a,slice:i,shape:l,isPacked:c}=n;if(i!=null){let p;c?p=new Fu(l,Ru):p=new $l(l,Ru);const x=this.runWebGLProgram(p,[{dataId:e,shape:l,dtype:r}],r),y=this.readSync(x.dataId);return this.disposeIntermediateTensorInfo(x),y}if(s!=null)return this.convertAndCacheOnCPU(e);if(r==="string")return s;const u=this.activeTimers!=null;let h;u&&(h=zr());let f;if(r==="complex64"){const p=this.readSync(a.real.dataId),x=this.readSync(a.imag.dataId);f=Mc(p,x)}else f=this.getValuesFromTexture(e);return u&&(this.downloadWaitMs+=zr()-h),this.convertAndCacheOnCPU(e,f)}async read(e){if(this.pendingRead.has(e)){const y=this.pendingRead.get(e);return new Promise(v=>y.push(v))}const n=this.texData.get(e),{values:s,shape:r,slice:a,dtype:i,complexTensorInfos:l,isPacked:c}=n;if(a!=null){let y;c?y=new Fu(r,Ru):y=new $l(r,Ru);const v=this.runWebGLProgram(y,[{dataId:e,shape:r,dtype:i}],i),b=this.read(v.dataId);return this.disposeIntermediateTensorInfo(v),b}if(s!=null)return this.convertAndCacheOnCPU(e);if($e().getBool("DEBUG")&&!$e().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&$e().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let u=null,h;if(i!=="complex64"&&$e().get("WEBGL_BUFFER_SUPPORTED")){h=this.decode(e);const y=this.texData.get(h.dataId);u=this.gpgpu.createBufferFromTexture(y.texture.texture,...y1(r))}this.pendingRead.set(e,[]),i!=="complex64"&&await this.gpgpu.createAndWaitForFence();let f;if(i==="complex64"){const y=await Promise.all([this.read(l.real.dataId),this.read(l.imag.dataId)]),v=y[0],b=y[1];f=Mc(v,b)}else if(u==null)f=this.getValuesFromTexture(e);else{const y=ze(r);f=this.gpgpu.downloadFloat32MatrixFromBuffer(u,y)}if(h!=null&&this.disposeIntermediateTensorInfo(h),u!=null){const y=this.gpgpu.gl;wt(y,()=>y.deleteBuffer(u))}const p=this.convertAndCacheOnCPU(e,f),x=this.pendingRead.get(e);return this.pendingRead.delete(e),x.forEach(y=>y(p)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&Qo().removeDataId(e,this),this.pendingDeletes--),p}readToGPU(e,n={}){const s=this.texData.get(e),{values:r,shape:a,slice:i,dtype:l,isPacked:c,texture:u}=s;if(l==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(i!=null){let x;c?x=new Fu(a,Ru):x=new $l(a,Ru);const y=this.runWebGLProgram(x,[{dataId:e,shape:a,dtype:l}],l),v=this.readToGPU(y,n);return this.disposeIntermediateTensorInfo(y),v}if(u==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const h=this.decode(e,n.customTexShape),f=Qo().makeTensorFromTensorInfo(h),p=this.texData.get(h.dataId);return Object.assign({tensorRef:f},p.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>Oc(r));return on(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return on(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const s=e[n];if(!xQ(s))throw $e().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:s,isPacked:r}=this.texData.get(e),a=ze(n);if($e().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const p=this.decode(e),x=this.texData.get(p.dataId),y=this.gpgpu.downloadMatrixFromPackedTexture(x.texture.texture,...y1(n)).subarray(0,a);return this.disposeIntermediateTensorInfo(p),y}const i=$e().getBool("WEBGL_PACK")&&r===!0,l=i?Tg(n):n,c=i?new dze(l):new uze(l),u=this.runWebGLProgram(c,[{shape:l,dtype:s,dataId:e}],"float32"),h=this.texData.get(u.dataId),f=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(h.texture.texture,h.texShape[0],h.texShape[1]).subarray(0,a);return this.disposeIntermediateTensorInfo(u),f}timerAvailable(){return $e().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,s=[];let r=!1;this.programTimersStack==null?(this.programTimersStack=s,r=!0):this.activeTimers.push(s),this.activeTimers=s,e();const a=zl(this.activeTimers.map(c=>c.query)).filter(c=>c!=null),i=zl(this.activeTimers.map(c=>c.name)).filter(c=>c!=null);this.activeTimers=n,r&&(this.programTimersStack=null);const l={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if($e().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const c=await Promise.all(a);l.kernelMs=MH(c),l.getExtraProfileInfo=()=>c.map((u,h)=>({name:i[h],ms:u})).map(u=>`${u.name}: ${u.ms}`).join(", ")}else l.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,l})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return $e().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:zr(),endMs:null}}endTimer(e){return $e().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=zr(),e)}async getQueryTime(e){if($e().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:s}=this.texData.get(e);return s!=null&&(this.disposeData(s.real.dataId,n),this.disposeData(s.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:s,texShape:r,usage:a,isPacked:i,slice:l}=this.texData.get(e),c=l&&l.origDataId||e,u=this.dataRefCount.get(c);u>1?this.dataRefCount.set(c,u-1):(this.dataRefCount.delete(c),n!=null&&(this.numBytesInGPU-=this.computeBytes(r,s),this.textureManager.releaseTexture(n,r,a,i)));const h=this.texData.get(e);h.texture=null,h.texShape=null,h.isPacked=!1,h.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=E8e){return $e().getBool("WEBGL_CPU_FORWARD")&&e.every(s=>this.texData.get(s.dataId).texture==null&&ze(s.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){zi("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return k8e(e.shape,n)}packedUnaryOp(e,n,s){const r=new Fu(e.shape,n),a=this.compileAndRun(r,[e],s);return Qo().makeTensorFromTensorInfo(a)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const r=cZ(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,r)}if($e().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,EB,e.dtype);const n=new $l(e.shape,EB),s=this.compileAndRun(n,[e]);return Qo().makeTensorFromTensorInfo(s)}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&Al(s[0])){const a=s.map(i=>Rl(i));r=this.write(a,e,n)}else r=this.write(s,e,n);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:n}}makeOutput(e,n,s){return Qo().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,s),this)}unpackTensor(e){const n=new j8e(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new l8e(e.shape);return this.runWebGLProgram(n,[e],e.dtype,null,!0)}packedReshape(e,n){const s=[Dh(e.shape),...Ph(e.shape)],r={dtype:e.dtype,shape:s,dataId:e.dataId},a=[Dh(n),...Ph(n)],i=new hZ(a,s),l=!0,c=[s],u=this.runWebGLProgram(i,[r],e.dtype,c,l);return{dataId:u.dataId,shape:n,dtype:u.dtype}}decode(e,n){const s=this.texData.get(e),{isPacked:r,shape:a,dtype:i}=s;if(n!=null){const p=ze(a),x=n[0]*n[1]*4;Z(p<=x,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const l=Tg(a);let c;r?c=new cze(l):c=new lze(l);const u=!0,h=[n??y1(l)],f=this.runWebGLProgram(c,[{shape:l,dtype:i,dataId:e}],i,h,u,n);return{dtype:i,shape:a,dataId:f.dataId}}runWebGLProgram(e,n,s,r,a=!1,i){const l=this.makeTensorInfo(e.outputShape,s),c=this.texData.get(l.dataId);if(e.packedOutput&&(c.isPacked=!0),e.outPackingScheme===fx.DENSE){const N=i??y1(e.outputShape);c.texShape=N.map(S=>S*2)}if(e.outTexUsage!=null&&(c.usage=e.outTexUsage),ze(l.shape)===0)return c.values=Er(l.dtype,0),l;const u=[],h=n.map(N=>{if(N.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let S=this.texData.get(N.dataId);if(S.texture==null){if(!e.packedInputs&&ze(N.shape)<=$e().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:N.shape,texData:null,isUniform:!0,uniformValues:S.values};e.packedInputs&&(S.isPacked=!0,S.shape=N.shape)}if(this.uploadToGPU(N.dataId),!!S.isPacked!=!!e.packedInputs)N=S.isPacked?this.unpackTensor(N):this.packTensor(N),u.push(N),S=this.texData.get(N.dataId);else if(S.isPacked&&!px(S.shape,N.shape)){const k=N,T=N.shape;N.shape=S.shape,N=this.packedReshape(N,T),u.push(N),S=this.texData.get(N.dataId),k.shape=T}return{shape:N.shape,texData:S,isUniform:!1}});this.uploadToGPU(l.dataId);const f={shape:l.shape,texData:c,isUniform:!1},p=oze(e,h,f),x=this.getAndSaveBinary(p,()=>aze(this.gpgpu,e,h,f)),y=this.activeTimers!=null;let v;y&&(v=this.startTimer()),$e().get("ENGINE_COMPILE_ONLY")||ize(this.gpgpu,x,h,f,r),u.forEach(N=>this.disposeIntermediateTensorInfo(N)),y&&(v=this.endTimer(v),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(v)}));const b=$e().getNumber("WEBGL_FLUSH_THRESHOLD");if(b>0){const N=zr();N-this.lastGlFlushTime>b&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=N)}if(!$e().getBool("WEBGL_LAZILY_UNPACK")&&c.isPacked&&a===!1){const N=this.unpackTensor(l);return this.disposeIntermediateTensorInfo(l),N}return l}compileAndRun(e,n,s,r,a=!1){return s=s||n[0].dtype,this.runWebGLProgram(e,n,s,r,a)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||($e().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=Ee(()=>{if(!$e().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=$e().getBool("DEBUG");$e().set("DEBUG",!1);const n=this.abs(Bt(1e-8)).dataSync()[0];if($e().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?C8e:T8e}uploadToGPU(e){const n=this.texData.get(e),{shape:s,dtype:r,values:a,texture:i,usage:l,isPacked:c}=n;if(i!=null)return;const u=this.activeTimers!=null;let h;u&&(h=zr());let f=n.texShape;if(f==null&&(f=OQ(s,c),n.texShape=f),a!=null){const p=Tg(s);let x,y=f[1],v=f[0];const b=a instanceof Uint8Array||a instanceof Uint8ClampedArray;(c||!b)&&([y,v]=Zp(f[0],f[1])),c?x=new mze(p,b):x=new kB(p,b);const N=b?[v,y]:f,S=this.makeTensorInfo(N,r),k=this.texData.get(S.dataId);b?k.usage=Wi.PIXELS:k.usage=Wi.UPLOAD,k.texShape=N,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(S.dataId),y,v,a);const T=[[v,y]],D=this.runWebGLProgram(x,[S],r,T,!0),A=this.texData.get(D.dataId);n.texShape=A.texShape,n.isPacked=A.isPacked,n.usage=A.usage,$e().get("ENGINE_COMPILE_ONLY")?this.disposeData(D.dataId):(n.texture=A.texture,n.values=null,this.texData.delete(D.dataId)),this.disposeIntermediateTensorInfo(S),u&&(this.uploadWaitMs+=zr()-h)}else{const p=this.acquireTexture(f,l,r,c);n.texture=p}}convertAndCacheOnCPU(e,n){const s=this.texData.get(e),{dtype:r}=s;return n!=null&&(s.values=I8e(n,r)),s.values}acquireTexture(e,n,s,r){if(this.numBytesInGPU+=this.computeBytes(e,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const a=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${a} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,r)}computeBytes(e,n){return e[0]*e[1]*Jg(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const s=new Promise(r=>{try{this.checkCompletion_(n),r(!0)}catch(a){throw a}});e.push(s)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await kI(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(PR(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:s,infLoc:r,nanLoc:a,outShapeLocation:i,outShapeStridesLocation:l,outTexShapeLocation:c}=HQ(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=s,e.infLoc=r,e.nanLoc=a,e.outShapeLocation=i,e.outShapeStridesLocation=l,e.outTexShapeLocation=c}}createTensorFromGPUData(e,n,s){e.channels=e.channels||"RGBA";const{texture:r,height:a,width:i,channels:l}=e,c=Qo().backend;if(!c.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const u=c.writeTexture(r,n,s,a,i,l);return Qo().makeTensorFromDataId(u,n,s,c)}}Eb.nextDataId=0;function I8e(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let s=0;s<n.length;++s)n[s]=Math.round(t[s]);return n}else throw new Error(`Unknown dtype ${e}`)}/** @license See the LICENSE file. */const mZ="4.22.0";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fZ(){$e().set("WEBGL_FORCE_F16_TEXTURES",!0)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */QA()&&JA("webgl",()=>new Eb,2);const R8e={forceHalfFloat:fZ};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GR=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Lh{constructor(e,n,s){this.variableNames=["A","B"],this.outputShape=en(n,s),this.enableShapeUniforms=fa(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nm=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class r0{constructor(e,n,s,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=en(n,s);const a=this.outputShape.length;this.enableShapeUniforms=fa(a);let i="";if(r)if(a===0||ze(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          ${es(a)} coords = getOutputCoords();
        `,a===1)this.enableShapeUniforms?i+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:i+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const c=Sa("coords",a);this.enableShapeUniforms?i+=`
            bool nextRowOutOfBounds =
              (${c[a-2]} + 1) >= outShape[${a} - 2];
            bool nextColOutOfBounds =
              (${c[a-1]} + 1) >= outShape[${a} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:i+=`
            bool nextRowOutOfBounds =
              (${c[a-2]} + 1) >= ${this.outputShape[a-2]};
            bool nextColOutOfBounds =
              (${c[a-1]} + 1) >= ${this.outputShape[a-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${i}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bi(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const O8e={kernelName:cp,backendName:"webgl",kernelFunc:bi};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xd(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,a=n.makeTensorInfo(s.shape,"complex64"),i=n.texData.get(a.dataId),l=bi({inputs:{x:s},backend:n}),c=bi({inputs:{x:r},backend:n});return i.complexTensorInfos={real:l,imag:c},a}const D8e={kernelName:wN,backendName:"webgl",kernelFunc:xd};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pZ="return (a < 0.) ? b * a : a;",gZ=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function P8e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:a}=s,i=n.makeTensorInfo([],"float32",Yc(a,"float32")),l=$e().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new r0(gZ,r.shape,i.shape):new Lh(pZ,r.shape,i.shape),c=n.runWebGLProgram(l,[r,i],"float32");return n.disposeIntermediateTensorInfo(i),c}const L8e={kernelName:hy,backendName:"webgl",kernelFunc:P8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xZ="return (a < 0.) ? b * a : a;",yZ=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function M8e(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e,a=$e().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new r0(yZ,s.shape,r.shape):new Lh(xZ,s.shape,r.shape);return n.runWebGLProgram(a,[s,r],"float32")}const F8e={kernelName:$y,backendName:"webgl",kernelFunc:M8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a0="if (isnan(x)) return x;";function En({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:s}){return({inputs:r,backend:a})=>{const{x:i}=r,l=a,c=s||i.dtype;if(l.shouldExecuteOnCPU([i])&&n!=null){const f=l.texData.get(i.dataId),p=n(f.values,c);return l.makeTensorInfo(i.shape,c,p)}const u=$e().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let h;return u?h=new Fu(i.shape,e):h=new $l(i.shape,t),l.runWebGLProgram(h,[i],c)}}function ta({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:s=!1,cpuKernelImpl:r,dtype:a}){return({inputs:i,backend:l})=>{const{a:c,b:u}=i,h=l;if(s&&c.dtype==="complex64"){const y=h.texData.get(c.dataId),v=h.texData.get(u.dataId),[b,N]=[[y.complexTensorInfos.real,v.complexTensorInfos.real],[y.complexTensorInfos.imag,v.complexTensorInfos.imag]].map(k=>{const[T,E]=k,D={dataId:T.dataId,dtype:T.dtype,shape:c.shape},A={dataId:E.dataId,dtype:E.dtype,shape:u.shape},I=new Lh(t,c.shape,u.shape);return h.runWebGLProgram(I,[D,A],Va(T.dtype,E.dtype))}),S=xd({inputs:{real:b,imag:N},backend:h});return h.disposeIntermediateTensorInfo(b),h.disposeIntermediateTensorInfo(N),S}const f=a||Va(c.dtype,u.dtype);if((c.dtype==="string"||u.dtype==="string"||h.shouldExecuteOnCPU([c,u]))&&r!=null){const y=h.texData.get(c.dataId).values,v=h.texData.get(u.dataId).values,b=c.dtype==="string"?Fc(y):y,N=c.dtype==="string"?Fc(v):v,[S,k]=r(c.shape,u.shape,b,N,f),T=h.makeTensorInfo(k,f),E=h.texData.get(T.dataId);return E.values=S,T}const p=$e().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let x;return p?x=new r0(e,c.shape,u.shape,n):x=new Lh(t,c.shape,u.shape),h.runWebGLProgram(x,[c,u],f)}}function gx(t,e=!1){if(t==="linear")return e?b8e:f8e;if(t==="relu")return e?w8e:g8e;if(t==="elu")return e?v8e:p8e;if(t==="relu6")return e?N8e:x8e;if(t==="prelu")return e?yZ:xZ;if(t==="leakyrelu")return e?gZ:pZ;if(t==="sigmoid")return e?S8e:y8e;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bZ{constructor(e,n,s,r=!1,a=!1,i=!1,l=null,c=!1,u=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=fa(this.outputShape.length);const h=r?e[1]:e[2],f=Math.ceil(h/2),p=r?"i * 2, rc.y":"rc.y, i * 2",x=a?"rc.z, i * 2":"i * 2, rc.z",y=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],v=a?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let b="",N="";l&&(c?b=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${l}
        }`:u?b=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${l}
        }`:b=`vec4 activation(vec4 x) {
          ${l}
        }`,N="result = activation(result);");const S=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),c&&this.variableNames.push("preluActivationWeights"),u&&this.variableNames.push("leakyreluAlpha");let k="rc.x",T="rc.x";e[0]<n[0]?k=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(T=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${b}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${f}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${k};
        int batchB = ${T};
        for (int i = 0; i < ${f}; i++) {
          vec4 a = getMatrixA(batchA, ${p});
          vec4 b = getMatrixB(batchB, ${x});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${y[0]} * ${v[0]});
          result += (${y[1]} * ${v[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${S}

        ${N}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AB={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class $B{constructor(e,n,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=en(n,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IB="return a * b;";function qR(t){const{inputs:e,backend:n}=t,{a:s,b:r}=e,a=Va(s.dtype,r.dtype);if(s.dtype==="complex64"){const l=n.texData.get(s.dataId),c=n.texData.get(r.dataId),u=new $B(AB.REAL,s.shape,r.shape),h=new $B(AB.IMAG,s.shape,r.shape),f=[{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:s.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:c.complexTensorInfos.real.dataId,dtype:c.complexTensorInfos.real.dtype,shape:r.shape},{dataId:c.complexTensorInfos.imag.dataId,dtype:c.complexTensorInfos.imag.dtype,shape:r.shape}],p=n.runWebGLProgram(u,f,"float32"),x=n.runWebGLProgram(h,f,"float32"),y=xd({inputs:{real:p,imag:x},backend:n});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(x),y}if(n.shouldExecuteOnCPU([s,r])){const l=n.texData.get(s.dataId),c=n.texData.get(r.dataId),[u,h]=Lze(s.shape,r.shape,l.values,c.values,a),f=n.makeTensorInfo(h,a),p=n.texData.get(f.dataId);return p.values=u,f}let i;return $e().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new r0(IB,s.shape,r.shape):i=new Lh(IB,s.shape,r.shape),n.runWebGLProgram(i,[s,r],a)}const z8e={kernelName:yp,backendName:"webgl",kernelFunc:qR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B8e(t,e,n){const s=[Dh(t.shape),...Ph(t.shape)],r={dtype:t.dtype,shape:s,dataId:t.dataId},a=[Dh(e),...Ph(e)],i=new hZ(a,s),l=!0,c=[s],u=n.runWebGLProgram(i,[r],t.dtype,c,l);return{dataId:u.dataId,shape:e,dtype:u.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vt(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:a}=s,i=n,l=ze(r.shape),c=WA(a,l),u=ze(c);Z(l===u,()=>`The new shape (${c}) has ${u} elements and the old shape (${r.shape}) has ${l} elements. The new shape and old shape must have the same number of elements.`);const h=i.texData.get(r.dataId);return h.isPacked&&!px(r.shape,c)&&!(h.texture!==null&&px(h.shape,c))?B8e(r,c,i):(i.incRef(r.dataId),{dataId:r.dataId,shape:c,dtype:r.dtype})}const U8e={kernelName:Ry,backendName:"webgl",kernelFunc:vt};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class RB{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:a,outSize:i}=e;this.outputShape=[r,i];const l=Math.floor(s/4)*4,c=s%4;let u="sumValue += dot(values, ones);";if(n!=null){const f=1/n;u=`sumValue += dot(values * ${vh(f)?f.toPrecision(2):f}, ones);`}let h="";a%s>0&&(h=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${h}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${l}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${u}
        }

        int inIdx = inOffset + ${l};
        if (${c===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${u}
        } else if (${c===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${u}
        } else if (${c===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${u}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class V8e{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:a,outSize:i}=e;this.outputShape=[r,i];let l="0.0",c="";n==="prod"?l="1.0":n==="min"?(l="1.0 / 1e-20",c="min"):n==="max"&&(l="-1.0 / 1e-20",c="max");let u=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?u="sumValue":n==="prod"?u="prodValue":n==="all"?u="allValue":n==="any"&&(u="anyValue");const h=Math.floor(s/4)*4,f=s%4;let p=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${c}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${c}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,x="vec4";n==="all"?(l="1.0",p=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,x="bvec4"):n==="any"&&(l="0.0",p=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,x="bvec4");let y="";a%s>0&&(y=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${l};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${y}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${l});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${h}; i += 4) {
          int inIdx = inOffset + i;
          ${x} values = ${x}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${p}
        }

        int inIdx = inOffset + ${h};
        if (${f===1}) {
          ${x} values = ${x}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${f===2}) {
          ${x} values = ${x}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${p}
        } else if (${f===3}) {
          ${x} values = ${x}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${p}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W8e(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],s=oj(n);e.push({inSize:n,windowSize:s,outSize:Math.ceil(n/s)})}return e}function sm(t,e,n,s){const r=W8e(t.shape);let a=t;for(let i=0;i<r.length;i++){const{inSize:l,windowSize:c,outSize:u}=r[i];let h,f;n==="mean"?h=i===0?new RB({windowSize:c,inSize:l,batchSize:t.shape[0],outSize:u},l):new RB({windowSize:c,inSize:l,batchSize:t.shape[0],outSize:u}):h=new V8e({windowSize:c,inSize:l,batchSize:t.shape[0],outSize:u},n),f=a,a=s.runWebGLProgram(h,[a],e),f.dataId!==t.dataId&&s.disposeIntermediateTensorInfo(f)}return a}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class H8e{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let i=0;i<s.length;i++)s[i]=e[n[i]];this.outputShape=s,this.rank=s.length;const r=es(this.rank),a=G8e(n);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${a}));
    }
    `}}function G8e(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(e);for(let r=0;r<t.length;r++)s[t[r]]=n[r];return s.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class q8e{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(e.length);for(let h=0;h<s.length;h++)s[h]=e[n[h]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=es(this.rank),a=dZ("rc",this.rank),i=new Array(this.rank);for(let h=0;h<n.length;h++)i[n[h]]=a[h];const l=`vec2(${i.slice(-2).join()})`,c=`++${a[this.rank-1]} < ${s[this.rank-1]}`,u=`getChannel(getA(${i.join()}), ${l})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${u};
      if(${c}) {
        result[1] = ${u};
      }
      --${a[this.rank-1]};
      if(++${a[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${u};
        if(${c}) {
          result[3] = ${u};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rj(t,e,n){const s=$e().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new q8e(t.shape,e):new H8e(t.shape,e);return n.runWebGLProgram(s,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K8e(t,e,n,s){const r=e,a=t.shape.length,i=fn(r,t.shape);let l=i;const c=Os(l,a),u=c!=null;let h=t;u&&(h=Rj(t,c,s),l=Hs(l.length,a)),Jr("sum",l,a);const[f,p]=Dr(h.shape,l);let x=f;n&&(x=Ws(f,i));const y=ze(p),b=ze(t.shape)/y,N=vt({inputs:{x:h},attrs:{shape:[b,y]},backend:s}),S=wS(t.dtype),k=sm(N,S,"sum",s),T=vt({inputs:{x:k},attrs:{shape:x},backend:s});return s.disposeIntermediateTensorInfo(N),s.disposeIntermediateTensorInfo(k),u&&s.disposeIntermediateTensorInfo(h),T}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oj(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:i}=s;return K8e(r,a,i,n)}const X8e={kernelName:Fy,backendName:"webgl",kernelFunc:Oj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ca(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{perm:a}=s,i=n,l=r.shape.length,c=new Array(l);for(let h=0;h<c.length;h++)c[h]=r.shape[a[h]];let u;if(i.shouldExecuteOnCPU([r])){const f=i.texData.get(r.dataId).values,p=HR(f,r.shape,r.dtype,a,c);u=i.makeTensorInfo(c,r.dtype);const x=i.texData.get(u.dataId);x.values=p}else u=Rj(r,a,i);return u}const Y8e={kernelName:ch,backendName:"webgl",kernelFunc:Ca};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vZ=1e3;function x2({a:t,b:e,transposeA:n,transposeB:s,backend:r,bias:a=null,preluActivationWeights:i=null,leakyreluAlpha:l=0,activation:c=null}){const u=t.shape.length,h=e.shape.length,f=n?t.shape[u-2]:t.shape[u-1],p=s?e.shape[h-1]:e.shape[h-2],x=n?t.shape[u-1]:t.shape[u-2],y=s?e.shape[h-2]:e.shape[h-1],v=t.shape.slice(0,-2),b=e.shape.slice(0,-2),N=ze(v),S=ze(b),T=en(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([x,y]);Z(f===p,()=>`Error in matMul: inner shapes (${f}) and (${p}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${s} must match.`);const E=n?[N,f,x]:[N,x,f],D=s?[S,y,p]:[S,p,y],A=vt({inputs:{x:t},backend:r,attrs:{shape:E}}),I=vt({inputs:{x:e},backend:r,attrs:{shape:D}}),P=[A,I],$=Math.max(N,S),R=n?A.shape[1]:A.shape[2],F=a!=null,W=i!=null,q=c==="leakyrelu",X=c!=null?gx(c,!0):null,z=F||W||q||X!=null;let K;if((x===1||y===1)&&R>vZ&&z===!1){let Y=A,B=I;n&&(Y=Ca({inputs:{x:A},backend:r,attrs:{perm:[0,2,1]}}),P.push(Y)),s&&(B=Ca({inputs:{x:I},backend:r,attrs:{perm:[0,2,1]}}),P.push(B));const O=y!==1,U=y===1;let J=Y;O&&(J=vt({inputs:{x:Y},backend:r,attrs:{shape:[$,R,1]}}),P.push(J));const se=y===1?2:1;let ae=B;U&&(ae=vt({inputs:{x:B},backend:r,attrs:{shape:[$,1,R]}}),P.push(ae));const fe=qR({inputs:{a:J,b:ae},backend:r});K=Oj({inputs:{x:fe},backend:r,attrs:{axis:se,keepDims:!0}}),P.push(fe)}else{const Y=Va(t.dtype,e.dtype),B=new bZ(E,D,[$,x,y],n,s,F,X,W,q),O=[A,I];if(a!=null&&O.push(a),W&&O.push(i),q){const U=r.makeTensorInfo([],"float32",Yc(l,"float32"));O.push(U),P.push(U)}K=r.runWebGLProgram(B,O,Y)}const H=vt({inputs:{x:K},backend:r,attrs:{shape:T}});P.push(K);for(const Y of P)r.disposeIntermediateTensorInfo(Y);return H}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q8e(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:a,bias:i,preluActivationWeights:l}=e,{transposeA:c,transposeB:u,activation:h,leakyreluAlpha:f}=s;return x2({a:r,b:a,transposeA:c,transposeB:u,backend:n,bias:i,preluActivationWeights:l,leakyreluAlpha:f,activation:h})}const Z8e={kernelName:ex,backendName:"webgl",kernelFunc:Q8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OB="return abs(x);";function J8e(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const a=n.texData.get(s.dataId),i=cZ(a.values);return n.makeTensorInfo(s.shape,s.dtype,i)}let r;return $e().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Fu(s.shape,OB):r=new $l(s.shape,OB),n.runWebGLProgram(r,[s],s.dtype)}const eBe={kernelName:Wx,backendName:"webgl",kernelFunc:J8e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tBe=Mo+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,nBe=En({opSnippet:tBe}),sBe={kernelName:Vf,backendName:"webgl",kernelFunc:nBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rBe=Mo+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,aBe=En({opSnippet:rBe}),iBe={kernelName:Wf,backendName:"webgl",kernelFunc:aBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DB="return a + b;",oBe=ta({opSnippet:DB,packedOpSnippet:DB,supportsComplex:!0,cpuKernelImpl:gze}),lBe={kernelName:Gh,backendName:"webgl",kernelFunc:oBe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cBe{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((a,i)=>`T${i}`);const s=[];this.variableNames.forEach(a=>{s.push(`float v${a} = get${a}AtOutCoords();`)});const r=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uBe{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((a,i)=>`T${i}`);const s=[];this.variableNames.forEach(a=>{s.push(`vec4 v${a} = get${a}AtOutCoords();`)});const r=this.variableNames.map(a=>`v${a}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z1(t){const{inputs:e,backend:n}=t,s=e;if(s.length===1)return bi({inputs:{x:s[0]},backend:n});if(s.length>$e().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const c=Math.floor(s.length/2),u=Z1({inputs:s.slice(0,c),backend:n}),h=Z1({inputs:s.slice(c),backend:n});return Z1({inputs:[u,h],backend:n})}const r=s.map(c=>c.dtype).reduce((c,u)=>Va(c,u)),a=s.map(c=>c.shape),l=$e().getBool("WEBGL_PACK")?new uBe(s[0].shape,a):new cBe(s[0].shape,a);return n.runWebGLProgram(l,s,r)}const dBe={kernelName:Hx,backendName:"webgl",kernelFunc:Z1};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hBe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:i}=s,l=r.shape.length,c=fn(a,r.shape);let u=c;const h=Os(u,l);let f=r;h!=null&&(f=Ca({inputs:{x:r},backend:n,attrs:{perm:h}}),u=Hs(u.length,l)),Jr("all",u,l);const[p,x]=Dr(f.shape,u),y=ze(x),v=vt({inputs:{x:f},backend:n,attrs:{shape:[-1,y]}}),b=sm(v,v.dtype,"all",n);let N;if(i){const S=Ws(p,c);N=vt({inputs:{x:b},backend:n,attrs:{shape:S}})}else N=vt({inputs:{x:b},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(b),h!=null&&n.disposeIntermediateTensorInfo(f),N}const mBe={kernelName:pN,backendName:"webgl",kernelFunc:hBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fBe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:i}=s,l=r.shape.length,c=fn(a,r.shape);let u=c;const h=Os(u,l);let f=r;h!=null&&(f=Ca({inputs:{x:r},backend:n,attrs:{perm:h}}),u=Hs(u.length,l)),Jr("any",u,l);const[p,x]=Dr(f.shape,u),y=ze(x),v=vt({inputs:{x:f},backend:n,attrs:{shape:[-1,y]}}),b=sm(v,v.dtype,"any",n);let N;if(i){const S=Ws(p,c);N=vt({inputs:{x:b},backend:n,attrs:{shape:S}})}else N=vt({inputs:{x:b},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(b),h!=null&&n.disposeIntermediateTensorInfo(f),N}const pBe={kernelName:gN,backendName:"webgl",kernelFunc:fBe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gBe{constructor(e,n,s){this.variableNames=["A"];const{windowSize:r,batchSize:a,outSize:i}=e;s||this.variableNames.push("bestIndicesA"),this.outputShape=[a,i];const l=n==="max"?">":"<",c=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${c};
          float candidate = getA(batch, inIdx);
          if (candidate ${l} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xBe{constructor(e,n,s,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,Z(e.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const a=e[e.length-1],i=Math.ceil(a/n);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");const l=this.outputShape,c=l.length,u=es(c),h=Sa("coords",c);let f,p;if(i===1){p=c+1;const I=es(p);f=`
        ${I} sourceLocR = ${I}(${h.join()}, 0);
        ++${h[c-1]};
        ${I} sourceLocG = ${I}(${h.join()}, 0);
        ++${h[c-2]};
        ${I} sourceLocA = ${I}(${h.join()}, 0);
        --${h[c-1]};
        ${I} sourceLocB = ${I}(${h.join()}, 0);
        --${h[c-2]};`}else p=c,f=`
        ${u} sourceLocR = coords;
        ++${h[c-1]};
        ${u} sourceLocG = coords;
        ++${h[c-2]};
        ${u} sourceLocA = coords;
        --${h[c-1]};
        ${u} sourceLocB = coords;
        --${h[c-2]};`;const x=["x","y","z","w","u","v"].slice(0,p),y="."+x[p-1],v=x.map(I=>"int "+I),b=Sa("sourceLocR",p-1).concat("inIdx.r"),N=Sa("sourceLocG",p-1).concat("inIdx.g"),S=Sa("sourceLocB",p-1).concat("inIdx.b"),k=Sa("sourceLocA",p-1).concat("inIdx.a"),T=s==="max"?"greaterThan":"lessThan",E=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${b.join()}),
                             getBestIndicesAChannel(${N.join()}),
                             getBestIndicesAChannel(${S.join()}),
                             getBestIndicesAChannel(${k.join()})));`,D=`vec4(
            getAChannel(${b.join()}),
            hasNextCol ? getAChannel(${N.join()}) : 0.,
            hasNextRow ? getAChannel(${S.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${k.join()}) : 0.)`,A=r?"":`
      float getBestIndicesAChannel(${v.join()}) {
        return getChannel(getBestIndicesA(${x.join()}),
                                          vec2(${x.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${v.join()}) {
        return getChannel(getA(${x.join()}),
                               vec2(${x.slice(-2).join()}));
      }
      ${A}
      void main() {
        ${u} coords = getOutputCoords();
        bool hasNextCol = ${h[c-1]} < ${l[c-1]-1};
        bool hasNextRow = ${h[c-2]} < ${l[c-2]-1};
        ${f}
        ivec4 srcIdx = ivec4(sourceLocR${y}, sourceLocG${y},
          sourceLocB${y}, sourceLocA${y}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${D};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${E}
          vec4 candidate = ${D};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${T}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wZ(t,e,n,s=null){let r=e.shape[0],a=e.shape[1];s!=null&&(r=s.shape[0],a=s.shape[1]);const i=oj(a),l={windowSize:i,inSize:a,batchSize:r,outSize:Math.ceil(a/i)},c=new gBe(l,n,s==null),u=[e];s!=null&&u.push(s);const h=t.runWebGLProgram(c,u,"int32");if(h.shape[1]===1)return h;const f=wZ(t,e,n,h);return t.disposeIntermediateTensorInfo(h),f}function NZ(t,e,n,s=null){const r=s!=null?s.shape:e.shape,a=r[r.length-1],i=oj(a),l=new xBe(r,i,n,s==null),c=s==null?[e]:[e,s],u=t.runWebGLProgram(l,c,"int32");if(u.shape.length===e.shape.length){const h=NZ(t,e,n,u);return t.disposeIntermediateTensorInfo(u),h}return u}function SZ(t,e,n,s){const r=[n];if(Jr("arg"+s.charAt(0).toUpperCase()+s.slice(1),r,e.shape.length),!$e().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const a=[],i=t.texData.get(e.dataId),l=i!==null&&i.isPacked;let c=e;l&&(c=t.unpackTensor(e),a.push(c));const[u,h]=Dr(c.shape,r),f=ze(h),p=vt({inputs:{x:c},backend:t,attrs:{shape:[-1,f]}});a.push(p);const x=wZ(t,p,s);a.push(x);const y=vt({inputs:{x},backend:t,attrs:{shape:u}});return a.forEach(v=>t.disposeIntermediateTensorInfo(v)),y}return NZ(t,e,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yBe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a}=s;let i=fn(a,r.shape);const l=Os(i,r.shape.length);let c=r;const u=[];l!=null&&(c=Ca({inputs:{x:r},backend:n,attrs:{perm:l}}),u.push(c),i=Hs(i.length,c.shape.length)),Jr("argMax",[i[0]],c.shape.length);const h=SZ(n,c,i[0],"max");return u.forEach(f=>n.disposeIntermediateTensorInfo(f)),h}const bBe={kernelName:Gx,backendName:"webgl",kernelFunc:yBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vBe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a}=s;let i=fn(a,r.shape);const l=Os(i,r.shape.length);let c=r;const u=[];l!=null&&(c=Ca({inputs:{x:r},backend:n,attrs:{perm:l}}),u.push(c),i=Hs(i.length,c.shape.length)),Jr("argMin",[i[0]],c.shape.length);const h=SZ(n,c,i[0],"min");return u.forEach(f=>n.disposeIntermediateTensorInfo(f)),h}const wBe={kernelName:qx,backendName:"webgl",kernelFunc:vBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NBe=Mo+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,SBe=En({opSnippet:NBe}),jBe={kernelName:Hf,backendName:"webgl",kernelFunc:SBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kBe=Mo+"return log(x + sqrt(x * x + 1.0));",CBe=En({opSnippet:kBe}),TBe={kernelName:Gf,backendName:"webgl",kernelFunc:CBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Be=Mo+`
  return atan(x);
`,EBe=En({opSnippet:_Be}),ABe={kernelName:qf,backendName:"webgl",kernelFunc:EBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $Be=GR+`
  return atan(a, b);
`,IBe=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+nm+`
  return result;
`,RBe=ta({opSnippet:$Be,packedOpSnippet:IBe}),OBe={kernelName:Xf,backendName:"webgl",kernelFunc:RBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DBe=Mo+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,PBe=En({opSnippet:DBe}),LBe={kernelName:Kf,backendName:"webgl",kernelFunc:PBe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xx{constructor(e,n,s,r=!1,a=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,l=e.strideHeight,c=e.strideWidth,u=e.dilationHeight,h=e.dilationWidth,f=e.effectiveFilterHeight,p=e.effectiveFilterWidth,x=e.padInfo.top,y=e.padInfo.left;this.outputShape=e.outShape;const v=n==="avg",b=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,N=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let S="0.0";if(v||(S="-1.0 / 1e-20"),s){this.userCode=`
        const ivec2 strides = ivec2(${l}, ${c});
        const ivec2 pads = ivec2(${x}, ${y});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${f};
              wR += ${u}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${p};
                wC += ${h}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value >= currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?a?b:N:`wR * ${p} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const k="max";let T=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(T="avgValue / max(count, 1.0)");const E=Math.floor(i/4)*4,D=i%4,A=`
      if (${v}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${k}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${x}, ${y});
      const float initializationValue = ${S};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${S});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${f};
            wR += ${u}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${E}; wC += 4) {
            int xC = xCCorner + wC * ${h};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${h}, d),
              getValue(batch, xR, xC + 2 * ${h}, d),
              getValue(batch, xR, xC + 3 * ${h}, d)
            );

            ${A}
          }

          int xC = xCCorner + ${E};
          if (${D===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${A}
          } else if (${D===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${h}, d),
              initializationValue,
              initializationValue
            );

            ${A}
          } else if (${D===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${h}, d),
              getValue(batch, xR, xC + 2 * ${h}, d),
              initializationValue
            );

            ${A}
          }
        }
        setOutput(${T});
      }
    `}}class KR{constructor(e,n,s,r=!1,a=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,l=e.strideDepth,c=e.strideHeight,u=e.strideWidth,h=e.dilationDepth,f=e.dilationHeight,p=e.dilationWidth,x=e.effectiveFilterDepth,y=e.effectiveFilterHeight,v=e.effectiveFilterWidth,b=e.padInfo.front,N=e.padInfo.top,S=e.padInfo.left;this.outputShape=e.outShape;const k=n==="avg";let T="0.0";if(k||(T="-1.0 / 1e-20"),s){this.userCode=`
        const ivec3 strides =
            ivec3(${l}, ${c}, ${u});
        const ivec3 pads = ivec3(${b}, ${N}, ${S});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${x};
              wD += ${h}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${y};
                wR += ${f}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${v};
                  wC += ${p}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value >= currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?a?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${y} * ${v} +
                      wR * ${v} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const E="max";let D=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(D="avgValue / max(count, 1.0)");const A=Math.floor(i/4)*4,I=i%4,P=`
      if (${k}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${E}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${l}, ${c}, ${u});
      const ivec3 pads = ivec3(${b}, ${N}, ${S});
      const float initializationValue = ${T};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${T});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${x};
            wD += ${h}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${y};
            wR += ${f}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${A}; wC += 4) {
              int xC = xCCorner + wC * ${p};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                getValue(batch, xD, xR, xC + 3 * ${p}, ch)
              );

              ${P}
            }

            int xC = xCCorner + ${A};
            if (${I===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${P}
            } else if (${I===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                initializationValue,
                initializationValue
              );

              ${P}
            } else if (${I===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${p}, ch),
                getValue(batch, xD, xR, xC + 2 * ${p}, ch),
                initializationValue
              );

              ${P}
            }
          }
        }
        setOutput(${D});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MBe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Jp(r,"avgPool");const{filterSize:a,strides:i,pad:l,dimRoundingMode:c}=s,u=1;Z(Zr(i,u),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const h=Po(r.shape,a,i,u,l,c);if(h.filterWidth===1&&h.filterHeight===1&&xn(h.inShape,h.outShape))return bi({inputs:{x:r},backend:n});const f=new xx(h,"avg",!1);return n.runWebGLProgram(f,[r],"float32")}const FBe={kernelName:Kx,backendName:"webgl",kernelFunc:MBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zBe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:a,strides:i,pad:l,dimRoundingMode:c,dataFormat:u}=s,h=[1,1,1],f=Qc(r.shape,a,i,h,l,c,u),p=new KR(f,"avg",!1);return n.runWebGLProgram(p,[r],"float32")}const BBe={kernelName:Xx,backendName:"webgl",kernelFunc:zBe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UBe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterHeight,u=e.effectiveFilterWidth,h=c-1-e.padInfo.top,f=u-1-e.padInfo.left,p=1/(n*s);this.userCode=`
      const ivec2 pads = ivec2(${h}, ${f});
      const float avgMultiplier = float(${p});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${c};
            wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${u};
            wC+= ${l}) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class VBe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,a=e.strideDepth,i=e.strideHeight,l=e.strideWidth,c=e.dilationDepth,u=e.dilationHeight,h=e.dilationWidth,f=e.effectiveFilterDepth,p=e.effectiveFilterHeight,x=e.effectiveFilterWidth,y=f-1-e.padInfo.front,v=p-1-e.padInfo.top,b=x-1-e.padInfo.left,N=1/(n*s*r);this.userCode=`
      const ivec3 pads = ivec3(${y}, ${v}, ${b});
      const float avgMultiplier = float(${N});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${c}) {
          float dyD = float(dyDCorner + wD) / ${a}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${p};
              wR += ${u}) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${x};
                wC += ${h}) {
              float dyC = float(dyCCorner + wC) / ${l}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WBe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:a}=e,i=a,{filterSize:l,strides:c,pad:u,dimRoundingMode:h}=s,f=[1,1,1],p=Qc(i.shape,l,c,f,u,h),x=new VBe(p);return n.runWebGLProgram(x,[r],i.dtype)}const HBe={kernelName:yN,backendName:"webgl",kernelFunc:WBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GBe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:a}=e,i=a;Jp([r,a],"avgPoolGrad");const{filterSize:l,strides:c,pad:u}=s,h=Po(i.shape,l,c,1,u),f=new UBe(h);return n.runWebGLProgram(f,[r],i.dtype)}const qBe={kernelName:xN,backendName:"webgl",kernelFunc:GBe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KBe(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:a}=e,{transposeA:i,transposeB:l}=s;return x2({a:r,b:a,transposeA:i,transposeB:l,backend:n})}const XBe={kernelName:Yx,backendName:"webgl",kernelFunc:KBe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YBe{constructor(e,n,s,r,a,i){this.outputShape=[],this.variableNames=["x","mean","variance"],en(e,n),en(e,s);let l="0.0";r!=null&&(en(e,r),this.variableNames.push("offset"),l="getOffsetAtOutCoords()");let c="1.0";a!=null&&(en(e,a),this.variableNames.push("scale"),c="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${l};
        float scale = ${c};
        float inv = scale * inversesqrt(variance + float(${i}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class QBe{constructor(e,n,s,r,a,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],en(e,n),en(e,s);let l="vec4(0.0)";r!=null&&(en(e,r),this.variableNames.push("offset"),l="getOffsetAtOutCoords()");let c="vec4(1.0)";a!=null&&(en(e,a),this.variableNames.push("scale"),c="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${l};
        vec4 scale = ${c};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${i}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZBe=({inputs:t,backend:e,attrs:n})=>{const{x:s,mean:r,variance:a,offset:i,scale:l}=t;Z(r.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),Z(i==null||r.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),Z(l==null||r.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:c}=n;c==null&&(c=.001);const u=[s,r,a];let h=null;i!=null&&(h=i.shape,u.push(i));let f=null;l!=null&&(f=l.shape,u.push(l));const p=$e().getBool("WEBGL_PACK_NORMALIZATION")?new QBe(s.shape,r.shape,a.shape,h,f,c):new YBe(s.shape,r.shape,a.shape,h,f,c);return e.runWebGLProgram(p,u,u[0].dtype)},JBe={kernelName:cy,backendName:"webgl",kernelFunc:ZBe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class e7e{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=es(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=t7e(this.rank);let r;const a=e.map((i,l)=>`sourceLoc.${UE[l]} = start[${l}] + coords.${UE[l]};`);r=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${a.join(`
`)}
      `,this.userCode=`
      void main() {
        ${r}
        setOutput(getSource(${s}));
      }
    `}}const UE=["x","y","z","w","u","v"];function t7e(t){if(t===1)return"sourceLoc";if(t<=6)return UE.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class n7e{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=es(this.rank),s=Sa("coords",this.rank),r=Sa("sourceLoc",this.rank),a=this.rank===1?"sourceLoc":`vec2(${r.slice(-2).join()})`,i=`getChannel(getSource(${r.join()}), ${a})`,l=`
      result.x = ${i};
      if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${i};
        --${r[this.rank-1]};
      }
    `,c=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${e[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${i};
        if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${i};
        }
      }
    `,u=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((h,f)=>`start[${f}]`).join()});`:e.map((h,f)=>`${r[f]} = ${s[f]} + start[${f}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${u}
        vec4 result = vec4(0.);
        ${l}
        ${c}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s7e(t,e,n,s){const r=s.texData.get(t.dataId),a=s.makeTensorInfo(n,t.dtype),i=s.texData.get(a.dataId);Object.assign(i,r),i.refCount=1,i.shape=n,i.dtype=t.dtype;let l=SI(e,Ut(t.shape));r.slice&&(l+=r.slice.flatOffset),i.slice={flatOffset:l,origDataId:r.slice&&r.slice.origDataId||t.dataId};const c=s.dataRefCount.get(i.slice.origDataId)||1;return s.dataRefCount.set(i.slice.origDataId,c+1),a}function i0(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:a,size:i}=s,[l,c]=ij(r,a,i);if(vI(r,l,c),ze(c)===0)return n.makeTensorInfo(c,r.dtype,[]);if(n.shouldExecuteOnCPU([r])||r.dtype==="string"){const f=n.texData.get(r.dataId),p=Kze(f.values,l,c,r.shape,r.dtype);return n.makeTensorInfo(c,r.dtype,p)}const{isPacked:u}=n.texData.get(r.dataId),h=NI(r.shape,l,c);if(u||!h){const f=$e().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new n7e(c):new e7e(c),p=[l];return n.runWebGLProgram(f,[r],r.dtype,p)}return n.uploadToGPU(r.dataId),s7e(r,l,c,n)}const r7e={kernelName:My,backendName:"webgl",kernelFunc:i0};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a7e=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:a,crops:i}=s;Z(r.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const l=a.reduce((S,k)=>S*k),c=mb(r.shape,a,l),u=fb(c.length,a.length),h=pb(r.shape,a,l),f=EI(i,a.length),p=AI(h,i,a.length),x=[],y=vt({inputs:{x:r},backend:n,attrs:{shape:c}}),v=Ca({inputs:{x:y},backend:n,attrs:{perm:u}}),b=vt({inputs:{x:v},backend:n,attrs:{shape:h}}),N=i0({inputs:{x:b},backend:n,attrs:{begin:f,size:p}});return x.push(y),x.push(v),x.push(b),x.forEach(S=>n.disposeIntermediateTensorInfo(S)),N},i7e={kernelName:Qx,backendName:"webgl",kernelFunc:a7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o7e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:a}=e,{size:i}=s,l=n.readSync(r.dataId),c=n.readSync(a.dataId),u=lZ(l,c,a.dtype,a.shape,i);return n.makeTensorInfo([i],a.dtype,u)}const l7e={kernelName:bN,backendName:"webgl",kernelFunc:o7e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c7e=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,u7e=`
  return float(int(a.r) & int(b.r));
`;function d7e(t){const{inputs:e,backend:n}=t,{a:s,b:r}=e,a=$e().getBool("WEBGL_PACK_BINARY_OPERATIONS"),i=$e().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([s,r])||i===1){const c=n.texData.get(s.dataId).values,u=n.texData.get(r.dataId).values,[h,f]=yze(s.shape,r.shape,c,u,s.dtype),p=n.makeTensorInfo(f,s.dtype),x=n.texData.get(p.dataId);return x.values=h,p}let l;return a?l=new r0(c7e,s.shape,r.shape,!1):l=new Lh(u7e,s.shape,r.shape),n.runWebGLProgram(l,[s,r],s.dtype)}const h7e={kernelName:Zx,backendName:"webgl",kernelFunc:d7e};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m7e(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,a=n.readSync(s.dataId),i=n.readSync(r.dataId),l=en(Array.from(a),Array.from(i));return n.makeTensorInfo([l.length],"int32",Int32Array.from(l))}const f7e={kernelName:vN,backendName:"webgl",kernelFunc:m7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const p7e="return float(a != b);",jZ=ta({opSnippet:p7e,cpuKernelImpl:Fze,dtype:"bool"}),g7e={kernelName:Cy,backendName:"webgl",kernelFunc:jZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ab(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return bi({inputs:{x:r.complexTensorInfos.real},backend:n})}const x7e={kernelName:eS,backendName:"webgl",kernelFunc:Ab};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y7e="return float(int(x));";function b7e(t,e){const n=new $l(t.shape,y7e),s=e.runWebGLProgram(n,[t],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VE(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:a}=s;if(a==="complex64"){if(r.dtype==="complex64")return bi({inputs:{x:r},backend:n});const i=Us(r.shape),l=VE({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),c=xd({inputs:{real:l,imag:i},backend:n});return i.dispose(),n.disposeIntermediateTensorInfo(l),c}if(r.dtype==="complex64"){const i=Ab({inputs:{input:r},backend:n}),l=VE({inputs:{x:i},backend:n,attrs:{dtype:a}});return n.disposeIntermediateTensorInfo(i),l}if(!HA(r.dtype,a)){const i=bi({inputs:{x:r},backend:n});return{dataId:i.dataId,shape:i.shape,dtype:a}}if(n.shouldExecuteOnCPU([r])){const i=n.texData.get(r.dataId).values,[l,c,u]=bze(i,r.shape,r.dtype,a);return n.makeTensorInfo(l,c,u)}if(a==="int32")return b7e(r,n);if(a==="bool"){const i=n.makeTensorInfo([],"bool",Er("bool",1)),c=jZ({inputs:{a:r,b:i},backend:n});return n.disposeIntermediateTensorInfo(i),c}throw new Error(`Error in Cast: failed to cast ${r.dtype} to ${a}`)}const v7e={kernelName:Yf,backendName:"webgl",kernelFunc:VE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PB="return ceil(x);",w7e=En({opSnippet:PB,packedOpSnippet:PB,cpuKernelImpl:vze}),N7e={kernelName:Qf,backendName:"webgl",kernelFunc:w7e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class S7e{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class j7e{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k7e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{clipValueMin:a,clipValueMax:i}=s;let l;$e().getBool("WEBGL_PACK_CLIP")?l=new j7e(r.shape):l=new S7e(r.shape);const c=[[a],[i]];return n.runWebGLProgram(l,[r],r.dtype,c)}const C7e={kernelName:Zf,backendName:"webgl",kernelFunc:k7e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class T7e{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LB(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function _7e(t){const{inputs:e,backend:n}=t,{x:s}=e,r=n.texData.get(s.dataId),a=new T7e(s.shape),i=[LB(s,r.complexTensorInfos.real),LB(s,r.complexTensorInfos.imag)];return n.runWebGLProgram(a,i,i[0].dtype)}const E7e={kernelName:Jx,backendName:"webgl",kernelFunc:_7e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class A7e{constructor(e){this.outputShape=[],this.outputShape=Dl(e,1),this.variableNames=e.map((i,l)=>`T${l}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let i=1;i<n.length;i++)n[i]=n[i-1]+e[i][1];const s=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<n.length;i++){const l=n[i-1];s.push(`else if (yC < ${n[i]}) setOutput(getT${i}(yR, yC-${l}));`)}const r=n.length,a=n[n.length-1];s.push(`else setOutput(getT${r}(yR, yC-${a}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $7e{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Dl(e,n);const s=this.outputShape,r=s.length,a=es(r),i=Sa("coords",r),l=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((v,b)=>`T${b}`);const c=new Array(e.length-1);c[0]=e[0][n];for(let v=1;v<c.length;v++)c[v]=c[v-1]+e[v][n];const u=l[n],h=l.slice(-2),f=l.join();let p=`if (${u} < ${c[0]}) {
        return getChannel(
            getT0(${f}), vec2(${h.join()}));
        }`;for(let v=1;v<c.length;v++){const b=c[v-1];p+=`
        if (${u} < ${c[v]}  && ${u} >= ${c[v-1]}) {
          return getChannel(
            getT${v}(${w1(l,u,b)}),
            vec2(${w1(h,u,b)}));
        }`}const x=c.length,y=c[c.length-1];p+=`
        return getChannel(
          getT${x}(${w1(l,u,y)}),
          vec2(${w1(h,u,y)}));`,this.userCode=`
      float getValue(${l.map(v=>"int "+v)}) {
        ${p}
      }

      void main() {
        ${a} coords = getOutputCoords();
        vec4 result = vec4(getValue(${i}), 0., 0., 0.);

        ${i[r-1]} = ${i[r-1]} + 1;
        if (${i[r-1]} < ${s[r-1]}) {
          result.g = getValue(${i});
        }

        ${i[r-2]} = ${i[r-2]} + 1;
        if (${i[r-2]} < ${s[r-2]}) {
          result.a = getValue(${i});
        }

        ${i[r-1]} = ${i[r-1]} - 1;
        if (${i[r-2]} < ${s[r-2]} &&
            ${i[r-1]} < ${s[r-1]}) {
          result.b = getValue(${i});
        }
        setOutput(result);
      }
    `}}function w1(t,e,n){const s=t.indexOf(e);return t.map((a,i)=>i===s?`${a} - ${n}`:a).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dj(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return bi({inputs:{x:r.complexTensorInfos.imag},backend:n})}const I7e={kernelName:zN,backendName:"webgl",kernelFunc:Dj};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _g(t,e,n){const s=t[0].dtype;if(s==="complex64"){const x=t.map(S=>Ab({inputs:{input:S},backend:n})),y=t.map(S=>Dj({inputs:{input:S},backend:n})),v=_g(x,e,n),b=_g(y,e,n),N=xd({inputs:{real:v,imag:b},backend:n});return x.forEach(S=>n.disposeIntermediateTensorInfo(S)),y.forEach(S=>n.disposeIntermediateTensorInfo(S)),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(b),N}let r=n.shouldExecuteOnCPU(t);if(s==="string"&&(r=!0),r){const x=t.map(T=>{const D=[-1,ze(T.shape.slice(e))];return vt({inputs:{x:T},backend:n,attrs:{shape:D}})}),y=x.map(T=>({vals:n.readSync(T.dataId),shape:T.shape})),v=Dl(x.map(T=>T.shape),1),b=x[0].shape[0]===1,N=wze(y,v,s,b),S=Dl(t.map(T=>T.shape),e),k=n.makeTensorInfo(S,s,N);return x.forEach(T=>n.disposeIntermediateTensorInfo(T)),k}const a=t.filter(x=>ze(x.shape)>0),i=$e().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&a[0].shape.length>1;if(a.length===1){const x=i?new $l(t[0].shape,Ru):new Fu(t[0].shape,Ru);return n.runWebGLProgram(x,t,s)}const l=$e().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(a.length>l){const x=[];for(let v=0;v<a.length;v+=l){const b=a.slice(v,v+l);x.push(_g(b,e,n))}const y=_g(x,e,n);for(const v of x)n.disposeIntermediateTensorInfo(v);return y}if(i){const x=new $7e(a.map(y=>y.shape),e);return n.runWebGLProgram(x,a,s)}const{tensors2D:c,outShape:u}=R7e(a,e,n),h=new A7e(c.map(x=>x.shape)),f=n.runWebGLProgram(h,c,s);c.forEach(x=>n.disposeIntermediateTensorInfo(x));const p=vt({inputs:{x:f},attrs:{shape:u},backend:n});return n.disposeIntermediateTensorInfo(f),p}function R7e(t,e,n){const s=Dl(t.map(a=>a.shape),e);return{tensors2D:t.map(a=>vt({inputs:{x:a},attrs:{shape:[-1,ze(a.shape.slice(e))]},backend:n})),outShape:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kZ(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,a=fn(r,e[0].shape)[0],i=e.map(u=>u.shape);CI(i,a);const l=Dl(e.map(u=>u.shape),a);if(ze(l)===0)return n.makeTensorInfo(l,e[0].dtype,[]);const c=e.filter(u=>ze(u.shape)>0);return c.length===1?bi({inputs:{x:c[0]},backend:n}):_g(c,a,n)}const O7e={kernelName:ey,backendName:"webgl",kernelFunc:kZ};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CZ{constructor(e,n=!1,s=null,r=!1,a=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const i=e.padInfo.top,l=e.padInfo.left,c=e.strideHeight,u=e.strideWidth,h=e.dilationHeight,f=e.dilationWidth,p=e.filterHeight,x=e.filterWidth,y=Math.floor(e.inChannels/4)*4,v=e.inChannels%4,b=e.dataFormat==="channelsLast",N=b?1:2,S=b?2:3,k=b?3:1;let T="",E="";s&&(r?T=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:a?T=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:T=`
          float activation(float x) {
            ${s}
          }
        `,E="result = activation(result);");const D=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${T}

      const ivec2 strides = ivec2(${c}, ${u});
      const ivec2 pads = ivec2(${i}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${k}];

        ivec2 xRCCorner =
            ivec2(coords[${N}], coords[${S}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${p}; wR++) {
          int xR = xRCorner + wR * ${h};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${x}; wC++) {
            int xC = xCCorner + wC * ${f};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${y}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${b}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${v===1}) {

              if (${b}) {
                dotProd +=
                    getX(batch, xR, xC, ${y}) *
                    getW(wR, wC, ${y}, d2);
              } else {
                dotProd +=
                    getX(batch, ${y}, xR, xC) *
                    getW(wR, wC, ${y}, d2);
              }

            } else if (${v===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${y}, d2),
                getW(wR, wC, ${y} + 1, d2)
              );

              if (${b}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${y}),
                  getX(batch, xR, xC, ${y} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${y}, xR, xC),
                  getX(batch, ${y} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${v===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${y}, d2),
                getW(wR, wC, ${y} + 1, d2),
                getW(wR, wC, ${y} + 2, d2)
              );

              if (${b}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${y}),
                  getX(batch, xR, xC, ${y} + 1),
                  getX(batch, xR, xC, ${y} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${y}, xR, xC),
                  getX(batch, ${y} + 1, xR, xC),
                  getX(batch, ${y} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${D}
        ${E}
        setOutput(result);
      }
    `}}class D7e{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,s=e.padInfo.top,r=e.padInfo.left,a=e.strideDepth,i=e.strideHeight,l=e.strideWidth,c=e.dilationDepth,u=e.dilationHeight,h=e.dilationWidth,f=e.filterDepth,p=e.filterHeight,x=e.filterWidth,y=Math.floor(e.inChannels/4)*4,v=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${a}, ${i}, ${l});
      const ivec3 pads = ivec3(${n}, ${s}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${f}; wF++) {
          int xF = xFCorner + wF * ${c};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p}; wR++) {
            int xR = xRCorner + wR * ${u};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${x}; wC++) {
              int xC = xCCorner + wC * ${h};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${y}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${v===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${y}) *
                  getW(wF, wR, wC, ${y}, d2);
              } else if (${v===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${y}),
                  getX(batch, xF, xR, xC, ${y} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${y}, d2),
                  getW(wF, wR, wC, ${y} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${v===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${y}),
                  getX(batch, xF, xR, xC, ${y} + 1),
                  getX(batch, xF, xR, xC, ${y} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${y}, d2),
                  getW(wF, wR, wC, ${y} + 1, d2),
                  getW(wF, wR, wC, ${y} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TZ{constructor(e,n=!1,s=null,r=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=fa(this.outputShape.length);const i=e.padInfo.left,l=e.strideWidth,c=e.dilationWidth,u=e.filterHeight,h=e.filterWidth,f=h;let p=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let b=0;b<h;b++)p+=`
           vec4 xTexelC${b*2};
           int xTexelC${b*2}Ready;
           vec4 xTexelC${b*2+1};
           int xTexelC${b*2+1}Ready;
           vec4 xC${b};`;p+=`
     for (int r = 0; r < ${u}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let b=0;b<h;b++)p+=`
           xTexelC${b*2} = vec4(0.0);
           xTexelC${b*2}Ready = 0;
           xTexelC${b*2+1} = vec4(0.0);
           xTexelC${b*2+1}Ready = 0;
           xC${b} = vec4(0.0);`;p+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let b=0;b<(f+1)/2;b++){const N=b*2;if(p+=`
           xC = xCCorner + ${N*c};
           `,l===1){if(N<h&&(i%2===1?(p+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${N}Ready == 0) {
                   xTexelC${N} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${N}.zw = vec2(0.0);
                   }
                   xTexelC${N}Ready = 1;
                 }
               `,c===1&&N>0?p+=`
                 xC${N} = vec4(xTexelC${N-2}.zw, xTexelC${N}.xy);
                 `:p+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${N} = vec4(previous.zw, xTexelC${N}.xy);
                   } else {
                     xC${N} = vec4(0.0, 0.0, xTexelC${N}.xy);
                   }
                   `):p+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${N}Ready == 0) {
                   xTexelC${N} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${N}.zw = vec2(0.0);
                   }
                   xTexelC${N}Ready = 1;
                 }

                 xC${N} = xTexelC${N};
                 `,N+1<h)){const S=i%2===0?mN(c):c;c%2===0&&i%2===1||c%2!==0&&i%2!==1?(p+=`
                   xCOffset = xC + imod(pads[1], 2) + ${S};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${N+1}Ready == 0) {
                     xTexelC${N+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${N+1}.zw = vec2(0.0);
                     }
                     xTexelC${N+1}Ready = 1;
                   }
                   `,c>1?p+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${N+1} = vec4(previous.zw, xTexelC${N+1}.xy);
                     } else {
                      xC${N+1} = vec4(0.0, 0.0, xTexelC${N+1}.xy);
                     }
                     `:p+=`
                     xC${N+1} = vec4(xTexelC${N}.zw, xTexelC${N+1}.xy);
                     `):S===1?p+=`
                     xC${N+1} = xTexelC${N};
                     `:p+=`
                     xCOffset = xC + ${S};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${N+1}Ready == 0) {
                       xTexelC${N+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${N+1}.zw = vec2(0.0);
                       }
                       xTexelC${N+1}Ready = 1;
                     }

                     xC${N+1} = xTexelC${N+1};
                     `}}else N<h&&(i%2===1?(p+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${N}Ready == 0) {
                   xTexelC${N} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${N}.zw = vec2(0.0);
                   }
                   xTexelC${N}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${N+1}Ready == 0) {
                   xTexelC${N+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${N+1}.zw = vec2(0.0);
                   }
                   xTexelC${N+1}Ready = 1;
                 }

                 xC${N} = vec4(xTexelC${N}.zw, xTexelC${N+1}.zw);
               `,N+1<h&&(p+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${N+1} = vec4(xTexelC${N+1}.xy, final.xy);
                 `)):(p+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${N}Ready == 0) {
                   xTexelC${N} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${N}.zw = vec2(0.0);
                   }
                   xTexelC${N}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${N+1}Ready == 0) {
                   xTexelC${N+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${N+1}.zw = vec2(0.);
                   }
                   xTexelC${N+1}Ready = 1;
                 }

                 xC${N} = vec4(
                   xTexelC${N}.xy, xTexelC${N+1}.xy);
               `,N+1<h&&(p+=`
                   xC${N+1} = vec4(xTexelC${N}.zw, xTexelC${N+1}.zw);
                 `)));N<h&&(p+=`
             wTexel = getW(r, ${N}, d1, d2);
             dotProd += xC${N}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${N}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,N+1<h&&(p+=`
               wTexel = getW(r, ${N+1}, d1, d2);
               dotProd += xC${N+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${N+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}p+=`
     }
   `,p+=`
     }
   `,p+=`
     }
   `;let x="",y="";s&&(r?x=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:a?x=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:x=`vec4 activation(vec4 x) {
           ${s}
         }`,y="result = activation(result);");const v=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${x}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${p}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${v}
         ${y}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class P7e{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=fa(this.outputShape.length);const{dataFormat:s}=n,r=Ea(),a=s==="channelsLast",i=a?1:2,l=a?2:3,c=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let u="";for(let h=0;h<=1;h++)for(let f=0;f<=1;f++)u+=`
          blockIndex = rc.z + ${f};
          pos = rc.y + ${h};

          ${c}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${i}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${l}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${a}) {
                  innerDims = vec2(d1, ch);
                  result[${h*2+f}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${h*2+f}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${u}

        ${r.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y2(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function _Z({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:a=null,leakyreluAlpha:i=0,activation:l=null}){const c=t.shape,u=s.texData.get(t.dataId),h=n.inChannels,f=c[0]*c[1]*c[2],p=n.outChannels,x=n.dataFormat==="channelsLast",y=!1,v=!1;let b;const N=[];if(a!=null){const T=y2(a.shape,x);T!=null&&(a=vt({inputs:{x:a},backend:s,attrs:{shape:T}}),N.push(a))}if(r!=null){const T=y2(r.shape,x);T!=null&&(r=vt({inputs:{x:r},backend:s,attrs:{shape:T}}),N.push(r))}if(!((f===1||p===1)&&h>vZ)&&u.isPacked&&x&&u.texture!=null&&c[2]%2!==0&&xn(u.shape.slice(-3),c.slice(-3))){const T=c[0]*c[1]*(c[2]+1),E={dataId:t.dataId,shape:[1,T,n.inChannels],dtype:t.dtype},D=u.shape;u.shape=u.shape.slice(),u.shape[u.shape.length-2]++,Z(px(u.shape,E.shape),()=>`packed reshape ${u.shape} to ${E.shape} isn't free`);const A=vt({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}});N.push(A);const I=x2({a:E,b:A,backend:s,transposeA:y,transposeB:v,bias:r,activation:l,preluActivationWeights:a,leakyreluAlpha:i}),P=s.texData.get(I.dataId);Z(P.isPacked,()=>"batchMatMul result is expected to be packed"),u.shape=D,P.shape=n.outShape,b=bi({inputs:{x:I},backend:s}),b.shape=n.outShape,N.push(I)}else{const T=n.outHeight*n.outWidth,E=vt({inputs:{x:t},backend:s,attrs:{shape:x?[n.batchSize,T,n.inChannels]:[n.batchSize,n.inChannels,T]}}),D=vt({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}}),A=x2({a:x?E:D,b:x?D:E,transposeA:!x,transposeB:v,backend:s,bias:r,activation:l,preluActivationWeights:a,leakyreluAlpha:i});b=vt({inputs:{x:A},backend:s,attrs:{shape:n.outShape}}),N.push(E),N.push(D),N.push(A)}for(const T of N)s.disposeIntermediateTensorInfo(T);return b}function EZ({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:a=null,leakyreluAlpha:i=0,activation:l=null}){const{filterWidth:c,filterHeight:u,inChannels:h,outWidth:f,outHeight:p,dataFormat:x}=n,y=x==="channelsLast",v=c*u*h,b=p*f,N=[n.batchSize,v,b],S=!0,k=!1,T=[];if(a!=null){const H=y2(a.shape,y);H!=null&&(a=vt({inputs:{x:a},backend:s,attrs:{shape:H}}),T.push(a))}if(r!=null){const H=y2(r.shape,y);H!=null&&(r=vt({inputs:{x:r},backend:s,attrs:{shape:H}}),T.push(r))}const E=vt({inputs:{x:e},backend:s,attrs:{shape:[1,v,ze(e.shape)/v]}});T.push(E);const D=new P7e(N,n),A=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],I=s.runWebGLProgram(D,[t],"float32",A),P=vt({inputs:{x:I},backend:s,attrs:{shape:N}});T.push(I),T.push(P);const $=r!=null,R=a!=null,F=l==="leakyrelu",W=l?gx(l,!0):null,q=new bZ(y?P.shape:E.shape,y?E.shape:P.shape,y?[n.batchSize,b,n.outChannels]:[n.batchSize,n.outChannels,b],S,k,$,W,R,F),X=y?[P,E]:[E,P];if(r&&X.push(r),R&&X.push(a),F){const H=s.makeTensorInfo([],"float32",Yc(i,"float32"));X.push(H),T.push(H)}const z=s.runWebGLProgram(q,X,"float32"),K=vt({inputs:{x:z},backend:s,attrs:{shape:n.outShape}});T.push(z);for(const H of T)s.disposeIntermediateTensorInfo(H);return K}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L7e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a}=e,{strides:i,pad:l,dataFormat:c,dilations:u,dimRoundingMode:h}=s,f=Zc(c),p=Or(r.shape,a.shape,i,u,l,h,!1,f);let x;if(p.filterHeight===1&&p.filterWidth===1&&p.dilationHeight===1&&p.dilationWidth===1&&p.strideHeight===1&&p.strideWidth===1&&(p.padInfo.type==="SAME"||p.padInfo.type==="VALID"))x=_Z({x:r,filter:a,convInfo:p,backend:n});else if(p.strideWidth<=2&&f==="channelsLast"&&$e().getBool("WEBGL_EXP_CONV")){const v=new TZ(p),b=[[p.padInfo.top,p.padInfo.left],[p.strideHeight,p.strideWidth],[p.dilationHeight,p.dilationWidth],[p.inHeight,p.inWidth]];x=n.runWebGLProgram(v,[r,a],"float32",b)}else if($e().getBool("WEBGL_CONV_IM2COL"))x=EZ({x:r,filter:a,convInfo:p,backend:n});else{const v=new CZ(p);x=n.runWebGLProgram(v,[r,a],"float32")}const y=vt({inputs:{x},backend:n,attrs:{shape:p.outShape}});return n.disposeIntermediateTensorInfo(x),y}const M7e={kernelName:ty,backendName:"webgl",kernelFunc:L7e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class F7e{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${a};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${i?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class z7e{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=e.dataFormat==="channelsLast",l=n-1-e.padInfo.top,c=s-1-e.padInfo.left,u=i?1:2,h=i?2:3,f=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(${l}, ${c});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${f}];

        ivec2 dyCorner = ivec2(coords[${u}], coords[${h}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${i}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class B7e{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,a=e.padInfo.front,i=e.padInfo.top,l=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${a};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${i};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${l};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class U7e{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,a=e.strideDepth,i=e.strideHeight,l=e.strideWidth,c=n-1-e.padInfo.front,u=s-1-e.padInfo.top,h=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${c}, ${u}, ${h});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${a}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${l}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V7e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:a}=e,{strides:i,pad:l,dataFormat:c,dimRoundingMode:u,filterShape:h}=s,f=Zc(c),p=Or(r.shape,h,i,1,l,u,!1,f),x=new F7e(p);return n.runWebGLProgram(x,[r,a],"float32")}const W7e={kernelName:NN,backendName:"webgl",kernelFunc:V7e};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class H7e{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=fa(this.outputShape.length);const n=e.filterHeight,s=e.filterWidth,r=n-1-e.padInfo.top,a=s-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${r}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            int wCPerm = ${s} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G7e(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:a}=e,{inputShape:i,strides:l,pad:c,dataFormat:u,dimRoundingMode:h}=s,f=Zc(u),p=Or(i,a.shape,l,1,c,h,!1,f);if($e().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&f==="channelsLast"){const x=[[p.strideHeight,p.strideWidth]],y=new H7e(p);return n.runWebGLProgram(y,[r,a],"float32",x)}else{const x=new z7e(p);return n.runWebGLProgram(x,[r,a],"float32")}}const q7e={kernelName:ny,backendName:"webgl",kernelFunc:G7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K7e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a}=e,{strides:i,pad:l,dilations:c}=s,u=ud(r.shape,a.shape,i,c,l),h=new D7e(u);return n.runWebGLProgram(h,[r,a],"float32")}const X7e={kernelName:sy,backendName:"webgl",kernelFunc:K7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y7e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:a}=e,{strides:i,pad:l,filterShape:c}=s,u=ud(r.shape,c,i,1,l),h=new B7e(u);return n.runWebGLProgram(h,[r,a],"float32")}const Q7e={kernelName:SN,backendName:"webgl",kernelFunc:Y7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z7e(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:a}=e,{pad:i,strides:l,inputShape:c}=s,u=ud(c,a.shape,l,1,i),h=new U7e(u);return n.runWebGLProgram(h,[r,a],"float32")}const J7e={kernelName:jN,backendName:"webgl",kernelFunc:Z7e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eUe=a0+`
  return cos(x);
`,tUe=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${nm}
  return result;
`,nUe=En({opSnippet:eUe,packedOpSnippet:tUe}),sUe={kernelName:Jf,backendName:"webgl",kernelFunc:nUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rUe=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,aUe=En({opSnippet:rUe}),iUe={kernelName:ep,backendName:"webgl",kernelFunc:aUe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oUe{constructor(e,n,s,r,a){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,l,c,u]=e,[h]=n,[f,p]=s;this.outputShape=[h,f,p,u];const x=r==="bilinear"?1:0,[y,v]=[`${l-1}.0`,`${c-1}.0`],[b,N,S]=f>1?[`${(l-1)/(f-1)}`,"(y2-y1) * height_ratio",`y1*${y} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${y}`],[k,T,E]=p>1?[`${(c-1)/(p-1)}`,"(x2-x1) * width_ratio",`x1*${v} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${v}`];this.userCode=`
      const float height_ratio = float(${b});
      const float width_ratio = float(${k});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${i}) {
          return;
        }

        float height_scale = ${N};
        float width_scale = ${T};

        float in_y = ${S};
        if( in_y < 0.0 || in_y > ${y} ) {
          setOutput(float(${a}));
          return;
        }
        float in_x = ${E};
        if( in_x < 0.0 || in_x > ${v} ) {
          setOutput(float(${a}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${x} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lUe=t=>{const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:a,boxInd:i}=e,{cropSize:l,method:c,extrapolationValue:u}=s,h=new oUe(r.shape,a.shape,l,c,u);return n.runWebGLProgram(h,[r,a,i],"float32")},cUe={kernelName:CN,backendName:"webgl",kernelFunc:lUe};var yx;(function(t){t.Prod="*",t.Sum="+"})(yx||(yx={}));class MB{constructor(e,n,s,r){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const a=this.outputShape.length,i=this.op===yx.Prod?"1.0":"0.0",l=s?i:`getX(${FB(a,"coords",this.op)})`,c=this.outputShape[this.outputShape.length-1];let u="",h="";s?(u=r?`end != ${c-1}`:"end != 0",h=r?"end + 1":"end - 1"):(u=r?`end + pow2 < ${c}`:"end >= pow2",h=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${es(a)} coords = getOutputCoords();
        int end = ${zB(a,"coords",this.op)};
        float val = ${l};
        int pow2 = int(pow(2.0, index));
        if (${u}) {
          int idx = ${h};
          ${zB(a,"coords",this.op)} = idx;
          val ${this.op}= getX(${FB(a,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function FB(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function zB(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AZ(t,e,n,s,r,a){const i=e.shape.length,l=Os([s],i);let c=e;l!=null&&(c=Ca({inputs:{x:e},backend:n,attrs:{perm:l}}));const u=Hs(1,i)[0];if(u!==i-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${s}`);const h=c.shape[u];let f=bi({inputs:{x:c},backend:n});for(let p=0;p<=Math.ceil(Math.log2(h))-1;p++){const x=new MB(t,c.shape,!1,a),y=[[p]],v=f;f=n.runWebGLProgram(x,[f],f.dtype,y),n.disposeIntermediateTensorInfo(v)}if(r){const p=new MB(t,c.shape,r,a),x=f;f=n.runWebGLProgram(p,[f],f.dtype),n.disposeIntermediateTensorInfo(x)}if(l!=null){const p=dd(l),x=Ca({inputs:{x:f},backend:n,attrs:{perm:p}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(c),x}return f}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uUe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,exclusive:i,reverse:l}=s;return AZ(yx.Prod,r,n,a,i,l)}const dUe={kernelName:kN,backendName:"webgl",kernelFunc:uUe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hUe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,exclusive:i,reverse:l}=s;return AZ(yx.Sum,r,n,a,i,l)}const mUe={kernelName:ry,backendName:"webgl",kernelFunc:hUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fUe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:a}=e,{size:i,binaryOutput:l}=s;if(r.shape.length===1){const c=n.readSync(r.dataId),u=n.readSync(a.dataId),h=lZ(c,u,a.dtype,a.shape,i);return n.makeTensorInfo([i],a.dtype,h)}else if(r.shape.length===2){const c=n.bufferSync(r),u=n.bufferSync(a),h=xze(c,u,i,l);return n.makeTensorInfo(h.shape,a.dtype,h.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const pUe={kernelName:TN,backendName:"webgl",kernelFunc:fUe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gUe{constructor(e,n,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xUe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:a,dataFormat:i}=s,l=r.shape[0],c=i==="NHWC"?r.shape[1]:r.shape[2],u=i==="NHWC"?r.shape[2]:r.shape[3],h=i==="NHWC"?r.shape[3]:r.shape[1],f=c*a,p=u*a,x=h/(a*a),y=i==="NHWC"?[l,f,p,x]:[l,x,f,p],v=new gUe(y,a,i);return n.runWebGLProgram(v,[r],r.dtype)}const yUe={kernelName:_N,backendName:"webgl",kernelFunc:xUe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $Z{constructor(e,n=!1,s=null,r=!1,a=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=fa(this.outputShape.length);const i=e.filterHeight,l=e.filterWidth,c=e.outChannels/e.inChannels;let u="",h="";s&&(r?u=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:a?u=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:u=`
          float activation(float x) {
            ${s}
          }
        `,h="result = activation(result);");const f=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${u}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${c};
        int q = d2 - d1 * ${c};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${i}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${l}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${f}
        ${h}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IZ{constructor(e,n=!1,s=null,r=!1,a=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=fa(this.outputShape.length);const i=e.outChannels/e.inChannels,l=e.padInfo.left,c=e.strideWidth,u=e.dilationWidth,h=e.filterHeight,f=e.filterWidth,p=f;let x=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let N=0;N<f;N++)x+=`
          vec4 xTexelC${N*2};
          int xTexelC${N*2}Ready;
          vec4 xTexelC${N*2+1};
          int xTexelC${N*2+1}Ready;
          vec4 xC${N};`;x+=`
    for (int r = 0; r < ${h}; r++) {
      `;for(let N=0;N<f;N++)x+=`
          xTexelC${N*2} = vec4(0.0);
          xTexelC${N*2}Ready = 0;
          xTexelC${N*2+1} = vec4(0.0);
          xTexelC${N*2+1}Ready = 0;
          xC${N} = vec4(0.0);`;x+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let N=0;N<(p+1)/2;N++){const S=N*2;if(x+=`
          xC = xCCorner + ${S*u};
          `,c===1){if(S<f&&(l%2===1?(x+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S}Ready == 0) {
                  xTexelC${S} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${S}.zw = vec2(0.0);
                  }
                  xTexelC${S}Ready = 1;
                }
              `,u===1&&S>0?x+=`
                xC${S} = vec4(xTexelC${S-2}.zw, xTexelC${S}.xy);
                `:x+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${S} = vec4(previous.zw, xTexelC${S}.xy);
                  } else {
                    xC${S} = vec4(0.0, 0.0, xTexelC${S}.xy);
                  }
                  `):x+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${S}Ready == 0) {
                  xTexelC${S} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${S}.zw = vec2(0.0);
                  }
                  xTexelC${S}Ready = 1;
                }

                xC${S} = xTexelC${S};
                `,S+1<f)){const k=l%2===0?mN(u):u;u%2===0&&l%2===1||u%2!==0&&l%2!==1?(x+=`
                  xCOffset = xC + imod(pads[1], 2) + ${k};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S+1}Ready == 0) {
                    xTexelC${S+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${S+1}.zw = vec2(0.0);
                    }
                    xTexelC${S+1}Ready = 1;
                  }
                  `,u>1?x+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${S+1} = vec4(previous.zw, xTexelC${S+1}.xy);
                    } else {
                     xC${S+1} = vec4(0.0, 0.0, xTexelC${S+1}.xy);
                    }
                    `:x+=`
                    xC${S+1} = vec4(xTexelC${S}.zw, xTexelC${S+1}.xy);
                    `):k===1?x+=`
                    xC${S+1} = xTexelC${S};
                    `:x+=`
                    xCOffset = xC + ${k};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S+1}Ready == 0) {
                      xTexelC${S+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${S+1}.zw = vec2(0.0);
                      }
                      xTexelC${S+1}Ready = 1;
                    }

                    xC${S+1} = xTexelC${S+1};
                    `}}else S<f&&(l%2===1?(x+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S}Ready == 0) {
                  xTexelC${S} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${S}.zw = vec2(0.0);
                  }
                  xTexelC${S}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${S+1}Ready == 0) {
                  xTexelC${S+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${S+1}.zw = vec2(0.0);
                  }
                  xTexelC${S+1}Ready = 1;
                }

                xC${S} = vec4(xTexelC${S}.zw, xTexelC${S+1}.zw);
              `,S+1<f&&(x+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${S+1} = vec4(xTexelC${S+1}.xy, final.xy);
                `)):(x+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${S}Ready == 0) {
                  xTexelC${S} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${S}.zw = vec2(0.0);
                  }
                  xTexelC${S}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${S+1}Ready == 0) {
                  xTexelC${S+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${S+1}.zw = vec2(0.);
                  }
                  xTexelC${S+1}Ready = 1;
                }

                xC${S} = vec4(
                  xTexelC${S}.xy, xTexelC${S+1}.xy);
              `,S+1<f&&(x+=`
                  xC${S+1} = vec4(xTexelC${S}.zw, xTexelC${S+1}.zw);
                `)));S<f&&(x+=`
            wTexel = getW(r, ${S}, d1, q);
            dotProd += xC${S} * vec4(wTexel.xz, wTexel.xz);
          `,S+1<f&&(x+=`
              wTexel = getW(r, ${S+1}, d1, q);
              dotProd += xC${S+1} * vec4(wTexel.xz, wTexel.xz);
            `))}x+=`
    }
  `,x+=`
      }
    `;let y="",v="";s&&(r?y=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:a?y=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:y=`vec4 activation(vec4 x) {
          ${s}
        }`,v="result = activation(result);");const b=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),a&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${y}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${i};
        int q = d2 - d1 * ${i};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${x}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${b}
        ${v}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bUe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a}=e,{strides:i,pad:l,dilations:c,dimRoundingMode:u}=s;let h=c;h==null&&(h=[1,1]),Z(Zr(i,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${h}'`);const f=Or(r.shape,a.shape,i,h,l,u,!0);let p;$e().getBool("WEBGL_PACK_DEPTHWISECONV")&&f.strideWidth<=2&&f.outChannels/f.inChannels===1?p=new IZ(f):p=new $Z(f);const x=[[f.padInfo.top,f.padInfo.left],[f.strideHeight,f.strideWidth],[f.dilationHeight,f.dilationWidth],[f.inHeight,f.inWidth]];return n.runWebGLProgram(p,[r,a],"float32",x)}const vUe={kernelName:ay,backendName:"webgl",kernelFunc:bUe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wUe{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,a=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${i} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${a};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class NUe{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,a=e.strideWidth,i=n-1-e.padInfo.top,l=s-1-e.padInfo.left,c=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${a}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${c}; dm++) {
              int d2 = d1 * ${c} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SUe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:a}=e,{strides:i,dilations:l,pad:c,dimRoundingMode:u,filterShape:h}=s,f=Or(r.shape,h,i,l,c,u,!0),p=new wUe(f);return n.runWebGLProgram(p,[r,a],"float32")}const jUe={kernelName:EN,backendName:"webgl",kernelFunc:SUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kUe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:a}=e,{strides:i,dilations:l,pad:c,dimRoundingMode:u,inputShape:h}=s,f=Or(h,a.shape,i,l,c,u,!0),p=new NUe(f);return n.runWebGLProgram(p,[r,a],"float32")}const CUe={kernelName:AN,backendName:"webgl",kernelFunc:kUe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TUe{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _Ue(t){const{inputs:e,backend:n}=t,{x:s}=e,r=[...s.shape,...s.shape],a=ze(s.shape),i=vt({inputs:{x:s},backend:n,attrs:{shape:[a]}}),l=new TUe(a),c=n.runWebGLProgram(l,[i],i.dtype),u=vt({inputs:{x:c},backend:n,attrs:{shape:r}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(c),u}const EUe={kernelName:$N,backendName:"webgl",kernelFunc:_Ue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class AUe{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:s,padInfo:r,strideHeight:a,strideWidth:i,filterHeight:l,filterWidth:c,dilationHeight:u,dilationWidth:h}=e,{top:f,left:p}=r;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${i});
      const ivec2 pads = ivec2(${f}, ${p});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${l}; h++) {
          int hIn = hBeg + h * ${u};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${c}; w++) {
              int wIn = wBeg + w * ${h};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a}=e,{strides:i,pad:l,dilations:c}=s,u=Xy(r.shape,a.shape,i,l,"NHWC",c);let h;const f=new AUe(u);h=n.runWebGLProgram(f,[r,a],"float32");const p=vt({inputs:{x:h},backend:n,attrs:{shape:u.outShape}});return n.disposeIntermediateTensorInfo(h),p}const IUe={kernelName:iy,backendName:"webgl",kernelFunc:$Ue};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RUe(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,a=e,{allDims:i,summedDims:l,idDims:c}=MI(r,a.length);zI(i.length,c,a);const{path:u,steps:h}=BI(l,c),f=h.length;let p=null,x=i.length;const y=[];for(let v=0;v<f;++v){for(const b of h[v]){const{permutationIndices:N,expandDims:S}=FI(x,c[b]);let k;UI(N)?k=a[b]:(k=Ca({inputs:{x:a[b]},backend:n,attrs:{perm:N}}),y.push(k));const T=k.shape.slice();for(let E=0;E<S.length;++E)T.splice(S[E],0,1);xn(k.shape,T)||(k=vt({inputs:{x:k},backend:n,attrs:{shape:T}}),y.push(k)),p===null?p=k:(p=qR({inputs:{a:k,b:p},backend:n}),y.push(p))}v<f-1&&(u[v]>=0&&(p=Oj({inputs:{x:p},backend:n,attrs:{axis:u[v]-(i.length-x),keepDims:!1}}),y.push(p)),x--)}for(const v of y)v!==p&&n.disposeIntermediateTensorInfo(v);return p}const OUe={kernelName:RN,backendName:"webgl",kernelFunc:RUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DUe="return (x >= 0.0) ? x : (exp(x) - 1.0);",PUe=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,LUe=En({opSnippet:DUe,packedOpSnippet:PUe}),MUe={kernelName:np,backendName:"webgl",kernelFunc:LUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FUe="return (b >= 0.0) ? a : a * (b + 1.0);",zUe=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,BUe=t=>{const{inputs:e,backend:n}=t,{dy:s,y:r}=e,a=$e().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new r0(zUe,s.shape,r.shape):new Lh(FUe,s.shape,r.shape);return n.runWebGLProgram(a,[s,r],s.dtype)},UUe={kernelName:ON,backendName:"webgl",kernelFunc:BUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VUe=`
  return vec4(equal(a, b));
`,WUe="return float(a == b);",HUe=ta({opSnippet:WUe,packedOpSnippet:VUe,dtype:"bool",cpuKernelImpl:Nze}),GUe={kernelName:oy,backendName:"webgl",kernelFunc:HUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qUe=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${$I};
  float a1 = ${II};
  float a2 = ${RI};
  float a3 = ${OI};
  float a4 = ${DI};
  float a5 = ${PI};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,KUe=En({opSnippet:qUe}),XUe={kernelName:sp,backendName:"webgl",kernelFunc:KUe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YUe=a0+`
  return exp(x);
`,QUe=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,RZ=En({opSnippet:YUe,packedOpSnippet:QUe,cpuKernelImpl:Sze,dtype:"float32"}),ZUe={kernelName:rp,backendName:"webgl",kernelFunc:RZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WE(t){const{inputs:e,attrs:n,backend:s}=t,{dim:r}=n,{input:a}=e,i=a.shape.length,l=a.shape.slice();let c=r;return r<0&&(Z(-(i+1)<=r,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),c=i+r+1),l.splice(c,0,1),vt({inputs:{x:a},backend:s,attrs:{shape:l}})}const JUe={kernelName:ly,backendName:"webgl",kernelFunc:WE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BB="return exp(x) - 1.0;",eVe=En({opSnippet:BB,packedOpSnippet:BB,cpuKernelImpl:jze}),tVe={kernelName:ap,backendName:"webgl",kernelFunc:eVe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UB{constructor(e,n,s){this.variableNames=["real","imag"];const r=n[1];this.outputShape=n;const a=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,i=s?`${r}.0`:"1.0";let l;if(e==="real")l="return real * expR - imag * expI;";else if(e==="imag")l="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${a};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${l}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${i};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OZ(t,e,n){const s=n.texData.get(t.dataId),r=ze(t.shape),a=t.shape[t.shape.length-1],i=r/a,l=vt({inputs:{x:t},backend:n,attrs:{shape:[i,a]}}),c=l.shape,u=new UB("real",c,e),h=new UB("imag",c,e),f=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:c},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:c}],p=n.runWebGLProgram(u,f,"float32"),x=n.runWebGLProgram(h,f,"float32"),y=xd({inputs:{real:p,imag:x},backend:n});n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(x);const v=vt({inputs:{x:y},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(y),v}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nVe(t){const{inputs:e,backend:n}=t,{input:s}=e;return OZ(s,!1,n)}const sVe={kernelName:DN,backendName:"webgl",kernelFunc:nVe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rVe{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $b(t){const{backend:e,attrs:n}=t,{shape:s,value:r}=n;let{dtype:a}=n;if(a=a||Wh(r),a==="string"){const i=Ms(a,ze(s));return i.fill(r),e.makeTensorInfo(s,a,i)}else{const i=new rVe(s,r),l=[[r]];return e.runWebGLProgram(i,[],a,l)}}const aVe={kernelName:PN,backendName:"webgl",kernelFunc:$b};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iVe{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oVe={kernelName:LN,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,s=e,r=new iVe(n.shape);return s.runWebGLProgram(r,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VB="return floor(x);",lVe=En({opSnippet:VB,packedOpSnippet:VB,cpuKernelImpl:kze}),cVe={kernelName:ip,backendName:"webgl",kernelFunc:lVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uVe=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,dVe=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,hVe=ta({opSnippet:uVe,packedOpSnippet:dVe,dtype:"int32"}),mVe={kernelName:op,backendName:"webgl",kernelFunc:hVe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fVe{constructor(e){this.variableNames=["A"];const n=Ea(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${s}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pVe{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=Ea(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${s}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gVe={kernelName:Xw,backendName:"webgl",kernelFunc:xVe};let Bm,F3=$e().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function xVe(t){const{inputs:e,backend:n,attrs:s}=t;let{pixels:r}=e;const{numChannels:a}=s,i=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement,l=typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement,[c,u]=i?[r.videoWidth,r.videoHeight]:[r.width,r.height],h=[u,c],f=[u,c,a];if(l||i){const v=$e().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Bm==null||v!==F3)&&(F3=v,Bm=document.createElement("canvas").getContext("2d",{willReadFrequently:F3})),Bm.canvas.width=c,Bm.canvas.height=u,Bm.drawImage(r,0,0,c,u),r=Bm.canvas}const p=n.makeTensorInfo(h,"int32");n.texData.get(p.dataId).usage=Wi.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(p.dataId),r);const x=$e().getBool("WEBGL_PACK")?new pVe(f):new fVe(f),y=n.runWebGLProgram(x,[p],"int32");return n.disposeData(p.dataId),y}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yVe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a,bias:i,preluActivationWeights:l}=e,{strides:c,pad:u,dataFormat:h,dilations:f,dimRoundingMode:p,activation:x,leakyreluAlpha:y}=s,v=Zc(h),b=Or(r.shape,a.shape,c,f,u,p,!1,v);let N;const S=[],k=i!=null,T=l!=null,E=x==="leakyrelu",D=()=>{const I=[r,a],P=($,R)=>{if(R==="NCHW"&&$.shape.length===1&&$.shape[0]!==1){const F=vt({inputs:{x:$},backend:n,attrs:{shape:[$.shape[0],1,1]}});return S.push(F),F}return $};if(k&&I.push(P(i,h)),T&&I.push(P(l,h)),E){const $=n.makeTensorInfo([],"float32",Yc(y,"float32"));I.push($),S.push($)}return I};if(b.filterHeight===1&&b.filterWidth===1&&b.dilationHeight===1&&b.dilationWidth===1&&b.strideHeight===1&&b.strideWidth===1&&(b.padInfo.type==="SAME"||b.padInfo.type==="VALID"))N=_Z({x:r,filter:a,convInfo:b,backend:n,bias:i,activation:x,preluActivationWeights:l,leakyreluAlpha:y});else if(b.strideWidth<=2&&v==="channelsLast"&&$e().getBool("WEBGL_EXP_CONV")){const I=x?gx(x,!0):null,P=new TZ(b,k,I,T,E),$=[[b.padInfo.top,b.padInfo.left],[b.strideHeight,b.strideWidth],[b.dilationHeight,b.dilationWidth],[b.inHeight,b.inWidth]],R=D();N=n.runWebGLProgram(P,R,"float32",$)}else if($e().getBool("WEBGL_CONV_IM2COL"))N=EZ({x:r,filter:a,convInfo:b,backend:n,bias:i,activation:x,preluActivationWeights:l,leakyreluAlpha:y});else{const I=x?gx(x,!1):null,P=new CZ(b,k,I,T,E),$=D();N=n.runWebGLProgram(P,$,"float32")}const A=vt({inputs:{x:N},backend:n,attrs:{shape:b.outShape}});return S.push(N),S.forEach(I=>n.disposeIntermediateTensorInfo(I)),A}const bVe={kernelName:tx,backendName:"webgl",kernelFunc:yVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vVe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:a,bias:i,preluActivationWeights:l}=e,{strides:c,pad:u,dilations:h,dimRoundingMode:f,activation:p,leakyreluAlpha:x}=s,y=[];let v=h;v==null&&(v=[1,1]),Z(Zr(c,v),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${c} and dilations '${v}'`);const b=Or(r.shape,a.shape,c,v,u,f,!0),N=$e().getBool("WEBGL_PACK_DEPTHWISECONV")&&b.strideWidth<=2&&b.outChannels/b.inChannels===1,S=p?gx(p,N):null,k=[r,a],T=i!=null,E=l!=null,D=p==="leakyrelu";if(T&&k.push(i),E&&k.push(l),D){const $=n.makeTensorInfo([],"float32",Yc(x,"float32"));k.push($),y.push($)}let A;N?A=new IZ(b,T,S,E,D):A=new $Z(b,T,S,E,D);const I=[[b.padInfo.top,b.padInfo.left],[b.strideHeight,b.strideWidth],[b.dilationHeight,b.dilationWidth],[b.inHeight,b.inWidth]],P=n.runWebGLProgram(A,k,"float32",I);return y.forEach($=>n.disposeIntermediateTensorInfo($)),P}const wVe={kernelName:nx,backendName:"webgl",kernelFunc:vVe};class NVe{constructor(e,n,s,r){this.sliceDim=e,this.strides=n,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=s;const a=es(s.length);let i=`
    int index;`;for(let l=0;l<this.sliceDim;l++)i+=`
          index = round(getIndices(coords[0], ${l}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[l]};
          flattenIndex += index * ${this.strides[l]};`;this.userCode=`
         void main() {
          ${a} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${i}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SVe(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,a=r.shape,i=a[a.length-1],l=ze(s.shape),[c,u,h,f]=aj(s,r),p=vt({inputs:{x:r},backend:n,attrs:{shape:[u,i]}}),x=vt({inputs:{x:s},backend:n,attrs:{shape:[ze(s.shape)/h,h]}});if(n.shouldExecuteOnCPU([s,r])||s.dtype==="string"){const N=n.readSync(r.dataId),S=n.bufferSync(s),k=Cze(N,S,s.dtype,u,i,h,f,s.shape,l);return n.makeTensorInfo(c,s.dtype,k.values)}const y=new NVe(i,f,[u,h],s.shape),v=n.runWebGLProgram(y,[x,p],x.dtype),b=vt({inputs:{x:v},backend:n,attrs:{shape:c}});return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(v),b}const jVe={kernelName:MN,backendName:"webgl",kernelFunc:SVe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class kVe{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const s=es(this.rank),r=CVe(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}}function CVe(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let r=0;r<t.length;r++)r===2?s.push("index"):s.push(`${n[r]}`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DZ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:a}=e,{axis:i,batchDims:l}=s,c=fn(i,r.shape)[0];if($e().get("DEBUG")){const S=n.readSync(a.dataId),k=r.shape[c];for(let T=0;T<S.length;++T){const E=S[T];Z(E<=k-1&&E>=0,()=>`GatherV2: the index value ${E} is not in [0, ${k-1}]`)}}const u=WI(r,a,c,l),h=ze(a.shape),f=[],p=vt({inputs:{x:r},backend:n,attrs:{shape:[u.batchSize,u.outerSize,u.dimSize,u.sliceSize]}}),x=vt({inputs:{x:a},backend:n,attrs:{shape:[u.batchSize,h/u.batchSize]}});f.push(p),f.push(x);const y=[u.batchSize,u.outerSize,h/u.batchSize,u.sliceSize];if(n.shouldExecuteOnCPU([r,a])||r.dtype==="string"){const S=n.bufferSync(x),k=n.bufferSync(p),T=Tze(k,S,y);return f.forEach(E=>n.disposeIntermediateTensorInfo(E)),n.makeTensorInfo(u.outputShape,T.dtype,T.values)}const v=new kVe(p.shape,y),b=n.runWebGLProgram(v,[p,x],p.dtype);f.push(b);const N=vt({inputs:{x:b},backend:n,attrs:{shape:u.outputShape}});return f.forEach(S=>n.disposeIntermediateTensorInfo(S)),N}const TVe={kernelName:uy,backendName:"webgl",kernelFunc:DZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Ve="return float(a > b);",EVe=`
  return vec4(greaterThan(a, b));
`,AVe=ta({opSnippet:_Ve,packedOpSnippet:EVe,cpuKernelImpl:_ze,dtype:"bool"}),$Ve={kernelName:dy,backendName:"webgl",kernelFunc:AVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IVe="return float(a >= b);",RVe=`
  return vec4(greaterThanEqual(a, b));
`,OVe=ta({opSnippet:IVe,packedOpSnippet:RVe,dtype:"bool",cpuKernelImpl:Eze}),DVe={kernelName:lp,backendName:"webgl",kernelFunc:OVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PVe(t){const{inputs:e,backend:n}=t,{input:s}=e;return OZ(s,!0,n)}const LVe={kernelName:FN,backendName:"webgl",kernelFunc:PVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MVe="return float(!isnan(x) && !isinf(x));",FVe=En({opSnippet:MVe,dtype:"bool"}),zVe={kernelName:up,backendName:"webgl",kernelFunc:FVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BVe="return float(isinf(x));",UVe=En({opSnippet:BVe,dtype:"bool"}),VVe={kernelName:dp,backendName:"webgl",kernelFunc:UVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WVe="return float(isnan(x));",HVe=En({opSnippet:WVe,dtype:"bool"}),GVe={kernelName:hp,backendName:"webgl",kernelFunc:HVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qVe="return float(a < b);",KVe=`
  return vec4(lessThan(a, b));
`,XVe=ta({opSnippet:qVe,packedOpSnippet:KVe,cpuKernelImpl:Aze,dtype:"bool"}),YVe={kernelName:my,backendName:"webgl",kernelFunc:XVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QVe="return float(a <= b);",ZVe=`
  return vec4(lessThanEqual(a, b));
`,JVe=ta({opSnippet:QVe,packedOpSnippet:ZVe,cpuKernelImpl:$ze,dtype:"bool"}),e9e={kernelName:fy,backendName:"webgl",kernelFunc:JVe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t9e(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:a}=n,i=Ize(s,r,a);return e.makeTensorInfo([i.length],"float32",i)}const n9e={kernelName:BN,backendName:"webgl",kernelFunc:t9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s9e=a0+`
  return x < 0.0 ? 0./0. : log(x);
`,r9e=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,a9e=En({opSnippet:s9e,packedOpSnippet:r9e,cpuKernelImpl:Rze}),i9e={kernelName:mp,backendName:"webgl",kernelFunc:a9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o9e=a0+`
  return log(1.0 + x);
`,l9e=En({opSnippet:o9e}),c9e={kernelName:fp,backendName:"webgl",kernelFunc:l9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u9e="return float(a >= 1.0 && b >= 1.0);",d9e=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,h9e=ta({opSnippet:u9e,packedOpSnippet:d9e,dtype:"bool"}),m9e={kernelName:py,backendName:"webgl",kernelFunc:h9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const f9e="return float(!(x >= 1.0));",p9e=En({opSnippet:f9e}),g9e={kernelName:gy,backendName:"webgl",kernelFunc:p9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x9e="return float(a >= 1.0 || b >= 1.0);",y9e=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,b9e=ta({opSnippet:x9e,packedOpSnippet:y9e,dtype:"bool"}),v9e={kernelName:xy,backendName:"webgl",kernelFunc:b9e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class w9e{constructor(e,n,s,r,a){this.variableNames=["x"],this.outputShape=[];const i=n,l=e[3]-1;this.outputShape=e;let c;const u=`float(${s}) + float(${r}) * sum`;a===.5?c=`inversesqrt(${u})`:a===1?c=`1.0/(${u})`:c=`exp(log(${u}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${i}; j <= ${i}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${l}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${c};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class N9e{constructor(e,n,s,r,a){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=n,l=e[3]-1;this.outputShape=e;let c;const u=`float(${s}) + float(${r}) * sum`;a===.5?c=`inversesqrt(${u})`:a===1?c=`1.0/(${u})`:c=`exp(log(${u}) * float(-${a}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${i};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${i}; j <= ${i}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${l}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${c};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S9e=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:a,bias:i,alpha:l,beta:c}=s,u=$e().getBool("WEBGL_PACK_NORMALIZATION")?new N9e(r.shape,a,i,l,c):new w9e(r.shape,a,i,l,c);return n.runWebGLProgram(u,[r],r.dtype)},j9e={kernelName:yy,backendName:"webgl",kernelFunc:S9e};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class k9e{constructor(e,n,s,r,a){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=s,this.alpha=r,this.beta=a,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${a})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${a});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C9e=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r,y:a,dy:i}=e,{depthRadius:l,bias:c,alpha:u,beta:h}=s,f=new k9e(r.shape,l,c,u,h);return n.runWebGLProgram(f,[r,a,i],r.dtype)},T9e={kernelName:UN,backendName:"webgl",kernelFunc:C9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _9e(t,e,n,s){const r=ze(e),i=ze(t.shape)/r,l=vt({inputs:{x:t},attrs:{shape:[i,r]},backend:s}),c=sm(l,t.dtype,"max",s),u=vt({inputs:{x:c},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(l),s.disposeIntermediateTensorInfo(c),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PZ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:a,keepDims:i}=s,l=r.shape.length,c=fn(a,r.shape);let u=c;const h=Os(u,l),f=h!=null,p=n.shouldExecuteOnCPU([r]);let x=r;if(f){if(p){const k=n.texData.get(x.dataId).values,T=new Array(l);for(let A=0;A<T.length;A++)T[A]=r.shape[h[A]];const E=HR(k,r.shape,r.dtype,h,T);x=n.makeTensorInfo(T,r.dtype);const D=n.texData.get(x.dataId);D.values=E}else x=Rj(r,h,n);u=Hs(u.length,l)}Jr("max",u,l);const[y,v]=Dr(x.shape,u);let b=y;i&&(b=Ws(y,c));let N;if(p){const k=n.texData.get(x.dataId).values,T=Oze(k,ze(v),b,r.dtype);N=n.makeTensorInfo(b,r.dtype);const E=n.texData.get(N.dataId);E.values=T}else N=_9e(x,v,b,n);return f&&n.disposeIntermediateTensorInfo(x),N}const E9e={kernelName:by,backendName:"webgl",kernelFunc:PZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A9e=GR+`
  return max(a, b);
`,$9e=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+nm+`
  return result;
`,I9e=ta({opSnippet:A9e,packedOpSnippet:$9e,cpuKernelImpl:Dze}),R9e={kernelName:pp,backendName:"webgl",kernelFunc:I9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O9e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Jp(r,"maxPool");const{filterSize:a,strides:i,pad:l,dimRoundingMode:c}=s,u=1;Z(Zr(i,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const h=Po(r.shape,a,i,u,l,c);if(h.filterWidth===1&&h.filterHeight===1&&xn(h.inShape,h.outShape))return bi({inputs:{x:r},backend:n});const f=new xx(h,"max",!1);return n.runWebGLProgram(f,[r],r.dtype)}const D9e={kernelName:vy,backendName:"webgl",kernelFunc:O9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P9e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:a,strides:i,pad:l,dataFormat:c,dimRoundingMode:u}=s,h=[1,1,1],f=Qc(r.shape,a,i,h,l,u,c),p=new KR(f,"max",!1);return n.runWebGLProgram(p,[r],r.dtype)}const L9e={kernelName:wy,backendName:"webgl",kernelFunc:P9e};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class M9e{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,s=e.strideWidth,r=e.dilationHeight,a=e.effectiveFilterHeight,i=e.effectiveFilterWidth,l=a-1-e.padInfo.top,c=i-1-e.padInfo.left,u=a*i-1;this.userCode=`
      const ivec2 pads = ivec2(${l}, ${c});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${a};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${i}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${u} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${i} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class F9e{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,a=e.dilationDepth,i=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,u=e.effectiveFilterHeight,h=e.effectiveFilterWidth,f=c-1-e.padInfo.front,p=u-1-e.padInfo.top,x=h-1-e.padInfo.left,y=c*u*h-1;this.userCode=`
      const ivec3 pads = ivec3(${f}, ${p}, ${x});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${c};
           wD += ${a}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${u};
              wR += ${i}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${h};
                wC += ${l}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${y} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${u} * ${h} +
                  wR * ${h} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z9e(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:a}=e,i=a,{filterSize:l,strides:c,pad:u,dimRoundingMode:h}=s,f=[1,1,1],p=Qc(i.shape,l,c,f,u,h),x=new KR(p,"max",!0),y=n.runWebGLProgram(x,[i],i.dtype),v=new F9e(p),b=n.runWebGLProgram(v,[r,y],i.dtype);return n.disposeIntermediateTensorInfo(y),b}const B9e={kernelName:WN,backendName:"webgl",kernelFunc:z9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U9e(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:a,output:i}=e,l=a;Jp([a,i],"maxPoolGrad");const{filterSize:c,strides:u,pad:h,dimRoundingMode:f}=s,p=Po(l.shape,c,u,1,h,f),x=!0,y=new xx(p,"max",x),v=n.runWebGLProgram(y,[l],l.dtype),b=new M9e(p),N=n.runWebGLProgram(b,[r,v],l.dtype);return n.disposeIntermediateTensorInfo(v),N}const V9e={kernelName:VN,backendName:"webgl",kernelFunc:U9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W9e(t,e,n,s){let r=new xx(n,"max",!1);const a=s.runWebGLProgram(r,[t],"float32");r=new xx(n,"max",!0,!0,e);const i=s.runWebGLProgram(r,[t],"float32");return[a,i]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const H9e={kernelName:HN,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:a,pad:i,includeBatchInIndex:l}=e,c=n;Z(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const u=[1,1];Z(Zr(a,u),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${a} and dilations '${u}'`);const h=Po(s.shape,r,a,u,i),[f,p]=W9e(s,l,h,c);return[f,p]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G9e(t,e,n,s){const r=ze(e),i=ze(t.shape)/r,l=vt({inputs:{x:t},attrs:{shape:[i,r]},backend:s}),c=sm(l,"float32","mean",s),u=vt({inputs:{x:c},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(l),s.disposeIntermediateTensorInfo(c),u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q9e={kernelName:Ny,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{keepDims:r,axis:a}=e,i=n,l=s.shape.length,c=fn(a,s.shape);let u=c;const h=Os(u,l),f=h!=null,p=i.shouldExecuteOnCPU([s]),x=[];let y=s;if(f){if(p){const T=i.texData.get(y.dataId).values,E=new Array(l);for(let I=0;I<E.length;I++)E[I]=s.shape[h[I]];const D=HR(T,s.shape,s.dtype,h,E);y=i.makeTensorInfo(E,s.dtype);const A=i.texData.get(y.dataId);A.values=D}else y=Rj(s,h,i);x.push(y),u=Hs(u.length,l)}Jr("sum",u,l);const[v,b]=Dr(y.shape,u);let N=v;r&&(N=Ws(v,c));const S=G9e(y,b,N,i);for(const k of x)i.disposeIntermediateTensorInfo(k);return S}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K9e(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:i}=s,l=r.shape.length,c=fn(a,r.shape);let u=c;const h=Os(u,l);let f=r;h!=null&&(f=Ca({inputs:{x:r},backend:n,attrs:{perm:h}}),u=Hs(u.length,r.shape.length)),Jr("min",u,l);const[p,x]=Dr(f.shape,u),y=ze(x),v=vt({inputs:{x:f},backend:n,attrs:{shape:[-1,y]}}),b=sm(v,v.dtype,"min",n);let N;if(i){const S=Ws(p,c);N=vt({inputs:{x:b},backend:n,attrs:{shape:S}})}else N=vt({inputs:{x:b},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(b),h!=null&&n.disposeIntermediateTensorInfo(f),N}const X9e={kernelName:Sy,backendName:"webgl",kernelFunc:K9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y9e=GR+`
  return min(a, b);
`,Q9e=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+nm+`
  return result;
`,Z9e=ta({opSnippet:Y9e,packedOpSnippet:Q9e,cpuKernelImpl:Pze}),J9e={kernelName:gp,backendName:"webgl",kernelFunc:Z9e};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eWe{constructor(e,n,s){this.variableNames=["x"],this.outputShape=n.map((h,f)=>h[0]+e[f]+h[1]);const r=e.length,a=es(r),i=n.map(h=>h[0]).join(","),l=n.map((h,f)=>h[0]+e[f]).join(","),c=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),u=s==="reflect"?0:1;if(r===1){this.userCode=`
        int start = ${i};
        int end = ${l};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${u};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${u};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${i});
      ${a} end = ${a}(${l});

      void main() {
        ${a} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${u};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${u};
          }
        }
        ${a} coords = outC - start;
        setOutput(getX(${c}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tWe{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((y,v)=>y[0]+e[v]+y[1]);const r=e.length,a=es(r),i=n.map(y=>y[0]).join(","),l=n.map((y,v)=>y[0]+e[v]).join(","),c=Sa("rc",r),u=Sa("source",r),h=`${c[r-1]} < ${this.outputShape[r-1]}`,f=r===1?"source":`vec2(${u.slice(-2).join()})`,p=s==="reflect"?0:1;let x="";if(r===1){const y=`
        ${a} source = rc;
        if (source < start) {
          source = start * 2 - source - ${p};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${p};
        }
        source -= start;
      `;x=`
        ${a} rc = outputLoc;
        ${y}
        result[0] = getChannel(getX(${u.join()}), ${f});
        ${c[r-1]} += 1;
        if(${h}) {
          ${y}
          result[1] = getChannel(getX(${u.join()}), ${f});
        }
      `}else{const y=`
        ${a} source = rc;
        ${a} lt = ${a}(lessThan(source, start));
        ${a} gte = ${a}(greaterThanEqual(source, end));
        ${a} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${p}) +
                gte * ((end - 1) * 2 - source + ${p});
        source -= start;
      `;x=`
        ${a} rc = outputLoc;
        ${y}
        result[0] = getChannel(getX(${u.join()}), ${f});
        ${c[r-1]} += 1;
        if(${h}) {
          ${y}
          result[1] = getChannel(getX(${u.join()}), ${f});
        }
        rc = outputLoc;
        ${c[r-2]} += 1;
        if(${c[r-2]} < ${this.outputShape[r-2]}) {
          ${y}
          result[2] = getChannel(getX(${u.join()}), ${f});
          ${c[r-1]} += 1;
          if(${h}) {
            ${y}
            result[3] = getChannel(getX(${u.join()}), ${f});
          }
        }
      `}this.userCode=`
      const ${a} start = ${a}(${i});
      const ${a} end = ${a}(${l});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${x}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nWe=({inputs:t,backend:e,attrs:n})=>{const{x:s}=t,{paddings:r,mode:a}=n,i=$e().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new tWe(s.shape,r,a):new eWe(s.shape,r,a);return e.runWebGLProgram(i,[s],s.dtype)},sWe={kernelName:jy,backendName:"webgl",kernelFunc:nWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rWe=`if (b == 0.0) return NAN;
  return mod(a, b);`,aWe=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+nm+`
  return result;
`,iWe=ta({opSnippet:rWe,packedOpSnippet:aWe}),oWe={kernelName:xp,backendName:"webgl",kernelFunc:iWe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lWe{constructor(e,n,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cWe=`
if (a == b) {
  return 1.0;
};
return a / b;`,uWe=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,LZ=ta({opSnippet:cWe,packedOpSnippet:uWe,checkOutOfBounds:!0}),dWe={kernelName:tp,backendName:"webgl",kernelFunc:LZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WB="return a - b;",MZ=ta({opSnippet:WB,packedOpSnippet:WB,supportsComplex:!0,cpuKernelImpl:s8e}),hWe={kernelName:Rp,backendName:"webgl",kernelFunc:MZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FZ(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:a}=s,i=fn([a],r.shape),l=PZ({inputs:{x:r},backend:n,attrs:{reductionIndices:i,keepDims:!1}}),c=Ws(l.shape,i),u=vt({inputs:{x:l},backend:n,attrs:{shape:c}}),h=MZ({inputs:{a:r,b:u},backend:n}),f=RZ({inputs:{x:h},backend:n}),p=Oj({inputs:{x:f},backend:n,attrs:{axis:i,keepDims:!1}}),x=vt({inputs:{x:p},backend:n,attrs:{shape:c}}),y=LZ({inputs:{a:f,b:x},backend:n});return n.disposeIntermediateTensorInfo(l),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(x),y}const mWe={kernelName:Uy,backendName:"webgl",kernelFunc:FZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fWe(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:a,seed:i,normalized:l}=s,c=l?r:FZ({inputs:{logits:r},backend:n,attrs:{dim:r.shape.length-1}}),u=c.shape[0],h=c.shape[1],f=new lWe(u,h,a),p=[[i]],x=n.runWebGLProgram(f,[c],"int32",p);return l||n.disposeIntermediateTensorInfo(c),x}const pWe={kernelName:GN,backendName:"webgl",kernelFunc:fWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gWe=Mo+`
  return -x;
`,xWe=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function yWe(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])){const a=n.texData.get(s.dataId),[i,l]=Mze(a.values,s.shape,s.dtype);return n.makeTensorInfo(l,s.dtype,i)}let r;return $e().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Fu(s.shape,xWe):r=new $l(s.shape,gWe),n.runWebGLProgram(r,[s],s.dtype)}const bWe={kernelName:ky,backendName:"webgl",kernelFunc:yWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vWe=tj;function wWe(t){zi("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:a}=e,{maxOutputSize:i,iouThreshold:l,scoreThreshold:c}=s,u=n.readSync(r.dataId),h=n.readSync(a.dataId),{selectedIndices:f}=vWe(u,h,i,l,c);return n.makeTensorInfo([f.length],"int32",new Int32Array(f))}const NWe={kernelName:qN,backendName:"webgl",kernelFunc:wWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SWe=nj;function jWe(t){zi("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:a}=e,{maxOutputSize:i,iouThreshold:l,scoreThreshold:c,padToMaxOutputSize:u}=s,h=n.readSync(r.dataId),f=n.readSync(a.dataId),{selectedIndices:p,validOutputs:x}=SWe(h,f,i,l,c,u);return[n.makeTensorInfo([p.length],"int32",new Int32Array(p)),n.makeTensorInfo([],"int32",new Int32Array([x]))]}const kWe={kernelName:KN,backendName:"webgl",kernelFunc:jWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CWe=sj;function TWe(t){zi("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:a}=e,{maxOutputSize:i,iouThreshold:l,scoreThreshold:c,softNmsSigma:u}=s,h=n.readSync(r.dataId),f=n.readSync(a.dataId),p=i,x=l,y=c,v=u,{selectedIndices:b,selectedScores:N}=CWe(h,f,p,x,y,v);return[n.makeTensorInfo([b.length],"int32",new Int32Array(b)),n.makeTensorInfo([N.length],"float32",new Float32Array(N))]}const _We={kernelName:XN,backendName:"webgl",kernelFunc:TWe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EWe{constructor(e,n,s,r){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${s}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AWe=t=>{const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:a,depth:i,onValue:l,offValue:c}=s,u=ze(r.shape),h=new EWe(u,i,l,c),f=vt({inputs:{x:r},backend:n,attrs:{shape:[u]}}),p=n.runWebGLProgram(h,[f],a);n.disposeIntermediateTensorInfo(f);const x=[...r.shape,i],y=vt({inputs:{x:p},backend:n,attrs:{shape:x}});return n.disposeIntermediateTensorInfo(p),y},$We={kernelName:_y,backendName:"webgl",kernelFunc:AWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b2(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="complex64"){const r=Ab({inputs:{input:s},backend:n}),a=b2({inputs:{x:r},backend:n}),i=Dj({inputs:{input:s},backend:n}),l=b2({inputs:{x:i},backend:n}),c=xd({inputs:{real:a,imag:l},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(l),c}else return $b({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:n})}const IWe={kernelName:Gy,backendName:"webgl",kernelFunc:b2};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zZ(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const r=Ab({inputs:{input:s},backend:n}),a=zZ({inputs:{x:r},backend:n}),i=Dj({inputs:{input:s},backend:n}),l=b2({inputs:{x:i},backend:n}),c=xd({inputs:{real:a,imag:l},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(l),c}else return $b({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:n})}const RWe={kernelName:Ty,backendName:"webgl",kernelFunc:zZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OWe(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return WE({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const a=e[0].shape,i=e[0].dtype;e.forEach(h=>{Qr(a,h.shape,"All tensors passed to stack must have matching shapes"),Z(i===h.dtype,()=>"All tensors passed to stack must have matching dtypes")});const l=[],c=e.map(h=>{const f=WE({inputs:{input:h},backend:n,attrs:{dim:r}});return l.push(f),f}),u=kZ({inputs:c,backend:n,attrs:{axis:r}});return l.forEach(h=>n.disposeIntermediateTensorInfo(h)),u}const DWe={kernelName:Ey,backendName:"webgl",kernelFunc:OWe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PWe{constructor(e,n,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((u,h)=>u[0]+e[h]+u[1]);const r=e.length,a=es(r),i=n.map(u=>u[0]).join(","),l=n.map((u,h)=>u[0]+e[h]).join(","),c=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode=`
        int start = ${i};
        int end = ${l};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${a} start = ${a}(${i});
      ${a} end = ${a}(${l});

      void main() {
        ${a} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${a} coords = outC - start;
          setOutput(getX(${c}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LWe{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((v,b)=>v[0]+e[b]+v[1]);const r=e.length,a=es(r),i=n.map(v=>v[0]).join(","),l=n.map((v,b)=>v[0]+e[b]).join(","),c=Sa("rc",r),u=Sa("source",r),h=`${c[r-1]} < ${this.outputShape[r-1]}`,f=r===1?"source":`vec2(${u.slice(-2).join()})`,p=[`${a} rc = outputLoc;`,`${c[r-1]} += 1;
       if(${h}) {
      `,r===1?"":`}
       rc = outputLoc;
       ${c[r-2]} += 1;
       if(${c[r-2]} < ${this.outputShape[r-2]}) {`,r===1?"":`  ${c[r-1]} += 1;
         if(${h}) {`],x=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let y="";for(let v=0,b=r===1?2:4;v<b;v++)y+=`
        ${p[v]}
        if (${x}) {
          result[${v}] = float(value);
        } else {
          ${a} source = rc - start;
          result[${v}] = getChannel(getX(${u.join()}), ${f});
        }
      `;y+=r===1?"} ":"}}",this.userCode=`
      const ${a} start = ${a}(${i});
      const ${a} end = ${a}(${l});

      void main() {
        ${a} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${y}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BZ=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:a,constantValue:i}=s;if(ze(r.shape)===0){const u=a.map((h,f)=>h[0]+r.shape[f]+h[1]);return $b({backend:n,attrs:{shape:u,value:i,dtype:r.dtype}})}const l=$e().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new LWe(r.shape,a,i):new PWe(r.shape,a,i),c=[[i]];return n.runWebGLProgram(l,[r],r.dtype,c)},MWe={kernelName:Ay,backendName:"webgl",kernelFunc:BZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FWe=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,zWe=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+nm+`
  return result;
`,BWe=ta({opSnippet:FWe,packedOpSnippet:zWe}),UWe={kernelName:bp,backendName:"webgl",kernelFunc:BWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VWe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:a,keepDims:i}=s,l=r.shape.length,c=[],u=fn(a,r.shape);let h=u;const f=Os(h,l);let p=r;f!=null&&(p=Ca({inputs:{x:r},backend:n,attrs:{perm:f}}),h=Hs(h.length,l),c.push(p)),Jr("prod",h,l);let x;if(n.shouldExecuteOnCPU([p])){const y=n.texData.get(p.dataId).values,{outVals:v,outShape:b,outDtype:N}=zze(p.shape,p.dtype,y,h);x=n.makeTensorInfo(b,N,v)}else{const[y,v]=Dr(p.shape,h),b=ze(v),N=vt({inputs:{x:p},backend:n,attrs:{shape:[-1,b]}}),S=wS(r.dtype),k=sm(N,S,"prod",n);x=vt({inputs:{x:k},backend:n,attrs:{shape:y}}),c.push(N),c.push(k)}if(i){c.push(x);const y=Ws(x.shape,u);x=vt({inputs:{x},backend:n,attrs:{shape:y}})}return c.forEach(y=>n.disposeIntermediateTensorInfo(y)),x}const WWe={kernelName:Iy,backendName:"webgl",kernelFunc:VWe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HWe(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:a,indices:i}=e,{outputRaggedRank:l}=s,c=r.map(N=>n.readSync(N.dataId)),u=r.map(N=>N.shape),h=n.readSync(a.dataId),f=n.readSync(i.dataId),[p,x,y]=Bze(c,u,h,a.shape,a.dtype,f,i.shape,l),v=p.map(N=>n.makeTensorInfo([N.length],"int32",N)),b=n.makeTensorInfo(y,a.dtype,x);return v.concat([b])}const GWe={kernelName:YN,backendName:"webgl",kernelFunc:HWe};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qWe(t){const{inputs:e,backend:n}=t,{starts:s,limits:r,deltas:a}=e,i=n.readSync(s.dataId),l=n.readSync(r.dataId),c=n.readSync(a.dataId),[u,h]=Uze(i,s.shape,s.dtype,l,r.shape,c,a.shape),f=n.makeTensorInfo([u.length],"int32",u),p=n.makeTensorInfo([h.length],s.dtype,h);return[f,p]}const KWe={kernelName:QN,backendName:"webgl",kernelFunc:qWe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XWe(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:a,defaultValue:i,rowPartitionTensors:l}=e,{rowPartitionTypes:c}=s,u=n.readSync(r.dataId),h=n.readSync(a.dataId),f=n.readSync(i.dataId),p=l.map(b=>n.readSync(b.dataId)),x=l.map(b=>b.shape),[y,v]=Vze(u,r.shape,h,a.shape,a.dtype,f,i.shape,p,x,c);return n.makeTensorInfo(y,a.dtype,v)}const YWe={kernelName:ZN,backendName:"webgl",kernelFunc:XWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UZ=t=>{const{backend:e,attrs:n}=t,{start:s,stop:r,step:a,dtype:i}=n,l=Wze(s,r,a,i);return e.makeTensorInfo([l.length],i,l)},QWe={kernelName:JN,backendName:"webgl",kernelFunc:UZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZWe="return 1.0 / x;",JWe=En({opSnippet:ZWe}),eHe={kernelName:vp,backendName:"webgl",kernelFunc:JWe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tHe=Mo+`
  return (x < 0.0) ? 0.0 : x;
`,nHe=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,sHe=En({opSnippet:tHe,packedOpSnippet:nHe}),rHe={kernelName:wp,backendName:"webgl",kernelFunc:sHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aHe=Mo+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,iHe=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,oHe=En({opSnippet:aHe,packedOpSnippet:iHe}),lHe={kernelName:Np,backendName:"webgl",kernelFunc:oHe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cHe{constructor(e,n,s,r,a){this.variableNames=["A"],this.outputShape=[];const[i,l,c,u]=e;this.outputShape=[i,n,s,u];const h=[r&&n>1?l-1:l,r&&s>1?c-1:c],f=[r&&n>1?n-1:n,r&&s>1?s-1:s];let p;a?p="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":p="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${h[0]/f[0]},
          ${h[1]/f[1]});
      const vec2 inputShapeRC = vec2(${l}.0, ${c}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class uHe{constructor(e,n,s,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,l,c,u]=e;this.outputShape=[i,n,s,u];const h=[r&&n>1?l-1:l,r&&s>1?c-1:c],f=[r&&n>1?n-1:n,r&&s>1?s-1:s];let p;a?p="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":p="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${h[0]/f[0]},
          ${h[1]/f[1]},
          ${h[1]/f[1]});
      const vec3 inputShapeRC = vec3(${l}.0, ${c}.0,
                                     ${c}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${p};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dHe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:a,halfPixelCenters:i,size:l}=s,[c,u]=l,h=$e().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new uHe(r.shape,c,u,a,i):new cHe(r.shape,c,u,a,i);return n.runWebGLProgram(h,[r],"float32")}const hHe={kernelName:Dy,backendName:"webgl",kernelFunc:dHe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mHe{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,a]=n,[,i,l]=e,c=[s&&i>1?r-1:r,s&&l>1?a-1:a],u=[s&&i>1?i-1:i,s&&l>1?l-1:l],h=c[0]/u[0],f=c[1]/u[1],p=1/h,x=1/f,y=Math.ceil(p)*2+2,v=Math.ceil(x)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${h});
        const float widthScale = float(${f});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${x});

        const int winHeight = int(${y});
        const int winWidth = int(${v});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${l}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${a-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fHe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:a}=e,{alignCorners:i}=s,l=new mHe(a.shape,r.shape,i);return n.runWebGLProgram(l,[a],a.dtype)}const pHe={kernelName:nS,backendName:"webgl",kernelFunc:fHe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gHe{constructor(e,n,s,r,a){this.variableNames=["A"],this.outputShape=[];const[i,l,c,u]=e;this.outputShape=[i,n,s,u];const h=[r&&n>1?l-1:l,r&&s>1?c-1:c],f=[r&&n>1?n-1:n,r&&s>1?s-1:s],p=r?"0.5":"0.0";let x;a?x="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":x="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${h[0]/f[0]},
          ${h[1]/f[1]});
      const vec2 inputShapeRC = vec2(${l}.0, ${c}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${x};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xHe{constructor(e,n,s,r,a){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,l,c,u]=e;this.outputShape=[i,n,s,u];const h=[r&&n>1?l-1:l,r&&s>1?c-1:c],f=[r&&n>1?n-1:n,r&&s>1?s-1:s],p=r?"0.5":"0.0";let x;a?x="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":x="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${h[0]/f[0]},
          ${h[1]/f[1]},
          ${h[1]/f[1]});
      const vec3 inputShapeRC = vec3(${l}.0, ${c}.0,
                                     ${c}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${x};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${p})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${u-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yHe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:a,halfPixelCenters:i,size:l}=s,[c,u]=l,h=$e().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new xHe(r.shape,c,u,a,i):new gHe(r.shape,c,u,a,i);return n.runWebGLProgram(h,[r],r.dtype)}const bHe={kernelName:Oy,backendName:"webgl",kernelFunc:yHe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vHe{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,a]=n,[,i,l]=e,c=[s&&i>1?r-1:r,s&&l>1?a-1:a],u=[s&&i>1?i-1:i,s&&l>1?l-1:l],h=c[0]/u[0],f=c[1]/u[1],p=1/h,x=1/f,y=Math.ceil(p)*2+2,v=Math.ceil(x)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${h});
        const float widthScale = float(${f});

        const float invHeightScale = float(${p});
        const float invWidthScale = float(${x});

        const int winHeight = int(${y});
        const int winWidth = int(${v});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${l}) {
              continue;
            }

            float sourceFracRow =
              float(${c[0]}) *
                (float(dyR) / float(${u[0]}));

            float sourceFracCol =
                float(${c[1]}) *
                  (float(dyC) / float(${u[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${a}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wHe(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:a}=e,{alignCorners:i}=s,l=new vHe(a.shape,r.shape,i);return n.runWebGLProgram(l,[a],a.dtype)}const NHe={kernelName:tS,backendName:"webgl",kernelFunc:wHe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SHe{constructor(e,n){this.variableNames=["x"];const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=e,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const r=l=>n.indexOf(l)!==-1&&e[l]!==1?`${e[l]} - coords[${l}] - 1`:`coords[${l}]`,a=e.map((l,c)=>r(c)).join(","),i=es(s);this.userCode=`
      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jHe{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=e;const r=Sa("rc",s),a=`${r[s-1]} + 1 < ${this.outputShape[s-1]}`,i=`${r[s-2]} + 1 < ${this.outputShape[s-2]}`,l=es(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${a}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${l} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${c(r.slice())};
          if(${a}){
            result.g = ${u(r.slice())};
          }
          if(${i}) {
            result.b = ${h(r.slice())};
            if(${a}) {
              result.a = ${f(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function c(y){return p(y)}function u(y){return y[s-1]="("+y[s-1]+" + 1)",p(y)}function h(y){return y[s-2]="("+y[s-2]+" + 1)",p(y)}function f(y){return y[s-1]="("+y[s-1]+" + 1)",y[s-2]="("+y[s-2]+" + 1)",p(y)}function p(y){const v=e.map((S,k)=>x(k,y)),b=v.join(","),N=v.slice(-2).join(",");return`getChannel(getX(${b}), vec2(${N}))`}function x(y,v){return n.indexOf(y)!==-1&&e[y]!==1?`${e[y]} - ${v[y]} - 1`:`${v[y]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kHe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:a}=s,i=r.shape.length,l=fn(a,r.shape);if(i===0)return bi({inputs:{x:r},backend:n});const c=$e().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new jHe(r.shape,l):new SHe(r.shape,l);return n.runWebGLProgram(c,[r],r.dtype)}const CHe={kernelName:Py,backendName:"webgl",kernelFunc:kHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class THe{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=e[1],r=e[2];this.outputShape=e;let a="";typeof n=="number"?a=`float outputValue = ${n.toFixed(2)};`:a=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${a}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _He={kernelName:bS,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:a,center:i}=e,l=n,c=new THe(s.shape,a),[u,h]=_I(i,s.shape[1],s.shape[2]),f=[[u,h,Math.sin(r),Math.cos(r)]];return l.runWebGLProgram(c,[s],s.dtype,f)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EHe=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,AHe=En({opSnippet:EHe}),$He={kernelName:Sp,backendName:"webgl",kernelFunc:AHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IHe="return inversesqrt(x);",RHe=En({opSnippet:IHe,cpuKernelImpl:Hze}),OHe={kernelName:jp,backendName:"webgl",kernelFunc:RHe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class XR{constructor(e,n,s,r,a,i,l=!0,c=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const u=es(a.length),h=es(i.length);let f="";s===1?f="i":s===2&&(f="i, j");const p=`getIndices(${f})`;let x="";r===1?x="i":r===2&&(x="i, coords[1]");const y=`getUpdates(${x})`;let v="";c&&(v="coords[0], coords[1]");const b=`getDefaultValue(${v})`,N=n>1?"strides[j]":"strides";this.userCode=`
        ${u} strides = ${u}(${a});

        void main() {
          ${h} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${p});
              flattenedIndex += index * ${N};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${y};
              found = true;
            }
          }
          setOutput(mix(${b}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DHe{constructor(e,n,s,r,a,i,l=!0,c=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;const u=es(a.length),h=es(i.length);let f="";s===1?f="i":s===2&&(f="i, j");const p=`getIndices(${f})`;let x="";r===1?x="i":r===2&&(x="i, coords[1]");const y=`getUpdates(${x})`;let v="";c&&(v="coords[0], coords[1]");const b=`getDefaultValue(${v})`,N=n>1?"strides[j]":"strides",S=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${u} strides = ${u}(${a});

        void main() {
          ${h} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${p});
              flattenedIndex += index.xz * ${N};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${S};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${y};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${b}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PHe(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:a}=e,{shape:i}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:h,outputSize:f}=pd(a,r,i),p=[f/u,u];if(f===0)return n.makeTensorInfo(i,r.dtype);const x=vt({inputs:{x:r},backend:n,attrs:{shape:[c,l]}}),y=vt({inputs:{x:a},backend:n,attrs:{shape:[c,u]}}),v=n.makeTensorInfo([],"float32",new Float32Array([0]));let b;$e().getBool("WEBGL_PACK")?b=new DHe(c,l,x.shape.length,y.shape.length,h,p):b=new XR(c,l,x.shape.length,y.shape.length,h,p);const N=n.runWebGLProgram(b,[y,x,v],y.dtype),S=vt({inputs:{x:N},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(N),n.disposeIntermediateTensorInfo(v),S}const LHe={kernelName:sS,backendName:"webgl",kernelFunc:PHe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class MHe{constructor(e,n,s,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,s];const a="while (left < right) {",i=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,l=$e().getNumber("WEBGL_VERSION")===2?a:i,c=r==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${l}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${c} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FHe(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:a}=e,{side:i}=s,l=new MHe(r.shape[0],r.shape[1],a.shape[1],i),c=[[r.shape[1]]];return n.runWebGLProgram(l,[r,a],"int32",c)}const zHe={kernelName:aS,backendName:"webgl",kernelFunc:FHe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class BHe{constructor(e,n,s){this.variableNames=["c","a","b"],this.outputShape=n;let r,a;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)a="resRC",r="resRC";else{const l=["resRC.x","resRC.y","resRC.z","resRC.w"],c=[],u=[];for(let h=0;h<n.length;h++)u.push(`${l[h]}`),h<e&&c.push(`${l[h]}`);r=c.join(),a=u.join()}const i=es(s);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${a}));
        } else {
          setOutput(getB(${a}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UHe(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:a}=e,i=new BHe(s.shape.length,r.shape,r.shape.length);return n.runWebGLProgram(i,[s,r,a],Va(r.dtype,a.dtype))}const VHe={kernelName:Ly,backendName:"webgl",kernelFunc:UHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WHe=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${lj};
  float scale = ${cj};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,HHe=En({opSnippet:WHe}),GHe={kernelName:kp,backendName:"webgl",kernelFunc:HHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qHe=a0+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,KHe=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,XHe=En({opSnippet:qHe,packedOpSnippet:KHe,cpuKernelImpl:qze}),YHe={kernelName:Ep,backendName:"webgl",kernelFunc:XHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QHe=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,ZHe=En({opSnippet:QHe}),JHe={kernelName:_p,backendName:"webgl",kernelFunc:ZHe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eGe=a0+`
  return sin(x);
`,tGe=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${nm}
  return result;
`,nGe=En({opSnippet:eGe,packedOpSnippet:tGe}),sGe={kernelName:Cp,backendName:"webgl",kernelFunc:nGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rGe=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,aGe=En({opSnippet:rGe}),iGe={kernelName:Tp,backendName:"webgl",kernelFunc:aGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oGe=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,lGe=En({opSnippet:oGe}),cGe={kernelName:Ap,backendName:"webgl",kernelFunc:lGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uGe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:a,paddings:i}=s;Z(r.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const l=a.reduce((N,S)=>N*S),c=[[0,0]];c.push(...i);for(let N=1+a.length;N<r.shape.length;++N)c.push([0,0]);const u=[],h=BZ({inputs:{x:r},backend:n,attrs:{paddings:c,constantValue:0}}),f=mb(h.shape,a,l,!1),p=fb(f.length,a.length,!1),x=pb(h.shape,a,l,!1),y=vt({inputs:{x:h},backend:n,attrs:{shape:f}}),v=Ca({inputs:{x:y},backend:n,attrs:{perm:p}}),b=vt({inputs:{x:v},backend:n,attrs:{shape:x}});return u.push(h),u.push(y),u.push(v),u.forEach(N=>n.disposeIntermediateTensorInfo(N)),b},dGe={kernelName:zy,backendName:"webgl",kernelFunc:uGe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hGe(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:a,defaultValue:i}=e;if(a.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${a.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${r.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const l=n.readSync(s.dataId),c=n.readSync(r.dataId),u=n.readSync(a.dataId),h=n.readSync(i.dataId)[0],[f,p,x,y,v]=Xze(l,s.shape,s.dtype,c,r.dtype,u,h);return[n.makeTensorInfo(p,s.dtype,f),n.makeTensorInfo([p[0]],r.dtype,x),n.makeTensorInfo([y.length],"bool",new Uint8Array(y.map(b=>Number(b)))),n.makeTensorInfo([v.length],s.dtype,new Int32Array(v))]}const mGe={kernelName:iS,backendName:"webgl",kernelFunc:hGe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fGe(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:a}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${r.shape}`);if(a.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${a.shape}`);const i=Array.from(n.readSync(r.dataId)),l=n.readSync(s.dataId),c=Array.from(n.readSync(a.dataId)),[u,h,f]=Yze(l,s.shape,s.dtype,i,c);return[n.makeTensorInfo(h,s.dtype,u),n.makeTensorInfo([f.length],a.dtype,new Int32Array(f))]}const pGe={kernelName:oS,backendName:"webgl",kernelFunc:fGe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gGe(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:a}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${a.shape}`);const i=n.readSync(s.dataId),l=n.readSync(r.dataId),c=n.readSync(a.dataId),[u,h]=uZ(i,s.shape,s.dtype,l,c,!0);return n.makeTensorInfo(h,s.dtype,u)}const xGe={kernelName:lS,backendName:"webgl",kernelFunc:gGe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yGe(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:a}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${r.shape}`);if(a.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${a.shape}`);const i=n.readSync(s.dataId),l=n.readSync(r.dataId),c=n.readSync(a.dataId),[u,h]=uZ(i,s.shape,s.dtype,l,c);return n.makeTensorInfo(h,s.dtype,u)}const bGe={kernelName:cS,backendName:"webgl",kernelFunc:yGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vGe(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:a,defaultValue:i}=e,{outputShape:l}=s,{sliceRank:c,numUpdates:u,sliceSize:h,strides:f,outputSize:p}=pd(a,r,l),x=!1;if(a.dtype==="string"){const N=n.bufferSync(r),S=n.bufferSync(a),k=Oc(n.readSync(i.dataId)[0]),T=Gze(N,S,l,p,h,u,c,f,k,x);return n.makeTensorInfo(l,T.dtype,T.values)}const y=new XR(u,c,r.shape.length,a.shape.length,f,[p,1],x),v=n.runWebGLProgram(y,[a,r,i],a.dtype),b=vt({inputs:{x:v},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(v),b}const wGe={kernelName:uS,backendName:"webgl",kernelFunc:vGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NGe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:a,axis:i}=s,l=fn(i,r.shape)[0],c=VI(r,a,l),u=r.shape.length,h=new Array(u).fill(0),f=r.shape.slice();return c.map(p=>{const x=[...f];x[l]=p;const y=i0({inputs:{x:r},backend:n,attrs:{begin:h,size:x}});return h[l]+=p,y})}const SGe={kernelName:By,backendName:"webgl",kernelFunc:NGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HB="return sqrt(x);",jGe=En({opSnippet:HB,packedOpSnippet:HB,cpuKernelImpl:Qze}),kGe={kernelName:$p,backendName:"webgl",kernelFunc:jGe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CGe="return x * x;",TGe=En({opSnippet:CGe}),_Ge={kernelName:dS,backendName:"webgl",kernelFunc:TGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GB="return (a - b) * (a - b);",EGe=ta({opSnippet:GB,packedOpSnippet:GB}),AGe={kernelName:Ip,backendName:"webgl",kernelFunc:EGe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Ge(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");const a=n.readSync(r.dataId),i=Fc(a),l=Zze(i,"string",s);return n.makeTensorInfo(r.shape,"string",l)}const IGe={kernelName:Vy,backendName:"webgl",kernelFunc:$Ge};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RGe({inputs:t,attrs:e,backend:n}){const{x:s}=t,r=Mo+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,a=new $l(s.shape,r);return n.runWebGLProgram(a,[s],s.dtype)}const OGe={kernelName:Lp,backendName:"webgl",kernelFunc:RGe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DGe{constructor(e,n,s){this.variableNames=["x"],this.outputShape=s;const r=s.length,a=es(s.length),i=es(s.length);let l="";if(r===1)l="coords * strides + begin";else{let c=0;l=s.map((u,h)=>(c++,s.length===1?`coords * strides[${h}] + begin[${h}]`:`coords[${c-1}] * strides[${h}] + begin[${h}]`)).join(",")}this.userCode=`
      ${a} begin = ${a}(${e});
      ${a} strides = ${a}(${n});

      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PGe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:a,end:i,strides:l,beginMask:c,endMask:u,ellipsisMask:h,newAxisMask:f,shrinkAxisMask:p}=s,{finalShapeSparse:x,finalShape:y,isIdentity:v,sliceDim0:b,isSimpleSlice:N,begin:S,end:k,strides:T}=jI(r.shape,a,i,l,c,u,h,f,p);let E;if(v)E=vt({inputs:{x:r},backend:n,attrs:{shape:y}});else if(b||N){Z(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const A=wI(S,k,T),I=i0({inputs:{x:r},backend:n,attrs:{begin:S,size:A}});E=vt({inputs:{x:I},backend:n,attrs:{shape:y}}),n.disposeIntermediateTensorInfo(I)}else if(n.shouldExecuteOnCPU([r])){const I=n.readSync(r.dataId),P=on(r.shape,r.dtype,I),$=Jze(x,P,T,S);E=n.makeTensorInfo(y,r.dtype,$.values)}else{const I=new DGe(S,T,x);E=n.runWebGLProgram(I,[r],r.dtype)}const D=vt({inputs:{x:E},backend:n,attrs:{shape:y}});return n.disposeIntermediateTensorInfo(E),D}const LGe={kernelName:hS,backendName:"webgl",kernelFunc:PGe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MGe(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:a,leftPad:i,rightPad:l,padWidth:c,preserveShortSequences:u}=s,{data:h,dataSplits:f}=e,p=n.readSync(h.dataId),x=n.readSync(f.dataId),[y,v]=e8e(p,x,r,a,i,l,c,u);return[n.makeTensorInfo([y.length],"string",y),n.makeTensorInfo(f.shape,"int32",v)]}const FGe={kernelName:mS,backendName:"webgl",kernelFunc:MGe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zGe(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:a,delimiter:i}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(a.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${a.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const l=n.readSync(a.dataId),c=n.readSync(i.dataId)[0],[u,h,f]=t8e(l,c,r),p=h.length;return[n.makeTensorInfo([p,2],"int32",u),n.makeTensorInfo([p],"string",h),n.makeTensorInfo([2],"int32",new Int32Array(f))]}const BGe={kernelName:fS,backendName:"webgl",kernelFunc:zGe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UGe(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:a}=e;if(a.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const i=n.readSync(a.dataId),l=n8e(i,r);return n.makeTensorInfo(a.shape,"int32",l)}const VGe={kernelName:pS,backendName:"webgl",kernelFunc:UGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WGe="return tan(x);",HGe=En({opSnippet:WGe}),GGe={kernelName:Op,backendName:"webgl",kernelFunc:HGe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qGe=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,KGe=En({opSnippet:qGe}),XGe={kernelName:Dp,backendName:"webgl",kernelFunc:KGe};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YGe(t){const{inputs:e,backend:n,attrs:s}=t,{tensor:r,indices:a,updates:i}=e,{sliceRank:l,numUpdates:c,sliceSize:u,strides:h,outputSize:f}=pd(i,a,r.shape),p=[f/u,u];if(f===0)return n.makeTensorInfo(r.shape,a.dtype);const x=vt({inputs:{x:a},backend:n,attrs:{shape:[c,l]}}),y=vt({inputs:{x:i},backend:n,attrs:{shape:[c,u]}}),v=vt({inputs:{x:r},backend:n,attrs:{shape:p}}),b=new XR(c,l,x.shape.length,y.shape.length,h,p,!1,!0),N=n.runWebGLProgram(b,[y,x,v],v.dtype),S=vt({inputs:{x:N},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(v),n.disposeIntermediateTensorInfo(N),S}const QGe={kernelName:rS,backendName:"webgl",kernelFunc:YGe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ZGe{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let i=0;i<s.length;i++)s[i]=e[i]*n[i];this.outputShape=s,this.rank=s.length;const r=es(this.rank),a=JGe(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${a}));
      }
    `}}function JGe(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let r=0;r<t.length;r++)s.push(`imod(${n[r]}, ${t[r]})`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VZ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:a}=s;if(r.dtype==="string"||r.shape.length>5){const c=n.readSync(r.dataId),u=r.dtype==="string"?c.map(p=>Oc(p)):c,h=on(r.shape,r.dtype,u),f=r8e(h,a);return n.makeTensorInfo(f.shape,f.dtype,f.values)}const i=new ZGe(r.shape,a);return n.runWebGLProgram(i,[r],r.dtype)}const eqe={kernelName:Pp,backendName:"webgl",kernelFunc:VZ};class tqe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class nqe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dd(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function qB(t){let e=1;for(;e<t;)e*=2;return e}function sqe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:a,sorted:i}=s,l=$e().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),c=$e().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),u=r.shape,h=u[u.length-1];if(n.shouldExecuteOnCPU([r])||h<l||a>c){const $=n.readSync(r.dataId),[R,F]=a8e($,u,r.dtype,a,i);return[n.makeTensorInfo(R.shape,R.dtype,R.values),n.makeTensorInfo(F.shape,F.dtype,F.values)]}if(a===0)return u[u.length-1]=0,[n.makeTensorInfo(u,r.dtype,[]),n.makeTensorInfo(u,"int32",[])];if(h===1)return[r,$b({attrs:{shape:u,dtype:"int32",value:0},backend:n})];const f=n.texData.get(r.dataId),p=f!==null&&f.isPacked,x=p?n.unpackTensor(r):r,v=ze(u)/h,b=vt({inputs:{x},attrs:{shape:[v,h]},backend:n});p&&Dd(n,x);const N=qB(a),S=qB(h);let k=null;const T=()=>k===null?[b,b]:[b,k],E=($,R,F)=>{const W=T(),q=new tqe(F),z=[[h],[k===null?1:0],[Number.NEGATIVE_INFINITY],[$],[R]],K=k;k=n.runWebGLProgram(q,W,"int32",z),Dd(n,K)};for(let $=1;$<N;$*=2){const R=$*2;for(let F=$;F>=1;F/=2)E(R,F,[v,S])}for(let $=S;$>N;$/=2){const R=T(),F=new nqe([v,$/2]),q=[[h],[k===null?1:0],[N]],X=k;k=n.runWebGLProgram(F,R,"int32",q),Dd(n,X);const z=N/2,K=z*2;for(let H=z;H>=1;H/=2)E(K,H,k.shape)}let D=k;k=i0({inputs:{x:k},backend:n,attrs:{begin:0,size:[v,a]}}),Dd(n,D);let A=DZ({inputs:{x:b,indices:k},backend:n,attrs:{axis:1,batchDims:1}});Dd(n,b);const I=u.slice(0,-1);I.push(a),D=k,k=vt({inputs:{x:k},attrs:{shape:I},backend:n}),Dd(n,D);const P=A;return A=vt({inputs:{x:A},attrs:{shape:I},backend:n}),Dd(n,P),[A,k]}const rqe={kernelName:gS,backendName:"webgl",kernelFunc:sqe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class aqe{constructor(e,n,s,r,a,i){this.variableNames=["Image","Transforms"],this.outputShape=i;const l=s==="nearest"?1:2;let c;switch(r){case"constant":c=1;break;case"reflect":c=2;break;case"wrap":c=3;break;case"nearest":c=4;break;default:c=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${c} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${c} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${c} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${a});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${a});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${l} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iqe(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,transforms:a}=e,{interpolation:i,fillMode:l,fillValue:c,outputShape:u}=s,[h,f,p,x]=r.shape,[y,v]=u??[f,p],b=[h,y,v,x],N=new aqe(f,p,i,l,c,b);return n.runWebGLProgram(N,[r,a],"float32")}const oqe={kernelName:xS,backendName:"webgl",kernelFunc:iqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lqe(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:a}=e;Jp(a,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const i=s.readSync(a.dataId),{outputValues:l,outputShape:c,indices:u}=i8e(i,r,a.shape,a.dtype);return[s.makeTensorInfo(c,a.dtype,l),s.makeTensorInfo([u.length],"int32",u)]}const cqe={kernelName:yS,backendName:"webgl",kernelFunc:lqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uqe(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:a}=s;a<0&&(a+=r.shape.length);const i=r,l=i.shape.length,c=r.shape[a],u=new Array(l-1);let h=0;for(let v=0;v<l;v++)v!==a&&(u[h++]=i.shape[v]);const f=[],p=new Array(l).fill(0),x=i.shape.slice();x[a]=1;const y=new Array(c);for(let v=0;v<y.length;v++){p[a]=v;const b=i0({inputs:{x:i},backend:n,attrs:{begin:p,size:x}}),N=vt({inputs:{x:b},backend:n,attrs:{shape:u}});y[v]=N,f.push(b)}return f.forEach(v=>n.disposeIntermediateTensorInfo(v)),y}const dqe={kernelName:Wy,backendName:"webgl",kernelFunc:uqe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hqe{constructor(e,n){this.variableNames=["x","segmentIds"];const s=e.windowSize,r=e.batchSize,a=e.inSize,i=e.numSegments,l=i*Math.ceil(a/s);this.outputShape=[r,l];const c="0.0",u="sumValue",h=Math.floor(s/4)*4,f=s%4,p=`
        sumValue += dot(values, segFilter);
    `;let x="";a%s>0&&(x=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return initializationValue;
        }
      `);let y="";a%s>0&&(y=`
        if (inIdx < 0 || inIdx >= ${a}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${c};

      float getValue(int batch, int inIdx) {
        ${x}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${y}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${i})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${i})));

        float sumValue = 0.0;

        for (int i = 0; i < ${h}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${p}
        }

        int inIdx = inOffset + ${h};
        if (${f===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${p}
        } else if (${f===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${p}
        } else if (${f===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${p}
        }
        setOutput(${u});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mqe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:a}=e,{numSegments:i}=s,l=r.shape.length,c=[];let u=0;const h=Os([u],l);let f=r;h!=null&&(f=Ca({inputs:{x:r},backend:n,attrs:{perm:h}}),c.push(f),u=Hs(1,l)[0]);const p=xK(f.shape,u,i),x=ze([f.shape[u]]),y=vt({inputs:{x:f},backend:n,attrs:{shape:[-1,x]}});c.push(y);const v=wS(r.dtype),b=(T,E,D,A,I)=>{const P=T.shape[0],$=T.shape[1],R=gK($,I),F={windowSize:R,inSize:$,batchSize:P,numSegments:I},W=new hqe(F,E),q=n.compileAndRun(W,[T,D],A);if(c.push(q),q.shape[1]===I)return q;const X=UZ({backend:n,attrs:{start:0,stop:I,step:1,dtype:"float32"}}),z=VZ({inputs:{x:X},backend:n,attrs:{reps:[$/R]}});return c.push(X),c.push(z),b(q,E,z,A,I)},N=b(y,"unsortedSegmentSum",a,v,i),S=vt({inputs:{x:N},backend:n,attrs:{shape:p}});let k=S;if(h!=null){c.push(S);const T=dd(h);k=Ca({inputs:{x:k},backend:n,attrs:{perm:T}})}return c.forEach(T=>n.disposeIntermediateTensorInfo(T)),k}const fqe={kernelName:Hy,backendName:"webgl",kernelFunc:mqe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pqe=[Z8e,eBe,sBe,iBe,lBe,dBe,mBe,pBe,bBe,wBe,jBe,TBe,ABe,OBe,LBe,FBe,BBe,HBe,qBe,XBe,JBe,i7e,l7e,h7e,f7e,v7e,N7e,C7e,D8e,E7e,O7e,M7e,W7e,q7e,X7e,Q7e,J7e,sUe,iUe,cUe,dUe,mUe,pUe,yUe,vUe,jUe,CUe,EUe,IUe,OUe,MUe,UUe,GUe,XUe,ZUe,JUe,tVe,sVe,aVe,oVe,cVe,mVe,gVe,bVe,wVe,jVe,TVe,$Ve,DVe,O8e,LVe,I7e,zVe,VVe,GVe,L8e,YVe,e9e,n9e,i9e,c9e,m9e,g9e,v9e,j9e,T9e,E9e,R9e,D9e,L9e,B9e,V9e,H9e,q9e,X9e,J9e,sWe,oWe,pWe,z8e,bWe,NWe,kWe,_We,g7e,$We,RWe,DWe,MWe,UWe,F8e,WWe,GWe,KWe,YWe,QWe,x7e,dWe,eHe,rHe,lHe,U8e,hHe,pHe,bHe,NHe,CHe,_He,$He,OHe,LHe,zHe,VHe,GHe,YHe,JHe,sGe,iGe,r7e,mWe,cGe,dGe,mGe,pGe,xGe,bGe,wGe,SGe,kGe,_Ge,AGe,IGe,OGe,LGe,FGe,BGe,VGe,hWe,X8e,GGe,XGe,QGe,eqe,rqe,oqe,Y8e,cqe,dqe,fqe,IWe];for(const t of pqe)vS(t);/** @license See the LICENSE file. */const gqe="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xqe={"tfjs-core":qq,"tfjs-backend-cpu":JY,"tfjs-backend-webgl":mZ,"tfjs-data":sY,"tfjs-layers":Nj,"tfjs-converter":BX,tfjs:gqe},yqe=Object.freeze(Object.defineProperty({__proto__:null,Abs:Wx,Acos:Vf,Acosh:Wf,AdadeltaOptimizer:uI,AdagradOptimizer:dI,AdamOptimizer:hI,AdamaxOptimizer:mI,Add:Gh,AddN:Hx,All:pN,Any:gN,ArgMax:Gx,ArgMin:qx,Asin:Hf,Asinh:Gf,Atan:qf,Atan2:Xf,Atanh:Kf,AvgPool:Kx,AvgPool3D:Xx,AvgPool3DGrad:yN,AvgPoolGrad:xN,BatchMatMul:Yx,BatchToSpaceND:Qx,Bincount:bN,BitwiseAnd:Zx,BroadcastArgs:vN,BroadcastTo:KH,Callback:DX,CallbackList:PK,Cast:Yf,Ceil:Qf,ClipByValue:Zf,Complex:wN,ComplexAbs:Jx,Concat:ey,Conv2D:ty,Conv2DBackpropFilter:NN,Conv2DBackpropInput:ny,Conv3D:sy,Conv3DBackpropFilterV2:SN,Conv3DBackpropInputV2:jN,Cos:Jf,Cosh:ep,CropAndResize:CN,Cumprod:kN,Cumsum:ry,CustomCallback:MK,DataStorage:UA,DenseBincount:TN,DepthToSpace:_N,DepthwiseConv2dNative:ay,DepthwiseConv2dNativeBackpropFilter:EN,DepthwiseConv2dNativeBackpropInput:AN,Diag:$N,Dilation2D:iy,Dilation2DBackpropFilter:Kw,Dilation2DBackpropInput:qw,Draw:IN,get ENV(){return qA},EarlyStopping:PX,Einsum:RN,Elu:np,EluGrad:ON,Environment:GH,Equal:oy,Erf:sp,Exp:rp,ExpandDims:ly,Expm1:ap,FFT:DN,Fill:PN,FlipLeftRight:LN,Floor:ip,FloorDiv:op,FromPixels:Xw,FusedBatchNorm:cy,FusedConv2D:tx,FusedDepthwiseConv2D:nx,GPGPUContext:Q1,GatherNd:MN,GatherV2:uy,GraphModel:wR,Greater:dy,GreaterEqual:lp,History:LK,IFFT:FN,Identity:cp,Imag:zN,InputSpec:er,IsFinite:up,IsInf:dp,IsNan:hp,KernelBackend:hN,LRN:yy,LRNGrad:UN,LayerVariable:IK,LayersModel:Cc,LeakyRelu:hy,Less:my,LessEqual:fy,LinSpace:BN,Log:mp,Log1p:fp,LogSoftmax:XH,LogicalAnd:py,LogicalNot:gy,LogicalOr:xy,LogicalXor:awe,LowerBound:iwe,MathBackendCPU:kb,MathBackendWebGL:Eb,MatrixBandPart:owe,Max:by,MaxPool:vy,MaxPool3D:wy,MaxPool3DGrad:WN,MaxPoolGrad:VN,MaxPoolWithArgmax:HN,Maximum:pp,Mean:Ny,Min:Sy,Minimum:gp,MirrorPad:jy,Mod:xp,MomentumOptimizer:fI,Multinomial:GN,Multiply:yp,Neg:ky,NonMaxSuppressionV3:qN,NonMaxSuppressionV4:KN,NonMaxSuppressionV5:XN,NotEqual:Cy,OP_SCOPE_SUFFIX:ZA,OneHot:_y,OnesLike:Ty,Optimizer:nu,OptimizerConstructors:Kq,Pack:Ey,PadV2:Ay,Pool:lwe,Pow:bp,Prelu:$y,Prod:Iy,RMSPropOptimizer:pI,RNN:yl,RaggedGather:YN,RaggedRange:QN,RaggedTensorToTensor:ZN,Range:JN,get Rank(){return Z_},Real:eS,RealDiv:tp,Reciprocal:vp,get Reduction(){return Na},Relu:wp,Relu6:Np,Reshape:Ry,ResizeBilinear:Dy,ResizeBilinearGrad:nS,ResizeNearestNeighbor:Oy,ResizeNearestNeighborGrad:tS,Reverse:Py,RotateWithOffset:bS,Round:Sp,Rsqrt:jp,SGDOptimizer:rj,ScatterNd:sS,SearchSorted:aS,Select:Ly,Selu:kp,Sequential:$h,Sigmoid:Ep,Sign:_p,Sin:Cp,Sinh:Tp,Slice:My,Softmax:Uy,Softplus:Ap,SpaceToBatchND:zy,SparseFillEmptyRows:iS,SparseReshape:oS,SparseSegmentMean:lS,SparseSegmentSum:cS,SparseToDense:uS,SplitV:By,Sqrt:$p,Square:dS,SquaredDifference:Ip,StaticRegexReplace:Vy,Step:Lp,StridedSlice:hS,StringNGrams:mS,StringSplit:fS,StringToHashBucketFast:pS,Sub:Rp,Sum:Fy,SymbolicTensor:ul,Tan:Op,Tanh:Dp,Tensor:Tn,TensorBuffer:tr,TensorScatterUpdate:rS,Tile:Pp,TopK:gS,Transform:xS,Transpose:ch,Unique:yS,Unpack:Wy,UnsortedSegmentSum:Hy,UpperBound:cwe,Variable:ax,ZerosLike:Gy,_FusedMatMul:ex,abs:Js,acos:i$,acosh:o$,add:nt,addN:kG,all:jS,any:ox,argMax:jh,argMin:l$,asin:c$,asinh:u$,atan:d$,atan2:h$,atanh:m$,avgPool:Yy,avgPool3d:p$,backend:e$,backend_util:bK,basicLSTMCell:CG,batchNorm:Mp,batchNorm2d:g$,batchNorm3d:x$,batchNorm4d:y$,batchToSpaceND:Qy,bincount:b$,bitwiseAnd:TG,booleanMaskAsync:dq,broadcastArgs:_G,broadcastTo:uh,broadcast_util:zNe,browser:r3e,buffer:on,callbacks:bIe,cast:ft,ceil:v$,clipByValue:Ha,clone:Ol,complex:Pc,concat:Vs,concat1d:w$,concat2d:N$,concat3d:S$,concat4d:j$,constraints:i4e,conv1d:kS,conv2d:Lc,conv2dTranspose:CS,conv3d:C$,conv3dTranspose:T$,copyRegisteredKernels:mwe,cos:Zy,cosh:TS,cosineWindow:YS,cumprod:ux,cumsum:_S,customGrad:Vl,data:$Re,denseBincount:Zw,deprecationWarn:Wwe,depthToSpace:_$,depthwiseConv2d:Fp,deregisterOp:NIe,device_util:Mwe,diag:AG,dilation2d:E$,disableDeprecationWarnings:Vwe,dispose:Jt,disposeVariables:Hwe,div:Mt,divNoNan:A$,dot:$$,dropout:aI,einsum:Wd,elu:zp,enableDebugMode:Uwe,enableProdMode:Bwe,enclosingPowerOfTwo:iI,engine:Qo,ensureShape:$G,env:$e,equal:gi,erf:ES,euclideanNorm:R$,exp:Ga,expandDims:Br,expm1:O$,eye:AS,fft:db,fill:qh,findBackend:Qwe,findBackendFactory:Zwe,floor:Up,floorDiv:SS,forceHalfFloat:fZ,fused:vq,gather:Vp,gatherND:pq,gather_util:a3e,getBackend:dG,getGradient:Y_,getKernel:rx,getKernelsForBackend:Yw,gpgpu_util:fze,grad:SSe,grads:jSe,greater:_a,greaterEqual:Jc,ifft:vf,imag:Jy,image:Vi,inTopKAsync:gq,initializers:N4e,input:eX,io:yI,irfft:WS,isFinite:D$,isInf:P$,isNaN:L$,keep:hr,kernel_impls:f3e,layers:X$e,leakyRelu:eb,less:gf,lessEqual:hd,linalg:cI,linspace:OG,loadGraphModel:zX,loadGraphModelSync:q5e,loadLayersModel:ZK,localResponseNormalization:M$,log:xi,log1p:tb,logSigmoid:F$,logSoftmax:IS,logSumExp:nb,logicalAnd:Io,logicalNot:sb,logicalOr:RS,logicalXor:z$,losses:Tq,lowerBound:PG,matMul:mn,math:XTe,max:Ki,maxPool:rb,maxPool3d:B$,maxPoolWithArgmax:LG,maximum:Gl,mean:Es,memory:rE,meshgrid:MG,metrics:hIe,min:pf,minimum:Ju,mirrorPad:U$,mod:V$,model:JK,models:mIe,moments:ab,movingAverage:hq,mul:ge,multiRNNCell:FG,multinomial:zG,neg:gs,nextFrame:kI,norm:Bp,notEqual:Th,oneHot:xf,ones:Fa,onesLike:yi,op:he,outerProduct:BG,pad:eu,pad1d:UG,pad2d:VG,pad3d:WG,pad4d:HG,pool:W$,pow:Ul,prelu:ob,print:a$,prod:H$,profile:Gwe,raggedGather:GG,raggedRange:qG,raggedTensorToTensor:KG,rand:XG,randomGamma:ZG,randomNormal:DS,randomStandardNormal:JG,randomUniform:md,randomUniformInt:eq,range:_h,ready:Xwe,real:yf,reciprocal:X$,registerBackend:JA,registerCallbackConstructor:pAe,registerGradient:YH,registerKernel:vS,registerOp:wIe,regularizers:xIe,relu:gl,relu6:PS,removeBackend:Ywe,reshape:be,reverse:Ji,reverse1d:tq,reverse2d:nq,reverse3d:sq,reverse4d:rq,rfft:hb,round:LS,rsqrt:MS,scalar:Bt,scatterND:mq,scatter_util:_ke,searchSorted:OS,selu:FS,separableConv2d:zS,sequential:fAe,serialization:ETe,setBackend:Kwe,setPlatform:Jwe,setWebGLContext:gQ,setdiff1dAsync:aq,shared:ZY,sigmoid:rl,sign:Y$,signal:Cq,sin:BS,sinh:US,slice:Nn,slice1d:lb,slice2d:VS,slice3d:cb,slice4d:bf,slice_util:Gq,softmax:ub,softplus:Kh,spaceToBatchND:ib,sparse:_q,sparseToDense:fq,spectral:kq,split:Ua,sqrt:Ar,square:Jn,squaredDifference:HS,squeeze:fd,stack:ka,step:Xh,stridedSlice:Q$,string:Eq,sub:Tt,sum:$t,sumOutType:wS,tan:Z$,tanh:Zu,tensor:pi,tensor1d:Wr,tensor2d:Uu,tensor3d:J$,tensor4d:iq,tensor5d:oq,tensor6d:lq,tensorScatterUpdate:cq,tensor_util:Rwe,test_util:Bje,tidy:Ee,tile:Ui,time:qwe,topk:tI,train:Bd,transpose:bn,truncatedNormal:qS,unique:nI,unregisterGradient:hwe,unregisterKernel:dwe,unsortedSegmentSum:KS,unstack:eo,upcastType:Va,upperBound:uq,util:wwe,valueAndGrad:kSe,valueAndGrads:CSe,variable:sI,variableGrads:DG,version:xqe,version_converter:BX,version_core:qq,version_cpu:JY,version_layers:Nj,version_webgl:mZ,webgl:R8e,webgl_util:vFe,where:_r,whereAsync:rI,zeros:Us,zerosLike:Sn},Symbol.toStringTag,{value:"Module"}));var z3={},pg={},KB;function bqe(){if(KB)return pg;KB=1,pg.byteLength=l,pg.toByteArray=u,pg.fromByteArray=p;for(var t=[],e=[],n=typeof Uint8Array<"u"?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=0,a=s.length;r<a;++r)t[r]=s[r],e[s.charCodeAt(r)]=r;e[45]=62,e[95]=63;function i(x){var y=x.length;if(y%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var v=x.indexOf("=");v===-1&&(v=y);var b=v===y?0:4-v%4;return[v,b]}function l(x){var y=i(x),v=y[0],b=y[1];return(v+b)*3/4-b}function c(x,y,v){return(y+v)*3/4-v}function u(x){var y,v=i(x),b=v[0],N=v[1],S=new n(c(x,b,N)),k=0,T=N>0?b-4:b,E;for(E=0;E<T;E+=4)y=e[x.charCodeAt(E)]<<18|e[x.charCodeAt(E+1)]<<12|e[x.charCodeAt(E+2)]<<6|e[x.charCodeAt(E+3)],S[k++]=y>>16&255,S[k++]=y>>8&255,S[k++]=y&255;return N===2&&(y=e[x.charCodeAt(E)]<<2|e[x.charCodeAt(E+1)]>>4,S[k++]=y&255),N===1&&(y=e[x.charCodeAt(E)]<<10|e[x.charCodeAt(E+1)]<<4|e[x.charCodeAt(E+2)]>>2,S[k++]=y>>8&255,S[k++]=y&255),S}function h(x){return t[x>>18&63]+t[x>>12&63]+t[x>>6&63]+t[x&63]}function f(x,y,v){for(var b,N=[],S=y;S<v;S+=3)b=(x[S]<<16&16711680)+(x[S+1]<<8&65280)+(x[S+2]&255),N.push(h(b));return N.join("")}function p(x){for(var y,v=x.length,b=v%3,N=[],S=16383,k=0,T=v-b;k<T;k+=S)N.push(f(x,k,k+S>T?T:k+S));return b===1?(y=x[v-1],N.push(t[y>>2]+t[y<<4&63]+"==")):b===2&&(y=(x[v-2]<<8)+x[v-1],N.push(t[y>>10]+t[y>>4&63]+t[y<<2&63]+"=")),N.join("")}return pg}var N1={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var XB;function vqe(){return XB||(XB=1,N1.read=function(t,e,n,s,r){var a,i,l=r*8-s-1,c=(1<<l)-1,u=c>>1,h=-7,f=n?r-1:0,p=n?-1:1,x=t[e+f];for(f+=p,a=x&(1<<-h)-1,x>>=-h,h+=l;h>0;a=a*256+t[e+f],f+=p,h-=8);for(i=a&(1<<-h)-1,a>>=-h,h+=s;h>0;i=i*256+t[e+f],f+=p,h-=8);if(a===0)a=1-u;else{if(a===c)return i?NaN:(x?-1:1)*(1/0);i=i+Math.pow(2,s),a=a-u}return(x?-1:1)*i*Math.pow(2,a-s)},N1.write=function(t,e,n,s,r,a){var i,l,c,u=a*8-r-1,h=(1<<u)-1,f=h>>1,p=r===23?Math.pow(2,-24)-Math.pow(2,-77):0,x=s?0:a-1,y=s?1:-1,v=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(l=isNaN(e)?1:0,i=h):(i=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-i))<1&&(i--,c*=2),i+f>=1?e+=p/c:e+=p*Math.pow(2,1-f),e*c>=2&&(i++,c/=2),i+f>=h?(l=0,i=h):i+f>=1?(l=(e*c-1)*Math.pow(2,r),i=i+f):(l=e*Math.pow(2,f-1)*Math.pow(2,r),i=0));r>=8;t[n+x]=l&255,x+=y,l/=256,r-=8);for(i=i<<r|l,u+=r;u>0;t[n+x]=i&255,x+=y,i/=256,u-=8);t[n+x-y]|=v*128}),N1}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var YB;function wqe(){return YB||(YB=1,(function(t){const e=bqe(),n=vqe(),s=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=l,t.SlowBuffer=S,t.INSPECT_MAX_BYTES=50;const r=2147483647;t.kMaxLength=r,l.TYPED_ARRAY_SUPPORT=a(),!l.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function a(){try{const Q=new Uint8Array(1),L={foo:function(){return 42}};return Object.setPrototypeOf(L,Uint8Array.prototype),Object.setPrototypeOf(Q,L),Q.foo()===42}catch{return!1}}Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}});function i(Q){if(Q>r)throw new RangeError('The value "'+Q+'" is invalid for option "size"');const L=new Uint8Array(Q);return Object.setPrototypeOf(L,l.prototype),L}function l(Q,L,M){if(typeof Q=="number"){if(typeof L=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return f(Q)}return c(Q,L,M)}l.poolSize=8192;function c(Q,L,M){if(typeof Q=="string")return p(Q,L);if(ArrayBuffer.isView(Q))return y(Q);if(Q==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Q);if(mt(Q,ArrayBuffer)||Q&&mt(Q.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(mt(Q,SharedArrayBuffer)||Q&&mt(Q.buffer,SharedArrayBuffer)))return v(Q,L,M);if(typeof Q=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const ee=Q.valueOf&&Q.valueOf();if(ee!=null&&ee!==Q)return l.from(ee,L,M);const ce=b(Q);if(ce)return ce;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Q[Symbol.toPrimitive]=="function")return l.from(Q[Symbol.toPrimitive]("string"),L,M);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Q)}l.from=function(Q,L,M){return c(Q,L,M)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array);function u(Q){if(typeof Q!="number")throw new TypeError('"size" argument must be of type number');if(Q<0)throw new RangeError('The value "'+Q+'" is invalid for option "size"')}function h(Q,L,M){return u(Q),Q<=0?i(Q):L!==void 0?typeof M=="string"?i(Q).fill(L,M):i(Q).fill(L):i(Q)}l.alloc=function(Q,L,M){return h(Q,L,M)};function f(Q){return u(Q),i(Q<0?0:N(Q)|0)}l.allocUnsafe=function(Q){return f(Q)},l.allocUnsafeSlow=function(Q){return f(Q)};function p(Q,L){if((typeof L!="string"||L==="")&&(L="utf8"),!l.isEncoding(L))throw new TypeError("Unknown encoding: "+L);const M=k(Q,L)|0;let ee=i(M);const ce=ee.write(Q,L);return ce!==M&&(ee=ee.slice(0,ce)),ee}function x(Q){const L=Q.length<0?0:N(Q.length)|0,M=i(L);for(let ee=0;ee<L;ee+=1)M[ee]=Q[ee]&255;return M}function y(Q){if(mt(Q,Uint8Array)){const L=new Uint8Array(Q);return v(L.buffer,L.byteOffset,L.byteLength)}return x(Q)}function v(Q,L,M){if(L<0||Q.byteLength<L)throw new RangeError('"offset" is outside of buffer bounds');if(Q.byteLength<L+(M||0))throw new RangeError('"length" is outside of buffer bounds');let ee;return L===void 0&&M===void 0?ee=new Uint8Array(Q):M===void 0?ee=new Uint8Array(Q,L):ee=new Uint8Array(Q,L,M),Object.setPrototypeOf(ee,l.prototype),ee}function b(Q){if(l.isBuffer(Q)){const L=N(Q.length)|0,M=i(L);return M.length===0||Q.copy(M,0,0,L),M}if(Q.length!==void 0)return typeof Q.length!="number"||jt(Q.length)?i(0):x(Q);if(Q.type==="Buffer"&&Array.isArray(Q.data))return x(Q.data)}function N(Q){if(Q>=r)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r.toString(16)+" bytes");return Q|0}function S(Q){return+Q!=Q&&(Q=0),l.alloc(+Q)}l.isBuffer=function(L){return L!=null&&L._isBuffer===!0&&L!==l.prototype},l.compare=function(L,M){if(mt(L,Uint8Array)&&(L=l.from(L,L.offset,L.byteLength)),mt(M,Uint8Array)&&(M=l.from(M,M.offset,M.byteLength)),!l.isBuffer(L)||!l.isBuffer(M))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(L===M)return 0;let ee=L.length,ce=M.length;for(let Ce=0,De=Math.min(ee,ce);Ce<De;++Ce)if(L[Ce]!==M[Ce]){ee=L[Ce],ce=M[Ce];break}return ee<ce?-1:ce<ee?1:0},l.isEncoding=function(L){switch(String(L).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(L,M){if(!Array.isArray(L))throw new TypeError('"list" argument must be an Array of Buffers');if(L.length===0)return l.alloc(0);let ee;if(M===void 0)for(M=0,ee=0;ee<L.length;++ee)M+=L[ee].length;const ce=l.allocUnsafe(M);let Ce=0;for(ee=0;ee<L.length;++ee){let De=L[ee];if(mt(De,Uint8Array))Ce+De.length>ce.length?(l.isBuffer(De)||(De=l.from(De)),De.copy(ce,Ce)):Uint8Array.prototype.set.call(ce,De,Ce);else if(l.isBuffer(De))De.copy(ce,Ce);else throw new TypeError('"list" argument must be an Array of Buffers');Ce+=De.length}return ce};function k(Q,L){if(l.isBuffer(Q))return Q.length;if(ArrayBuffer.isView(Q)||mt(Q,ArrayBuffer))return Q.byteLength;if(typeof Q!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Q);const M=Q.length,ee=arguments.length>2&&arguments[2]===!0;if(!ee&&M===0)return 0;let ce=!1;for(;;)switch(L){case"ascii":case"latin1":case"binary":return M;case"utf8":case"utf-8":return Ve(Q).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M*2;case"hex":return M>>>1;case"base64":return tt(Q).length;default:if(ce)return ee?-1:Ve(Q).length;L=(""+L).toLowerCase(),ce=!0}}l.byteLength=k;function T(Q,L,M){let ee=!1;if((L===void 0||L<0)&&(L=0),L>this.length||((M===void 0||M>this.length)&&(M=this.length),M<=0)||(M>>>=0,L>>>=0,M<=L))return"";for(Q||(Q="utf8");;)switch(Q){case"hex":return Y(this,L,M);case"utf8":case"utf-8":return q(this,L,M);case"ascii":return K(this,L,M);case"latin1":case"binary":return H(this,L,M);case"base64":return W(this,L,M);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,L,M);default:if(ee)throw new TypeError("Unknown encoding: "+Q);Q=(Q+"").toLowerCase(),ee=!0}}l.prototype._isBuffer=!0;function E(Q,L,M){const ee=Q[L];Q[L]=Q[M],Q[M]=ee}l.prototype.swap16=function(){const L=this.length;if(L%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let M=0;M<L;M+=2)E(this,M,M+1);return this},l.prototype.swap32=function(){const L=this.length;if(L%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let M=0;M<L;M+=4)E(this,M,M+3),E(this,M+1,M+2);return this},l.prototype.swap64=function(){const L=this.length;if(L%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let M=0;M<L;M+=8)E(this,M,M+7),E(this,M+1,M+6),E(this,M+2,M+5),E(this,M+3,M+4);return this},l.prototype.toString=function(){const L=this.length;return L===0?"":arguments.length===0?q(this,0,L):T.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(L){if(!l.isBuffer(L))throw new TypeError("Argument must be a Buffer");return this===L?!0:l.compare(this,L)===0},l.prototype.inspect=function(){let L="";const M=t.INSPECT_MAX_BYTES;return L=this.toString("hex",0,M).replace(/(.{2})/g,"$1 ").trim(),this.length>M&&(L+=" ... "),"<Buffer "+L+">"},s&&(l.prototype[s]=l.prototype.inspect),l.prototype.compare=function(L,M,ee,ce,Ce){if(mt(L,Uint8Array)&&(L=l.from(L,L.offset,L.byteLength)),!l.isBuffer(L))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof L);if(M===void 0&&(M=0),ee===void 0&&(ee=L?L.length:0),ce===void 0&&(ce=0),Ce===void 0&&(Ce=this.length),M<0||ee>L.length||ce<0||Ce>this.length)throw new RangeError("out of range index");if(ce>=Ce&&M>=ee)return 0;if(ce>=Ce)return-1;if(M>=ee)return 1;if(M>>>=0,ee>>>=0,ce>>>=0,Ce>>>=0,this===L)return 0;let De=Ce-ce,xt=ee-M;const Ie=Math.min(De,xt),lt=this.slice(ce,Ce),Nt=L.slice(M,ee);for(let kt=0;kt<Ie;++kt)if(lt[kt]!==Nt[kt]){De=lt[kt],xt=Nt[kt];break}return De<xt?-1:xt<De?1:0};function D(Q,L,M,ee,ce){if(Q.length===0)return-1;if(typeof M=="string"?(ee=M,M=0):M>2147483647?M=2147483647:M<-2147483648&&(M=-2147483648),M=+M,jt(M)&&(M=ce?0:Q.length-1),M<0&&(M=Q.length+M),M>=Q.length){if(ce)return-1;M=Q.length-1}else if(M<0)if(ce)M=0;else return-1;if(typeof L=="string"&&(L=l.from(L,ee)),l.isBuffer(L))return L.length===0?-1:A(Q,L,M,ee,ce);if(typeof L=="number")return L=L&255,typeof Uint8Array.prototype.indexOf=="function"?ce?Uint8Array.prototype.indexOf.call(Q,L,M):Uint8Array.prototype.lastIndexOf.call(Q,L,M):A(Q,[L],M,ee,ce);throw new TypeError("val must be string, number or Buffer")}function A(Q,L,M,ee,ce){let Ce=1,De=Q.length,xt=L.length;if(ee!==void 0&&(ee=String(ee).toLowerCase(),ee==="ucs2"||ee==="ucs-2"||ee==="utf16le"||ee==="utf-16le")){if(Q.length<2||L.length<2)return-1;Ce=2,De/=2,xt/=2,M/=2}function Ie(Nt,kt){return Ce===1?Nt[kt]:Nt.readUInt16BE(kt*Ce)}let lt;if(ce){let Nt=-1;for(lt=M;lt<De;lt++)if(Ie(Q,lt)===Ie(L,Nt===-1?0:lt-Nt)){if(Nt===-1&&(Nt=lt),lt-Nt+1===xt)return Nt*Ce}else Nt!==-1&&(lt-=lt-Nt),Nt=-1}else for(M+xt>De&&(M=De-xt),lt=M;lt>=0;lt--){let Nt=!0;for(let kt=0;kt<xt;kt++)if(Ie(Q,lt+kt)!==Ie(L,kt)){Nt=!1;break}if(Nt)return lt}return-1}l.prototype.includes=function(L,M,ee){return this.indexOf(L,M,ee)!==-1},l.prototype.indexOf=function(L,M,ee){return D(this,L,M,ee,!0)},l.prototype.lastIndexOf=function(L,M,ee){return D(this,L,M,ee,!1)};function I(Q,L,M,ee){M=Number(M)||0;const ce=Q.length-M;ee?(ee=Number(ee),ee>ce&&(ee=ce)):ee=ce;const Ce=L.length;ee>Ce/2&&(ee=Ce/2);let De;for(De=0;De<ee;++De){const xt=parseInt(L.substr(De*2,2),16);if(jt(xt))return De;Q[M+De]=xt}return De}function P(Q,L,M,ee){return St(Ve(L,Q.length-M),Q,M,ee)}function $(Q,L,M,ee){return St(Ze(L),Q,M,ee)}function R(Q,L,M,ee){return St(tt(L),Q,M,ee)}function F(Q,L,M,ee){return St(bt(L,Q.length-M),Q,M,ee)}l.prototype.write=function(L,M,ee,ce){if(M===void 0)ce="utf8",ee=this.length,M=0;else if(ee===void 0&&typeof M=="string")ce=M,ee=this.length,M=0;else if(isFinite(M))M=M>>>0,isFinite(ee)?(ee=ee>>>0,ce===void 0&&(ce="utf8")):(ce=ee,ee=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Ce=this.length-M;if((ee===void 0||ee>Ce)&&(ee=Ce),L.length>0&&(ee<0||M<0)||M>this.length)throw new RangeError("Attempt to write outside buffer bounds");ce||(ce="utf8");let De=!1;for(;;)switch(ce){case"hex":return I(this,L,M,ee);case"utf8":case"utf-8":return P(this,L,M,ee);case"ascii":case"latin1":case"binary":return $(this,L,M,ee);case"base64":return R(this,L,M,ee);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F(this,L,M,ee);default:if(De)throw new TypeError("Unknown encoding: "+ce);ce=(""+ce).toLowerCase(),De=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function W(Q,L,M){return L===0&&M===Q.length?e.fromByteArray(Q):e.fromByteArray(Q.slice(L,M))}function q(Q,L,M){M=Math.min(Q.length,M);const ee=[];let ce=L;for(;ce<M;){const Ce=Q[ce];let De=null,xt=Ce>239?4:Ce>223?3:Ce>191?2:1;if(ce+xt<=M){let Ie,lt,Nt,kt;switch(xt){case 1:Ce<128&&(De=Ce);break;case 2:Ie=Q[ce+1],(Ie&192)===128&&(kt=(Ce&31)<<6|Ie&63,kt>127&&(De=kt));break;case 3:Ie=Q[ce+1],lt=Q[ce+2],(Ie&192)===128&&(lt&192)===128&&(kt=(Ce&15)<<12|(Ie&63)<<6|lt&63,kt>2047&&(kt<55296||kt>57343)&&(De=kt));break;case 4:Ie=Q[ce+1],lt=Q[ce+2],Nt=Q[ce+3],(Ie&192)===128&&(lt&192)===128&&(Nt&192)===128&&(kt=(Ce&15)<<18|(Ie&63)<<12|(lt&63)<<6|Nt&63,kt>65535&&kt<1114112&&(De=kt))}}De===null?(De=65533,xt=1):De>65535&&(De-=65536,ee.push(De>>>10&1023|55296),De=56320|De&1023),ee.push(De),ce+=xt}return z(ee)}const X=4096;function z(Q){const L=Q.length;if(L<=X)return String.fromCharCode.apply(String,Q);let M="",ee=0;for(;ee<L;)M+=String.fromCharCode.apply(String,Q.slice(ee,ee+=X));return M}function K(Q,L,M){let ee="";M=Math.min(Q.length,M);for(let ce=L;ce<M;++ce)ee+=String.fromCharCode(Q[ce]&127);return ee}function H(Q,L,M){let ee="";M=Math.min(Q.length,M);for(let ce=L;ce<M;++ce)ee+=String.fromCharCode(Q[ce]);return ee}function Y(Q,L,M){const ee=Q.length;(!L||L<0)&&(L=0),(!M||M<0||M>ee)&&(M=ee);let ce="";for(let Ce=L;Ce<M;++Ce)ce+=Oe[Q[Ce]];return ce}function B(Q,L,M){const ee=Q.slice(L,M);let ce="";for(let Ce=0;Ce<ee.length-1;Ce+=2)ce+=String.fromCharCode(ee[Ce]+ee[Ce+1]*256);return ce}l.prototype.slice=function(L,M){const ee=this.length;L=~~L,M=M===void 0?ee:~~M,L<0?(L+=ee,L<0&&(L=0)):L>ee&&(L=ee),M<0?(M+=ee,M<0&&(M=0)):M>ee&&(M=ee),M<L&&(M=L);const ce=this.subarray(L,M);return Object.setPrototypeOf(ce,l.prototype),ce};function O(Q,L,M){if(Q%1!==0||Q<0)throw new RangeError("offset is not uint");if(Q+L>M)throw new RangeError("Trying to access beyond buffer length")}l.prototype.readUintLE=l.prototype.readUIntLE=function(L,M,ee){L=L>>>0,M=M>>>0,ee||O(L,M,this.length);let ce=this[L],Ce=1,De=0;for(;++De<M&&(Ce*=256);)ce+=this[L+De]*Ce;return ce},l.prototype.readUintBE=l.prototype.readUIntBE=function(L,M,ee){L=L>>>0,M=M>>>0,ee||O(L,M,this.length);let ce=this[L+--M],Ce=1;for(;M>0&&(Ce*=256);)ce+=this[L+--M]*Ce;return ce},l.prototype.readUint8=l.prototype.readUInt8=function(L,M){return L=L>>>0,M||O(L,1,this.length),this[L]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(L,M){return L=L>>>0,M||O(L,2,this.length),this[L]|this[L+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(L,M){return L=L>>>0,M||O(L,2,this.length),this[L]<<8|this[L+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(L,M){return L=L>>>0,M||O(L,4,this.length),(this[L]|this[L+1]<<8|this[L+2]<<16)+this[L+3]*16777216},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(L,M){return L=L>>>0,M||O(L,4,this.length),this[L]*16777216+(this[L+1]<<16|this[L+2]<<8|this[L+3])},l.prototype.readBigUInt64LE=ht(function(L){L=L>>>0,re(L,"offset");const M=this[L],ee=this[L+7];(M===void 0||ee===void 0)&&je(L,this.length-8);const ce=M+this[++L]*2**8+this[++L]*2**16+this[++L]*2**24,Ce=this[++L]+this[++L]*2**8+this[++L]*2**16+ee*2**24;return BigInt(ce)+(BigInt(Ce)<<BigInt(32))}),l.prototype.readBigUInt64BE=ht(function(L){L=L>>>0,re(L,"offset");const M=this[L],ee=this[L+7];(M===void 0||ee===void 0)&&je(L,this.length-8);const ce=M*2**24+this[++L]*2**16+this[++L]*2**8+this[++L],Ce=this[++L]*2**24+this[++L]*2**16+this[++L]*2**8+ee;return(BigInt(ce)<<BigInt(32))+BigInt(Ce)}),l.prototype.readIntLE=function(L,M,ee){L=L>>>0,M=M>>>0,ee||O(L,M,this.length);let ce=this[L],Ce=1,De=0;for(;++De<M&&(Ce*=256);)ce+=this[L+De]*Ce;return Ce*=128,ce>=Ce&&(ce-=Math.pow(2,8*M)),ce},l.prototype.readIntBE=function(L,M,ee){L=L>>>0,M=M>>>0,ee||O(L,M,this.length);let ce=M,Ce=1,De=this[L+--ce];for(;ce>0&&(Ce*=256);)De+=this[L+--ce]*Ce;return Ce*=128,De>=Ce&&(De-=Math.pow(2,8*M)),De},l.prototype.readInt8=function(L,M){return L=L>>>0,M||O(L,1,this.length),this[L]&128?(255-this[L]+1)*-1:this[L]},l.prototype.readInt16LE=function(L,M){L=L>>>0,M||O(L,2,this.length);const ee=this[L]|this[L+1]<<8;return ee&32768?ee|4294901760:ee},l.prototype.readInt16BE=function(L,M){L=L>>>0,M||O(L,2,this.length);const ee=this[L+1]|this[L]<<8;return ee&32768?ee|4294901760:ee},l.prototype.readInt32LE=function(L,M){return L=L>>>0,M||O(L,4,this.length),this[L]|this[L+1]<<8|this[L+2]<<16|this[L+3]<<24},l.prototype.readInt32BE=function(L,M){return L=L>>>0,M||O(L,4,this.length),this[L]<<24|this[L+1]<<16|this[L+2]<<8|this[L+3]},l.prototype.readBigInt64LE=ht(function(L){L=L>>>0,re(L,"offset");const M=this[L],ee=this[L+7];(M===void 0||ee===void 0)&&je(L,this.length-8);const ce=this[L+4]+this[L+5]*2**8+this[L+6]*2**16+(ee<<24);return(BigInt(ce)<<BigInt(32))+BigInt(M+this[++L]*2**8+this[++L]*2**16+this[++L]*2**24)}),l.prototype.readBigInt64BE=ht(function(L){L=L>>>0,re(L,"offset");const M=this[L],ee=this[L+7];(M===void 0||ee===void 0)&&je(L,this.length-8);const ce=(M<<24)+this[++L]*2**16+this[++L]*2**8+this[++L];return(BigInt(ce)<<BigInt(32))+BigInt(this[++L]*2**24+this[++L]*2**16+this[++L]*2**8+ee)}),l.prototype.readFloatLE=function(L,M){return L=L>>>0,M||O(L,4,this.length),n.read(this,L,!0,23,4)},l.prototype.readFloatBE=function(L,M){return L=L>>>0,M||O(L,4,this.length),n.read(this,L,!1,23,4)},l.prototype.readDoubleLE=function(L,M){return L=L>>>0,M||O(L,8,this.length),n.read(this,L,!0,52,8)},l.prototype.readDoubleBE=function(L,M){return L=L>>>0,M||O(L,8,this.length),n.read(this,L,!1,52,8)};function U(Q,L,M,ee,ce,Ce){if(!l.isBuffer(Q))throw new TypeError('"buffer" argument must be a Buffer instance');if(L>ce||L<Ce)throw new RangeError('"value" argument is out of bounds');if(M+ee>Q.length)throw new RangeError("Index out of range")}l.prototype.writeUintLE=l.prototype.writeUIntLE=function(L,M,ee,ce){if(L=+L,M=M>>>0,ee=ee>>>0,!ce){const xt=Math.pow(2,8*ee)-1;U(this,L,M,ee,xt,0)}let Ce=1,De=0;for(this[M]=L&255;++De<ee&&(Ce*=256);)this[M+De]=L/Ce&255;return M+ee},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(L,M,ee,ce){if(L=+L,M=M>>>0,ee=ee>>>0,!ce){const xt=Math.pow(2,8*ee)-1;U(this,L,M,ee,xt,0)}let Ce=ee-1,De=1;for(this[M+Ce]=L&255;--Ce>=0&&(De*=256);)this[M+Ce]=L/De&255;return M+ee},l.prototype.writeUint8=l.prototype.writeUInt8=function(L,M,ee){return L=+L,M=M>>>0,ee||U(this,L,M,1,255,0),this[M]=L&255,M+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(L,M,ee){return L=+L,M=M>>>0,ee||U(this,L,M,2,65535,0),this[M]=L&255,this[M+1]=L>>>8,M+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(L,M,ee){return L=+L,M=M>>>0,ee||U(this,L,M,2,65535,0),this[M]=L>>>8,this[M+1]=L&255,M+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(L,M,ee){return L=+L,M=M>>>0,ee||U(this,L,M,4,4294967295,0),this[M+3]=L>>>24,this[M+2]=L>>>16,this[M+1]=L>>>8,this[M]=L&255,M+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(L,M,ee){return L=+L,M=M>>>0,ee||U(this,L,M,4,4294967295,0),this[M]=L>>>24,this[M+1]=L>>>16,this[M+2]=L>>>8,this[M+3]=L&255,M+4};function J(Q,L,M,ee,ce){me(L,ee,ce,Q,M,7);let Ce=Number(L&BigInt(4294967295));Q[M++]=Ce,Ce=Ce>>8,Q[M++]=Ce,Ce=Ce>>8,Q[M++]=Ce,Ce=Ce>>8,Q[M++]=Ce;let De=Number(L>>BigInt(32)&BigInt(4294967295));return Q[M++]=De,De=De>>8,Q[M++]=De,De=De>>8,Q[M++]=De,De=De>>8,Q[M++]=De,M}function se(Q,L,M,ee,ce){me(L,ee,ce,Q,M,7);let Ce=Number(L&BigInt(4294967295));Q[M+7]=Ce,Ce=Ce>>8,Q[M+6]=Ce,Ce=Ce>>8,Q[M+5]=Ce,Ce=Ce>>8,Q[M+4]=Ce;let De=Number(L>>BigInt(32)&BigInt(4294967295));return Q[M+3]=De,De=De>>8,Q[M+2]=De,De=De>>8,Q[M+1]=De,De=De>>8,Q[M]=De,M+8}l.prototype.writeBigUInt64LE=ht(function(L,M=0){return J(this,L,M,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeBigUInt64BE=ht(function(L,M=0){return se(this,L,M,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeIntLE=function(L,M,ee,ce){if(L=+L,M=M>>>0,!ce){const Ie=Math.pow(2,8*ee-1);U(this,L,M,ee,Ie-1,-Ie)}let Ce=0,De=1,xt=0;for(this[M]=L&255;++Ce<ee&&(De*=256);)L<0&&xt===0&&this[M+Ce-1]!==0&&(xt=1),this[M+Ce]=(L/De>>0)-xt&255;return M+ee},l.prototype.writeIntBE=function(L,M,ee,ce){if(L=+L,M=M>>>0,!ce){const Ie=Math.pow(2,8*ee-1);U(this,L,M,ee,Ie-1,-Ie)}let Ce=ee-1,De=1,xt=0;for(this[M+Ce]=L&255;--Ce>=0&&(De*=256);)L<0&&xt===0&&this[M+Ce+1]!==0&&(xt=1),this[M+Ce]=(L/De>>0)-xt&255;return M+ee},l.prototype.writeInt8=function(L,M,ee){return L=+L,M=M>>>0,ee||U(this,L,M,1,127,-128),L<0&&(L=255+L+1),this[M]=L&255,M+1},l.prototype.writeInt16LE=function(L,M,ee){return L=+L,M=M>>>0,ee||U(this,L,M,2,32767,-32768),this[M]=L&255,this[M+1]=L>>>8,M+2},l.prototype.writeInt16BE=function(L,M,ee){return L=+L,M=M>>>0,ee||U(this,L,M,2,32767,-32768),this[M]=L>>>8,this[M+1]=L&255,M+2},l.prototype.writeInt32LE=function(L,M,ee){return L=+L,M=M>>>0,ee||U(this,L,M,4,2147483647,-2147483648),this[M]=L&255,this[M+1]=L>>>8,this[M+2]=L>>>16,this[M+3]=L>>>24,M+4},l.prototype.writeInt32BE=function(L,M,ee){return L=+L,M=M>>>0,ee||U(this,L,M,4,2147483647,-2147483648),L<0&&(L=4294967295+L+1),this[M]=L>>>24,this[M+1]=L>>>16,this[M+2]=L>>>8,this[M+3]=L&255,M+4},l.prototype.writeBigInt64LE=ht(function(L,M=0){return J(this,L,M,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),l.prototype.writeBigInt64BE=ht(function(L,M=0){return se(this,L,M,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function ae(Q,L,M,ee,ce,Ce){if(M+ee>Q.length)throw new RangeError("Index out of range");if(M<0)throw new RangeError("Index out of range")}function fe(Q,L,M,ee,ce){return L=+L,M=M>>>0,ce||ae(Q,L,M,4),n.write(Q,L,M,ee,23,4),M+4}l.prototype.writeFloatLE=function(L,M,ee){return fe(this,L,M,!0,ee)},l.prototype.writeFloatBE=function(L,M,ee){return fe(this,L,M,!1,ee)};function ye(Q,L,M,ee,ce){return L=+L,M=M>>>0,ce||ae(Q,L,M,8),n.write(Q,L,M,ee,52,8),M+8}l.prototype.writeDoubleLE=function(L,M,ee){return ye(this,L,M,!0,ee)},l.prototype.writeDoubleBE=function(L,M,ee){return ye(this,L,M,!1,ee)},l.prototype.copy=function(L,M,ee,ce){if(!l.isBuffer(L))throw new TypeError("argument should be a Buffer");if(ee||(ee=0),!ce&&ce!==0&&(ce=this.length),M>=L.length&&(M=L.length),M||(M=0),ce>0&&ce<ee&&(ce=ee),ce===ee||L.length===0||this.length===0)return 0;if(M<0)throw new RangeError("targetStart out of bounds");if(ee<0||ee>=this.length)throw new RangeError("Index out of range");if(ce<0)throw new RangeError("sourceEnd out of bounds");ce>this.length&&(ce=this.length),L.length-M<ce-ee&&(ce=L.length-M+ee);const Ce=ce-ee;return this===L&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(M,ee,ce):Uint8Array.prototype.set.call(L,this.subarray(ee,ce),M),Ce},l.prototype.fill=function(L,M,ee,ce){if(typeof L=="string"){if(typeof M=="string"?(ce=M,M=0,ee=this.length):typeof ee=="string"&&(ce=ee,ee=this.length),ce!==void 0&&typeof ce!="string")throw new TypeError("encoding must be a string");if(typeof ce=="string"&&!l.isEncoding(ce))throw new TypeError("Unknown encoding: "+ce);if(L.length===1){const De=L.charCodeAt(0);(ce==="utf8"&&De<128||ce==="latin1")&&(L=De)}}else typeof L=="number"?L=L&255:typeof L=="boolean"&&(L=Number(L));if(M<0||this.length<M||this.length<ee)throw new RangeError("Out of range index");if(ee<=M)return this;M=M>>>0,ee=ee===void 0?this.length:ee>>>0,L||(L=0);let Ce;if(typeof L=="number")for(Ce=M;Ce<ee;++Ce)this[Ce]=L;else{const De=l.isBuffer(L)?L:l.from(L,ce),xt=De.length;if(xt===0)throw new TypeError('The value "'+L+'" is invalid for argument "value"');for(Ce=0;Ce<ee-M;++Ce)this[Ce+M]=De[Ce%xt]}return this};const Te={};function oe(Q,L,M){Te[Q]=class extends M{constructor(){super(),Object.defineProperty(this,"message",{value:L.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${Q}]`,this.stack,delete this.name}get code(){return Q}set code(ce){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:ce,writable:!0})}toString(){return`${this.name} [${Q}]: ${this.message}`}}}oe("ERR_BUFFER_OUT_OF_BOUNDS",function(Q){return Q?`${Q} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),oe("ERR_INVALID_ARG_TYPE",function(Q,L){return`The "${Q}" argument must be of type number. Received type ${typeof L}`},TypeError),oe("ERR_OUT_OF_RANGE",function(Q,L,M){let ee=`The value of "${Q}" is out of range.`,ce=M;return Number.isInteger(M)&&Math.abs(M)>2**32?ce=Se(String(M)):typeof M=="bigint"&&(ce=String(M),(M>BigInt(2)**BigInt(32)||M<-(BigInt(2)**BigInt(32)))&&(ce=Se(ce)),ce+="n"),ee+=` It must be ${L}. Received ${ce}`,ee},RangeError);function Se(Q){let L="",M=Q.length;const ee=Q[0]==="-"?1:0;for(;M>=ee+4;M-=3)L=`_${Q.slice(M-3,M)}${L}`;return`${Q.slice(0,M)}${L}`}function ke(Q,L,M){re(L,"offset"),(Q[L]===void 0||Q[L+M]===void 0)&&je(L,Q.length-(M+1))}function me(Q,L,M,ee,ce,Ce){if(Q>M||Q<L){const De=typeof L=="bigint"?"n":"";let xt;throw L===0||L===BigInt(0)?xt=`>= 0${De} and < 2${De} ** ${(Ce+1)*8}${De}`:xt=`>= -(2${De} ** ${(Ce+1)*8-1}${De}) and < 2 ** ${(Ce+1)*8-1}${De}`,new Te.ERR_OUT_OF_RANGE("value",xt,Q)}ke(ee,ce,Ce)}function re(Q,L){if(typeof Q!="number")throw new Te.ERR_INVALID_ARG_TYPE(L,"number",Q)}function je(Q,L,M){throw Math.floor(Q)!==Q?(re(Q,M),new Te.ERR_OUT_OF_RANGE("offset","an integer",Q)):L<0?new Te.ERR_BUFFER_OUT_OF_BOUNDS:new Te.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${L}`,Q)}const ie=/[^+/0-9A-Za-z-_]/g;function Re(Q){if(Q=Q.split("=")[0],Q=Q.trim().replace(ie,""),Q.length<2)return"";for(;Q.length%4!==0;)Q=Q+"=";return Q}function Ve(Q,L){L=L||1/0;let M;const ee=Q.length;let ce=null;const Ce=[];for(let De=0;De<ee;++De){if(M=Q.charCodeAt(De),M>55295&&M<57344){if(!ce){if(M>56319){(L-=3)>-1&&Ce.push(239,191,189);continue}else if(De+1===ee){(L-=3)>-1&&Ce.push(239,191,189);continue}ce=M;continue}if(M<56320){(L-=3)>-1&&Ce.push(239,191,189),ce=M;continue}M=(ce-55296<<10|M-56320)+65536}else ce&&(L-=3)>-1&&Ce.push(239,191,189);if(ce=null,M<128){if((L-=1)<0)break;Ce.push(M)}else if(M<2048){if((L-=2)<0)break;Ce.push(M>>6|192,M&63|128)}else if(M<65536){if((L-=3)<0)break;Ce.push(M>>12|224,M>>6&63|128,M&63|128)}else if(M<1114112){if((L-=4)<0)break;Ce.push(M>>18|240,M>>12&63|128,M>>6&63|128,M&63|128)}else throw new Error("Invalid code point")}return Ce}function Ze(Q){const L=[];for(let M=0;M<Q.length;++M)L.push(Q.charCodeAt(M)&255);return L}function bt(Q,L){let M,ee,ce;const Ce=[];for(let De=0;De<Q.length&&!((L-=2)<0);++De)M=Q.charCodeAt(De),ee=M>>8,ce=M%256,Ce.push(ce),Ce.push(ee);return Ce}function tt(Q){return e.toByteArray(Re(Q))}function St(Q,L,M,ee){let ce;for(ce=0;ce<ee&&!(ce+M>=L.length||ce>=Q.length);++ce)L[ce+M]=Q[ce];return ce}function mt(Q,L){return Q instanceof L||Q!=null&&Q.constructor!=null&&Q.constructor.name!=null&&Q.constructor.name===L.name}function jt(Q){return Q!==Q}const Oe=(function(){const Q="0123456789abcdef",L=new Array(256);for(let M=0;M<16;++M){const ee=M*16;for(let ce=0;ce<16;++ce)L[ee+ce]=Q[M]+Q[ce]}return L})();function ht(Q){return typeof BigInt>"u"?ut:Q}function ut(){throw new Error("BigInt not supported")}})(z3)),z3}var Nqe=wqe(),Sqe={0:"Drawing",1:"Hentai",2:"Neutral",3:"Porn",4:"Sexy"},zc=function(t,e,n,s){function r(a){return a instanceof n?a:new n(function(i){i(a)})}return new(n||(n=Promise))(function(a,i){function l(h){try{u(s.next(h))}catch(f){i(f)}}function c(h){try{u(s.throw(h))}catch(f){i(f)}}function u(h){h.done?a(h.value):r(h.value).then(l,c)}u((s=s.apply(t,e||[])).next())})},Bc=function(t,e){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},s,r,a,i=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),typeof Symbol=="function"&&(i[Symbol.iterator]=function(){return this}),i;function l(u){return function(h){return c([u,h])}}function c(u){if(s)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(n=0)),n;)try{if(s=1,r&&(a=u[0]&2?r.return:u[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,u[1])).done)return a;switch(r=0,a&&(u=[u[0]&2,a.value]),u[0]){case 0:case 1:a=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,r=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(a=n.trys,!(a=a.length>0&&a[a.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!a||u[1]>a[0]&&u[1]<a[3])){n.label=u[1];break}if(u[0]===6&&n.label<a[1]){n.label=a[1],a=u;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(u);break}a[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(h){u=[6,h],r=0}finally{s=a=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}},jqe=function(t,e,n){if(n||arguments.length===2)for(var s=0,r=e.length,a;s<r;s++)(a||!(s in e))&&(a||(a=Array.prototype.slice.call(e,0,s)),a[s]=e[s]);return t.concat(a||Array.prototype.slice.call(e))},YR={MobileNetV2:{numOfWeightBundles:1},MobileNetV2Mid:{numOfWeightBundles:2,options:{type:"graph"}},InceptionV3:{numOfWeightBundles:6,options:{size:299}}},kqe="MobileNetV2",QB=224,WZ=function(){if(typeof globalThis<"u")return globalThis;if(typeof global<"u")return global;if(typeof window<"u")return window;if(typeof self<"u")return self;throw new Error("Unable to locate global object")};function HZ(t){return!!t&&t in YR}var Cqe=function(t){return zc(void 0,void 0,void 0,function(){var e,n;return Bc(this,function(s){switch(s.label){case 0:return e=WZ().model,e?[2,e]:t!=="MobileNetV2"?[3,2]:[4,Xm(()=>import("./mobilenet_v2-CcMzI-xa.js"),[])];case 1:return n=s.sent().modelJson,[3,6];case 2:return t!=="MobileNetV2Mid"?[3,4]:[4,Xm(()=>import("./mobilenet_v2_mid-dPGqnrFs.js"),[])];case 3:return n=s.sent().modelJson,[3,6];case 4:return t!=="InceptionV3"?[3,6]:[4,Xm(()=>import("./inception_v3-LHnJfg5B.js"),[])];case 5:n=s.sent().modelJson,s.label=6;case 6:return[4,n()];case 7:return[2,s.sent().default]}})})},Tqe=function(t){return zc(void 0,void 0,void 0,function(){var e,n,s,r,a,i,l,c,u,h;return Bc(this,function(f){switch(f.label){case 0:e=YR[t].numOfWeightBundles,n=[],s=0,f.label=1;case 1:return s<e?(r="group1-shard".concat(s+1,"of").concat(e),a=r.replace(/-/g,"_"),i=WZ()[a],i?(n.push((u={},u[r]=i,u)),[3,10]):[3,2]):[3,11];case 2:return l=void 0,t!=="MobileNetV2"?[3,4]:[4,Xm(()=>import("./mobilenet_v2-CcMzI-xa.js"),[])];case 3:return l=f.sent().weightBundles,[3,8];case 4:return t!=="MobileNetV2Mid"?[3,6]:[4,Xm(()=>import("./mobilenet_v2_mid-dPGqnrFs.js"),[])];case 5:return l=f.sent().weightBundles,[3,8];case 6:return t!=="InceptionV3"?[3,8]:[4,Xm(()=>import("./inception_v3-LHnJfg5B.js"),[])];case 7:l=f.sent().weightBundles,f.label=8;case 8:return[4,l[s]()];case 9:c=f.sent().default,n.push((h={},h[r]=c,h)),f.label=10;case 10:return s++,[3,1];case 11:return[2,Object.assign.apply(Object,jqe([{}],n,!1))]}})})};function _qe(t){return zc(this,void 0,void 0,function(){var e;return Bc(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Tqe(t)];case 1:return e=n.sent(),[2,e];case 2:throw n.sent(),new Error("Could not load the weight data. Make sure you are importing the correct shard files from the models directory. Ref: https://github.com/infinitered/nsfwjs?tab=readme-ov-file#browserify");case 3:return[2]}})})}function Eqe(t){return zc(this,void 0,void 0,function(){var e,n,s;return Bc(this,function(r){switch(r.label){case 0:if(!HZ(t))return[2,t];r.label=1;case 1:return r.trys.push([1,4,,5]),[4,Cqe(t)];case 2:return e=r.sent(),[4,_qe(t)];case 3:return n=r.sent(),s=new $qe(e,n),[2,s];case 4:throw r.sent(),new Error("Could not load the model. Make sure you are importing the model.min.js bundle. Ref: https://github.com/infinitered/nsfwjs?tab=readme-ov-file#browserify");case 5:return[2]}})})}function Aqe(t){return zc(this,arguments,void 0,function(e,n){var s,r,a;return n===void 0&&(n={size:QB}),Bc(this,function(i){switch(i.label){case 0:if(yqe==null)throw new Error("Cannot find TensorFlow.js. If you are using a <script> tag, please also include @tensorflow/tfjs on the page before using this model.");return e===void 0?(e=kqe,console.info("%cBy not specifying 'modelOrUrl' parameter, you're using the default model: '".concat(e,"'. See NSFWJS docs for instructions on hosting your own model (https://github.com/infinitered/nsfwjs?tab=readme-ov-file#host-your-own-model)."),"color: lightblue")):HZ(e)&&(console.info("%cYou're using the model: '".concat(e,"'. See NSFWJS docs for instructions on hosting your own model (https://github.com/infinitered/nsfwjs?tab=readme-ov-file#host-your-own-model)."),"color: lightblue"),n=(a=YR[e].options)!==null&&a!==void 0?a:n),n.size=(n==null?void 0:n.size)||QB,[4,Eqe(e)];case 1:return s=i.sent(),r=new Iqe(s,n),[4,r.load()];case 2:return i.sent(),[2,r]}})})}var $qe=(function(){function t(e,n){this.modelJson=e,this.weightDataBase64=n}return t.prototype.arrayBufferFromBase64=function(e){for(var n=Nqe.Buffer.from(e,"base64").toString("binary"),s=n.length,r=new Uint8Array(s),a=0;a<s;a++)r[a]=n.charCodeAt(a);return r.buffer},t.prototype.load=function(){return zc(this,void 0,void 0,function(){var e,n,s,r,a,i,l,c,u,h,f,p,x,y;return Bc(this,function(v){if(e={modelTopology:this.modelJson.modelTopology,format:this.modelJson.format,generatedBy:this.modelJson.generatedBy,convertedBy:this.modelJson.convertedBy},this.modelJson.weightsManifest!=null){for(n=[],s=[],r=0,a=this.modelJson.weightsManifest;r<a.length;r++){for(i=a[r],l=0,c=i.paths;l<c.length;l++){if(u=c[l],h=this.weightDataBase64[u],!h)throw new Error("Could not find the weight data. Make sure you are importing the correct weight bundle for the model: ".concat(u,".min.js."));f=this.arrayBufferFromBase64(h),s.push(new Uint8Array(f))}n.push.apply(n,i.weights)}for(e.weightSpecs=n,p=new Uint8Array(s.reduce(function(b,N){return b+N.length},0)),x=0,y=0;y<s.length;y++)p.set(s[y],x),x+=s[y].byteLength;e.weightData=p.buffer}return this.modelJson.trainingConfig!=null&&(e.trainingConfig=this.modelJson.trainingConfig),this.modelJson.userDefinedMetadata!=null&&(e.userDefinedMetadata=this.modelJson.userDefinedMetadata),[2,e]})})},t})(),Iqe=(function(){function t(e,n){this.intermediateModels={},this.options=n,this.normalizationOffset=Bt(255),this.urlOrIOHandler=e,typeof e=="string"&&!e.startsWith("indexeddb://")&&!e.startsWith("localstorage://")&&!e.endsWith("model.json")?this.urlOrIOHandler="".concat(e,"model.json"):this.urlOrIOHandler=e}return t.prototype.load=function(){return zc(this,void 0,void 0,function(){var e,n,s,r,a,i,l=this;return Bc(this,function(c){switch(c.label){case 0:return e=this.options,n=e.size,s=e.type,s!=="graph"?[3,2]:(r=this,[4,zX(this.urlOrIOHandler)]);case 1:return r.model=c.sent(),[3,4];case 2:return a=this,[4,ZK(this.urlOrIOHandler)];case 3:a.model=c.sent(),this.endpoints=this.model.layers.map(function(u){return u.name}),c.label=4;case 4:return i=Ee(function(){return l.model.predict(Us([1,n,n,3]))}),[4,i.data()];case 5:return c.sent(),i.dispose(),[2]}})})},t.prototype.infer=function(e,n){var s=this;if(n!=null&&this.endpoints.indexOf(n)===-1)throw new Error("Unknown endpoint ".concat(n,". Available endpoints: ").concat(this.endpoints,"."));return Ee(function(){e instanceof Tn||(e=bI(e));var r=e.toFloat().div(s.normalizationOffset),a=r,i=s.options.size;if(e.shape[0]!==i||e.shape[1]!==i){var l=!0;a=Vi.resizeBilinear(r,[i,i],l)}var c=a.reshape([1,i,i,3]),u;if(n==null)u=s.model;else{if(s.model.hasOwnProperty("layers")&&s.intermediateModels[n]==null){var h=s.model.layers.find(function(f){return f.name===n});s.intermediateModels[n]=JK({inputs:s.model.inputs,outputs:h.output})}u=s.intermediateModels[n]}return u.predict(c)})},t.prototype.classify=function(e){return zc(this,arguments,void 0,function(n,s){var r,a;return s===void 0&&(s=5),Bc(this,function(i){switch(i.label){case 0:return r=this.infer(n),[4,Rqe(r,s)];case 1:return a=i.sent(),r.dispose(),[2,a]}})})},t})();function Rqe(t,e){return zc(this,void 0,void 0,function(){var n,s,l,r,a,l,i,l;return Bc(this,function(c){switch(c.label){case 0:return[4,t.data()];case 1:for(n=c.sent(),s=[],l=0;l<n.length;l++)s.push({value:n[l],index:l});for(s.sort(function(u,h){return h.value-u.value}),r=new Float32Array(e),a=new Int32Array(e),l=0;l<e;l++)r[l]=s[l].value,a[l]=s[l].index;for(i=[],l=0;l<a.length;l++)i.push({className:Sqe[a[l]],probability:r[l]});return[2,i]}})})}const Oqe=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],GZ=({isOpen:t,onClose:e,hideEmailVerification:n=!1,hideFullName:s=!1,hideCourse:r=!1,hideYearLevel:a=!1,prefilledEmail:i="",prefilledFullName:l="",prefilledCourseId:c="",prefilledYearLevel:u="",prefilledUniversityId:h=""})=>{const{notify:f}=Mh(),[p,x]=j.useState(new Set),[y,v]=j.useState(!1),[b,N]=j.useState({show:!1,message:"",type:"warning"}),[S,k]=j.useState(i),[T,E]=j.useState(l),[D,A]=j.useState(""),[I,P]=j.useState([]),[$,R]=j.useState(h||""),[F,W]=j.useState(null),[q,X]=j.useState([]),[z,K]=j.useState(c?String(c):""),[H,Y]=j.useState(""),[B,O]=j.useState(""),[U,J]=j.useState([]),[se,ae]=j.useState(""),[fe,ye]=j.useState({}),[Te,oe]=j.useState([]),[Se,ke]=j.useState(null),[me,re]=j.useState(null),[je,ie]=j.useState(!1),[Re,Ve]=j.useState(""),[Ze,bt]=j.useState(u),[tt,St]=j.useState(""),[mt,jt]=j.useState(!1),[Oe,ht]=j.useState(!1),[ut,Q]=j.useState(!1),[L,M]=j.useState(0),[ee,ce]=j.useState(""),[Ce,De]=j.useState(!1),xt=j.useMemo(()=>{if(!ee)return null;const le=Number(ee);return isNaN(le)?null:le<100||le>800?"Session rate must be between 100 and 800 per hour.":null},[ee]),[Ie,lt]=j.useState(n),[Nt,kt]=j.useState(""),[In,vs]=j.useState(!1),[ns,qn]=j.useState(!1),[Ds,Ks]=j.useState(!1),[ro,Xa]=j.useState(""),[Aa,vr]=j.useState(!1),[na,Pr]=j.useState(null),[Fo,Kl]=j.useState(null),[Ya,Si]=j.useState(!1),[Qa,ji]=j.useState({}),[zo,wr]=j.useState({show:!1,message:"",onConfirm:()=>{}}),[us,Ps]=j.useState(""),$a=j.useMemo(()=>Object.keys(Qa),[Qa]),Lr=j.useMemo(()=>Oqe.filter(le=>!$a.includes(le)),[$a]),ao=le=>{le&&(ji(_e=>({..._e,[le]:{slots:[{startTime:"09:00",endTime:"17:00"}]}})),Ps(""))},ue=le=>{wr({show:!0,message:`Remove ${le} and all its time slots?`,onConfirm:()=>{ji(_e=>{const Pe={..._e};return delete Pe[le],Pe})}})},[He,ot]=j.useState({}),st=le=>{if(!le)return le;const _e=le.trim(),[Pe]=_e.split("."),Je=_e.split(":").map(At=>At.replace(/\D/g,"")),pt=Je[0]?String(Number(Je[0])).padStart(2,"0"):"00",Ct=Je[1]?String(Math.min(59,Number(Je[1]))).padStart(2,"0"):"00";return`${pt}:${Ct}`},_t=le=>{const _e=st(le),[Pe,Je]=_e.split(":").map(Number);return Pe*60+(Je||0)},Qt=le=>{const _e=Math.floor(le/60).toString().padStart(2,"0"),Pe=(le%60).toString().padStart(2,"0");return`${_e}:${Pe}`},ds=(le,_e,Pe,Je)=>{const pt=_t(le),Ct=_t(_e),At=_t(Pe),dn=_t(Je);return pt<dn&&At<Ct},Nr=(le,_e=60,Pe=420,Je=1320,pt=15)=>{const Ct=le.map(At=>({startTime:st(At.startTime),endTime:st(At.endTime)})).sort((At,dn)=>_t(At.startTime)-_t(dn.startTime));for(let At=0;At<=Ct.length;At++){let dn,gn;if(At===0?(dn=Pe,gn=Ct.length>0?_t(Ct[0].startTime):Je):At===Ct.length?(dn=_t(Ct[Ct.length-1].endTime),gn=Je):(dn=_t(Ct[At-1].endTime),gn=_t(Ct[At].startTime)),gn-dn>=_e){const jn=dn,yn=jn+_e;if(yn<=gn){const Wn={startTime:Qt(jn),endTime:Qt(yn)};if(!Ct.some(An=>ds(An.startTime,An.endTime,Wn.startTime,Wn.endTime)))return Wn}}}for(let At=Pe;At+_e<=Je;At+=pt){const dn=At+_e,gn={startTime:Qt(At),endTime:Qt(dn)};if(!Ct.some(yn=>ds(yn.startTime,yn.endTime,gn.startTime,gn.endTime)))return gn}return null},Xt=(le,_e=60)=>{le&&ji(Pe=>{const Je={...Pe},pt=Je[le]?{slots:[...Je[le].slots]}:{slots:[]};pt.slots=pt.slots.map(At=>({startTime:st(At.startTime),endTime:st(At.endTime)}));const Ct=Nr(pt.slots,_e);return Ct?(pt.slots.push(Ct),pt.slots.sort((At,dn)=>_t(At.startTime)-_t(dn.startTime)),Je[le]=pt,Je):(f("No available non-overlapping slot could be found for that day.","error"),Pe)})},Vn=(le,_e,Pe,Je)=>{const pt=st(Je);ji(Ct=>{const At={...Ct},dn=At[le];if(!dn)return Ct;const gn=dn.slots.map(An=>({startTime:st(An.startTime),endTime:st(An.endTime)}));if(_e<0||_e>=gn.length)return Ct;const jn={...gn[_e],[Pe]:pt},yn=[...gn];yn[_e]=jn;const Wn=_t(jn.startTime),ws=_t(jn.endTime);if(isNaN(Wn)||isNaN(ws))return yn.sort((An,Fs)=>_t(An.startTime)-_t(Fs.startTime)),At[le]={slots:yn},At;if(ws<=Wn){const An=jn.startTime&&jn.startTime.match(/^\d{2}:\d{2}$/),Fs=jn.endTime&&jn.endTime.match(/^\d{2}:\d{2}$/);return An&&Fs&&f("End time must be after start time","error"),Ct}for(let An=0;An<yn.length;An++){if(An===_e)continue;const Fs=yn[An],ss=_t(Fs.startTime),Xs=_t(Fs.endTime);if(!(isNaN(ss)||isNaN(Xs))&&Wn<Xs&&ss<ws)return f("This time overlaps with another slot. Please choose a different time.","error"),Ct}return yn.sort((An,Fs)=>_t(An.startTime)-_t(Fs.startTime)),At[le]={slots:yn},At})},ki=(le,_e)=>{wr({show:!0,message:"Remove this time slot?",onConfirm:()=>{ji(Pe=>{const Je={...Pe},pt=Je[le];return pt?(pt.slots=pt.slots.filter((Ct,At)=>At!==_e),pt.slots.length===0?delete Je[le]:Je[le]=pt,Je):Pe})}})},[xe,Ke]=j.useState(!1),Ge=j.useRef(null),rt=async()=>{if(Fo)return!0;if(Ge.current)try{return!!await Ge.current}catch{return!1}try{Ke(!0),console.log("Loading NSFWJS model...");const le=Aqe();Ge.current=le;const _e=await le;return Kl(_e),Ge.current=null,Ke(!1),console.log("NSFWJS model loaded successfully"),!0}catch(le){return console.error("Failed to load NSFWJS model:",le),Ge.current=null,Ke(!1),f("Failed to load image analysis model. Please try again.","error"),!1}};j.useEffect(()=>{if(y){const le=setTimeout(()=>{v(!1)},2e3);return()=>clearTimeout(le)}},[y]),j.useEffect(()=>{(async()=>{var le;try{if(!$){J([]),x(new Set),ye({});return}if(!z){J([]),x(new Set),ye({});return}const _e={university_id:$,course_id:Number(z)},Pe=await we.get("/subjects",{params:_e});J(Pe.data||[]),console.log(`Fetched ${((le=Pe.data)==null?void 0:le.length)||0} subjects for course_id: ${z}`)}catch(_e){console.error("Error fetching subjects:",_e),J([])}})()},[$,z]);const ct=j.useMemo(()=>new Set(Array.from(p).map(le=>le.toLowerCase())),[p]),Ye=j.useMemo(()=>{const le=se.trim().toLowerCase();return le?U.some(_e=>_e.subject_name.toLowerCase()===le):!1},[se,U]);j.useEffect(()=>{(async()=>{try{const _e=((await we.get("/universities")).data||[]).filter(pt=>pt.status==="active");P(_e);const Pe=await we.get("/courses"),Je=(Array.isArray(Pe.data)?Pe.data:[]).map(pt=>{var Ct;return{...pt,university_id:(pt==null?void 0:pt.university_id)??((Ct=pt==null?void 0:pt.university)==null?void 0:Ct.university_id)??(pt==null?void 0:pt.universityId)??null}});X(Je)}catch{}})()},[]),j.useEffect(()=>{if(n){lt(!0),W(null);return}if(!S||!$){W(null),lt(!1),vr(!1),Pr(null);return}const le=I.find(Pe=>Pe.university_id===$);if(!le){W(null),lt(!1),vr(!1),Pr(null);return}const _e=S.split("@")[1]||"";!_e||_e.toLowerCase()!==le.email_domain.toLowerCase()?(W(`Email domain must be ${le.email_domain}`),lt(!1),vr(!1),Pr(null)):(W(null),rm(S),ru(S))},[S,$,I,n]);const yt=j.useMemo(()=>na?Date.now()>na:!0,[na]);j.useEffect(()=>{if(!na)return;const le=setInterval(()=>{Date.now()>na&&(vr(!1),Pr(null))},1e3);return()=>clearInterval(le)},[na]);const dt=j.useMemo(()=>q.filter(le=>{var Pe;const _e=(le==null?void 0:le.university_id)??((Pe=le==null?void 0:le.university)==null?void 0:Pe.university_id)??(le==null?void 0:le.universityId);return!$||_e===$}),[q,$]);j.useEffect(()=>{!z||!$||dt.length>0&&(dt.some(_e=>String(_e.course_id)===z)||K(""))},[dt,z,$]),j.useEffect(()=>{$||K("")},[$]);const Dt=()=>{B&&!p.has(B)&&(x(le=>new Set(le).add(B)),ye(le=>({...le,[B]:le[B]||[]})),O(""))},Et=()=>{const le=se.trim();le&&!p.has(le)&&(x(_e=>new Set(_e).add(le)),ye(_e=>({..._e,[le]:_e[le]||[]})),ae(""))},Pt=le=>{x(_e=>{const Pe=new Set(_e);return Pe.delete(le),Pe}),ye(_e=>{const Pe={..._e};return delete Pe[le],Pe})};j.useEffect(()=>{if(!U||U.length===0){!$&&p.size>0&&(x(new Set),ye({}));return}const le=new Set(U.map(_e=>_e.subject_name));x(_e=>{const Pe=new Set;return _e.forEach(Je=>{le.has(Je)&&Pe.add(Je)}),Pe}),ye(_e=>{const Pe={..._e},Je=new Set(U.map(pt=>pt.subject_name));return Object.keys(Pe).forEach(pt=>{Je.has(pt)||delete Pe[pt]}),Pe})},[U,$,z]);const Wt=async le=>{if(le.preventDefault(),le.stopPropagation(),v(!0),le.target.files){const _e=Array.from(le.target.files),Pe=[];for(const Je of _e)Je.type.startsWith("image/")?await o0(Je)&&Pe.push(Je):Pe.push(Je);Pe.length>0&&(oe(Je=>[...Je,...Pe]),f(`${Pe.length} file(s) uploaded successfully!`,"success")),setTimeout(()=>{le.currentTarget&&(le.currentTarget.value=""),setTimeout(()=>v(!1),300)},0)}else setTimeout(()=>v(!1),300)},un=le=>{le.preventDefault(),le.stopPropagation()},Pn=le=>{le.preventDefault(),le.stopPropagation()},Ls=le=>{le.preventDefault(),le.stopPropagation()},Kn=async le=>{le.preventDefault(),le.stopPropagation();const Pe=Array.from(le.dataTransfer.files).filter(Je=>{var dn;const pt=["application/pdf","image/png","image/jpeg","image/jpg"],Ct=[".pdf",".png",".jpg",".jpeg"],At="."+((dn=Je.name.split(".").pop())==null?void 0:dn.toLowerCase());return pt.includes(Je.type)||Ct.includes(At)});if(Pe.length>0){const Je=[];for(const pt of Pe)pt.type.startsWith("image/")?await o0(pt)&&Je.push(pt):Je.push(pt);Je.length>0&&(oe(pt=>[...pt,...Je]),f(`${Je.length} file(s) uploaded successfully!`,"success"))}},Ln=async le=>{const _e=le.target.files&&le.target.files[0];if(_e)if(_e.type.startsWith("image/")){if(!await o0(_e)){le.target.value="";return}if(await pa(_e)){f("Profile images cannot be QR codes. Please upload a regular photo of yourself.","error"),le.target.value="";return}ke(_e),f("Profile image uploaded successfully!","success")}else f("Please select a valid image file.","error"),le.target.value=""},pa=async le=>new Promise(_e=>{const Pe=new Image;Pe.onload=()=>{try{const Je=document.createElement("canvas"),pt=Je.getContext("2d");if(!pt){_e(!1);return}Je.width=Pe.width,Je.height=Pe.height,pt.drawImage(Pe,0,0);const At=pt.getImageData(0,0,Je.width,Je.height).data;let dn=0,gn=0,jn=At.length/4;for(let ar=0;ar<At.length;ar+=4){const lo=At[ar],co=At[ar+1],Ia=At[ar+2];(lo+co+Ia)/3<128?dn++:gn++}const yn=dn/jn,Wn=gn/jn,ws=Math.abs(Pe.width-Pe.height)/Math.max(Pe.width,Pe.height)<.15,An=yn>.25&&yn<.75&&Wn>.25&&Wn<.75,Fs=Math.abs(yn-Wn)<.5,ss=Pe.width>=100&&Pe.width<=2e3&&Pe.height>=100&&Pe.height<=2e3,Xs=Uo(Je,Pe.width,Pe.height),ra=ws&&An&&Fs&&ss&&Xs;console.log("Profile QR Code validation:",{blackRatio:yn.toFixed(3),whiteRatio:Wn.toFixed(3),isSquare:ws,isBalanced:An,isNotColorful:Fs,isReasonableSize:ss,hasQRPatterns:Xs,isQRCode:ra,dimensions:`${Pe.width}x${Pe.height}`}),_e(ra)}catch(Je){console.error("Error validating QR code for profile:",Je),_e(!1)}},Pe.onerror=()=>{console.error("Failed to load image for profile QR validation"),_e(!1)},Pe.src=URL.createObjectURL(le)}),Bo=async le=>new Promise(_e=>{const Pe=new Image;Pe.onload=()=>{try{const Je=document.createElement("canvas"),pt=Je.getContext("2d");if(!pt){_e(!1);return}Je.width=Pe.width,Je.height=Pe.height,pt.drawImage(Pe,0,0);const At=pt.getImageData(0,0,Je.width,Je.height).data;let dn=0,gn=0,jn=At.length/4;for(let ar=0;ar<At.length;ar+=4){const lo=At[ar],co=At[ar+1],Ia=At[ar+2];(lo+co+Ia)/3<128?dn++:gn++}const yn=dn/jn,Wn=gn/jn,ws=Math.abs(Pe.width-Pe.height)/Math.max(Pe.width,Pe.height)<.25,An=yn>.2&&yn<.8&&Wn>.2&&Wn<.8,Fs=Math.abs(yn-Wn)<.6,ss=Pe.width>=80&&Pe.width<=2500&&Pe.height>=80&&Pe.height<=2500,Xs=Uo(Je,Pe.width,Pe.height),ra=ws&&An&&Fs&&ss||Xs;console.log("GCash QR Code validation:",{blackRatio:yn.toFixed(3),whiteRatio:Wn.toFixed(3),isSquare:ws,isBalanced:An,isNotColorful:Fs,isReasonableSize:ss,hasQRPatterns:Xs,isGCashQRCode:ra,dimensions:`${Pe.width}x${Pe.height}`}),_e(ra)}catch(Je){console.error("Error validating GCash QR code:",Je),_e(!1)}},Pe.onerror=()=>{console.error("Failed to load image for GCash QR validation"),_e(!1)},Pe.src=URL.createObjectURL(le)}),Uo=(le,_e,Pe)=>{try{const Je=le.getContext("2d");if(!Je)return!1;const pt=Math.min(_e,Pe)*.15,Ct=Math.floor(pt),At=Je.getImageData(0,0,Ct,Ct),dn=sa(At),gn=Je.getImageData(_e-Ct,0,Ct,Ct),jn=sa(gn),yn=Je.getImageData(0,Pe-Ct,Ct,Ct),Wn=sa(yn);return[dn,jn,Wn].filter(Boolean).length>=2}catch(Je){return console.error("Error checking QR patterns:",Je),!1}},sa=le=>{const _e=le.data;let Pe=0,Je=0;for(let jn=0;jn<_e.length;jn+=4){const yn=_e[jn],Wn=_e[jn+1],ws=_e[jn+2];(yn+Wn+ws)/3<128?Pe++:Je++}const pt=_e.length/4,Ct=Pe/pt,At=Je/pt,dn=Ct>.3&&Ct<.7&&At>.3&&At<.7,gn=Math.abs(Ct-At)<.4;return dn&&gn},Xl=async le=>{const _e=le.target.files&&le.target.files[0];_e&&(_e.type.startsWith("image/")?await Bo(_e)?(re(_e),N({show:!0,message:"GCash QR code uploaded successfully!",type:"success"})):(N({show:!0,message:"Please upload a valid GCash QR code image. This doesn't appear to be a GCash QR code.",type:"warning"}),le.target.value=""):(f("Please select a valid image file.","error"),le.target.value=""))},rm=async le=>{if(!le||!$){lt(!1);return}try{const _e=await we.get(`/auth/email-verification/status?email=${encodeURIComponent(le)}&user_type=tutor`);_e.data&&_e.data.is_verified===1?(lt(!0),vr(!1),Pr(null)):lt(!1)}catch{lt(!1)}},ru=async le=>{if(!le||!$){vr(!1),Pr(null);return}try{const _e=await we.get(`/auth/email-verification/status?email=${encodeURIComponent(le)}&user_type=tutor`);if(_e.data&&_e.data.verification_expires){const Pe=new Date(_e.data.verification_expires).getTime(),Je=Date.now();if(Pe>Je){Pr(Pe),vr(!0);return}}vr(!1),Pr(null)}catch{vr(!1),Pr(null)}},o0=async le=>{if(!await rt()||!Fo)return console.log("NSFWJS model could not be loaded"),f("Image analysis is temporarily unavailable. Please try again in a moment.","error"),!1;try{Si(!0),console.log("Analyzing image:",le.name);const Pe=new Image,Je=document.createElement("canvas"),pt=Je.getContext("2d");return new Promise(Ct=>{Pe.onload=async()=>{try{Je.width=Pe.width,Je.height=Pe.height,pt==null||pt.drawImage(Pe,0,0);const At=pt==null?void 0:pt.getImageData(0,0,Je.width,Je.height);if(!At){Ct(!1);return}const dn=await Fo.classify(At);console.log("NSFWJS predictions:",dn);const[gn,jn,yn,Wn,ws]=dn,An=.2,Fs=.2,ss=.3,Xs=.6,oo=ws.probability>gn.probability+.2,ra=jn.probability>Xs&&jn.probability>gn.probability,ar=le.name.toLowerCase(),lo=["bikini","swimsuit","underwear","lingerie","nude","naked","sexy","hot","beach","pool","vacation","selfie","mirror","bedroom","bathroom","meme","funny","joke","lol","haha","comedy","humor","laugh","party","drunk","alcohol","beer","wine","club","nightclub","cartoon","anime","character","cosplay","costume","game","gaming","gamer","console","playstation","xbox","food","eating","restaurant","cooking","recipe","pet","dog","cat","animal","cute","adorable","nature","landscape","travel","trip","holiday","sport","fitness","gym","workout","exercise","music","concert","band","singer","artist","movie","film","cinema","actor","actress","social","instagram","facebook","snapchat","tiktok","dank","epic","fail","win","awesome","cool","sick","fire","reaction","face","expression","emotion","feeling","text","caption","quote","saying","phrase","template","blank","empty","space","background","edit","edited","photoshop","filter","effect","trending","viral","popular","famous","celebrity","random","weird","strange","odd","bizarre","wtf","omg","rofl","lmao","lmfao","stfu","yolo","fomo","bae","fam","squad","goals"],co=[/meme\d*\.(jpg|jpeg|png|gif)/i,/funny\d*\.(jpg|jpeg|png|gif)/i,/joke\d*\.(jpg|jpeg|png|gif)/i,/lol\d*\.(jpg|jpeg|png|gif)/i,/dank\d*\.(jpg|jpeg|png|gif)/i,/epic\d*\.(jpg|jpeg|png|gif)/i,/fail\d*\.(jpg|jpeg|png|gif)/i,/win\d*\.(jpg|jpeg|png|gif)/i,/reaction\d*\.(jpg|jpeg|png|gif)/i,/template\d*\.(jpg|jpeg|png|gif)/i],Ia=lo.some(au=>ar.includes(au)),bl=co.some(au=>au.test(ar));Wn.probability>An||yn.probability>Fs||ws.probability>ss||oo||Ia||ra?(console.log("Inappropriate content detected:",{porn:Wn.probability,hentai:yn.probability,sexy:ws.probability,neutral:gn.probability,drawing:jn.probability,isSexySignificantlyHigher:oo,hasInappropriateKeyword:Ia,isDrawingOrMeme:ra,fileName:ar}),N({show:!0,message:"This image contains inappropriate content and cannot be uploaded. Please choose a different image.",type:"warning"}),Ct(!1)):(console.log("Image content is appropriate"),N({show:!0,message:"Nice! Your photo looks clean and good to go!",type:"success"}),Ct(!0))}catch(At){console.error("Error analyzing image:",At),f("Failed to analyze image content. Please try again.","error"),Ct(!1)}finally{Si(!1)}},Pe.onerror=()=>{console.error("Failed to load image for analysis"),f("Failed to load image for analysis. Please try again.","error"),Si(!1),Ct(!1)},Pe.src=URL.createObjectURL(le)})}catch(Pe){return console.error("Error in image analysis:",Pe),Si(!1),f("Failed to analyze image content. Please try again.","error"),!1}},l0=async()=>{var le,_e;if(!S||!$){f("Please enter email and select university first.","error");return}if(F){f(F,"error");return}qn(!0),Xa("");try{console.log("Frontend: Sending verification code to:",S);const Pe=await we.post("/auth/email-verification/send-code",{email:S,user_type:"tutor"});if(console.log("Frontend: Verification code response:",Pe.data),Pe.data){const Je=Date.now()+6e5;Pr(Je),vr(!0),f("Verification code sent to your email!","success")}}catch(Pe){console.log("Frontend: Verification code error:",Pe);const Je=((_e=(le=Pe.response)==null?void 0:le.data)==null?void 0:_e.message)||"Failed to send verification code. Please try again.";Xa(Je),f(Je,"error")}finally{qn(!1)}},Ib=()=>{Aa&&!yt&&(vs(!0),Xa(""))},c0=async()=>{var le,_e;if(!Nt.trim()){Xa("Please enter the verification code");return}Ks(!0),Xa("");try{console.log("Frontend: Verifying code:",Nt);const Pe=await we.post("/auth/email-verification/verify-code",{email:S,code:Nt,user_type:"tutor"});console.log("Frontend: Verification response:",Pe.data),Pe.data&&(lt(!0),vs(!1),kt(""),vr(!1),Pr(null),Xa(""),f("Email verified successfully! You can now submit your application.","success"))}catch(Pe){console.log("Frontend: Verification error:",Pe);const Je=((_e=(le=Pe.response)==null?void 0:le.data)==null?void 0:_e.message)||"Invalid verification code. Please try again.";Xa(Je)}finally{Ks(!1)}},Rb=()=>{vs(!1),kt(""),Xa("")},Ob=()=>{L>=80&&Q(!0),ht(!1)},am=le=>{const _e=le.currentTarget,Pe=_e.scrollTop,Je=_e.scrollHeight,pt=_e.clientHeight,Ct=Pe/(Je-pt)*100;M(Ct),Ct>=80&&Q(!0)},Ci=async le=>{var Pe,Je,pt,Ct,At,dn,gn,jn,yn,Wn,ws,An,Fs,ss,Xs,oo,ra,ar,lo,co,Ia,bl,im,au,Db,Pb,om;if(le.preventDefault(),le.stopPropagation(),y)return;if(!n&&!S){f("Please enter email.","error");return}if(!s&&!T.trim()){f("Please enter full name.","error");return}if(!D||!$){f("Please enter password and select your university.","error");return}if(F){f(F,"error");return}if(!Ie){f("Please verify your email address before submitting the application.","error");return}if(D.length<7||D.length>21){f("Password must be between 7 and 21 characters.","error");return}if(!a&&!Ze){f("Please select your year level.","error");return}if(!tt||tt.length!==11){f("Please enter a valid GCash number (11 digits).","error");return}if(xt){f(xt,"error");return}if(p.size===0||Te.length===0){f("Please select at least one subject and upload at least one document.","error");return}const _e=Array.from(p).filter(hs=>!fe[hs]||fe[hs].length===0);if(_e.length>0){f(`Please upload supporting document(s) for: ${_e.join(", ")}`,"error");return}if(!ut){f('Please read the Terms and Conditions before submitting. Click "Read Terms" to view them.',"error"),ht(!0);return}if(!mt){f("Please accept the Terms and Conditions before submitting.","error");return}try{console.log("Starting tutor application submission..."),console.log("Form data:",{email:S,full_name:T.trim(),university_id:Number($),course_id:z?Number(z):void 0,bio:Re,year_level:Number(Ze),gcash_number:tt,SessionRatePerHour:ee?Number(ee):void 0,selectedSubjects:Array.from(p),uploadedFiles:Te.length,profileImage:!!Se,gcashQRImage:!!me}),console.log("Step 1: Registering new tutor user...");const hs={name:T.trim(),email:S,password:D,user_type:"tutor",university_id:Number($),course_id:z?Number(z):void 0,bio:Re||void 0,year_level:Number(Ze),gcash_number:tt,SessionRatePerHour:ee?Number(ee):void 0};console.log("Registration payload:",hs),console.log("Making POST request to /auth/register...");let Za;try{Za=await we.post("/auth/register",hs),console.log("Registration response:",Za.data)}catch(Vt){if(console.error("Registration API error details:",{message:Vt==null?void 0:Vt.message,response:(Pe=Vt==null?void 0:Vt.response)==null?void 0:Pe.data,status:(Je=Vt==null?void 0:Vt.response)==null?void 0:Je.status,url:(pt=Vt==null?void 0:Vt.config)==null?void 0:pt.url,method:(Ct=Vt==null?void 0:Vt.config)==null?void 0:Ct.method,baseURL:(At=Vt==null?void 0:Vt.config)==null?void 0:At.baseURL,fullUrl:`${(dn=Vt==null?void 0:Vt.config)==null?void 0:dn.baseURL}${(gn=Vt==null?void 0:Vt.config)==null?void 0:gn.url}`}),((jn=Vt==null?void 0:Vt.response)==null?void 0:jn.status)===404){const Ql=((Wn=(yn=Vt==null?void 0:Vt.response)==null?void 0:yn.data)==null?void 0:Wn.message)||(Vt==null?void 0:Vt.message)||"Endpoint not found";f(`Registration failed: ${Ql}. Please ensure the backend server is running on http://localhost:3000`,"error")}throw Vt}const{user:Vo,accessToken:d0}=Za.data;if(d0){localStorage.setItem("token",d0),localStorage.setItem("user",JSON.stringify(Vo)),console.log("Token stored for authenticated requests");const Vt=ci(Vo==null?void 0:Vo.role)??ci(Vo==null?void 0:Vo.user_type);Vt&&Vo&&nw(Vt,Vo,d0)}const h0=((Fs=(An=(ws=Za.data)==null?void 0:ws.user)==null?void 0:An.tutor_profile)==null?void 0:Fs.tutor_id)||((Xs=(ss=Za.data)==null?void 0:ss.tutor_profile)==null?void 0:Xs.tutor_id)||((oo=Za.data)==null?void 0:oo.tutor_id)||((ar=(ra=Za.data)==null?void 0:ra.user)==null?void 0:ar.tutor_id);if(!h0)throw console.error("Registration response structure:",JSON.stringify(Za.data,null,2)),new Error("Could not get tutor ID after registration. Please check the response structure.");console.log("New Tutor User Registered with ID:",h0);const Wo=h0;if(console.log("Step 2: Handling profile image..."),Se){console.log("Uploading profile image...");const Vt=new FormData;Vt.append("file",Se),await we.post(`/tutors/${Wo}/profile-image`,Vt,{headers:{"Content-Type":"multipart/form-data"}}),console.log("Profile image uploaded successfully")}else console.log("Setting placeholder profile image..."),await we.post(`/tutors/${Wo}/profile-image-placeholder`),console.log("Placeholder profile image set");if(console.log("Step 3: Handling GCash QR image..."),me){console.log("Uploading GCash QR image...");const Vt=new FormData;Vt.append("file",me),await we.post(`/tutors/${Wo}/gcash-qr`,Vt,{headers:{"Content-Type":"multipart/form-data"}}),console.log("GCash QR image uploaded successfully")}else console.log("Setting placeholder GCash QR..."),await we.post(`/tutors/${Wo}/gcash-qr-placeholder`),console.log("Placeholder GCash QR set");console.log("Step 4: Uploading documents...");const Lb=new FormData;Te.forEach(Vt=>Lb.append("files",Vt)),await we.post(`/tutors/${Wo}/documents`,Lb,{headers:{"Content-Type":"multipart/form-data"}}),console.log("Documents uploaded successfully"),console.log("Step 5: Saving availability...");const Mb=Object.entries(Qa).flatMap(([Vt,Ql])=>Ql.slots.map(lm=>({day_of_week:Vt,start_time:lm.startTime,end_time:lm.endTime})));console.log("Availability slots:",Mb),await we.post(`/tutors/${Wo}/availability`,{slots:Mb}),console.log("Availability saved successfully"),console.log("Step 6: Saving subjects...");const m0=Array.from(p);console.log("Selected subjects:",m0);const Pj=z?Number(z):null;await we.post(`/tutors/${Wo}/subjects`,{subjects:m0,course_id:Pj||void 0}),console.log("Subjects saved successfully"),console.log("Step 7: Uploading subject supporting documents...");for(const Vt of m0){const Ql=fe[Vt]||[];if(Ql.length===0){console.warn(`No files found for subject: ${Vt}, skipping...`);continue}try{const ir=new FormData;ir.append("subject_name",Vt),Ql.forEach(lm=>ir.append("files",lm)),await we.post(`/tutors/${Wo}/subject-application`,ir,{headers:{"Content-Type":"multipart/form-data"}}),console.log(`Uploaded ${Ql.length} document(s) for subject: ${Vt}`)}catch(ir){console.error(`Failed to upload documents for subject ${Vt}:`,ir),console.error("Error details:",{message:ir==null?void 0:ir.message,response:(lo=ir==null?void 0:ir.response)==null?void 0:lo.data,status:(co=ir==null?void 0:ir.response)==null?void 0:co.status,url:(Ia=ir==null?void 0:ir.config)==null?void 0:Ia.url}),f(`Warning: Failed to upload documents for ${Vt}. Continuing...`,"error")}}console.log("Step 7: Subject supporting documents upload completed"),f("Application submitted successfully!","success"),e&&e();return}catch(hs){console.error("Submission error:",hs),console.error("Error response:",(bl=hs==null?void 0:hs.response)==null?void 0:bl.data),console.error("Error status:",(im=hs==null?void 0:hs.response)==null?void 0:im.status),console.error("Error config:",hs==null?void 0:hs.config);const Za=((Db=(au=hs==null?void 0:hs.response)==null?void 0:au.data)==null?void 0:Db.message)||((om=(Pb=hs==null?void 0:hs.response)==null?void 0:Pb.data)==null?void 0:om.error)||(hs==null?void 0:hs.message)||"Failed to submit application";typeof Za=="string"&&Za.toLowerCase().includes("email already registered")?f("Email already registered","error"):f(`Submission failed: ${Za}`,"error")}},io=typeof t=="boolean",u0=io?!!t:!0,Yl=()=>{if(!y){if(e)return e();try{window.history.back()}catch{}}};return u0?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:io?"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-end sm:items-center justify-center p-3 sm:p-6 animate-[fadeIn_200ms_ease-out]":"min-h-screen flex items-center justify-center lg:py-8 bg-gradient-to-br from-indigo-50/40 to-sky-50/40",role:io?"dialog":void 0,"aria-modal":io?"true":void 0,onClick:le=>{io&&le.target===le.currentTarget&&!y&&Yl()},children:o.jsxs("div",{className:io?"w-full max-w-5xl lg:max-w-4xl bg-white/95 backdrop-blur-xl rounded-2xl shadow-2xl border border-white/50 overflow-hidden transform transition-all duration-300 ease-out animate-[slideUp_240ms_ease-out]":"w-full max-w-5xl mx-auto bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden max-h-[95vh] lg:max-h-[80vh] flex flex-col",onClick:le=>le.stopPropagation(),children:[o.jsxs("div",{className:"flex items-center justify-between px-3 sm:px-5 lg:px-4 py-2.5 sm:py-3.5 lg:py-2 border-b border-slate-200/70 bg-gradient-to-r from-slate-50 to-white",children:[o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1",children:[o.jsx(Hu,{className:"h-10 w-10 sm:h-14 sm:w-14 lg:h-10 lg:w-10 flex-shrink-0"}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl lg:text-2xl font-bold text-slate-800 truncate",children:"Tutor Application"}),o.jsx("p",{className:"text-slate-600 text-xs sm:text-sm hidden sm:block lg:hidden",children:"Share your expertise and start earning."})]})]}),io?o.jsx("button",{type:"button","aria-label":"Close",onClick:le=>{le.preventDefault(),le.stopPropagation(),Yl()},className:"p-1.5 sm:p-2 rounded-full hover:bg-slate-100 text-slate-500 hover:text-slate-700 transition-colors flex-shrink-0 ml-2",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}):o.jsx("button",{type:"button","aria-label":"Back",onClick:le=>{le.preventDefault(),le.stopPropagation(),e?e():window.history.back()},className:"p-1.5 sm:p-2 rounded-full hover:bg-slate-100 text-slate-500 hover:text-slate-700 transition-colors flex-shrink-0 ml-2",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})})]}),o.jsx("div",{className:`overflow-y-auto px-2 sm:px-4 md:px-5 lg:px-4 py-3 sm:py-4 md:py-5 lg:py-3 bg-gradient-to-br from-indigo-50/40 to-sky-50/40 relative ${io?"max-h-[85vh] sm:max-h-[90vh]":"flex-1"}`,children:o.jsx("div",{className:"w-full bg-white/80 backdrop-blur-lg p-3 sm:p-4 md:p-5 lg:p-4 rounded-xl sm:rounded-2xl shadow-xl border border-white/50",children:o.jsxs("form",{onSubmit:Ci,id:"tutor-registration-form",className:"mx-auto max-w-4xl",noValidate:!0,onKeyDown:le=>{const _e=le.target,Pe=_e.tagName==="BUTTON",Je=Pe&&_e.type==="submit";le.key==="Enter"&&!Pe&&!Je&&le.preventDefault()},children:[o.jsxs("div",{className:"space-y-4 lg:space-y-3 mb-5 lg:mb-4",children:[!n&&o.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-3 sm:p-4 md:p-4 lg:p-3 rounded-lg sm:rounded-xl border border-blue-200 shadow-sm",children:[o.jsxs("h3",{className:"text-base sm:text-lg lg:text-base font-semibold text-slate-800 mb-3 sm:mb-3 lg:mb-2 flex items-center",children:[o.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 mr-2 text-blue-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),o.jsx("span",{className:"truncate",children:"Email Verification"})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[o.jsxs("div",{className:"w-full",children:[o.jsx("label",{className:"block text-sm sm:text-base lg:text-sm text-slate-700 font-semibold mb-1.5 sm:mb-2 lg:mb-1",children:"Email Address"}),o.jsx("input",{type:"email",value:S,onChange:le=>k(le.target.value),disabled:!$,className:`w-full px-3 sm:px-4 lg:px-3 py-2 sm:py-3 lg:py-2 text-sm sm:text-base lg:text-sm border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all ${F?"border-red-400 bg-red-50":$?"border-slate-300":"border-slate-200 bg-slate-100 text-slate-500 cursor-not-allowed"}`,placeholder:$?"Enter your university email":"Select a university first",required:!0}),!$&&o.jsxs("p",{className:"text-xs sm:text-sm text-slate-500 mt-1.5 sm:mt-2 flex items-start sm:items-center",children:[o.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 flex-shrink-0 mt-0.5 sm:mt-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),o.jsx("span",{className:"break-words",children:"Please select a university first to enter your email"})]}),F&&o.jsxs("p",{className:"text-xs sm:text-sm text-red-600 mt-1.5 sm:mt-2 flex items-start sm:items-center",children:[o.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 flex-shrink-0 mt-0.5 sm:mt-0",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 000 16zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),o.jsx("span",{className:"break-words",children:F})]})]}),o.jsxs("div",{className:"w-full",children:[o.jsx("label",{className:"block text-sm sm:text-base lg:text-sm text-slate-700 font-semibold mb-1.5 sm:mb-2 lg:mb-1",children:"University"}),o.jsxs("select",{className:"w-full px-3 sm:px-4 lg:px-3 py-2 sm:py-3 lg:py-2 text-sm sm:text-base lg:text-sm border border-slate-300 rounded-lg focus:ring-2 sm:focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 transition-all bg-white",value:$,onChange:le=>R(le.target.value?Number(le.target.value):""),required:!0,children:[o.jsx("option",{value:"",children:"Select University"}),I.map(le=>o.jsx("option",{value:le.university_id,children:le.name},le.university_id))]})]})]}),o.jsxs("div",{className:"mt-3 sm:mt-4 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4",children:[o.jsx("div",{className:"flex items-center min-w-0 flex-1",children:Ie?o.jsxs("div",{className:"flex items-center text-green-700 min-w-0",children:[o.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 mr-1.5 sm:mr-2 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),o.jsx("span",{className:"font-medium text-xs sm:text-sm md:text-base truncate",children:"Email Verified Successfully!"})]}):o.jsxs("div",{className:"flex items-center text-slate-600 min-w-0",children:[o.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 mr-1.5 sm:mr-2 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 19.5c-.77.833.192 2.5 1.732 2.5z"})}),o.jsx("span",{className:"text-xs sm:text-sm md:text-base break-words",children:"Email verification required to submit application"})]})}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3 w-full sm:w-auto",children:[o.jsx("button",{type:"button",onClick:Ib,disabled:!Aa||yt||Ie,className:`w-full sm:w-auto px-4 sm:px-6 py-2 sm:py-3 text-sm sm:text-base rounded-lg font-semibold transition-all duration-300 transform flex-shrink-0 ${Ie?"bg-green-100 text-green-800 border-2 border-green-300 cursor-default":!Aa||yt?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-indigo-600 text-white hover:bg-indigo-700 hover:scale-105 shadow-lg hover:shadow-xl"}`,title:Ie?"Email verified ":Aa?yt?"Code expired. Please send a new code":"Input verification code":"Send verification code first",children:o.jsxs("div",{className:"flex items-center",children:[o.jsxs("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Input Code"]})}),o.jsx("button",{type:"button",onClick:l0,disabled:!S||!$||!!F||ns||Ie||Aa&&!yt,className:`w-full sm:w-auto px-4 sm:px-6 py-2 sm:py-3 text-sm sm:text-base rounded-lg font-semibold transition-all duration-300 transform flex-shrink-0 ${Ie?"bg-green-100 text-green-800 border-2 border-green-300 cursor-default":!S||!$||F||Aa&&!yt?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700 hover:scale-105 shadow-lg hover:shadow-xl"}`,title:Ie?"Email verified ":!S||!$?"Enter email and select university first":F?"Fix email domain error first":Aa&&!yt?'Code already sent. Use "Input Code" button or wait for expiration':"Send verification code",children:ns?o.jsxs("div",{className:"flex items-center",children:[o.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Sending Code..."]}):Ie?o.jsxs("div",{className:"flex items-center",children:[o.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Verified "]}):o.jsxs("div",{className:"flex items-center",children:[o.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Send Verification Code"]})})]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-12 gap-3 sm:gap-3 lg:gap-3 p-3 sm:p-4 md:p-4 lg:p-3 bg-white rounded-lg sm:rounded-xl border border-slate-200 shadow-sm items-start",children:[!s&&o.jsxs("div",{className:"w-full sm:col-span-2 lg:col-span-8",children:[o.jsx("label",{className:"block text-sm sm:text-base lg:text-sm text-slate-700 font-semibold mb-1 lg:mb-0.5",children:"Full Name"}),o.jsx("input",{type:"text",value:T,onChange:le=>{const _e=le.target.value.replace(/[^A-Za-z\-\s]/g,"").slice(0,60);E(_e)},className:"w-full py-2 sm:py-2.5 pl-3 sm:pl-3 lg:pl-3 pr-3 sm:pr-3 lg:pr-3 text-sm sm:text-base lg:text-sm border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Enter your full name",required:!0})]}),o.jsxs("div",{className:"w-full sm:col-span-2 lg:col-span-4",children:[o.jsx("label",{className:"block text-sm sm:text-base lg:text-sm text-slate-700 font-semibold mb-1 lg:mb-0.5",children:"Password"}),o.jsxs("div",{className:"relative w-full",children:[o.jsx("input",{type:Ce?"text":"password",value:D,onChange:le=>A(le.target.value.slice(0,21)),minLength:7,maxLength:21,autoComplete:"new-password","data-form-type":"other","data-lpignore":"true","data-1p-ignore":"true","data-bwignore":"true",style:{WebkitAppearance:"none",MozAppearance:"textfield"},required:!0,className:"w-full py-2 sm:py-2.5 pl-3 sm:pl-4 lg:pl-3 pr-10 sm:pr-12 lg:pr-10 text-sm sm:text-base lg:text-sm border border-slate-300 rounded-lg [&::-webkit-credentials-auto-fill-button]:!hidden [&::-ms-reveal]:hidden [&::-webkit-strong-password-auto-fill-button]:!hidden",placeholder:"Desired Password"}),o.jsx("button",{type:"button",onClick:()=>De(!Ce),"aria-label":Ce?"Hide password":"Show password",className:"absolute right-2 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 z-10",children:Ce?o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"h-4 w-4 sm:h-5 sm:w-5",children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}):o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"h-4 w-4 sm:h-5 sm:w-5",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.242 4.242L6.228 6.228"})})})]})]}),!r&&o.jsxs("div",{className:"w-full sm:col-span-2 lg:col-span-12",children:[o.jsx("label",{className:"block text-sm sm:text-base text-slate-700 font-semibold mb-1",children:"Course"}),o.jsxs("select",{className:`w-full px-3 sm:px-4 py-2 sm:py-2.5 text-sm sm:text-base border rounded-lg ${$?"border-slate-300":"border-slate-200 bg-slate-100 text-slate-400 cursor-not-allowed"}`,value:z,onChange:le=>{K(le.target.value||"")},disabled:!$,title:$?void 0:"Select a university first",children:[o.jsx("option",{value:"",children:"Select Course"}),dt.map(le=>o.jsx("option",{value:String(le.course_id),children:le.course_name},le.course_id))]}),!z&&!$&&o.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Select a university to enable course selection."})]})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-12 gap-3 sm:gap-3 lg:gap-3 mb-4 sm:mb-4 lg:mb-3 p-3 sm:p-4 md:p-4 lg:p-3 bg-white rounded-lg sm:rounded-xl border border-slate-200 shadow-sm items-start",children:[!a&&o.jsxs("div",{className:"w-full sm:col-span-1 lg:col-span-3",children:[o.jsx("label",{className:"block text-sm sm:text-base text-slate-700 font-semibold mb-1",children:"Year Level"}),o.jsxs("select",{value:Ze,onChange:le=>bt(le.target.value),className:"w-full px-3 py-2 text-sm sm:text-base border border-slate-300 rounded-lg",required:!0,children:[o.jsx("option",{value:"",children:"None"}),o.jsx("option",{value:"1",children:"1st Year"}),o.jsx("option",{value:"2",children:"2nd Year"}),o.jsx("option",{value:"3",children:"3rd Year"}),o.jsx("option",{value:"4",children:"4th Year"}),o.jsx("option",{value:"5",children:"5th Year"})]})]}),o.jsxs("div",{className:"w-full sm:col-span-1 lg:col-span-5",children:[o.jsx("label",{className:"block text-sm sm:text-base text-slate-700 font-semibold mb-1",children:"GCash Number"}),o.jsx("input",{type:"tel",value:tt,onChange:le=>{const Pe=le.target.value.replace(/[^0-9]/g,"");Pe.length<=11&&St(Pe)},className:"w-full px-3 py-2 text-sm sm:text-base border border-slate-300 rounded-lg",placeholder:"09XXXXXXXXX",pattern:"09[0-9]{9}",maxLength:11,required:!0}),o.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Format: 09XXXXXXXXX (11 digits, numbers only)"})]}),o.jsxs("div",{className:"w-full sm:col-span-2 lg:col-span-4",children:[o.jsx("label",{className:"block text-sm sm:text-base text-slate-700 font-semibold mb-1",children:"Session Rate (/hour)"}),o.jsxs("div",{className:"relative w-full",children:[o.jsx("span",{className:"absolute left-2 sm:left-3 top-1/2 -translate-y-1/2 text-slate-500 text-sm sm:text-base",children:""}),o.jsx("input",{type:"text",inputMode:"numeric",value:ee,onChange:le=>{const _e=le.target.value.replace(/[^0-9]/g,"").slice(0,6);ce(_e)},className:`w-full pl-6 sm:pl-7 pr-2 sm:pr-3 py-2 text-sm sm:text-base border rounded-lg ${xt?"border-red-400 bg-red-50 focus:ring-2 focus:ring-red-500 focus:border-red-500":"border-slate-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"}`,placeholder:"e.g., 350"})]}),xt?o.jsxs("p",{className:"text-xs text-red-600 mt-1 flex items-start",children:[o.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 000 16zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),o.jsx("span",{className:"break-words",children:xt})]}):o.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Typical range: 100 - 800"})]})]}),o.jsxs("div",{className:"mb-4 sm:mb-4 lg:mb-3 p-3 sm:p-4 md:p-4 lg:p-3 bg-white rounded-lg sm:rounded-xl border border-slate-200 shadow-sm",children:[o.jsx("label",{className:"block text-sm sm:text-base text-slate-700 font-semibold mb-1",children:"Your Bio (why you'd be a great tutor)"}),o.jsx("textarea",{value:Re,onChange:le=>{const _e=le.target.value.replace(/[^A-Za-z\s]/g,"");Ve(_e)},rows:4,className:"w-full px-3 sm:px-4 py-2 text-sm sm:text-base border border-slate-300 rounded-lg focus:ring-2 sm:focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500",placeholder:"Share your peer-to-peer tutoring style, subjects you can help with, relevant study experience, and how you support fellow students."})]}),o.jsxs("div",{className:"p-3 sm:p-4 md:p-4 lg:p-3 bg-white rounded-lg sm:rounded-xl border border-slate-200 shadow-sm",children:[o.jsx("h2",{className:"block text-base sm:text-lg text-slate-700 font-semibold mb-2",children:"1. Subjects of Expertise"}),o.jsxs("div",{className:"flex flex-wrap gap-2 mb-4 min-h-[2.5rem] items-center",children:[Array.from(p).map(le=>o.jsxs("div",{className:"flex items-center bg-indigo-100 text-indigo-800 text-sm font-medium pl-3 pr-2 py-1 rounded-full",children:[le,o.jsx("button",{type:"button",onClick:()=>Pt(le),className:"ml-2 flex-shrink-0 bg-indigo-200 hover:bg-indigo-300 text-indigo-800 rounded-full p-0.5","aria-label":`Remove ${le}`,children:o.jsx("svg",{className:"h-3 w-3",stroke:"currentColor",fill:"none",viewBox:"0 0 8 8",children:o.jsx("path",{strokeLinecap:"round",strokeWidth:"1.5",d:"M1 1l6 6m0-6L1 7"})})})]},le)),p.size===0&&o.jsx("p",{className:"text-sm text-slate-500",children:"No subjects selected yet."})]}),p.size>0&&o.jsx("div",{className:"space-y-4 mb-6",children:Array.from(p).map(le=>o.jsxs("div",{className:"border rounded-lg p-3 bg-slate-50/50",onClick:_e=>{_e.target!==_e.currentTarget&&_e.stopPropagation()},onMouseDown:_e=>{_e.target!==_e.currentTarget&&_e.stopPropagation()},children:[o.jsxs("label",{className:"block text-slate-700 font-semibold mb-1",children:["Supporting documents for: ",o.jsx("span",{className:"text-indigo-700",children:le}),(fe[le]||[]).length>0&&o.jsxs("span",{className:"ml-2 px-2 py-0.5 bg-green-100 text-green-700 text-xs font-medium rounded-full",children:[(fe[le]||[]).length," file",(fe[le]||[]).length!==1?"s":""," selected"]})]}),o.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Upload proofs (PDF, PNG, JPG, JPEG). At least one file required."}),o.jsxs("div",{className:"relative",onClick:_e=>{_e.stopPropagation()},onMouseDown:_e=>{_e.stopPropagation()},onMouseUp:_e=>{_e.stopPropagation()},children:[o.jsx("input",{type:"file",multiple:!0,accept:".pdf,.png,.jpg,.jpeg,application/pdf,image/png,image/jpeg,image/jpg",onChange:_e=>{_e.preventDefault(),_e.stopPropagation(),v(!1);const Pe=Array.from(_e.target.files||[]);if(Pe.length===0){v(!1);return}ye(Je=>({...Je,[le]:[...Je[le]||[],...Pe]})),setTimeout(()=>{_e.currentTarget&&(_e.currentTarget.value="")},0)},onClick:_e=>{_e.stopPropagation(),v(!0)},onFocus:_e=>{_e.stopPropagation(),v(!0)},onBlur:_e=>{_e.stopPropagation(),setTimeout(()=>v(!1),300)},onMouseDown:_e=>{_e.stopPropagation()},onMouseUp:_e=>{_e.stopPropagation()},className:"block w-full text-sm text-slate-700 file:mr-3 file:py-2 file:px-3 file:rounded file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100",id:`file-input-${le}`,form:""}),(fe[le]||[]).length>0&&o.jsxs("div",{className:"mt-2",children:[o.jsx("p",{className:"text-xs text-slate-600 font-medium mb-1",children:"Selected files:"}),o.jsx("ul",{className:"list-none text-xs text-slate-600 space-y-1",children:(fe[le]||[]).map((_e,Pe)=>o.jsxs("li",{className:"flex items-center justify-between bg-slate-50 px-2 py-1 rounded",children:[o.jsx("span",{className:"truncate mr-2 flex-1",title:_e.name,children:_e.name}),o.jsxs("span",{className:"text-xs text-slate-400 mr-2",children:["(",(_e.size/1024).toFixed(1)," KB)"]}),o.jsx("button",{type:"button",className:"text-red-600 hover:text-red-700 hover:underline flex-shrink-0",onClick:Je=>{Je.preventDefault(),Je.stopPropagation(),ye(pt=>{const Ct={...pt},At=[...Ct[le]||[]];return At.splice(Pe,1),Ct[le]=At,Ct})},"aria-label":`Remove ${_e.name}`,children:"remove"})]},`${le}-f-${Pe}`))})]})]})]},`files-${le}`))}),o.jsxs("div",{className:"flex items-center gap-2 mb-4 max-w-3xl",children:[o.jsxs("select",{value:B,onChange:le=>O(le.target.value),className:`flex-grow w-full px-4 py-2 border rounded-lg focus:ring-4 focus:ring-indigo-500/20 focus:border-indigo-500 ${!$||!z?"border-slate-500 bg-slate-600/70 text-white/60 cursor-not-allowed":"border-slate-600 bg-slate-700 text-white"}`,"aria-label":"Select a subject to add",disabled:!$||!z,title:$?z?void 0:"Select a course first to view subjects":"Select a university first",children:[o.jsx("option",{value:"",children:"Select a subject..."}),U.filter(le=>!p.has(le.subject_name)).map(le=>o.jsx("option",{value:le.subject_name,children:le.subject_name},le.subject_id)),o.jsx("option",{value:"other",children:"Other"})]}),o.jsx("button",{type:"button",onClick:Dt,disabled:!$||!z||!B||B==="other"||ct.has(B.toLowerCase()),className:"bg-indigo-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-indigo-600 transition-colors disabled:bg-slate-400 disabled:cursor-not-allowed",title:$?z?!B||B==="other"?"Select a subject to add":void 0:"Select a course first":"Select a university first",children:"Add"})]}),!$&&o.jsx("p",{className:"text-xs text-slate-500 mb-4",children:"Select a university to view and add subjects."}),$&&!z&&o.jsxs("p",{className:"text-xs text-amber-600 mb-4 flex items-center",children:[o.jsx("svg",{className:"w-4 h-4 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),"Please select a course to view and add subjects specific to that course."]}),B==="other"&&o.jsxs("div",{className:"max-w-3xl",children:[o.jsx("label",{htmlFor:"other-subject",className:"block text-slate-600 text-sm mb-1",children:"Not in the list? Add another subject:"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("input",{type:"text",id:"other-subject",value:se,onChange:le=>{const _e=le.target.value.replace(/[^a-zA-Z\s]/g,"");ae(_e)},placeholder:"e.g., Astrophysics",className:`flex-grow w-full px-4 py-2 border rounded-lg focus:ring-4 focus:ring-indigo-500/20 focus:border-indigo-500 placeholder-slate-400 ${!$||!z?"border-slate-500 bg-slate-700/60 text-white/60 cursor-not-allowed":"border-slate-600 bg-slate-700 text-white"}`,disabled:!$||!z,title:$?z?void 0:"Select a course first to add a custom subject":"Select a university first"}),o.jsx("button",{type:"button",onClick:Et,disabled:!$||!z||B!=="other"||!se.trim()||Ye,className:"bg-slate-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-slate-600 transition-colors disabled:bg-slate-300 disabled:cursor-not-allowed",title:!$||!z?"Select a university and course first":se.trim()?Ye?"Subject already exists in the list":void 0:"Enter a subject name",children:"Add"})]}),Ye&&o.jsx("p",{className:"mt-1 text-xs text-red-300",children:"Subject already exists. Please select it from the dropdown above."}),!z&&o.jsx("p",{className:"mt-1 text-xs text-amber-600",children:"Please select a course first to add a custom subject for that course."})]})]}),o.jsxs("div",{className:"mt-5 sm:mt-5 lg:mt-4 p-3 sm:p-4 md:p-4 lg:p-3 bg-white rounded-lg sm:rounded-xl border border-slate-200 shadow-sm",children:[o.jsx("h2",{className:"block text-base sm:text-lg text-slate-700 font-semibold mb-2",children:"2. Weekly Availability"}),o.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-3",children:[o.jsxs("select",{id:"day-to-add",value:us,onChange:le=>Ps(le.target.value),className:"flex-1 sm:flex-none border border-slate-300 rounded-md px-3 py-2 text-sm",children:[o.jsx("option",{value:"",children:"Select a day"}),Lr.map(le=>o.jsx("option",{value:le,children:le},le))]}),o.jsx("button",{type:"button",onClick:()=>ao(us),disabled:!us,className:`w-full sm:w-auto px-4 py-2 rounded-md text-sm font-medium ${us?"bg-indigo-600 text-white hover:bg-indigo-700":"bg-gray-200 text-gray-500 cursor-not-allowed"}`,children:"Add"})]}),Object.keys(Qa).length===0&&o.jsx("p",{className:"text-xs sm:text-sm text-slate-500",children:'No availability added yet. Click "Add Day" to begin.'}),o.jsx("div",{className:"space-y-2 sm:space-y-3",children:Object.entries(Qa).map(([le,_e])=>o.jsxs("div",{className:"p-3 sm:p-4 border rounded-lg bg-white",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-0 mb-2 sm:mb-3",children:[o.jsx("div",{className:"font-medium text-sm sm:text-base text-slate-800",children:le}),o.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[o.jsx("button",{type:"button",onClick:()=>Xt(le),className:"flex-1 sm:flex-none text-xs sm:text-sm px-3 py-1.5 sm:py-1 bg-slate-100 hover:bg-slate-200 rounded-md",children:"Add Time"}),o.jsx("button",{type:"button",onClick:()=>ue(le),className:"flex-1 sm:flex-none text-xs sm:text-sm px-3 py-1.5 sm:py-1 text-red-600 bg-red-50 hover:bg-red-100 rounded-md",children:"Remove Day"})]})]}),o.jsx("div",{className:"space-y-2",children:_e.slots.map((Pe,Je)=>o.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[o.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[o.jsx("input",{type:"time",value:Pe.startTime,onChange:pt=>Vn(le,Je,"startTime",pt.target.value),className:"flex-1 px-2 sm:px-3 py-1.5 sm:py-1 border rounded-md text-xs sm:text-sm"}),o.jsx("span",{className:"text-slate-500 text-sm",children:"-"}),o.jsx("input",{type:"time",value:Pe.endTime,onChange:pt=>Vn(le,Je,"endTime",pt.target.value),className:"flex-1 px-2 sm:px-3 py-1.5 sm:py-1 border rounded-md text-xs sm:text-sm"})]}),o.jsx("button",{type:"button",onClick:()=>ki(le,Je),className:"w-full sm:w-auto text-xs sm:text-sm px-3 py-1.5 sm:py-1 text-red-600 bg-red-50 hover:bg-red-100 rounded-md",children:"Remove"})]},Je))})]},le))})]})]}),o.jsxs("div",{className:"mt-5 sm:mt-5 lg:mt-4 p-3 sm:p-4 md:p-4 lg:p-3 bg-white rounded-lg sm:rounded-xl border border-slate-200 shadow-sm",children:[o.jsx("h2",{className:"block text-base sm:text-lg text-slate-700 font-semibold mb-2",children:"3. Proof Documents"}),o.jsxs("div",{className:"mb-4 sm:mb-6",children:[o.jsx("label",{className:"block text-sm sm:text-base text-slate-700 font-semibold mb-1",children:"Profile Image (optional)"}),o.jsx("input",{type:"file",accept:"image/*",onChange:Ln,disabled:Ya||xe,className:`w-full px-3 sm:px-4 py-2 text-sm sm:text-base border border-slate-300 rounded-lg ${Ya||xe?"opacity-50 cursor-not-allowed":""}`}),(Ya||xe)&&o.jsxs("div",{className:"flex items-center mt-2 text-blue-600",children:[o.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-3 w-3 sm:h-4 sm:w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),o.jsx("span",{className:"text-xs sm:text-sm",children:xe?"Loading image analyzer...":"Analyzing image content..."})]}),Se&&o.jsxs("p",{className:"text-xs text-slate-500 mt-1 truncate",children:["Selected: ",Se.name]})]}),o.jsxs("div",{className:"mb-4 sm:mb-6",children:[o.jsx("label",{className:"block text-sm sm:text-base text-slate-700 font-semibold mb-1",children:"GCash QR Code (optional)"}),o.jsx("input",{type:"file",accept:"image/*",onChange:Xl,disabled:Ya||xe,className:`w-full px-3 sm:px-4 py-2 text-sm sm:text-base border border-slate-300 rounded-lg ${Ya||xe?"opacity-50 cursor-not-allowed":""}`}),(Ya||xe)&&o.jsxs("div",{className:"flex items-center mt-2 text-blue-600",children:[o.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-3 w-3 sm:h-4 sm:w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),o.jsx("span",{className:"text-xs sm:text-sm",children:xe?"Loading image analyzer...":"Analyzing image content..."})]}),me&&o.jsxs("p",{className:"text-xs text-slate-500 mt-1 truncate",children:["Selected: ",me.name]}),o.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Upload your GCash QR code for payment processing"})]}),o.jsxs("div",{className:"space-y-2",onClick:le=>{const _e=le.target;_e.id==="file-upload-drag"||_e.closest('input[type="file"]')||_e.closest('[id^="file-input-"]')||le.stopPropagation()},onMouseDown:le=>{const _e=le.target;_e.id==="file-upload-drag"||_e.closest('input[type="file"]')||_e.closest('[id^="file-input-"]')||le.stopPropagation()},children:[o.jsxs("label",{className:"block text-xs sm:text-sm font-medium text-slate-700",children:["Supporting Documents ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("p",{className:"text-xs text-slate-500",children:"Upload valid supporting documents (e.g., National ID, COR, academic achievements, transcript, student ID, certification) to verify your credibility as a tutor."}),o.jsxs("div",{className:"mt-1 relative flex justify-center px-3 sm:px-6 pt-4 sm:pt-5 pb-4 sm:pb-6 border-2 border-slate-300 border-dashed rounded-md hover:border-indigo-400 hover:bg-indigo-50/30 transition-colors cursor-pointer",onDragOver:un,onDragEnter:Pn,onDragLeave:Ls,onDrop:Kn,children:[o.jsx("input",{id:"file-upload-drag",type:"file",className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10",multiple:!0,accept:".pdf,.docx,.png,.jpg,.jpeg,application/pdf,application/vnd.openxmlformats-officedocument.wordprocessingml.document,image/png,image/jpeg,image/jpg",onChange:Wt,onClick:le=>{le.stopPropagation(),v(!0)},onFocus:le=>{le.stopPropagation(),v(!0)},onBlur:le=>{le.stopPropagation(),setTimeout(()=>v(!1),300)},onTouchStart:le=>{le.stopPropagation(),v(!0)},form:""}),o.jsxs("div",{className:"space-y-1 text-center relative z-0 pointer-events-none",children:[o.jsx(V1e,{className:"mx-auto h-8 w-8 sm:h-12 sm:w-12 text-slate-400"}),o.jsxs("div",{className:"text-xs sm:text-sm text-slate-600",children:[o.jsx("p",{children:"Drag and drop your files here"}),o.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"or click to browse"})]}),o.jsx("p",{className:"text-xs text-slate-500",children:"PDF, DOCX, PNG, JPG, JPEG up to 10MB"})]})]})]}),Te.length>0&&o.jsxs("div",{className:"mt-3 sm:mt-4",children:[o.jsx("h4",{className:"font-semibold text-sm sm:text-base text-slate-700 mb-2",children:"Selected files:"}),o.jsx("ul",{className:"list-none space-y-2 text-xs sm:text-sm",children:Te.map((le,_e)=>o.jsxs("li",{className:"flex items-center justify-between bg-slate-50 px-3 py-2 rounded-lg border border-slate-200",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("span",{className:"text-slate-700 font-medium truncate block",title:le.name,children:le.name}),o.jsxs("span",{className:"text-xs text-slate-500",children:["(",(le.size/1024).toFixed(1)," KB)"]})]}),o.jsx("button",{type:"button",className:"ml-3 text-red-600 hover:text-red-700 hover:underline flex-shrink-0 text-xs font-medium px-2 py-1 rounded transition-colors",onClick:Pe=>{Pe.preventDefault(),Pe.stopPropagation(),oe(Je=>Je.filter((pt,Ct)=>Ct!==_e))},"aria-label":`Remove ${le.name}`,children:"Remove"})]},_e))})]})]})]}),o.jsxs("div",{className:"pt-3 sm:pt-4",children:[o.jsxs("div",{className:"flex items-start gap-2 text-xs sm:text-sm text-slate-700",children:[o.jsx("input",{id:"accept-terms",type:"checkbox",checked:mt,onChange:le=>jt(le.target.checked),disabled:!ut,className:`mt-1 h-4 w-4 rounded border-slate-300 text-indigo-600 focus:ring-indigo-500 flex-shrink-0 ${ut?"":"opacity-50 cursor-not-allowed"}`}),o.jsxs("label",{htmlFor:"accept-terms",className:"leading-5 break-words",children:[ut?"I have read and agree to the Tutor Terms and Conditions.":"I agree to the Tutor Terms and Conditions (please read the terms first).",o.jsx("button",{type:"button",className:"ml-1 sm:ml-2 text-indigo-600 hover:text-indigo-700 underline whitespace-nowrap",onClick:()=>{ht(!0),M(0)},children:ut?"Review Terms":"Read Terms"})]})]}),!ut&&o.jsxs("p",{className:"text-xs text-amber-600 mt-1 ml-6 sm:ml-7 flex items-start sm:items-center",children:[o.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 flex-shrink-0 mt-0.5 sm:mt-0",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),o.jsx("span",{className:"break-words",children:"Please open and read the Terms and Conditions before accepting."})]}),o.jsx("div",{className:"sticky bottom-0 mt-3 bg-gradient-to-t from-white/80 to-transparent pt-3 pb-2 z-50 pointer-events-auto",children:o.jsx("button",{type:"submit",className:`w-full font-bold py-2.5 sm:py-3 px-4 sm:px-6 text-sm sm:text-base rounded-lg transition-colors relative z-50 ${Ie&&mt&&ut?"bg-indigo-600 text-white hover:bg-indigo-700 active:bg-indigo-800 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2":"bg-gray-400 text-gray-600 cursor-not-allowed"}`,disabled:!Ie||!mt||!ut,onClick:le=>{if(!Ie||!mt||!ut){le.preventDefault(),le.stopPropagation();return}if(y){le.preventDefault(),le.stopPropagation(),setTimeout(()=>{v(!1);const Pe=le.currentTarget.form||document.getElementById("tutor-registration-form");Pe&&Ci({preventDefault:()=>{},stopPropagation:()=>{},target:Pe,currentTarget:Pe})},500);return}if(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||window.innerWidth<=768){le.preventDefault(),le.stopPropagation();const Pe=le.currentTarget.form||document.getElementById("tutor-registration-form");Pe&&Ci({preventDefault:()=>{},stopPropagation:()=>{},target:Pe,currentTarget:Pe})}},style:{WebkitTapHighlightColor:"rgba(99, 102, 241, 0.3)",touchAction:"manipulation",WebkitUserSelect:"none",userSelect:"none",position:"relative",zIndex:50,minHeight:"44px"},title:Ie?ut?mt?"Submit your tutor application":"Please accept the Terms and Conditions":"Please read the Terms and Conditions first":"Please verify your email first",children:Ie?"Submit Application":"Verify Email to Submit"})})]})]})})})]})}),je&&o.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:o.jsx("div",{className:"bg-white/95 backdrop-blur-xl rounded-2xl shadow-2xl border border-white/50 max-w-md w-full relative overflow-hidden",children:o.jsxs("div",{className:"p-8 text-center",children:[o.jsx("div",{className:"flex items-center justify-center mb-4",children:o.jsx("div",{className:"w-16 h-16 rounded-full bg-green-100 flex items-center justify-center",children:o.jsx(LH,{className:"w-10 h-10 text-green-600"})})}),o.jsx("h2",{className:"text-2xl font-bold text-slate-800 mb-3",children:"Application Submitted!"}),o.jsx("p",{className:"text-slate-600 mb-6",children:"Thank you for your application. Our team will review your submitted documents. You will be notified once approved."}),o.jsx("button",{onClick:()=>{ie(!1),e&&e()},className:"w-full bg-indigo-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-indigo-700 transition-colors",children:"Close"})]})})}),In&&o.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"bg-white/95 backdrop-blur-xl rounded-2xl shadow-2xl border border-white/50 max-w-md w-full relative overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 opacity-5",children:o.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-gradient-to-br from-blue-500 to-indigo-600"})}),o.jsxs("div",{className:"relative z-10 p-6",children:[o.jsxs("div",{className:"text-center mb-6",children:[o.jsx("div",{className:"mx-auto w-16 h-16 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full flex items-center justify-center mb-4",children:o.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),o.jsx("h2",{className:"text-2xl font-bold bg-gradient-to-r from-slate-900 via-blue-800 to-indigo-800 bg-clip-text text-transparent mb-2",children:"Verify Your Email"}),o.jsxs("p",{className:"text-slate-600 text-sm",children:["We've sent a 6-digit verification code to ",o.jsx("strong",{children:S}),". Please check your email and enter the code below."]})]}),ro&&o.jsx("div",{className:"bg-red-50/90 backdrop-blur-sm border border-red-200 text-red-600 px-4 py-3 rounded-xl text-sm font-medium shadow-lg mb-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("svg",{className:"w-5 h-5 mr-2 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),ro]})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"verification-code",className:"block text-sm font-semibold text-slate-800 mb-2",children:"Verification Code"}),o.jsx("input",{id:"verification-code",type:"text",value:Nt,onChange:le=>{const _e=le.target.value.replace(/\D/g,"").slice(0,6);kt(_e)},placeholder:"Enter 6-digit code",className:"w-full px-4 py-3 bg-white/95 backdrop-blur-sm border-2 border-slate-200 rounded-lg focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 transition-all duration-300 placeholder-slate-400 font-medium shadow-lg hover:shadow-xl text-center text-2xl tracking-widest",maxLength:6,autoComplete:"off"})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsxs("button",{onClick:c0,disabled:!Nt.trim()||Nt.length!==6||Ds,className:"flex-1 flex justify-center items-center py-3 px-6 border border-transparent rounded-lg shadow-2xl text-sm font-bold text-white bg-gradient-to-r from-blue-600 via-blue-500 to-indigo-600 hover:from-blue-700 hover:via-blue-600 hover:to-indigo-700 focus:outline-none focus:ring-4 focus:ring-blue-500/30 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 transform hover:scale-105 hover:shadow-3xl relative overflow-hidden group",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),Ds?o.jsxs("div",{className:"flex items-center relative z-10",children:[o.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),o.jsx("span",{className:"text-sm",children:"Verifying..."})]}):o.jsxs("span",{className:"relative z-10 flex items-center",children:[o.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Verify Code"]})]}),o.jsx("button",{onClick:Rb,className:"px-4 py-3 border border-slate-300 rounded-lg text-sm font-medium text-slate-700 hover:bg-slate-50 transition-colors",children:"Cancel"})]}),o.jsx("div",{className:"text-center",children:o.jsx("button",{onClick:l0,disabled:ns,className:"text-sm text-blue-600 hover:text-blue-800 font-medium transition-colors",children:ns?"Sending...":"Didn't receive the code? Resend"})})]})]}),o.jsx("button",{type:"button",onClick:Rb,className:"absolute top-4 right-4 p-2 text-slate-400 hover:text-slate-600 transition-colors z-10 pointer-events-auto","aria-label":"Close verification",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),Oe&&o.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:o.jsx("div",{className:"bg-white/95 backdrop-blur-xl rounded-2xl shadow-2xl border border-white/50 max-w-3xl w-full relative overflow-hidden",children:o.jsxs("div",{className:"relative z-10 p-6",children:[o.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Tutor Terms and Conditions"}),L>0&&o.jsxs("div",{className:"mt-2",children:[o.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[o.jsx("div",{className:"flex-1 bg-slate-200 rounded-full h-2 overflow-hidden",children:o.jsx("div",{className:"bg-indigo-600 h-full transition-all duration-300 ease-out",style:{width:`${Math.min(L,100)}%`}})}),o.jsxs("span",{className:"min-w-[3rem] text-right",children:[Math.round(L),"%"]})]}),L>=80&&o.jsxs("p",{className:"text-xs text-green-600 mt-1 flex items-center",children:[o.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"You can now accept the terms"]})]})]}),o.jsx("button",{type:"button",onClick:Ob,className:"p-2 text-slate-400 hover:text-slate-600 ml-4",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),o.jsxs("div",{className:"max-h-[65vh] overflow-y-auto pr-1 text-slate-700 space-y-4",onScroll:am,children:[o.jsxs("p",{children:[o.jsx("strong",{children:"Effective Date:"})," October 31, 2025"]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Platform Name:"})," TutorFriends (the Platform)"]}),o.jsx("h3",{className:"font-semibold",children:"1. Overview"}),o.jsx("p",{children:"These Terms govern your participation as a Tutor on TutorFriends. By joining and providing tutoring services, you agree to follow these rules and maintain professionalism throughout your use of the Platform."}),o.jsx("h3",{className:"font-semibold",children:"2. Tutor Application"}),o.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[o.jsx("li",{children:"Only qualified individuals may apply as tutors."}),o.jsx("li",{children:"You must submit accurate personal and academic details for verification."}),o.jsx("li",{children:"Uploading false, incomplete, or inappropriate documents is not allowed and may result in suspension or removal."}),o.jsx("li",{children:"TutorFriends reserves the right to approve or revoke tutor access at any time."})]}),o.jsx("h3",{className:"font-semibold",children:"3. Profile and Availability"}),o.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[o.jsx("li",{children:"Once approved, you must complete your profile with accurate information, subjects, and GCash details."}),o.jsx("li",{children:"Keep your profile and schedule updated to ensure proper session bookings."})]}),o.jsx("h3",{className:"font-semibold",children:"4. Session Handling"}),o.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[o.jsx("li",{children:"Tutors may accept or decline session requests."}),o.jsx("li",{children:"Once a session is completed, both parties must confirm it through TutorFriends."}),o.jsx("li",{children:"After confirmation, TutorFriends will verify and process the tutors payment."}),o.jsx("li",{children:"Any disputes will be reviewed by the platforms admin team."})]}),o.jsx("h3",{className:"font-semibold",children:"5. Payment"}),o.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[o.jsx("li",{children:"All payments are handled securely by TutorFriends."}),o.jsx("li",{children:"Tutors will receive their earnings after successful session verification."}),o.jsx("li",{children:"Payments are typically released within 35 business days."}),o.jsx("li",{children:"Tutors must not request or accept payments outside the Platform."})]}),o.jsx("h3",{className:"font-semibold",children:"5.1. Service Fee Deduction"}),o.jsx("p",{children:"All tutor earnings processed through the platform will be subject to a 13% service fee, automatically deducted to cover system and operational costs. The remaining 87% will be issued as the tutor's final payout. This fee is fixed and non-refundable."}),o.jsx("h3",{className:"font-semibold",children:"6. Conduct and Responsibilities"}),o.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[o.jsx("li",{children:"Act professionally and respectfully during sessions."}),o.jsx("li",{children:"Provide accurate, relevant, and appropriate teaching materials."}),o.jsx("li",{children:"Protect students personal and academic information."}),o.jsx("li",{children:"Avoid uploading inappropriate or unrelated files."}),o.jsx("li",{children:"Report any issues or concerns to TutorFriends support."}),o.jsx("li",{children:"Violations may lead to suspension, withholding of payments, or permanent removal."})]}),o.jsx("h3",{className:"font-semibold",children:"7. Ratings and Feedback"}),o.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[o.jsx("li",{children:"Tutees may leave ratings and feedback after each session."}),o.jsx("li",{children:"Tutors must not manipulate or pressure tutees to alter reviews."}),o.jsx("li",{children:"Constructive and professional engagement with feedback is encouraged."})]}),o.jsx("h3",{className:"font-semibold",children:"8. Privacy and Security"}),o.jsx("p",{children:"TutorFriends handles all tutor data and GCash information with confidentiality. Personal information is used only for verification, payment, and platform operations, following the Data Privacy Act of 2012."}),o.jsx("h3",{className:"font-semibold",children:"9. Liability"}),o.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[o.jsx("li",{children:"TutorFriends acts only as a facilitator and payment handler between tutors and tutees."}),o.jsx("li",{children:"The Platform is not responsible for internet issues, GCash delays, or factors beyond its control."}),o.jsx("li",{children:"TutorFriends does not guarantee a fixed number of sessions or earnings."})]}),o.jsx("h3",{className:"font-semibold",children:"10. Modifications"}),o.jsx("p",{children:"TutorFriends may update these Terms anytime. Continued use of the Platform means you accept the revised version."})]}),o.jsx("div",{className:"mt-4 flex justify-end gap-2",children:o.jsx("button",{type:"button",onClick:Ob,className:"px-4 py-2 border border-slate-300 rounded-lg text-sm font-medium text-slate-700 hover:bg-slate-50",children:"Close"})})]})})}),zo.show&&o.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:o.jsx("div",{className:"bg-white/95 backdrop-blur-xl rounded-2xl shadow-2xl border border-white/50 max-w-md w-full relative overflow-hidden",children:o.jsxs("div",{className:"p-6",children:[o.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4",children:"Confirm Action"}),o.jsx("p",{className:"text-slate-600 mb-6",children:zo.message}),o.jsxs("div",{className:"flex justify-end space-x-3",children:[o.jsx("button",{onClick:()=>wr({show:!1,message:"",onConfirm:()=>{}}),className:"px-4 py-2 text-sm font-medium text-slate-700 hover:bg-slate-100 rounded-lg transition-colors",children:"Cancel"}),o.jsx("button",{onClick:()=>{zo.onConfirm(),wr({show:!1,message:"",onConfirm:()=>{}})},className:"px-4 py-2 text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 rounded-lg transition-colors",children:"Confirm"})]})]})})}),b.show&&o.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:o.jsx("div",{className:"bg-white/95 backdrop-blur-xl rounded-2xl shadow-2xl border border-white/50 max-w-md w-full relative overflow-hidden",children:o.jsxs("div",{className:"p-6",children:[o.jsx("div",{className:"flex items-center justify-center mb-4",children:b.type==="warning"?o.jsx("div",{className:"w-12 h-12 rounded-full bg-red-100 flex items-center justify-center",children:o.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.5 0L4.268 19.5c-.77.833.192 2.5 1.732 2.5z"})})}):o.jsx("div",{className:"w-12 h-12 rounded-full bg-green-100 flex items-center justify-center",children:o.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})})}),o.jsx("h3",{className:"text-lg font-semibold text-slate-800 mb-4 text-center",children:b.type==="warning"?"Warning":"Success"}),o.jsx("p",{className:"text-slate-600 mb-6 text-center",children:b.message}),o.jsx("div",{className:"flex justify-center",children:o.jsx("button",{onClick:()=>N({show:!1,message:"",type:"warning"}),className:`px-6 py-2 text-sm font-medium text-white rounded-lg transition-colors ${b.type==="warning"?"bg-red-600 hover:bg-red-700":"bg-green-600 hover:bg-green-700"}`,children:"Got it"})})]})})})]}):null},Dqe=GZ,qZ=({isOpen:t,onClose:e})=>{const n=qr(),{notify:s}=Mh(),[r,a]=j.useState(!1),[i,l]=j.useState({name:"",email:"",password:"",course:"",yearLevel:""}),[c,u]=j.useState([]),[h,f]=j.useState(""),[p,x]=j.useState(null),[y,v]=j.useState(!1),[b,N]=j.useState(!1),[S,k]=j.useState([]),[T,E]=j.useState(""),[D,A]=j.useState(!1),[I,P]=j.useState(!1),[$,R]=j.useState(!1),[F,W]=j.useState(0),[q,X]=j.useState(!1),[z,K]=j.useState(""),[H,Y]=j.useState(!1),[B,O]=j.useState(!1),[U,J]=j.useState(!1),[se,ae]=j.useState(""),[fe,ye]=j.useState(!1),[Te,oe]=j.useState(null),[Se,ke]=j.useState(null);j.useMemo(()=>c.find(M=>M.university_id===h),[c,h]);const me=M=>{const{name:ee,value:ce}=M.target;l(Ce=>({...Ce,[ee]:ce})),ee==="email"&&re(ce)},re=(M,ee)=>{if(!M||!h){x(null),X(!1);return}const ce=c.find(De=>De.university_id===h);if(!ce){x(null),X(!1);return}const Ce=M.split("@")[1]||"";!Ce||Ce.toLowerCase()!==ce.email_domain.toLowerCase()?(x(`Email domain must be ${ce.email_domain}`),X(!1)):(x(null),je(M))},je=async M=>{if(!M||!h){X(!1);return}try{const ee=await we.get(`/auth/email-verification/status?email=${encodeURIComponent(M)}&user_type=tutee`);ee.data&&ee.data.is_verified===1?(X(!0),ye(!1),oe(null)):X(!1)}catch{X(!1)}},ie=async M=>{if(!M||!h){ye(!1),oe(null);return}try{const ee=await we.get(`/auth/email-verification/status?email=${encodeURIComponent(M)}&user_type=tutee`);if(ee.data&&ee.data.verification_expires){const ce=new Date(ee.data.verification_expires).getTime(),Ce=Date.now();if(ce>Ce){oe(ce),ye(!0);return}}ye(!1),oe(null)}catch{ye(!1),oe(null)}},Re=async()=>{var M,ee;if(!i.email||!h){s("Please enter email and select university first.","error");return}if(p){s(p,"error");return}O(!0),ae("");try{console.log("Frontend: Sending verification code to:",i.email);const ce=await we.post("/auth/email-verification/send-code",{email:i.email,user_type:"tutee"});if(console.log("Frontend: Verification code response:",ce.data),ce.data){const Ce=Date.now()+6e5;oe(Ce),ye(!0),s("Verification code sent to your email!","success")}}catch(ce){console.log("Frontend: Verification code error:",ce);const Ce=((ee=(M=ce.response)==null?void 0:M.data)==null?void 0:ee.message)||"Failed to send verification code. Please try again.";ae(Ce),s(Ce,"error")}finally{O(!1)}},Ve=()=>{fe&&!jt&&(Y(!0),ae(""))},Ze=async()=>{var M,ee;if(!z.trim()){ae("Please enter the verification code");return}J(!0),ae("");try{console.log("Frontend: Verifying code:",z);const ce=await we.post("/auth/email-verification/verify-code",{email:i.email,code:z,user_type:"tutee"});console.log("Frontend: Verification response:",ce.data),ce.data&&(X(!0),Y(!1),K(""),ye(!1),oe(null),s("Email verified successfully! You can now submit your registration.","success"))}catch(ce){console.log("Frontend: Verification error:",ce);const Ce=((ee=(M=ce.response)==null?void 0:M.data)==null?void 0:ee.message)||"Invalid verification code. Please try again.";ae(Ce),s(Ce,"error")}finally{J(!1)}},bt=()=>{Y(!1),K(""),ae("")},tt=()=>{F>=80&&R(!0),P(!1)},St=M=>{const ee=M.currentTarget,ce=ee.scrollTop,Ce=ee.scrollHeight,De=ee.clientHeight,xt=ce/(Ce-De)*100;W(xt),xt>=80&&R(!0)},mt=M=>{const ee=M.target.files&&M.target.files[0];ee&&(ee.type.startsWith("image/")?(ke(ee),s("Profile image selected successfully!","success")):(s("Please select a valid image file.","error"),M.target.value=""))};j.useEffect(()=>{(async()=>{try{const ee=((await we.get("/universities")).data||[]).filter(De=>De.status==="active");u(ee);const ce=await we.get("/courses"),Ce=(Array.isArray(ce.data)?ce.data:[]).map(De=>{var xt;return{...De,university_id:(De==null?void 0:De.university_id)??((xt=De==null?void 0:De.university)==null?void 0:xt.university_id)??(De==null?void 0:De.universityId)??null}});k(Ce)}catch{u([]),k([])}})()},[]),j.useEffect(()=>{if(!i.email||!h){x(null),X(!1),ye(!1),oe(null);return}const M=c.find(ce=>ce.university_id===h);if(!M){x(null),X(!1),ye(!1),oe(null);return}const ee=i.email.split("@")[1]||"";!ee||ee.toLowerCase()!==M.email_domain.toLowerCase()?(x(`Email domain must be ${M.email_domain}`),X(!1),ye(!1),oe(null)):(x(null),je(i.email),ie(i.email))},[i.email,h,c]);const jt=j.useMemo(()=>Te?Date.now()>Te:!0,[Te]);j.useEffect(()=>{if(!Te)return;const M=setInterval(()=>{Date.now()>Te&&(ye(!1),oe(null))},1e3);return()=>clearInterval(M)},[Te]);const Oe=j.useMemo(()=>S.filter(M=>{var ce;const ee=(M==null?void 0:M.university_id)??((ce=M==null?void 0:M.university)==null?void 0:ce.university_id)??(M==null?void 0:M.universityId);return!h||ee===h}),[S,h]);j.useEffect(()=>{const M=i.course.trim().toLowerCase();if(!M||T)return;const ee=Oe.find(ce=>ce.course_name.toLowerCase()===M);ee&&E(ee.course_id)},[i.course,T,Oe]),j.useEffect(()=>{if(!T)return;Oe.some(ee=>ee.course_id===T)||(E(""),l(ee=>({...ee,course:""})))},[Oe,T]),j.useEffect(()=>{h||(E(""),l(M=>({...M,course:""})))},[h]);const ht=async M=>{var ce,Ce,De,xt,Ie,lt;if(M.preventDefault(),a(!0),!i.name||!i.email||!i.password||!i.yearLevel){a(!1),s("Please fill all required fields.","error");return}if(p){s(p,"error");return}if(!q){s("Please verify your email address before submitting the registration.","error");return}if(i.password.length<7||i.password.length>21){s("Password must be between 7 and 21 characters.","error");return}if(!(!!T||!!i.course.trim())){s("Please select or enter a course.","error");return}try{console.log("Starting tutee registration submission..."),console.log("Form data:",{name:i.name.trim(),email:i.email,password:i.password,university_id:Number(h),course_id:T?Number(T):void 0,course_name:!T&&i.course.trim().length>0?i.course.trim():void 0,year_level:Number(i.yearLevel)});const Nt={name:i.name.trim(),email:i.email,password:i.password,user_type:"tutee",university_id:Number(h),course_id:T?Number(T):void 0,course_name:!T&&i.course.trim().length>0?i.course.trim():void 0,year_level:Number(i.yearLevel)},kt=await we.post("/auth/register",Nt);console.log("Tutee registration successful:",kt.data);const{user:In,accessToken:vs}=kt.data;localStorage.setItem("token",vs),localStorage.setItem("user",JSON.stringify(In));const ns=ci(In==null?void 0:In.role)??ci(In==null?void 0:In.user_type);ns&&In&&nw(ns,In,vs),console.log("Token stored:",vs),console.log("User stored:",In);try{const qn=await we.get("/users/test-auth",{headers:{Authorization:`Bearer ${vs}`}});console.log("Auth test successful:",qn.data)}catch(qn){console.error("Auth test failed:",qn)}if(await new Promise(qn=>setTimeout(qn,100)),Se)try{console.log("Uploading profile image for tutee:",In.user_id),console.log("Using token:",vs);const qn=new FormData;qn.append("file",Se);const Ds=await we.post(`/users/${In.user_id}/profile-image`,qn,{headers:{"Content-Type":"multipart/form-data",Authorization:`Bearer ${vs}`}});console.log("Profile image uploaded successfully:",Ds.data);const Ks={...In,profile_image_url:Ds.data.profile_image_url};localStorage.setItem("user",JSON.stringify(Ks)),Lg(Ks),s("Profile image uploaded successfully!","success")}catch(qn){console.error("Failed to upload profile image:",qn),console.error("Error details:",(ce=qn.response)==null?void 0:ce.data),console.error("Error status:",(Ce=qn.response)==null?void 0:Ce.status),s("Registration successful, but profile image upload failed. You can update it later.","info")}else try{console.log("Setting placeholder profile image for tutee"),await we.post(`/users/${In.user_id}/profile-image-placeholder`,{},{headers:{Authorization:`Bearer ${vs}`}}),console.log("Placeholder profile image set")}catch(qn){console.error("Failed to set placeholder profile image:",qn)}s("Registration successful!","success"),e?e():n("/LandingPage");return}catch(Nt){console.error("Registration error:",Nt),console.error("Error response:",(De=Nt==null?void 0:Nt.response)==null?void 0:De.data),console.error("Error status:",(xt=Nt==null?void 0:Nt.response)==null?void 0:xt.status);const kt=((lt=(Ie=Nt==null?void 0:Nt.response)==null?void 0:Ie.data)==null?void 0:lt.message)||(Nt==null?void 0:Nt.message)||"Failed to submit registration";typeof kt=="string"&&kt.toLowerCase().includes("email already registered")?s("Email already registered","error"):s(kt,"error")}};if(y)return o.jsx("div",{className:"min-h-[calc(100vh-68px)] flex flex-col items-center justify-center bg-slate-50 p-4",children:o.jsxs("div",{className:"max-w-md w-full text-center bg-white p-10 rounded-xl shadow-lg",children:[o.jsx(LH,{className:"w-16 h-16 text-green-500 mx-auto"}),o.jsx("h2",{className:"text-3xl font-bold text-slate-800 mt-4",children:"Registration Successful!"}),o.jsx("p",{className:"text-slate-600 mt-2",children:"Your account is now active! You can log in with your credentials anytime."}),o.jsx("button",{onClick:()=>n("/login"),className:"mt-8 w-full bg-sky-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-sky-700 transition-colors",children:"Proceed to Login"}),o.jsx("button",{onClick:()=>n("/LandingPage"),className:"mt-8 w-full bg-sky-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-sky-700 transition-colors",children:"Back to Home"})]})});const ut=typeof t=="boolean",Q=ut?!!t:!0,L=()=>{if(e)return e();try{window.history.back()}catch{}};return j.useEffect(()=>{Q&&(v(!1),A(!1),R(!1),Y(!1))},[Q]),Q?o.jsxs("div",{className:ut?"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-end sm:items-center justify-center p-3 sm:p-6 animate-[fadeIn_200ms_ease-out]":"min-h-screen flex items-center justify-center lg:py-8 bg-gradient-to-br from-indigo-50/40 to-sky-50/40",role:ut?"dialog":void 0,"aria-modal":ut?"true":void 0,children:[o.jsxs("div",{className:ut?"w-full max-w-5xl lg:max-w-4xl bg-white/95 backdrop-blur-xl rounded-2xl shadow-2xl border border-white/50 overflow-hidden transform transition-all duration-300 ease-out animate-[slideUp_240ms_ease-out]":"w-full max-w-5xl mx-auto bg-white rounded-2xl shadow-sm border border-slate-200 overflow-hidden max-h-[95vh] lg:max-h-[80vh] flex flex-col",children:[o.jsxs("div",{className:"flex items-center justify-between px-3 sm:px-4 md:px-5 lg:px-4 py-2.5 sm:py-3 lg:py-2 border-b border-slate-200/70 bg-gradient-to-r from-slate-50 to-white",children:[o.jsxs("div",{className:"flex items-center gap-2 sm:gap-2.5 min-w-0 flex-1",children:[o.jsx(Hu,{className:"h-10 w-10 sm:h-12 sm:w-12 lg:h-10 lg:w-10 flex-shrink-0"}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl lg:text-2xl font-bold text-slate-800 truncate",children:"Student Registration"}),o.jsx("p",{className:"text-slate-600 text-xs sm:text-sm hidden sm:block lg:hidden",children:"Create your account to find a tutor."})]})]}),ut?o.jsx("button",{"aria-label":"Close",onClick:L,className:"p-1.5 sm:p-2 rounded-full hover:bg-slate-100 text-slate-500 hover:text-slate-700 transition-colors flex-shrink-0 ml-2",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}):o.jsx("button",{type:"button","aria-label":"Back",onClick:M=>{M.preventDefault(),M.stopPropagation(),e?e():window.history.back()},className:"p-1.5 sm:p-2 rounded-full hover:bg-slate-100 text-slate-500 hover:text-slate-700 transition-colors flex-shrink-0 ml-2",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})})})]}),o.jsx("div",{className:`overflow-y-auto px-2 sm:px-3 md:px-4 lg:px-4 py-3 sm:py-4 lg:py-3 bg-gradient-to-br from-indigo-50/40 to-sky-50/40 ${ut?"max-h-[85vh] sm:max-h-[90vh]":"flex-1"}`,children:o.jsx("div",{className:"w-full bg-white/80 backdrop-blur-lg p-3 sm:p-4 md:p-5 lg:p-4 rounded-xl sm:rounded-2xl shadow-xl border border-white/50",children:o.jsxs("form",{onSubmit:ht,noValidate:!0,className:"max-w-4xl mx-auto",children:[o.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-3 sm:p-4 md:p-4 lg:p-3 rounded-lg sm:rounded-xl border border-blue-200 mb-3 sm:mb-4 lg:mb-3",children:[o.jsxs("h3",{className:"text-base sm:text-lg lg:text-base font-semibold text-slate-800 mb-3 sm:mb-3 lg:mb-2 flex items-center",children:[o.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 mr-2 text-blue-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),o.jsx("span",{className:"truncate",children:"Email Verification"})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[o.jsxs("div",{className:"w-full",children:[o.jsx("label",{className:"block text-sm sm:text-base lg:text-sm text-slate-700 font-semibold mb-1.5 sm:mb-2 lg:mb-1",children:"University"}),o.jsxs("select",{className:"w-full px-3 sm:px-4 lg:px-3 py-2 sm:py-3 lg:py-2 text-sm sm:text-base lg:text-sm border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all max-w-[60ch]",value:h,onChange:M=>f(M.target.value?Number(M.target.value):""),required:!0,children:[o.jsx("option",{value:"",children:"Select University"}),c.map(M=>o.jsx("option",{value:M.university_id,children:M.name},M.university_id))]})]}),o.jsxs("div",{className:"w-full",children:[o.jsx("label",{className:"block text-sm sm:text-base lg:text-sm text-slate-700 font-semibold mb-1.5 sm:mb-2 lg:mb-1",children:"Email Address"}),o.jsx("input",{type:"email",value:i.email,onChange:me,disabled:!h,className:`w-full px-3 sm:px-4 lg:px-3 py-2 sm:py-3 lg:py-2 text-sm sm:text-base lg:text-sm border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all ${p?"border-red-400 bg-red-50":h?"border-slate-300":"border-slate-200 bg-slate-100 text-slate-500 cursor-not-allowed"}`,placeholder:h?"Enter your university email":"Select a university first",name:"email",required:!0}),!h&&o.jsxs("p",{className:"text-xs sm:text-sm text-slate-500 mt-1.5 sm:mt-2 flex items-start sm:items-center",children:[o.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 flex-shrink-0 mt-0.5 sm:mt-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),o.jsx("span",{className:"break-words",children:"Please select a university first to enter your email"})]})]})]}),o.jsx("div",{className:"mt-3 sm:mt-4 flex flex-col sm:flex-row items-start sm:items-center justify-end gap-3 sm:gap-4",children:o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3 w-full sm:w-auto",children:[o.jsx("button",{type:"button",onClick:Ve,disabled:!fe||jt||q,className:`w-full sm:w-auto px-4 sm:px-6 py-2 sm:py-3 text-sm sm:text-base rounded-lg font-semibold transition-all duration-300 transform flex-shrink-0 ${q?"bg-green-100 text-green-800 border-2 border-green-300 cursor-default":!fe||jt?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-indigo-600 text-white hover:bg-indigo-700 hover:scale-105 shadow-lg hover:shadow-xl"}`,title:q?"Email verified ":fe?jt?"Code expired. Please send a new code":"Input verification code":"Send verification code first",children:o.jsxs("div",{className:"flex items-center",children:[o.jsxs("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]}),"Input Code"]})}),o.jsx("button",{type:"button",onClick:Re,disabled:!!(!i.email||!h||p||B||q||fe&&!jt),className:`w-full sm:w-auto px-4 sm:px-6 py-2 sm:py-3 text-sm sm:text-base rounded-lg font-semibold transition-all duration-300 transform flex-shrink-0 ${q?"bg-green-100 text-green-800 border-2 border-green-300 cursor-default":!i.email||!h||p||fe&&!jt?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-blue-600 text-white hover:bg-blue-700 hover:scale-105 shadow-lg hover:shadow-xl"}`,title:q?"Email verified ":!i.email||!h?"Enter email and select university first":p?"Fix email domain error first":fe&&!jt?'Code already sent. Use "Input Code" button or wait for expiration':"Send verification code",children:B?o.jsxs("div",{className:"flex items-center",children:[o.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Sending Code..."]}):q?o.jsxs("div",{className:"flex items-center",children:[o.jsx("svg",{className:"w-4 h-4 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"Verified "]}):o.jsxs("div",{className:"flex items-center",children:[o.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),"Send Verification Code"]})})]})})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-12 gap-3 sm:gap-3 lg:gap-3 mb-4 sm:mb-4 lg:mb-3 items-start",children:[o.jsxs("div",{className:"w-full sm:col-span-2 lg:col-span-8",children:[o.jsx("label",{className:"block text-sm sm:text-base lg:text-sm text-slate-700 font-semibold mb-1 lg:mb-0.5",htmlFor:"name",children:"Full Name"}),o.jsx("input",{type:"text",id:"name",name:"name",value:i.name,onChange:M=>{const ee=M.target.value.replace(/[^A-Za-z\-\s]/g,"").slice(0,60);me({target:{name:"name",value:ee}})},maxLength:60,className:"w-full py-2 sm:py-2 lg:py-1.5 pl-3 sm:pl-3 lg:pl-3 pr-3 sm:pr-3 lg:pr-3 text-sm sm:text-base lg:text-sm border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all",placeholder:"Enter your full name",required:!0})]}),o.jsxs("div",{className:"w-full sm:col-span-2 lg:col-span-4",children:[o.jsx("label",{className:"block text-sm sm:text-base lg:text-sm text-slate-700 font-semibold mb-1 lg:mb-0.5",htmlFor:"password",children:"Password"}),o.jsxs("div",{className:"relative w-full",children:[o.jsx("input",{type:b?"text":"password",id:"password",name:"password",value:i.password,onChange:me,minLength:7,maxLength:21,className:`w-full px-3 sm:px-4 lg:px-3 py-2 sm:py-2.5 lg:py-1.5 pr-10 sm:pr-12 lg:pr-10 text-sm sm:text-base lg:text-sm border border-slate-300 rounded-lg \r
                  [&::-ms-reveal]:hidden \r
                  [&::-webkit-credentials-auto-fill-button]:hidden \r
                  [&::-webkit-strong-password-auto-fill-button]:hidden`,autoComplete:"new-password","data-form-type":"other","data-lpignore":"true","data-1p-ignore":"true","data-bwignore":"true",required:!0}),o.jsx("button",{type:"button",onClick:()=>N(!b),className:"absolute inset-y-0 right-0 pr-2 sm:pr-3 flex items-center text-slate-400 hover:text-slate-600",children:b?o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"h-4 w-4 sm:h-5 sm:w-5",children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}):o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"h-4 w-4 sm:h-5 sm:w-5",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.242 4.242L6.228 6.228"})})})]})]}),o.jsxs("div",{className:"w-full sm:col-span-2 lg:col-span-8",children:[o.jsx("label",{className:"block text-sm sm:text-base text-slate-700 font-semibold mb-1",children:"Course"}),o.jsxs("select",{className:`w-full px-3 sm:px-4 py-2 sm:py-2.5 text-sm sm:text-base border rounded-lg ${h?"border-slate-300":"border-slate-200 bg-slate-100 text-slate-400 cursor-not-allowed"}`,value:T,onChange:M=>{const ee=M.target.value?Number(M.target.value):"";E(ee),ee&&l(ce=>({...ce,course:""}))},disabled:!h,title:h?void 0:"Select a university first",children:[o.jsx("option",{value:"",children:"Select Course"}),Oe.map(M=>o.jsx("option",{value:M.course_id,children:M.course_name},M.course_id))]})]}),o.jsxs("div",{className:"w-full sm:col-span-2 lg:col-span-4",children:[o.jsx("label",{className:"block text-sm sm:text-base text-slate-700 font-semibold mb-1",htmlFor:"yearLevel",children:"Year Level"}),o.jsxs("select",{id:"yearLevel",name:"yearLevel",value:i.yearLevel,onChange:me,className:"w-full px-3 py-2 text-sm sm:text-base border border-slate-300 rounded-lg",required:!0,children:[o.jsx("option",{value:"",children:"Select Year Level"}),o.jsx("option",{value:"1",children:"1st Year"}),o.jsx("option",{value:"2",children:"2nd Year"}),o.jsx("option",{value:"3",children:"3rd Year"}),o.jsx("option",{value:"4",children:"4th Year"}),o.jsx("option",{value:"5",children:"5th Year"})]})]})]}),o.jsxs("div",{className:"mb-4 sm:mb-4 lg:mb-3",children:[o.jsx("label",{className:"block text-sm sm:text-base text-slate-700 font-semibold mb-1",children:"Profile Image (optional)"}),o.jsx("input",{type:"file",accept:"image/*",onChange:mt,className:"w-full px-3 sm:px-4 py-2 text-sm sm:text-base border border-slate-300 rounded-lg"}),Se&&o.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Selected: ",Se.name]}),o.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Upload a photo of yourself (JPG, PNG, or other image formats)"})]}),o.jsxs("div",{className:"pt-2",children:[o.jsxs("div",{className:"flex items-start gap-2 text-xs sm:text-sm text-slate-700",children:[o.jsx("input",{id:"accept-terms-tutee",type:"checkbox",checked:D,onChange:M=>A(M.target.checked),disabled:!$,className:`mt-1 h-4 w-4 rounded border-slate-300 text-indigo-600 focus:ring-indigo-500 flex-shrink-0 ${$?"":"opacity-50 cursor-not-allowed"}`}),o.jsxs("label",{htmlFor:"accept-terms-tutee",className:"leading-5 break-words",children:[$?"I have read and agree to the Student Terms and Conditions.":"I agree to the Student Terms and Conditions (please read the terms first).",o.jsx("button",{type:"button",className:"ml-1 sm:ml-2 text-indigo-600 hover:text-indigo-700 underline whitespace-nowrap",onClick:()=>{P(!0),W(0)},children:$?"Review Terms":"Read Terms"})]})]}),!$&&o.jsxs("p",{className:"text-xs text-amber-600 mt-1 ml-6 sm:ml-7 flex items-start sm:items-center",children:[o.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1 flex-shrink-0 mt-0.5 sm:mt-0",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),o.jsx("span",{className:"break-words",children:"Please open and read the Terms and Conditions before accepting."})]}),o.jsx("button",{type:"submit",className:`mt-3 sm:mt-4 w-full font-bold py-2.5 sm:py-3 px-4 sm:px-6 text-sm sm:text-base rounded-lg transition-colors ${q&&D&&$?"bg-indigo-600 text-white hover:bg-indigo-700":"bg-gray-400 text-gray-600 cursor-not-allowed"}`,disabled:!q||!D||!$,title:q?$?D?"Create your account":"Please accept the Terms and Conditions":"Please read the Terms and Conditions first":"Please verify your email first",children:q?"Create Account":"Verify Email to Submit"})]})]})})})]}),H&&o.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:o.jsxs("div",{className:"bg-white/95 backdrop-blur-xl rounded-2xl shadow-2xl border border-white/50 max-w-md w-full relative overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 opacity-5",children:o.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-gradient-to-br from-blue-500 to-indigo-600"})}),o.jsxs("div",{className:"relative z-10 p-6",children:[o.jsxs("div",{className:"text-center mb-6",children:[o.jsx("div",{className:"mx-auto w-16 h-16 bg-gradient-to-r from-blue-500 to-indigo-600 rounded-full flex items-center justify-center mb-4",children:o.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),o.jsx("h2",{className:"text-2xl font-bold bg-gradient-to-r from-slate-900 via-blue-800 to-indigo-800 bg-clip-text text-transparent mb-2",children:"Verify Your Email"}),o.jsxs("p",{className:"text-slate-600 text-sm",children:["We've sent a 6-digit verification code to ",o.jsx("strong",{children:i.email}),". Please check your email and enter the code below."]})]}),se&&o.jsx("div",{className:"bg-red-50/90 backdrop-blur-sm border border-red-200 text-red-600 px-4 py-3 rounded-xl text-sm font-medium shadow-lg mb-4",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("svg",{className:"w-5 h-5 mr-2 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),se]})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{htmlFor:"verification-code",className:"block text-sm font-semibold text-slate-800 mb-2",children:"Verification Code"}),o.jsx("input",{id:"verification-code",type:"text",value:z,onChange:M=>{const ee=M.target.value.replace(/\D/g,"").slice(0,6);K(ee)},placeholder:"Enter 6-digit code",className:"w-full px-4 py-3 bg-white/95 backdrop-blur-sm border-2 border-slate-200 rounded-lg focus:ring-4 focus:ring-blue-500/20 focus:border-blue-500 transition-all duration-300 placeholder-slate-400 font-medium shadow-lg hover:shadow-xl text-center text-2xl tracking-widest",maxLength:6,autoComplete:"off"})]}),o.jsxs("div",{className:"flex gap-3",children:[o.jsxs("button",{onClick:Ze,disabled:!z.trim()||z.length!==6||U,className:"flex-1 flex justify-center items-center py-3 px-6 border border-transparent rounded-lg shadow-2xl text-sm font-bold text-white bg-gradient-to-r from-blue-600 via-blue-500 to-indigo-600 hover:from-blue-700 hover:via-blue-600 hover:to-indigo-700 focus:outline-none focus:ring-4 focus:ring-blue-500/30 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 transform hover:scale-105 hover:shadow-3xl relative overflow-hidden group",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-white/20 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),U?o.jsxs("div",{className:"flex items-center relative z-10",children:[o.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),o.jsx("span",{className:"text-sm",children:"Verifying..."})]}):o.jsxs("span",{className:"relative z-10 flex items-center",children:[o.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Verify Code"]})]}),o.jsx("button",{onClick:bt,className:"px-4 py-3 border border-slate-300 rounded-lg text-sm font-medium text-slate-700 hover:bg-slate-50 transition-colors",children:"Cancel"})]}),o.jsx("div",{className:"text-center",children:o.jsx("button",{onClick:Re,disabled:B,className:"text-sm text-blue-600 hover:text-blue-800 font-medium transition-colors",children:B?"Sending...":"Didn't receive the code? Resend"})})]})]}),o.jsx("button",{onClick:bt,className:"absolute top-4 right-4 p-2 text-slate-400 hover:text-slate-600 transition-colors",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),I&&o.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:o.jsx("div",{className:"bg-white/95 backdrop-blur-xl rounded-2xl shadow-2xl border border-white/50 max-w-3xl w-full relative overflow-hidden",children:o.jsxs("div",{className:"relative z-10 p-6",children:[o.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("h2",{className:"text-xl font-bold text-slate-800",children:"Student Terms and Conditions"}),F>0&&o.jsxs("div",{className:"mt-2",children:[o.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[o.jsx("div",{className:"flex-1 bg-slate-200 rounded-full h-2 overflow-hidden",children:o.jsx("div",{className:"bg-indigo-600 h-full transition-all duration-300 ease-out",style:{width:`${Math.min(F,100)}%`}})}),o.jsxs("span",{className:"min-w-[3rem] text-right",children:[Math.round(F),"%"]})]}),F>=80&&o.jsxs("p",{className:"text-xs text-green-600 mt-1 flex items-center",children:[o.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),"You can now accept the terms"]})]})]}),o.jsx("button",{type:"button",onClick:tt,className:"p-2 text-slate-400 hover:text-slate-600 ml-4",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),o.jsxs("div",{className:"max-h-[65vh] overflow-y-auto pr-1 text-slate-700 space-y-4",onScroll:St,children:[o.jsxs("p",{children:[o.jsx("strong",{children:"Effective Date:"})," October 31, 2025"]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Platform Name:"})," TutorFriends (the Platform)"]}),o.jsx("h3",{className:"font-semibold",children:"1. Overview"}),o.jsx("p",{children:"These Terms govern your participation as a Student (Tutee) on TutorFriends. By registering and using the Platform, you agree to follow these rules and use the services responsibly."}),o.jsx("h3",{className:"font-semibold",children:"2. Account and Verification"}),o.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[o.jsx("li",{children:"Provide accurate personal and academic information."}),o.jsx("li",{children:"Use your official university email for verification."}),o.jsx("li",{children:"Do not share your account with others."})]}),o.jsx("h3",{className:"font-semibold",children:"3. Session Bookings"}),o.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[o.jsx("li",{children:"Book sessions only when you intend to attend."}),o.jsx("li",{children:"Communicate clearly with tutors about your subject needs."}),o.jsx("li",{children:"Confirm completed sessions promptly."})]}),o.jsx("h3",{className:"font-semibold",children:"4. Payments"}),o.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[o.jsx("li",{children:"Payments are handled securely via the Platform."}),o.jsx("li",{children:"Do not pay tutors outside the Platform."})]}),o.jsx("h3",{className:"font-semibold",children:"4.1. Service Fee Deduction"}),o.jsx("p",{children:"All tutor earnings processed through the platform will be subject to a 13% service fee, automatically deducted to cover system and operational costs. The remaining 87% will be issued as the tutor's final payout. This fee is fixed and non-refundable."}),o.jsx("h3",{className:"font-semibold",children:"5. Conduct"}),o.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[o.jsx("li",{children:"Be respectful and professional during sessions."}),o.jsx("li",{children:"Do not request inappropriate content or behavior."})]}),o.jsx("h3",{className:"font-semibold",children:"6. Ratings and Feedback"}),o.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[o.jsx("li",{children:"Provide fair and honest feedback after sessions."}),o.jsx("li",{children:"Do not abuse the review system."})]}),o.jsx("h3",{className:"font-semibold",children:"7. Privacy"}),o.jsx("p",{children:"Your information is handled in accordance with the Data Privacy Act of 2012. We use your data to operate and improve the Platform."}),o.jsx("h3",{className:"font-semibold",children:"8. Modifications"}),o.jsx("p",{children:"TutorFriends may update these Terms anytime. Continued use means you accept the revised version."})]}),o.jsx("div",{className:"mt-4 flex justify-end gap-2",children:o.jsx("button",{type:"button",onClick:tt,className:"px-4 py-2 border border-slate-300 rounded-lg text-sm font-medium text-slate-700 hover:bg-slate-50",children:"Close"})})]})})})]}):null},Pqe=qZ,Lqe=t=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z"})}),Mqe=t=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M13.19 8.688a4.5 4.5 0 011.242 7.244l-4.5 4.5a4.5 4.5 0 01-6.364-6.364l1.757-1.757m13.35-.622l1.757-1.757a4.5 4.5 0 00-6.364-6.364l-4.5 4.5a4.5 4.5 0 001.242 7.244"})}),Fqe=t=>o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",...t,children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17.25v-.75a.75.75 0 01.75-.75h4.5a.75.75 0 01.75.75v.75m-6 0h6M12 4.5a5.25 5.25 0 015.25 5.25c0 2.298-1.04 4.33-2.625 5.625H9.375c-1.585-1.295-2.625-3.327-2.625-5.625A5.25 5.25 0 0112 4.5z"})}),zqe=()=>{const[t,e]=j.useState(null),[n,s]=j.useState(null);return j.useEffect(()=>{let r=!0;const a=async()=>{try{const l=await we.get(`/landing/stats?_t=${Date.now()}`);r&&(e(l.data),s(null))}catch(l){r&&(t||s(l.message||"Failed to load stats"))}};a();const i=setInterval(a,1e3);return()=>{r=!1,clearInterval(i)}},[]),o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-6 mb-24",children:[["Students","Tutors","Universities","Courses","Sessions"].map((r,a)=>{const i=r.toLowerCase(),l=t?t[i]:void 0;return o.jsxs("div",{className:"bg-white/60 backdrop-blur-md rounded-2xl border border-white/50 p-6 text-center shadow-[0_4px_20px_-4px_rgba(0,0,0,0.1)] hover:shadow-[0_8px_30px_-4px_rgba(0,0,0,0.12)] hover:-translate-y-1 transition-all duration-300 group",children:[o.jsx("p",{className:"text-slate-500 text-sm font-medium uppercase tracking-wider mb-2 group-hover:text-sky-600 transition-colors",children:r}),o.jsx("p",{className:"text-3xl lg:text-4xl font-black text-slate-800 mt-1 bg-gradient-to-br from-slate-900 to-slate-700 bg-clip-text text-transparent",children:l!==void 0?l.toLocaleString():""})]},r)}),n&&o.jsx("div",{className:"col-span-2 md:col-span-5 text-center text-slate-500 text-sm",children:"Stats unavailable"})]})},ZB=[{src:"assets/images/bgp1.jpg",alt:"A tutor helping a student with a laptop in a well-lit room"},{src:"assets/images/bg2.png",alt:"A diverse group of young students studying together around a table"},{src:"assets/images/bg3.png",alt:"Students in a university lecture hall, focused on learning"},{src:"assets/images/bgp4.jpg",alt:"Online tutoring session in progress"},{src:"assets/images/bg5.png",alt:"Student studying with digital resources"}],Bqe=()=>{const[t,e]=j.useState(0);return j.useEffect(()=>{const n=setInterval(()=>{e(s=>(s+1)%ZB.length)},5e3);return()=>clearInterval(n)},[]),o.jsx("div",{className:"relative w-full h-full bg-slate-200",children:ZB.map((n,s)=>o.jsx("img",{src:n.src,alt:n.alt,className:`absolute inset-0 w-full h-full object-cover transition-opacity duration-1000 ease-in-out ${s===t?"opacity-100":"opacity-0"}`,"aria-hidden":s!==t},s))})},Uqe=({isOpen:t,onClose:e,onNavigate:n})=>(j.useEffect(()=>{if(!t)return;const s=r=>{r.key==="Escape"&&e()};return window.addEventListener("keydown",s),()=>{window.removeEventListener("keydown",s)}},[t,e]),t?o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 transition-opacity p-4",onClick:s=>{s.preventDefault(),e()},role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",children:o.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-6 md:p-8 m-0 max-w-3xl w-full flex flex-col md:flex-row gap-6 md:gap-8 max-h-[90vh] overflow-y-auto",onClick:s=>s.stopPropagation(),children:[o.jsxs("div",{role:"button",tabIndex:0,className:"flex-1 p-8 rounded-xl border-2 border-slate-200 hover:border-sky-500 hover:bg-sky-50 transition-all duration-300 cursor-pointer flex flex-col items-center text-center focus:outline-none focus:ring-2 focus:ring-sky-500 group",onClick:s=>{s.preventDefault(),n("/TuteeRegistrationPage")},onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),n("/TuteeRegistrationPage"))},children:[o.jsxs("div",{className:"relative flex items-center justify-center h-32 w-32 rounded-full bg-gradient-to-br from-sky-400 to-sky-600 mb-6 overflow-hidden shadow-lg group-hover:shadow-xl transition-all duration-300",children:[o.jsx("img",{src:"assets/images/tutee.png",alt:"Student",className:"w-full h-full object-cover rounded-full transform transition-transform duration-500 group-hover:scale-125"}),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-sky-500/20 to-transparent rounded-full"}),o.jsx("div",{className:"absolute -bottom-1 -right-1 w-8 h-8 bg-sky-500 rounded-full flex items-center justify-center shadow-md",children:o.jsx("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})})]}),o.jsx("h3",{id:"modal-title",className:"text-2xl font-bold text-slate-800 group-hover:text-sky-700 transition-colors",children:"I'm a Student"}),o.jsx("p",{className:"mt-2 text-slate-600 group-hover:text-slate-700 transition-colors",children:"Find a tutor to help you achieve your academic goals."})]}),o.jsxs("div",{role:"button",tabIndex:0,className:"flex-1 p-8 rounded-xl border-2 border-slate-200 hover:border-indigo-500 hover:bg-indigo-50 transition-all duration-300 cursor-pointer flex flex-col items-center text-center focus:outline-none focus:ring-2 focus:ring-indigo-500 group",onClick:()=>n("/TutorRegistrationPage"),onKeyDown:s=>{(s.key==="Enter"||s.key===" ")&&n("/TutorRegistrationPage")},children:[o.jsxs("div",{className:"relative flex items-center justify-center h-32 w-32 rounded-full bg-gradient-to-br from-indigo-400 to-indigo-600 mb-6 overflow-hidden shadow-lg group-hover:shadow-xl transition-all duration-300",children:[o.jsx("img",{src:"assets/images/tutor.png",alt:"Tutor",className:"w-full h-full object-cover rounded-full transform transition-transform duration-500 group-hover:scale-125"}),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-indigo-500/20 to-transparent rounded-full"}),o.jsx("div",{className:"absolute -bottom-1 -right-1 w-8 h-8 bg-indigo-500 rounded-full flex items-center justify-center shadow-md",children:o.jsx("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})})]}),o.jsx("h3",{className:"text-2xl font-bold text-slate-800 group-hover:text-indigo-700 transition-colors",children:"I'm a Tutor"}),o.jsx("p",{className:"mt-2 text-slate-600 group-hover:text-slate-700 transition-colors",children:"Share your knowledge, help students, and earn money."})]})]})}):null),JB=()=>{const t=qr(),[e,n]=j.useState(!1),[s,r]=j.useState(!1),[a,i]=j.useState(!1),[l,c]=j.useState(!1),[u,h]=j.useState(!1),[f,p]=j.useState(""),[x,y]=j.useState(!1),[v,b]=j.useState(!1),[N,S]=j.useState(!1),[k,T]=j.useState(0),[E,D]=j.useState(0),[A,I]=j.useState([]),P=F=>{p(F);const W=document.getElementById(F);if(W){const z=W.getBoundingClientRect().top+window.pageYOffset-100;window.scrollTo({top:z,behavior:"smooth"})}},$=()=>{if(typeof window>"u")return!1;const F=navigator.userAgent||navigator.vendor||window.opera,W=/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(F.toLowerCase()),q=window.innerWidth<=768;return W||q},R=F=>{if($()){if(F==="/TutorRegistrationPage"||F==="/TuteeRegistrationPage"){n(!1),t(F);return}t(F);return}if(F==="/TutorRegistrationPage"){n(!1),T(W=>W+1),b(!0);return}if(F==="/TuteeRegistrationPage"){n(!1),D(W=>W+1),S(!0);return}t(F)};return j.useEffect(()=>{let F;const W=()=>{F&&clearTimeout(F),F=setTimeout(()=>{const q=window.scrollY;y(q>50)},100)};return window.addEventListener("scroll",W,{passive:!0}),()=>{window.removeEventListener("scroll",W),F&&clearTimeout(F)}},[]),j.useEffect(()=>{let F=!0;const W=async()=>{try{const X=await we.get(`/universities?_t=${Date.now()}`);if(F){const K=(Array.isArray(X.data)?X.data:[]).filter(H=>(H.status||"active")==="active");I(K)}}catch{}};W();const q=setInterval(W,1e3);return()=>{F=!1,clearInterval(q)}},[]),o.jsxs("div",{className:"bg-white text-slate-800 antialiased min-h-screen flex flex-col",children:[" ",o.jsxs("header",{className:`relative py-3 px-4 sm:px-6 md:px-10 sticky top-0 z-50 transition-all duration-300 ${x?"bg-white/90 backdrop-blur-md border-b border-slate-200/50 shadow-lg":"bg-white/95 backdrop-blur-lg border-b border-slate-200/60 shadow-md"}`,children:[o.jsx("div",{className:`absolute inset-0 pointer-events-none transition-opacity duration-300 ${x?"bg-gradient-to-r from-sky-50/20 via-transparent to-indigo-50/20 opacity-50":"bg-gradient-to-r from-sky-50/30 via-transparent to-indigo-50/30"}`}),o.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between relative",children:[o.jsxs("div",{className:"flex items-center group cursor-pointer space-x-3",onClick:()=>t("/LandingPage"),children:[o.jsx(Hu,{className:"h-10 sm:h-12 md:h-14 lg:h-16 w-auto transition-all duration-300"}),o.jsxs("div",{className:"flex flex-col",children:[o.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold bg-gradient-to-r from-sky-600 to-indigo-600 bg-clip-text text-transparent",children:"TutorFriends"}),o.jsx("p",{className:"text-xs sm:text-sm text-slate-600 font-medium hidden sm:block",children:"Connecting Minds, Building Futures"})]})]}),o.jsxs("nav",{className:"hidden md:flex items-center space-x-6",children:[o.jsxs("button",{onClick:()=>P("how-it-works"),className:`${f==="how-it-works"?"text-sky-600":"text-slate-600"} hover:text-sky-600 transition-all duration-200 font-medium text-sm relative group focus:outline-none focus:ring-0`,children:["How It Works",o.jsx("span",{className:`absolute bottom-0 left-0 h-0.5 bg-sky-600 transition-all duration-200 ${f==="how-it-works"?"w-full":"w-0 group-hover:w-full"}`})]}),o.jsxs("button",{onClick:()=>P("features"),className:`${f==="features"?"text-sky-600":"text-slate-600"} hover:text-sky-600 transition-all duration-200 font-medium text-sm relative group focus:outline-none focus:ring-0`,children:["Features",o.jsx("span",{className:`absolute bottom-0 left-0 h-0.5 bg-sky-600 transition-all duration-200 ${f==="features"?"w-full":"w-0 group-hover:w-full"}`})]}),o.jsxs("button",{onClick:()=>P("contact"),className:`${f==="contact"?"text-sky-600":"text-slate-600"} hover:text-sky-600 transition-all duration-200 font-medium text-sm relative group focus:outline-none focus:ring-0`,children:["Contact",o.jsx("span",{className:`absolute bottom-0 left-0 h-0.5 bg-sky-600 transition-all duration-200 ${f==="contact"?"w-full":"w-0 group-hover:w-full"}`})]})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("button",{className:"hidden sm:block text-slate-600 hover:text-sky-600 transition-colors duration-200 font-medium text-sm",onClick:()=>t("/login"),children:"Login"}),o.jsx("button",{className:"hidden sm:block bg-sky-600 hover:bg-sky-700 text-white font-semibold text-sm px-4 py-2 rounded-lg transition-all duration-200 shadow-md hover:shadow-lg transform hover:-translate-y-0.5",onClick:()=>n(!0),children:"Get Started"}),o.jsx("button",{"aria-label":"Toggle menu",className:"md:hidden p-2 text-slate-700 hover:text-sky-600 transition-colors duration-200",onClick:()=>r(F=>!F),children:s?o.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}):o.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 6h16M4 12h16M4 18h16"})})})]})]}),s&&o.jsx("div",{className:"md:hidden border-t border-slate-200 bg-white/95 backdrop-blur-sm",children:o.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-3 space-y-2",children:[o.jsxs("button",{className:`block w-full text-left ${f==="how-it-works"?"text-sky-600":"text-slate-700"} hover:text-sky-600 py-2 relative group focus:outline-none focus:ring-0`,onClick:()=>{r(!1),P("how-it-works")},children:["How It Works",o.jsx("span",{className:`absolute bottom-1 left-0 h-0.5 bg-sky-600 transition-all duration-200 ${f==="how-it-works"?"w-full":"w-0 group-hover:w-full"}`})]}),o.jsxs("button",{className:`block w-full text-left ${f==="features"?"text-sky-600":"text-slate-700"} hover:text-sky-600 py-2 relative group focus:outline-none focus:ring-0`,onClick:()=>{r(!1),P("features")},children:["Features",o.jsx("span",{className:`absolute bottom-1 left-0 h-0.5 bg-sky-600 transition-all duration-200 ${f==="features"?"w-full":"w-0 group-hover:w-full"}`})]}),o.jsxs("button",{className:`block w-full text-left ${f==="contact"?"text-sky-600":"text-slate-700"} hover:text-sky-600 py-2 relative group focus:outline-none focus:ring-0`,onClick:()=>{r(!1),P("contact")},children:["Contact",o.jsx("span",{className:`absolute bottom-1 left-0 h-0.5 bg-sky-600 transition-all duration-200 ${f==="contact"?"w-full":"w-0 group-hover:w-full"}`})]}),o.jsxs("div",{className:"pt-2",children:[o.jsx("button",{className:"w-full text-slate-700 hover:text-sky-600 font-medium py-2 transition-colors duration-200",onClick:()=>{r(!1),t("/login")},children:"Login"}),o.jsx("button",{className:"mt-2 w-full bg-sky-600 hover:bg-sky-700 text-white font-semibold py-2 px-4 rounded-lg transition-all duration-200 shadow-md hover:shadow-lg",onClick:()=>{r(!1),n(!0)},children:"Get Started"})]})]})}),o.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-px bg-gradient-to-r from-transparent via-slate-200 to-transparent"})]}),o.jsxs("main",{children:[o.jsxs("section",{className:"relative overflow-hidden min-h-[85vh] h-auto flex items-center justify-center pt-10 pb-12 sm:pt-2 sm:pb-16 md:pb-16",children:[o.jsx("div",{className:"pointer-events-none absolute -top-24 -right-24 h-72 w-72 rounded-full bg-sky-100 blur-3xl"}),o.jsx("div",{className:"pointer-events-none absolute -bottom-24 -left-24 h-72 w-72 rounded-full bg-indigo-100 blur-3xl"}),o.jsxs("div",{className:"relative z-10 px-4 sm:px-6 md:px-8 lg:px-16 py-4 sm:py-6 md:py-8 grid md:grid-cols-2 gap-8 md:gap-10 lg:gap-14 items-center max-w-7xl mx-auto w-full",children:[o.jsxs("div",{className:"hero-text text-center md:text-left space-y-6 md:space-y-8 flex flex-col justify-center h-full",children:[o.jsxs("h1",{className:"text-3xl sm:text-4xl md:text-5xl lg:text-6xl font-black text-slate-900 leading-[1.1] break-words tracking-tight",children:["Where Students Come to ",o.jsx("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-sky-600 to-indigo-600",children:"Learn and Teach"})]}),o.jsx("p",{className:"text-base sm:text-lg md:text-xl text-slate-600 max-w-lg mx-auto md:mx-0 leading-relaxed font-medium",children:"Join a community where you can find the support you need or share your expertise. Become a tutee to excel, or a tutor to inspire."}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 sm:gap-4 mt-6 md:mt-8 justify-center md:justify-start",children:[o.jsx("button",{className:"bg-gradient-to-r from-sky-600 to-indigo-600 text-white font-bold py-3 px-6 sm:py-4 sm:px-8 rounded-xl shadow-lg hover:shadow-sky-500/30 hover:scale-105 transition-all duration-300 text-base sm:text-lg w-full sm:w-auto",onClick:()=>n(!0),children:"Get Started Today"}),o.jsx("button",{className:"bg-white border-2 border-slate-200 text-slate-700 font-bold py-3 px-6 sm:py-4 sm:px-8 rounded-xl hover:border-sky-600 hover:text-sky-600 hover:bg-sky-50 transition-all duration-300 text-base sm:text-lg w-full sm:w-auto",onClick:()=>P("how-it-works"),children:"Learn More"})]})]}),o.jsxs("div",{className:"hero-image aspect-[4/3] w-full rounded-3xl overflow-hidden relative shadow-[0_20px_50px_-12px_rgba(0,0,0,0.25)] border-4 sm:border-8 border-white mx-auto md:mx-0 transform md:translate-x-0",children:[o.jsx(Bqe,{}),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent pointer-events-none"})]})]})]}),o.jsx("section",{className:"px-4 sm:px-8 md:px-16 py-10 md:py-14 w-full",children:o.jsxs("div",{className:"max-w-6xl mx-auto",children:[o.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-slate-800 mb-6",children:"Partnered institutions"}),A.length>0?o.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-6 sm:gap-8",children:A.map(F=>o.jsxs("div",{className:"group flex flex-col items-center justify-start h-full p-6 bg-white rounded-2xl border border-slate-100 shadow-sm hover:shadow-[0_8px_30px_-4px_rgba(0,0,0,0.08)] transition-all duration-300 hover:-translate-y-1 min-h-[160px]",children:[o.jsx("div",{className:"flex items-center justify-center h-20 w-20 rounded-full bg-slate-50 border border-slate-100 group-hover:border-sky-100 group-hover:bg-sky-50 transition-colors duration-300 overflow-hidden mb-4 p-2",children:F.logo_url?o.jsx("img",{src:Zt(F.logo_url),alt:F.name,className:"h-full w-full object-contain transition-all duration-300"}):o.jsx("div",{className:"h-full w-full bg-slate-200"})}),o.jsx("span",{className:"font-medium text-xs sm:text-sm text-slate-600 group-hover:text-slate-900 text-center leading-snug transition-colors duration-300",title:F.name,children:F.name})]},F.university_id))}):o.jsx("p",{className:"text-slate-500",children:"No partners yet."})]})}),o.jsxs("section",{id:"features",className:"relative bg-slate-50 px-4 sm:px-8 md:px-12 lg:px-20 py-14 md:py-20 xl:py-28 w-full overflow-hidden",children:[o.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-[radial-gradient(ellipse_at_top,_var(--tw-gradient-stops))] from-sky-100/40 via-transparent to-transparent pointer-events-none"}),o.jsxs("div",{className:"max-w-7xl mx-auto relative z-10",children:[o.jsxs("div",{className:"text-center mb-16",children:[o.jsx("span",{className:"text-sky-600 font-bold tracking-wider uppercase text-sm mb-2 block",children:"Why Choose Us"}),o.jsx("h2",{className:"text-4xl sm:text-5xl font-black text-slate-900 mb-6 tracking-tight",children:"Powerful Features for Everyone"}),o.jsx("p",{className:"text-xl text-slate-600 max-w-3xl mx-auto leading-relaxed",children:"Whether you're a student seeking help or a tutor sharing knowledge, TutorFriends provides all the tools you need."})]}),o.jsx("div",{className:"overflow-x-auto mb-20",children:o.jsx(zqe,{})}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 lg:gap-12 mb-24",children:[o.jsxs("div",{className:"space-y-8",children:[o.jsxs("div",{className:"flex items-center space-x-4 mb-8",children:[o.jsx("div",{className:"h-12 w-1 bg-sky-500 rounded-full"}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-3xl font-bold text-slate-900",children:"For Students"}),o.jsx("p",{className:"text-slate-500",children:"Find the perfect tutor and excel."})]})]}),o.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-slate-100 shadow-[0_2px_10px_-4px_rgba(0,0,0,0.05)] hover:shadow-[0_8px_30px_-4px_rgba(0,0,0,0.08)] transition-all duration-300 hover:border-sky-100 group",children:[o.jsx("div",{className:"w-10 h-10 bg-sky-50 rounded-lg flex items-center justify-center mb-4 group-hover:bg-sky-500 group-hover:text-white transition-all duration-300 text-sky-600",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),o.jsx("h4",{className:"text-lg font-bold text-slate-800 mb-2",children:"Easy Registration"}),o.jsx("p",{className:"text-slate-600 text-sm leading-relaxed",children:"Quick signup with university email verification. Get started in seconds."})]}),o.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-slate-100 shadow-[0_2px_10px_-4px_rgba(0,0,0,0.05)] hover:shadow-[0_8px_30px_-4px_rgba(0,0,0,0.08)] transition-all duration-300 hover:border-sky-100 group",children:[o.jsx("div",{className:"w-10 h-10 bg-sky-50 rounded-lg flex items-center justify-center mb-4 group-hover:bg-sky-500 group-hover:text-white transition-all duration-300 text-sky-600",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})}),o.jsx("h4",{className:"text-lg font-bold text-slate-800 mb-2",children:"Smart Matching"}),o.jsx("p",{className:"text-slate-600 text-sm leading-relaxed",children:"Browse tutors filtered by your course subjects, ratings, and availability."})]}),o.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-slate-100 shadow-[0_2px_10px_-4px_rgba(0,0,0,0.05)] hover:shadow-[0_8px_30px_-4px_rgba(0,0,0,0.08)] transition-all duration-300 hover:border-sky-100 group",children:[o.jsx("div",{className:"w-10 h-10 bg-sky-50 rounded-lg flex items-center justify-center mb-4 group-hover:bg-sky-500 group-hover:text-white transition-all duration-300 text-sky-600",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})})}),o.jsx("h4",{className:"text-lg font-bold text-slate-800 mb-2",children:"Secure Payments"}),o.jsx("p",{className:"text-slate-600 text-sm leading-relaxed",children:"Pay safely via GCash. Funds are only released when you're satisfied."})]})]}),o.jsxs("div",{className:"space-y-8",children:[o.jsxs("div",{className:"flex items-center space-x-4 mb-8",children:[o.jsx("div",{className:"h-12 w-1 bg-indigo-500 rounded-full"}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-3xl font-bold text-slate-900",children:"For Tutors"}),o.jsx("p",{className:"text-slate-500",children:"Share your expertise and earn."})]})]}),o.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-slate-100 shadow-[0_2px_10px_-4px_rgba(0,0,0,0.05)] hover:shadow-[0_8px_30px_-4px_rgba(0,0,0,0.08)] transition-all duration-300 hover:border-indigo-100 group",children:[o.jsx("div",{className:"w-10 h-10 bg-indigo-50 rounded-lg flex items-center justify-center mb-4 group-hover:bg-indigo-500 group-hover:text-white transition-all duration-300 text-indigo-600",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),o.jsx("h4",{className:"text-lg font-bold text-slate-800 mb-2",children:"Quick Application"}),o.jsx("p",{className:"text-slate-600 text-sm leading-relaxed",children:"Simple vetting process. Upload your credentials and start teaching."})]}),o.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-slate-100 shadow-[0_2px_10px_-4px_rgba(0,0,0,0.05)] hover:shadow-[0_8px_30px_-4px_rgba(0,0,0,0.08)] transition-all duration-300 hover:border-indigo-100 group",children:[o.jsx("div",{className:"w-10 h-10 bg-indigo-50 rounded-lg flex items-center justify-center mb-4 group-hover:bg-indigo-500 group-hover:text-white transition-all duration-300 text-indigo-600",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),o.jsx("h4",{className:"text-lg font-bold text-slate-800 mb-2",children:"Flexible Schedule"}),o.jsx("p",{className:"text-slate-600 text-sm leading-relaxed",children:"Be your own boss. Set your availability and rates according to your needs."})]}),o.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-slate-100 shadow-[0_2px_10px_-4px_rgba(0,0,0,0.05)] hover:shadow-[0_8px_30px_-4px_rgba(0,0,0,0.08)] transition-all duration-300 hover:border-indigo-100 group",children:[o.jsx("div",{className:"w-10 h-10 bg-indigo-50 rounded-lg flex items-center justify-center mb-4 group-hover:bg-indigo-500 group-hover:text-white transition-all duration-300 text-indigo-600",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})}),o.jsx("h4",{className:"text-lg font-bold text-slate-800 mb-2",children:"Track Earnings"}),o.jsx("p",{className:"text-slate-600 text-sm leading-relaxed",children:"Transparent dashboard to monitor your sessions and income in real-time."})]})]})]})]})]}),o.jsx("section",{id:"how-it-works",className:"bg-white px-4 sm:px-8 md:px-16 py-14 md:py-20 xl:py-28 w-full",children:o.jsxs("div",{className:"max-w-6xl mx-auto",children:[o.jsxs("div",{className:"text-center mb-16",children:[o.jsx("span",{className:"text-indigo-600 font-bold tracking-wider uppercase text-sm mb-2 block",children:"Simple Process"}),o.jsx("h2",{className:"text-4xl sm:text-5xl font-black text-slate-900 mb-6",children:"How It Works"}),o.jsx("p",{className:"text-xl text-slate-600 max-w-3xl mx-auto leading-relaxed",children:"Getting academic help is easier than ever. Follow these simple steps."})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 relative",children:[o.jsx("div",{className:"hidden md:block absolute top-12 left-[16%] right-[16%] h-0.5 bg-gradient-to-r from-sky-200 via-indigo-200 to-sky-200","aria-hidden":"true"}),o.jsxs("div",{className:"text-center relative group",children:[o.jsxs("div",{className:"relative z-10 bg-white p-2 w-24 h-24 mx-auto rounded-full mb-6",children:[o.jsx("div",{className:"w-full h-full bg-sky-50 rounded-full flex items-center justify-center border-2 border-sky-100 group-hover:border-sky-500 transition-colors duration-300",children:o.jsx(Lqe,{className:"w-10 h-10 text-sky-600"})}),o.jsx("div",{className:"absolute -top-2 -right-2 w-8 h-8 bg-sky-600 text-white rounded-full flex items-center justify-center font-bold shadow-md",children:"1"})]}),o.jsx("h3",{className:"text-2xl font-bold text-slate-800 mb-3",children:"Find a Tutor"}),o.jsx("p",{className:"text-slate-600 leading-relaxed px-4",children:"Search our diverse network of qualified tutors by subject, location, and availability."})]}),o.jsxs("div",{className:"text-center relative group",children:[o.jsxs("div",{className:"relative z-10 bg-white p-2 w-24 h-24 mx-auto rounded-full mb-6",children:[o.jsx("div",{className:"w-full h-full bg-indigo-50 rounded-full flex items-center justify-center border-2 border-indigo-100 group-hover:border-indigo-500 transition-colors duration-300",children:o.jsx(Mqe,{className:"w-10 h-10 text-indigo-600"})}),o.jsx("div",{className:"absolute -top-2 -right-2 w-8 h-8 bg-indigo-600 text-white rounded-full flex items-center justify-center font-bold shadow-md",children:"2"})]}),o.jsx("h3",{className:"text-2xl font-bold text-slate-800 mb-3",children:"Connect & Book"}),o.jsx("p",{className:"text-slate-600 leading-relaxed px-4",children:"Message tutors directly to discuss your needs and easily schedule your first session."})]}),o.jsxs("div",{className:"text-center relative group",children:[o.jsxs("div",{className:"relative z-10 bg-white p-2 w-24 h-24 mx-auto rounded-full mb-6",children:[o.jsx("div",{className:"w-full h-full bg-purple-50 rounded-full flex items-center justify-center border-2 border-purple-100 group-hover:border-purple-500 transition-colors duration-300",children:o.jsx(Fqe,{className:"w-10 h-10 text-purple-600"})}),o.jsx("div",{className:"absolute -top-2 -right-2 w-8 h-8 bg-purple-600 text-white rounded-full flex items-center justify-center font-bold shadow-md",children:"3"})]}),o.jsx("h3",{className:"text-2xl font-bold text-slate-800 mb-3",children:"Get Expert Help"}),o.jsx("p",{className:"text-slate-600 leading-relaxed px-4",children:"Start learning from experienced educators and watch your grades and confidence soar!"})]})]})]})}),o.jsxs("section",{id:"contact",className:"bg-slate-900 px-4 sm:px-8 md:px-16 py-14 md:py-20 xl:py-28 w-full relative overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 bg-[radial-gradient(circle_at_bottom_left,_var(--tw-gradient-stops))] from-sky-900/20 via-slate-900 to-slate-900"}),o.jsx("div",{className:"max-w-6xl mx-auto relative z-10",children:o.jsxs("div",{className:"grid md:grid-cols-2 gap-12 items-center",children:[o.jsxs("div",{children:[o.jsx("span",{className:"text-sky-500 font-bold tracking-wider uppercase text-sm mb-2 block",children:"Support"}),o.jsx("h2",{className:"text-4xl sm:text-5xl font-black text-white mb-6",children:"Get in Touch"}),o.jsx("p",{className:"text-xl text-slate-400 leading-relaxed mb-8",children:"Have questions? We're here to help you succeed in your academic journey. Our support team is available around the clock."}),o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center space-x-4 p-4 rounded-xl bg-white/5 border border-white/10 hover:bg-white/10 transition-colors",children:[o.jsx("div",{className:"w-10 h-10 bg-sky-500/20 rounded-lg flex items-center justify-center text-sky-400",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-slate-400",children:"Email Support"}),o.jsx("p",{className:"text-white font-medium",children:"darkages38@gmail.com"})]})]}),o.jsxs("div",{className:"flex items-center space-x-4 p-4 rounded-xl bg-white/5 border border-white/10 hover:bg-white/10 transition-colors",children:[o.jsx("div",{className:"w-10 h-10 bg-indigo-500/20 rounded-lg flex items-center justify-center text-indigo-400",children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-slate-400",children:"Business Hours"}),o.jsx("p",{className:"text-white font-medium",children:"Monday - Sunday: 24hrs"})]})]}),o.jsxs("div",{className:"flex items-center space-x-4 p-4 rounded-xl bg-white/5 border border-white/10 hover:bg-white/10 transition-colors",children:[o.jsx("div",{className:"w-10 h-10 bg-purple-500/20 rounded-lg flex items-center justify-center text-purple-400",children:o.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-sm text-slate-400",children:"Location"}),o.jsx("p",{className:"text-white font-medium",children:"Philippines"})]})]})]})]}),o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-sky-500/20 to-purple-500/20 rounded-3xl blur-2xl"}),o.jsxs("div",{className:"relative bg-white/5 backdrop-blur-xl border border-white/10 p-8 rounded-3xl",children:[o.jsx("h3",{className:"text-2xl font-bold text-white mb-6",children:"Send us a message"}),o.jsxs("form",{className:"space-y-4",onSubmit:F=>F.preventDefault(),children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:"Name"}),o.jsx("input",{type:"text",className:"w-full bg-white/5 border border-white/10 rounded-lg px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-sky-500 transition-all",placeholder:"Your name"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:"Email"}),o.jsx("input",{type:"email",className:"w-full bg-white/5 border border-white/10 rounded-lg px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-sky-500 transition-all",placeholder:"your@email.com"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-400 mb-1",children:"Message"}),o.jsx("textarea",{className:"w-full bg-white/5 border border-white/10 rounded-lg px-4 py-3 text-white focus:outline-none focus:ring-2 focus:ring-sky-500 transition-all h-32",placeholder:"How can we help?"})]}),o.jsx("button",{className:"w-full bg-gradient-to-r from-sky-600 to-indigo-600 text-white font-bold py-3 rounded-xl shadow-lg hover:shadow-sky-500/25 transition-all transform hover:-translate-y-0.5",children:"Send Message"})]})]})]})]})})]})]}),o.jsxs("footer",{className:"relative bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 text-slate-300 py-8 sm:py-12 px-4 sm:px-8 overflow-hidden w-full mt-auto",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-sky-900/10 via-transparent to-indigo-900/10 pointer-events-none"}),o.jsx("div",{className:"absolute top-0 left-0 w-full h-px bg-gradient-to-r from-transparent via-sky-500/30 to-transparent"}),o.jsxs("div",{className:"max-w-6xl mx-auto relative",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6 sm:gap-8 mb-6 sm:mb-8",children:[o.jsxs("div",{children:[o.jsxs("div",{className:"flex items-center mb-4 space-x-3",children:[o.jsx(Hu,{className:"h-14 w-14 object-contain",style:{aspectRatio:"1/1"}}),o.jsxs("div",{className:"flex flex-col",children:[o.jsx("h3",{className:"text-xl font-bold text-white mb-1",children:"TutorFriends"}),o.jsx("p",{className:"text-sm text-sky-300 font-medium",children:"Connecting Minds, Building Futures"})]})]}),o.jsx("p",{className:"text-slate-400 leading-relaxed text-base",children:"Connecting students with qualified tutors for academic success. Empowering learners and educators to achieve their goals together through personalized learning experiences."})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-lg font-semibold text-white mb-4",children:"For Students"}),o.jsxs("ul",{className:"space-y-2",children:[o.jsx("li",{children:o.jsx("span",{className:"text-slate-400 hover:text-sky-400 transition-colors cursor-default",children:"Find Tutors"})}),o.jsx("li",{children:o.jsx("span",{className:"text-slate-400 hover:text-sky-400 transition-colors cursor-default",children:"Book Sessions"})}),o.jsx("li",{children:o.jsx("span",{className:"text-slate-400 hover:text-sky-400 transition-colors cursor-default",children:"Payment Guide"})}),o.jsx("li",{children:o.jsx("span",{className:"text-slate-400 hover:text-sky-400 transition-colors cursor-default",children:"Help Center"})})]})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-lg font-semibold text-white mb-4",children:"For Tutors"}),o.jsxs("ul",{className:"space-y-2",children:[o.jsx("li",{children:o.jsx("span",{className:"text-slate-400 hover:text-sky-400 transition-colors cursor-default",children:"Apply to Teach"})}),o.jsx("li",{children:o.jsx("span",{className:"text-slate-400 hover:text-sky-400 transition-colors cursor-default",children:"Tutor Resources"})}),o.jsx("li",{children:o.jsx("span",{className:"text-slate-400 hover:text-sky-400 transition-colors cursor-default",children:"Earnings"})}),o.jsx("li",{children:o.jsx("span",{className:"text-slate-400 hover:text-sky-400 transition-colors cursor-default",children:"Support"})})]})]}),o.jsxs("div",{children:[o.jsx("h4",{className:"text-lg font-semibold text-white mb-4",children:"Company"}),o.jsxs("ul",{className:"space-y-2",children:[o.jsx("li",{className:"w-max",children:o.jsx("button",{type:"button",onClick:()=>i(!0),className:"text-left text-slate-400 hover:text-sky-400 transition-colors",children:"About Us"})}),o.jsx("li",{className:"w-max",children:o.jsx("button",{type:"button",onClick:()=>c(!0),className:"text-left text-slate-400 hover:text-sky-400 transition-colors",children:"Privacy Policy"})}),o.jsx("li",{className:"w-max",children:o.jsx("button",{type:"button",onClick:()=>h(!0),className:"text-left text-slate-400 hover:text-sky-400 transition-colors",children:"Terms of Service"})}),o.jsx("li",{className:"relative group w-max",children:o.jsx("button",{type:"button",onClick:()=>{var F;return(F=document.getElementById("contact"))==null?void 0:F.scrollIntoView({behavior:"smooth"})},className:"text-left text-slate-400 hover:text-sky-400 transition-colors",children:"Contact"})})]})]})]}),o.jsx(On,{isOpen:a,onClose:()=>i(!1),title:"About TutorFriends",children:o.jsxs("div",{className:"space-y-4 text-slate-700",children:[o.jsx("p",{children:"TutorFriends is a student-to-student learning platform where university students can become tutors and help other students excel in their studies. Our platform empowers students to share their knowledge while earning money, creating a collaborative learning community within Philippine universities."}),o.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[o.jsx("li",{children:"Student-to-student learning: Students teach students, creating a peer-to-peer educational ecosystem"}),o.jsx("li",{children:"Empowerment through knowledge sharing: Any student can become a tutor and help fellow students succeed"}),o.jsx("li",{children:"University-focused community: Connecting students within the same academic environment for better understanding and support"}),o.jsx("li",{children:"Flexible earning opportunities: Students can monetize their expertise while helping others learn"})]})]})}),o.jsx(On,{isOpen:l,onClose:()=>c(!1),title:"Privacy Policy",children:o.jsxs("div",{className:"space-y-4 text-slate-700",children:[o.jsx("p",{children:"We comply with the Data Privacy Act of 2012 (Republic Act No. 10173) and process personal data lawfully and transparently. This summary explains how we collect, use, and protect information for tutor/tutee services."}),o.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[o.jsx("li",{children:"Data we collect: account details (name, email), university/course info, tutor profiles, booking and payment confirmations, and support communications."}),o.jsx("li",{children:"Purpose: enable registration, matching, booking, messaging, payment validation, and safety monitoring."}),o.jsx("li",{children:"Rights: you may access, correct, or request deletion of your data; you may also withdraw consent subject to legal/operational requirements."}),o.jsx("li",{children:"Security: we apply appropriate organizational and technical safeguards and limit access to authorized personnel only."}),o.jsx("li",{children:"Retention: we retain data only as long as needed for services and legal obligations."}),o.jsx("li",{children:"Third parties: we share data only with processors essential to our services (e.g., hosting, email) under confidentiality and DPAcompliant agreements."}),o.jsxs("li",{children:["Contact: for privacy requests or concerns, email ",o.jsx("span",{className:"font-medium",children:"darkages38@gmail.com"}),"."]})]})]})}),o.jsx(On,{isOpen:u,onClose:()=>h(!1),title:"Terms of Service",children:o.jsxs("div",{className:"space-y-4 text-slate-700",children:[o.jsx("p",{children:"By using TutorFriends, you agree to these terms. If you do not agree, please do not use the service."}),o.jsxs("ul",{className:"list-disc pl-5 space-y-1",children:[o.jsx("li",{children:"Accounts: provide accurate information and keep your credentials secure."}),o.jsx("li",{children:"Bookings and Payments: follow the posted process; submit valid proofs when required."}),o.jsx("li",{children:"Conduct: be respectful; no harassment, fraud, or academic dishonesty."}),o.jsx("li",{children:"Content: reviews and profiles must be truthful and may be moderated to ensure platform safety."}),o.jsx("li",{children:"Liability: TutorFriends facilitates connections; session outcomes remain between tutors and students subject to applicable law."}),o.jsx("li",{children:"Changes: we may update these terms and will indicate the effective date; continued use means acceptance."}),o.jsxs("li",{children:["Contact: questions about these terms? Email us at ",o.jsx("span",{className:"font-medium",children:"darkages38@gmail.com"}),"."]})]})]})}),o.jsxs("div",{className:"border-t border-gradient-to-r from-transparent via-slate-600 to-transparent pt-7 sm:pt-10 text-center relative",children:[o.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 w-24 h-px bg-gradient-to-r from-transparent via-sky-500 to-transparent"}),o.jsxs("p",{className:"text-slate-400 text-base font-medium",children:[" ",new Date().getFullYear()," TutorFriends. All rights reserved."]}),o.jsx("p",{className:"text-slate-500 text-sm mt-2",children:"Empowering education through technology"})]})]})]}),o.jsx(Uqe,{isOpen:e,onClose:()=>n(!1),onNavigate:R}),v&&o.jsx(Dqe,{isOpen:!0,onClose:()=>{b(!1),T(F=>F+1)}},`tutor-${k}`),N&&o.jsx(Pqe,{isOpen:!0,onClose:()=>{S(!1),D(F=>F+1)}},`tutee-${E}`)]})},Vqe=()=>{const t=qr(),e=()=>{t("/LandingPage")};return o.jsx("div",{className:"min-h-screen w-full bg-gradient-to-br from-indigo-50/40 to-sky-50/40",children:o.jsx(qZ,{isOpen:void 0,onClose:e})})},Wqe=()=>{const t=qr(),e=()=>{t("/LandingPage")};return o.jsx("div",{className:"min-h-screen w-full bg-gradient-to-br from-indigo-50/40 to-sky-50/40",children:o.jsx(GZ,{isOpen:void 0,onClose:e})})},KZ=j.createContext(void 0);function Hqe({children:t}){const{user:e}=kx(),[n,s]=j.useState(!1),[r,a]=j.useState("pending"),[i,l]=j.useState(null),[c,u]=j.useState(!0),h=async()=>{if(!(e!=null&&e.user_id)){u(!1);return}try{const x=await we.get(`/tutors/${e.user_id}/status`);s(x.data.is_verified),a(x.data.status),l(x.data.admin_notes||null)}catch(x){console.error("Failed to check verification status:",x),s(!1),a("pending"),l(null)}finally{u(!1)}},f=async()=>{u(!0),await h()};j.useEffect(()=>{h()},[e]);const p={isVerified:n,applicationStatus:r,adminNotes:i,isLoading:c,refreshStatus:f};return o.jsx(KZ.Provider,{value:p,children:t})}function QR(){const t=tn.useContext(KZ);if(t===void 0)throw new Error("useVerification must be used within a VerificationProvider");return t}const e7=[{to:"/tutor-dashboard/profile",icon:za,label:"Profile Setup",description:"Complete your tutor profile with bio, subjects, profile photo, and GCash payment details for students to see.",requiresApproval:!1,isFirstStep:!1},{to:"/tutor-dashboard/application",icon:bs,label:"Application & Verification",description:"Submit your credentials, certificates, and supporting documents for admin review and approval to start tutoring.",requiresApproval:!1,isFirstStep:!0},{to:"/tutor-dashboard/availability",icon:Mi,label:"Availability Scheduling",description:"Set your weekly schedule and time slots when you're available for tutoring sessions.",requiresApproval:!0,isFirstStep:!1},{to:"/tutor-dashboard/sessions",icon:Gm,label:"Booking",description:"Manage incoming booking requests, accept or decline sessions, and communicate with students.",requiresApproval:!0,isFirstStep:!1},{to:"/tutor-dashboard/session-history",icon:Zn,label:"Session History",description:"View your completed tutoring sessions and history.",requiresApproval:!0,isFirstStep:!1},{to:"/tutor-dashboard/earnings",icon:To,label:"Earnings & History",description:"View your payment history, track completed sessions, and monitor your tutoring income.",requiresApproval:!0,isFirstStep:!1}],t7=()=>{const{isVerified:t,applicationStatus:e,isLoading:n}=QR(),{user:s}=rr(),{notifications:r,unreadCount:a}=Bg(),i=vi(),[l,c]=j.useState(0),[u,h]=j.useState(0),[f,p]=j.useState(0),[x,y]=j.useState(!1),[v,b]=j.useState(new Set),[N,S]=j.useState(null),[k,T]=j.useState(null),[E,D]=j.useState(null),A=P=>{S(P),E&&clearTimeout(E);const $=setTimeout(()=>{T(P)},500);D($)},I=()=>{S(null),T(null),E&&(clearTimeout(E),D(null))};return j.useEffect(()=>()=>{E&&clearTimeout(E)},[E]),j.useEffect(()=>{let P=!0;const $=async()=>{var F,W;if(!(s!=null&&s.user_id)){P&&(c(0),h(0),p(0));return}try{const X=(F=(await we.get(`/tutors/by-user/${s.user_id}/tutor-id`)).data)==null?void 0:F.tutor_id;if(!X){P&&(c(0),h(0),p(0));return}const z=await we.get(`/tutors/${X}/booking-requests`),K=Array.isArray(z.data)?z.data:Array.isArray((W=z.data)==null?void 0:W.data)?z.data.data:[],H=K.filter(O=>["upcoming","confirmed"].includes(O.status));P&&c(H.length);const Y=K.filter(O=>O.status==="pending");P&&h(Y.length);const B=K.filter(O=>O.status==="awaiting_payment"&&!!O.payment_proof);P&&p(B.length)}catch(q){console.error("Failed to load booking data:",q),P&&(c(0),h(0),p(0))}};$();const R=()=>$();return window.addEventListener("focus",R),()=>{P=!1,window.removeEventListener("focus",R)}},[s==null?void 0:s.user_id]),j.useEffect(()=>{if(e==="rejected")y(!0);else if(e==="approved"||e==="pending"){const P=r.filter($=>{var R,F,W,q;return!$.is_read&&(((R=$.message)==null?void 0:R.toLowerCase().includes("application"))||((F=$.message)==null?void 0:F.toLowerCase().includes("verification"))||((W=$.message)==null?void 0:W.toLowerCase().includes("rejected"))||((q=$.message)==null?void 0:q.toLowerCase().includes("approved")))});y(P.length>0)}else y(!1)},[e,r]),j.useEffect(()=>{const P=i.pathname;e7.forEach(({to:$})=>{(P===$||P.startsWith($+"/"))&&b(R=>new Set(R).add($))})},[i.pathname]),o.jsxs("aside",{className:"w-64 bg-white border-r border-slate-200 flex flex-col",children:[o.jsx("div",{className:"px-4 py-4 border-b border-slate-200",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("img",{src:i4,alt:"TutorFriends Logo",className:"h-14 w-auto object-contain"}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-lg font-bold text-slate-800",children:"TutorFriends"}),o.jsx("p",{className:"text-xs text-slate-600 font-medium",children:"Connecting Minds, Building Futures"})]})]})}),o.jsx("nav",{className:"flex-1 px-3 py-4 space-y-1",children:e7.map(({to:P,icon:$,label:R,description:F,requiresApproval:W,isFirstStep:q})=>{const X=W&&!t;return o.jsxs("div",{className:"relative",children:[X?o.jsx("div",{className:"block p-3 rounded-lg transition-all duration-200 group cursor-not-allowed opacity-50",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(uL,{className:"h-5 w-5 text-slate-400"}),o.jsx("span",{className:"font-medium text-sm text-slate-400",children:R}),o.jsx(uL,{className:"h-4 w-4 text-slate-400 ml-auto"})]})}):o.jsx(Pg,{to:P,className:({isActive:z})=>`block p-3 rounded-lg transition-all duration-200 group ${z?"bg-blue-50 text-blue-700 shadow-sm":"text-slate-600 hover:bg-slate-50 hover:text-slate-900"}`,onMouseEnter:()=>A(P),onMouseLeave:I,onClick:()=>{b(z=>new Set(z).add(P))},children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx($,{className:`h-5 w-5 ${N===P?"text-blue-600":"text-slate-500"}`}),o.jsx("span",{className:"font-medium text-sm",children:R}),!X&&o.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[P==="/tutor-dashboard/sessions"&&!v.has(P)&&(u>0||f>0)&&o.jsx("div",{className:"relative",children:o.jsx("div",{className:"h-2.5 w-2.5 rounded-full bg-red-500 animate-pulse"})}),P==="/tutor-dashboard/application"&&!v.has(P)&&x&&o.jsx("div",{className:"relative",children:o.jsx("div",{className:"h-2.5 w-2.5 rounded-full bg-orange-500 animate-pulse"})}),P==="/tutor-dashboard/earnings"&&!v.has(P)&&r.some(z=>{var K,H;return!z.is_read&&(z.type==="payment"||((K=z.message)==null?void 0:K.toLowerCase().includes("payment"))||((H=z.message)==null?void 0:H.toLowerCase().includes("earnings")))})&&o.jsx("div",{className:"relative",children:o.jsx("div",{className:"h-2.5 w-2.5 rounded-full bg-green-500 animate-pulse"})}),P==="/tutor-dashboard/session-history"&&!v.has(P)&&r.some(z=>{var K,H,Y;return!z.is_read&&(((K=z.message)==null?void 0:K.toLowerCase().includes("session"))||((H=z.message)==null?void 0:H.toLowerCase().includes("completed"))||((Y=z.message)==null?void 0:Y.toLowerCase().includes("confirmation")))})&&o.jsx("div",{className:"relative",children:o.jsx("div",{className:"h-2.5 w-2.5 rounded-full bg-blue-500 animate-pulse"})}),P==="/tutor-dashboard/upcoming-sessions"&&l>0&&o.jsx("span",{className:"inline-flex items-center justify-center px-2 py-0.5 rounded-full text-xs font-semibold bg-red-600 text-white",children:l>99?"99+":l}),q&&o.jsx(o.Fragment,{children:e==="approved"?o.jsx(Zn,{className:"h-4 w-4 text-green-500"}):o.jsx(Un,{className:"h-4 w-4 text-yellow-500"})})]})]})}),k===P&&o.jsx("div",{className:"absolute left-full top-1/2 transform -translate-y-1/2 ml-4 z-50 animate-in fade-in-0 zoom-in-95 duration-200",children:o.jsx("div",{className:"bg-white border border-slate-200 rounded-2xl px-5 py-4 shadow-2xl w-80",children:o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute left-0 top-1/2 transform -translate-y-1/2 -translate-x-2",children:o.jsx("div",{className:"w-4 h-4 bg-white border-l-2 border-t-2 border-slate-200 rotate-45"})}),o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx("div",{className:"flex-shrink-0 mt-1",children:o.jsx("div",{className:"w-3 h-3 bg-gradient-to-r from-blue-500 to-blue-600 rounded-full shadow-sm"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h4",{className:"text-base font-semibold text-slate-800 mb-2 leading-tight",children:R}),o.jsx("p",{className:"text-sm text-slate-600 leading-relaxed",children:F})]})]})]})})})]},P)})}),o.jsx("div",{className:"px-4 py-3 border-t border-slate-200",children:o.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e==="approved"?o.jsx(Zn,{className:"h-4 w-4 text-green-500"}):o.jsx(Rn,{className:"h-4 w-4 text-red-500"}),o.jsx("span",{className:"text-slate-600",children:"Tutor Account"})]})})]})};var XZ={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},n7=tn.createContext&&tn.createContext(XZ),Gqe=["attr","size","title"];function qqe(t,e){if(t==null)return{};var n=Kqe(t,e),s,r;if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(r=0;r<a.length;r++)s=a[r],!(e.indexOf(s)>=0)&&Object.prototype.propertyIsEnumerable.call(t,s)&&(n[s]=t[s])}return n}function Kqe(t,e){if(t==null)return{};var n={};for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)){if(e.indexOf(s)>=0)continue;n[s]=t[s]}return n}function v2(){return v2=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},v2.apply(this,arguments)}function s7(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,s)}return n}function w2(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?s7(Object(n),!0).forEach(function(s){Xqe(t,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s7(Object(n)).forEach(function(s){Object.defineProperty(t,s,Object.getOwnPropertyDescriptor(n,s))})}return t}function Xqe(t,e,n){return e=Yqe(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yqe(t){var e=Qqe(t,"string");return typeof e=="symbol"?e:e+""}function Qqe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var s=n.call(t,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function YZ(t){return t&&t.map((e,n)=>tn.createElement(e.tag,w2({key:n},e.attr),YZ(e.child)))}function QZ(t){return e=>tn.createElement(Zqe,v2({attr:w2({},t.attr)},e),YZ(t.child))}function Zqe(t){var e=n=>{var{attr:s,size:r,title:a}=t,i=qqe(t,Gqe),l=r||n.size||"1em",c;return n.className&&(c=n.className),t.className&&(c=(c?c+" ":"")+t.className),tn.createElement("svg",v2({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,s,i,{className:c,style:w2(w2({color:t.color||n.color},n.style),t.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),a&&tn.createElement("title",null,a),t.children)};return n7!==void 0?tn.createElement(n7.Consumer,null,n=>e(n)):e(XZ)}function Jqe(t){return QZ({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2m.995-14.901a1 1 0 1 0-1.99 0A5 5 0 0 0 3 6c0 1.098-.5 6-2 7h14c-1.5-1-2-5.902-2-7 0-2.42-1.72-4.44-4.005-4.901"},child:[]}]})(t)}function r7(t){return QZ({attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2M8 1.918l-.797.161A4 4 0 0 0 4 6c0 .628-.134 2.197-.459 3.742-.16.767-.376 1.566-.663 2.258h10.244c-.287-.692-.502-1.49-.663-2.258C12.134 8.197 12 6.628 12 6a4 4 0 0 0-3.203-3.92zM14.22 12c.223.447.481.801.78 1H1c.299-.199.557-.553.78-1C2.68 10.2 3 6.88 3 6c0-2.42 1.72-4.44 4.005-4.901a1 1 0 1 1 1.99 0A5 5 0 0 1 13 6c0 .88.32 4.2 1.22 6"},child:[]}]})(t)}const ZZ=()=>{const{notifications:t,unreadCount:e,markAsRead:n,isLoading:s,refreshNotifications:r}=Bg(),a=t.filter(f=>f.type!=="upcoming_session"),i=a.filter(f=>!f.is_read).length,[l,c]=j.useState(!1),u=qr(),h=f=>{const p=new Date(f),y=new Date().getTime()-p.getTime(),v=Math.floor(y/(1e3*60)),b=Math.floor(y/(1e3*60*60)),N=Math.floor(y/(1e3*60*60*24));return v<60?`${v}m ago`:b<24?`${b}h ago`:N<7?`${N}d ago`:p.toLocaleDateString()};return o.jsxs("div",{className:"relative",children:[o.jsxs("button",{className:"p-1.5 sm:p-2 hover:bg-gray-100 active:bg-gray-200 rounded-full relative transition-colors touch-manipulation",onClick:async()=>{const f=!l;c(f),f&&await r()},style:{WebkitTapHighlightColor:"transparent"},"aria-label":`Notifications${i>0?` (${i} unread)`:""}`,children:[i>0?o.jsx(Jqe,{className:"text-blue-500 w-5 h-5 sm:w-6 sm:h-6"}):o.jsx(r7,{className:"w-5 h-5 sm:w-6 sm:h-6"}),i>0&&o.jsx("span",{className:"absolute -top-0.5 -right-0.5 sm:-top-1 sm:-right-1 bg-red-500 text-white rounded-full w-4 h-4 sm:w-5 sm:h-5 text-[10px] sm:text-xs flex items-center justify-center animate-pulse font-semibold",children:i>9?"9+":i}),a.some(f=>!f.is_read&&f.type==="payment")&&o.jsx("span",{className:"absolute bottom-0 left-0 w-2.5 h-2.5 sm:w-3 sm:h-3 bg-yellow-500 border-2 border-white rounded-full animate-pulse"})]}),l&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 z-40 sm:hidden",onClick:()=>c(!1)}),o.jsxs("div",{className:"fixed sm:absolute right-0 sm:right-0 top-14 sm:top-auto sm:mt-2 w-full sm:w-80 max-w-full sm:max-w-sm bg-white rounded-t-2xl sm:rounded-lg shadow-xl border border-gray-200 z-50 max-h-[calc(100vh-3.5rem)] sm:max-h-[400px] flex flex-col",children:[o.jsx("div",{className:"p-4 sm:p-4 flex-shrink-0 border-b border-gray-200 bg-gradient-to-r from-slate-50 to-white",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h3",{className:"text-lg sm:text-lg font-bold text-slate-800",children:"Notifications"}),o.jsx("button",{onClick:()=>c(!1),className:"p-2 rounded-lg hover:bg-gray-100 active:bg-gray-200 text-gray-500 touch-manipulation transition-colors","aria-label":"Close notifications",style:{WebkitTapHighlightColor:"transparent"},children:o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),o.jsxs("div",{className:"overflow-y-auto flex-1 min-h-0",children:[a.some(f=>!f.is_read&&f.type==="payment")&&o.jsx("div",{className:"mb-3 p-3 sm:p-3 bg-yellow-50 border-l-4 border-yellow-400 rounded-r-lg mx-3 sm:mx-4",children:o.jsx("p",{className:"text-sm sm:text-sm text-yellow-800 font-semibold",children:"You have pending payment notifications"})}),s?o.jsxs("div",{className:"animate-pulse space-y-3 sm:space-y-4 px-4 sm:px-4 pb-4 sm:pb-4",children:[o.jsx("div",{className:"h-20 sm:h-20 bg-gray-200 rounded-lg"}),o.jsx("div",{className:"h-20 sm:h-20 bg-gray-200 rounded-lg"})]}):a.length===0?o.jsxs("div",{className:"flex flex-col items-center justify-center py-12 sm:py-12 px-4",children:[o.jsx(r7,{className:"w-12 h-12 sm:w-12 sm:h-12 text-gray-300 mb-3"}),o.jsx("p",{className:"text-sm sm:text-base text-gray-500 font-medium",children:"No notifications"})]}):o.jsx("div",{className:"space-y-3 sm:space-y-3 px-4 sm:px-4 pb-4 sm:pb-4",children:a.map(f=>{var p;return o.jsxs("div",{className:`p-3 sm:p-3 rounded-xl border ${f.is_read?"bg-white border-gray-200":f.type==="payment"?"bg-yellow-50 border-yellow-300":"bg-blue-50 border-blue-200"} shadow-sm`,children:[o.jsxs("div",{className:"flex items-start justify-between gap-3",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-start gap-2",children:[f.type==="payment"&&!f.is_read&&o.jsx("span",{className:"inline-flex items-center justify-center w-2 h-2 sm:w-2 sm:h-2 mt-1.5 bg-red-500 rounded-full animate-pulse flex-shrink-0"}),o.jsx("p",{className:"text-sm sm:text-sm font-semibold text-gray-900 break-words leading-relaxed",children:f.message})]}),((p=f.metadata)==null?void 0:p.session_date)&&o.jsxs("p",{className:"text-xs sm:text-xs text-gray-600 mt-2 break-words",children:[o.jsx("span",{className:"font-medium",children:"Session:"})," ",new Date(f.metadata.session_date).toLocaleDateString(),f.metadata.session_time&&` at ${f.metadata.session_time}`]}),o.jsx("p",{className:"text-xs sm:text-xs text-gray-500 mt-2",children:h(f.created_at)})]}),f.type==="payment"&&!f.is_read&&o.jsx("span",{className:"ml-2 px-2 sm:px-2 py-1 sm:py-1 text-xs sm:text-xs font-semibold text-yellow-800 bg-yellow-200 rounded-full whitespace-nowrap flex-shrink-0",children:"Payment"})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 mt-3",children:[f.type==="payment"&&!f.is_read&&o.jsx("button",{onClick:()=>{u("/tutee-dashboard/payment"),c(!1)},className:"text-sm font-semibold text-white bg-gradient-to-r from-yellow-600 to-yellow-700 hover:from-yellow-700 hover:to-yellow-800 active:from-yellow-800 active:to-yellow-900 px-4 py-2.5 rounded-lg transition-all w-full sm:w-auto touch-manipulation shadow-md hover:shadow-lg",style:{WebkitTapHighlightColor:"transparent"},children:"Go to Payment"}),!f.is_read&&o.jsx("button",{onClick:()=>n(f.notification_id),className:"text-xs sm:text-xs text-blue-600 hover:text-blue-700 active:text-blue-800 font-medium text-left sm:text-center touch-manipulation py-2 sm:py-0",style:{WebkitTapHighlightColor:"transparent"},children:"Mark as read"})]})]},f.notification_id)})})]})]})]})]})},eKe=({onMenuClick:t})=>{const{user:e,logout:n}=rr();return o.jsx("header",{className:"bg-white border-b border-slate-200 shadow-sm sticky top-0 z-30",children:o.jsx("div",{className:"px-3 sm:px-4 md:px-6 py-2.5 sm:py-3 md:py-4",children:o.jsxs("div",{className:"flex items-center justify-between gap-2 sm:gap-3 md:gap-4",children:[o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 md:gap-4 flex-1 min-w-0",children:[o.jsx("button",{onClick:t,className:"md:hidden p-2 rounded-lg text-slate-700 hover:bg-slate-100 active:bg-slate-200 focus:outline-none focus:ring-2 focus:ring-slate-300 transition-colors flex-shrink-0 touch-manipulation","aria-label":"Open menu",style:{WebkitTapHighlightColor:"transparent"},children:o.jsx(a4,{className:"h-5 w-5 sm:h-6 sm:w-6"})}),o.jsxs("div",{className:"min-w-0 flex-1 overflow-hidden",children:[o.jsxs("h1",{className:"text-sm sm:text-base md:text-lg lg:text-xl font-semibold text-slate-800 truncate leading-tight",children:["Welcome back, ",(e==null?void 0:e.name)||"Tutor","!"]}),o.jsx("p",{className:"text-[10px] sm:text-xs md:text-sm text-slate-600 hidden sm:block truncate",children:"Manage your tutoring profile and sessions"})]})]}),o.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 md:gap-3 lg:gap-4 flex-shrink-0",children:[o.jsx(ZZ,{}),o.jsxs(at,{onClick:n,variant:"secondary",className:"flex items-center justify-center gap-1 sm:gap-1.5 md:gap-2 !px-2 sm:!px-3 !py-1.5 sm:!py-2 text-xs sm:text-sm touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:[o.jsx(r4,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 flex-shrink-0"}),o.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]})]})})})},tKe=({children:t})=>{const[e,n]=j.useState(!1);return j.useEffect(()=>{const s=()=>{window.innerWidth>=768&&n(!1)};return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),j.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[e]),o.jsx(Hqe,{children:o.jsx(o4,{children:o.jsxs("div",{className:"flex h-screen bg-slate-50 overflow-hidden",children:[o.jsx("div",{className:"hidden md:flex",children:o.jsx(t7,{})}),o.jsxs("div",{className:`fixed inset-y-0 left-0 z-50 w-64 bg-white border-r border-slate-200 md:hidden transform transition-transform duration-300 ease-in-out ${e?"translate-x-0":"-translate-x-full"}`,children:[o.jsxs("div",{className:"flex items-center justify-between h-16 px-4 border-b border-slate-200 bg-white",children:[o.jsx("h2",{className:"text-lg font-bold text-slate-800",children:"Menu"}),o.jsx("button",{onClick:()=>n(!1),className:"p-2 rounded-md text-slate-600 hover:bg-slate-100 focus:outline-none focus:ring-2 focus:ring-slate-300","aria-label":"Close menu",children:o.jsx(Rn,{className:"h-6 w-6"})})]}),o.jsx("div",{className:"overflow-y-auto h-[calc(100vh-4rem)]",children:o.jsx(t7,{})})]}),e&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden",onClick:()=>n(!1)}),o.jsxs("div",{className:"flex-1 flex flex-col min-h-0 overflow-hidden",children:[o.jsx(eKe,{onMenuClick:()=>n(!0)}),o.jsx("main",{className:"flex-1 overflow-y-auto bg-slate-50 overscroll-contain",children:o.jsx("div",{className:"max-w-7xl mx-auto px-2 sm:px-3 md:px-4 lg:px-6 pt-2 sm:pt-3 md:pt-4 lg:pt-4 pb-3 sm:pb-4 md:pb-6 lg:pb-8 w-full",children:t})})]})]})})})},nKe=()=>{const{user:t}=rr(),{isVerified:e,applicationStatus:n,adminNotes:s,refreshStatus:r}=QR(),[a,i]=j.useState(null),[l,c]=j.useState([]),[u,h]=j.useState([]),[f,p]=j.useState(""),[x,y]=j.useState(""),[v,b]=j.useState(!1),[N,S]=j.useState([]),[k,T]=j.useState(!1),[E,D]=j.useState([]),[A,I]=j.useState([]),[P,$]=j.useState(!1),[R,F]=j.useState(""),[W,q]=j.useState(""),[X,z]=j.useState(null),[K,H]=j.useState(""),[Y,B]=j.useState(""),[O,U]=j.useState(null),[J,se]=j.useState(""),[ae,fe]=j.useState(""),[ye,Te]=j.useState(null),[oe,Se]=j.useState(""),[ke,me]=j.useState(""),[re,je]=j.useState(""),[ie,Re]=j.useState(""),[Ve,Ze]=j.useState(new Set),[bt,tt]=j.useState({}),[St,mt]=j.useState({}),[jt,Oe]=j.useState([]),[ht,ut]=j.useState([]),[Q,L]=j.useState({}),[M,ee]=j.useState(!1),[ce,Ce]=j.useState(!1),[De,xt]=j.useState("");j.useEffect(()=>{t!=null&&t.user_id&&(r(),Ie())},[t]),j.useEffect(()=>{console.log("Application Status changed:",n),console.log("Is Verified:",e)},[n,e]);const Ie=async()=>{var ue,He,ot,st,_t;if(t!=null&&t.user_id)try{const Qt=await we.get(`/tutors/by-user/${t.user_id}/tutor-id`);i(Qt.data.tutor_id)}catch(Qt){console.error("Failed to fetch tutor ID:",Qt),console.log("Error details:",{status:(ue=Qt.response)==null?void 0:ue.status,message:Qt.message,responseData:(He=Qt.response)==null?void 0:He.data,url:(ot=Qt.config)==null?void 0:ot.url}),(((st=Qt.response)==null?void 0:st.status)===404||(_t=Qt.message)!=null&&_t.includes("Tutor not found"))&&(console.log("User does not have a tutor profile yet. They may need to complete tutor registration."),fe("You need to complete your tutor registration first. Please go to the tutor registration page to complete your application."))}};j.useEffect(()=>{a&&(Nt(),In(),vs(),r())},[a]),j.useEffect(()=>{a&&n==="rejected"&&!M&&ns()},[n,a]),j.useEffect(()=>{M&&a&&!X&&we.get(`/tutors/${a}/profile`).then(ue=>{const He=ue.data.profile_photo||(t==null?void 0:t.profile_image_url)||"";console.log("Fetching profile image for reapplication form:",He),He&&H(He)}).catch(ue=>{console.error("Failed to fetch profile for reapplication form:",ue)})},[M,a,X]),j.useEffect(()=>{ye&&lt()},[ye]);const lt=async()=>{try{if(ye){const ue=await we.get("/subjects",{params:{course_id:ye}});h(ue.data)}else h([])}catch(ue){console.error("Failed to fetch subjects:",ue)}},Nt=async()=>{if(a)try{const ue=await we.get(`/tutors/${a}/subject-applications`);I(ue.data)}catch(ue){console.error("Failed to fetch subject applications:",ue)}};new Set(l.map(ue=>ue.toLowerCase()));const kt=async()=>{var ue;if(a)try{const He=await we.get(`/tutors/${a}/documents`).catch(()=>({data:[]}));let ot=[];Array.isArray(He.data)?ot=He.data:Array.isArray((ue=He.data)==null?void 0:ue.data)?ot=He.data.data:He.data&&typeof He.data=="object"&&(He.data.documents&&Array.isArray(He.data.documents)?ot=He.data.documents:He.data.docs&&Array.isArray(He.data.docs)&&(ot=He.data.docs)),ot.length>0?ut(ot.map(st=>({id:st.document_id||st.id,file_url:st.file_url,file_name:st.file_name,file_type:st.file_type}))):ut([])}catch(He){console.error("Failed to fetch tutor documents:",He),ut([])}},In=async()=>{if(a)try{const ue=await we.get(`/tutors/${a}/profile`);H(ue.data.profile_photo||""),B(ue.data.gcash_number||""),se(ue.data.gcash_qr||""),ue.data.course_id&&Te(ue.data.course_id),await kt(),n==="rejected"&&await ns()}catch(ue){console.error("Failed to fetch tutor profile:",ue)}},vs=async()=>{var ue,He;if(a)try{try{const st=((await we.get("/tutors/applications").catch(()=>({data:[]}))).data||[]).find(_t=>_t.tutor_id===a);if(st!=null&&st.course_id){Te(st.course_id);return}else if((ue=st==null?void 0:st.course)!=null&&ue.course_id){Te(st.course.course_id);return}}catch(ot){console.log("Could not fetch course_id from applications endpoint:",ot)}if((He=t==null?void 0:t.tutor_profile)!=null&&He.course_id){Te(t.tutor_profile.course_id);return}}catch(ot){console.error("Failed to fetch tutor course_id:",ot)}},ns=async()=>{var ue;if(a)try{z(null),await Nt();const[He,ot]=await Promise.all([we.get(`/tutors/${a}/profile`),we.get(`/tutors/${a}/availability`)]);console.log("Profile response data:",He.data),console.log("Profile photo URL from API:",He.data.profile_photo),console.log("User profile_image_url:",t==null?void 0:t.profile_image_url),t!=null&&t.name&&Se(t.name),Re(He.data.bio||""),B(He.data.gcash_number||""),je(((ue=He.data.session_rate_per_hour)==null?void 0:ue.toString())||"");try{const Vn=((await we.get("/tutors/applications").catch(()=>({data:[]}))).data||[]).find(ki=>ki.tutor_id===a);Vn&&Vn.year_level!==void 0&&Vn.year_level!==null&&me(Vn.year_level.toString())}catch(Xt){console.error("Failed to fetch year level:",Xt)}const st=await we.get(`/tutors/${a}/subject-applications`),_t=new Set,Qt={},ds={};(st.data||[]).forEach(Xt=>{_t.add(Xt.subject_name),Qt[Xt.subject_name]=[],Xt.documents&&Array.isArray(Xt.documents)&&Xt.documents.length>0?ds[Xt.subject_name]=Xt.documents.map(Vn=>({id:Vn.id,file_url:Vn.file_url,file_name:Vn.file_name,file_type:Vn.file_type})):ds[Xt.subject_name]=[]}),Ze(_t),tt(Qt),mt(ds);try{const Xt=await we.get(`/tutors/${a}/documents`).catch(()=>({data:[]}));Xt.data&&Array.isArray(Xt.data)&&Xt.data.length>0?ut(Xt.data.map(Vn=>({id:Vn.document_id||Vn.id,file_url:Vn.file_url,file_name:Vn.file_name,file_type:Vn.file_type}))):ut([])}catch(Xt){console.error("Failed to fetch proof documents:",Xt),ut([])}if(ot.data&&Array.isArray(ot.data)){const Xt={};ot.data.forEach(Vn=>{const ki=Vn.day_of_week;Xt[ki]||(Xt[ki]={slots:[]}),Xt[ki].slots.push({startTime:Vn.start_time,endTime:Vn.end_time})}),L(Xt)}const Nr=He.data.profile_photo||(t==null?void 0:t.profile_image_url)||"";console.log("Setting profile photo URL to:",Nr),H(Nr),se(He.data.gcash_qr||""),console.log("Profile image state updated. existingProfilePhotoUrl:",Nr)}catch(He){console.error("Failed to fetch full tutor data:",He)}},qn=ue=>{const He=ue.target.files&&ue.target.files[0];He&&z(He)},Ds=ue=>{const He=ue.target.value;y(He);const ot=u.find(st=>st.subject_name.toLowerCase()===He.toLowerCase());ot?(p(ot.subject_name),b(!0)):(f&&p(""),b(!1))},Ks=ue=>{const He=ue.target.value;p(He),He===""?(b(!1),y("")):(b(!0),y(""))},ro=ue=>{ue.target.files&&D(Array.from(ue.target.files))},Xa=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Aa=ue=>{ue&&(Ze(He=>new Set(He).add(ue)),bt[ue]||tt(He=>({...He,[ue]:[]})),St[ue]||mt(He=>({...He,[ue]:[]})))},vr=ue=>{Ze(He=>{const ot=new Set(He);return ot.delete(ue),ot}),tt(He=>{const ot={...He};return delete ot[ue],ot}),mt(He=>{const ot={...He};return delete ot[ue],ot})},na=(ue,He)=>{if(He.target.files){const ot=Array.from(He.target.files);tt(st=>({...st,[ue]:[...st[ue]||[],...ot]}))}},Pr=(ue,He)=>{tt(ot=>{const st={...ot};return st[ue]&&(st[ue]=st[ue].filter((_t,Qt)=>Qt!==He)),st})},Fo=(ue,He)=>{mt(ot=>{const st={...ot};return st[ue]&&(st[ue]=st[ue].filter(_t=>_t.id!==He)),st})},Kl=ue=>{ut(He=>He.filter(ot=>ot.id!==ue))},Ya=ue=>{if(!ue)return ue;const ot=ue.trim().split(":").map(Qt=>Qt.replace(/\D/g,"")),st=ot[0]?String(Number(ot[0])).padStart(2,"0"):"00",_t=ot[1]?String(Math.min(59,Number(ot[1]))).padStart(2,"0"):"00";return`${st}:${_t}`},Si=ue=>{ue&&L(He=>({...He,[ue]:{slots:[{startTime:"09:00",endTime:"17:00"}]}}))},Qa=ue=>{L(He=>{const ot={...He};return delete ot[ue],ot})},ji=ue=>{L(He=>{const ot={...He};ot[ue]||(ot[ue]={slots:[]});const st=ot[ue].slots,_t=st.length>0?st[st.length-1]:null,Qt=_t?_t.endTime:"09:00",[ds,Nr]=Qt.split(":").map(Number),Xt=(ds*60+Nr+60)%1440,Vn=`${Math.floor(Xt/60).toString().padStart(2,"0")}:${(Xt%60).toString().padStart(2,"0")}`;return ot[ue].slots.push({startTime:Qt,endTime:Vn}),ot})},zo=(ue,He)=>{L(ot=>{const st={...ot};return st[ue]&&(st[ue].slots=st[ue].slots.filter((_t,Qt)=>Qt!==He),st[ue].slots.length===0&&delete st[ue]),st})},wr=(ue,He,ot,st)=>{const _t=Ya(st);L(Qt=>{const ds={...Qt};return ds[ue]&&ds[ue].slots[He]&&(ds[ue].slots[He][ot]=_t),ds})},us=async()=>{var He,ot;const ue=f||x.trim();if(!a||!ue||E.length===0){alert("Please select a subject (or enter a custom subject) and upload supporting documents.");return}try{const st=new FormData;st.append("subject_name",ue),E.forEach(_t=>st.append("files",_t)),await we.post(`/tutors/${a}/subject-application`,st,{headers:{"Content-Type":"multipart/form-data"}}),alert("Subject application submitted successfully! Awaiting admin approval."),T(!1),p(""),y(""),D([]),Nt()}catch(st){console.error("Failed to submit subject application:",st);const _t=((ot=(He=st.response)==null?void 0:He.data)==null?void 0:ot.message)||st.message||"Failed to submit subject application. Please try again.";alert(_t)}},Ps=ue=>{switch(ue){case"approved":return"text-green-600 bg-green-50 border-green-200";case"rejected":return"text-red-600 bg-red-50 border-red-200";default:return"text-yellow-600 bg-yellow-50 border-yellow-200"}},$a=ue=>{switch(ue){case"approved":return o.jsx(Zn,{className:"h-4 w-4"});case"rejected":return o.jsx(Rn,{className:"h-4 w-4"});default:return o.jsx(Un,{className:"h-4 w-4"})}},Lr=ue=>{if(!ue)return"";if(console.log("Getting file URL for:",ue),ue.startsWith("http://")||ue.startsWith("https://"))return console.log("URL is already absolute:",ue),ue;if(ue.startsWith("/user_profile_images/")||ue.startsWith("user_profile_images/")){const st=ue.startsWith("/")?ue:`/${ue}`,Qt=`${we.defaults.baseURL.replace("/api","")}${st}`;return console.log("Constructed profile image URL:",Qt),Qt}if(ue.startsWith("/tutor_documents/")||ue.startsWith("tutor_documents/")){const st=ue.startsWith("/")?ue:`/${ue}`,Qt=`${we.defaults.baseURL.replace("/api","")}${st}`;return console.log("Constructed tutor document URL:",Qt),Qt}const He=ue.startsWith("/")?ue.substring(1):ue,ot=`${we.defaults.baseURL}/files/${He}`;return console.log("Constructed file URL:",ot),ot},ao=(ue,He)=>{console.log("Opening document:",{fileUrl:ue,fileType:He});const ot=(He||"").toLowerCase();if(ot.startsWith("image/")||ot==="application/pdf"){console.log("Opening in preview modal:",{fileUrl:ue,fileType:ot}),F(ue),q(ot),$(!0);return}const st=ue.toLowerCase();if(st.endsWith(".pdf")){console.log("Opening PDF in preview modal:",ue),F(ue),q("application/pdf"),$(!0);return}if(/(\.png|\.jpg|\.jpeg|\.gif|\.webp)$/.test(st)){console.log("Opening image in preview modal:",ue),F(ue),q("image/*"),$(!0);return}console.log("Opening in new tab:",ue),window.open(ue,"_blank","noopener,noreferrer")};return o.jsxs("div",{className:"space-y-3 sm:space-y-4 md:space-y-6 pb-6 sm:pb-8 md:pb-10",children:[o.jsxs("div",{className:"bg-gradient-to-br from-primary-600 via-primary-700 to-primary-800 rounded-xl sm:rounded-2xl p-4 sm:p-5 md:p-6 text-white shadow-2xl relative overflow-hidden -mx-2 sm:-mx-3 md:mx-0",children:[o.jsxs("div",{className:"absolute inset-0 opacity-20",children:[o.jsx("div",{className:"absolute top-0 right-0 w-40 h-40 bg-white rounded-full -mr-20 -mt-20 blur-2xl"}),o.jsx("div",{className:"absolute bottom-0 left-0 w-32 h-32 bg-white rounded-full -ml-16 -mb-16 blur-2xl"})]}),o.jsxs("div",{className:"relative flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4",children:[o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsxs("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold mb-1 drop-shadow-lg flex items-center gap-2 sm:gap-3",children:[o.jsx(bs,{className:"h-6 w-6 sm:h-7 sm:w-7 md:h-8 md:w-8 flex-shrink-0"}),o.jsx("span",{className:"truncate",children:"Application & Verification"})]}),o.jsx("p",{className:"text-xs sm:text-sm md:text-base text-white/90 leading-tight",children:"Manage your tutor application and subject expertise"})]}),o.jsx("div",{className:`px-3 sm:px-4 md:px-5 py-1.5 sm:py-2 md:py-2.5 rounded-full text-xs sm:text-sm md:text-base font-semibold bg-white/95 backdrop-blur-sm text-slate-800 shadow-xl flex-shrink-0 border-2 ${Ps(n).replace("bg-","border-").replace(" text-"," ")}`,children:o.jsxs("div",{className:"flex items-center space-x-2",children:[$a(n),o.jsx("span",{className:"whitespace-nowrap",children:n.charAt(0).toUpperCase()+n.slice(1)})]})})]})]}),ae&&o.jsx(Lt,{className:"p-3 sm:p-4 md:p-6 border-red-200 bg-red-50 -mx-2 sm:-mx-3 md:mx-0",children:o.jsxs("div",{className:"flex items-start space-x-2 sm:space-x-3",children:[o.jsx(Rn,{className:"h-4 w-4 sm:h-5 sm:w-5 md:h-6 md:w-6 text-red-600 flex-shrink-0 mt-0.5"}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("h3",{className:"text-sm sm:text-base md:text-lg font-semibold text-red-800",children:"Tutor Profile Not Found"}),o.jsx("p",{className:"text-xs sm:text-sm md:text-base text-red-700 mt-1 break-words",children:ae}),o.jsx("p",{className:"text-[10px] sm:text-xs md:text-sm text-red-600 mt-2",children:"If you believe this is an error, please contact support or try logging out and logging back in."}),o.jsx("div",{className:"mt-2.5 sm:mt-3 md:mt-4",children:o.jsx(at,{onClick:()=>window.location.href="/tutor-registration",className:"w-full sm:w-auto bg-white text-primary-700 hover:bg-primary-50 border-2 border-primary-600 font-semibold text-xs sm:text-sm md:text-base py-1.5 sm:py-2",children:"Complete Tutor Registration"})})]})]})}),o.jsxs(Lt,{className:"p-4 sm:p-5 md:p-6 bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl shadow-xl border border-slate-200/50 hover:shadow-2xl transition-all duration-300 -mx-2 sm:-mx-3 md:mx-0",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl shadow-lg",children:o.jsx(bs,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"Main Application Status"})]}),(n==null?void 0:n.toLowerCase())==="approved"?o.jsx("div",{className:"bg-gradient-to-br from-green-50 via-emerald-50 to-green-50 border-2 border-green-200/50 rounded-xl p-4 sm:p-5 shadow-lg",children:o.jsxs("div",{className:"flex items-start sm:items-center",children:[o.jsx("div",{className:"p-2 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl mr-3 flex-shrink-0 shadow-md",children:o.jsx(Zn,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-sm sm:text-base md:text-lg font-bold text-green-800",children:"Your application has been approved!"}),o.jsx("p",{className:"text-xs sm:text-sm text-green-700 mt-1.5",children:"You can now start accepting tutoring sessions."})]})]})}):(n==null?void 0:n.toLowerCase())==="rejected"?o.jsx("div",{className:"bg-gradient-to-br from-red-50 via-rose-50 to-red-50 border-2 border-red-200/50 rounded-xl p-4 sm:p-5 shadow-lg",children:o.jsxs("div",{className:"flex items-start",children:[o.jsx("div",{className:"p-2 bg-gradient-to-br from-red-500 to-red-600 rounded-xl mr-3 flex-shrink-0 shadow-md",children:o.jsx(Rn,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-sm sm:text-base md:text-lg font-bold text-red-800",children:"Your application has been rejected"}),o.jsx("p",{className:"text-xs sm:text-sm text-red-700 mt-1.5",children:"Your application did not meet the requirements. Please review the feedback below and resubmit if needed."}),o.jsxs("div",{className:"mt-3 sm:mt-4 p-3 sm:p-4 bg-gradient-to-br from-red-100 to-red-50 border-2 border-red-300/50 rounded-xl shadow-sm",children:[o.jsx("p",{className:"text-xs sm:text-sm font-semibold text-red-800 mb-2",children:"Rejection Reason:"}),s?o.jsx("p",{className:"text-xs sm:text-sm text-red-700 leading-relaxed whitespace-pre-wrap break-words",children:s}):o.jsx("p",{className:"text-xs sm:text-sm text-red-600 italic",children:"No specific rejection reason was provided. Please review your application and ensure all requirements are met before resubmitting."})]}),o.jsx("div",{className:"mt-3 sm:mt-4",children:o.jsx(at,{onClick:async()=>{await ns(),ee(!0)},className:"w-full sm:w-auto bg-gradient-to-r from-primary-600 to-primary-700 hover:from-primary-700 hover:to-primary-800 text-white shadow-lg hover:shadow-xl text-xs sm:text-sm md:text-base py-2 sm:py-2.5 px-4 sm:px-5",children:"Reapply - Update Application"})})]})]})}):o.jsx("div",{className:"bg-gradient-to-br from-yellow-50 via-amber-50 to-yellow-50 border-2 border-yellow-200/50 rounded-xl p-4 sm:p-5 shadow-lg",children:o.jsxs("div",{className:"flex items-start sm:items-center",children:[o.jsx("div",{className:"p-2 bg-gradient-to-br from-yellow-500 to-amber-600 rounded-xl mr-3 flex-shrink-0 shadow-md",children:o.jsx(Un,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-sm sm:text-base md:text-lg font-bold text-yellow-800",children:" Your application is pending review"}),o.jsx("p",{className:"text-xs sm:text-sm text-yellow-700 mt-1.5",children:"An admin will review your documents and approve your account."})]})]})})]}),o.jsxs(Lt,{className:"p-4 sm:p-5 md:p-6 bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl shadow-xl border border-slate-200/50 hover:shadow-2xl transition-all duration-300 -mx-2 sm:-mx-3 md:mx-0",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4 mb-4",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl shadow-lg",children:o.jsx(Zn,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"Approved Subjects of Expertise"})]}),e&&o.jsxs(at,{onClick:()=>T(!0),className:"w-full sm:w-auto flex items-center justify-center space-x-2 bg-gradient-to-r from-primary-600 to-primary-700 hover:from-primary-700 hover:to-primary-800 text-white shadow-lg hover:shadow-xl text-xs sm:text-sm md:text-base py-2 sm:py-2.5 px-4 sm:px-5",children:[o.jsx(zg,{className:"h-4 w-4"}),o.jsx("span",{children:"Apply for New Subject"})]})]}),o.jsxs("div",{className:"flex flex-wrap gap-2 sm:gap-2.5",children:[A.filter(ue=>ue.status==="approved").map(ue=>o.jsxs("span",{className:"px-4 py-2 bg-gradient-to-r from-primary-600 to-primary-700 text-white rounded-xl text-sm font-semibold shadow-md hover:shadow-lg hover:scale-105 transition-all duration-200 border border-primary-400/30 flex items-center gap-1.5",children:[o.jsx(Zn,{className:"h-4 w-4 flex-shrink-0"}),o.jsx("span",{className:"break-words",children:ue.subject_name})]},ue.id)),A.filter(ue=>ue.status==="approved").length===0&&o.jsx("div",{className:"w-full text-center py-6",children:o.jsxs("div",{className:"bg-gradient-to-br from-yellow-50 to-amber-50 border-2 border-yellow-200 rounded-xl p-5 sm:p-6 shadow-lg",children:[o.jsx(Un,{className:"h-10 w-10 sm:h-12 sm:w-12 text-yellow-600 mx-auto mb-3"}),o.jsx("p",{className:"text-sm sm:text-base md:text-lg text-yellow-800 font-semibold mb-1",children:"No approved subjects yet"}),o.jsx("p",{className:"text-xs sm:text-sm text-yellow-700",children:"Your subject expertise applications are being reviewed by our admin team."})]})})]})]}),k&&o.jsxs(Lt,{className:"p-4 sm:p-5 md:p-6 bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl shadow-xl border-2 border-primary-200/50 hover:shadow-2xl transition-all duration-300 -mx-2 sm:-mx-3 md:mx-0",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl shadow-lg",children:o.jsx(zg,{className:"h-5 w-5 text-white"})}),o.jsx("h3",{className:"text-lg sm:text-xl md:text-2xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"Apply for Additional Subject"})]}),o.jsx("button",{onClick:()=>T(!1),className:"text-slate-500 hover:text-slate-700 hover:bg-slate-100 rounded-full p-2 transition-all flex-shrink-0","aria-label":"Close form",children:o.jsx(Rn,{className:"h-5 w-5"})})]}),o.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs sm:text-sm font-medium text-slate-700 mb-1.5 sm:mb-2",children:"Select Subject"}),o.jsx("p",{className:"text-[10px] sm:text-xs text-slate-500 mb-1.5 sm:mb-2",children:"Subjects are filtered based on your course. You can apply for new subjects or reapply for previously rejected subjects."}),o.jsxs("select",{className:"w-full border border-slate-300 rounded-lg px-2.5 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm",value:f,onChange:Ks,children:[o.jsx("option",{value:"",children:"Select a subject..."}),u.filter(ue=>{const He=ue.subject_name.toLowerCase(),ot=A.find(st=>st.subject_name.toLowerCase()===He);return ot?ot.status==="rejected":!0}).map(ue=>{const He=A.find(ot=>ot.subject_name.toLowerCase()===ue.subject_name.toLowerCase()&&ot.status==="rejected");return o.jsxs("option",{value:ue.subject_name,children:[ue.subject_name," ",He?"(Reapply)":""]},ue.subject_id)})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs sm:text-sm font-medium text-slate-700 mb-1.5 sm:mb-2",children:"Custom Subject (Optional)"}),o.jsxs("p",{className:"text-[10px] sm:text-xs text-slate-500 mb-1.5 sm:mb-2",children:["If your desired subject is not in the dropdown above, you can type a custom subject name here.",v&&o.jsx("span",{className:"text-primary-600 font-medium ml-1",children:" Subject found in dropdown and auto-selected!"})]}),o.jsx("input",{type:"text",className:`w-full border rounded-lg px-2.5 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm ${v?"border-slate-300 bg-slate-100 text-slate-500 cursor-not-allowed":"border-slate-300 bg-white"}`,placeholder:v?"Custom input disabled - subject found in dropdown":"Type your custom subject name (e.g., Advanced Calculus, Organic Chemistry)",value:x,onChange:Ds,disabled:v})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs sm:text-sm font-medium text-slate-700 mb-1.5 sm:mb-2",children:"Supporting Documents"}),o.jsx("input",{type:"file",multiple:!0,accept:".pdf,.png,.jpg,.jpeg",onChange:ro,className:"w-full border border-slate-300 rounded-lg px-2.5 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm file:mr-2 file:py-1 file:px-2 file:rounded file:border-0 file:text-xs file:font-semibold file:bg-primary-50 file:text-primary-700 hover:file:bg-primary-100"}),E.length>0&&o.jsx("ul",{className:"list-disc list-inside text-xs sm:text-sm text-slate-600 mt-2 space-y-1",children:E.map((ue,He)=>o.jsx("li",{className:"break-words",children:ue.name},He))})]}),(f||x.trim())&&o.jsxs("div",{className:"bg-primary-50 border border-primary-200 rounded-lg p-2.5 sm:p-3",children:[o.jsx("h4",{className:"text-xs sm:text-sm font-medium text-primary-800 mb-1",children:"Subject to be submitted:"}),o.jsxs("p",{className:"text-xs sm:text-sm text-primary-700 break-words",children:[f||x.trim(),f&&x.trim()&&o.jsx("span",{className:"text-[10px] sm:text-xs text-primary-600 ml-2",children:"(Using dropdown selection)"}),!f&&x.trim()&&o.jsx("span",{className:"text-[10px] sm:text-xs text-primary-600 ml-2",children:"(Custom subject)"})]})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[o.jsx(at,{onClick:us,disabled:!f&&!x.trim()||E.length===0,className:"w-full sm:w-auto bg-gradient-to-r from-primary-600 to-primary-700 hover:from-primary-700 hover:to-primary-800 text-white shadow-lg hover:shadow-xl text-xs sm:text-sm md:text-base py-2 sm:py-2.5 px-4 sm:px-5",children:"Submit Application"}),o.jsx(at,{variant:"secondary",onClick:()=>T(!1),className:"w-full sm:w-auto text-xs sm:text-sm md:text-base py-2 sm:py-2.5 px-4 sm:px-5",children:"Cancel"})]})]})]}),o.jsxs(Lt,{className:"p-4 sm:p-5 md:p-6 bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl shadow-xl border border-slate-200/50 hover:shadow-2xl transition-all duration-300 -mx-2 sm:-mx-3 md:mx-0",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl shadow-lg",children:o.jsx(bs,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"Supporting Documents"})]}),ht.length>0?o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2.5 sm:gap-3",children:ht.map(ue=>o.jsxs("div",{className:"flex items-center justify-between bg-gradient-to-r from-slate-50 via-primary-50/50 to-slate-50 rounded-lg p-3 sm:p-3.5 border-2 border-slate-200/50 hover:border-primary-300 hover:shadow-md transition-all duration-200",children:[o.jsxs("div",{className:"flex items-center min-w-0 flex-1",children:[o.jsx("div",{className:"p-1.5 sm:p-2 bg-gradient-to-br from-primary-100 to-primary-200 rounded-lg mr-2.5 flex-shrink-0",children:o.jsx(bs,{className:"h-4 w-4 sm:h-5 sm:w-5 text-primary-600"})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-xs sm:text-sm font-semibold text-slate-800 truncate",title:ue.file_name||"Document",children:ue.file_name||"Document"}),o.jsx("p",{className:"text-[10px] sm:text-xs text-slate-500 truncate",children:ue.file_type||"File"})]})]}),o.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 flex-shrink-0 ml-2",children:[o.jsx("button",{type:"button",onClick:()=>ao(Lr(ue.file_url),ue.file_type),className:"text-[10px] sm:text-xs px-2 sm:px-2.5 py-1 sm:py-1.5 bg-gradient-to-r from-primary-600 to-primary-700 text-white hover:from-primary-700 hover:to-primary-800 rounded-lg font-semibold shadow-sm hover:shadow-md transition-all duration-200 whitespace-nowrap",title:"View document",children:"View"}),o.jsx("a",{href:Lr(ue.file_url),download:!0,className:"text-[10px] sm:text-xs px-2 sm:px-2.5 py-1 sm:py-1.5 bg-gradient-to-r from-slate-600 to-slate-700 text-white hover:from-slate-700 hover:to-slate-800 rounded-lg font-semibold shadow-sm hover:shadow-md transition-all duration-200 whitespace-nowrap",title:"Download document",children:"Download"})]})]},ue.id))}):o.jsxs("div",{className:"text-center py-6 sm:py-8 lg:py-10",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-14 h-14 sm:w-18 sm:h-18 lg:w-20 lg:h-20 bg-slate-100 rounded-full mb-3",children:o.jsx(bs,{className:"w-7 h-7 sm:w-9 sm:h-9 lg:w-10 lg:h-10 text-slate-400"})}),o.jsx("p",{className:"text-sm sm:text-base text-slate-500 font-medium",children:"No supporting documents uploaded yet."}),o.jsx("p",{className:"text-xs sm:text-sm text-slate-400 mt-2",children:"Upload documents such as National ID, academic transcripts, certifications, or student ID to verify your credibility as a tutor."})]})]}),A.length>0&&o.jsxs(Lt,{className:"p-4 sm:p-5 md:p-6 bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl shadow-xl border border-slate-200/50 hover:shadow-2xl transition-all duration-300 -mx-2 sm:-mx-3 md:mx-0",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl shadow-lg",children:o.jsx(bs,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"Subject Application History"})]}),o.jsx("div",{className:"space-y-3 sm:space-y-4",children:A.map(ue=>o.jsxs("div",{className:"p-4 sm:p-5 bg-gradient-to-br from-slate-50 via-white to-slate-50 rounded-xl border-2 border-slate-200/50 hover:border-primary-300 hover:shadow-lg transition-all duration-200",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-0 mb-2",children:[o.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 sm:gap-2 md:gap-3 min-w-0 flex-1",children:[o.jsx("span",{className:"font-medium text-xs sm:text-sm md:text-base text-slate-800 break-words",children:ue.subject_name}),o.jsx("span",{className:`px-1.5 sm:px-2 py-0.5 sm:py-1 rounded-full text-[10px] sm:text-xs font-medium border flex-shrink-0 ${Ps(ue.status)}`,children:o.jsxs("div",{className:"flex items-center space-x-0.5 sm:space-x-1",children:[$a(ue.status),o.jsx("span",{children:ue.status.charAt(0).toUpperCase()+ue.status.slice(1)})]})})]}),o.jsxs("span",{className:"text-xs sm:text-sm text-slate-500 whitespace-nowrap",children:["Applied: ",new Date(ue.created_at).toLocaleDateString()]})]}),ue.status==="rejected"&&o.jsx("div",{className:"mt-4 p-4 sm:p-5 bg-gradient-to-br from-red-50 via-rose-50 to-red-50 border-2 border-red-200/50 rounded-xl shadow-lg",children:o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx("div",{className:"p-2 bg-gradient-to-br from-red-500 to-red-600 rounded-xl flex-shrink-0 shadow-md",children:o.jsx(Rn,{className:"h-5 w-5 text-white"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 mb-3",children:[o.jsx("p",{className:"text-sm sm:text-base font-bold text-red-800",children:" Application Rejected"}),o.jsxs("span",{className:"text-xs sm:text-sm text-red-600 whitespace-nowrap font-semibold",children:["Rejected: ",new Date(ue.updated_at).toLocaleDateString()]})]}),ue.admin_notes?o.jsxs("div",{children:[o.jsx("p",{className:"text-xs sm:text-sm font-semibold text-red-700 mb-2 uppercase tracking-wide",children:"Admin Feedback:"}),o.jsx("div",{className:"bg-gradient-to-br from-red-100 to-red-50 border-2 border-red-300/50 rounded-xl p-3 sm:p-4 shadow-sm",children:o.jsx("p",{className:"text-xs sm:text-sm text-red-800 leading-relaxed break-words",children:ue.admin_notes})})]}):o.jsxs("div",{children:[o.jsx("p",{className:"text-xs sm:text-sm font-semibold text-red-700 mb-2",children:"No specific feedback provided"}),o.jsx("p",{className:"text-xs sm:text-sm text-red-600",children:"The application was rejected based on current requirements and standards. You can reapply with additional documentation or qualifications."})]}),o.jsx("div",{className:"mt-4 p-3 bg-gradient-to-br from-red-100 to-red-50 border-2 border-red-200/50 rounded-xl",children:o.jsx("p",{className:"text-xs sm:text-sm text-red-700 font-semibold",children:' You can reapply for this subject by clicking "Apply for New Subject" above.'})})]})]})}),ue.status==="approved"&&o.jsx("div",{className:"mt-4 p-4 sm:p-5 bg-gradient-to-br from-green-50 via-emerald-50 to-green-50 border-2 border-green-200/50 rounded-xl shadow-lg",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"p-2 bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl flex-shrink-0 shadow-md",children:o.jsx(Zn,{className:"h-5 w-5 text-white"})}),o.jsx("p",{className:"text-sm sm:text-base text-green-800 font-semibold",children:"This subject is now part of your approved expertise areas!"})]})}),ue.status==="pending"&&o.jsx("div",{className:"mt-4 p-4 sm:p-5 bg-gradient-to-br from-yellow-50 via-amber-50 to-yellow-50 border-2 border-yellow-200/50 rounded-xl shadow-lg",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"p-2 bg-gradient-to-br from-yellow-500 to-amber-600 rounded-xl flex-shrink-0 shadow-md",children:o.jsx(Un,{className:"h-5 w-5 text-white"})}),o.jsx("p",{className:"text-sm sm:text-base text-yellow-800 font-semibold",children:"Your application is being reviewed by our admin team."})]})}),ue.documents&&ue.documents.length>0&&o.jsxs("div",{className:"mt-4",children:[o.jsx("h5",{className:"text-xs sm:text-sm font-semibold text-slate-700 mb-3 uppercase tracking-wide",children:"Supporting Documents:"}),o.jsx("ul",{className:"space-y-2",children:ue.documents.map(He=>o.jsxs("li",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 bg-gradient-to-r from-slate-50 via-primary-50/50 to-slate-50 rounded-xl p-3 border-2 border-slate-200/50 hover:border-primary-300 hover:shadow-md transition-all",children:[o.jsxs("div",{className:"flex items-center min-w-0 flex-1",children:[o.jsx("div",{className:"p-1.5 bg-gradient-to-br from-primary-100 to-primary-200 rounded-lg mr-2.5 flex-shrink-0",children:o.jsx(bs,{className:"h-4 w-4 text-primary-600"})}),o.jsx("button",{type:"button",onClick:()=>ao(Lr(He.file_url),He.file_type),className:"text-primary-700 hover:text-primary-900 hover:underline truncate text-left text-xs sm:text-sm font-semibold",title:"Open file",children:He.file_name})]}),o.jsx("div",{className:"flex items-center gap-2 flex-shrink-0 ml-0 sm:ml-4 w-full sm:w-auto",children:o.jsx("button",{type:"button",onClick:()=>ao(Lr(He.file_url),He.file_type),className:"text-xs px-3 py-1.5 bg-gradient-to-r from-primary-600 to-primary-700 text-white hover:from-primary-700 hover:to-primary-800 rounded-lg font-semibold shadow-md hover:shadow-lg transition-all",children:"Open"})})]},He.id))})]})]},ue.id))})]}),n==="rejected"&&M&&o.jsxs(Lt,{className:"p-4 sm:p-5 md:p-6 bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl shadow-xl border-2 border-primary-200/50 hover:shadow-2xl transition-all duration-300 -mx-2 sm:-mx-3 md:mx-0",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4 mb-4",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl shadow-lg",children:o.jsx(fh,{className:"h-5 w-5 text-white"})}),o.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"Update & Resubmit Your Application"})]}),o.jsxs(at,{variant:"secondary",onClick:()=>ee(!1),className:"w-full sm:w-auto flex items-center justify-center text-xs sm:text-sm md:text-base py-2 sm:py-2.5 px-4 sm:px-5",children:[o.jsx(Rn,{className:"h-4 w-4 mr-2"}),"Cancel"]})]}),o.jsxs("div",{className:"space-y-3 sm:space-y-4 md:space-y-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-xs sm:text-sm font-medium text-slate-700 mb-1.5 sm:mb-2",children:["Full Name ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",className:"w-full border border-slate-300 rounded-lg px-2.5 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm md:text-base",value:oe,onChange:ue=>{const He=ue.target.value.replace(/[^A-Za-z\s\-']/g,"").slice(0,60);Se(He)},required:!0})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-xs sm:text-sm font-medium text-slate-700 mb-1.5 sm:mb-2",children:["Year Level ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsxs("select",{className:"w-full border border-slate-300 rounded-lg px-2.5 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm md:text-base",value:ke,onChange:ue=>me(ue.target.value),required:!0,children:[o.jsx("option",{value:"",children:"Select year level"}),o.jsx("option",{value:"1",children:"1st Year"}),o.jsx("option",{value:"2",children:"2nd Year"}),o.jsx("option",{value:"3",children:"3rd Year"}),o.jsx("option",{value:"4",children:"4th Year"}),o.jsx("option",{value:"5",children:"5th Year"})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-xs sm:text-sm font-medium text-slate-700 mb-1.5 sm:mb-2",children:["GCash Number ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"text",className:"w-full border border-slate-300 rounded-lg px-2.5 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm md:text-base",placeholder:"09XX XXX XXXX",value:Y,onChange:ue=>{const He=ue.target.value.replace(/[^0-9]/g,"");if(He.length===0)B("");else if(He.startsWith("09"))B(He.slice(0,11));else if(He==="0")B("0");else if(He.startsWith("0")&&He[1]!=="9")B("0");else{if(Y&&Y.startsWith("09"))return;B("")}},maxLength:11,required:!0}),Y&&(!Y.startsWith("09")||Y.length!==11)&&o.jsx("p",{className:"text-xs text-red-600 mt-1",children:"GCash number must be 11 digits starting with 09"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-xs sm:text-sm font-medium text-slate-700 mb-1.5 sm:mb-2",children:["Session Rate Per Hour (PHP) ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("input",{type:"number",className:"w-full border border-slate-300 rounded-lg px-2.5 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm md:text-base",placeholder:"e.g., 300",value:re,onChange:ue=>je(ue.target.value),min:"0",step:"0.01",required:!0})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-xs sm:text-sm font-medium text-slate-700 mb-1.5 sm:mb-2",children:["Bio ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("textarea",{className:"w-full border border-slate-300 rounded-lg px-2.5 sm:px-3 py-1.5 sm:py-2 min-h-[80px] sm:min-h-[100px] text-xs sm:text-sm md:text-base",value:ie,onChange:ue=>{const He=ue.target.value.replace(/[^A-Za-z\s]/g,"");Re(He)},placeholder:"Tell us about yourself and your tutoring experience...",required:!0})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs sm:text-sm font-medium text-slate-700 mb-1.5 sm:mb-2",children:"Profile Photo"}),o.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2.5 sm:gap-3 md:gap-4",children:[o.jsx("div",{className:"relative w-16 h-16 sm:w-20 sm:h-20 md:w-24 md:h-24 rounded-full overflow-hidden bg-slate-200 flex items-center justify-center border-2 sm:border-4 border-white shadow-lg flex-shrink-0 mx-auto sm:mx-0",children:X?o.jsx("img",{src:URL.createObjectURL(X),alt:"Profile Preview",className:"w-full h-full object-cover",style:{aspectRatio:"1/1"}}):K?o.jsx("img",{src:Lr(K),alt:"Profile",className:"w-full h-full object-cover",style:{aspectRatio:"1/1"},onError:ue=>{console.error("Failed to load profile image. Original URL:",K),console.error("Constructed URL:",Lr(K)),console.error("API Base URL:",we.defaults.baseURL),ue.target.style.display="none"},onLoad:()=>{console.log("Profile image loaded successfully:",Lr(K))}}):o.jsx(za,{className:"h-8 w-8 sm:h-10 sm:w-10 md:h-12 md:w-12 text-slate-400"})}),o.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-3 md:gap-4 flex-1 w-full sm:w-auto",children:[o.jsxs("label",{className:"flex items-center justify-center space-x-1.5 sm:space-x-2 px-3 sm:px-4 py-1.5 sm:py-2 bg-primary-600 text-white rounded-lg cursor-pointer hover:bg-primary-700 active:bg-primary-800 transition-colors text-xs sm:text-sm md:text-base w-full sm:w-auto touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:[o.jsx($1,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 md:h-5 md:w-5"}),o.jsx("span",{children:"Upload Photo"}),o.jsx("input",{type:"file",accept:"image/*",onChange:qn,className:"hidden"})]}),X&&o.jsx("button",{onClick:()=>z(null),className:"bg-red-600 text-white px-3 py-1.5 sm:py-2 rounded-lg hover:bg-red-700 active:bg-red-800 transition-colors flex items-center justify-center text-xs sm:text-sm w-full sm:w-auto touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:o.jsx(Rn,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})})]})]})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-xs sm:text-sm font-medium text-slate-700 mb-1.5 sm:mb-2",children:["Subjects of Expertise ",o.jsx("span",{className:"text-red-500",children:"*"})]}),o.jsx("p",{className:"text-[10px] sm:text-xs text-slate-500 mb-1.5 sm:mb-2",children:"You can add new subjects or reapply for previously rejected subjects. Each subject requires supporting documents."}),o.jsxs("div",{className:"mb-3 sm:mb-4",children:[o.jsxs("select",{className:"w-full border border-slate-300 rounded-lg px-2.5 sm:px-3 py-1.5 sm:py-2 mb-2 text-xs sm:text-sm",value:f,onChange:Ks,children:[o.jsx("option",{value:"",children:"Select a subject..."}),u.filter(ue=>{const He=ue.subject_name.toLowerCase();return!Array.from(Ve).some(ot=>ot.toLowerCase()===He)}).map(ue=>o.jsx("option",{value:ue.subject_name,children:ue.subject_name},ue.subject_id))]}),o.jsx(at,{onClick:()=>{f&&(Aa(f),p(""))},disabled:!f,className:"w-full text-xs sm:text-sm py-1.5 sm:py-2",children:"Add Subject"}),o.jsxs("div",{className:"mt-2",children:[o.jsx("input",{type:"text",className:"w-full border border-slate-300 rounded-lg px-2.5 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm",placeholder:"Or enter a custom subject name",value:x,onChange:ue=>{const He=ue.target.value.replace(/[^A-Za-z\s\-()]/g,"");y(He);const ot=u.find(st=>st.subject_name.toLowerCase()===He.toLowerCase());ot?(p(ot.subject_name),b(!0)):(f&&p(""),b(!1))}}),o.jsx(at,{onClick:()=>{const ue=x.trim();ue&&!Array.from(Ve).some(He=>He.toLowerCase()===ue.toLowerCase())&&(Aa(ue),y(""))},disabled:!x.trim(),variant:"secondary",className:"w-full mt-2 text-xs sm:text-sm py-1.5 sm:py-2",children:"Add Custom Subject"})]})]}),Array.from(Ve).length>0&&o.jsx("div",{className:"space-y-3 sm:space-y-4 mt-3 sm:mt-4",children:Array.from(Ve).map(ue=>o.jsxs("div",{className:"border border-slate-200 rounded-lg p-2.5 sm:p-3 md:p-4 bg-slate-50",children:[o.jsxs("div",{className:"flex items-center justify-between mb-2",children:[o.jsx("span",{className:"font-medium text-xs sm:text-sm md:text-base text-slate-800 break-words flex-1 min-w-0 pr-2",children:ue}),o.jsx("button",{type:"button",onClick:()=>vr(ue),className:"text-red-600 hover:text-red-800 active:text-red-900 flex-shrink-0 p-1 touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},"aria-label":"Remove subject",children:o.jsx(Rn,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-[10px] sm:text-xs font-medium text-slate-700 mb-1",children:["Supporting Documents for ",ue]}),(St[ue]||[]).length>0&&o.jsxs("div",{className:"mb-3",children:[o.jsx("p",{className:"text-[10px] sm:text-xs text-slate-600 mb-1.5 font-medium",children:"Previously uploaded documents:"}),o.jsx("ul",{className:"space-y-1.5",children:(St[ue]||[]).map(He=>o.jsxs("li",{className:"flex items-center justify-between text-xs sm:text-sm text-slate-700 bg-blue-50 border border-blue-200 p-1.5 sm:p-2 rounded",children:[o.jsxs("div",{className:"flex items-center min-w-0 flex-1",children:[o.jsx(bs,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 text-blue-600 mr-2 flex-shrink-0"}),o.jsx("button",{type:"button",onClick:()=>ao(Lr(He.file_url),He.file_type),className:"text-blue-700 hover:text-blue-900 hover:underline truncate text-left flex-1 min-w-0",title:"Open file",children:He.file_name})]}),o.jsx("button",{type:"button",onClick:()=>Fo(ue,He.id),className:"text-red-600 hover:text-red-800 active:text-red-900 flex-shrink-0 p-1 touch-manipulation ml-2",style:{WebkitTapHighlightColor:"transparent"},"aria-label":"Remove document",title:"Remove this document",children:o.jsx(Rn,{className:"h-3 w-3 sm:h-3.5 sm:w-3.5"})})]},He.id))})]}),o.jsx("input",{type:"file",multiple:!0,accept:".pdf,.png,.jpg,.jpeg",onChange:He=>na(ue,He),className:"w-full border border-slate-300 rounded-lg px-2 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm file:mr-2 file:py-1 file:px-2 file:rounded file:border-0 file:text-xs file:font-semibold file:bg-primary-50 file:text-primary-700 hover:file:bg-primary-100"}),(bt[ue]||[]).length>0&&o.jsxs("div",{className:"mt-2",children:[o.jsx("p",{className:"text-[10px] sm:text-xs text-slate-600 mb-1.5 font-medium",children:"New documents to upload:"}),o.jsx("ul",{className:"space-y-1",children:(bt[ue]||[]).map((He,ot)=>o.jsxs("li",{className:"flex items-center justify-between text-xs sm:text-sm text-slate-600 bg-white p-1.5 sm:p-2 rounded border border-slate-200",children:[o.jsx("span",{className:"break-words flex-1 min-w-0 pr-2",children:He.name}),o.jsx("button",{type:"button",onClick:()=>Pr(ue,ot),className:"text-red-600 hover:text-red-800 active:text-red-900 flex-shrink-0 p-1 touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},"aria-label":"Remove file",children:o.jsx(Rn,{className:"h-3 w-3 sm:h-3.5 sm:w-3.5"})})]},ot))})]})]})]},ue))})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-xs sm:text-sm font-medium text-slate-700 mb-1.5 sm:mb-2",children:["Proof Documents ",o.jsx("span",{className:"text-red-500",children:"*"})]}),ht.length>0&&o.jsxs("div",{className:"mb-3",children:[o.jsx("p",{className:"text-[10px] sm:text-xs text-slate-600 mb-1.5 font-medium",children:"Previously uploaded documents:"}),o.jsx("ul",{className:"space-y-1.5",children:ht.map(ue=>o.jsxs("li",{className:"flex items-center justify-between text-xs sm:text-sm text-slate-700 bg-blue-50 border border-blue-200 p-1.5 sm:p-2 rounded",children:[o.jsxs("div",{className:"flex items-center min-w-0 flex-1",children:[o.jsx(bs,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 text-blue-600 mr-2 flex-shrink-0"}),o.jsx("button",{type:"button",onClick:()=>ao(Lr(ue.file_url),ue.file_type),className:"text-blue-700 hover:text-blue-900 hover:underline truncate text-left flex-1 min-w-0",title:"Open file",children:ue.file_name})]}),o.jsx("button",{type:"button",onClick:()=>Kl(ue.id),className:"text-red-600 hover:text-red-800 active:text-red-900 flex-shrink-0 p-1 touch-manipulation ml-2",style:{WebkitTapHighlightColor:"transparent"},"aria-label":"Remove document",title:"Remove this document",children:o.jsx(Rn,{className:"h-3 w-3 sm:h-3.5 sm:w-3.5"})})]},ue.id))})]}),o.jsx("input",{type:"file",multiple:!0,accept:".pdf,.png,.jpg,.jpeg",onChange:ue=>{ue.target.files&&Oe(Array.from(ue.target.files))},className:"w-full border border-slate-300 rounded-lg px-2.5 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm file:mr-2 file:py-1 file:px-2 file:rounded file:border-0 file:text-xs file:font-semibold file:bg-primary-50 file:text-primary-700 hover:file:bg-primary-100"}),jt.length>0&&o.jsxs("div",{className:"mt-2",children:[o.jsx("p",{className:"text-[10px] sm:text-xs text-slate-600 mb-1.5 font-medium",children:"New documents to upload:"}),o.jsx("ul",{className:"list-disc list-inside text-xs sm:text-sm text-slate-600 space-y-1",children:jt.map((ue,He)=>o.jsx("li",{className:"break-words",children:ue.name},He))})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs sm:text-sm font-medium text-slate-700 mb-1.5 sm:mb-2",children:"Weekly Availability"}),o.jsx("p",{className:"text-[10px] sm:text-xs text-slate-500 mb-1.5 sm:mb-2",children:"Select the days and time slots when you're available for tutoring sessions."}),o.jsxs("div",{className:"mb-3 sm:mb-4",children:[o.jsxs("select",{className:"w-full border border-slate-300 rounded-lg px-2.5 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm",value:De,onChange:ue=>xt(ue.target.value),children:[o.jsx("option",{value:"",children:"Select a day to add..."}),Xa.filter(ue=>!Q[ue]).map(ue=>o.jsx("option",{value:ue,children:ue},ue))]}),De&&o.jsx(at,{onClick:()=>{Si(De),xt("")},className:"w-full mt-2 text-xs sm:text-sm py-1.5 sm:py-2",children:"Add Day"})]}),Object.keys(Q).length>0&&o.jsx("div",{className:"space-y-3 sm:space-y-4 mt-3 sm:mt-4",children:Object.entries(Q).map(([ue,He])=>o.jsxs("div",{className:"border border-slate-200 rounded-lg p-2.5 sm:p-3 md:p-4 bg-slate-50",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-0 mb-2 sm:mb-3",children:[o.jsx("h4",{className:"font-medium text-xs sm:text-sm md:text-base text-slate-800",children:ue}),o.jsxs("div",{className:"flex gap-1.5 sm:gap-2 w-full sm:w-auto",children:[o.jsx("button",{type:"button",onClick:()=>ji(ue),className:"text-xs sm:text-sm px-2 sm:px-3 py-1 bg-primary-100 text-primary-700 hover:bg-primary-200 active:bg-primary-300 rounded-md flex-1 sm:flex-none touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:"Add Time Slot"}),o.jsx("button",{type:"button",onClick:()=>Qa(ue),className:"text-xs sm:text-sm px-2 sm:px-3 py-1 text-red-600 bg-red-50 hover:bg-red-100 active:bg-red-200 rounded-md flex-1 sm:flex-none touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:"Remove Day"})]})]}),o.jsx("div",{className:"space-y-1.5 sm:space-y-2",children:He.slots.map((ot,st)=>o.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 sm:gap-2 bg-white p-1.5 sm:p-2 rounded",children:[o.jsx("input",{type:"time",value:ot.startTime,onChange:_t=>wr(ue,st,"startTime",_t.target.value),className:"border border-slate-300 rounded px-1.5 sm:px-2 py-1 text-xs sm:text-sm flex-1 min-w-[100px]"}),o.jsx("span",{className:"text-slate-500 text-xs sm:text-sm",children:"-"}),o.jsx("input",{type:"time",value:ot.endTime,onChange:_t=>wr(ue,st,"endTime",_t.target.value),className:"border border-slate-300 rounded px-1.5 sm:px-2 py-1 text-xs sm:text-sm flex-1 min-w-[100px]"}),o.jsx("button",{type:"button",onClick:()=>zo(ue,st),className:"text-xs sm:text-sm text-red-600 hover:text-red-800 active:text-red-900 p-1 touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},"aria-label":"Remove time slot",children:o.jsx(Rn,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"})})]},st))})]},ue))})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row justify-end gap-2 sm:gap-3 pt-4 sm:pt-5 border-t-2 border-slate-200",children:[o.jsx(at,{variant:"secondary",onClick:()=>ee(!1),className:"w-full sm:w-auto text-xs sm:text-sm md:text-base py-2 sm:py-2.5 px-4 sm:px-5 order-2 sm:order-1",children:"Cancel"}),o.jsx(at,{onClick:async()=>{if(!a){alert("Tutor not found");return}if(!oe||!ke||!Y||!re||!ie){alert("Please fill in all required fields");return}if(!Y.startsWith("09")||Y.length!==11){alert("Please enter a valid GCash number (11 digits starting with 09)");return}if(Array.from(Ve).length===0){alert("Please add at least one subject of expertise");return}const ue=Array.from(Ve).filter(ot=>{const st=bt[ot]&&bt[ot].length>0,_t=St[ot]&&St[ot].length>0;return!st&&!_t});if(ue.length>0){alert(`Please add supporting documents for: ${ue.join(", ")}`);return}if(!(ht.length>0||jt.length>0)){alert("Please add at least one proof document");return}Ce(!0);try{if(await we.put(`/tutors/${a}`,{full_name:oe,year_level:Number(ke),gcash_number:Y,session_rate_per_hour:Number(re),bio:ie}),(t==null?void 0:t.name)!==oe&&await we.put(`/users/${t==null?void 0:t.user_id}`,{name:oe}),X){const st=new FormData;st.append("file",X),await we.post(`/tutors/${a}/profile-image`,st,{headers:{"Content-Type":"multipart/form-data"}})}if(O){const st=new FormData;st.append("file",O),await we.post(`/tutors/${a}/gcash-qr`,st,{headers:{"Content-Type":"multipart/form-data"}})}for(const st of Array.from(Ve)){const _t=bt[st]||[],Qt=St[st]&&St[st].length>0,ds=new FormData;if(ds.append("subject_name",st),ds.append("is_reapplication","true"),_t.length>0&&_t.forEach(Nr=>ds.append("files",Nr)),_t.length===0&&!Qt){console.warn(`Skipping subject "${st}" - no files or existing documents`);continue}await we.post(`/tutors/${a}/subject-application`,ds,{headers:{"Content-Type":"multipart/form-data"}})}if(jt.length>0){const st=new FormData;jt.forEach(_t=>st.append("files",_t)),await we.post(`/tutors/${a}/documents`,st,{headers:{"Content-Type":"multipart/form-data"}})}const ot=Object.entries(Q).flatMap(([st,_t])=>_t.slots.map(Qt=>({day_of_week:st,start_time:Qt.startTime,end_time:Qt.endTime})));ot.length>0&&await we.post(`/tutors/${a}/availability`,{slots:ot}),await we.patch(`/tutors/${a}/status`,{status:"pending"}),alert("Application updated and resubmitted successfully! Your application is now pending review."),ee(!1),r(),Nt()}catch(ot){console.error("Failed to resubmit application:",ot),alert("Failed to resubmit application. Please try again.")}finally{Ce(!1)}},disabled:ce,className:"w-full sm:w-auto bg-gradient-to-r from-primary-600 to-primary-700 hover:from-primary-700 hover:to-primary-800 text-white shadow-lg hover:shadow-xl text-xs sm:text-sm md:text-base py-2 sm:py-2.5 px-4 sm:px-5 order-1 sm:order-2",children:ce?"Submitting...":"Submit Reapplication"})]})]})]}),o.jsx(On,{isOpen:P,onClose:()=>$(!1),title:W.startsWith("image/")?"Image Preview":W==="application/pdf"?"PDF Preview":"File Preview",footer:o.jsx(o.Fragment,{children:o.jsx("a",{href:R,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-primary-600",children:"Open in new tab"})}),children:o.jsx("div",{className:"w-full h-[70vh] bg-slate-100 rounded overflow-hidden flex items-center justify-center",children:W==="application/pdf"?o.jsx("iframe",{title:"PDF",src:R,className:"w-full h-full"}):W.startsWith("image/")||W==="image/*"?o.jsx("img",{src:R,alt:"Preview",className:"max-h-full max-w-full object-contain"}):o.jsx("div",{className:"text-sm text-slate-600 p-4 text-center",children:"Preview not available. You can open the file in a new tab."})})})]})},sKe=()=>{const{user:t}=rr(),{isVerified:e,applicationStatus:n}=QR(),[s,r]=j.useState(null),[a,i]=j.useState({bio:"",profile_photo:"",gcash_number:"",gcash_qr:"",session_rate_per_hour:null,subjects:[],rating:0,total_reviews:0}),[l,c]=j.useState(!1),[u,h]=j.useState(null),[f,p]=j.useState(null),[x,y]=j.useState(!1),[v,b]=j.useState([]);j.useEffect(()=>{var P;if(t){const $=((P=t==null?void 0:t.tutor_profile)==null?void 0:P.tutor_id)??(t==null?void 0:t.tutor_id);if($){const W=Number($);if(!Number.isNaN(W)){r(W);return}}const R=(t==null?void 0:t.id)??(t==null?void 0:t.user_id);if(!R)return;(async()=>{var W,q,X;try{const z=await we.get(`/tutors/by-user/${R}/tutor-id`),K=(z==null?void 0:z.data)??{},H=K.tutor_id??K.tutorId??K.id??((W=K.data)==null?void 0:W.tutor_id)??((q=K.data)==null?void 0:q.tutorId),Y=H!=null?Number(H):null;if(console.log("Fetched tutor_id via by-user:",K,"resolved:",Y,"for uid:",R),Y){r(Y);return}throw new Error("Tutor ID not present in response")}catch(z){console.error("Failed to fetch tutor ID via by-user endpoint:",((X=z==null?void 0:z.response)==null?void 0:X.data)||(z==null?void 0:z.message)),r(null)}})()}},[t]),j.useEffect(()=>{s&&(S(),N())},[s]);const N=async()=>{if(s)try{const P=await we.get(`/tutors/${s}/booking-requests`);b(P.data||[])}catch(P){console.error("Failed to fetch booking requests:",P)}},S=async()=>{if(s)try{const P=await we.get(`/tutors/${s}/profile`);console.log("Profile response data:",P.data),console.log("Profile photo URL from API:",P.data.profile_photo),console.log("User profile_image_url:",t==null?void 0:t.profile_image_url),i($=>{var F;let R=P.data.profile_photo||$.profile_photo||(t==null?void 0:t.profile_image_url)||"";if(R&&typeof R=="string"&&!/\?t=/.test(R)&&((F=$.profile_photo)!=null&&F.includes("?t="))){const W=$.profile_photo.split("?t=")[1];W&&(R=`${R}?t=${W}`)}return console.log("Setting profile photo URL to:",R),{...$,...P.data,profile_photo:R}})}catch(P){console.error("Failed to fetch profile:",P)}},k=(P,$)=>{i(R=>({...R,[P]:$}))},T=P=>{const $=P.target.files&&P.target.files[0];$&&h($)},E=P=>{const $=P.target.files&&P.target.files[0];$&&p($)},D=async()=>{var X,z,K,H,Y,B,O,U,J,se,ae,fe;const P=(a.bio||"").trim(),$=(a.gcash_number||"").trim(),R=!P||/^[A-Za-z\s]+$/.test(P),F=!$||/^09\d{9}$/.test($);if(!R){alert("Bio can contain letters and spaces only.");return}if(!F){alert("GCash number must be 11 digits and start with 09.");return}const q=await(async()=>{var ye,Te,oe;if(s)return s;try{const Se=((ye=t==null?void 0:t.tutor_profile)==null?void 0:ye.tutor_id)??(t==null?void 0:t.tutor_id);if(Se){const me=Number(Se);if(!Number.isNaN(me))return r(me),me}const ke=(t==null?void 0:t.id)??(t==null?void 0:t.user_id);if(ke){const me=await we.get(`/tutors/by-user/${ke}/tutor-id`),re=(me==null?void 0:me.data)??{},je=re.tutor_id??re.tutorId??re.id??((Te=re.data)==null?void 0:Te.tutor_id)??((oe=re.data)==null?void 0:oe.tutorId),ie=je!=null?Number(je):null;if(ie)return r(ie),ie}}catch{}return null})();if(!q){if(console.warn("Tutor ID could not be resolved. Will proceed with user-only updates (e.g., profile image) if available."),u){y(!0);try{const ye=(t==null?void 0:t.user_id)??(t==null?void 0:t.id),Te=new FormData;Te.append("file",u);const oe=await we.post(`/users/${ye}/profile-image`,Te,{headers:{"Content-Type":"multipart/form-data"}}),Se=oe.data.profile_image_url||((z=(X=oe.data)==null?void 0:X.data)==null?void 0:z.profile_image_url);if(Se&&(i(ke=>({...ke,profile_photo:Se})),t)){const ke={...t,profile_image_url:Se};localStorage.setItem("user",JSON.stringify(ke)),Lg(ke)}c(!1),h(null),alert("Profile image updated successfully!")}catch(ye){console.error("Failed user profile image upload without tutorId:",ye),alert("Failed to upload profile image.")}finally{y(!1)}}return}y(!0);try{console.log("Saving profile with tutorId:",q,"user:",t);const ye=a.session_rate_per_hour!=null?Number(a.session_rate_per_hour):null;let Te=!1;try{await we.put(`/tutors/${q}`,{bio:P,gcash_number:$,session_rate_per_hour:ye}),Te=!0}catch(oe){console.warn("PUT /tutors/:id failed",((K=oe==null?void 0:oe.response)==null?void 0:K.data)||(oe==null?void 0:oe.message));try{await we.put(`/tutors/${q}/profile`,{bio:P,gcash_number:$,session_rate_per_hour:ye}),Te=!0}catch(Se){console.error("Fallback update failed",((H=Se==null?void 0:Se.response)==null?void 0:H.data)||(Se==null?void 0:Se.message))}}if(u)try{const oe=(t==null?void 0:t.user_id)??(t==null?void 0:t.id);console.log("Uploading profile image for user:",oe);const Se=new FormData;Se.append("file",u);const ke=await we.post(`/users/${oe}/profile-image`,Se,{headers:{"Content-Type":"multipart/form-data"}});console.log("Profile image upload response:",ke.data);let me=ke.data.profile_image_url||((B=(Y=ke.data)==null?void 0:Y.data)==null?void 0:B.profile_image_url);if(me){if(/\?t=/.test(me)||(me=`${me}?t=${Date.now()}`),console.log("Setting profile photo URL to:",me),i(re=>({...re,profile_photo:me})),t){const re={...t,profile_image_url:me};localStorage.setItem("user",JSON.stringify(re)),Lg(re)}}else console.warn("Profile image URL not found in response:",ke.data)}catch(oe){console.error("Failed to upload profile image:",oe),console.error("Error details:",(O=oe==null?void 0:oe.response)==null?void 0:O.data)}else t!=null&&t.profile_image_url&&!u&&i(oe=>({...oe,profile_photo:t.profile_image_url}));if(f)try{console.log("Uploading GCash QR for tutor:",q);const oe=new FormData;oe.append("file",f);const Se=await we.post(`/tutors/${q}/gcash-qr`,oe,{headers:{"Content-Type":"multipart/form-data"}});console.log("GCash QR upload response:",Se.data);let ke=Se.data.gcash_qr_url||((J=(U=Se.data)==null?void 0:U.data)==null?void 0:J.gcash_qr_url);ke?(/\?t=/.test(ke)||(ke=`${ke}?t=${Date.now()}`),console.log("Setting GCash QR URL to:",ke),i(me=>({...me,gcash_qr:ke}))):console.warn("GCash QR URL not found in response:",Se.data)}catch(oe){console.error("Failed to upload GCash QR:",oe),console.error("Error details:",(se=oe==null?void 0:oe.response)==null?void 0:se.data)}c(!1),h(null),p(null),await S(),alert("Profile updated successfully!")}catch(ye){console.error("Failed to save profile:",ye);const Te=(((fe=(ae=ye==null?void 0:ye.response)==null?void 0:ae.data)==null?void 0:fe.message)||(ye==null?void 0:ye.message)||"").toString();Te.toLowerCase().includes("tutor not found")?console.warn("Tutor not found during save. Suppressing alert."):alert(Te||"Failed to save profile. Please try again.")}finally{y(!1)}},A=P=>Array.from({length:5},($,R)=>o.jsx(ja,{className:`h-4 w-4 ${R<Math.floor(P)?"text-yellow-400 fill-current":"text-slate-300"}`},R)),I=j.useMemo(()=>{const P={};return v.forEach(R=>{R.tutee_rating&&R.tutee_rating>0&&R.subject&&(P[R.subject]||(P[R.subject]=[]),P[R.subject].push(Number(R.tutee_rating)))}),Object.entries(P).map(([R,F])=>{const q=F.reduce((X,z)=>X+z,0)/F.length;return{subject:R,averageRating:q,totalRatings:F.length}}).sort((R,F)=>F.averageRating-R.averageRating)},[v]);return o.jsxs("div",{className:"space-y-4 sm:space-y-5 md:space-y-6 pb-6 sm:pb-8 md:pb-10",children:[o.jsxs("div",{className:"bg-gradient-to-br from-primary-600 via-primary-700 to-primary-800 rounded-xl sm:rounded-2xl p-4 sm:p-5 md:p-6 text-white shadow-2xl relative overflow-hidden -mx-2 sm:-mx-3 md:mx-0",children:[o.jsxs("div",{className:"absolute inset-0 opacity-20",children:[o.jsx("div",{className:"absolute top-0 right-0 w-40 h-40 bg-white rounded-full -mr-20 -mt-20 blur-2xl"}),o.jsx("div",{className:"absolute bottom-0 left-0 w-32 h-32 bg-white rounded-full -ml-16 -mb-16 blur-2xl"})]}),o.jsxs("div",{className:"relative flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4",children:[o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold mb-1 drop-shadow-lg",children:"Profile Setup"}),o.jsx("p",{className:"text-xs sm:text-sm md:text-base text-white/90 leading-tight",children:"Manage your public profile and payment information"})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2.5 sm:gap-3 bg-white/95 backdrop-blur-sm rounded-xl p-3 shadow-xl w-full sm:w-auto",children:[o.jsx("div",{className:`px-3 sm:px-4 py-1.5 sm:py-2 rounded-full text-xs sm:text-sm font-semibold text-slate-800 border-2 flex items-center justify-center space-x-2 ${n==="approved"?"border-green-400 bg-green-50":"border-red-400 bg-red-50"}`,children:n==="approved"?o.jsxs(o.Fragment,{children:[o.jsx(Zn,{className:"h-4 w-4 text-green-600 flex-shrink-0"}),o.jsx("span",{className:"whitespace-nowrap",children:"Approved"})]}):o.jsxs(o.Fragment,{children:[o.jsx(Rn,{className:"h-4 w-4 text-red-600 flex-shrink-0"}),o.jsx("span",{className:"whitespace-nowrap",children:"Not Approved"})]})}),o.jsx("div",{className:"flex space-x-2",children:l?o.jsxs(o.Fragment,{children:[o.jsx(at,{variant:"secondary",onClick:()=>c(!1),className:"!px-3 sm:!px-4 !py-2 text-xs sm:text-sm flex-1 sm:flex-none",children:"Cancel"}),o.jsx(at,{onClick:D,disabled:x,className:"!px-3 sm:!px-4 !py-2 bg-gradient-to-r from-primary-600 to-primary-700 text-white hover:from-primary-700 hover:to-primary-800 shadow-lg hover:shadow-xl text-xs sm:text-sm flex-1 sm:flex-none",children:x?"Saving...":"Save Changes"})]}):o.jsxs(at,{onClick:()=>c(!0),className:"!px-3 sm:!px-4 !py-2 bg-gradient-to-r from-primary-600 to-primary-700 text-white hover:from-primary-700 hover:to-primary-800 shadow-lg hover:shadow-xl flex items-center justify-center space-x-2 text-xs sm:text-sm w-full sm:w-auto",children:[o.jsx(fh,{className:"h-4 w-4 flex-shrink-0"}),o.jsx("span",{children:"Edit Profile"})]})})]})]})]}),o.jsxs(Lt,{className:"p-5 sm:p-6 bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl shadow-xl border border-slate-200/50 hover:shadow-2xl transition-all duration-300",children:[o.jsxs("div",{className:"mb-5 sm:mb-6",children:[o.jsx("div",{className:"flex justify-center mb-4 sm:mb-5",children:u?o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"w-28 h-28 sm:w-32 sm:h-32 rounded-full overflow-hidden ring-4 ring-primary-200 shadow-2xl bg-slate-100 transform hover:scale-105 transition-transform duration-300",children:o.jsx("img",{src:URL.createObjectURL(u),alt:"Profile Preview",className:"w-full h-full object-cover",style:{aspectRatio:"1/1"}})}),n==="approved"&&o.jsx("div",{className:"absolute -top-1 -right-1 bg-gradient-to-br from-green-500 to-emerald-600 text-white text-xs px-2 py-1 rounded-full border-2 border-white shadow-lg",children:o.jsx(Zn,{className:"h-3 w-3"})}),l&&o.jsxs("div",{className:"absolute bottom-0 right-0 flex space-x-1.5",children:[o.jsxs("label",{className:"bg-gradient-to-br from-primary-600 to-primary-700 text-white rounded-full p-2.5 cursor-pointer hover:from-primary-700 hover:to-primary-800 transition-all shadow-lg hover:shadow-xl",children:[o.jsx($1,{className:"h-4 w-4"}),o.jsx("input",{type:"file",accept:"image/*",onChange:T,className:"hidden"})]}),u&&o.jsx("button",{onClick:()=>h(null),className:"bg-gradient-to-br from-red-600 to-red-700 text-white rounded-full p-2.5 hover:from-red-700 hover:to-red-800 transition-all shadow-lg hover:shadow-xl",title:"Remove selected image",children:o.jsx(Rn,{className:"h-4 w-4"})})]})]}):a.profile_photo||t!=null&&t.profile_image_url?o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"w-28 h-28 sm:w-32 sm:h-32 rounded-full overflow-hidden ring-4 ring-primary-200 shadow-2xl bg-slate-100 transform hover:scale-105 transition-transform duration-300",children:o.jsx("img",{src:Zt(a.profile_photo||(t==null?void 0:t.profile_image_url)||""),alt:"Profile",className:"w-full h-full object-cover",style:{aspectRatio:"1/1"},onError:P=>{console.error("Failed to load profile image. Original URL:",a.profile_photo||(t==null?void 0:t.profile_image_url)),console.error("Constructed URL:",Zt(a.profile_photo||(t==null?void 0:t.profile_image_url)||"")),P.target.src=`https://ui-avatars.com/api/?name=${encodeURIComponent((t==null?void 0:t.name)||"Tutor")}&background=random`},onLoad:()=>{console.log("Profile image loaded successfully:",Zt(a.profile_photo||(t==null?void 0:t.profile_image_url)||""))}})}),n==="approved"?o.jsx("div",{className:"absolute -top-1 -right-1 bg-gradient-to-br from-green-500 to-emerald-600 text-white text-xs px-2 py-1 rounded-full border-2 border-white shadow-lg",children:o.jsx(Zn,{className:"h-3 w-3"})}):o.jsx("div",{className:"absolute -top-1 -right-1 bg-gradient-to-br from-red-500 to-red-600 text-white text-xs px-2 py-1 rounded-full border-2 border-white shadow-lg",children:o.jsx(Rn,{className:"h-3 w-3"})}),l&&o.jsxs("div",{className:"absolute bottom-0 right-0 flex space-x-1.5",children:[o.jsxs("label",{className:"bg-gradient-to-br from-primary-600 to-primary-700 text-white rounded-full p-2.5 cursor-pointer hover:from-primary-700 hover:to-primary-800 transition-all shadow-lg hover:shadow-xl",children:[o.jsx($1,{className:"h-4 w-4"}),o.jsx("input",{type:"file",accept:"image/*",onChange:T,className:"hidden"})]}),u&&o.jsx("button",{onClick:()=>h(null),className:"bg-gradient-to-br from-red-600 to-red-700 text-white rounded-full p-2.5 hover:from-red-700 hover:to-red-800 transition-all shadow-lg hover:shadow-xl",title:"Remove selected image",children:o.jsx(Rn,{className:"h-4 w-4"})})]})]}):o.jsxs("div",{className:"relative w-28 h-28 sm:w-32 sm:h-32 rounded-full bg-gradient-to-br from-slate-200 to-slate-300 flex items-center justify-center ring-4 ring-primary-200 shadow-2xl",children:[o.jsx(za,{className:"h-14 w-14 sm:h-16 sm:w-16 text-slate-500"}),l&&o.jsx("div",{className:"absolute bottom-0 right-0 flex space-x-1.5",children:o.jsxs("label",{className:"bg-gradient-to-br from-primary-600 to-primary-700 text-white rounded-full p-2.5 cursor-pointer hover:from-primary-700 hover:to-primary-800 transition-all shadow-lg hover:shadow-xl",children:[o.jsx($1,{className:"h-4 w-4"}),o.jsx("input",{type:"file",accept:"image/*",onChange:T,className:"hidden"})]})})]})}),o.jsxs("div",{className:"text-center",children:[o.jsx("h3",{className:"text-xl sm:text-2xl font-bold text-slate-800 mb-1.5",children:(t==null?void 0:t.name)||"Tutor"}),o.jsxs("p",{className:"text-sm sm:text-base text-slate-600 break-words flex items-center justify-center gap-1.5",children:[o.jsx(Y3,{className:"h-4 w-4 text-primary-600"}),(t==null?void 0:t.email)||""]})]})]}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx("div",{className:"p-2 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl shadow-lg",children:o.jsx(za,{className:"h-5 w-5 text-white"})}),o.jsx("h2",{className:"text-xl sm:text-2xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"Your Profile"})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"bg-gradient-to-br from-primary-50 via-primary-100/50 to-primary-50 p-4 rounded-xl border-2 border-primary-200/50 shadow-lg hover:shadow-xl transition-all",children:[o.jsx("p",{className:"text-xs sm:text-sm font-semibold text-slate-600 uppercase tracking-wide mb-2",children:"Approved Subjects"}),o.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-primary-700",children:a.subjects.length})]}),o.jsxs("div",{className:"bg-gradient-to-br from-primary-50 via-primary-100/50 to-primary-50 p-4 rounded-xl border-2 border-primary-200/50 shadow-lg hover:shadow-xl transition-all",children:[o.jsx("p",{className:"text-xs sm:text-sm font-semibold text-slate-600 uppercase tracking-wide mb-2",children:"Total Reviews"}),o.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-primary-700",children:I.reduce((P,$)=>P+$.totalRatings,0)})]})]})]})]}),o.jsxs(Lt,{className:"p-5 sm:p-6 bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl shadow-xl border border-slate-200/50 hover:shadow-2xl transition-all duration-300",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl shadow-lg",children:o.jsx(za,{className:"h-5 w-5 text-white"})}),o.jsx("h2",{className:"text-xl sm:text-2xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"Bio & Description"})]}),l?o.jsxs(o.Fragment,{children:[o.jsx("textarea",{className:"w-full border-2 border-slate-300 rounded-xl px-4 py-3 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 bg-white shadow-sm transition-all",rows:5,placeholder:"Tell students about your teaching experience, specialties, and approach...",value:a.bio,onChange:P=>{const $=P.target.value.replace(/[^A-Za-z\s]/g,"");k("bio",$)}}),a.bio&&/[^A-Za-z\s]/.test(a.bio)&&o.jsxs("p",{className:"text-xs text-red-600 mt-2 flex items-center gap-1",children:[o.jsx(Rn,{className:"h-3 w-3"}),"Bio can contain letters and spaces only."]})]}):o.jsx("div",{className:"bg-gradient-to-br from-slate-50 via-primary-50/30 to-slate-50 p-5 rounded-xl border-2 border-slate-200/50 shadow-sm min-h-[120px]",children:a.bio?o.jsx("p",{className:"text-slate-700 whitespace-pre-wrap leading-relaxed",children:a.bio}):o.jsx("p",{className:"text-slate-500 italic text-center py-4",children:'No bio added yet. Click "Edit Profile" to add one.'})})]}),o.jsxs(Lt,{className:"p-5 sm:p-6 bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl shadow-xl border border-slate-200/50 hover:shadow-2xl transition-all duration-300",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl shadow-lg",children:o.jsx(ja,{className:"h-5 w-5 text-white"})}),o.jsx("h2",{className:"text-xl sm:text-2xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"Approved Subjects of Expertise"})]}),o.jsxs("div",{className:"flex flex-wrap gap-2.5",children:[a.subjects.map((P,$)=>o.jsxs("span",{className:"px-4 py-2 bg-gradient-to-r from-primary-600 to-primary-700 text-white rounded-xl text-sm font-semibold shadow-md hover:shadow-lg hover:scale-105 transition-all duration-200 border border-primary-400/30 flex items-center space-x-1.5",children:[o.jsx(Zn,{className:"h-4 w-4"}),o.jsx("span",{children:P})]},$)),a.subjects.length===0&&o.jsx("div",{className:"w-full text-center py-6",children:o.jsxs("div",{className:"bg-gradient-to-br from-yellow-50 to-amber-50 border-2 border-yellow-200 rounded-xl p-6 shadow-lg",children:[o.jsx(Un,{className:"h-10 w-10 text-yellow-600 mx-auto mb-3"}),o.jsx("p",{className:"text-yellow-800 font-semibold text-base mb-1",children:"No approved subjects yet"}),o.jsx("p",{className:"text-sm text-yellow-700",children:"Your subject expertise applications are being reviewed by our admin team."})]})})]}),o.jsx("div",{className:"mt-5 p-4 bg-gradient-to-br from-primary-50 to-primary-100/50 border-2 border-primary-200/50 rounded-xl shadow-sm",children:o.jsxs("p",{className:"text-sm text-primary-800 flex items-start gap-2",children:[o.jsx("span",{className:"font-bold",children:"Note:"}),o.jsx("span",{children:"Only subjects approved by our admin team will appear here. To add new subjects or check the status of your applications, go to the Application & Verification section."})]})})]}),o.jsxs(Lt,{className:"p-5 sm:p-6 bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl shadow-xl border border-slate-200/50 hover:shadow-2xl transition-all duration-300",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl shadow-lg",children:o.jsx(_l,{className:"h-5 w-5 text-white"})}),o.jsx("h2",{className:"text-xl sm:text-2xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"Payment Information"})]}),o.jsxs("div",{className:"space-y-4 sm:space-y-5",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2 uppercase tracking-wide",children:"Session Rate per Hour"}),l?o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"relative",children:[o.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-primary-600 font-bold text-lg",children:""}),o.jsx("input",{type:"number",min:"0",step:"0.01",className:"w-full border-2 border-slate-300 rounded-xl pl-10 pr-4 py-3 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 bg-white shadow-sm transition-all",placeholder:"0.00",value:a.session_rate_per_hour??"",onChange:P=>{const $=P.target.value===""?null:parseFloat(P.target.value);k("session_rate_per_hour",$)}})]}),a.session_rate_per_hour!=null&&(a.session_rate_per_hour<0||isNaN(a.session_rate_per_hour))&&o.jsxs("p",{className:"text-xs text-red-600 mt-2 flex items-center gap-1",children:[o.jsx(Rn,{className:"h-3 w-3"}),"Session rate must be a positive number."]})]}):o.jsx("div",{className:"bg-gradient-to-br from-primary-50 via-primary-100/50 to-primary-50 p-4 rounded-xl border-2 border-primary-200/50 shadow-sm",children:o.jsx("p",{className:"text-primary-700 font-bold text-lg sm:text-xl",children:a.session_rate_per_hour!=null?`${Number(a.session_rate_per_hour).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`:o.jsx("span",{className:"text-slate-500 italic font-normal",children:"No session rate set yet"})})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2 uppercase tracking-wide",children:"GCash Number"}),l?o.jsxs(o.Fragment,{children:[o.jsx("input",{type:"text",className:"w-full border-2 border-slate-300 rounded-xl px-4 py-3 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 bg-white shadow-sm transition-all",placeholder:"09XX XXX XXXX",value:a.gcash_number,onChange:P=>{const R=P.target.value.replace(/[^0-9]/g,"").slice(0,11);k("gcash_number",R)}}),a.gcash_number&&(!/^09\d{9}$/.test(a.gcash_number)||a.gcash_number.length!==11)&&o.jsxs("p",{className:"text-xs text-red-600 mt-2 flex items-center gap-1",children:[o.jsx(Rn,{className:"h-3 w-3"}),"GCash number must be 11 digits, start with 09."]})]}):o.jsx("div",{className:"bg-gradient-to-br from-slate-50 via-primary-50/30 to-slate-50 p-4 rounded-xl border-2 border-slate-200/50 shadow-sm",children:o.jsx("p",{className:"text-slate-700 font-semibold",children:a.gcash_number||o.jsx("span",{className:"text-slate-500 italic font-normal",children:"No GCash number added yet"})})})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-semibold text-slate-700 mb-2 uppercase tracking-wide",children:"GCash QR Code"}),l?o.jsxs("div",{children:[o.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2.5",children:[o.jsx("input",{type:"file",accept:"image/*",onChange:E,className:"flex-1 border-2 border-slate-300 rounded-xl px-4 py-3 bg-white shadow-sm text-sm transition-all"}),f&&o.jsxs("button",{onClick:()=>p(null),className:"bg-gradient-to-br from-red-600 to-red-700 text-white px-4 py-3 rounded-xl hover:from-red-700 hover:to-red-800 transition-all shadow-lg hover:shadow-xl flex items-center justify-center gap-2",title:"Remove selected QR code",children:[o.jsx(Rn,{className:"h-4 w-4"}),o.jsx("span",{className:"text-sm",children:"Remove"})]})]}),f&&o.jsxs("p",{className:"text-sm text-slate-600 mt-2 flex items-center gap-2",children:[o.jsx(Zn,{className:"h-4 w-4 text-green-600"}),"Selected: ",f.name]})]}):o.jsx("div",{className:"bg-gradient-to-br from-slate-50 via-primary-50/30 to-slate-50 p-5 rounded-xl border-2 border-slate-200/50 shadow-sm flex justify-center",children:f?o.jsx("img",{src:URL.createObjectURL(f),alt:"GCash QR Preview",className:"w-32 h-32 sm:w-40 sm:h-40 object-contain border-2 border-primary-200 rounded-xl bg-white shadow-lg"}):a.gcash_qr?o.jsx("img",{src:Zt(a.gcash_qr),alt:"GCash QR Code",className:"w-32 h-32 sm:w-40 sm:h-40 object-contain border-2 border-primary-200 rounded-xl bg-white shadow-lg hover:shadow-xl transition-all"}):o.jsx("p",{className:"text-sm text-slate-500 italic py-4",children:"No GCash QR code uploaded yet"})})]})]})]}),I.length>0&&o.jsxs(Lt,{className:"p-5 sm:p-6 bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl shadow-xl border border-slate-200/50 hover:shadow-2xl transition-all duration-300",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl shadow-lg",children:o.jsx(ja,{className:"h-5 w-5 text-white"})}),o.jsx("h2",{className:"text-xl sm:text-2xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"Average Rating per Subject"})]}),o.jsx("div",{className:"space-y-3 sm:space-y-4",children:I.map(P=>o.jsxs("div",{className:"flex items-center justify-between p-3 sm:p-4 bg-gradient-to-br from-primary-50 via-primary-100/50 to-primary-50 rounded-lg border-2 border-primary-200/50 shadow-sm hover:shadow-md transition-all",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-sm sm:text-base font-semibold text-slate-900 mb-1 truncate",children:P.subject}),o.jsxs("p",{className:"text-xs sm:text-sm text-slate-600",children:[P.totalRatings," ",P.totalRatings===1?"rating":"ratings"]})]}),o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 ml-4",children:[o.jsx("div",{className:"flex items-center gap-1",children:A(P.averageRating)}),o.jsx("span",{className:"text-base sm:text-lg md:text-xl font-bold text-primary-700 min-w-[3rem] text-right",children:P.averageRating.toFixed(1)})]})]},P.subject))})]})]})},S1=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],rKe=()=>{const t=[];for(let e=0;e<24;e++)for(let n=0;n<60;n+=30){const s=`${String(e).padStart(2,"0")}:${String(n).padStart(2,"0")}`;t.push(s)}return t},Ud=rKe(),ls=t=>{if(!t)return 0;const e=t.split(":"),n=parseInt(e[0],10)||0,s=parseInt(e[1],10)||0;return n*60+s},j1=t=>{if(!t)return"";const e=t.split(":");return`${e[0].padStart(2,"0")}:${e[1].padStart(2,"0")}`},aKe=(t,e,n)=>{const s=ls(t),r=ls(e),a=ls(n);return s>=r&&s<a},Eu=t=>{const e=new Set;return t.forEach(n=>{Ud.forEach(s=>{aKe(s,n.start_time,n.end_time)&&e.add(s)})}),e},k1=t=>{if(t.size===0)return[];const e=Array.from(t).sort((a,i)=>ls(a)-ls(i)),n=[];let s=null,r=null;if(e.forEach((a,i)=>{if(s===null)s=a,r=a;else{const l=ls(a),c=ls(e[i-1]);if(l-c===30)r=a;else{if(s&&r){const u=ls(r)+30,h=Math.floor(u/60),f=u%60;n.push({start_time:s,end_time:`${String(h).padStart(2,"0")}:${String(f).padStart(2,"0")}`})}s=a,r=a}}}),s&&r){const a=ls(r)+30,i=Math.floor(a/60),l=a%60;n.push({start_time:s,end_time:`${String(i).padStart(2,"0")}:${String(l).padStart(2,"0")}`})}return n.map(a=>{const i=ls(a.start_time),l=[];let c=e.findIndex(u=>ls(u)===i);if(c===-1)return a;for(let u=c;u<e.length;u++){const h=e[u],f=ls(h);if(u===c)l.push(h);else{const p=ls(e[u-1]);if(f===p+30)l.push(h);else break}}if(l.length===0)return a;for(let u=l.length-1;u>=0;u--){const h=l.slice(0,u+1),f=h[h.length-1],x=ls(f)+30,y={start_time:a.start_time,end_time:`${String(Math.floor(x/60)).padStart(2,"0")}:${String(x%60).padStart(2,"0")}`},v=Eu([y]),b=Array.from(v).sort(),N=h.sort();if(JSON.stringify(b)===JSON.stringify(N)){if(ls(a.end_time)!==x){const S=Math.floor(x/60),k=x%60;return{start_time:a.start_time,end_time:`${String(S).padStart(2,"0")}:${String(k).padStart(2,"0")}`}}return a}}if(l.length>1){const u=l.slice(0,-1),h=u[u.length-1],p=ls(h)+30,x=Math.floor(p/60),y=p%60;return{start_time:a.start_time,end_time:`${String(x).padStart(2,"0")}:${String(y).padStart(2,"0")}`}}return a})},iKe=({day:t,onAddRange:e})=>{const[n,s]=j.useState("09:00"),[r,a]=j.useState("17:00"),[i,l]=j.useState(!1),c=()=>{n&&r&&ls(n)<ls(r)&&(e(n,r),l(!1),s("09:00"),a("17:00"))};return i?o.jsxs("div",{className:"space-y-4 p-3 sm:p-4 md:p-5 bg-white rounded-xl border-2 border-primary-300 shadow-lg",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"block text-xs sm:text-sm font-bold text-primary-700 uppercase tracking-wide",children:"Start Time"}),o.jsx("input",{type:"time",value:n,onChange:u=>s(u.target.value),className:"w-full px-3 sm:px-4 md:px-5 py-2.5 sm:py-3 md:py-3.5 text-sm sm:text-base border-2 border-primary-300 rounded-xl bg-primary-50 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 font-semibold text-slate-800 shadow-sm transition-all min-w-0",style:{minWidth:"140px"}})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"block text-xs sm:text-sm font-bold text-primary-700 uppercase tracking-wide",children:"End Time"}),o.jsx("input",{type:"time",value:r,onChange:u=>a(u.target.value),className:"w-full px-3 sm:px-4 md:px-5 py-2.5 sm:py-3 md:py-3.5 text-sm sm:text-base border-2 border-primary-300 rounded-xl bg-primary-50 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 font-semibold text-slate-800 shadow-sm transition-all min-w-0",style:{minWidth:"140px"}})]})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-3 pt-2",children:[o.jsxs("button",{type:"button",onClick:c,className:"flex-1 px-4 sm:px-6 py-2.5 sm:py-3 bg-gradient-to-r from-primary-600 to-primary-700 text-white text-xs sm:text-sm font-bold rounded-xl hover:from-primary-700 hover:to-primary-800 transition-all shadow-md hover:shadow-lg flex items-center justify-center gap-2 min-h-[44px]",children:[o.jsx(zg,{className:"h-4 w-4 flex-shrink-0"}),o.jsx("span",{className:"whitespace-nowrap",children:"Add Time Range"})]}),o.jsx("button",{type:"button",onClick:()=>l(!1),className:"px-4 sm:px-6 py-2.5 sm:py-3 bg-slate-100 text-slate-700 text-xs sm:text-sm font-semibold rounded-xl hover:bg-slate-200 transition-all shadow-sm border border-slate-300 min-h-[44px] sm:w-auto w-full",children:"Cancel"})]})]}):o.jsxs("button",{type:"button",onClick:()=>l(!0),className:"flex items-center justify-center gap-2 w-full px-6 py-3.5 bg-gradient-to-r from-primary-600 to-primary-700 text-white text-sm font-bold rounded-xl hover:from-primary-700 hover:to-primary-800 transition-all shadow-lg hover:shadow-xl transform hover:scale-[1.02]",children:[o.jsx(zg,{className:"h-5 w-5"}),o.jsx("span",{children:"Add Time Range"})]})},oKe=()=>{const{user:t}=rr(),[e,n]=j.useState(null),[s,r]=j.useState(S1.reduce((W,q)=>(W[q]={selectedSlots:new Set},W),{})),[a,i]=j.useState(!1),[l,c]=j.useState(0),[u,h]=j.useState(23),[f,p]=j.useState(!1),[x,y]=j.useState("30min"),[v,b]=j.useState(null),[N,S]=j.useState(""),[k,T]=j.useState(""),[E,D]=j.useState({});j.useEffect(()=>{t!=null&&t.user_id&&(async()=>{try{const X=(await we.get(`/tutors/by-user/${t.user_id}/tutor-id`)).data.tutor_id;console.log("Fetched tutor_id:",X,"for user_id:",t.user_id),n(X)}catch(q){console.error("Failed to fetch tutor ID:",q),n(t.user_id)}})()},[t]),j.useEffect(()=>{if(!e)return;(async()=>{try{const X=(await we.get(`/tutors/${e}/availability`)).data,z=S1.reduce((H,Y)=>(H[Y]={selectedSlots:new Set},H),{}),K={};X.forEach(H=>{K[H.day_of_week]||(K[H.day_of_week]=[]),K[H.day_of_week].push({start_time:j1(H.start_time),end_time:j1(H.end_time)})}),Object.entries(K).forEach(([H,Y])=>{z[H].selectedSlots=Eu(Y)}),r(z)}catch(q){console.error("Failed to fetch availability:",q)}})()},[e]);const A=async()=>{if(e)try{const q=(await we.get(`/tutors/${e}/availability`)).data,X=S1.reduce((K,H)=>(K[H]={selectedSlots:new Set},K),{}),z={};q.forEach(K=>{z[K.day_of_week]||(z[K.day_of_week]=[]),z[K.day_of_week].push({start_time:j1(K.start_time),end_time:j1(K.end_time)})}),Object.entries(z).forEach(([K,H])=>{X[K].selectedSlots=Eu(H)}),r(X)}catch(W){console.error("Failed to fetch availability:",W)}},I=(W,q=!1)=>{r(X=>{const z=X[W].selectedSlots,K=z.size>0;if(q||a||(l!==0||u!==23||x!=="30min")){if(!q&&a&&K)return D(O=>({...O,[W]:new Set(z)})),{...X,[W]:{selectedSlots:new Set}};if(!K&&!q&&a){const O=E[W];if(O&&O.size>0)return D(U=>({...U,[W]:new Set})),{...X,[W]:{selectedSlots:new Set(O)}}}const B=new Set(z);return x==="hourly"?$.every(U=>{const[J]=U.split(":");return z.has(`${J}:00`)&&z.has(`${J}:30`)})?$.forEach(U=>{const[J]=U.split(":");B.delete(`${J}:00`),B.delete(`${J}:30`)}):$.forEach(U=>{const[J]=U.split(":");B.add(`${J}:00`),B.add(`${J}:30`)}):$.every(U=>z.has(U))?$.forEach(U=>B.delete(U)):$.forEach(U=>B.add(U)),{...X,[W]:{selectedSlots:B}}}else return Ud.every(O=>z.has(O))?{...X,[W]:{selectedSlots:new Set}}:{...X,[W]:{selectedSlots:new Set(Ud)}}})},P=j.useMemo(()=>Ud.filter(W=>{const[q]=W.split(":"),X=parseInt(q,10);return X>=l&&X<=u}),[l,u]),$=j.useMemo(()=>x==="hourly"?Ud.filter(W=>{const[q,X]=W.split(":"),z=parseInt(q,10);return X==="00"&&z>=l&&z<u}):P,[P,x,l,u]),R=W=>{switch(W){case"morning":c(6),h(11);break;case"afternoon":c(12),h(17);break;case"evening":c(18),h(23);break;case"business":c(9),h(17);break;case"all":default:c(0),h(23);break}},F=async()=>{if(!e){alert("Tutor not found.");return}try{const W=[];Object.entries(s).forEach(([q,X])=>{const z=X;z.selectedSlots.size>0&&k1(z.selectedSlots).forEach(H=>{const Y=Eu([H]),B=Array.from(z.selectedSlots).sort(),O=ls(H.start_time),U=ls(H.end_time),J=B.filter(ae=>{const fe=ls(ae);return fe>=O&&fe<U}),se=Array.from(Y).sort();if(JSON.stringify(J)!==JSON.stringify(se)&&(console.warn(`Range conversion mismatch for ${q}:`,{range:`${H.start_time}-${H.end_time}`,originalSlotsInRange:J,reconvertedSlots:se}),J.length>0)){const ae=J[J.length-1],ye=ls(ae)+30,Te=Math.floor(ye/60),oe=ye%60;H.end_time=`${String(Te).padStart(2,"0")}:${String(oe).padStart(2,"0")}`}W.push({day_of_week:q,start_time:H.start_time,end_time:H.end_time})})}),await we.post(`/tutors/${e}/availability`,{slots:W}),i(!1),await A(),alert("Availability updated successfully!")}catch(W){console.error("Failed to save availability:",W),alert("Failed to save availability. Please try again.")}};return o.jsxs("div",{className:"space-y-3 sm:space-y-4 md:space-y-6 pb-4 sm:pb-6 md:pb-8",children:[o.jsxs("div",{className:"bg-gradient-to-br from-primary-600 via-primary-700 to-primary-800 rounded-xl sm:rounded-2xl p-4 sm:p-5 md:p-6 lg:p-8 text-white shadow-2xl relative overflow-hidden -mx-2 sm:-mx-3 md:mx-0",children:[o.jsxs("div",{className:"absolute inset-0 opacity-20",children:[o.jsx("div",{className:"absolute top-0 right-0 w-40 h-40 bg-white rounded-full -mr-20 -mt-20 blur-2xl"}),o.jsx("div",{className:"absolute bottom-0 left-0 w-32 h-32 bg-white rounded-full -ml-16 -mb-16 blur-2xl"})]}),o.jsxs("div",{className:"relative flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4",children:[o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsxs("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold mb-1 drop-shadow-lg flex items-center gap-2 sm:gap-3",children:[o.jsx(Mi,{className:"h-6 w-6 sm:h-7 sm:w-7 md:h-8 md:w-8 flex-shrink-0"}),o.jsx("span",{className:"truncate",children:"Availability Scheduling"})]}),o.jsx("p",{className:"text-xs sm:text-sm md:text-base text-white/90 leading-tight",children:"Manage your weekly availability and update your schedule anytime"})]}),o.jsx("div",{className:"flex w-full sm:w-auto mt-2 sm:mt-0",children:a?o.jsxs("button",{onClick:F,className:"flex items-center justify-center space-x-2 bg-white/95 backdrop-blur-sm text-primary-600 px-4 sm:px-5 md:px-6 py-2 sm:py-2.5 md:py-3 rounded-xl font-semibold hover:bg-white transition-all shadow-xl hover:shadow-2xl text-xs sm:text-sm md:text-base w-full sm:w-auto touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:[o.jsx(dL,{className:"h-4 w-4 sm:h-5 sm:w-5 flex-shrink-0"}),o.jsx("span",{children:"Save Changes"})]}):o.jsxs("button",{onClick:()=>i(!0),className:"flex items-center justify-center space-x-2 bg-white/95 backdrop-blur-sm text-primary-600 px-4 sm:px-5 md:px-6 py-2 sm:py-2.5 md:py-3 rounded-xl font-semibold hover:bg-white transition-all shadow-xl hover:shadow-2xl text-xs sm:text-sm md:text-base w-full sm:w-auto touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:[o.jsx(fh,{className:"h-4 w-4 sm:h-5 sm:w-5 flex-shrink-0"}),o.jsx("span",{children:"Edit Schedule"})]})})]})]}),o.jsxs(Lt,{className:"p-0 overflow-hidden shadow-xl border-0 -mx-2 sm:-mx-3 md:mx-0",children:[o.jsx("div",{className:"bg-gradient-to-br from-primary-50 via-primary-100/50 to-primary-50 border-b-2 border-primary-200/50 px-4 sm:px-5 md:px-6 lg:px-8 py-4 sm:py-5 md:py-6",children:o.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl shadow-lg",children:o.jsx(Mi,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"Weekly Schedule"})]}),o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 w-full sm:w-auto",children:[o.jsxs("button",{onClick:()=>p(!f),className:`flex items-center justify-center space-x-2 px-3 sm:px-4 py-2 rounded-xl font-semibold transition-all text-xs sm:text-sm shadow-lg hover:shadow-xl touch-manipulation ${f?"bg-gradient-to-r from-primary-600 to-primary-700 text-white":"bg-white text-primary-700 border-2 border-primary-300 hover:bg-primary-50"}`,style:{WebkitTapHighlightColor:"transparent"},children:[o.jsx(lL,{className:"h-4 w-4"}),o.jsx("span",{children:"Filter"})]}),a&&o.jsx("button",{onClick:()=>i(!1),className:"px-3 sm:px-4 py-2 bg-slate-100 text-slate-700 rounded-xl font-semibold hover:bg-slate-200 transition-all shadow-md hover:shadow-lg text-xs sm:text-sm flex-1 sm:flex-none touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:"Cancel"})]})]})}),o.jsxs("div",{className:"p-3 sm:p-4 md:p-6 lg:p-8",children:[f&&o.jsxs("div",{className:"mb-4 sm:mb-6 md:mb-8 p-4 sm:p-5 md:p-6 bg-gradient-to-br from-primary-50 via-primary-100/50 to-primary-50 rounded-xl sm:rounded-2xl border-2 border-primary-200/50 shadow-xl",children:[o.jsxs("div",{className:"flex items-center justify-between mb-4",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"p-2 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl shadow-lg",children:o.jsx(lL,{className:"h-4 w-4 sm:h-5 sm:w-5 text-white"})}),o.jsx("h3",{className:"text-sm sm:text-base md:text-lg font-bold text-slate-800",children:"Filter & View Options"})]}),o.jsx("button",{onClick:()=>p(!1),className:"text-slate-500 hover:text-slate-700 hover:bg-slate-100 p-2 rounded-full transition-all flex-shrink-0 touch-manipulation",title:"Close filter",style:{WebkitTapHighlightColor:"transparent"},children:o.jsx(Rn,{className:"h-4 w-4 sm:h-5 sm:w-5"})})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4 md:gap-5",children:[o.jsx("div",{className:"space-y-3 sm:space-y-4",children:o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-slate-700 mb-2 sm:mb-3",children:"Time Range"}),o.jsxs("div",{className:"mb-3 sm:mb-4",children:[o.jsx("label",{className:"block text-[10px] sm:text-xs font-medium text-slate-600 mb-1.5 sm:mb-2",children:"Quick Filters:"}),o.jsxs("div",{className:"grid grid-cols-2 gap-1.5 sm:gap-2",children:[o.jsx("button",{onClick:()=>R("all"),className:`px-3 sm:px-4 py-2 text-xs sm:text-sm rounded-xl font-semibold transition-all shadow-md hover:shadow-lg touch-manipulation ${l===0&&u===23?"bg-gradient-to-r from-primary-600 to-primary-700 text-white":"bg-white text-slate-700 border-2 border-primary-300 hover:bg-primary-50"}`,style:{WebkitTapHighlightColor:"transparent"},children:"All Day"}),o.jsx("button",{onClick:()=>R("business"),className:`px-3 sm:px-4 py-2 text-xs sm:text-sm rounded-xl font-semibold transition-all shadow-md hover:shadow-lg touch-manipulation ${l===9&&u===17?"bg-gradient-to-r from-primary-600 to-primary-700 text-white":"bg-white text-slate-700 border-2 border-primary-300 hover:bg-primary-50"}`,style:{WebkitTapHighlightColor:"transparent"},children:"Business Hours"}),o.jsx("button",{onClick:()=>R("morning"),className:`px-3 sm:px-4 py-2 text-xs sm:text-sm rounded-xl font-semibold transition-all shadow-md hover:shadow-lg touch-manipulation ${l===6&&u===11?"bg-gradient-to-r from-primary-600 to-primary-700 text-white":"bg-white text-slate-700 border-2 border-primary-300 hover:bg-primary-50"}`,style:{WebkitTapHighlightColor:"transparent"},children:"Morning"}),o.jsx("button",{onClick:()=>R("afternoon"),className:`px-3 sm:px-4 py-2 text-xs sm:text-sm rounded-xl font-semibold transition-all shadow-md hover:shadow-lg touch-manipulation ${l===12&&u===17?"bg-gradient-to-r from-primary-600 to-primary-700 text-white":"bg-white text-slate-700 border-2 border-primary-300 hover:bg-primary-50"}`,style:{WebkitTapHighlightColor:"transparent"},children:"Afternoon"}),o.jsx("button",{onClick:()=>R("evening"),className:`px-3 sm:px-4 py-2 text-xs sm:text-sm rounded-xl font-semibold transition-all shadow-md hover:shadow-lg md:col-span-2 touch-manipulation ${l===18&&u===23?"bg-gradient-to-r from-primary-600 to-primary-700 text-white":"bg-white text-slate-700 border-2 border-primary-300 hover:bg-primary-50"}`,style:{WebkitTapHighlightColor:"transparent"},children:"Evening"})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-[10px] sm:text-xs font-medium text-slate-600 mb-1.5 sm:mb-2",children:"Custom Range:"}),o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("label",{className:"block text-[10px] sm:text-xs text-slate-500 mb-1 sm:mb-1.5",children:"From"}),o.jsx("select",{value:l,onChange:W=>c(parseInt(W.target.value,10)),className:"w-full px-2 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm border border-slate-300 rounded-lg bg-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 shadow-sm",children:Array.from({length:24},(W,q)=>o.jsxs("option",{value:q,children:[String(q).padStart(2,"0"),":00 ",q>=12?"PM":"AM"]},q))})]}),o.jsx("span",{className:"pt-5 sm:pt-7 text-slate-500 font-medium text-xs sm:text-sm",children:"to"}),o.jsxs("div",{className:"flex-1",children:[o.jsx("label",{className:"block text-[10px] sm:text-xs text-slate-500 mb-1 sm:mb-1.5",children:"To"}),o.jsx("select",{value:u,onChange:W=>h(parseInt(W.target.value,10)),className:"w-full px-2 sm:px-3 py-1.5 sm:py-2 text-xs sm:text-sm border border-slate-300 rounded-lg bg-white focus:ring-2 focus:ring-primary-500 focus:border-primary-500 shadow-sm",children:Array.from({length:24},(W,q)=>o.jsxs("option",{value:q,children:[String(q).padStart(2,"0"),":00 ",q>=12?"PM":"AM"]},q))})]})]})]})]})}),o.jsx("div",{className:"space-y-3 sm:space-y-4",children:o.jsxs("div",{children:[o.jsx("label",{className:"block text-xs sm:text-sm font-semibold text-slate-700 mb-2 sm:mb-3",children:"Display Mode"}),o.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[o.jsxs("div",{className:"flex gap-2",children:[o.jsx("button",{onClick:()=>y("30min"),className:`flex-1 px-3 sm:px-4 py-2.5 sm:py-3 rounded-xl font-semibold transition-all shadow-md hover:shadow-lg text-xs sm:text-sm touch-manipulation ${x==="30min"?"bg-gradient-to-r from-primary-600 to-primary-700 text-white":"bg-white text-slate-700 border-2 border-primary-300 hover:bg-primary-50"}`,style:{WebkitTapHighlightColor:"transparent"},children:"30-Minute View"}),o.jsx("button",{onClick:()=>y("hourly"),className:`flex-1 px-3 sm:px-4 py-2.5 sm:py-3 rounded-xl font-semibold transition-all shadow-md hover:shadow-lg text-xs sm:text-sm touch-manipulation ${x==="hourly"?"bg-gradient-to-r from-primary-600 to-primary-700 text-white":"bg-white text-slate-700 border-2 border-primary-300 hover:bg-primary-50"}`,style:{WebkitTapHighlightColor:"transparent"},children:"Hourly View"})]}),o.jsx("div",{className:"p-2 sm:p-3 bg-white rounded-lg border border-slate-200",children:o.jsx("p",{className:"text-[10px] sm:text-xs text-slate-600 leading-relaxed",children:x==="hourly"?" Hourly view shows only hour markers. Clicking an hour selects/deselects both 30-minute slots for that hour.":" 30-minute view shows all time slots. Click to select individual 30-minute intervals."})})]})]})})]}),o.jsx("div",{className:"mt-3 sm:mt-4 md:mt-5 pt-3 sm:pt-4 border-t border-slate-200",children:o.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-0",children:[o.jsxs("div",{className:"text-[10px] sm:text-xs text-slate-600",children:[o.jsx("span",{className:"font-medium",children:"Showing:"})," ",o.jsx("span",{className:"text-primary-600 font-semibold",children:$.length})," ",$.length===1?"slot":"slots"," ","(",l.toString().padStart(2,"0"),":00 - ",x==="hourly"?`${(u-1).toString().padStart(2,"0")}:59`:`${u.toString().padStart(2,"0")}:59`,")"]}),o.jsx("button",{onClick:()=>{c(0),h(23),y("30min")},className:"text-[10px] sm:text-xs text-primary-600 hover:text-primary-700 active:text-primary-800 font-medium hover:underline touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:"Reset All Filters"})]})})]}),o.jsx("div",{className:"space-y-3 sm:space-y-4 md:space-y-6",children:S1.map(W=>{const q=s[W].selectedSlots,X=q.size>0;x==="hourly"?($.filter(H=>{const[Y]=H.split(":"),B=`${Y}:00`,O=`${Y}:30`;return q.has(B)&&q.has(O)}).length,Ud.filter(H=>{const[,Y]=H.split(":");return Y==="00"}).filter(H=>{const[Y]=H.split(":"),B=`${Y}:00`,O=`${Y}:30`;return q.has(B)&&q.has(O)}).length):($.filter(K=>q.has(K)).length,q.size);const z=l!==0||u!==23||x!=="30min";return o.jsxs("div",{className:`border rounded-lg transition-all ${X?"bg-green-50 border-green-200":"bg-slate-50 border-slate-200"}`,children:[o.jsxs("div",{className:"border-b border-slate-200 bg-white hover:bg-slate-50 transition-colors",children:[o.jsx("div",{className:"px-3 sm:px-4 md:px-6 py-3 sm:py-4 md:py-5 bg-gradient-to-r from-slate-50 to-white border-b border-slate-100",children:o.jsx("div",{className:"flex items-center justify-between gap-2 sm:gap-4",children:o.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3 md:space-x-4 min-w-0 flex-1",children:[o.jsx("input",{type:"checkbox",className:"h-4 w-4 sm:h-5 sm:w-5 md:h-6 md:w-6 rounded-lg border-slate-300 text-primary-600 focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 cursor-pointer flex-shrink-0 touch-manipulation",checked:X,onChange:()=>I(W),disabled:!a,style:{WebkitTapHighlightColor:"transparent"}}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("span",{className:"font-bold text-base sm:text-lg md:text-xl text-slate-800 block truncate",children:W}),X&&o.jsxs("span",{className:"mt-1 sm:mt-0 sm:ml-2 sm:inline-block text-xs sm:text-sm font-medium text-green-700 bg-green-100 px-2 sm:px-3 py-0.5 sm:py-1 rounded-full inline-flex items-center",children:[o.jsx(Mi,{className:"h-2.5 w-2.5 sm:h-3 sm:w-3 mr-1 flex-shrink-0"}),o.jsx("span",{className:"whitespace-nowrap",children:`${k1(q).reduce((Y,B)=>Y+(ls(B.end_time)-ls(B.start_time))/60,0).toFixed(1)} hours`})]})]})]})})}),a&&o.jsxs("div",{className:"px-3 sm:px-4 md:px-6 pb-4 sm:pb-5 md:pb-6 space-y-4 sm:space-y-5 md:space-y-6",children:[o.jsxs("div",{className:"bg-gradient-to-br from-primary-50 via-primary-100/50 to-purple-50 border-2 border-primary-300 rounded-xl sm:rounded-2xl p-3 sm:p-4 md:p-6 shadow-xl hover:shadow-2xl transition-all",children:[o.jsx("div",{className:"flex items-start gap-2 sm:gap-3 md:gap-4 mb-3 sm:mb-4 md:mb-5",children:o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h3",{className:"font-bold text-base sm:text-lg md:text-xl text-slate-800 mb-1",children:"Add Available Time"}),o.jsx("p",{className:"text-xs sm:text-sm text-slate-600",children:"Select your start and end times below. The system will automatically convert it to 30-minute slots."})]})}),o.jsx(iKe,{day:W,onAddRange:(K,H)=>{const Y=Eu([{start_time:K,end_time:H}]);r(B=>{const O=new Set(B[W].selectedSlots);return Y.forEach(U=>O.add(U)),{...B,[W]:{selectedSlots:O}}})}})]}),X&&(()=>{const K=k1(q),H=(v==null?void 0:v.day)===W,B=l!==0||u!==23||x!=="30min"?K.filter(se=>{const ae=parseInt(se.start_time.split(":")[0],10),fe=parseInt(se.end_time.split(":")[0],10);return ae>=l&&fe<=u+1}):K,O=(se,ae)=>{b({day:W,index:se}),S(ae.start_time),T(ae.end_time)},U=se=>{if(N&&k&&ls(N)<ls(k)){const ae=B[se],fe=K.findIndex(Se=>Se.start_time===ae.start_time&&Se.end_time===ae.end_time);if(fe===-1)return;const ye=K[fe],Te=Eu([ye]),oe=Eu([{start_time:N,end_time:k}]);r(Se=>{const ke=new Set(Se[W].selectedSlots);return Te.forEach(me=>ke.delete(me)),oe.forEach(me=>ke.add(me)),{...Se,[W]:{selectedSlots:ke}}}),b(null),S(""),T("")}},J=()=>{b(null),S(""),T("")};return o.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-0 pb-2 sm:pb-3 border-b-2 border-slate-200",children:[o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 min-w-0 flex-1",children:[o.jsx("div",{className:"p-1.5 sm:p-2 bg-green-100 rounded-lg flex-shrink-0",children:o.jsx(Un,{className:"h-4 w-4 sm:h-5 sm:w-5 text-green-600"})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("h3",{className:"text-sm sm:text-base md:text-lg font-bold text-slate-800",children:"Your Available Times"}),o.jsx("p",{className:"text-[10px] sm:text-xs text-slate-500 mt-0.5",children:"Click Edit to modify or Remove to delete"})]})]}),o.jsxs("span",{className:"text-xs sm:text-sm font-bold text-white bg-gradient-to-r from-green-500 to-emerald-500 px-2.5 sm:px-3 md:px-4 py-1 sm:py-1.5 rounded-full shadow-md whitespace-nowrap",children:[B.length," ",B.length===1?"range":"ranges"]})]}),B.length===0?o.jsx("div",{className:"text-center py-2.5 sm:py-3 text-slate-500 text-xs sm:text-sm bg-slate-50 rounded-lg border border-slate-200",children:"No availability in the filtered range"}):o.jsx("div",{className:"space-y-2.5 sm:space-y-3 max-h-64 sm:max-h-72 overflow-y-auto pr-1 sm:pr-2 scrollbar-thin scrollbar-thumb-slate-300 scrollbar-track-slate-100",children:B.map((se,ae)=>{const fe=parseInt(se.start_time.split(":")[0],10),ye=parseInt(se.start_time.split(":")[1],10),Te=parseInt(se.end_time.split(":")[0],10),oe=parseInt(se.end_time.split(":")[1],10),Se=(re,je)=>{const ie=re>=12?"PM":"AM";return`${re>12?re-12:re===0?12:re}:${String(je).padStart(2,"0")} ${ie}`},ke=H&&(v==null?void 0:v.index)===ae,me=(ls(se.end_time)-ls(se.start_time))/60;return o.jsx("div",{className:`rounded-xl sm:rounded-2xl transition-all duration-200 ${ke?"bg-gradient-to-r from-primary-50 via-primary-100/50 to-primary-50 border-2 border-primary-400 shadow-xl p-3 sm:p-4 md:p-5":"bg-gradient-to-r from-green-50 via-emerald-50 to-green-50 border-2 border-green-200 hover:border-green-400 hover:shadow-lg p-3 sm:p-4 md:p-5 group"}`,children:o.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 sm:gap-4",children:[ke?o.jsxs("div",{className:"flex-1 w-full grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[o.jsxs("div",{className:"space-y-1.5 sm:space-y-2",children:[o.jsxs("label",{className:"block text-[10px] sm:text-xs font-bold text-primary-700 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(Mi,{className:"h-2.5 w-2.5 sm:h-3 sm:w-3"}),"Start Time"]}),o.jsx("input",{type:"time",value:N,onChange:re=>S(re.target.value),className:"w-full px-3 sm:px-4 md:px-5 py-2.5 sm:py-2.5 md:py-3 text-sm sm:text-sm md:text-base border-2 border-primary-400 rounded-lg sm:rounded-xl bg-white focus:ring-2 sm:focus:ring-4 focus:ring-primary-200 focus:border-primary-600 font-bold text-slate-800 shadow-lg transition-all min-w-0",style:{minWidth:"140px"}})]}),o.jsxs("div",{className:"space-y-1.5 sm:space-y-2",children:[o.jsxs("label",{className:"block text-[10px] sm:text-xs font-bold text-primary-700 uppercase tracking-wide flex items-center gap-1",children:[o.jsx(Un,{className:"h-2.5 w-2.5 sm:h-3 sm:w-3"}),"End Time"]}),o.jsx("input",{type:"time",value:k,onChange:re=>T(re.target.value),className:"w-full px-3 sm:px-4 md:px-5 py-2.5 sm:py-2.5 md:py-3 text-sm sm:text-sm md:text-base border-2 border-primary-400 rounded-lg sm:rounded-xl bg-white focus:ring-2 sm:focus:ring-4 focus:ring-primary-200 focus:border-primary-600 font-bold text-slate-800 shadow-lg transition-all min-w-0",style:{minWidth:"140px"}})]})]}):o.jsx("div",{className:"flex items-center gap-2 sm:gap-3 md:gap-4 flex-1 min-w-0",children:o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 md:gap-4 min-w-0 flex-1",children:[o.jsxs("div",{className:"relative flex-shrink-0",children:[o.jsx("div",{className:"w-3 h-3 sm:w-4 sm:h-4 bg-gradient-to-br from-green-500 to-emerald-600 rounded-full shadow-lg"}),o.jsx("div",{className:"absolute inset-0 w-3 h-3 sm:w-4 sm:h-4 bg-green-400 rounded-full animate-ping opacity-75"})]}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsxs("div",{className:"flex flex-wrap items-baseline gap-1 sm:gap-2 mb-1",children:[o.jsx("span",{className:"font-black text-base sm:text-lg md:text-2xl text-slate-800 whitespace-nowrap",children:Se(fe,ye)}),o.jsx("span",{className:"text-sm sm:text-lg md:text-xl text-slate-400 font-light",children:""}),o.jsx("span",{className:"font-black text-base sm:text-lg md:text-2xl text-slate-800 whitespace-nowrap",children:Se(Te,oe)})]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 sm:gap-2",children:[o.jsxs("span",{className:"text-[10px] sm:text-xs font-semibold text-slate-500 bg-white px-1.5 sm:px-2 py-0.5 sm:py-1 rounded-md border border-slate-200 whitespace-nowrap",children:[se.start_time," - ",se.end_time]}),o.jsxs("span",{className:"text-[10px] sm:text-xs font-bold text-white bg-gradient-to-r from-green-500 to-emerald-600 px-2 sm:px-3 py-0.5 sm:py-1 rounded-full shadow-md whitespace-nowrap",children:[me.toFixed(1)," hours"]})]})]})]})}),o.jsx("div",{className:"flex items-center gap-1.5 sm:gap-2 shrink-0 w-full sm:w-auto",children:ke?o.jsxs(o.Fragment,{children:[o.jsxs("button",{type:"button",onClick:()=>U(ae),className:"px-3 sm:px-4 md:px-6 py-2 sm:py-2.5 md:py-3 text-xs sm:text-sm font-bold text-white bg-gradient-to-r from-primary-600 to-primary-700 rounded-lg sm:rounded-xl hover:from-primary-700 hover:to-primary-800 active:from-primary-800 active:to-primary-900 transition-all shadow-lg hover:shadow-xl flex items-center justify-center gap-1.5 sm:gap-2 flex-1 sm:flex-none touch-manipulation",title:"Save changes",style:{WebkitTapHighlightColor:"transparent"},children:[o.jsx(dL,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"}),o.jsx("span",{children:"Save"})]}),o.jsx("button",{type:"button",onClick:J,className:"px-3 sm:px-4 md:px-6 py-2 sm:py-2.5 md:py-3 text-xs sm:text-sm font-bold text-slate-700 bg-white border-2 border-slate-300 rounded-lg sm:rounded-xl hover:bg-slate-50 active:bg-slate-100 transition-all shadow-md hover:shadow-lg flex-1 sm:flex-none touch-manipulation",title:"Cancel editing",style:{WebkitTapHighlightColor:"transparent"},children:"Cancel"})]}):o.jsxs(o.Fragment,{children:[o.jsxs("button",{type:"button",onClick:()=>O(ae,se),className:"px-3 sm:px-4 md:px-5 py-2 sm:py-2.5 text-xs sm:text-sm font-bold text-primary-700 bg-primary-50 rounded-lg sm:rounded-xl hover:bg-primary-100 active:bg-primary-200 transition-all shadow-md hover:shadow-lg opacity-0 group-hover:opacity-100 border-2 border-primary-200 flex items-center justify-center gap-1.5 sm:gap-2 flex-1 sm:flex-none touch-manipulation",title:"Edit this time range",style:{WebkitTapHighlightColor:"transparent"},children:[o.jsx(fh,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"}),o.jsx("span",{children:"Edit"})]}),o.jsxs("button",{type:"button",onClick:()=>{const re=Eu([se]);r(je=>{const ie=new Set(je[W].selectedSlots);return re.forEach(Re=>ie.delete(Re)),{...je,[W]:{selectedSlots:ie}}})},className:"px-3 sm:px-4 md:px-5 py-2 sm:py-2.5 text-xs sm:text-sm font-bold text-red-700 bg-red-50 rounded-lg sm:rounded-xl hover:bg-red-100 active:bg-red-200 transition-all shadow-md hover:shadow-lg opacity-0 group-hover:opacity-100 border-2 border-red-200 flex items-center justify-center gap-1.5 sm:gap-2 flex-1 sm:flex-none touch-manipulation",title:"Remove this time range",style:{WebkitTapHighlightColor:"transparent"},children:[o.jsx(Rn,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"}),o.jsx("span",{children:"Remove"})]})]})})]})},`${se.start_time}-${se.end_time}-${ae}`)})})]})})()]})]}),!a&&X&&o.jsx("div",{className:"p-4",children:(()=>{const K=k1(q);let H=K;if(z&&(H=K.filter(Y=>{const B=parseInt(Y.start_time.split(":")[0],10),O=parseInt(Y.end_time.split(":")[0],10);return B>=l&&O<=u+1})),x==="hourly"&&H.length>0){const Y=[];return H.forEach(B=>{const O=parseInt(B.start_time.split(":")[0],10),U=parseInt(B.end_time.split(":")[0],10);let J=!1;for(let se=O;se<=U;se++){const ae=Y.find(fe=>fe.hour===se);if(ae&&!ae.ranges.includes(B)){ae.ranges.push(B),J=!0;break}}J||Y.push({hour:O,ranges:[B]})}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("div",{className:"text-xs text-slate-500 mb-2 font-medium",children:"Available Slots:"}),o.jsx("div",{className:"flex flex-wrap gap-2",children:Y.map((B,O)=>{const U=B.ranges,J=new Set;return U.forEach(ae=>{const fe=parseInt(ae.start_time.split(":")[0],10),ye=parseInt(ae.end_time.split(":")[0],10);for(let Te=fe;Te<ye;Te++)J.add(Te)}),Array.from(J).sort((ae,fe)=>ae-fe).map(ae=>ae>=12?`${ae===12?12:ae-12} PM`:`${ae===0?12:ae} AM`).join(", "),o.jsx("div",{className:"flex flex-wrap gap-2",children:U.map((ae,fe)=>o.jsxs("span",{className:"px-3 py-1.5 bg-gradient-to-r from-primary-100 via-primary-100/50 to-primary-100 text-primary-800 rounded-lg text-sm font-medium border border-primary-200 shadow-sm",children:[ae.start_time," - ",ae.end_time]},fe))},O)})})]})}return H.length>0?o.jsxs("div",{className:"space-y-2",children:[o.jsx("div",{className:"text-xs text-slate-500 mb-2 font-medium",children:"Available Time Slots:"}),o.jsx("div",{className:"flex flex-wrap gap-2",children:H.map((Y,B)=>o.jsxs("span",{className:"px-3 py-1.5 bg-gradient-to-r from-primary-100 via-primary-100/50 to-primary-100 text-primary-800 rounded-lg text-sm font-medium border border-primary-200 shadow-sm",children:[Y.start_time," - ",Y.end_time]},B))})]}):o.jsx("div",{className:"text-center py-4 text-slate-500 text-sm bg-slate-50 rounded-lg border border-slate-200",children:"No availability in the filtered range"})})()}),!a&&!X&&o.jsx("div",{className:"p-4 text-slate-500 text-sm",children:"No availability set for this day"})]},W)})})]})]}),o.jsxs(Lt,{className:"p-5 sm:p-6 bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl shadow-xl border border-slate-200/50 hover:shadow-2xl transition-all duration-300 -mx-2 sm:-mx-3 md:mx-0",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl shadow-lg",children:o.jsx(Mi,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"Schedule Summary"})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"bg-gradient-to-br from-primary-50 via-primary-100/50 to-primary-50 p-4 sm:p-5 rounded-xl border-2 border-primary-200/50 shadow-lg hover:shadow-xl transition-all",children:[o.jsx("h3",{className:"text-xs sm:text-sm font-semibold text-slate-600 uppercase tracking-wide mb-2",children:"Available Days"}),o.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-primary-700",children:Object.values(s).filter(W=>W.selectedSlots.size>0).length}),o.jsx("p",{className:"text-xs sm:text-sm text-primary-600 mt-1",children:"out of 7 days"})]}),o.jsxs("div",{className:"bg-gradient-to-br from-primary-50 via-primary-100/50 to-primary-50 p-4 sm:p-5 rounded-xl border-2 border-primary-200/50 shadow-lg hover:shadow-xl transition-all",children:[o.jsx("h3",{className:"text-xs sm:text-sm font-semibold text-slate-600 uppercase tracking-wide mb-2",children:"Total Hours"}),o.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-primary-700",children:Object.values(s).reduce((W,q)=>W+q.selectedSlots.size*.5,0).toFixed(1)}),o.jsx("p",{className:"text-xs sm:text-sm text-primary-600 mt-1",children:"hours per week"})]}),o.jsxs("div",{className:"bg-gradient-to-br from-primary-50 via-primary-100/50 to-primary-50 p-4 sm:p-5 rounded-xl border-2 border-primary-200/50 shadow-lg hover:shadow-xl transition-all",children:[o.jsx("h3",{className:"text-xs sm:text-sm font-semibold text-slate-600 uppercase tracking-wide mb-2",children:"Total Slots"}),o.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-primary-700",children:x==="hourly"?(()=>{const W=Ud.filter(q=>{const[,X]=q.split(":");return X==="00"});return Object.values(s).reduce((q,X)=>{const z=W.filter(K=>{const[H]=K.split(":"),Y=`${H}:00`,B=`${H}:30`;return X.selectedSlots.has(Y)&&X.selectedSlots.has(B)}).length;return q+z},0)})():Object.values(s).reduce((W,q)=>W+q.selectedSlots.size,0)}),o.jsx("p",{className:"text-xs sm:text-sm text-primary-600 mt-1",children:x==="hourly"?"slots selected (hourly)":"30-min slots selected"})]})]})]})]})},JZ=({open:t,bookingId:e,onClose:n,onSuccess:s})=>{const[r,a]=j.useState(""),[i,l]=j.useState(""),[c,u]=j.useState(void 0),[h,f]=j.useState(""),[p,x]=j.useState(!1);if(!t)return null;const y=window.__notify,v=async()=>{var b,N,S,k;if(!r||!i){y==null||y("Please select a date and time","error");return}x(!0);try{const T={booking_id:e,proposedDate:r,proposedTime:i};c&&(T.proposedDuration=c),h&&(T.reason=h);const E=await we.post("/reschedules",T);if(!((b=E.data)!=null&&b.success))throw new Error(((N=E.data)==null?void 0:N.message)||"Failed to send proposal");y==null||y("Reschedule proposal sent","success"),s==null||s(),n()}catch(T){y==null||y(((k=(S=T==null?void 0:T.response)==null?void 0:S.data)==null?void 0:k.message)||"Failed to send proposal","error")}finally{x(!1)}};return o.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/40",children:o.jsxs("div",{className:"bg-white rounded-lg max-w-lg w-full p-6",children:[o.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Propose reschedule"}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium",children:"Date"}),o.jsx("input",{type:"date",value:r,onChange:b=>a(b.target.value),className:"mt-1 block w-full border rounded px-3 py-2"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium",children:"Time"}),o.jsx("input",{type:"time",value:i,onChange:b=>l(b.target.value),className:"mt-1 block w-full border rounded px-3 py-2"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium",children:"Duration (hours)"}),o.jsx("input",{type:"number",min:.5,step:.5,value:c??"",onChange:b=>u(b.target.value?Number(b.target.value):void 0),className:"mt-1 block w-full border rounded px-3 py-2"})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium",children:"Reason (optional)"}),o.jsx("textarea",{value:h,onChange:b=>f(b.target.value),className:"mt-1 block w-full border rounded px-3 py-2",rows:3})]})]}),o.jsxs("div",{className:"mt-4 flex justify-end gap-2",children:[o.jsx("button",{onClick:n,className:"px-4 py-2 rounded bg-gray-100",children:"Cancel"}),o.jsx("button",{onClick:v,disabled:p,className:"px-4 py-2 rounded bg-blue-600 text-white",children:p?"Sending...":"Send proposal"})]})]})})},lKe=()=>{const{user:t}=kx(),e=qr(),[n,s]=j.useState(null),[r,a]=j.useState([]),[i,l]=j.useState(!1),[c,u]=j.useState(!1),[h,f]=j.useState(null),[p,x]=j.useState("all"),[y,v]=j.useState(!0),[b,N]=j.useState(null),[S,k]=j.useState(!1),[T,E]=j.useState(!1),[D,A]=j.useState(!1),[I,P]=j.useState(null),[$,R]=j.useState(!1),[F,W]=j.useState(null),[q,X]=j.useState(new Date);j.useEffect(()=>{const re=setInterval(()=>X(new Date),6e4);return()=>clearInterval(re)},[]);const z=r.some(re=>re.status==="awaiting_payment"&&!!re.payment_proof),K=r.some(re=>re.status==="pending"),H=async()=>{var re,je,ie,Re,Ve,Ze,bt;if(!(t!=null&&t.user_id)){f("User information not found. Please log in again."),gt.error("Session missing or expired. Redirecting to login..."),localStorage.removeItem("token"),localStorage.removeItem("user"),e("/login");return}u(!0),f(null);try{console.log("Attempting to resolve tutor_id for user:",t.user_id);const tt=await we.get(`/tutors/by-user/${t.user_id}/tutor-id`);if(console.log("Tutor ID response:",tt.data),!((re=tt.data)!=null&&re.tutor_id))throw new Error(" Access Restricted: Your tutor profile is not yet created. Please complete your tutor application first.");let St,mt=null;try{St=await we.get(`/tutors/by-user/${t.user_id}/status`),mt=(je=St.data)==null?void 0:je.status,console.log("Status (by-user) response:",St.data)}catch(Oe){console.warn("Failed to fetch status by user, will try tutor endpoint. Error:",Oe)}if(!mt&&((ie=tt.data)!=null&&ie.tutor_id))try{const Oe=await we.get(`/tutors/${tt.data.tutor_id}/status`);console.log("Status (by-tutor) response:",Oe.data),mt=mt||((Re=Oe.data)==null?void 0:Re.status),St=St||Oe}catch(Oe){console.warn("Failed to fetch status by tutor id as fallback. Error:",Oe)}const jt=String(mt||"").toLowerCase().trim();if(console.log("Resolved tutor status:",{rawStatus:mt,currentStatus:jt}),jt!=="approved"){const Oe=' Access Restricted: Your tutor profile is not yet approved. Click on "Application & Verification" in the sidebar menu to check your status and complete any pending requirements.';throw console.error("Access restricted:",{status:mt,message:Oe}),new Error(Oe)}console.log("Successfully resolved tutor_id:",tt.data.tutor_id),y&&s(tt.data.tutor_id),await Y(tt.data.tutor_id)}catch(tt){console.error("Failed to resolve tutor id for user",t.user_id,tt);const St=(Ve=tt==null?void 0:tt.response)==null?void 0:Ve.status,mt=((bt=(Ze=tt==null?void 0:tt.response)==null?void 0:Ze.data)==null?void 0:bt.message)||(tt==null?void 0:tt.message);if(St===401){gt.error("Session expired. Redirecting to login..."),localStorage.removeItem("token"),localStorage.removeItem("user"),e("/login");return}if(St===404||mt&&mt.includes("Tutor not found")){const Oe=" Access Restricted: To manage tutoring sessions, you need to:",ht=["1. Complete your tutor profile application","2. Submit required documents","3. Receive admin approval"].join(`
`);y&&f(`${Oe}

${ht}

Go to "Application & Verification" in the sidebar menu to check your status or complete these steps.`),gt.error(Oe,{autoClose:7e3});return}const jt=mt||"Failed to load tutor information. Please try refreshing the page.";y&&f(jt.toString()),gt.error(jt.toString())}finally{y&&u(!1)}};j.useEffect(()=>(v(!0),H(),()=>{v(!1)}),[t]);const Y=async re=>{var ie,Re,Ve,Ze,bt;const je=re||n;if(!je){console.warn("No tutor ID available for fetching bookings");return}try{console.log("Fetching booking requests for tutor:",je);const tt=await we.get(`/tutors/${je}/booking-requests`);console.log("Raw booking response:",tt.data),console.log("Response type:",Array.isArray(tt.data)?"Array":typeof tt.data),console.log("Response length:",Array.isArray(tt.data)?tt.data.length:"N/A");let St=[];Array.isArray(tt.data)?St=tt.data:Array.isArray((ie=tt.data)==null?void 0:ie.data)?St=tt.data.data:(Re=tt.data)!=null&&Re.bookings&&Array.isArray(tt.data.bookings)&&(St=tt.data.bookings),St.length===0&&!Array.isArray(tt.data)&&console.warn("Unexpected response format:",tt.data),console.log("Processed bookings:",St);const mt=St.map(jt=>{var Oe,ht,ut,Q,L,M,ee,ce,Ce,De,xt,Ie,lt,Nt,kt;return{id:jt.id,student:{user_id:((Oe=jt.student)==null?void 0:Oe.user_id)||((ut=(ht=jt.student)==null?void 0:ht.user)==null?void 0:ut.user_id),name:((L=(Q=jt.student)==null?void 0:Q.user)==null?void 0:L.name)||((M=jt.student)==null?void 0:M.name)||"Student",email:((ce=(ee=jt.student)==null?void 0:ee.user)==null?void 0:ce.email)||((Ce=jt.student)==null?void 0:Ce.email)||"",profile_image_url:((xt=(De=jt.student)==null?void 0:De.user)==null?void 0:xt.profile_image_url)||((Ie=jt.student)==null?void 0:Ie.profile_image_url)||((Nt=(lt=jt.student)==null?void 0:lt.user)==null?void 0:Nt.profile_image)||((kt=jt.student)==null?void 0:kt.profile_image)||""},subject:jt.subject,date:jt.date,time:jt.time,duration:jt.duration,status:jt.status,payment_proof:jt.payment_proof?(jt.payment_proof.startsWith("http"),jt.payment_proof):void 0,student_notes:jt.student_notes,created_at:jt.created_at}});console.log("Mapped booking-requests:",mt),y&&a(mt)}catch(tt){console.error("Failed to fetch booking requests:",tt),gt.error("Failed to load booking requests. Please check your connection and try again."),(Ze=(Ve=tt.response)==null?void 0:Ve.data)!=null&&Ze.message&&gt.error(tt.response.data.message),((bt=tt==null?void 0:tt.response)==null?void 0:bt.status)===401&&(gt.error("Session expired. Redirecting to login..."),localStorage.removeItem("token"),localStorage.removeItem("user"),e("/login"))}},B=async(re,je)=>{var ie,Re;l(!0);try{if((await we.post(`/tutors/booking-requests/${re}/${je}`)).data.success)gt.success(`Booking ${je}ed successfully!`),await Y();else throw new Error("Failed to update booking status")}catch(Ve){console.error(`Failed to ${je} booking:`,Ve),gt.error(`Failed to ${je} booking. Please try again.`),(Re=(ie=Ve.response)==null?void 0:ie.data)!=null&&Re.message&&gt.error(Ve.response.data.message)}finally{l(!1)}},O=(re,je)=>{if(!re||!je)return null;let ie=new Date(`${re.split("T")[0]}T${je}`);if(!isNaN(ie.getTime()))return ie;if(ie=new Date(re),isNaN(ie.getTime()))return null;const Re=je.match(/(\d{1,2}):(\d{2})(?::\d{2})?\s*(AM|PM)?/i);if(Re){let Ve=parseInt(Re[1],10);const Ze=parseInt(Re[2],10),bt=Re[3];return bt&&bt.toLowerCase()==="pm"&&Ve<12&&(Ve+=12),bt&&bt.toLowerCase()==="am"&&Ve===12&&(Ve=0),ie.setHours(Ve,Ze,0,0),ie}return null},U=async re=>{var je,ie,Re,Ve;l(!0);try{const Ze=new FormData;Ze.append("status","completed");const bt=await we.post(`/tutors/booking-requests/${re}/complete`,Ze,{headers:{"Content-Type":"multipart/form-data"}});if((je=bt.data)!=null&&je.success)gt.success("Session marked as completed"),await Y();else throw new Error(((ie=bt.data)==null?void 0:ie.message)||"Failed to mark completed")}catch(Ze){console.error("Failed to mark session completed",Ze),gt.error(((Ve=(Re=Ze==null?void 0:Ze.response)==null?void 0:Re.data)==null?void 0:Ve.message)||(Ze==null?void 0:Ze.message)||"Failed to mark session completed")}finally{l(!1)}},J=re=>{switch(re){case"pending":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"accepted":return"text-primary-600 bg-primary-50 border-primary-200";case"declined":return"text-red-600 bg-red-50 border-red-200";case"awaiting_payment":return"text-orange-600 bg-orange-50 border-orange-200";case"payment_approved":return"text-primary-700 bg-primary-50 border-primary-200";case"confirmed":return"text-green-600 bg-green-50 border-green-200";case"completed":return"text-purple-600 bg-purple-50 border-purple-200";case"cancelled":return"text-slate-600 bg-slate-50 border-slate-200";default:return"text-slate-600 bg-slate-50 border-slate-200"}},se=re=>{switch(re){case"pending":return o.jsx(Un,{className:"h-4 w-4"});case"accepted":return o.jsx(Zn,{className:"h-4 w-4"});case"declined":return o.jsx(Rn,{className:"h-4 w-4"});case"awaiting_payment":return o.jsx(vc,{className:"h-4 w-4"});case"payment_approved":return o.jsx(Zn,{className:"h-4 w-4"});case"confirmed":return o.jsx(Zn,{className:"h-4 w-4"});case"completed":return o.jsx(Zn,{className:"h-4 w-4"});case"cancelled":return o.jsx(Rn,{className:"h-4 w-4"});default:return o.jsx(Un,{className:"h-4 w-4"})}},ae=re=>{const je=O(re.date,re.time);if(!je)return!1;const ie=re.duration||1,Re=new Date(je.getTime()+ie*60*60*1e3);return new Date().getTime()>Re.getTime()},fe=re=>re.status==="awaiting_payment"&&re.payment_proof?0:re.status==="awaiting_payment"?1:2,Te=[...r].sort((re,je)=>{const ie=fe(re),Re=fe(je);if(ie!==Re)return ie-Re;const Ve=new Date(re.created_at).getTime();return new Date(je.created_at).getTime()-Ve}).filter(re=>re.status==="awaiting_confirmation"||["upcoming","confirmed"].includes(re.status)&&ae(re)?!1:p==="all"?re.status!=="completed"&&re.status!=="cancelled":p==="upcoming"?["upcoming","confirmed"].includes(re.status):re.status===p),oe=()=>{const re=new Date;return r.filter(je=>{if(!["upcoming","confirmed"].includes(je.status))return!1;const Re=O(je.date,je.time);return Re&&Re>re}).length},Se=re=>{const je=O(re.date,re.time);if(!je)return!1;const ie=re.duration||1,Re=new Date(je.getTime()+ie*60*60*1e3),Ve=new Date,Ze=["upcoming","confirmed"];return Ve.getTime()>Re.getTime()&&Ze.includes(re.status)},ke=re=>{if(re.status!=="upcoming")return!1;const je=O(re.date,re.time);if(!je)return!1;const ie=re.duration||1,Re=new Date(je.getTime()+ie*60*60*1e3);return new Date>=Re},me={total:r.length,pending:r.filter(re=>re.status==="pending").length,awaiting_payment:r.filter(re=>re.status==="awaiting_payment").length,confirmed:r.filter(re=>re.status==="confirmed").length,upcoming:oe()};return o.jsxs("div",{className:"space-y-3 sm:space-y-4 md:space-y-6 pb-6 sm:pb-8 md:pb-10",children:[o.jsx(Kc,{"aria-label":"Notification messages"}),o.jsxs("div",{className:"bg-gradient-to-br from-primary-600 via-primary-700 to-primary-800 rounded-xl sm:rounded-2xl p-4 sm:p-5 md:p-6 text-white shadow-2xl relative overflow-hidden -mx-2 sm:-mx-3 md:mx-0",children:[o.jsxs("div",{className:"absolute inset-0 opacity-20",children:[o.jsx("div",{className:"absolute top-0 right-0 w-40 h-40 bg-white rounded-full -mr-20 -mt-20 blur-2xl"}),o.jsx("div",{className:"absolute bottom-0 left-0 w-32 h-32 bg-white rounded-full -ml-16 -mb-16 blur-2xl"})]}),o.jsx("div",{className:"relative flex items-center justify-between",children:o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsxs("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold mb-1 drop-shadow-lg flex items-center gap-2 sm:gap-3",children:[o.jsx(Gm,{className:"h-6 w-6 sm:h-7 sm:w-7 md:h-8 md:w-8 flex-shrink-0"}),o.jsx("span",{className:"truncate",children:"Session Handling"})]}),o.jsx("p",{className:"text-xs sm:text-sm md:text-base text-white/90 leading-tight",children:"Manage booking requests and payment confirmations"})]})})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-3 sm:gap-4",children:[o.jsx(Lt,{className:"p-4 sm:p-5 md:p-6 bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl shadow-xl border border-slate-200/50 hover:shadow-2xl transition-all duration-300",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-2.5 sm:p-3 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl mr-3 flex-shrink-0 shadow-lg",children:o.jsx(Gm,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-xs sm:text-sm font-semibold text-slate-600 uppercase tracking-wide",children:"Total Requests"}),o.jsx("p",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-primary-700",children:me.total})]})]})}),o.jsx(Lt,{className:"p-4 sm:p-5 md:p-6 bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl shadow-xl border border-slate-200/50 hover:shadow-2xl transition-all duration-300",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-2.5 sm:p-3 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl mr-3 flex-shrink-0 shadow-lg",children:o.jsx(Un,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-xs sm:text-sm font-semibold text-slate-600 uppercase tracking-wide",children:"Pending"}),o.jsx("p",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-primary-700",children:me.pending})]})]})}),o.jsx(Lt,{className:"p-4 sm:p-5 md:p-6 bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl shadow-xl border border-slate-200/50 hover:shadow-2xl transition-all duration-300",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-2.5 sm:p-3 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl mr-3 flex-shrink-0 shadow-lg",children:o.jsx(vc,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-xs sm:text-sm font-semibold text-slate-600 uppercase tracking-wide",children:"Awaiting Payment"}),o.jsx("p",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-primary-700",children:me.awaiting_payment})]})]})})]}),o.jsx(Lt,{className:"p-3 sm:p-4 md:p-5 bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl shadow-xl border border-slate-200/50",children:o.jsx("div",{className:"flex flex-wrap gap-2",children:[{key:"all",label:"All Requests"},{key:"pending",label:"Pending"},{key:"awaiting_payment",label:"Awaiting Payment"},{key:"confirmed",label:"Confirmed"},{key:"upcoming",label:"Upcoming"},{key:"declined",label:"Declined"}].map(re=>o.jsx("button",{onClick:()=>x(re.key),className:`px-3 sm:px-4 py-2 rounded-xl text-xs sm:text-sm font-semibold transition-all shadow-md hover:shadow-lg touch-manipulation ${p===re.key?"bg-gradient-to-r from-primary-600 to-primary-700 text-white":"text-slate-600 hover:text-slate-800 bg-white border-2 border-slate-200 hover:border-primary-300"}`,style:{WebkitTapHighlightColor:"transparent"},children:o.jsxs("span",{className:"inline-flex items-center space-x-1 sm:space-x-1.5 md:space-x-2",children:[o.jsx("span",{children:re.label}),re.key==="pending"&&K&&o.jsx("span",{className:"inline-flex items-center justify-center px-1 sm:px-1.5 py-0.5 rounded-full text-[9px] sm:text-[10px] font-semibold bg-red-100 text-red-700 border border-red-200",children:me.pending}),re.key==="awaiting_payment"&&z&&o.jsx("span",{className:"inline-flex items-center justify-center px-1 sm:px-1.5 py-0.5 rounded-full text-[9px] sm:text-[10px] font-semibold bg-red-100 text-red-700 border border-red-200",children:"New"})]})},re.key))})}),o.jsx("div",{className:"space-y-3 sm:space-y-4 pb-4",children:Te.length===0?o.jsxs(Lt,{className:"p-6 sm:p-8 text-center",children:[o.jsx(Gm,{className:"h-10 w-10 sm:h-12 sm:w-12 text-slate-400 mx-auto mb-3 sm:mb-4"}),o.jsx("h3",{className:"text-base sm:text-lg font-medium text-slate-900 mb-1",children:"No booking requests"}),o.jsx("p",{className:"text-xs sm:text-sm md:text-base text-slate-600",children:p==="all"?"You haven't received any booking requests yet.":`No ${p.replace("_"," ")} requests found.`})]}):Te.map(re=>{const je={pending:"bg-gradient-to-r from-yellow-500 to-amber-500",accepted:"bg-gradient-to-r from-primary-500 to-primary-700",confirmed:"bg-gradient-to-r from-green-500 to-emerald-500",awaiting_payment:"bg-gradient-to-r from-orange-500 to-amber-500",upcoming:"bg-gradient-to-r from-primary-500 to-primary-700",completed:"bg-gradient-to-r from-purple-500 to-primary-700",declined:"bg-gradient-to-r from-red-500 to-rose-500",cancelled:"bg-gradient-to-r from-slate-500 to-slate-600"};return o.jsxs(Lt,{className:`group relative bg-gradient-to-br from-white to-primary-50/30 rounded-xl sm:rounded-2xl shadow-lg border-2 ${Se(re)?"border-red-300 hover:border-red-400 bg-red-50/50":"border-slate-200 hover:border-primary-300"} p-4 sm:p-5 md:p-6 transition-all duration-300 overflow-hidden`,children:[o.jsx("div",{className:`absolute top-0 left-0 right-0 h-1 ${je[re.status]||"bg-gradient-to-r from-primary-500 to-primary-700"}`}),o.jsxs("div",{className:"flex flex-col gap-4 sm:gap-5",children:[o.jsx("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3 sm:gap-4",children:o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3 mb-2 sm:mb-3",children:[o.jsx("h3",{className:"text-lg sm:text-xl md:text-2xl font-bold text-slate-900 break-words",children:re.subject}),o.jsx("button",{onClick:async()=>{var Re,Ve,Ze,bt;const ie=re.student.user_id;if(!ie){gt.error("Student ID not available");return}k(!0),N({user_id:ie,name:re.student.name,email:re.student.email,profile_image_url:((Re=re.student)==null?void 0:Re.profile_image_url)||((Ve=re.student)==null?void 0:Ve.profile_image)||""}),E(!0);try{let tt=null;try{tt=(await we.get(`/users/${ie}/profile`)).data}catch{try{tt=(await we.get(`/users/${ie}`)).data}catch(mt){console.warn("No detailed profile endpoints available, will use booking student info",mt),tt={user_id:ie,...re.student}}}try{const St=await we.get(`/users/${ie}/bookings`),mt=Array.isArray(St.data)?St.data:Array.isArray((Ze=St.data)==null?void 0:Ze.data)?St.data.data:Array.isArray((bt=St.data)==null?void 0:bt.bookings)?St.data.bookings:[];tt._bookingsCount=mt.length}catch{}N(tt||{user_id:ie,...re.student})}catch(tt){console.warn("Failed to fetch full tutee profile, falling back to minimal data",tt),N({user_id:ie,...re.student})}finally{k(!1)}},className:"inline-flex items-center justify-center p-1.5 sm:p-2 rounded-lg bg-primary-50 hover:bg-primary-100 active:bg-primary-200 text-primary-600 touch-manipulation transition-colors shadow-sm hover:shadow-md",title:"View tutee profile",style:{WebkitTapHighlightColor:"transparent"},children:o.jsx(Xo,{className:"h-4 w-4 sm:h-5 sm:w-5"})})]}),o.jsx("div",{className:"mb-3",children:o.jsxs("div",{className:`inline-flex items-center px-3 sm:px-4 py-1.5 sm:py-2 rounded-xl text-xs sm:text-sm md:text-base font-bold gap-1.5 sm:gap-2 shadow-md border-2 ${J(re.status)}`,children:[se(re.status),o.jsx("span",{className:"h-2.5 w-2.5 rounded-full",style:{backgroundColor:re.status==="pending"?"#eab308":re.status==="confirmed"?"#16a34a":re.status==="awaiting_payment"?"#f97316":re.status==="declined"?"#dc2626":"#3b82f6"}}),o.jsx("span",{className:"whitespace-nowrap",children:re.status.replace("_"," ").charAt(0).toUpperCase()+re.status.replace("_"," ").slice(1)})]})}),o.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3 text-xs sm:text-sm text-slate-600 mb-3",children:[o.jsxs("span",{className:"flex items-center gap-1.5 px-2.5 py-1.5 bg-white rounded-lg border border-slate-200 shadow-sm",children:[o.jsx(za,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 text-primary-600 flex-shrink-0"}),o.jsx("span",{className:"truncate max-w-[120px] sm:max-w-none",children:re.student.name})]}),o.jsxs("span",{className:"flex items-center gap-1.5 px-2.5 py-1.5 bg-white rounded-lg border border-slate-200 shadow-sm",children:[o.jsx(Mi,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 text-primary-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),o.jsx("span",{className:"whitespace-nowrap",children:new Date(re.date).toLocaleDateString()})]}),o.jsxs("span",{className:"flex items-center gap-1.5 px-2.5 py-1.5 bg-white rounded-lg border border-slate-200 shadow-sm",children:[o.jsx(Un,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 text-primary-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),o.jsx("span",{className:"whitespace-nowrap",children:re.time})]}),o.jsxs("span",{className:"flex items-center gap-1.5 px-2.5 py-1.5 bg-white rounded-lg border border-slate-200 shadow-sm",children:[o.jsx(Un,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 text-primary-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),o.jsxs("span",{className:"whitespace-nowrap",children:[re.duration," ",re.duration===1?"hour":"hours"]})]})]}),re.student_notes&&o.jsx("div",{className:"p-3 sm:p-4 bg-gradient-to-br from-slate-50 to-primary-50/50 rounded-xl border-2 border-slate-200 shadow-sm",children:o.jsxs("div",{className:"flex items-start gap-2 sm:gap-3",children:[o.jsx("div",{className:"p-1.5 sm:p-2 bg-primary-100 rounded-lg flex-shrink-0 mt-0.5",children:o.jsx(bs,{className:"h-4 w-4 sm:h-5 sm:w-5 text-primary-600"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h4",{className:"text-xs sm:text-sm md:text-base font-semibold text-slate-800 mb-1.5 sm:mb-2",children:"Student Notes"}),o.jsx("p",{className:"text-xs sm:text-sm md:text-base text-slate-700 leading-relaxed whitespace-pre-wrap break-words",children:re.student_notes})]})]})})]})}),o.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-3 p-3 sm:p-4 bg-gradient-to-r from-primary-50 via-primary-100/50 to-primary-50 rounded-xl border-2 border-primary-200/50 shadow-sm",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-xs sm:text-sm font-semibold text-slate-700",children:"Requested:"}),o.jsx("span",{className:"text-xs sm:text-sm md:text-base font-medium text-slate-900",children:new Date(re.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-3 sm:gap-4 pt-4 sm:pt-5 border-t-2 border-slate-200 mt-4",children:[o.jsx("div",{className:"hidden sm:block text-[10px] sm:text-xs text-slate-500"}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2.5 sm:gap-2 w-full sm:w-auto",children:[re.status==="pending"&&o.jsxs(o.Fragment,{children:[o.jsxs(at,{onClick:()=>{P(re),A(!0)},disabled:i,className:"bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 active:from-green-800 active:to-emerald-800 text-white rounded-xl px-5 py-3 shadow-md hover:shadow-lg transition-all text-sm sm:text-base font-semibold flex items-center justify-center gap-2 w-full sm:w-auto touch-manipulation min-h-[44px]",style:{WebkitTapHighlightColor:"transparent"},children:[o.jsx(Zn,{className:"h-5 w-5 flex-shrink-0"}),o.jsx("span",{children:"Accept"})]}),o.jsxs(at,{variant:"secondary",onClick:()=>B(re.id,"decline"),disabled:i,className:"bg-gradient-to-r from-red-600 to-rose-600 hover:from-red-700 hover:to-rose-700 active:from-red-800 active:to-rose-800 text-white rounded-xl px-5 py-3 shadow-md hover:shadow-lg transition-all text-sm sm:text-base font-semibold flex items-center justify-center gap-2 w-full sm:w-auto touch-manipulation min-h-[44px]",style:{WebkitTapHighlightColor:"transparent"},children:[o.jsx(Rn,{className:"h-5 w-5 flex-shrink-0"}),o.jsx("span",{children:"Decline"})]})]}),(re.status==="upcoming"||re.status==="confirmed")&&o.jsxs(at,{variant:"secondary",onClick:()=>{W(re),R(!0)},disabled:i,className:"bg-gradient-to-r from-primary-600 to-primary-700 hover:from-primary-700 hover:to-primary-800 active:from-primary-800 active:to-primary-900 text-white rounded-xl px-5 py-3 shadow-md hover:shadow-lg transition-all text-sm sm:text-base font-semibold flex items-center justify-center gap-2 w-full sm:w-auto touch-manipulation min-h-[44px]",style:{WebkitTapHighlightColor:"transparent"},children:[o.jsx(Un,{className:"h-5 w-5 flex-shrink-0"}),o.jsx("span",{children:"Reschedule"})]}),ke(re)&&o.jsxs(at,{onClick:()=>U(re.id),disabled:i,className:"bg-gradient-to-r from-primary-600 to-primary-700 hover:from-primary-700 hover:to-primary-800 active:from-primary-800 active:to-primary-900 text-white rounded-xl px-5 py-3 shadow-md hover:shadow-lg transition-all text-sm sm:text-base font-semibold flex items-center justify-center gap-2 w-full sm:w-auto touch-manipulation min-h-[44px]",style:{WebkitTapHighlightColor:"transparent"},children:[o.jsx(Zn,{className:"h-5 w-5 flex-shrink-0"}),o.jsx("span",{children:"Mark as done"})]})]})]})]},re.id)})}),T&&o.jsx(On,{isOpen:!0,onClose:()=>{E(!1),N(null)},title:"Tutee Profile",footer:o.jsx(at,{onClick:()=>{E(!1),N(null)},children:"Close"}),children:S?o.jsx("div",{className:"text-slate-600",children:"Loading profile..."}):o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("div",{className:"h-20 w-20 rounded-full overflow-hidden border",children:o.jsx("img",{src:Zt((b==null?void 0:b.profile_image_url)||(b==null?void 0:b.profile_image)||""),alt:(b==null?void 0:b.name)||"Tutee",className:"w-full h-full object-cover",onError:re=>{re.target.src=`https://ui-avatars.com/api/?name=${encodeURIComponent((b==null?void 0:b.name)||"Tutee")}`}})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("div",{className:"text-xl font-semibold",children:(b==null?void 0:b.name)||(b==null?void 0:b.email)}),o.jsx("div",{className:"text-sm text-slate-600",children:b==null?void 0:b.email}),b!=null&&b.university_name||b!=null&&b.university_id?o.jsx("div",{className:"text-sm text-slate-500 mt-1",children:(b==null?void 0:b.university_name)||""}):null]}),o.jsxs("div",{className:"flex flex-col items-end gap-2",children:[o.jsxs("div",{className:"text-sm text-slate-500",children:["Joined: ",b!=null&&b.created_at?new Date(b.created_at).toLocaleDateString():""]}),o.jsxs("div",{className:"text-sm text-slate-500",children:["Bookings: ",(b==null?void 0:b._bookingsCount)??""]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"space-y-2",children:[b!=null&&b.course_name||b!=null&&b.course_id?o.jsxs("div",{children:[o.jsx("strong",{children:"Course:"})," ",(b==null?void 0:b.course_name)||""]}):null,b!=null&&b.year_level?o.jsxs("div",{children:[o.jsx("strong",{children:"Year level:"})," ",b.year_level]}):null,b!=null&&b.phone||b!=null&&b.contact_number?o.jsxs("div",{children:[o.jsx("strong",{children:"Phone:"})," ",b.phone||b.contact_number," ",o.jsx("button",{onClick:async()=>{try{await navigator.clipboard.writeText(b.phone||b.contact_number),gt.success("Phone copied")}catch{gt.error("Unable to copy")}},className:"ml-2 text-xs text-primary-600",children:"Copy"})]}):null,b!=null&&b.city||b!=null&&b.country?o.jsxs("div",{children:[o.jsx("strong",{children:"Location:"})," ",[b.city,b.country].filter(Boolean).join(", ")]}):null]}),o.jsxs("div",{className:"space-y-2",children:[(b==null?void 0:b.bio)&&o.jsxs("div",{children:[o.jsx("strong",{children:"Bio"}),o.jsx("p",{className:"text-sm text-slate-700 mt-1",children:b.bio})]}),o.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[(b==null?void 0:b.email)&&o.jsx("a",{href:`mailto:${b.email}`,className:"px-3 py-1 bg-primary-600 text-white rounded-md text-sm",children:"Send email"}),(b==null?void 0:b.phone)&&o.jsx("button",{onClick:async()=>{try{await navigator.clipboard.writeText(b.phone),gt.success("Phone copied")}catch{gt.error("Unable to copy")}},className:"px-3 py-1 border rounded-md text-sm",children:"Copy phone"})]})]})]})]})}),D&&I&&o.jsx(On,{isOpen:!0,onClose:()=>{A(!1),P(null)},title:"Confirm Accept Booking",footer:o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:async()=>{await B(I.id,"accept"),A(!1),P(null)},disabled:i,className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 shadow-md",children:i?"Accepting...":"Confirm Accept"}),o.jsx("button",{onClick:()=>{A(!1),P(null)},className:"px-4 py-2 border rounded-md hover:bg-slate-100 ml-2",children:"Cancel"})]}),children:o.jsx("div",{className:"space-y-4",children:o.jsxs("div",{className:"rounded-lg overflow-hidden shadow-sm",children:[o.jsxs("div",{className:"bg-gradient-to-r from-green-600 to-emerald-500 p-4 text-white flex items-center gap-4",children:[o.jsx("div",{className:"h-16 w-16 rounded-full overflow-hidden flex-shrink-0 border-2 border-white shadow-lg",children:o.jsx("img",{src:I.student.profile_image_url?Zt(I.student.profile_image_url):`https://ui-avatars.com/api/?name=${encodeURIComponent(I.student.name)}&background=10b981&color=fff&size=128`,alt:I.student.name,className:"w-full h-full object-cover",onError:re=>{re.target.src=`https://ui-avatars.com/api/?name=${encodeURIComponent(I.student.name)}&background=10b981&color=fff&size=128`}})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"font-semibold text-lg truncate",children:["Accept booking from ",I.student.name]}),o.jsx("div",{className:"text-sm opacity-90 truncate",children:I.student.email})]}),o.jsxs("div",{className:"ml-auto text-sm inline-flex items-center bg-white/20 px-2 py-1 rounded text-white flex-shrink-0",children:[I.duration," hr",I.duration!==1?"s":""]})]}),o.jsxs("div",{className:"p-4 bg-white",children:[o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[o.jsxs("div",{className:"text-sm",children:[o.jsx("div",{className:"font-medium",children:"Subject"}),o.jsx("div",{className:"text-slate-700",children:I.subject})]}),o.jsxs("div",{className:"text-sm",children:[o.jsx("div",{className:"font-medium",children:"When"}),o.jsxs("div",{className:"text-slate-700",children:[new Date(I.date).toLocaleDateString(),"  ",I.time]})]}),o.jsxs("div",{className:"text-sm sm:col-span-2",children:[o.jsx("div",{className:"font-medium",children:"Notes"}),o.jsx("div",{className:"text-slate-700",children:I.student_notes||"No notes"})]})]}),o.jsx("div",{className:"mt-3 text-xs text-slate-500",children:"Accepting will notify the student that their booking is approved. You can still cancel later if needed."})]})]})})}),c&&o.jsx(Lt,{className:"p-4 sm:p-5 mb-4",children:o.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h3",{className:"text-base sm:text-lg font-medium text-slate-800",children:"Loading tutor information"}),o.jsx("p",{className:"text-xs sm:text-sm text-slate-500 mt-1",children:"Resolving your tutor profile. This may take a moment."})]}),o.jsx("div",{className:"text-xs sm:text-sm text-slate-500",children:"Please wait"})]})}),h&&o.jsx(Lt,{className:"p-4 sm:p-5 border-2 border-red-200 bg-red-50 mb-4",children:o.jsxs("div",{className:"flex flex-col sm:flex-row items-start justify-between gap-4",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h3",{className:"text-base sm:text-lg font-medium text-red-800",children:"Failed to load tutor information"}),o.jsx("p",{className:"text-xs sm:text-sm text-red-700 mt-2 break-words",children:h}),o.jsx("p",{className:"text-xs sm:text-sm text-slate-500 mt-2",children:"Possible causes: backend not running, expired session, or missing tutor profile."})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:[o.jsx(at,{onClick:()=>H(),className:"px-4 py-2.5 text-sm min-h-[44px] w-full sm:w-auto",children:"Retry"}),o.jsx(at,{variant:"secondary",onClick:()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),e("/login")},className:"px-4 py-2.5 text-sm min-h-[44px] w-full sm:w-auto",children:"Sign in again"})]})]})}),$&&F&&o.jsx(JZ,{open:$,bookingId:F.id,onClose:()=>{R(!1),W(null)},onSuccess:()=>{R(!1),W(null),Y()}})]})},cKe=()=>o.jsx(PH,{children:o.jsx(lKe,{})}),uKe=()=>{const{user:t}=rr(),{notify:e}=Mh();qr();const[n,s]=j.useState(null),[r,a]=j.useState([]),[i,l]=j.useState([]),[c,u]=j.useState([]),[h,f]=j.useState([]),[p,x]=j.useState({total_earnings:0,pending_earnings:0,completed_sessions:0,average_rating:0,total_hours:0}),[y,v]=j.useState(!1),[b,N]=j.useState(!1),[S,k]=j.useState(null),[T,E]=j.useState(""),[D,A]=j.useState({}),[I,P]=j.useState({}),[$,R]=j.useState("all"),[F,W]=j.useState("all"),[q,X]=j.useState(!1),[z,K]=j.useState(6);j.useEffect(()=>{t!=null&&t.user_id&&(async()=>{try{const ie=(await we.get(`/tutors/by-user/${t.user_id}/tutor-id`)).data.tutor_id;s(ie||t.user_id)}catch(je){console.error("Failed to fetch tutor ID:",je),s(t.user_id)}})()},[t]),j.useEffect(()=>{if(n){(async()=>{await H(!0),X(!0)})();const je=setInterval(()=>{H(!1)},1e4),ie=()=>H(!1);return window.addEventListener("focus",ie),()=>{clearInterval(je),window.removeEventListener("focus",ie)}}},[n]);const H=async(re=!1)=>{if(n)try{re&&v(!0);const[je,ie,Re,Ve,Ze]=await Promise.all([we.get(`/tutors/${n}/sessions`),we.get(`/tutors/${n}/payments`),we.get(`/tutors/${n}/payouts`),we.get(`/tutors/${n}/earnings-stats`),we.get(`/tutors/${n}/booking-requests`)]);a(je.data),l(ie.data),u(Re.data||[]),x(Ve.data),f(Ze.data||[])}catch(je){console.error("Failed to fetch earnings data:",je)}finally{re&&v(!1)}},Y=re=>{switch(re){case"completed":return"text-green-600 bg-green-50 border-green-200";case"pending":return"text-yellow-600 bg-yellow-50 border-yellow-200";case"cancelled":return"text-red-600 bg-red-50 border-red-200";case"approved":return"text-primary-600 bg-primary-50 border-primary-200";case"confirmed":return"text-green-600 bg-green-50 border-green-200";case"admin_confirmed":return"text-blue-600 bg-blue-50 border-blue-200";case"admin_paid":return"text-emerald-600 bg-emerald-50 border-emerald-200";case"rejected":return"text-red-600 bg-red-50 border-red-200";case"refunded":return"text-purple-600 bg-purple-50 border-purple-200";case"paid":return"text-green-600 bg-green-50 border-green-200";default:return"text-slate-600 bg-slate-50 border-slate-200"}},B=re=>{switch(re){case"completed":return o.jsx(Zn,{className:"h-4 w-4"});case"pending":return o.jsx(Un,{className:"h-4 w-4"});case"cancelled":return o.jsx(Rn,{className:"h-4 w-4"});case"approved":return o.jsx(Zn,{className:"h-4 w-4"});case"confirmed":return o.jsx(Zn,{className:"h-4 w-4"});case"admin_confirmed":return o.jsx(Zn,{className:"h-4 w-4"});case"admin_paid":return o.jsx(To,{className:"h-4 w-4"});case"rejected":return o.jsx(Rn,{className:"h-4 w-4"});case"refunded":return o.jsx(To,{className:"h-4 w-4"});case"paid":return o.jsx(To,{className:"h-4 w-4"});default:return o.jsx(Un,{className:"h-4 w-4"})}};r.filter(re=>$==="all"?!0:re.status===$);const O=j.useMemo(()=>{const re=c.map(je=>{var Ve,Ze;const ie=je.payment_id||((Ve=je.payment)==null?void 0:Ve.payment_id)||((Ze=je.payment)==null?void 0:Ze.id),Re=ie?Number(ie):null;return Re&&!isNaN(Re)?Re:null}).filter(je=>je!==null&&!isNaN(je));return c.length>0&&(console.log("[EarningsHistory] Payouts:",c),console.log("[EarningsHistory] Payment IDs from payouts:",re)),new Set(re)},[c]),U=j.useMemo(()=>{const re=i.filter(ie=>ie.status==="confirmed"),je=re.filter(ie=>{const Re=ie.payment_id||ie.id,Ve=Re?Number(Re):null;if(Ve===null||isNaN(Ve))return console.warn("[EarningsHistory] Payment with invalid ID:",ie),!1;const Ze=O.has(Ve);return Ze&&console.log(`[EarningsHistory] Excluding payment ${Ve} - has payout`),!Ze});return console.log(`[EarningsHistory] Total payments: ${i.length}`),console.log(`[EarningsHistory] Confirmed payments: ${re.length}`),console.log(`[EarningsHistory] Confirmed without payouts: ${je.length}`),console.log("[EarningsHistory] Payment IDs with payouts:",Array.from(O)),je},[i,O]);i.filter(re=>re.status==="pending").length,U.length;const J=j.useMemo(()=>F==="all"||F==="approved"?U:i.filter(re=>re.status===F),[F,U,i]),se=j.useMemo(()=>i.filter(re=>{const je=re.payment_id||re.id,ie=je?Number(je):null;return re.status==="confirmed"&&ie!==null&&!O.has(ie)}),[i,O]),ae=j.useMemo(()=>Array.from({length:z},(je,ie)=>{const Re=new Date;return Re.setMonth(Re.getMonth()-(z-1-ie)),{month:Re.toLocaleDateString("en-US",{month:"short"}),monthIndex:Re.getMonth(),year:Re.getFullYear()}}).map(({month:je,monthIndex:ie,year:Re})=>{const Ze=c.filter(mt=>{if(!mt.created_at)return!1;const jt=new Date(mt.created_at);return jt.getMonth()===ie&&jt.getFullYear()===Re}).reduce((mt,jt)=>mt+Number(jt.amount_released||0),0),bt=Ze/.87,tt=Ze,St=bt*.13;return{month:je,"Gross Amount":Number(bt.toFixed(2)),"Net Earnings":Number(tt.toFixed(2)),"Service Fee":Number(St.toFixed(2))}}),[c,z]),fe=j.useMemo(()=>c.filter(re=>re.status==="released").reduce((re,je)=>re+Number(je.amount_released||0),0),[c]),ye=j.useMemo(()=>!se||se.length===0?0:se.reduce((re,je)=>{const Re=(Number(je.amount)||0)*.87;return re+Re},0),[se]),Te=j.useMemo(()=>!se||se.length===0?0:se.reduce((re,je)=>{const Re=(Number(je.amount)||0)*.13;return re+Re},0),[se]),oe=j.useMemo(()=>!se||se.length===0?0:se.reduce((re,je)=>{const ie=Number(je.amount)||0;return re+ie},0),[se]),Se=re=>Array.from({length:5},(je,ie)=>o.jsx(ja,{className:`h-4 w-4 ${ie<Math.floor(re)?"text-yellow-400 fill-current":"text-slate-300"}`},ie)),ke=j.useMemo(()=>h.filter(re=>re.status&&re.status.toLowerCase()==="completed").length,[h]),me=j.useMemo(()=>{const re={};return h.forEach(ie=>{ie.tutee_rating&&ie.tutee_rating>0&&ie.subject&&(re[ie.subject]||(re[ie.subject]=[]),re[ie.subject].push(Number(ie.tutee_rating)))}),Object.entries(re).map(([ie,Re])=>{const Ze=Re.reduce((bt,tt)=>bt+tt,0)/Re.length;return{subject:ie,averageRating:Ze,totalRatings:Re.length}}).sort((ie,Re)=>Re.averageRating-ie.averageRating)},[h]);return y?o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600 mx-auto mb-4"}),o.jsx("p",{className:"text-slate-600",children:"Loading earnings data..."})]})}):o.jsxs("div",{className:"space-y-3 sm:space-y-4 md:space-y-6 pb-6 sm:pb-8 md:pb-10",children:[o.jsxs("div",{className:"bg-gradient-to-br from-primary-600 via-primary-700 to-primary-800 rounded-xl sm:rounded-2xl p-4 sm:p-5 md:p-6 text-white shadow-2xl relative overflow-hidden -mx-2 sm:-mx-3 md:mx-0",children:[o.jsxs("div",{className:"absolute inset-0 opacity-20",children:[o.jsx("div",{className:"absolute top-0 right-0 w-40 h-40 bg-white rounded-full -mr-20 -mt-20 blur-2xl"}),o.jsx("div",{className:"absolute bottom-0 left-0 w-32 h-32 bg-white rounded-full -ml-16 -mb-16 blur-2xl"})]}),o.jsx("div",{className:"relative flex items-center justify-between",children:o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsxs("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold mb-1 drop-shadow-lg flex items-center gap-2 sm:gap-3",children:[o.jsx(To,{className:"h-6 w-6 sm:h-7 sm:w-7 md:h-8 md:w-8 flex-shrink-0"}),o.jsx("span",{className:"truncate",children:"Earnings & History"})]}),o.jsx("p",{className:"text-xs sm:text-sm md:text-base text-white/90 leading-tight",children:"Track your completed sessions and earnings"})]})})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3 sm:gap-4",children:[o.jsx(Lt,{className:"p-4 sm:p-5 md:p-6 bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl shadow-xl border border-slate-200/50 hover:shadow-2xl transition-all duration-300 -mx-2 sm:-mx-3 md:mx-0",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-2.5 sm:p-3 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl mr-3 flex-shrink-0 shadow-lg",children:o.jsx(To,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-xs sm:text-sm font-semibold text-slate-600 uppercase tracking-wide",children:"Total Earnings"}),o.jsxs("p",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-primary-700 truncate",children:["",fe.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})}),o.jsx(Lt,{className:"p-4 sm:p-5 md:p-6 bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl shadow-xl border border-slate-200/50 hover:shadow-2xl transition-all duration-300 -mx-2 sm:-mx-3 md:mx-0",children:o.jsxs("div",{className:"flex items-center",children:[o.jsx("div",{className:"p-2.5 sm:p-3 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl mr-3 flex-shrink-0 shadow-lg",children:o.jsx(Zn,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-xs sm:text-sm font-semibold text-slate-600 uppercase tracking-wide",children:"Completed Sessions"}),o.jsx("p",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-primary-700",children:ke})]})]})})]}),me.length>0&&o.jsxs(Lt,{className:"p-4 sm:p-5 md:p-6 bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl shadow-xl border border-slate-200/50 hover:shadow-2xl transition-all duration-300 -mx-2 sm:-mx-3 md:mx-0",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl shadow-lg",children:o.jsx(ja,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"Average Rating per Subject"})]}),o.jsx("div",{className:"space-y-3 sm:space-y-4",children:me.map(re=>o.jsxs("div",{className:"flex items-center justify-between p-3 sm:p-4 bg-slate-50 rounded-lg border border-slate-200 hover:bg-slate-100 transition-colors",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-sm sm:text-base font-semibold text-slate-900 mb-1 truncate",children:re.subject}),o.jsxs("p",{className:"text-xs sm:text-sm text-slate-600",children:[re.totalRatings," ",re.totalRatings===1?"rating":"ratings"]})]}),o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 ml-4",children:[o.jsx("div",{className:"flex items-center gap-1",children:Se(re.averageRating)}),o.jsx("span",{className:"text-base sm:text-lg md:text-xl font-bold text-primary-700 min-w-[3rem] text-right",children:re.averageRating.toFixed(1)})]})]},re.subject))})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-3 sm:gap-4",children:[o.jsxs(Lt,{className:"p-4 sm:p-5 md:p-6 bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl shadow-xl border border-slate-200/50 hover:shadow-2xl transition-all duration-300 -mx-2 sm:-mx-3 md:mx-0",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl shadow-lg",children:o.jsx(Du,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"Performance Overview"})]}),o.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-[10px] sm:text-xs md:text-sm text-slate-600",children:"Total Hours Tutored"}),o.jsxs("span",{className:"text-xs sm:text-sm md:text-base font-semibold text-slate-800",children:[p.total_hours," hours"]})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-[10px] sm:text-xs md:text-sm text-slate-600",children:"Average Session Duration"}),o.jsxs("span",{className:"text-xs sm:text-sm md:text-base font-semibold text-slate-800",children:[ke>0?(p.total_hours/ke).toFixed(1):"0"," hours"]})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-[10px] sm:text-xs md:text-sm text-slate-600",children:"Average Hourly Rate"}),o.jsxs("span",{className:"text-xs sm:text-sm md:text-base font-semibold text-slate-800",children:["",p.total_hours>0?(p.total_earnings/p.total_hours).toFixed(0):"0"]})]})]})]}),o.jsxs(Lt,{className:"p-4 sm:p-5 md:p-6 bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl shadow-xl border border-slate-200/50 hover:shadow-2xl transition-all duration-300 -mx-2 sm:-mx-3 md:mx-0",children:[o.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[o.jsx("div",{className:"p-2.5 bg-gradient-to-br from-primary-500 to-primary-700 rounded-xl shadow-lg",children:o.jsx(Mi,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold bg-gradient-to-r from-slate-800 to-slate-600 bg-clip-text text-transparent",children:"Upcoming Payouts"})]}),o.jsx("div",{className:"mb-4 p-3 sm:p-4 bg-gradient-to-r from-amber-50 via-yellow-50 to-amber-50 rounded-xl border-2 border-amber-200 shadow-sm",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx("div",{className:"p-2 bg-amber-100 rounded-lg flex-shrink-0",children:o.jsx(aU,{className:"h-4 w-4 sm:h-5 sm:w-5 text-amber-700"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h3",{className:"text-xs sm:text-sm font-bold text-amber-900 mb-1.5",children:"Service Fee Information"}),o.jsxs("p",{className:"text-[10px] sm:text-xs text-amber-800 mb-2",children:["A ",o.jsx("span",{className:"font-bold",children:"13% service fee"})," will be deducted from each payment you receive through TutorLink platform."]}),o.jsxs("div",{className:"grid grid-cols-3 gap-2 sm:gap-3 text-[10px] sm:text-xs",children:[o.jsxs("div",{className:"bg-white/60 rounded-lg p-2",children:[o.jsx("p",{className:"text-amber-700 font-medium",children:"Gross Income"}),o.jsxs("p",{className:"text-amber-900 font-bold text-sm sm:text-base",children:["",oe.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),o.jsxs("div",{className:"bg-white/60 rounded-lg p-2",children:[o.jsx("p",{className:"text-amber-700 font-medium",children:"Service Fee (13%)"}),o.jsxs("p",{className:"text-amber-900 font-bold text-sm sm:text-base",children:["",Te.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),o.jsxs("div",{className:"bg-white/60 rounded-lg p-2",children:[o.jsx("p",{className:"text-amber-700 font-medium",children:"Upcoming Earnings"}),o.jsxs("p",{className:"text-amber-900 font-bold text-sm sm:text-base",children:["",ye.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]}),o.jsx("div",{className:"mt-2 pt-2 border-t border-amber-200 bg-white/60 rounded-lg p-2",children:o.jsxs("p",{className:"text-[10px] sm:text-xs text-amber-700",children:["Upcoming Earnings are calculated as ",o.jsx("span",{className:"font-bold",children:"87%"})," of each confirmed payment. The system admin receives the tutees payment first and will transfer your earnings after you complete the tutoring session."]})})]})]})})]})]}),o.jsxs(Lt,{className:"p-4 sm:p-5 md:p-6 bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl shadow-xl border border-slate-200/50 hover:shadow-2xl transition-all duration-300 -mx-2 sm:-mx-3 md:mx-0",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 mb-3",children:[o.jsx("h3",{className:"text-xs sm:text-sm font-semibold text-slate-700",children:"Payment Trends"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("label",{htmlFor:"months-filter",className:"text-xs sm:text-sm text-slate-600 font-medium",children:"Display:"}),o.jsxs("select",{id:"months-filter",value:z,onChange:re=>K(Number(re.target.value)),className:"px-3 py-1.5 text-xs sm:text-sm border border-slate-300 rounded-lg bg-white text-slate-700 focus:ring-2 focus:ring-primary-500 focus:border-primary-500 transition-all",children:[o.jsx("option",{value:3,children:"Last 3 Months"}),o.jsx("option",{value:6,children:"Last 6 Months"}),o.jsx("option",{value:12,children:"Last 12 Months"})]})]})]}),o.jsx("div",{className:"bg-white rounded-lg p-3 sm:p-4 border border-slate-200",children:o.jsx(O1,{width:"100%",height:250,children:o.jsxs(P1,{data:ae,margin:{top:10,right:10,left:0,bottom:5},children:[o.jsx($g,{strokeDasharray:"3 3",stroke:"#e2e8f0"}),o.jsx(Ig,{dataKey:"month",tick:{fontSize:11,fill:"#64748b"},stroke:"#cbd5e1"}),o.jsx(Rg,{tick:{fontSize:11,fill:"#64748b"},stroke:"#cbd5e1",tickFormatter:re=>`${(re/1e3).toFixed(0)}k`}),o.jsx(R1,{formatter:re=>[`${re.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}`,""],contentStyle:{backgroundColor:"white",border:"1px solid #e2e8f0",borderRadius:"8px",padding:"8px 12px",fontSize:"12px"}}),o.jsx(Ax,{wrapperStyle:{fontSize:"11px",paddingTop:"10px"},iconType:"rect"}),o.jsx(oh,{dataKey:"Gross Amount",fill:"#3b82f6",radius:[4,4,0,0]}),o.jsx(oh,{dataKey:"Net Earnings",fill:"#10b981",radius:[4,4,0,0]}),o.jsx(oh,{dataKey:"Service Fee",fill:"#f59e0b",radius:[4,4,0,0]})]})})})]}),o.jsxs(Lt,{className:"p-4 sm:p-5 md:p-6 bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl shadow-xl border border-slate-200/50 hover:shadow-2xl transition-all duration-300 -mx-2 sm:-mx-3 md:mx-0",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-0 mb-3",children:[o.jsx("h3",{className:"text-sm sm:text-base font-semibold text-slate-800",children:"Payment History"}),o.jsx("div",{className:"flex flex-wrap gap-1 sm:gap-1.5",children:[{key:"all",label:"All"},{key:"pending",label:"Pending"},{key:"approved",label:"Approved"}].map(re=>o.jsx("button",{onClick:()=>W(re.key),className:`px-3 sm:px-4 py-1.5 sm:py-2 rounded-xl text-xs sm:text-sm font-semibold transition-all shadow-md hover:shadow-lg touch-manipulation ${F===re.key?"bg-gradient-to-r from-primary-600 to-primary-700 text-white":"text-slate-600 hover:text-slate-800 bg-white border-2 border-slate-200 hover:border-primary-300"}`,style:{WebkitTapHighlightColor:"transparent"},children:re.label},re.key))})]}),o.jsxs("div",{className:"space-y-2 sm:space-y-3 max-h-96 overflow-auto",children:[J.map(re=>o.jsxs("div",{className:"flex items-center justify-between p-2 sm:p-3 bg-slate-50 rounded-lg hover:bg-slate-100 transition-colors",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 sm:gap-2 md:gap-3 mb-1",children:[o.jsx("span",{className:"text-xs sm:text-sm md:text-base font-medium text-slate-800 break-words",children:re.student_name||"Unknown Student"}),o.jsx("span",{className:`px-1.5 sm:px-2 py-0.5 sm:py-1 rounded-full text-[10px] sm:text-xs font-medium border flex-shrink-0 ${Y(re.status)}`,children:o.jsxs("div",{className:"flex items-center space-x-0.5 sm:space-x-1",children:[B(re.status),o.jsx("span",{className:"whitespace-nowrap",children:re.status.charAt(0).toUpperCase()+re.status.slice(1)})]})})]}),o.jsxs("div",{className:"text-xs text-slate-500",children:["Payment ID: #",re.payment_id||re.id,"  ",new Date(re.created_at).toLocaleDateString(),re.subject&&o.jsxs("span",{className:"ml-2",children:[" Subject: ",re.subject]}),(re.status==="confirmed"||re.status==="admin_confirmed"||re.status==="admin_paid")&&re.admin_note&&o.jsx("span",{className:"ml-2 text-green-600",children:" Approved by Admin"}),re.admin_payment_proof_url&&o.jsxs("div",{className:"inline-flex items-center space-x-2 ml-2 mt-1",children:[o.jsx(at,{variant:"secondary",disabled:!re.admin_payment_proof_url,onClick:()=>{if(!re.admin_payment_proof_url)return;const je=re.admin_payment_proof_url,ie=Zt(je);k(ie),E("Admin payment proof"),N(!0),A(Re=>({...Re,[re.payment_id]:!0}))},className:"text-[10px] sm:text-xs py-1 px-2",children:"View admin proof"}),(()=>{const je=re.payment_id||re.id;return I[je]?null:o.jsx(at,{className:"ml-1 text-[10px] sm:text-xs py-1 px-2",onClick:async()=>{try{await we.patch(`/payments/${re.payment_id}/confirm`),e("Payment confirmed. Booking updated to Upcoming.","success",{label:"Hide Confirm",onClick:()=>P(ie=>({...ie,[je]:!0}))}),await H(!1)}catch(ie){console.error("Failed to confirm payment",ie),e("Failed to confirm payment. Please try again.","error")}},variant:"primary",disabled:re.status==="confirmed"||re.status==="admin_confirmed"||re.status==="admin_paid"||re.status==="rejected"||re.status==="refunded"||!re.admin_payment_proof_url||!D[re.payment_id],title:re.status==="confirmed"||re.status==="admin_confirmed"||re.status==="admin_paid"?"Already confirmed":re.admin_payment_proof_url?D[re.payment_id]?"Confirm payment (mark as received)":"Open the admin proof to enable Confirm":"Waiting for admin to upload proof",children:"Confirm"})})()]})]})]}),o.jsxs("div",{className:"ml-4 text-right",children:[o.jsx("span",{className:"text-xs text-slate-600 block mb-0.5",children:"Gross Amount"}),o.jsxs("span",{className:"font-semibold text-slate-800 block",children:["",Number(re.amount).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]}),(re.status==="confirmed"||re.status==="admin_confirmed"||re.status==="admin_paid")&&o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"text-xs text-slate-600 block mt-1.5 mb-0.5",children:"Net Amount"}),o.jsxs("span",{className:"text-[10px] text-slate-500 block",children:["",(Number(re.amount)*.87).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]},re.id||re.payment_id)),J.length===0&&o.jsx("p",{className:"text-slate-500 text-center py-4",children:"No payments found"})]})]}),b&&S&&o.jsx(On,{isOpen:b,onClose:()=>N(!1),title:T,children:o.jsx("div",{className:"flex justify-center",children:o.jsx("img",{src:S,alt:T,className:"max-w-full h-auto rounded"})})})]})},dKe=()=>{const[t,e]=j.useState([]),[n,s]=j.useState([]),[r,a]=j.useState([]),[i,l]=j.useState(!1),{user:c}=rr(),[u,h]=j.useState(new Date),[f,p]=j.useState(!1),[x,y]=j.useState(null),[v,b]=j.useState(null),[N,S]=j.useState(null),[k,T]=j.useState(null),[E,D]=j.useState(new Set);j.useEffect(()=>{const H=setInterval(()=>h(new Date),6e4);return()=>clearInterval(H)},[]);const A=(H,Y)=>{if(!H||!Y)return null;let B=new Date(`${H.split("T")[0]}T${Y}`);if(!isNaN(B.getTime()))return B;if(B=new Date(H),isNaN(B.getTime()))return null;const O=Y.match(/(\d{1,2}):(\d{2})(?::\d{2})?\s*(AM|PM)?/i);if(O){let U=parseInt(O[1],10);const J=parseInt(O[2],10),se=O[3];return se&&se.toLowerCase()==="pm"&&U<12&&(U+=12),se&&se.toLowerCase()==="am"&&U===12&&(U=0),B.setHours(U,J,0,0),B}return null},I=async()=>{var H,Y,B;if(!(c!=null&&c.user_id)){e([]);return}l(!0);try{const U=(H=(await we.get(`/tutors/by-user/${c.user_id}/tutor-id`)).data)==null?void 0:H.tutor_id;if(!U){e([]);return}S(U);try{const ie=await we.get(`/tutors/${U}/profile`);T(ie.data.session_rate_per_hour||null)}catch(ie){console.warn("Failed to fetch tutor profile for session rate:",ie)}const[J,se,ae]=await Promise.all([we.get(`/tutors/${U}/booking-requests`),we.get(`/tutors/${U}/payments`).catch(()=>({data:[]})),we.get(`/tutors/${U}/payouts`).catch(()=>({data:[]}))]),fe=(ae.data||[]).map(ie=>{var Ze,bt;const Re=ie.payment_id||((Ze=ie.payment)==null?void 0:Ze.payment_id)||((bt=ie.payment)==null?void 0:bt.id),Ve=Re?Number(Re):null;return Ve&&!isNaN(Ve)?Ve:null}).filter(ie=>ie!==null&&!isNaN(ie)),ye=new Set(fe);console.log("[SessionHistory] Payouts data:",ae.data),console.log("[SessionHistory] Payment IDs with payouts:",Array.from(ye));const Te=se.data||[];console.log("[SessionHistory] All tutor payments:",Te),console.log("[SessionHistory] Payment IDs with payouts:",Array.from(ye));const oe=new Map;Te.forEach(ie=>{const Re=ie.payment_id||ie.id,Ve=Re?Number(Re):null,Ze=ie.booking_request_id;if(Ze&&Ve!==null&&!isNaN(Ve)){const bt=Number(Ze);(!oe.has(bt)||ye.has(Ve))&&oe.set(bt,Ve)}}),console.log("[SessionHistory] Booking ID to Payment ID map:",Array.from(oe.entries()));const Se=new Set;oe.forEach((ie,Re)=>{const Ve=Number(ie);if(ye.has(Ve)){const Ze=Number(Re);Se.add(Ze),console.log(`[SessionHistory] Booking ${Ze} has payment ${Ve} with payout - will be excluded`)}}),console.log("[SessionHistory] Booking IDs with payouts (final):",Array.from(Se));const ke=Te.filter(ie=>{const Re=ie.payment_id||ie.id,Ve=Re?Number(Re):null;return ie.status==="confirmed"&&Ve!==null&&!isNaN(Ve)&&!ye.has(Ve)});s(Te),a(ae.data||[]),D(Se);let me=[];Array.isArray(J.data)?me=J.data:Array.isArray((Y=J.data)==null?void 0:Y.data)?me=J.data.data:(B=J.data)!=null&&B.bookings&&Array.isArray(J.data.bookings)&&(me=J.data.bookings);const je=me.map(ie=>{var bt,tt,St,mt,jt;const Re=[{value:ie.rating,comment:ie.rating_comment??ie.comment??ie.tutee_comment},{value:ie.tutee_rating,comment:ie.tutee_comment??ie.comment},{value:(bt=ie.feedback)==null?void 0:bt.rating,comment:(tt=ie.feedback)==null?void 0:tt.comment},{value:(St=ie.review)==null?void 0:St.rating,comment:(mt=ie.review)==null?void 0:mt.comment}];let Ve=null,Ze=null;for(const Oe of Re){const ht=Oe.value,ut=typeof ht=="number"?ht:typeof ht=="string"?Number(ht):null;if(ut!==null&&!Number.isNaN(ut)){Ve=ut,Ze=Oe.comment??null;break}}return{...ie,rating:Ve,rating_comment:Ze,session_rate_per_hour:ie.session_rate_per_hour||((jt=ie.tutor)==null?void 0:jt.session_rate_per_hour)||null}}).filter(ie=>ie.status==="upcoming"||ie.status==="awaiting_confirmation"||ie.status==="completed"||ie.status==="admin_payment_pending");e(je)}catch(O){console.error("Failed to fetch session history:",O),e([])}finally{l(!1)}};j.useEffect(()=>{I()},[c,u]);const P=H=>Array.from({length:5},(Y,B)=>o.jsx(ja,{className:`h-4 w-4 ${B<Math.floor(H)?"text-yellow-400 fill-current":"text-slate-300"}`},B)),$=j.useMemo(()=>{const H=r.map(Y=>{var U,J;const B=Y.payment_id||((U=Y.payment)==null?void 0:U.payment_id)||((J=Y.payment)==null?void 0:J.id),O=B?Number(B):null;return O&&!isNaN(O)?O:null}).filter(Y=>Y!==null&&!isNaN(Y));return new Set(H)},[r]),R=j.useMemo(()=>n.filter(B=>B.status==="confirmed").filter(B=>{const O=B.payment_id||B.id,U=O?Number(O):null;return U===null||isNaN(U)?!1:!$.has(U)}),[n,$]),F=j.useMemo(()=>{const H=t.filter(O=>O.status==="upcoming"),Y=new Set;R.forEach(O=>{const U=O.booking_request_id;U&&Y.add(Number(U))});const B=H.filter(O=>{const U=Number(O.id);if(E.has(U))return console.log(`[SessionHistory] Excluding upcoming session ${U} - has payment with payout`),!1;const se=n.find(ae=>{const fe=ae.payment_id||ae.id,ye=fe?Number(fe):null;return ae.booking_request_id===U&&ye!==null&&!isNaN(ye)&&$.has(ye)});return se?(console.log(`[SessionHistory] Excluding upcoming session ${U} - payment ${se.payment_id||se.id} has payout`),!1):!0});return console.log(`[SessionHistory] Total sessions: ${t.length}`),console.log(`[SessionHistory] Upcoming sessions (before filter): ${H.length}`),console.log(`[SessionHistory] Upcoming sessions (after filter): ${B.length}`),console.log("[SessionHistory] Booking IDs with payouts:",Array.from(E)),console.log("[SessionHistory] Payment IDs with payouts:",Array.from($)),console.log("[SessionHistory] Upcoming session IDs (after filter):",B.map(O=>O.id)),B},[t,E,R,n,$]),W=F.reduce((H,Y)=>{const B=Number(Y.duration??0);return H+(Number.isNaN(B)?0:B)},0),q=j.useMemo(()=>!F||F.length===0?0:F.reduce((H,Y)=>{const B=n.find(U=>{var ae;const J=U.booking_request_id||((ae=U.bookingRequest)==null?void 0:ae.id),se=Y.id;return J===se||J===Number(se)||Number(J)===se});let O=0;if(B&&B.amount)O=Number(B.amount)*.87;else{const U=Y.session_rate_per_hour||k||0,J=Number(Y.duration??0);O=U*J*.87}return H+O},0),[F,n,k]),X=H=>{if(H.status!=="upcoming")return!1;const Y=A(H.date,H.time);if(!Y)return!1;const B=H.duration||1,O=new Date(Y.getTime()+B*60*60*1e3);return u>=O},z=H=>{y(H),p(!0)},K=async()=>{var H,Y,B,O;if(!x||!v){gt.error("Please select a proof image to upload.");return}l(!0);try{const U=new FormData;U.append("file",v),U.append("status","awaiting_confirmation");const J=await we.post(`/tutors/booking-requests/${x.id}/complete`,U,{headers:{"Content-Type":"multipart/form-data"}});if((H=J.data)!=null&&H.success)gt.success("Session proof uploaded. Waiting for tutee confirmation."),p(!1),y(null),b(null),await I();else throw new Error(((Y=J.data)==null?void 0:Y.message)||"Failed to mark session")}catch(U){console.error("Failed to mark session for confirmation",U),gt.error(((O=(B=U==null?void 0:U.response)==null?void 0:B.data)==null?void 0:O.message)||(U==null?void 0:U.message)||"Failed to mark session")}finally{l(!1)}};return o.jsxs("div",{className:"space-y-3 sm:space-y-4 md:space-y-6 pb-6 sm:pb-8 md:pb-10",children:[o.jsx(Kc,{"aria-label":"Notification messages"}),o.jsxs("div",{className:"bg-gradient-to-br from-primary-600 via-primary-700 to-primary-800 rounded-xl sm:rounded-2xl p-4 sm:p-5 md:p-6 text-white shadow-2xl relative overflow-hidden -mx-2 sm:-mx-3 md:mx-0",children:[o.jsxs("div",{className:"absolute inset-0 opacity-20",children:[o.jsx("div",{className:"absolute top-0 right-0 w-40 h-40 bg-white rounded-full -mr-20 -mt-20 blur-2xl"}),o.jsx("div",{className:"absolute bottom-0 left-0 w-32 h-32 bg-white rounded-full -ml-16 -mb-16 blur-2xl"})]}),o.jsx("div",{className:"relative flex items-center justify-between",children:o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsxs("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold mb-1 drop-shadow-lg flex items-center gap-2 sm:gap-3",children:[o.jsx(X3,{className:"h-6 w-6 sm:h-7 sm:w-7 md:h-8 md:w-8 flex-shrink-0"}),o.jsx("span",{className:"truncate",children:"Session History"})]}),o.jsx("p",{className:"text-xs sm:text-sm md:text-base text-white/90 leading-tight",children:"View and manage your completed sessions"})]})})]}),i?o.jsx(Lt,{className:"p-6 sm:p-8 -mx-2 sm:-mx-3 md:mx-0",children:o.jsx("div",{className:"animate-pulse space-y-4",children:[1,2].map(H=>o.jsx("div",{className:"h-32 bg-slate-100 rounded-lg"},H))})}):t.length===0?o.jsxs(Lt,{className:"p-6 sm:p-8 text-center bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl shadow-xl border border-slate-200/50 -mx-2 sm:-mx-3 md:mx-0",children:[o.jsx("div",{className:"p-3 bg-gradient-to-br from-primary-100 to-primary-200 rounded-full w-16 h-16 sm:w-20 sm:h-20 mx-auto mb-4 flex items-center justify-center",children:o.jsx(X3,{className:"h-10 w-10 sm:h-12 sm:w-12 text-primary-600"})}),o.jsx("h3",{className:"text-lg sm:text-xl font-bold text-slate-900 mb-2",children:"No Upcoming Sessions"}),o.jsx("p",{className:"text-sm sm:text-base text-slate-600",children:"Your upcoming sessions will appear here."})]}):o.jsx("div",{className:"space-y-3 sm:space-y-4",children:t.map(H=>{var J;const Y=H.status==="upcoming",B=H.status==="awaiting_confirmation",O=H.status==="completed",U=H.status==="admin_payment_pending";return o.jsxs(Lt,{className:"group relative bg-gradient-to-br from-white to-slate-50 rounded-xl sm:rounded-2xl shadow-xl border-2 border-slate-200/50 hover:border-primary-300 p-4 sm:p-5 md:p-6 -mx-2 sm:-mx-3 md:mx-0 transition-all duration-300 overflow-hidden hover:shadow-2xl",children:[o.jsx("div",{className:`absolute top-0 left-0 right-0 h-1 ${O||U?"bg-gradient-to-r from-green-500 to-emerald-500":B?"bg-gradient-to-r from-yellow-500 to-amber-500":Y?"bg-gradient-to-r from-blue-500 to-indigo-500":"bg-gradient-to-r from-primary-500 to-primary-700"}`}),o.jsxs("div",{className:"flex flex-col gap-4 sm:gap-5",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3 sm:gap-4",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h3",{className:"text-lg sm:text-xl md:text-2xl font-bold text-slate-900 mb-2 sm:mb-3 break-words",children:H.subject}),o.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3 text-xs sm:text-sm text-slate-600",children:[o.jsxs("span",{className:"flex items-center gap-1.5 px-2.5 py-1 bg-white rounded-lg border border-slate-200",children:[o.jsx(za,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 text-primary-600"}),((J=H.student)==null?void 0:J.name)||"Student"]}),o.jsxs("span",{className:"flex items-center gap-1.5 px-2.5 py-1 bg-white rounded-lg border border-slate-200",children:[o.jsx(Mi,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),new Date(H.date).toLocaleDateString()]}),o.jsxs("span",{className:"flex items-center gap-1.5 px-2.5 py-1 bg-white rounded-lg border border-slate-200",children:[o.jsx(Un,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),H.time]}),o.jsxs("span",{className:"flex items-center gap-1.5 px-2.5 py-1 bg-white rounded-lg border border-slate-200",children:[o.jsx(Un,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),H.duration," ",H.duration===1?"hour":"hours"]})]})]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-2 flex-shrink-0 w-full sm:w-auto",children:[O&&o.jsxs("div",{className:"px-3 sm:px-4 py-1.5 sm:py-2 rounded-xl text-xs sm:text-sm md:text-base font-bold flex items-center gap-1.5 sm:gap-2 shadow-md text-green-700 bg-green-50 border-2 border-green-400",children:[o.jsx(Zn,{className:"h-4 w-4 sm:h-5 sm:w-5"}),o.jsx("span",{className:"whitespace-nowrap",children:"Completed"})]}),U&&o.jsxs("div",{className:"px-3 sm:px-4 py-1.5 sm:py-2 rounded-xl text-xs sm:text-sm md:text-base font-bold flex items-center gap-1.5 sm:gap-2 shadow-md text-indigo-700 bg-indigo-50 border-2 border-indigo-400",children:[o.jsx(Zn,{className:"h-4 w-4 sm:h-5 sm:w-5"}),o.jsx("span",{className:"whitespace-nowrap",children:"Payment Pending"})]}),B&&o.jsxs("div",{className:"px-3 sm:px-4 py-1.5 sm:py-2 rounded-xl text-xs sm:text-sm md:text-base font-bold flex items-center gap-1.5 sm:gap-2 shadow-md text-yellow-700 bg-yellow-50 border-2 border-yellow-400",children:[o.jsx(Un,{className:"h-4 w-4 sm:h-5 sm:w-5"}),o.jsx("span",{className:"whitespace-nowrap",children:"Awaiting Confirmation"})]}),Y&&!X(H)&&o.jsxs("div",{className:"px-3 sm:px-4 py-1.5 sm:py-2 rounded-xl text-xs sm:text-sm md:text-base font-bold flex items-center gap-1.5 sm:gap-2 shadow-md text-blue-700 bg-blue-50 border-2 border-blue-400",children:[o.jsx(Un,{className:"h-4 w-4 sm:h-5 sm:w-5"}),o.jsx("span",{className:"h-2.5 w-2.5 rounded-full bg-blue-500"}),o.jsx("span",{className:"whitespace-nowrap",children:"Upcoming"})]}),X(H)&&o.jsxs(at,{onClick:()=>z(H),disabled:i,className:"bg-gradient-to-r from-primary-600 to-primary-700 hover:from-primary-700 hover:to-primary-800 active:from-primary-800 active:to-primary-900 text-white rounded-xl px-4 sm:px-5 py-2 sm:py-2.5 shadow-md hover:shadow-lg transition-all text-xs sm:text-sm md:text-base font-semibold flex items-center justify-center gap-2 w-full sm:w-auto touch-manipulation min-h-[44px]",style:{WebkitTapHighlightColor:"transparent"},children:[o.jsx(Zn,{className:"h-4 w-4 sm:h-5 sm:w-5 flex-shrink-0"}),o.jsx("span",{children:"Mark as done"})]})]})]}),o.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-3 p-3 sm:p-4 bg-gradient-to-r from-primary-50 via-primary-100/50 to-primary-50 rounded-xl border-2 border-primary-200/50 shadow-sm",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:"text-xs sm:text-sm font-semibold text-slate-700",children:"Created:"}),o.jsx("span",{className:"text-xs sm:text-sm md:text-base font-medium text-slate-900",children:new Date(H.created_at).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})}),H.rating&&o.jsx("div",{className:"p-3 sm:p-4 bg-gradient-to-br from-yellow-50 via-amber-50/50 to-yellow-50 border-2 border-yellow-200 rounded-xl shadow-sm",children:o.jsxs("div",{className:"flex items-start gap-2 sm:gap-3",children:[o.jsx("div",{className:"p-2 bg-gradient-to-br from-yellow-100 to-yellow-200 rounded-lg flex-shrink-0 mt-0.5",children:o.jsx(ja,{className:"h-4 w-4 sm:h-5 sm:w-5 text-yellow-600 fill-current"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h4",{className:"text-xs sm:text-sm md:text-base font-semibold text-slate-800 mb-1.5 sm:mb-2 flex items-center gap-2",children:"Student Rating"}),o.jsx("div",{className:"flex items-center gap-2 mb-2",children:P(H.rating)}),H.rating_comment&&o.jsxs("p",{className:"text-xs sm:text-sm md:text-base text-slate-700 leading-relaxed whitespace-pre-wrap break-words italic",children:['"',H.rating_comment,'"']})]})]})}),H.student_notes&&o.jsx("div",{className:"p-3 sm:p-4 bg-gradient-to-br from-slate-50 via-primary-50/50 to-slate-50 rounded-xl border-2 border-slate-200/50 shadow-sm",children:o.jsxs("div",{className:"flex items-start gap-2 sm:gap-3",children:[o.jsx("div",{className:"p-2 bg-gradient-to-br from-primary-100 to-primary-200 rounded-lg flex-shrink-0 mt-0.5",children:o.jsx(bs,{className:"h-4 w-4 sm:h-5 sm:w-5 text-primary-600"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h4",{className:"text-xs sm:text-sm md:text-base font-semibold text-slate-800 mb-1.5 sm:mb-2 flex items-center gap-2",children:"Student Notes"}),o.jsx("p",{className:"text-xs sm:text-sm md:text-base text-slate-700 leading-relaxed whitespace-pre-wrap break-words",children:H.student_notes})]})]})})]})]},H.id)})}),F.length>0&&o.jsxs(Lt,{className:"p-0 bg-gradient-to-br from-white via-primary-50/10 to-white rounded-xl shadow-xl border-2 border-primary-200/60 overflow-hidden -mx-2 sm:-mx-3 md:mx-0",children:[o.jsxs("div",{className:"bg-gradient-to-r from-primary-600 via-primary-700 to-primary-800 px-4 sm:px-5 py-3 sm:py-4 relative overflow-hidden",children:[o.jsxs("div",{className:"absolute inset-0 opacity-10",children:[o.jsx("div",{className:"absolute top-0 right-0 w-40 h-40 bg-white rounded-full -mr-20 -mt-20 blur-2xl"}),o.jsx("div",{className:"absolute bottom-0 left-0 w-32 h-32 bg-white rounded-full -ml-16 -mb-16 blur-2xl"})]}),o.jsxs("div",{className:"relative flex items-center gap-3",children:[o.jsx("div",{className:"p-2 bg-white/20 backdrop-blur-sm rounded-lg shadow-lg",children:o.jsx(Du,{className:"h-5 w-5 sm:h-6 sm:w-6 text-white"})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-lg sm:text-xl md:text-2xl font-bold text-white drop-shadow-md",children:"Upcoming Sessions"}),o.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[o.jsx("div",{className:"px-2 py-0.5 bg-white/20 backdrop-blur-sm rounded-full border border-white/30",children:o.jsxs("p",{className:"text-xs sm:text-sm font-semibold text-white",children:[F.length," ",F.length===1?"Session":"Sessions"]})}),o.jsx("div",{className:"px-2 py-0.5 bg-white/20 backdrop-blur-sm rounded-full border border-white/30",children:o.jsxs("p",{className:"text-xs sm:text-sm font-semibold text-white",children:[W.toFixed(1)," Hours"]})})]})]})]})]}),o.jsx("div",{className:"hidden lg:block overflow-x-auto",children:o.jsx("div",{className:"inline-block min-w-full align-middle",children:o.jsx("div",{className:"overflow-hidden",children:o.jsxs("table",{className:"min-w-full divide-y divide-slate-200/40",children:[o.jsx("thead",{className:"bg-gradient-to-r from-slate-50 via-primary-50/50 to-slate-50",children:o.jsxs("tr",{children:[o.jsx("th",{scope:"col",className:"px-4 py-2.5 text-left text-xs font-bold text-slate-700 uppercase tracking-wider",children:"Subject"}),o.jsx("th",{scope:"col",className:"px-4 py-2.5 text-left text-xs font-bold text-slate-700 uppercase tracking-wider",children:"Student"}),o.jsx("th",{scope:"col",className:"px-4 py-2.5 text-center text-xs font-bold text-slate-700 uppercase tracking-wider",children:"Duration"}),o.jsx("th",{scope:"col",className:"px-4 py-2.5 text-right text-xs font-bold text-slate-700 uppercase tracking-wider",children:"Expected Earnings"}),o.jsx("th",{scope:"col",className:"px-4 py-2.5 text-left text-xs font-bold text-slate-700 uppercase tracking-wider",children:"Notes"}),o.jsx("th",{scope:"col",className:"px-4 py-2.5 text-left text-xs font-bold text-slate-700 uppercase tracking-wider",children:"Date & Time"})]})}),o.jsx("tbody",{className:"bg-white divide-y divide-slate-100/50",children:F.map((H,Y)=>{var J;const B=n.find(se=>{var Te;const ae=se.booking_request_id||((Te=se.bookingRequest)==null?void 0:Te.id),fe=H.id,ye=ae===fe||ae===Number(fe)||Number(ae)===fe;return Y===0&&console.log("[SessionHistory] Payment matching:",{paymentId:se.payment_id||se.id,bookingId:ae,sessionId:fe,matches:ye,paymentAmount:se.amount,allPayments:n.length}),ye});let O=0;if(B&&B.amount)O=Number(B.amount)*.87,Y===0&&console.log("[SessionHistory] Using payment amount:",{paymentAmount:B.amount,expectedEarnings:O});else{const se=H.session_rate_per_hour||k||0,ae=Number(H.duration??0);O=se*ae*.87,Y===0&&console.log("[SessionHistory] No payment found, using rate calculation:",{ratePerHour:se,duration:ae,expectedEarnings:O})}const U=H.session_rate_per_hour||k||0;return Number(H.duration??0),o.jsxs("tr",{className:`group hover:bg-gradient-to-r hover:from-primary-50/80 hover:via-primary-50/40 hover:to-transparent transition-all duration-300 cursor-pointer ${Y%2===0?"bg-white":"bg-slate-50/20"}`,children:[o.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"p-1.5 bg-gradient-to-br from-primary-500 to-primary-600 rounded-lg shadow-sm group-hover:shadow-md transition-shadow",children:o.jsx(Fg,{className:"h-3.5 w-3.5 text-white"})}),o.jsx("span",{className:"text-sm font-bold text-slate-800 group-hover:text-primary-700 transition-colors",children:H.subject})]})}),o.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"p-1 bg-gradient-to-br from-primary-100 to-primary-200 rounded-full shadow-sm",children:o.jsx(za,{className:"h-3.5 w-3.5 text-primary-700"})}),o.jsx("span",{className:"text-sm font-semibold text-slate-700",children:((J=H.student)==null?void 0:J.name)||"Student"})]})}),o.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-center",children:o.jsxs("div",{className:"inline-flex items-center gap-1.5 px-2.5 py-1 bg-gradient-to-r from-slate-100 to-slate-50 rounded-lg border border-slate-200 shadow-sm",children:[o.jsx(Un,{className:"h-3.5 w-3.5 text-primary-600"}),o.jsxs("span",{className:"text-sm font-bold text-slate-800",children:[H.duration," ",H.duration===1?"hr":"hrs"]})]})}),o.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-right",children:o.jsxs("div",{className:"flex flex-col items-end gap-0.5",children:[o.jsx("div",{className:"px-2.5 py-1 bg-gradient-to-r from-emerald-50 to-green-50 rounded-lg border border-emerald-200/50 shadow-sm",children:o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(To,{className:"h-3.5 w-3.5 text-emerald-700"}),o.jsxs("span",{className:"text-sm font-bold text-emerald-700",children:["",O.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]})}),U>0&&o.jsxs("div",{className:"flex flex-col items-end",children:[o.jsxs("span",{className:"text-[10px] text-slate-500 font-medium",children:["(",U.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),"/hr)"]}),o.jsx("span",{className:"text-[9px] text-amber-600 font-semibold",children:"After 13% fee"})]})]})}),o.jsx("td",{className:"px-4 py-3",children:H.student_notes?o.jsx("div",{className:"max-w-xs",children:o.jsx("p",{className:"text-xs text-slate-700 line-clamp-2 break-words bg-gradient-to-r from-slate-50 to-primary-50/30 px-2.5 py-1.5 rounded-lg border border-slate-200/50 shadow-sm",children:H.student_notes})}):o.jsx("span",{className:"text-xs text-slate-400 italic font-medium",children:"No notes"})}),o.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:o.jsxs("div",{className:"flex flex-col gap-0.5",children:[o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx(Mi,{className:"h-3.5 w-3.5 text-primary-600"}),o.jsx("span",{className:"text-sm font-semibold text-slate-700",children:new Date(H.date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]}),o.jsx("span",{className:"text-xs text-slate-500 font-medium ml-5",children:H.time})]})})]},H.id)})}),o.jsx("tfoot",{className:"bg-gradient-to-r from-primary-600 via-primary-700 to-primary-800",children:o.jsxs("tr",{children:[o.jsx("td",{colSpan:3,className:"px-4 py-3",children:o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"p-1.5 bg-white/20 backdrop-blur-sm rounded-lg",children:o.jsx(Du,{className:"h-4 w-4 text-white"})}),o.jsx("span",{className:"text-sm font-bold text-white",children:"Total Summary"})]})}),o.jsx("td",{className:"px-4 py-3 text-right",children:o.jsxs("div",{className:"flex flex-col items-end gap-1",children:[o.jsxs("div",{className:"flex items-center gap-1.5 px-3 py-1.5 bg-white/20 backdrop-blur-sm rounded-lg border border-white/30",children:[o.jsx(To,{className:"h-4 w-4 text-white"}),o.jsxs("span",{className:"text-base font-bold text-white",children:["",q.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),o.jsx("span",{className:"text-[10px] text-white/90 font-semibold",children:"After 13% service fee"})]})}),o.jsx("td",{colSpan:2,className:"px-4 py-3"})]})})]})})})}),o.jsxs("div",{className:"lg:hidden space-y-3 sm:space-y-4",children:[F.map((H,Y)=>{var J,se;const B=n.find(ae=>{var ye;const fe=ae.booking_request_id||((ye=ae.bookingRequest)==null?void 0:ye.id);return fe===H.id||fe===Number(H.id)});let O=0;if(B&&B.amount)O=Number(B.amount)*.87;else{const ae=H.session_rate_per_hour||k||0,fe=Number(H.duration??0);O=ae*fe*.87}const U=H.session_rate_per_hour||k||0;return Number(H.duration??0),o.jsxs("div",{className:"bg-gradient-to-br from-white via-primary-50/10 to-white rounded-xl border-2 border-primary-200/60 shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden group",children:[o.jsxs("div",{className:"bg-gradient-to-r from-primary-600 via-primary-700 to-primary-800 px-3 py-2.5 relative overflow-hidden",children:[o.jsx("div",{className:"absolute inset-0 opacity-10",children:o.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-white rounded-full -mr-12 -mt-12 blur-xl"})}),o.jsxs("div",{className:"relative flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("div",{className:"p-1.5 bg-white/20 backdrop-blur-sm rounded-lg shadow-md",children:o.jsx(Fg,{className:"h-4 w-4 text-white"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-bold text-white drop-shadow-md",children:H.subject}),o.jsx("p",{className:"text-[10px] text-white/90 font-medium mt-0.5",children:((J=H.student)==null?void 0:J.name)||"Student"})]})]}),o.jsx("div",{className:"px-2 py-1 bg-white/20 backdrop-blur-sm rounded-lg border border-white/30",children:o.jsx("span",{className:"text-[10px] font-bold text-white",children:"Upcoming"})})]})]}),o.jsxs("div",{className:"p-3 space-y-2",children:[o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gradient-to-br from-slate-50 to-primary-50/30 rounded-lg border border-slate-200/50 shadow-sm",children:[o.jsx("div",{className:"p-1 bg-gradient-to-br from-primary-100 to-primary-200 rounded-lg",children:o.jsx(za,{className:"h-3.5 w-3.5 text-primary-700"})}),o.jsxs("div",{className:"min-w-0",children:[o.jsx("p",{className:"text-[9px] text-slate-500 font-semibold uppercase tracking-wide",children:"Student"}),o.jsx("p",{className:"text-xs font-bold text-slate-800 truncate",children:((se=H.student)==null?void 0:se.name)||"Student"})]})]}),o.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gradient-to-br from-slate-50 to-primary-50/30 rounded-lg border border-slate-200/50 shadow-sm",children:[o.jsx("div",{className:"p-1 bg-gradient-to-br from-primary-100 to-primary-200 rounded-lg",children:o.jsx(Mi,{className:"h-3.5 w-3.5 text-primary-700"})}),o.jsxs("div",{className:"min-w-0",children:[o.jsx("p",{className:"text-[9px] text-slate-500 font-semibold uppercase tracking-wide",children:"Date"}),o.jsx("p",{className:"text-xs font-bold text-slate-800",children:new Date(H.date).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})}),o.jsx("p",{className:"text-[9px] text-slate-500 font-medium mt-0.5",children:H.time})]})]})]}),o.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[o.jsxs("div",{className:"flex items-center gap-2 p-2 bg-gradient-to-br from-slate-50 to-primary-50/30 rounded-lg border border-slate-200/50 shadow-sm",children:[o.jsx("div",{className:"p-1 bg-gradient-to-br from-primary-100 to-primary-200 rounded-lg",children:o.jsx(Un,{className:"h-3.5 w-3.5 text-primary-700"})}),o.jsxs("div",{children:[o.jsx("p",{className:"text-[9px] text-slate-500 font-semibold uppercase tracking-wide",children:"Duration"}),o.jsxs("p",{className:"text-xs font-bold text-slate-800",children:[H.duration," ",H.duration===1?"hr":"hrs"]})]})]}),o.jsxs("div",{className:"p-2 bg-gradient-to-br from-emerald-50 via-green-50 to-emerald-50 rounded-lg border-2 border-emerald-200/60 shadow-sm",children:[o.jsxs("div",{className:"flex items-center gap-1.5 mb-0.5",children:[o.jsx(To,{className:"h-3.5 w-3.5 text-emerald-700"}),o.jsx("p",{className:"text-[9px] text-emerald-700 font-semibold uppercase tracking-wide",children:"Expected Earnings"})]}),o.jsxs("p",{className:"text-sm font-bold text-emerald-700 mb-0.5",children:["",O.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]}),U>0&&o.jsxs("div",{className:"space-y-0.5",children:[o.jsxs("p",{className:"text-[8px] text-emerald-600 font-medium",children:["(",U.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}),"/hr)"]}),o.jsx("p",{className:"text-[8px] text-amber-600 font-semibold",children:"After 13% fee"})]})]})]}),H.student_notes&&o.jsx("div",{className:"p-3 bg-gradient-to-br from-primary-50/50 to-slate-50 rounded-lg border border-primary-200/50",children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(bs,{className:"h-4 w-4 text-primary-600 flex-shrink-0 mt-0.5"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-[10px] text-primary-700 font-semibold mb-1 uppercase tracking-wide",children:"Student Notes"}),o.jsx("p",{className:"text-xs text-slate-700 leading-relaxed break-words",children:H.student_notes})]})]})})]})]},H.id)}),o.jsxs("div",{className:"bg-gradient-to-r from-primary-600 via-primary-700 to-primary-800 rounded-xl p-3.5 shadow-xl border-2 border-primary-400/50 relative overflow-hidden",children:[o.jsxs("div",{className:"absolute inset-0 opacity-10",children:[o.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white rounded-full -mr-16 -mt-16 blur-2xl"}),o.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 bg-white rounded-full -ml-12 -mb-12 blur-2xl"})]}),o.jsxs("div",{className:"relative",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[o.jsx("div",{className:"p-1.5 bg-white/20 backdrop-blur-sm rounded-lg",children:o.jsx(Du,{className:"h-4 w-4 text-white"})}),o.jsx("h3",{className:"text-sm font-bold text-white drop-shadow-md",children:"Total Summary"})]}),o.jsxs("div",{className:"bg-white/20 backdrop-blur-sm rounded-lg p-2.5 border border-white/30 shadow-md",children:[o.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[o.jsx(To,{className:"h-3.5 w-3.5 text-white"}),o.jsx("p",{className:"text-[9px] text-white/90 font-semibold uppercase tracking-wide",children:"Expected Earnings"})]}),o.jsxs("p",{className:"text-base font-bold text-white mb-0.5",children:["",q.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]}),o.jsx("p",{className:"text-[8px] text-white/90 font-semibold",children:"After 13% fee"})]})]})]})]}),o.jsx("div",{className:"mt-4 p-3 sm:p-4 bg-gradient-to-br from-primary-50 via-amber-50/40 to-primary-50 border-2 border-primary-200/70 rounded-xl shadow-md",children:o.jsxs("div",{className:"flex items-start gap-2.5",children:[o.jsx("div",{className:"p-1.5 bg-gradient-to-br from-primary-500 to-primary-600 rounded-lg shadow-sm flex-shrink-0",children:o.jsx(aU,{className:"h-4 w-4 text-white"})}),o.jsx("div",{className:"flex-1 min-w-0",children:o.jsxs("p",{className:"text-xs sm:text-sm text-primary-900 leading-relaxed font-medium",children:[o.jsx("span",{className:"font-bold text-primary-800",children:"Note:"})," Expected earnings are calculated based on the actual payment amount (if available) or your session rate per hour multiplied by the session duration, with a 13% service fee deduction. Actual payment will be processed after session completion."]})})]})})]}),f&&x&&o.jsx(On,{isOpen:!0,onClose:()=>{p(!1),y(null),b(null)},title:"Upload Session Proof",footer:o.jsxs(o.Fragment,{children:[o.jsx(at,{onClick:K,disabled:i||!v,className:"bg-gradient-to-r from-primary-600 to-primary-700 hover:from-primary-700 hover:to-primary-800 text-white shadow-lg hover:shadow-xl",children:i?"Uploading...":"Confirm"}),o.jsx(at,{variant:"secondary",onClick:()=>{p(!1),y(null),b(null)},children:"Cancel"})]}),children:o.jsxs("div",{className:"space-y-4",children:[o.jsx("p",{className:"text-sm sm:text-base text-slate-700",children:"Please upload a screenshot or image as proof that the session was conducted."}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"block text-sm font-semibold text-slate-800",children:"Select Image"}),o.jsx("input",{type:"file",accept:"image/*",onChange:H=>b(H.target.files?H.target.files[0]:null),className:"w-full text-xs sm:text-sm md:text-base file:mr-3 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-xs sm:file:text-sm file:font-semibold file:bg-primary-50 file:text-primary-700 hover:file:bg-primary-100 transition-colors"}),v&&o.jsxs("div",{className:"flex items-center gap-2 p-2.5 sm:p-3 bg-green-50 border border-green-200 rounded-lg",children:[o.jsx(Zn,{className:"h-4 w-4 sm:h-5 sm:w-5 text-green-600 flex-shrink-0"}),o.jsx("span",{className:"text-xs sm:text-sm text-green-700 truncate flex-1",children:v.name})]})]})]})})]})},hKe=()=>{const t=qr(),{user:e}=rr(),[n,s]=j.useState([]),[r,a]=j.useState(!1),[i,l]=j.useState(null),[c,u]=j.useState(!1),[h,f]=j.useState(""),[p,x]=j.useState(""),[y,v]=j.useState("all");j.useEffect(()=>{(async()=>{if(e!=null&&e.user_id){a(!0);try{const S=await we.get(`/tutors/${e.user_id}/payments`);s(S.data||[])}catch(S){console.error("Failed to load payments history",S)}finally{a(!1)}}})()},[e]),j.useEffect(()=>{const N=setTimeout(()=>x(h.trim()),200);return()=>clearTimeout(N)},[h]);const b=n.filter(N=>{if(y!=="all"){const S=new Date(N.created_at).getTime(),k=Date.now();if(y==="week"){if(S<k-10080*60*1e3)return!1}else if(y==="month"&&S<k-720*60*60*1e3)return!1}return!(p&&!(N.student_name||"").toLowerCase().includes(p.toLowerCase())||N.status==="confirmed")});return o.jsxs("div",{className:"space-y-3 sm:space-y-4 md:space-y-6",children:[o.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl sm:rounded-2xl p-3 sm:p-4 md:p-6 text-white shadow-lg -mx-2 sm:-mx-3 md:mx-0",children:o.jsxs("div",{className:"flex flex-col gap-3 sm:gap-4",children:[o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[o.jsx(at,{variant:"secondary",onClick:()=>t("/tutor-dashboard/earnings"),className:"text-xs sm:text-sm !px-2 sm:!px-3 !py-1 sm:!py-1.5 bg-white/20 hover:bg-white/30 text-white border-white/30",children:o.jsxs("div",{className:"flex items-center gap-1 sm:gap-1.5",children:[o.jsx(_re,{className:"h-3 w-3 sm:h-4 sm:w-4"})," ",o.jsx("span",{className:"hidden sm:inline",children:"Back"})]})}),o.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold text-white",children:"Payments history"})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2 sm:gap-3",children:[o.jsxs("div",{className:"flex items-center space-x-1 sm:space-x-2",children:[o.jsx("button",{className:`px-2 sm:px-3 py-1 rounded-lg text-xs sm:text-sm font-medium transition-colors touch-manipulation ${y==="all"?"bg-white text-blue-600 shadow-md":"bg-white/20 text-white hover:bg-white/30"}`,onClick:()=>v("all"),style:{WebkitTapHighlightColor:"transparent"},children:"All"}),o.jsx("button",{className:`px-2 sm:px-3 py-1 rounded-lg text-xs sm:text-sm font-medium transition-colors touch-manipulation ${y==="week"?"bg-white text-blue-600 shadow-md":"bg-white/20 text-white hover:bg-white/30"}`,onClick:()=>v("week"),style:{WebkitTapHighlightColor:"transparent"},children:"1 week"}),o.jsx("button",{className:`px-2 sm:px-3 py-1 rounded-lg text-xs sm:text-sm font-medium transition-colors touch-manipulation ${y==="month"?"bg-white text-blue-600 shadow-md":"bg-white/20 text-white hover:bg-white/30"}`,onClick:()=>v("month"),style:{WebkitTapHighlightColor:"transparent"},children:"1 month"})]}),o.jsx("div",{className:"w-full sm:w-auto flex-1 sm:flex-none",children:o.jsx("input",{type:"search",placeholder:"Search student name...",value:h,onChange:N=>f(N.target.value),className:"px-3 py-2 border-0 rounded-lg w-full sm:w-64 text-sm bg-white/90 placeholder:text-slate-400 focus:bg-white focus:ring-2 focus:ring-white/50"})})]})]})}),o.jsx(Lt,{className:"p-4 sm:p-6",children:r?o.jsx("div",{className:"text-center py-6 text-sm sm:text-base",children:"Loading..."}):b.length===0?o.jsx("div",{className:"text-center py-6 text-slate-500 text-sm sm:text-base",children:"No payments found"}):o.jsx("div",{className:"space-y-2 max-h-[60vh] overflow-auto p-1",children:b.map(N=>o.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-3 p-3 bg-white border rounded-lg shadow-sm hover:shadow-md transition",children:[o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("div",{className:"font-medium text-sm sm:text-base text-slate-800 break-words",children:N.student_name||"Student"}),o.jsxs("div",{className:"text-xs text-slate-500 break-words",children:["ID #",N.payment_id,"  ",new Date(N.created_at).toLocaleString(),N.subject?`  Subject: ${N.subject}`:""]})]}),o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 w-full sm:w-auto",children:[o.jsxs("div",{className:"text-left sm:text-right",children:[o.jsxs("div",{className:"text-sm font-semibold",children:["",Number(N.amount).toLocaleString()]}),o.jsx("div",{className:"text-xs text-slate-500",children:N.status})]}),N.admin_payment_proof_url&&o.jsx(at,{variant:"secondary",onClick:()=>{l(Zt(N.admin_payment_proof_url)),u(!0)},className:"text-xs sm:text-sm w-full sm:w-auto",children:"View proof"})]})]},N.payment_id))})}),c&&i&&o.jsx(On,{isOpen:c,onClose:()=>u(!1),title:"Admin proof",children:o.jsx("div",{className:"flex justify-center",children:o.jsx("img",{src:i,alt:"Admin proof",className:"max-w-full h-auto rounded"})})})]})},eJ=()=>{const[t,e]=j.useState([]),[n,s]=j.useState(!1),[r,a]=j.useState(!1),[i,l]=j.useState(null),[c,u]=j.useState(new Date);j.useEffect(()=>{const y=setInterval(()=>u(new Date),6e4);return()=>clearInterval(y)},[]);const h=(y,v)=>{if(!y||!v)return null;let b=new Date(`${y.split("T")[0]}T${v}`);if(!isNaN(b.getTime()))return b;if(b=new Date(y),isNaN(b.getTime()))return null;const N=v.match(/(\d{1,2}):(\d{2})(?::\d{2})?\s*(AM|PM)?/i);if(N){let S=parseInt(N[1],10);const k=parseInt(N[2],10),T=N[3];T&&T.toLowerCase()==="pm"&&S<12&&(S+=12),T&&T.toLowerCase()==="am"&&S===12&&(S=0),b.setHours(S,k,0,0)}return b},f=async()=>{var y,v,b;s(!0);try{const k=(((y=(await we.get("/users/upcoming-sessions/list")).data)==null?void 0:y.data)||[]).filter(T=>{const E=h(T.date,T.time);return E&&E>c});e(k)}catch(N){gt.error(((b=(v=N==null?void 0:N.response)==null?void 0:v.data)==null?void 0:b.message)||"Failed to load upcoming sessions")}finally{s(!1)}};j.useEffect(()=>{f()},[c]);const p=y=>{switch(y){case"confirmed":return"text-green-600 bg-green-50 border-green-200";case"upcoming":return"text-blue-600 bg-blue-50 border-blue-200";default:return"text-gray-600 bg-gray-50 border-gray-200"}},x=y=>{switch(y){case"confirmed":return o.jsx(Zn,{className:"h-4 w-4"});case"upcoming":return o.jsx(Un,{className:"h-4 w-4"});default:return o.jsx(Un,{className:"h-4 w-4"})}};return o.jsxs("div",{className:"space-y-3 sm:space-y-4 md:space-y-6",children:[o.jsx(Kc,{}),o.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl sm:rounded-2xl p-3 sm:p-4 md:p-6 text-white shadow-lg -mx-2 sm:-mx-3 md:mx-0",children:[o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2 sm:mb-3",children:[o.jsx(Gm,{className:"h-5 w-5 sm:h-6 sm:w-6 md:h-8 md:w-8 flex-shrink-0"}),o.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl font-bold text-white",children:"Upcoming Sessions"})]}),o.jsx("p",{className:"text-xs sm:text-sm md:text-base lg:text-lg text-blue-100/90 leading-relaxed",children:"Manage and mark your upcoming sessions"})]}),o.jsx("div",{className:"space-y-3 sm:space-y-4",children:t.length===0?o.jsxs(Lt,{className:"p-6 sm:p-8 text-center",children:[o.jsx(Gm,{className:"h-10 w-10 sm:h-12 sm:w-12 text-gray-400 mx-auto mb-3 sm:mb-4"}),o.jsx("h3",{className:"text-base sm:text-lg font-medium text-gray-900 mb-2",children:"No upcoming sessions"}),o.jsx("p",{className:"text-sm sm:text-base text-gray-500",children:"You have no upcoming sessions scheduled."})]}):o.jsx(o.Fragment,{children:t.map(y=>{var v;return o.jsxs(Lt,{className:"p-3 sm:p-4 md:p-6 -mx-2 sm:-mx-3 md:mx-0",children:[o.jsx("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2.5 sm:gap-3 md:gap-0 mb-2.5 sm:mb-3 md:mb-4",children:o.jsxs("div",{className:"flex-1 min-w-0 w-full sm:w-auto",children:[o.jsxs("div",{className:"flex flex-wrap items-center gap-1.5 sm:gap-2 md:gap-3 mb-2",children:[o.jsx("h3",{className:"text-sm sm:text-base md:text-lg font-semibold text-slate-800 break-words",children:((v=y.student)==null?void 0:v.name)||"Student"}),o.jsx("span",{className:`px-1.5 sm:px-2 py-0.5 sm:py-1 rounded-full text-[10px] sm:text-xs font-medium border flex-shrink-0 ${p(y.status)}`,children:o.jsxs("div",{className:"flex items-center space-x-0.5 sm:space-x-1",children:[x(y.status),o.jsx("span",{className:"whitespace-nowrap",children:y.status.replace("_"," ").charAt(0).toUpperCase()+y.status.replace("_"," ").slice(1)})]})})]}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 sm:gap-3 md:gap-4 text-[10px] sm:text-xs md:text-sm text-slate-600 mt-2",children:[o.jsxs("div",{children:[o.jsxs("p",{className:"break-words",children:[o.jsx("strong",{children:"Subject:"})," ",y.subject]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Date:"})," ",new Date(y.date).toLocaleDateString()]})]}),o.jsxs("div",{children:[o.jsxs("p",{children:[o.jsx("strong",{children:"Time:"})," ",y.time]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Duration:"})," ",y.duration," hours"]})]})]}),y.student_notes&&o.jsx("div",{className:"mt-2 sm:mt-3 p-2 sm:p-3 bg-slate-50 rounded-lg",children:o.jsxs("p",{className:"text-[10px] sm:text-xs md:text-sm text-slate-700 break-words",children:[o.jsx("strong",{children:"Student Notes:"})," ",y.student_notes]})})]})}),o.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2 sm:gap-0 pt-2.5 sm:pt-3 md:pt-4 border-t border-slate-200",children:[o.jsxs("div",{className:"text-[10px] sm:text-xs text-slate-500",children:["Requested on ",isNaN(new Date(y.created_at).getTime())?"Unknown date":new Date(y.created_at).toLocaleDateString()]}),o.jsx("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:o.jsxs(at,{variant:"secondary",onClick:()=>{l(y),a(!0)},disabled:n,className:"flex items-center justify-center space-x-1 w-full sm:w-auto text-xs sm:text-sm md:text-base py-1.5 sm:py-2",children:[o.jsx(Un,{className:"h-4 w-4"}),o.jsx("span",{children:"Reschedule"})]})})]})]},y.id)})})}),r&&i&&o.jsx(JZ,{open:r,bookingId:i.id,onClose:()=>{a(!1),l(null)},onSuccess:()=>{a(!1),l(null),f()}})]})},mKe=()=>{const{user:t}=rr();return vi(),o.jsx(tKe,{children:o.jsx("div",{className:"w-full",children:o.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-0 lg:gap-6",children:o.jsx("div",{className:"lg:col-span-4 w-full",children:o.jsxs(ew,{children:[o.jsx(rn,{path:"/",element:o.jsx(nl,{to:"/tutor-dashboard/application",replace:!0})}),o.jsx(rn,{path:"/application",element:o.jsx(nKe,{})}),o.jsx(rn,{path:"/profile",element:o.jsx(sKe,{})}),o.jsx(rn,{path:"/availability",element:o.jsx(oKe,{})}),o.jsx(rn,{path:"/sessions",element:o.jsx(cKe,{})}),o.jsx(rn,{path:"/upcoming-sessions",element:o.jsx(eJ,{})}),o.jsx(rn,{path:"/earnings",element:o.jsx(uKe,{})}),o.jsx(rn,{path:"/earnings/payments",element:o.jsx(hKe,{})}),o.jsx(rn,{path:"/session-history",element:o.jsx(dKe,{})}),o.jsx(rn,{path:"*",element:o.jsx(nl,{to:"/tutor-dashboard/application",replace:!0})})]})})})})})},a7=[{to:"/tutee-dashboard/become-tutor",icon:rU,label:"Become a Tutor",description:"Apply to become a tutor by selecting subjects and uploading supporting documents like transcripts."},{to:"/tutee-dashboard/find-tutors",icon:J3,label:"Find & Book Tutors",description:"Browse tutors filtered by your course subjects, view their profiles, ratings, and availability to book a session."},{to:"/tutee-dashboard/my-bookings",icon:Xd,label:"My Bookings",description:"View and manage your tutoring session bookings."},{to:"/tutee-dashboard/upcoming-sessions",icon:za,label:"Upcoming Sessions",description:"See your scheduled sessions in the next 30 days.",showUpcoming:!0},{to:"/tutee-dashboard/payment",icon:_l,label:"Payment",description:"View tutor payment information, upload proof of payment via GCash, and wait for tutor approval.",showNotification:!0},{to:"/tutee-dashboard/after-session",icon:ja,label:"After Session",description:"Leave feedback and rating for completed sessions to help future students make informed decisions."}],i7=()=>{var F;const{user:t}=rr(),{notify:e}=Mh(),{notifications:n}=Bg(),s=vi(),[r,a]=j.useState(!1),[i,l]=j.useState(0),[c,u]=j.useState(0),[h,f]=j.useState(!1),[p,x]=j.useState(!1),[y,v]=j.useState(new Set);j.useEffect(()=>{const W=async()=>{try{const[z,K]=await Promise.all([we.get("/users/me/bookings"),we.get("/payments").catch(()=>({data:[]}))]);if(!Array.isArray(z.data)){a(!1);return}const H=z.data||[],B=(K.data||[]).filter(J=>{var se,ae;return t!=null&&t.user_id?((ae=(se=J.student)==null?void 0:se.user)==null?void 0:ae.user_id)===t.user_id:!1}),O=H.filter(J=>{const se=((J==null?void 0:J.status)||"").toLowerCase().trim();return se==="awaiting_payment"||se==="payment_pending"||se==="payment_rejected"});let U=!1;for(const J of O){const se=B.find(fe=>fe.booking_id===J.id);if(!se){U=!0;break}const ae=(se.status||"").toLowerCase().trim();if(ae==="pending"||ae==="rejected"){U=!0;break}}a(U)}catch(z){console.error("Failed to check pending payments",z),a(!1)}};W();const q=setInterval(W,8e3),X=()=>W();return window.addEventListener("focus",X),()=>{clearInterval(q),window.removeEventListener("focus",X)}},[t==null?void 0:t.user_id]),j.useEffect(()=>{let W=!0;const q=async()=>{if(!(t!=null&&t.user_id)){W&&(l(0),u(0),f(!1));return}try{const K=await we.get("/users/me/bookings"),H=Array.isArray(K.data)?K.data:[],Y=(se,ae)=>{if(!se||!ae)return null;let fe=new Date(`${se.split("T")[0]}T${ae}`);if(!isNaN(fe.getTime()))return fe;if(fe=new Date(se),isNaN(fe.getTime()))return null;const ye=ae.match(/(\d{1,2}):(\d{2})(?::\d{2})?\s*(AM|PM)?/i);if(ye){let Te=parseInt(ye[1],10);const oe=parseInt(ye[2],10),Se=ye[3];Se&&Se.toLowerCase()==="pm"&&Te<12&&(Te+=12),Se&&Se.toLowerCase()==="am"&&Te===12&&(Te=0),fe.setHours(Te,oe,0,0)}return fe},B=new Date,O=H.filter(se=>{if(!["upcoming","confirmed"].includes(se.status))return!1;const ae=Y(se.date,se.time);return ae&&ae>B});W&&l(O.length);const U=H.filter(se=>{const ae=(se.status||"").toLowerCase();return ae!=="upcoming"&&ae!=="completed"});W&&u(U.length);const J=H.filter(se=>se.status==="completed"&&!se.tutee_rating);W&&f(J.length>0)}catch(K){console.error("Failed to load booking data (tutee):",K),W&&(l(0),u(0),f(!1))}};q();const X=setInterval(q,3e4),z=()=>q();return window.addEventListener("focus",z),()=>{W=!1,clearInterval(X),window.removeEventListener("focus",z)}},[t==null?void 0:t.user_id]),j.useEffect(()=>{let W=!0;const q=async()=>{var z,K;if(!(t!=null&&t.user_id)){W&&x(!1);return}try{let H=!1;try{(z=(await we.get(`/tutors/by-user/${t.user_id}/tutor-id`)).data)!=null&&z.tutor_id&&(H=!0)}catch(Y){((K=Y.response)==null?void 0:K.status)!==404&&console.error("Error checking tutor profile:",Y)}if(H){const Y=n.filter(B=>{var O,U,J,se;return!B.is_read&&(((O=B.message)==null?void 0:O.toLowerCase().includes("tutor"))||((U=B.message)==null?void 0:U.toLowerCase().includes("application"))||((J=B.message)==null?void 0:J.toLowerCase().includes("approved"))||((se=B.message)==null?void 0:se.toLowerCase().includes("rejected")))});W&&x(Y.length>0)}else W&&x(!1)}catch(H){console.error("Failed to check tutor application status:",H),W&&x(!1)}};q();const X=setInterval(q,1e4);return()=>{W=!1,clearInterval(X)}},[n,t==null?void 0:t.user_id]),j.useEffect(()=>{const W=s.pathname;a7.forEach(({to:q})=>{(W===q||W.startsWith(q+"/"))&&v(X=>new Set(X).add(q))})},[s.pathname]);const{unreadCount:b,hasUpcomingSessions:N}=Bg(),[S,k]=j.useState(null),[T,E]=j.useState(null),[D,A]=j.useState(null),[I,P]=j.useState(!1),$=W=>{k(W),D&&clearTimeout(D);const q=setTimeout(()=>{E(W)},500);A(q)},R=()=>{k(null),E(null),D&&(clearTimeout(D),A(null))};return j.useEffect(()=>()=>{D&&clearTimeout(D)},[D]),o.jsxs("aside",{className:"w-64 bg-white border-r border-slate-200 flex flex-col",children:[o.jsx("div",{className:"px-4 py-4 border-b border-slate-200",children:o.jsx("div",{className:"flex items-center justify-between",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("img",{src:i4,alt:"TutorFriends Logo",className:"h-10 w-auto object-contain"}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-lg font-bold text-slate-800",children:"TutorFriends"}),o.jsx("p",{className:"text-xs text-slate-600 font-medium",children:"Student Dashboard"})]})]})})}),o.jsx("nav",{className:"flex-1 px-3 py-4 space-y-1",children:a7.map(({to:W,icon:q,label:X,description:z,showNotification:K,showUpcoming:H})=>o.jsxs("div",{className:"relative",children:[o.jsx(Pg,{to:W,className:({isActive:Y})=>`block p-3 rounded-lg transition-all duration-200 group ${Y?"bg-blue-50 text-blue-700 shadow-sm":"text-slate-600 hover:bg-slate-50 hover:text-slate-900"}`,onMouseEnter:()=>$(W),onMouseLeave:R,onClick:()=>{v(Y=>new Set(Y).add(W))},children:o.jsxs("div",{className:"flex items-center justify-between w-full",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(q,{className:`h-5 w-5 ${S===W?"text-blue-600":"text-slate-500"}`}),o.jsx("span",{className:"font-medium text-sm",children:X})]}),o.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[W==="/tutee-dashboard/my-bookings"&&!y.has(W)&&o.jsxs(o.Fragment,{children:[c>0&&o.jsx("div",{className:"h-2.5 w-2.5 rounded-full bg-orange-500 animate-pulse"}),n.some(Y=>{var B,O,U;return!Y.is_read&&(Y.type==="booking_update"||((B=Y.message)==null?void 0:B.toLowerCase().includes("booking"))||((O=Y.message)==null?void 0:O.toLowerCase().includes("accepted"))||((U=Y.message)==null?void 0:U.toLowerCase().includes("declined")))})&&o.jsx("div",{className:"h-2.5 w-2.5 rounded-full bg-blue-500 animate-pulse"})]}),W==="/tutee-dashboard/payment"&&!y.has(W)&&r&&o.jsx("div",{className:"h-2.5 w-2.5 rounded-full bg-red-500 animate-pulse"}),W==="/tutee-dashboard/after-session"&&!y.has(W)&&h&&o.jsx("div",{className:"h-2.5 w-2.5 rounded-full bg-purple-500 animate-pulse"}),W==="/tutee-dashboard/become-tutor"&&!y.has(W)&&p&&o.jsx("div",{className:"h-2.5 w-2.5 rounded-full bg-green-500 animate-pulse"}),H&&i>0&&o.jsx("span",{className:"inline-flex items-center justify-center px-2 py-0.5 rounded-full text-xs font-semibold bg-blue-600 text-white",children:i>99?"99+":i})]})]})}),T===W&&o.jsx("div",{className:"absolute left-full top-1/2 transform -translate-y-1/2 ml-4 z-50 animate-in fade-in-0 zoom-in-95 duration-200",children:o.jsx("div",{className:"bg-white border border-slate-200 rounded-2xl px-5 py-4 shadow-2xl w-80",children:o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute left-0 top-1/2 transform -translate-y-1/2 -translate-x-2",children:o.jsx("div",{className:"w-4 h-4 bg-white border-l-2 border-t-2 border-slate-200 rotate-45"})}),o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx("div",{className:"flex-shrink-0 mt-1",children:o.jsx("div",{className:"w-3 h-3 bg-gradient-to-r from-blue-500 to-blue-600 rounded-full shadow-sm"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("h4",{className:"text-base font-semibold text-slate-800 mb-2 leading-tight",children:X}),K&&r&&o.jsx("div",{className:"w-2 h-2 rounded-full bg-red-500 animate-pulse"})]}),o.jsx("p",{className:"text-sm text-slate-600 leading-relaxed",children:z})]})]})]})})})]},W))}),o.jsx("div",{className:"px-4 py-4 border-t border-slate-200",children:o.jsxs(Pg,{to:"/tutee-dashboard/profile",className:"flex items-center space-x-3 group hover:bg-slate-50 p-2 rounded-md",children:[o.jsx("div",{className:"relative",children:t!=null&&t.profile_image_url?o.jsx("img",{src:Zt(t.profile_image_url),alt:t.name,className:"h-12 w-12 rounded-full object-cover border-2 border-slate-200",onError:W=>{const q=W.target;q.style.display="none"}}):o.jsx("div",{className:"h-12 w-12 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center text-white font-semibold text-lg border-2 border-slate-200",children:((F=t==null?void 0:t.name)==null?void 0:F.charAt(0).toUpperCase())||"U"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-sm font-semibold text-slate-800 truncate",children:t==null?void 0:t.name}),o.jsx("p",{className:"text-xs text-slate-600 truncate",children:t==null?void 0:t.email})]})]})})]})},fKe=({onMenuClick:t})=>{var s;const{user:e,logout:n}=rr();return o.jsx("header",{className:"bg-white border-b border-slate-200 shadow-sm sticky top-0 z-30",children:o.jsx("div",{className:"px-2 sm:px-3 md:px-4 lg:px-4 py-2 sm:py-2.5 md:py-4 lg:py-4 md:h-[72px] lg:h-[72px] md:flex md:items-center",children:o.jsxs("div",{className:"flex items-center justify-between gap-1.5 sm:gap-2 md:gap-3 lg:gap-4 w-full md:h-full",children:[o.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2 md:gap-3 lg:gap-4 flex-1 min-w-0 md:h-full",children:[o.jsx("button",{onClick:t,className:"md:hidden p-1.5 sm:p-2 rounded-md text-slate-700 hover:bg-slate-100 active:bg-slate-200 focus:outline-none focus:ring-2 focus:ring-slate-300 flex-shrink-0 touch-manipulation","aria-label":"Open menu",style:{WebkitTapHighlightColor:"transparent"},children:o.jsx(a4,{className:"h-5 w-5 sm:h-6 sm:w-6"})}),o.jsx("div",{className:"min-w-0 flex-1 md:flex md:items-center md:h-full",children:o.jsxs("div",{className:"leading-none",children:[o.jsx("h1",{className:"text-sm sm:text-base md:text-lg lg:text-lg font-semibold md:font-bold text-slate-800 truncate leading-tight",children:o.jsxs("span",{className:"truncate inline-block max-w-full",children:["Welcome back, ",((s=e==null?void 0:e.name)==null?void 0:s.split(" ")[0])||"Student"," "]})}),o.jsx("p",{className:"text-[10px] sm:text-xs md:text-xs text-slate-600 md:text-slate-600 md:font-medium hidden sm:block break-words leading-tight mt-0",children:"Find tutors and manage your learning sessions"})]})})]}),o.jsxs("div",{className:"flex items-center gap-1 sm:gap-1.5 md:gap-2 lg:gap-4 flex-shrink-0",children:[o.jsx(ZZ,{}),o.jsxs(at,{onClick:n,variant:"secondary",className:"flex items-center justify-center gap-1 sm:gap-1.5 md:gap-2 !px-1.5 sm:!px-2 md:!px-3 !py-1.5 sm:!py-2 text-xs sm:text-sm touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:[o.jsx(r4,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 flex-shrink-0"}),o.jsx("span",{className:"hidden sm:inline",children:"Logout"})]})]})]})})})},pKe=({children:t})=>{const[e,n]=j.useState(!1);return j.useEffect(()=>{const s=()=>{window.innerWidth>=768&&n(!1)};return window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),j.useEffect(()=>(e?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[e]),o.jsx(o4,{children:o.jsxs("div",{className:"flex h-screen bg-slate-50 overflow-hidden",children:[o.jsx("div",{className:"hidden md:flex",children:o.jsx(i7,{})}),o.jsxs("div",{className:`fixed inset-y-0 left-0 z-50 w-64 bg-white border-r border-slate-200 md:hidden transform transition-transform duration-300 ease-in-out ${e?"translate-x-0":"-translate-x-full"}`,children:[o.jsxs("div",{className:"flex items-center justify-between h-16 px-4 border-b border-slate-200 bg-white",children:[o.jsx("h2",{className:"text-lg font-bold text-slate-800",children:"Menu"}),o.jsx("button",{onClick:()=>n(!1),className:"p-2 rounded-md text-slate-600 hover:bg-slate-100 focus:outline-none focus:ring-2 focus:ring-slate-300","aria-label":"Close menu",children:o.jsx(Rn,{className:"h-6 w-6"})})]}),o.jsx("div",{className:"overflow-y-auto h-[calc(100vh-4rem)]",children:o.jsx(i7,{})})]}),e&&o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 md:hidden",onClick:()=>n(!1)}),o.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[o.jsx(fKe,{onMenuClick:()=>n(!0)}),o.jsx("main",{className:"flex-1 overflow-y-auto bg-slate-50",children:o.jsx("div",{className:"max-w-7xl mx-auto px-2 sm:px-3 md:px-4 lg:px-6 pt-1 sm:pt-1.5 md:pt-2 pb-3 sm:pb-4 md:pb-6 lg:pb-8 w-full",children:t})})]})]})})},gKe=()=>{const{user:t}=kx();return t!=null&&t.email,t!=null&&t.name,t!=null&&t.course_id,t!=null&&t.year_level&&String(t.year_level),t!=null&&t.university_id,o.jsxs("div",{className:"space-y-3 sm:space-y-4 md:space-y-6",children:[o.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl sm:rounded-2xl p-3 sm:p-4 md:p-6 text-white shadow-lg -mx-2 sm:-mx-3 md:mx-0",children:[o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2 sm:mb-3",children:[o.jsx(rU,{className:"h-5 w-5 sm:h-6 sm:w-6 md:h-8 md:w-8 flex-shrink-0"}),o.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl font-bold text-white",children:"Become a Tutor"})]}),o.jsx("p",{className:"text-xs sm:text-sm md:text-base lg:text-lg text-blue-100/90 leading-relaxed",children:"Turn your knowledge into impact and income. Share your expertise, help fellow students excel, and build your portfolio  all in one place."})]}),o.jsx("div",{className:"bg-white rounded-lg sm:rounded-xl shadow-sm border border-slate-200 -mx-2 sm:-mx-3 md:mx-0 overflow-hidden"})]})},xKe=()=>{var na,Pr,Fo,Kl,Ya,Si,Qa,ji,zo,wr,us,Ps,$a,Lr,ao,ue,He,ot,st,_t,Qt,ds,Nr,Xt,Vn,ki;const[t,e]=j.useState([]),[n,s]=j.useState(""),[r,a]=j.useState("");j.useEffect(()=>{const xe=setTimeout(()=>{const Ke=(r||"").trim();Ke!==n&&s(Ke)},350);return()=>clearTimeout(xe)},[r]);const[i,l]=j.useState("all"),[c,u]=j.useState("all"),[h,f]=j.useState("all"),[p,x]=j.useState("all"),[y,v]=j.useState("all"),[b,N]=j.useState([]),[S,k]=j.useState([]),[T,E]=j.useState(!0),[D,A]=j.useState(null),[I,P]=j.useState(null),[$,R]=j.useState(!1),[F,W]=j.useState(!1);j.useEffect(()=>{(async()=>{try{const[Ke,Ge]=await Promise.all([we.get("/universities").catch(()=>({data:[]})),we.get("/courses").catch(()=>({data:[]}))]),rt=(Ke.data||[]).filter(Ye=>!Ye.status||Ye.status==="active");N(rt);const ct=(Array.isArray(Ge.data)?Ge.data:[]).map(Ye=>{var yt;return{...Ye,university_id:(Ye==null?void 0:Ye.university_id)??((yt=Ye==null?void 0:Ye.university)==null?void 0:yt.university_id)??(Ye==null?void 0:Ye.universityId)??null}});k(ct)}catch(Ke){console.error("Failed to fetch universities/courses:",Ke),N([]),k([])}})()},[]),j.useEffect(()=>{p==="all"&&v("all")},[p]),j.useEffect(()=>{(async()=>{try{E(!0);const ct=((await we.get("/users")).data||[]).filter(Ye=>Ye.tutor_profile&&(Ye.tutor_profile.status||"").toLowerCase()==="approved").sort((Ye,yt)=>{const dt=new Date(Ye.created_at||0).getTime(),Dt=new Date(yt.created_at||0).getTime();return dt-Dt});try{const Ye=await Promise.all(ct.map(async Et=>{var Wt,un,Pn;const Pt=(Wt=Et.tutor_profile)==null?void 0:Wt.tutor_id;if(!Pt)return Et;try{const[Ls,Kn]=await Promise.all([we.get(`/tutors/${Pt}/profile`),we.get(`/tutors/${Pt}/booking-requests`).catch(()=>({data:[]}))]);let Ln=[];Array.isArray(Kn.data)?Ln=Kn.data:Array.isArray((un=Kn.data)==null?void 0:un.data)?Ln=Kn.data.data:Array.isArray((Pn=Kn.data)==null?void 0:Pn.bookings)&&(Ln=Kn.data.bookings);const pa=[];Ln.forEach(sa=>{sa.tutee_rating&&sa.tutee_rating>0&&pa.push(Number(sa.tutee_rating))});let Bo=0,Uo=0;return pa.length>0&&(Bo=pa.reduce((Xl,rm)=>Xl+rm,0)/pa.length,Uo=pa.length),{...Et,profile:Ls.data,calculatedRating:Bo,calculatedTotalRatings:Uo}}catch(Ls){return console.warn("Failed to fetch tutor profile for",Pt,Ls),Et}}));e(Ye);const yt={},dt={};Ye.forEach(Et=>{if(Et.user_id&&Et.tutor_profile){const Pt=Et.tutor_profile.activity_status;yt[Et.user_id]=Pt==="online",Et.calculatedRating!==void 0&&(dt[Et.user_id]={average:Et.calculatedRating,totalRatings:Et.calculatedTotalRatings||0})}}),De(yt),In(dt);const Dt=[...Ye].sort((Et,Pt)=>{var Kn,Ln;const Wt=((Kn=dt[Et.user_id])==null?void 0:Kn.average)||0,un=((Ln=dt[Pt.user_id])==null?void 0:Ln.average)||0;if(un!==Wt)return un-Wt;const Pn=new Date(Et.created_at||0).getTime(),Ls=new Date(Pt.created_at||0).getTime();return Pn-Ls});e(Dt)}catch(Ye){console.warn("Failed to enrich tutors with profile data",Ye),e(ct)}}catch(Ke){console.error("Failed to fetch tutors",Ke),A("Failed to load tutors. Please try again later.")}finally{E(!1)}})()},[]);const[q,X]=j.useState(!1),[z,K]=j.useState(!1),[H,Y]=j.useState(null),[B,O]=j.useState({subject:"",date:"",time:"",duration:1}),[U,J]=j.useState({}),[se,ae]=j.useState(!1),[fe,ye]=j.useState([]),[Te,oe]=j.useState(!1),[Se,ke]=j.useState(null),[me,re]=j.useState(!1),[je,ie]=j.useState(!1),[Re,Ve]=j.useState(null),[Ze,bt]=j.useState(!1),[tt,St]=j.useState(!1),[mt,jt]=j.useState([]),[Oe,ht]=j.useState([]),[ut,Q]=j.useState(0),[L,M]=j.useState([]),[ee,ce]=j.useState(!1),[Ce,De]=j.useState({}),[xt,Ie]=j.useState([]),[lt,Nt]=j.useState([]),[kt,In]=j.useState({});j.useEffect(()=>{(async()=>{var Ke,Ge,rt,ct;if(!B.date||!((Ge=(Ke=I==null?void 0:I.user)==null?void 0:Ke.tutor_profile)!=null&&Ge.tutor_id)){M([]);return}try{ce(!0);const Ye=I.user.tutor_profile.tutor_id,yt=await we.get(`/tutors/${Ye}/booking-requests`);let dt=[];Array.isArray(yt.data)?dt=yt.data:Array.isArray((rt=yt.data)==null?void 0:rt.data)?dt=yt.data.data:(ct=yt.data)!=null&&ct.bookings&&Array.isArray(yt.data.bookings)&&(dt=yt.data.bookings);const Dt=dt.filter(Et=>{const Pt=new Date(Et.date).toISOString().split("T")[0],Wt=(Et.status||"").toLowerCase(),un=["pending","upcoming","confirmed"];return Pt===B.date&&un.includes(Wt)});M(Dt)}catch(Ye){console.error("Failed to fetch existing bookings:",Ye),M([])}finally{ce(!1)}})()},[B.date,(Pr=(na=I==null?void 0:I.user)==null?void 0:na.tutor_profile)==null?void 0:Pr.tutor_id]);const vs=(xe,Ke,Ge)=>{const rt=dt=>{const[Dt,Et]=dt.split(":").map(Number);return Dt*60+Et},ct=rt(xe),Ye=Ke*60,yt=ct+Ye;for(const dt of Ge){const Dt=rt(dt.time),Et=(dt.duration||0)*60,Pt=Dt+Et;if(ct<Pt&&yt>Dt)return!1}return!0};j.useEffect(()=>{if(B.date&&(I!=null&&I.availability)){const Ke=new Date(B.date).toLocaleDateString("en-US",{weekday:"long"}),Ge=I.availability.filter(rt=>rt.day_of_week.toLowerCase()===Ke.toLowerCase());if(Ge.length>0){const rt=[];Ge.forEach(dt=>{const Dt=ns(dt.start_time,dt.end_time);rt.push(...Dt)});const yt=Array.from(new Set(rt)).sort().filter(dt=>{const Dt=(()=>{const[Pt,Wt]=dt.split(":").map(Number);return Pt*60+Wt})(),Et=B.duration*60;if(B.duration>0){const Pt=Dt+Et;return Ge.some(un=>{const Pn=(()=>{const[Kn,Ln]=un.start_time.split(":").map(Number);return Kn*60+Ln})(),Ls=(()=>{const[Kn,Ln]=un.end_time.split(":").map(Number);return Kn*60+Ln})();return Dt>=Pn&&Pt<=Ls})?vs(dt,B.duration,L):!1}return!0}).sort();jt(yt),B.time&&!yt.includes(B.time)&&O(dt=>({...dt,time:""}))}else jt([]),O(rt=>({...rt,time:""}))}else jt([]),B.time&&O(xe=>({...xe,time:""}))},[B.date,B.duration,I==null?void 0:I.availability,B.time,L]),j.useEffect(()=>{(()=>{if(ht([]),!(I!=null&&I.availability)||!B.date)return;const Ge=new Date(B.date).toLocaleDateString("en-US",{weekday:"long"}),rt=I.availability.filter(Wt=>Wt.day_of_week.toLowerCase()===Ge.toLowerCase());if(rt.length===0)return;const ct=Wt=>{const[un,Pn]=Wt.split(":").map(Number);return un*60+Pn};let Ye=0;if(B.time){const Wt=ct(B.time),un=rt.find(Pn=>{const Ls=ct(Pn.start_time),Kn=ct(Pn.end_time);return Wt>=Ls&&Wt<Kn});if(un){const Pn=ct(un.end_time);Ye=Pn-Wt;for(const Ls of L){const Kn=ct(Ls.time);if(Kn+Ls.duration*60,Kn>Wt&&Kn<Pn){const Ln=Kn-Wt;Ln<Ye&&(Ye=Ln)}}}}else rt.forEach(Wt=>{const un=ct(Wt.start_time),Pn=ct(Wt.end_time);let Kn=Pn-un;for(const Ln of L){const pa=ct(Ln.time),Bo=pa+Ln.duration*60;if(pa<Pn&&Bo>un){const Uo=pa>un?pa-un:0,sa=Bo<Pn?Pn-Bo:0,Xl=Math.max(Uo,sa);Xl<Kn&&(Kn=Xl)}}Kn>Ye&&(Ye=Kn)});Q(Ye);const yt=[],dt=.5,Dt=Ye/60,Et=.5;for(let Wt=dt;Wt<=Dt;Wt+=Et)yt.push(Wt);ht(yt);const Pt=B.duration||0;if(Ye>0&&(Pt*60>Ye||Pt<dt)){const Wt=Math.max(dt,Math.min(Dt,Pt));O(un=>({...un,duration:Wt}))}})()},[B.time,B.date,I==null?void 0:I.availability,L]),j.useEffect(()=>{if(!se)return;const xe={};B.subject||(xe.subject="Subject is required"),B.date||(xe.date="Date is required"),B.time||(xe.time="Time is required");const Ke=B.duration*60;B.duration>0&&ut>0&&Ke>ut&&(xe.duration="Selected duration does not fit within the tutor's availability for the chosen date/time"),J(Ge=>({...Ge,...xe}))},[se,Oe]),j.useEffect(()=>{se&&J(xe=>{const Ke={...xe},Ge=B.duration*60;return B.duration>0&&ut>0&&Ge>ut?Ke.duration="Selected duration does not fit within the tutor's availability for the chosen date/time":delete Ke.duration,Ke})},[B.duration,ut,se]);const ns=(xe,Ke)=>{const Ge=[],rt=Pt=>{if(!Pt)return NaN;const Wt=Pt.split(":"),un=parseInt(Wt[0],10)||0,Pn=parseInt(Wt[1],10)||0;return un*60+Pn},ct=Pt=>{const Wt=Math.floor(Pt/60),un=Pt%60;return`${String(Wt).padStart(2,"0")}:${String(un).padStart(2,"0")}`},Ye=rt(xe),yt=rt(Ke);if(isNaN(Ye)||isNaN(yt))return console.error("Invalid time format:",{startTime:xe,endTime:Ke}),Ge;if(yt<=Ye)return console.error("End time must be after start time:",{startTime:xe,endTime:Ke}),Ge;const dt=new Date,Dt=B.date===dt.toISOString().split("T")[0],Et=dt.getHours()*60+dt.getMinutes();try{for(let Pt=Ye;Pt<=yt;Pt+=30)(!Dt||Pt>Et+30)&&Ge.push(ct(Pt))}catch(Pt){console.error("Error generating time slots:",Pt)}return Ge},qn=(xe,Ke=[],Ge=new Date)=>{const ct=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].indexOf(String(xe).toLowerCase());if(ct===-1)return"";const Ye=new Date(Ge.getFullYear(),Ge.getMonth(),Ge.getDate()),yt=Ye.getDay();if(ct===yt&&Ke.length>0){const Et=Ge.getHours()*60+Ge.getMinutes();if(Ke.some(Wt=>{const[un,Pn]=(Wt.start_time||"00:00").split(":").map(Number);return un*60+(Pn||0)>Et}))return Ye.toISOString().split("T")[0]}let dt=ct-yt;return dt<=0&&(dt+=7),new Date(Ye.getTime()+dt*24*60*60*1e3).toISOString().split("T")[0]},Ds=j.useMemo(()=>{if(!xt||xt.length===0)return{};const xe={};xt.forEach(Ge=>{if(Ge.tutee_rating&&Ge.tutee_rating>0&&Ge.subject){const rt=String(Ge.subject).trim();xe[rt]||(xe[rt]=[]),xe[rt].push(Number(Ge.tutee_rating))}});const Ke={};return Object.entries(xe).forEach(([Ge,rt])=>{const Ye=rt.reduce((yt,dt)=>yt+dt,0)/rt.length;Ke[Ge]={average:Ye,count:rt.length}}),Ke},[xt]),Ks=j.useMemo(()=>{const xe=Object.values(Ds);if(xe.length===0)return null;let Ke=0,Ge=0;return xe.forEach(({average:rt,count:ct})=>{Ke+=rt*ct,Ge+=ct}),Ge>0?Ke/Ge:null},[Ds]),ro=j.useMemo(()=>{const xe=(n||"").trim().toLowerCase();let Ke=t.slice();return xe&&(Ke=Ke.filter(Ge=>{var dt,Dt,Et,Pt;if((Ge.name||"").toLowerCase().includes(xe))return!0;const ct=((dt=Ge.profile)==null?void 0:dt.subjects)||((Dt=Ge.tutor_profile)==null?void 0:Dt.subjects)||[];if(Array.isArray(ct)){for(const Wt of ct)if(String(Wt).toLowerCase().includes(xe))return!0}if((Ge.university_name||"").toLowerCase().includes(xe))return!0;const yt=Ge.university||((Et=Ge.profile)==null?void 0:Et.university)||((Pt=Ge.tutor_profile)==null?void 0:Pt.university);if(yt){const Wt=(yt.name||yt.university_name||yt.display_name||"").toLowerCase(),un=(yt.acronym||"").toLowerCase();if(Wt.includes(xe)||un.includes(xe))return!0}return!1})),c!=="all"&&(Ke=Ke.filter(Ge=>{var Ye;const rt=(Ye=Ge.profile)==null?void 0:Ye.session_rate_per_hour;if(!rt)return!1;const ct=Number(rt);switch(c){case"under_300":return ct<300;case"300_500":return ct>=300&&ct<500;case"500_700":return ct>=500&&ct<700;case"700_plus":return ct>=700;default:return!0}})),h!=="all"&&(Ke=Ke.filter(Ge=>{var Ye,yt;const rt=((Ye=kt[Ge.user_id])==null?void 0:Ye.average)||0,ct=((yt=kt[Ge.user_id])==null?void 0:yt.totalRatings)>0;switch(h){case"4_plus":return rt>=4;case"3":return rt>=3&&rt<4;case"2":return rt>=2&&rt<3;case"1":return rt>=1&&rt<2;case"no_rate":return!ct||rt===0;default:return!0}})),p!=="all"&&(Ke=Ke.filter(Ge=>{var ct,Ye,yt,dt,Dt,Et;return(Ge.university_id||((ct=Ge.university)==null?void 0:ct.university_id)||((yt=(Ye=Ge.profile)==null?void 0:Ye.university)==null?void 0:yt.university_id)||((dt=Ge.tutor_profile)==null?void 0:dt.university_id)||((Et=(Dt=Ge.tutor_profile)==null?void 0:Dt.university)==null?void 0:Et.university_id))===p})),y!=="all"&&(Ke=Ke.filter(Ge=>{var ct,Ye,yt,dt,Dt,Et;return(Ge.course_id||((ct=Ge.course)==null?void 0:ct.course_id)||((yt=(Ye=Ge.profile)==null?void 0:Ye.course)==null?void 0:yt.course_id)||((dt=Ge.tutor_profile)==null?void 0:dt.course_id)||((Et=(Dt=Ge.tutor_profile)==null?void 0:Dt.course)==null?void 0:Et.course_id))===y})),i==="has_subjects"?Ke=Ke.filter(Ge=>{var ct,Ye;const rt=((ct=Ge.profile)==null?void 0:ct.subjects)||((Ye=Ge.tutor_profile)==null?void 0:Ye.subjects)||[];return Array.isArray(rt)&&rt.length>0}):i==="top_rated"?Ke=Ke.sort((Ge,rt)=>{var ct,Ye;return(((ct=kt[rt.user_id])==null?void 0:ct.average)||0)-(((Ye=kt[Ge.user_id])==null?void 0:Ye.average)||0)}):i==="with_reviews"?Ke=Ke.filter(Ge=>{var rt;return(((rt=kt[Ge.user_id])==null?void 0:rt.totalRatings)||0)>0}).sort((Ge,rt)=>{var ct,Ye;return(((ct=kt[rt.user_id])==null?void 0:ct.average)||0)-(((Ye=kt[Ge.user_id])==null?void 0:Ye.average)||0)}):i==="newest"&&(Ke=Ke.sort((Ge,rt)=>new Date(rt.created_at||0).getTime()-new Date(Ge.created_at||0).getTime())),Ke},[t,n,i,c,h,p,y,kt]),Xa=async()=>{var xe,Ke,Ge,rt,ct;if(!((xe=I==null?void 0:I.user)!=null&&xe.tutor_profile)){console.error("handleConfirmBooking: No tutor profile found"),gt.error("Tutor profile not found. Please try again.");return}K(!0);try{const Ye=I.user.tutor_profile.tutor_id;console.log("Creating booking request:",{tutorId:Ye,bookingForm:B,tutorName:I.user.name});const yt=await we.post(`/tutors/${Ye}/booking-requests`,B);console.log("Booking request response:",yt.data),gt.success("Booking request submitted successfully!",{position:"top-center",autoClose:3e3}),setTimeout(()=>{W(!1),bt(!1),O({subject:"",date:"",time:"",duration:1,student_notes:""})},100)}catch(Ye){console.error("Booking request failed:",{error:Ye,response:Ye==null?void 0:Ye.response,data:(Ke=Ye==null?void 0:Ye.response)==null?void 0:Ke.data,status:(Ge=Ye==null?void 0:Ye.response)==null?void 0:Ge.status,message:Ye==null?void 0:Ye.message});const yt=((ct=(rt=Ye==null?void 0:Ye.response)==null?void 0:rt.data)==null?void 0:ct.message)||(Ye==null?void 0:Ye.message)||"Failed to send booking request. Please try again later.";Ve(yt),ie(!0),gt.error(yt,{position:"top-center"})}finally{K(!1)}},Aa=async xe=>{var Ke,Ge,rt;if(xe.tutor_profile){R(!0),W(!0);try{const ct=xe.tutor_profile.tutor_id,[Ye,yt,dt,Dt]=await Promise.all([we.get(`/tutors/${ct}/profile`),we.get(`/tutors/${ct}/availability`),we.get(`/tutors/${ct}/booking-requests`).catch(()=>({data:[]})),we.get(`/tutors/${ct}/documents`).catch(()=>({data:[]}))]);P({user:xe,profile:Ye.data,availability:yt.data});let Et=[];Array.isArray(dt.data)?Et=dt.data:Array.isArray((Ke=dt.data)==null?void 0:Ke.data)?Et=dt.data.data:Array.isArray((Ge=dt.data)==null?void 0:Ge.bookings)&&(Et=dt.data.bookings),Ie(Et);let Pt=[];if(Array.isArray(Dt.data))Pt=Dt.data;else if(Array.isArray((rt=Dt.data)==null?void 0:rt.data))Pt=Dt.data.data;else if(Dt.data&&typeof Dt.data=="object"){const Wt=Dt.data;Wt.documents&&Array.isArray(Wt.documents)?Pt=Wt.documents:Wt.docs&&Array.isArray(Wt.docs)&&(Pt=Wt.docs)}console.log("Fetched tutor documents:",Pt),Nt(Pt)}catch(ct){console.error("Failed to load tutor profile",ct),P({user:xe,profile:null,availability:[]}),Ie([]),Nt([])}finally{R(!1)}}},vr=()=>{var Ge;const xe={},Ke=(((Ge=I==null?void 0:I.profile)==null?void 0:Ge.subjects)||[]).map(rt=>String(rt).trim());if(B.subject?Ke.includes(String(B.subject).trim())||(xe.subject="Please select a subject from the tutor's approved subjects"):xe.subject="Subject is required",!B.date)xe.date="Date is required";else{const rt=new Date(B.date),ct=new Date;ct.setHours(0,0,0,0),isNaN(rt.getTime())?xe.date="Invalid date format":rt<ct?xe.date="Cannot book sessions in the past":rt>new Date(ct.getTime()+2160*60*60*1e3)&&(xe.date="Cannot book more than 90 days in advance")}return B.time?mt.includes(B.time)||(xe.time="Selected time is not available"):xe.time="Time is required",!B.duration||B.duration===0?xe.duration="Duration is required":B.duration<.5?xe.duration="Minimum duration is 30 minutes (0.5 hours)":ut>0&&B.duration*60>ut&&(xe.duration="Selected duration does not fit within the tutor's availability for the chosen date/time"),B.student_notes&&B.student_notes.length>500&&(xe.student_notes="Notes cannot exceed 500 characters"),J(xe),Object.keys(xe).length===0};return o.jsxs("div",{className:"relative min-h-screen bg-gradient-to-br from-slate-50 via-white to-slate-100 text-slate-800 overflow-hidden",children:[o.jsx("div",{className:"absolute -top-24 -left-10 h-72 w-72 bg-sky-100 blur-3xl opacity-70 pointer-events-none"}),o.jsx("div",{className:"absolute top-32 -right-16 h-80 w-80 bg-indigo-100 blur-[120px] opacity-70 pointer-events-none"}),o.jsxs("div",{className:"relative max-w-6xl mx-auto px-2 sm:px-4 lg:px-0 pt-1 sm:pt-1.5 md:pt-2 pb-4 sm:pb-6 md:pb-10 space-y-3 sm:space-y-4 md:space-y-6",children:[o.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl sm:rounded-2xl p-3 sm:p-4 md:p-6 text-white shadow-lg -mx-2 sm:-mx-3 md:mx-0",children:[o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2 sm:mb-3",children:[o.jsx(J3,{className:"h-5 w-5 sm:h-6 sm:w-6 md:h-8 md:w-8 flex-shrink-0"}),o.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl font-bold text-white",children:"Find & Book Tutors"})]}),o.jsx("p",{className:"text-xs sm:text-sm md:text-base lg:text-lg text-blue-100/90 leading-relaxed",children:"Discover verified tutors, explore profiles, and secure your ideal session."})]}),o.jsxs("div",{className:"bg-white/80 backdrop-blur-sm border border-slate-100 shadow-sm rounded-2xl p-3 sm:p-4 md:p-5 space-y-3 sm:space-y-4",children:[o.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-end lg:justify-between gap-3 sm:gap-4",children:[o.jsxs("div",{className:"w-full md:w-2/3",children:[o.jsx("label",{htmlFor:"tutor-search",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Search by name, subject, or university"}),o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(J3,{className:"h-4 w-4 sm:h-5 sm:w-5 text-slate-400"})}),o.jsx("input",{id:"tutor-search",placeholder:"Search For...",value:r,onChange:xe=>a(xe.target.value),onKeyDown:xe=>{xe.key==="Enter"&&(xe.preventDefault(),s(r.trim()))},className:"w-full bg-white border border-slate-200 rounded-2xl pl-10 pr-12 py-2 sm:py-2.5 text-sm md:text-base shadow-sm focus:border-sky-400 focus:ring-2 focus:ring-sky-300 transition duration-150 placeholder:text-slate-400 h-[42px] sm:h-[44px]"}),r?o.jsx("button",{type:"button","aria-label":"Clear search",onClick:()=>{a(""),s("")},className:"absolute right-2 top-1/2 -translate-y-1/2 inline-flex items-center justify-center h-8 w-8 rounded-xl bg-slate-100 hover:bg-slate-200 text-slate-600 transition touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"h-3.5 w-3.5 sm:h-4 sm:w-4",children:o.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})}):o.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-[10px] sm:text-xs text-slate-400 hidden sm:block",children:"Press Enter"})]})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-end gap-3 w-full md:w-auto",children:[o.jsxs("div",{className:"w-full sm:w-auto",children:[o.jsx("label",{htmlFor:"filter-sort",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Sort"}),o.jsxs("select",{id:"filter-sort",value:i,onChange:xe=>l(xe.target.value),className:"border border-slate-200 rounded-2xl px-3 py-2 sm:py-2.5 text-sm md:text-base focus:border-sky-400 focus:ring-2 focus:ring-sky-300 bg-white shadow-sm w-full sm:w-48 transition duration-150 h-[42px] sm:h-[44px]",children:[o.jsx("option",{value:"all",children:"All"}),o.jsx("option",{value:"has_subjects",children:"Has subjects"}),o.jsx("option",{value:"top_rated",children:"Top rated"}),o.jsx("option",{value:"with_reviews",children:"With reviews"}),o.jsx("option",{value:"newest",children:"Newest"})]})]}),o.jsxs("div",{className:"w-full sm:w-auto",children:[o.jsx("label",{htmlFor:"filter-price",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Price"}),o.jsxs("select",{id:"filter-price",value:c,onChange:xe=>u(xe.target.value),className:"border border-slate-200 rounded-2xl px-3 py-2 sm:py-2.5 text-sm md:text-base focus:border-sky-400 focus:ring-2 focus:ring-sky-300 bg-white shadow-sm w-full sm:w-40 transition duration-150 h-[42px] sm:h-[44px]",children:[o.jsx("option",{value:"all",children:"All prices"}),o.jsx("option",{value:"under_300",children:"Under 300/hr"}),o.jsx("option",{value:"300_500",children:"300-500/hr"}),o.jsx("option",{value:"500_700",children:"500-700/hr"}),o.jsx("option",{value:"700_plus",children:"700+/hr"})]})]}),o.jsxs("div",{className:"w-full sm:w-auto",children:[o.jsx("label",{htmlFor:"filter-rating",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Rating"}),o.jsxs("select",{id:"filter-rating",value:h,onChange:xe=>f(xe.target.value),className:"border border-slate-200 rounded-2xl px-3 py-2 sm:py-2.5 text-sm md:text-base focus:border-sky-400 focus:ring-2 focus:ring-sky-300 bg-white shadow-sm w-full sm:w-36 transition duration-150 h-[42px] sm:h-[44px]",children:[o.jsx("option",{value:"all",children:"All ratings"}),o.jsx("option",{value:"4_plus",children:"4+ "}),o.jsx("option",{value:"3",children:"3 "}),o.jsx("option",{value:"2",children:"2 "}),o.jsx("option",{value:"1",children:"1 "}),o.jsx("option",{value:"no_rate",children:"No rate"})]})]})]})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-end gap-3 w-full",children:[o.jsxs("div",{className:"w-full sm:w-auto",children:[o.jsx("label",{htmlFor:"filter-university",className:"block text-sm font-semibold text-slate-700 mb-2",children:"University"}),o.jsxs("select",{id:"filter-university",value:p,onChange:xe=>x(xe.target.value==="all"?"all":Number(xe.target.value)),className:"border border-slate-200 rounded-2xl px-3 py-2 sm:py-2.5 text-sm md:text-base focus:border-sky-400 focus:ring-2 focus:ring-sky-300 bg-white shadow-sm w-full sm:w-80 md:w-96 lg:w-[28rem] transition duration-150 h-[42px] sm:h-[44px]",children:[o.jsx("option",{value:"all",children:"All universities"}),b.map(xe=>o.jsx("option",{value:xe.university_id,children:xe.acronym?`${xe.acronym} - ${xe.name||xe.university_name||xe.display_name}`:xe.name||xe.university_name||xe.display_name},xe.university_id))]})]}),o.jsxs("div",{className:"w-full sm:w-auto",children:[o.jsx("label",{htmlFor:"filter-course",className:"block text-sm font-semibold text-slate-700 mb-2",children:"Course"}),o.jsxs("select",{id:"filter-course",value:y,onChange:xe=>v(xe.target.value==="all"?"all":Number(xe.target.value)),disabled:p==="all",className:"border border-slate-200 rounded-2xl px-3 py-2 sm:py-2.5 text-sm md:text-base focus:border-sky-400 focus:ring-2 focus:ring-sky-300 bg-white shadow-sm w-full sm:w-80 md:w-96 lg:w-[28rem] transition duration-150 h-[42px] sm:h-[44px] disabled:bg-slate-50 disabled:text-slate-400 disabled:cursor-not-allowed",children:[o.jsx("option",{value:"all",children:p==="all"?"Select university first":"All courses"}),p!=="all"&&S.filter(xe=>xe.university_id===p).map(xe=>o.jsx("option",{value:xe.course_id||xe.id,children:xe.acronym?`${xe.acronym} - ${xe.course_name||xe.name}`:xe.course_name||xe.name},xe.course_id||xe.id))]})]})]})]}),me&&o.jsxs("div",{className:"bg-white/90 backdrop-blur rounded-2xl shadow-lg border border-slate-100 p-4 sm:p-5 md:p-6",children:[o.jsxs("div",{className:"flex items-center justify-between gap-2 mb-4",children:[o.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-slate-900",children:"My Bookings"}),o.jsxs("span",{className:"text-xs sm:text-sm text-slate-500",children:[fe.length," total"]})]}),Te?o.jsx("div",{className:"text-xs sm:text-sm md:text-base text-slate-600",children:"Loading your bookings..."}):Se?o.jsx("div",{className:"text-xs sm:text-sm md:text-base text-red-500",children:Se}):fe.length===0?o.jsx("div",{className:"text-xs sm:text-sm md:text-base text-slate-600",children:"You have no bookings yet."}):o.jsx("div",{className:"mt-2 sm:mt-3 space-y-2 sm:space-y-3",children:fe.map(xe=>{var Ke,Ge;return o.jsxs("div",{className:"border border-slate-200 rounded-xl p-3 sm:p-4 flex flex-col sm:flex-row items-start sm:items-center justify-between gap-3 hover:border-sky-200 hover:shadow-md transition",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"font-medium text-xs sm:text-sm md:text-base text-slate-800 break-words",children:[xe.subject," with ",((Ge=(Ke=xe.tutor)==null?void 0:Ke.user)==null?void 0:Ge.name)||"Tutor"]}),o.jsxs("div",{className:"text-[10px] sm:text-xs md:text-sm text-slate-600 mt-1",children:[new Date(xe.date).toLocaleDateString(),"  ",xe.time,"  ",xe.duration,"h"]}),xe.student_notes&&o.jsxs("div",{className:"text-[10px] sm:text-xs md:text-sm text-slate-500 mt-1 break-words",children:["Notes: ",xe.student_notes]})]}),o.jsx("div",{className:"text-xs sm:text-sm md:text-base font-semibold px-3 py-1 rounded-full bg-sky-50 text-sky-700 whitespace-nowrap capitalize",children:xe.status})]},xe.id)})})]}),o.jsx("div",{children:T?o.jsx("div",{className:"text-slate-600",children:"Loading tutors..."}):D?o.jsx("div",{className:"text-red-500",children:D}):t.length===0?o.jsx("div",{className:"text-slate-600",children:"No tutors found."}):o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-3 gap-3 sm:gap-4",children:ro.map(xe=>{var Ge,rt,ct,Ye,yt;const Ke=((Ge=xe.profile)==null?void 0:Ge.subjects)||((rt=xe.tutor_profile)==null?void 0:rt.subjects)||[];return o.jsxs("div",{className:"group relative bg-white border border-slate-200 rounded-2xl p-4 sm:p-4 shadow-sm hover:shadow-xl hover:border-sky-200 transition-all duration-200 flex flex-col h-full",children:[o.jsx("div",{className:"absolute inset-x-0 top-0 h-1 rounded-t-2xl bg-gradient-to-r from-sky-400 via-indigo-400 to-sky-500 opacity-0 group-hover:opacity-100 transition-opacity"}),o.jsxs("div",{className:"flex flex-col items-center text-center sm:hidden flex-1",children:[o.jsxs("div",{className:"relative mb-3",children:[o.jsx("div",{className:"h-20 w-20 rounded-full ring-4 ring-sky-100 shadow-lg overflow-hidden bg-gradient-to-br from-sky-50 to-indigo-50",children:o.jsx("img",{src:Zt(xe.profile_image_url||""),alt:xe.name,className:"w-full h-full object-cover",onError:dt=>{dt.target.src=`https://ui-avatars.com/api/?name=${encodeURIComponent(xe.name)}`}})}),Ce[xe.user_id]&&o.jsx("div",{className:"absolute -bottom-1 -right-1 h-5 w-5 bg-green-500 rounded-full border-2 border-white shadow-md"})]}),o.jsx("h3",{className:"font-bold text-base text-slate-800 mb-1",children:xe.name}),o.jsxs("div",{className:"flex items-center justify-center gap-1.5 mb-3",children:[o.jsx("svg",{className:"w-3.5 h-3.5 text-sky-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0v-5.5a2.5 2.5 0 015 0V21m-5 0h5m-5 0v-5.5a2.5 2.5 0 015 0V21"})}),o.jsx("span",{className:"text-xs text-slate-600",children:xe.university_name||"N/A"})]}),o.jsx("div",{className:"flex items-center justify-center gap-1.5 mb-3",children:(()=>{const dt=kt[xe.user_id],Dt=(dt==null?void 0:dt.average)||0,Et=(dt==null?void 0:dt.totalRatings)||0;return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex items-center",children:[1,2,3,4,5].map(Pt=>o.jsx("svg",{className:`w-4 h-4 ${Pt<=Math.floor(Dt)?"text-yellow-400 fill-current":"text-gray-300"}`,fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},Pt))}),o.jsxs("span",{className:"text-xs font-semibold text-slate-700",children:[Dt>0?Dt.toFixed(1):"No ratings",Et>0?` (${Et})`:""]})]})})()}),Ke.length>0&&o.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-1.5 mb-3",children:[Ke.slice(0,3).map((dt,Dt)=>o.jsx("span",{className:"text-xs text-sky-700 bg-gradient-to-r from-sky-50 to-indigo-50 border border-sky-200 px-3 py-1 rounded-full font-medium shadow-sm",children:dt},Dt)),Ke.length>3&&o.jsxs("span",{className:"text-xs text-indigo-700 bg-gradient-to-r from-indigo-50 to-sky-50 border border-indigo-200 px-3 py-1 rounded-full font-semibold shadow-sm",children:["+",Ke.length-3]})]}),(ct=xe.profile)!=null&&ct.session_rate_per_hour?o.jsxs("div",{className:"flex items-center justify-center gap-2 mb-3 px-4 py-2 bg-gradient-to-r from-emerald-50 to-teal-50 rounded-xl border border-emerald-200",children:[o.jsx("svg",{className:"w-4 h-4 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),o.jsxs("span",{className:"text-sm font-bold text-emerald-700",children:["",Number(xe.profile.session_rate_per_hour).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}),"/hr"]})]}):o.jsx("div",{className:"text-xs text-slate-400 italic mb-3",children:"Price not set"})]}),o.jsxs("div",{className:"hidden sm:flex items-start gap-3 flex-1",children:[o.jsxs("div",{className:"relative flex-shrink-0",children:[o.jsx("img",{src:Zt(xe.profile_image_url||""),alt:xe.name,className:"h-16 w-16 rounded-full object-cover flex-shrink-0 ring-4 ring-slate-50 shadow-md",onError:dt=>{dt.target.src=`https://ui-avatars.com/api/?name=${encodeURIComponent(xe.name)}`}}),Ce[xe.user_id]&&o.jsx("div",{className:"absolute -bottom-0.5 -right-0.5 h-4 w-4 bg-green-500 rounded-full border-2 border-white shadow-md"})]}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("div",{className:"font-semibold text-xs sm:text-sm md:text-base text-slate-800 truncate",children:xe.name}),o.jsx("div",{className:"text-[10px] sm:text-xs md:text-sm text-slate-500 truncate",children:xe.university_name||"N/A"}),o.jsxs("div",{className:"mt-2 space-y-2",children:[o.jsx("div",{className:"flex items-center gap-1",children:(()=>{const dt=kt[xe.user_id],Dt=(dt==null?void 0:dt.average)||0,Et=(dt==null?void 0:dt.totalRatings)||0;return o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"flex items-center flex-shrink-0",children:[1,2,3,4,5].map(Pt=>o.jsx("svg",{className:`w-3 h-3 sm:w-3.5 sm:h-3.5 md:w-4 md:h-4 ${Pt<=Math.floor(Dt)?"text-yellow-400 fill-current":"text-gray-300"}`,fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},Pt))}),o.jsxs("span",{className:"text-[10px] sm:text-xs md:text-sm text-slate-600 truncate",children:[Dt>0?Dt.toFixed(1):"No ratings",Et>0?` (${Et})`:""]})]})})()}),Ke.length>0&&o.jsxs("div",{className:"flex flex-wrap items-center gap-1",children:[Ke.slice(0,3).map((dt,Dt)=>o.jsx("span",{className:"text-[10px] sm:text-xs text-sky-700 bg-sky-50 border border-sky-100 px-2 py-0.5 rounded-full whitespace-nowrap",children:dt},Dt)),Ke.length>3&&o.jsxs("span",{className:"text-[10px] sm:text-xs text-sky-600 bg-sky-100 border border-sky-200 px-2 py-0.5 rounded-full font-medium",children:["+",Ke.length-3]})]})]}),o.jsx("div",{className:"mt-2 min-h-[20px] sm:min-h-[24px] flex items-center",children:(Ye=xe.profile)!=null&&Ye.session_rate_per_hour?o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx("svg",{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 text-emerald-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),o.jsxs("span",{className:"text-xs sm:text-sm md:text-base font-semibold text-emerald-700",children:["",Number(xe.profile.session_rate_per_hour).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}),"/hr"]})]}):o.jsx("div",{className:"text-[10px] sm:text-xs text-slate-400 italic",children:"Price not set"})})]})]}),o.jsxs("div",{className:"mt-4 pt-3 border-t border-slate-100 flex flex-col sm:flex-row items-center sm:items-start sm:justify-between gap-3 flex-shrink-0",children:[o.jsxs("div",{className:"inline-flex items-center gap-2 text-xs sm:text-[11px] md:text-sm text-slate-600",children:[o.jsx("span",{className:"h-2 w-2 rounded-full bg-emerald-400"}),o.jsx("span",{className:"font-medium capitalize",children:((yt=xe.tutor_profile)==null?void 0:yt.status)||"pending"})]}),o.jsx("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:o.jsx("button",{onClick:()=>Aa(xe),className:"px-4 sm:px-4 py-2.5 bg-gradient-to-r from-sky-600 to-indigo-600 text-white rounded-xl text-sm md:text-base font-semibold hover:shadow-lg transition-all w-full sm:w-auto touch-manipulation shadow-md hover:shadow-xl",style:{WebkitTapHighlightColor:"transparent"},children:"View Profile"})})]})]},xe.user_id)})})}),F&&o.jsx(On,{isOpen:!0,onClose:()=>{W(!1),ae(!1),O({subject:"",date:"",time:"",duration:1,student_notes:""})},title:"",maxWidth:se?"full":"5xl",className:`${se?"w-full h-full sm:h-[90vh] flex flex-col":"md:max-w-[90vw] lg:max-w-5xl"}`,contentClassName:`${se?"flex-1 overflow-y-auto":""}`,footer:o.jsx(o.Fragment,{children:se?o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>{if(!vr()){gt.error("Please fix booking errors before submitting");return}bt(!0)},disabled:z,className:`ml-2 px-6 py-2.5 rounded-lg text-white font-medium shadow-lg hover:shadow-xl transition-all duration-200 flex items-center gap-2 ${z?"bg-gray-400 cursor-not-allowed":"bg-gradient-to-r from-blue-600 to-indigo-600 hover:from-blue-700 hover:to-indigo-700"}`,children:z?o.jsxs(o.Fragment,{children:[o.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Submitting"]}):o.jsxs(o.Fragment,{children:[o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Submit Booking"]})}),o.jsx("button",{onClick:()=>{ae(!1),O({subject:"",date:"",time:"",duration:1,student_notes:""})},className:"px-6 py-2.5 border-2 border-slate-300 rounded-lg hover:bg-slate-50 font-medium transition-colors",children:"Cancel"})]}):o.jsxs(o.Fragment,{children:[o.jsxs("button",{onClick:()=>ae(!0),className:"ml-2 px-6 py-2.5 rounded-lg text-white bg-gradient-to-r from-green-600 to-emerald-600 hover:from-green-700 hover:to-emerald-700 font-medium shadow-lg hover:shadow-xl transition-all duration-200 flex items-center gap-2",children:[o.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Book Session"]}),o.jsx("button",{onClick:()=>{W(!1),ae(!1),O({subject:"",date:"",time:"",duration:1,student_notes:""})},className:"px-6 py-2.5 border-2 border-slate-300 rounded-lg hover:bg-slate-50 font-medium transition-colors",children:"Close"})]})}),children:$?o.jsxs("div",{className:"flex flex-col items-center justify-center py-12",children:[o.jsxs("svg",{className:"animate-spin h-12 w-12 text-indigo-600 mb-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),o.jsx("div",{className:"text-slate-600 font-medium",children:"Loading profile..."})]}):o.jsx("div",{className:`${se?"p-0 sm:p-0 lg:p-0":"p-4 sm:p-6 lg:p-6"}`,children:o.jsx("div",{className:`${se?"px-4 sm:px-6 lg:px-6 py-4":""}`,children:o.jsxs("div",{className:"space-y-4 sm:space-y-5 md:space-y-6 lg:space-y-6",children:[o.jsx("div",{className:"relative rounded-xl sm:rounded-2xl lg:rounded-2xl overflow-hidden shadow-2xl",children:o.jsxs("div",{className:"bg-gradient-to-br from-sky-600 via-indigo-600 to-indigo-700 p-4 sm:p-6 md:p-7 lg:p-8 text-white relative overflow-hidden",children:[o.jsxs("div",{className:"absolute inset-0 opacity-10",children:[o.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 sm:w-48 sm:h-48 md:w-56 md:h-56 lg:w-64 lg:h-64 bg-white rounded-full -mr-16 sm:-mr-24 md:-mr-28 lg:-mr-32 -mt-16 sm:-mt-24 md:-mt-28 lg:-mt-32"}),o.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 sm:w-36 sm:h-36 md:w-44 md:h-44 lg:w-52 lg:h-52 bg-white rounded-full -ml-12 sm:-ml-18 md:-ml-22 lg:-ml-26 -mb-12 sm:-mb-18 md:-mb-22 lg:-mb-26"}),o.jsx("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-40 h-40 sm:w-56 sm:h-56 md:w-72 md:h-72 lg:w-80 lg:h-80 bg-white rounded-full opacity-5"})]}),o.jsxs("div",{className:"relative flex flex-col items-center gap-3 sm:gap-4 md:gap-5 lg:gap-6",children:[o.jsxs("div",{className:"relative flex-shrink-0",children:[o.jsx("div",{className:"h-24 w-24 sm:h-28 sm:w-28 md:h-30 md:w-30 lg:h-32 lg:w-32 rounded-full ring-2 sm:ring-3 md:ring-4 ring-white/30 shadow-2xl overflow-hidden bg-white/10 backdrop-blur-sm",children:o.jsx("img",{src:Zt(((Fo=I==null?void 0:I.user)==null?void 0:Fo.profile_image_url)||""),alt:(Kl=I==null?void 0:I.user)==null?void 0:Kl.name,className:"w-full h-full object-cover",onError:xe=>{var Ke;xe.target.src=`https://ui-avatars.com/api/?name=${encodeURIComponent(((Ke=I==null?void 0:I.user)==null?void 0:Ke.name)||"Tutor")}`}})}),Ce[(Ya=I==null?void 0:I.user)==null?void 0:Ya.user_id]&&o.jsx("div",{className:"absolute -bottom-1 -right-1 sm:-bottom-1.5 sm:-right-1.5 md:-bottom-2 md:-right-2 h-5 w-5 sm:h-6 sm:w-6 md:h-7 md:w-7 bg-green-500 rounded-full border-2 sm:border-3 md:border-4 border-white shadow-lg"}),((Si=I==null?void 0:I.profile)==null?void 0:Si.is_verified)&&o.jsx("div",{className:`absolute ${Ce[(Qa=I==null?void 0:I.user)==null?void 0:Qa.user_id]?"-bottom-1 -left-1 sm:-bottom-1.5 sm:-left-1.5 md:-bottom-2 md:-left-2":"-bottom-1 -right-1 sm:-bottom-1.5 sm:-right-1.5 md:-bottom-2 md:-right-2"} bg-green-500 rounded-full p-1 sm:p-1.5 md:p-1.5 ring-2 sm:ring-3 md:ring-4 ring-white shadow-lg`,children:o.jsx("svg",{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 md:w-5 md:h-5 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})})]}),o.jsxs("div",{className:"flex flex-col items-center w-full",children:[o.jsx("h2",{className:"text-xl sm:text-2xl md:text-2xl lg:text-3xl font-bold leading-tight mb-2 text-center",children:(ji=I==null?void 0:I.user)==null?void 0:ji.name}),o.jsxs("div",{className:"flex items-center justify-center gap-1.5 sm:gap-2 text-white/90 mb-3 sm:mb-4",children:[o.jsx("svg",{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0v-5.5a2.5 2.5 0 015 0V21m-5 0h5m-5 0v-5.5a2.5 2.5 0 015 0V21"})}),o.jsx("span",{className:"text-xs sm:text-sm font-medium",children:((zo=I==null?void 0:I.user)==null?void 0:zo.university_name)||"N/A"})]}),o.jsxs("div",{className:"flex flex-wrap items-center justify-center gap-2 sm:gap-3",children:[Ks!==null&&o.jsxs("div",{className:"inline-flex items-center bg-white/20 backdrop-blur-sm text-white text-xs sm:text-sm rounded-full px-2.5 sm:px-3 md:px-4 py-1.5 sm:py-2 shadow-lg border border-white/20",children:[o.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 mr-1.5 sm:mr-2 text-yellow-300 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})}),o.jsx("span",{className:"font-bold text-sm sm:text-base md:text-lg",children:Ks.toFixed(1)}),o.jsxs("span",{className:"text-[10px] sm:text-xs opacity-90 ml-1.5 sm:ml-2",children:["(",Object.values(Ds).reduce((xe,Ke)=>xe+Ke.count,0)," ",Object.values(Ds).reduce((xe,Ke)=>xe+Ke.count,0)===1?"rating":"ratings",")"]})]}),((wr=I==null?void 0:I.profile)==null?void 0:wr.session_rate_per_hour)&&o.jsxs("div",{className:"inline-flex items-center bg-white/20 backdrop-blur-sm text-white text-xs sm:text-sm rounded-full px-2.5 sm:px-3 md:px-4 py-1.5 sm:py-2 shadow-lg border border-white/20",children:[o.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 mr-1.5 sm:mr-2 text-emerald-300 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),o.jsxs("span",{className:"font-bold text-sm sm:text-base md:text-lg",children:["",Number(I.profile.session_rate_per_hour).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}),"/hr"]})]})]})]})]})]})}),!se&&o.jsxs("div",{className:"space-y-4 sm:space-y-5 md:space-y-5 lg:space-y-6",children:[o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-5 md:gap-5 lg:gap-6",children:[o.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl lg:rounded-xl p-4 sm:p-5 md:p-5 lg:p-6 shadow-lg border border-slate-200 hover:shadow-xl transition-shadow duration-300",children:[o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-3 sm:mb-3.5 md:mb-4",children:[o.jsx("div",{className:"p-2 sm:p-2.5 bg-gradient-to-br from-sky-100 to-sky-200 rounded-xl flex-shrink-0 shadow-md",children:o.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6 text-sky-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),o.jsx("h3",{className:"text-lg sm:text-xl md:text-xl lg:text-xl font-bold text-slate-800",children:"About"})]}),o.jsx("p",{className:"text-sm sm:text-base text-slate-700 leading-relaxed break-words",children:((us=I==null?void 0:I.profile)==null?void 0:us.bio)||"No bio provided."})]}),o.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl lg:rounded-xl p-4 sm:p-5 md:p-5 lg:p-6 shadow-lg border border-slate-200 hover:shadow-xl transition-shadow duration-300",children:[o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-3 sm:mb-4 md:mb-4",children:[o.jsx("div",{className:"p-2 sm:p-2.5 bg-gradient-to-br from-indigo-100 to-indigo-200 rounded-xl flex-shrink-0 shadow-md",children:o.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-lg sm:text-xl md:text-xl lg:text-xl font-bold text-slate-800",children:"Subjects"}),o.jsxs("p",{className:"text-xs sm:text-sm text-slate-500 mt-0.5",children:[(((Ps=I==null?void 0:I.profile)==null?void 0:Ps.subjects)||[]).length," ",((($a=I==null?void 0:I.profile)==null?void 0:$a.subjects)||[]).length===1?"subject":"subjects"," available"]})]})]}),(((Lr=I==null?void 0:I.profile)==null?void 0:Lr.subjects)||[]).length===0?o.jsxs("div",{className:"text-center py-6 sm:py-8 lg:py-10",children:[o.jsx("svg",{className:"w-14 h-14 sm:w-18 sm:h-18 lg:w-20 lg:h-20 text-slate-300 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),o.jsx("p",{className:"text-sm sm:text-base text-slate-500",children:"No subjects listed"})]}):o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2.5 sm:gap-3",children:(((ao=I==null?void 0:I.profile)==null?void 0:ao.subjects)||[]).map((xe,Ke)=>{const Ge=Ds[xe];return o.jsxs("button",{onClick:()=>{a(String(xe)),s(String(xe)),W(!1)},className:"group relative px-3 sm:px-4 md:px-4 py-2.5 sm:py-3 md:py-3 bg-gradient-to-r from-sky-100 to-indigo-100 text-sky-800 rounded-lg hover:from-sky-200 hover:to-indigo-200 active:from-sky-300 active:to-indigo-300 transition-all duration-200 font-medium text-sm sm:text-sm shadow-md hover:shadow-lg border-2 border-sky-200 hover:border-sky-400 touch-manipulation text-left w-full overflow-visible",style:{WebkitTapHighlightColor:"transparent"},children:[o.jsxs("div",{className:"relative z-10 flex flex-col gap-1.5 min-w-0 w-full",children:[o.jsx("span",{className:"block break-words font-semibold w-full",children:xe}),Ge&&Ge.count>0?o.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap min-w-0 w-full",children:[o.jsx("div",{className:"flex items-center flex-shrink-0",children:[1,2,3,4,5].map(rt=>o.jsx("svg",{className:`w-3.5 h-3.5 sm:w-4 sm:h-4 flex-shrink-0 ${rt<=Math.floor(Ge.average)?"text-yellow-400 fill-current":"text-slate-300"}`,fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{d:"M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"})},rt))}),o.jsx("span",{className:"text-xs font-bold text-slate-700 whitespace-nowrap flex-shrink-0",children:Ge.average.toFixed(1)}),o.jsxs("span",{className:"text-[10px] sm:text-xs text-slate-500 whitespace-nowrap flex-shrink-0",children:["(",Ge.count," ",Ge.count===1?"rating":"ratings",")"]})]}):o.jsx("span",{className:"text-[10px] sm:text-xs text-slate-500 italic",children:"No ratings yet"})]}),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-sky-600 to-indigo-600 rounded-lg opacity-0 group-hover:opacity-10 transition-opacity"})]},Ke)})})]})]}),o.jsxs("div",{className:"bg-gradient-to-br from-sky-50 via-indigo-50 to-sky-50 rounded-lg sm:rounded-xl lg:rounded-xl p-4 sm:p-5 md:p-5 lg:p-6 shadow-lg border-2 border-sky-200 hover:shadow-xl transition-shadow duration-300",children:[o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-3 sm:mb-4 md:mb-4",children:[o.jsx("div",{className:"p-2 sm:p-2.5 bg-gradient-to-br from-sky-200 to-indigo-200 rounded-xl flex-shrink-0 shadow-md",children:o.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6 text-sky-700 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),o.jsx("h4",{className:"font-bold text-indigo-900 text-lg sm:text-xl md:text-xl lg:text-xl",children:"Availability"})]}),((I==null?void 0:I.availability)||[]).length===0?o.jsxs("div",{className:"text-center py-6 sm:py-8 lg:py-10",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-14 h-14 sm:w-18 sm:h-18 lg:w-20 lg:h-20 bg-slate-100 rounded-full mb-3",children:o.jsx("svg",{className:"w-7 h-7 sm:w-9 sm:h-9 lg:w-10 lg:h-10 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),o.jsx("div",{className:"text-sm sm:text-base text-slate-600 font-medium",children:"No availability provided."})]}):o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2.5 sm:gap-3",children:(()=>{const xe={};((I==null?void 0:I.availability)||[]).forEach(ct=>{const Ye=ct.day_of_week||"";xe[Ye]||(xe[Ye]=[]),xe[Ye].push(ct)});const Ke={Monday:{bg:"bg-sky-100",border:"border-sky-300",text:"text-sky-800",icon:""},Tuesday:{bg:"bg-sky-200",border:"border-sky-400",text:"text-sky-900",icon:""},Wednesday:{bg:"bg-indigo-100",border:"border-indigo-300",text:"text-indigo-800",icon:""},Thursday:{bg:"bg-indigo-200",border:"border-indigo-400",text:"text-indigo-900",icon:""},Friday:{bg:"bg-sky-50",border:"border-sky-200",text:"text-sky-700",icon:""},Saturday:{bg:"bg-indigo-50",border:"border-indigo-200",text:"text-indigo-700",icon:""},Sunday:{bg:"bg-sky-300",border:"border-sky-500",text:"text-sky-900",icon:""}},Ge=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];return Object.keys(xe).sort((ct,Ye)=>{const yt=Ge.indexOf(ct),dt=Ge.indexOf(Ye);return(yt===-1?999:yt)-(dt===-1?999:dt)}).map(ct=>{const Ye=xe[ct],yt=Ke[ct]||{bg:"bg-slate-100",border:"border-slate-300",text:"text-slate-800",icon:""},dt=qn(ct,Ye),Dt=dt&&new Date(dt)>=new Date(new Date().toISOString().split("T")[0]),Et=Ye.reduce((Pt,Wt)=>{const un=new Date(`1970-01-01T${Wt.start_time}`),Ls=(new Date(`1970-01-01T${Wt.end_time}`).getTime()-un.getTime())/(1e3*60*60);return Pt+Ls},0);return o.jsxs("div",{className:`${yt.bg} ${yt.border} border-2 rounded-lg p-3 sm:p-3.5 transition-all duration-200 hover:shadow-lg hover:scale-[1.01]`,children:[o.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-2.5 gap-2",children:[o.jsxs("div",{className:"flex items-center gap-2 sm:gap-2.5",children:[o.jsx("span",{className:"text-base sm:text-lg",children:yt.icon}),o.jsx("div",{className:`font-bold ${yt.text} text-sm sm:text-base uppercase tracking-wide`,children:ct.substring(0,3)})]}),Dt&&o.jsxs("span",{className:"text-xs sm:text-sm bg-white/80 text-slate-700 px-2 sm:px-2.5 py-1 sm:py-1 rounded-full font-semibold whitespace-nowrap shadow-sm",children:["Next: ",new Date(dt).toLocaleDateString("en-US",{month:"short",day:"numeric"})]})]}),o.jsx("div",{className:"space-y-2 sm:space-y-2.5",children:Ye.map((Pt,Wt)=>{var un,Pn;return o.jsxs("div",{className:"flex items-center gap-2 sm:gap-2.5",children:[o.jsx("svg",{className:`w-4 h-4 sm:w-5 sm:h-5 ${yt.text} flex-shrink-0`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),o.jsxs("div",{className:`${yt.text} font-bold text-sm sm:text-base`,children:[((un=Pt.start_time)==null?void 0:un.substring(0,5))||Pt.start_time," - ",((Pn=Pt.end_time)==null?void 0:Pn.substring(0,5))||Pt.end_time]})]},Pt.availability_id||Wt)})}),o.jsx("div",{className:"pt-2 sm:pt-2.5 border-t-2 border-white/60 mt-2 sm:mt-2.5",children:o.jsxs("div",{className:"flex items-center gap-1.5 sm:gap-2",children:[o.jsx("svg",{className:"w-3 h-3 sm:w-3.5 sm:h-3.5 text-slate-600 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z",clipRule:"evenodd"})}),o.jsxs("span",{className:"text-xs sm:text-sm text-slate-700 font-medium",children:[Et.toFixed(1),"h total available"]})]})})]},ct)})})()})]}),o.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl lg:rounded-xl p-4 sm:p-5 md:p-5 lg:p-6 shadow-lg border border-slate-200 hover:shadow-xl transition-shadow duration-300",children:[o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-3 sm:mb-4 md:mb-4",children:[o.jsx("div",{className:"p-2 sm:p-2.5 bg-gradient-to-br from-emerald-100 to-emerald-200 rounded-xl flex-shrink-0 shadow-md",children:o.jsx(bs,{className:"w-5 h-5 sm:w-6 sm:h-6 text-emerald-600"})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-lg sm:text-xl md:text-xl lg:text-xl font-bold text-slate-800",children:"Supporting Documents"}),o.jsx("p",{className:"text-xs sm:text-sm text-slate-500 mt-0.5",children:"Verified documents to ensure tutor reliability"})]})]}),lt.length>0?o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2.5 sm:gap-3",children:lt.map((xe,Ke)=>o.jsxs("div",{className:"flex items-center justify-between bg-gradient-to-r from-slate-50 via-emerald-50/30 to-slate-50 rounded-lg p-3 sm:p-3.5 border-2 border-slate-200/50 hover:border-emerald-300 hover:shadow-md transition-all duration-200",children:[o.jsxs("div",{className:"flex items-center min-w-0 flex-1",children:[o.jsx("div",{className:"p-1.5 sm:p-2 bg-gradient-to-br from-emerald-100 to-emerald-200 rounded-lg mr-2.5 flex-shrink-0",children:o.jsx(bs,{className:"h-4 w-4 sm:h-5 sm:w-5 text-emerald-600"})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-xs sm:text-sm font-semibold text-slate-800 truncate",title:xe.file_name||`Document ${Ke+1}`,children:xe.file_name||`Document ${Ke+1}`}),o.jsx("p",{className:"text-[10px] sm:text-xs text-slate-500 truncate",children:xe.file_type||"File"})]})]}),o.jsx("div",{className:"flex items-center gap-1.5 sm:gap-2 flex-shrink-0 ml-2",children:xe.file_url&&o.jsxs(o.Fragment,{children:[o.jsx("a",{href:Zt(xe.file_url),target:"_blank",rel:"noopener noreferrer",className:"text-[10px] sm:text-xs px-2 sm:px-2.5 py-1 sm:py-1.5 bg-gradient-to-r from-emerald-600 to-emerald-700 text-white hover:from-emerald-700 hover:to-emerald-800 rounded-lg font-semibold shadow-sm hover:shadow-md transition-all duration-200 whitespace-nowrap",title:"View document",children:"View"}),o.jsx("a",{href:Zt(xe.file_url),download:!0,className:"text-[10px] sm:text-xs px-2 sm:px-2.5 py-1 sm:py-1.5 bg-gradient-to-r from-slate-600 to-slate-700 text-white hover:from-slate-700 hover:to-slate-800 rounded-lg font-semibold shadow-sm hover:shadow-md transition-all duration-200 whitespace-nowrap",title:"Download document",children:"Download"})]})})]},xe.document_id||xe.id||Ke))}):o.jsxs("div",{className:"text-center py-6 sm:py-8 lg:py-10",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-14 h-14 sm:w-18 sm:h-18 lg:w-20 lg:h-20 bg-slate-100 rounded-full mb-3",children:o.jsx(bs,{className:"w-7 h-7 sm:w-9 sm:h-9 lg:w-10 lg:h-10 text-slate-400"})}),o.jsx("p",{className:"text-sm sm:text-base text-slate-500 font-medium",children:"No supporting documents uploaded yet."})]})]})]}),se&&o.jsxs("div",{className:"w-full overflow-hidden rounded-3xl border-2 border-sky-200/50 shadow-2xl bg-gradient-to-br from-white via-sky-50/30 to-indigo-50/20 backdrop-blur-sm flex flex-col h-full max-h-none",children:[o.jsxs("div",{className:"relative bg-gradient-to-r from-sky-600 via-indigo-600 to-indigo-700 px-4 sm:px-8 py-5 sm:py-6 text-white overflow-hidden",children:[o.jsxs("div",{className:"absolute inset-0 opacity-10",children:[o.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white rounded-full -mr-32 -mt-32"}),o.jsx("div",{className:"absolute bottom-0 left-0 w-48 h-48 bg-white rounded-full -ml-24 -mb-24"})]}),o.jsxs("div",{className:"relative flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsx("div",{className:"p-3 bg-white/20 backdrop-blur-sm rounded-2xl shadow-lg border border-white/20",children:o.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-2xl sm:text-3xl font-bold leading-tight mb-1",children:"Book a Session"}),o.jsx("p",{className:"text-sm sm:text-base text-white/90",children:"Choose your subject, schedule, and leave notes for your tutor."})]})]}),o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsxs("span",{className:"inline-flex items-center gap-2 rounded-full bg-white/20 backdrop-blur-sm px-4 py-2 border border-white/20 shadow-md",children:[o.jsx("span",{className:"h-2.5 w-2.5 rounded-full bg-emerald-300 animate-pulse"}),o.jsx("span",{className:"text-sm font-semibold",children:"Step 1  Details"})]}),o.jsxs("span",{className:"hidden sm:inline-flex items-center gap-2 text-sm text-white/80",children:[o.jsx("span",{className:"h-1 w-1 rounded-full bg-white/60"}),"Step 2  Review & Confirm"]})]})]})]}),o.jsx("div",{className:"px-3 sm:px-6 lg:px-8 py-4 sm:py-8 lg:py-10 flex-1 overflow-y-auto",children:o.jsxs("div",{className:"flex flex-col gap-4 lg:grid lg:grid-cols-[minmax(0,1.8fr)_minmax(0,1fr)] lg:gap-6 lg:items-stretch",children:[o.jsx("div",{className:"flex-1 order-2 lg:order-1",children:o.jsxs("div",{className:"bg-white rounded-xl sm:rounded-2xl border border-slate-200/80 sm:border-2 sm:border-slate-200/60 shadow-lg sm:shadow-xl overflow-hidden flex flex-col h-full",children:[o.jsx("div",{className:"bg-gradient-to-r from-sky-50 via-indigo-50 to-sky-50 border-b border-slate-200/80 sm:border-b-2 sm:border-slate-200/60 px-4 sm:px-6 py-3 sm:py-4",children:o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[o.jsx("div",{className:"inline-flex h-8 w-8 sm:h-10 sm:w-10 items-center justify-center rounded-lg sm:rounded-xl bg-gradient-to-br from-sky-500 to-indigo-500 text-white font-bold text-sm sm:text-base shadow-md flex-shrink-0",children:o.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("h4",{className:"text-base sm:text-lg font-bold text-slate-800",children:"Booking Details"}),o.jsx("p",{className:"text-[10px] sm:text-xs text-slate-600 hidden sm:block",children:"Fill in the information below to book your session"})]})]})}),o.jsxs("div",{className:"p-4 sm:p-6 space-y-4 sm:space-y-6 flex-1",children:[o.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[o.jsxs("div",{className:"flex items-center justify-between gap-2",children:[o.jsxs("label",{className:"text-sm font-bold text-slate-700 flex items-center gap-1.5 sm:gap-2",children:[o.jsx("span",{className:"inline-flex h-5 w-5 sm:h-6 sm:w-6 items-center justify-center rounded-md bg-sky-100 text-sky-700 text-[10px] sm:text-xs font-bold flex-shrink-0",children:"1"}),o.jsx("span",{className:"text-xs sm:text-sm",children:"Subject Selection"})]}),o.jsx("button",{type:"button",className:"px-2 sm:px-3 py-1 rounded-lg border border-sky-300 bg-sky-50 text-sky-700 hover:bg-sky-100 hover:border-sky-400 text-[10px] sm:text-xs font-medium transition-all flex-shrink-0",onClick:()=>{var xe;(((xe=I==null?void 0:I.profile)==null?void 0:xe.subjects)||[]).length>0&&(a(I.profile.subjects[0]),s(I.profile.subjects[0]))},children:"View"})]}),o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute left-3 sm:left-4 top-1/2 -translate-y-1/2 pointer-events-none",children:o.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),o.jsxs("select",{className:`w-full border-2 ${U.subject?"border-red-400 bg-red-50":"border-slate-300 bg-white hover:border-sky-400"} pl-10 sm:pl-12 pr-3 sm:pr-4 py-2.5 sm:py-3 rounded-lg sm:rounded-xl focus:ring-4 focus:ring-sky-200 focus:border-sky-500 transition-all text-sm sm:text-base font-medium text-slate-700`,value:B.subject,onChange:xe=>{const Ke=xe.target.value;O(Ge=>({...Ge,subject:Ke})),J(Ge=>{const rt={...Ge};return delete rt.subject,rt})},children:[o.jsx("option",{value:"",children:"Select a subject"}),(((ue=I==null?void 0:I.profile)==null?void 0:ue.subjects)||[]).map((xe,Ke)=>o.jsx("option",{value:xe,children:xe},Ke))]})]}),U.subject&&o.jsxs("div",{className:"p-3 bg-red-50 border-l-4 border-red-500 rounded-lg flex items-start gap-2",children:[o.jsx("svg",{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),o.jsx("p",{className:"text-sm text-red-700 font-medium",children:U.subject})]})]}),o.jsx("div",{className:"border-t border-slate-200"}),o.jsxs("div",{className:"space-y-3 sm:space-y-4",children:[o.jsxs("label",{className:"text-sm font-bold text-slate-700 flex items-center gap-1.5 sm:gap-2",children:[o.jsx("span",{className:"inline-flex h-5 w-5 sm:h-6 sm:w-6 items-center justify-center rounded-md bg-indigo-100 text-indigo-700 text-[10px] sm:text-xs font-bold flex-shrink-0",children:"2"}),o.jsx("span",{className:"text-xs sm:text-sm",children:"Schedule & Duration"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 sm:gap-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"block text-sm font-semibold text-slate-700 flex items-center gap-2",children:[o.jsx("svg",{className:"w-4 h-4 text-sky-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),"Date"]}),o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute left-3 sm:left-4 top-1/2 -translate-y-1/2 pointer-events-none",children:o.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),o.jsx("input",{type:"date",className:`w-full border-2 ${U.date?"border-red-400 bg-red-50":"border-slate-300 bg-white hover:border-sky-400"} pl-10 sm:pl-12 pr-3 sm:pr-4 py-2.5 sm:py-3.5 rounded-lg sm:rounded-xl focus:ring-4 focus:ring-sky-200 focus:border-sky-500 transition-all text-sm sm:text-base font-medium text-slate-700`,value:B.date,onChange:xe=>{const Ke=xe.target.value;O(Ge=>({...Ge,date:Ke})),J(Ge=>{const rt={...Ge};return delete rt.date,delete rt.time,rt})},min:new Date().toISOString().split("T")[0]})]}),U.date&&o.jsxs("div",{className:"p-2.5 bg-red-50 border-l-4 border-red-500 rounded-lg flex items-start gap-2",children:[o.jsx("svg",{className:"w-4 h-4 text-red-600 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),o.jsx("p",{className:"text-xs text-red-700 font-medium",children:U.date})]}),B.date&&!mt.length&&!U.date&&o.jsxs("div",{className:"text-xs text-amber-700 bg-amber-50 border border-amber-200 px-3 py-2 rounded-lg flex items-center gap-2",children:[o.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),"No available times on this date"]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"block text-sm font-semibold text-slate-700 flex items-center gap-2",children:[o.jsx("svg",{className:"w-4 h-4 text-indigo-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Time",mt.length>0&&o.jsxs("span",{className:"text-xs font-normal text-slate-500 bg-slate-100 px-2 py-0.5 rounded-full",children:[mt.length," slots"]}),ee&&o.jsxs("span",{className:"text-xs font-normal text-slate-400 ml-2 flex items-center gap-1",children:[o.jsxs("svg",{className:"animate-spin h-3 w-3",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Checking..."]})]}),B.date&&(I==null?void 0:I.availability)&&(()=>{const Ke=new Date(B.date).toLocaleDateString("en-US",{weekday:"long"}),Ge=I.availability.filter(rt=>rt.day_of_week.toLowerCase()===Ke.toLowerCase());if(Ge.length>0){if(B.time){const rt=(()=>{const[Ye,yt]=B.time.split(":").map(Number);return Ye*60+yt})(),ct=Ge.find(Ye=>{const yt=Number(Ye.start_time.split(":")[0])*60+Number(Ye.start_time.split(":")[1]),dt=Number(Ye.end_time.split(":")[0])*60+Number(Ye.end_time.split(":")[1]);return rt>=yt&&rt<dt});if(ct)return o.jsxs("div",{className:"text-xs text-slate-600 mb-1",children:[o.jsx("span",{className:"font-semibold",children:"Available:"})," ",ct.start_time," - ",ct.end_time]})}return Ge.map((rt,ct)=>o.jsxs("div",{className:"text-xs text-slate-600 mb-1",children:[o.jsx("span",{className:"font-semibold",children:"Available:"})," ",rt.start_time," - ",rt.end_time]},ct))}return null})(),o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute left-3 sm:left-4 top-1/2 -translate-y-1/2 pointer-events-none",children:o.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),o.jsxs("select",{className:`w-full border-2 ${U.time?"border-red-400 bg-red-50":"border-slate-300 bg-white hover:border-indigo-400"} ${B.date?"":"bg-slate-100 cursor-not-allowed opacity-60"} pl-10 sm:pl-12 pr-3 sm:pr-4 py-2.5 sm:py-3.5 rounded-lg sm:rounded-xl focus:ring-4 focus:ring-indigo-200 focus:border-indigo-500 transition-all text-sm sm:text-base font-medium text-slate-700`,value:B.time,onChange:xe=>{const Ke=xe.target.value;O(Ge=>({...Ge,time:Ke})),J(Ge=>{const rt={...Ge};return delete rt.time,rt})},disabled:!B.date,children:[o.jsx("option",{value:"",children:"Select time"}),mt.map(xe=>o.jsx("option",{value:xe,children:xe},xe))]})]}),U.time&&o.jsxs("p",{className:"text-sm text-red-600 flex items-center gap-1.5",children:[o.jsx("svg",{className:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),U.time]}),!B.date&&o.jsx("p",{className:"text-xs text-slate-500",children:"Please select a date first"}),B.date&&(!B.duration||B.duration===0)&&mt.length>0&&o.jsxs("p",{className:"text-xs text-amber-600 bg-amber-50 px-3 py-2 rounded-lg flex items-center gap-2",children:[o.jsx("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),"Select a duration to filter available times for your session length"]}),B.date&&B.duration>0&&mt.length===0&&!ee&&o.jsxs("p",{className:"text-xs text-red-600 bg-red-50 px-3 py-2 rounded-lg flex items-center gap-2",children:[o.jsx("svg",{className:"w-3.5 h-3.5",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})}),"No available time slots for this duration on the selected date (may be fully booked)"]}),B.date&&mt.length===0&&!ee&&(!B.duration||B.duration===0)&&o.jsx("p",{className:"text-xs text-slate-500",children:"No available time slots for this date"})]}),o.jsxs("div",{className:"space-y-2 md:col-span-2",children:[o.jsxs("label",{className:"block text-sm font-semibold text-slate-700 flex items-center gap-2",children:[o.jsx("svg",{className:"w-4 h-4 text-sky-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Duration",!B.date&&o.jsx("span",{className:"text-xs font-normal text-slate-400",children:"(Select date first)"})]}),o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute left-3 sm:left-4 top-1/2 -translate-y-1/2 pointer-events-none",children:o.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-slate-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),o.jsxs("select",{className:`w-full border-2 ${U.duration?"border-red-400 bg-red-50":"border-slate-300 bg-white hover:border-sky-400"} ${!B.date||Oe.length===0?"bg-slate-100 cursor-not-allowed opacity-60":""} pl-10 sm:pl-12 pr-3 sm:pr-4 py-2.5 sm:py-3.5 rounded-lg sm:rounded-xl focus:ring-4 focus:ring-sky-200 focus:border-sky-500 transition-all text-sm sm:text-base font-medium text-slate-700`,value:B.duration,onChange:xe=>{const Ke=parseFloat(xe.target.value)||0;isNaN(Ke)||O(Ge=>({...Ge,duration:Ke,time:""})),J(Ge=>{const rt={...Ge};return delete rt.duration,rt})},disabled:!B.date||Oe.length===0,children:[o.jsx("option",{value:0,children:B.date?Oe.length===0?"No available durations":"Select duration":"Select date first"}),Oe.map(xe=>o.jsx("option",{value:xe,children:xe%1===0?`${xe}hr${xe!==1?"s":""}`:`${xe}hr`},xe))]})]}),U.duration&&o.jsxs("div",{className:"p-2.5 bg-red-50 border-l-4 border-red-500 rounded-lg flex items-start gap-2",children:[o.jsx("svg",{className:"w-4 h-4 text-red-600 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),o.jsx("p",{className:"text-xs text-red-700 font-medium",children:U.duration})]}),ut>0&&o.jsx("div",{className:"text-xs text-slate-600 bg-gradient-to-r from-sky-50 to-indigo-50 border border-sky-200 px-4 py-3 rounded-lg",children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx("svg",{className:"w-4 h-4 text-sky-600 flex-shrink-0 mt-0.5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),o.jsxs("span",{className:"font-medium",children:["Maximum available: ",Math.floor(ut/60),"h ",ut%60,"m"]})]})})]})]})]}),o.jsx("div",{className:"border-t border-slate-200"}),o.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[o.jsxs("label",{className:"text-sm font-bold text-slate-700 flex items-center gap-1.5 sm:gap-2",children:[o.jsx("span",{className:"inline-flex h-5 w-5 sm:h-6 sm:w-6 items-center justify-center rounded-md bg-sky-100 text-sky-700 text-[10px] sm:text-xs font-bold flex-shrink-0",children:"3"}),o.jsx("span",{className:"text-xs sm:text-sm",children:"Notes & Requests"})]}),o.jsx("textarea",{className:"w-full border-2 border-slate-300 bg-white hover:border-sky-400 px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg sm:rounded-xl focus:ring-4 focus:ring-sky-200 focus:border-sky-500 transition-all resize-none min-h-[100px] sm:min-h-[120px] text-sm sm:text-base font-medium text-slate-700 placeholder:text-slate-400",placeholder:"Share learning goals or special instructions for the tutor...",value:B.student_notes,onChange:xe=>{const Ke=xe.target.value;O(Ge=>({...Ge,student_notes:Ke})),J(Ge=>{const rt={...Ge};return delete rt.student_notes,rt})}}),U.student_notes&&o.jsxs("div",{className:"p-3 bg-red-50 border-l-4 border-red-500 rounded-lg flex items-start gap-2",children:[o.jsx("svg",{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),o.jsx("p",{className:"text-sm text-red-700 font-medium",children:U.student_notes})]})]})]})]})}),o.jsxs("aside",{className:"w-full order-1 lg:order-2 lg:sticky lg:top-6 bg-white border border-slate-200/80 sm:border-2 sm:border-slate-200/60 rounded-xl sm:rounded-2xl p-4 sm:p-5 lg:p-6 space-y-4 sm:space-y-5 shadow-lg sm:shadow-xl flex flex-col",children:[o.jsxs("div",{className:"relative overflow-hidden rounded-xl bg-gradient-to-br from-sky-50 via-indigo-50 to-sky-50 p-4 border border-sky-200/50",children:[o.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-sky-200/20 rounded-full -mr-16 -mt-16"}),o.jsxs("div",{className:"relative flex items-center gap-4",children:[o.jsxs("div",{className:"relative flex-shrink-0",children:[o.jsx("img",{src:Zt(((He=I==null?void 0:I.user)==null?void 0:He.profile_image_url)||""),onError:xe=>{var Ke;xe.target.src=`https://ui-avatars.com/api/?name=${encodeURIComponent(((Ke=I==null?void 0:I.user)==null?void 0:Ke.name)||"Tutor")}`},alt:(ot=I==null?void 0:I.user)==null?void 0:ot.name,className:"h-16 w-16 rounded-full object-cover border-4 border-white shadow-lg ring-2 ring-sky-200"}),Ce[(st=I==null?void 0:I.user)==null?void 0:st.user_id]&&o.jsx("div",{className:"absolute -bottom-1 -right-1 h-5 w-5 bg-green-500 rounded-full border-2 border-white shadow-md"})]}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-xs font-semibold text-slate-500 uppercase tracking-wide mb-1",children:"Tutoring with"}),o.jsx("p",{className:"text-lg font-bold text-slate-900 truncate",children:(_t=I==null?void 0:I.user)==null?void 0:_t.name}),o.jsx("p",{className:"text-xs text-slate-600 truncate",children:(Qt=I==null?void 0:I.user)==null?void 0:Qt.university_name})]})]})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs("h5",{className:"text-sm font-bold text-slate-800 uppercase tracking-wide flex items-center gap-2",children:[o.jsx("div",{className:"h-1 w-8 bg-gradient-to-r from-sky-500 to-indigo-500 rounded-full"}),"Booking Summary"]}),[{label:"Subject",value:B.subject||"Select subject",icon:""},{label:"Date",value:B.date?new Date(B.date).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"}):"Select date",icon:""},{label:"Time",value:B.time||"Select time",icon:""},{label:"Duration",value:B.duration?`${B.duration}${B.duration%1===0?"hr"+(B.duration!==1?"s":""):"hr"}`:"Select duration",icon:""}].map(xe=>o.jsxs("div",{className:"flex items-center justify-between rounded-xl bg-gradient-to-r from-slate-50 to-sky-50/30 px-4 py-3 border border-slate-200/60 hover:border-sky-300 transition-colors",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("span",{className:"text-lg",children:xe.icon}),o.jsx("span",{className:"text-sm font-semibold text-slate-600",children:xe.label})]}),o.jsx("span",{className:"font-bold text-slate-900 text-right truncate max-w-[55%]",children:xe.value})]},xe.label)),B.student_notes&&o.jsxs("div",{className:"rounded-xl bg-gradient-to-br from-indigo-50/50 to-sky-50/50 px-4 py-4 border border-indigo-200/60",children:[o.jsxs("div",{className:"text-xs font-semibold text-slate-600 mb-2 flex items-center gap-2",children:[o.jsx("span",{children:""}),"Notes"]}),o.jsx("div",{className:"text-base font-bold text-slate-900 break-words whitespace-pre-wrap leading-relaxed max-h-48 overflow-y-auto",children:B.student_notes})]}),((ds=I==null?void 0:I.profile)==null?void 0:ds.session_rate_per_hour)&&B.duration>0&&(()=>{const xe=Number(I.profile.session_rate_per_hour)*B.duration,Ke=`${B.duration}${B.duration%1===0?"hr"+(B.duration!==1?"s":""):"hr"}`;return o.jsxs("div",{className:"relative overflow-hidden rounded-xl bg-gradient-to-r from-emerald-500 to-teal-500 p-4 border-2 border-emerald-400 shadow-lg",children:[o.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/10 to-transparent"}),o.jsxs("div",{className:"relative flex items-center justify-between",children:[o.jsx("span",{className:"text-white font-bold text-sm",children:"Estimated Cost"}),o.jsxs("span",{className:"font-black text-white text-xl",children:["",xe.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),o.jsxs("div",{className:"relative mt-1 text-xs text-white/90",children:["",Number(I.profile.session_rate_per_hour).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}),"/hr  ",Ke]})]})})()]})]})]})})]})]})})})}),Ze&&o.jsx(On,{isOpen:!0,onClose:()=>bt(!1),title:"Confirm Booking",footer:o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:Xa,disabled:z,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 shadow-md",children:z?"Booking...":"Confirm"}),o.jsx("button",{onClick:()=>bt(!1),className:"px-4 py-2 border rounded-md hover:bg-gray-100 ml-2",children:"Back"})]}),children:o.jsx("div",{className:"space-y-4",children:o.jsxs("div",{className:"rounded-lg overflow-hidden shadow-sm",children:[o.jsxs("div",{className:"bg-gradient-to-r from-sky-600 to-indigo-600 p-4 text-white flex items-center gap-4",children:[o.jsx("div",{className:"h-14 w-14 rounded-full overflow-hidden flex-shrink-0",children:o.jsx("img",{src:Zt(((Nr=I==null?void 0:I.user)==null?void 0:Nr.profile_image_url)||""),alt:(Xt=I==null?void 0:I.user)==null?void 0:Xt.name,className:"w-full h-full object-cover",onError:xe=>{var Ke;xe.target.src=`https://ui-avatars.com/api/?name=${encodeURIComponent(((Ke=I==null?void 0:I.user)==null?void 0:Ke.name)||"Tutor")}`}})}),o.jsxs("div",{children:[o.jsx("div",{className:"font-semibold text-lg",children:(Vn=I==null?void 0:I.user)==null?void 0:Vn.name}),o.jsx("div",{className:"text-sm opacity-90",children:((ki=I==null?void 0:I.user)==null?void 0:ki.university_name)||""})]}),o.jsx("div",{className:"ml-auto text-sm inline-flex items-center bg-white/20 px-2 py-1 rounded text-white",children:Ks!==null?`${Ks.toFixed(1)} `:""})]}),o.jsx("div",{className:"p-4 bg-white",children:o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[o.jsxs("div",{className:"text-sm",children:[o.jsx("div",{className:"font-medium",children:"Subject"}),o.jsx("div",{className:"text-slate-700",children:B.subject||""})]}),o.jsxs("div",{className:"text-sm",children:[o.jsx("div",{className:"font-medium",children:"When"}),o.jsxs("div",{className:"text-slate-700",children:[B.date?new Date(B.date).toLocaleDateString():"","  ",B.time||""]})]}),o.jsxs("div",{className:"text-sm",children:[o.jsx("div",{className:"font-medium",children:"Duration"}),o.jsx("div",{className:"text-slate-700",children:B.duration?`${B.duration}${B.duration%1===0?"hr"+(B.duration!==1?"s":""):"hr"}`:""})]}),o.jsxs("div",{className:"text-sm",children:[o.jsx("div",{className:"font-medium",children:"Notes"}),o.jsx("div",{className:"text-slate-700",children:B.student_notes||"No notes"})]})]})})]})})}),tt&&o.jsx(On,{isOpen:!0,onClose:()=>St(!1),title:"Cancel Booking",footer:o.jsxs(o.Fragment,{children:[o.jsx("button",{onClick:()=>{W(!1),St(!1),O({subject:"",date:"",time:"",duration:1,student_notes:""})},className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",children:"Yes, Cancel"}),o.jsx("button",{onClick:()=>St(!1),className:"px-4 py-2 border rounded-md hover:bg-gray-100",children:"No, Keep Editing"})]}),children:o.jsx("p",{className:"text-slate-700",children:"Are you sure you want to cancel this booking? Any information you've entered will be lost."})}),je&&o.jsx(On,{isOpen:!0,onClose:()=>ie(!1),title:"Booking Error",footer:o.jsx("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md",onClick:()=>ie(!1),children:"Got it"}),children:o.jsx("div",{className:"py-2 text-slate-700",children:Re})}),o.jsx(Kc,{position:"top-center","aria-label":"Notification center"})]})]})},yKe=()=>{const[t,e]=j.useState([]),[n,s]=j.useState([]),[r,a]=j.useState([]),[i,l]=j.useState(!0),[c,u]=j.useState(null),[h,f]=j.useState({}),[p,x]=j.useState(!1),[y,v]=j.useState([]),[b,N]=j.useState({}),[S,k]=j.useState(!1),[T,E]=j.useState(!1),[D,A]=j.useState(null),[I,P]=j.useState(void 0),{user:$}=rr();j.useEffect(()=>{(async()=>{await X(!0),k(!0)})();const O=setInterval(()=>{p||X(!1)},5e3);return()=>clearInterval(O)},[p]),j.useEffect(()=>{(async()=>{var O;try{const U=await we.get("/users/admins-with-qr");v(((O=U.data)==null?void 0:O.data)||[])}catch{}})()},[]);const R=async()=>{try{const U=((await we.get("/payments")).data||[]).filter(J=>{var oe,Se;if(!($!=null&&$.user_id))return!1;const se=J.student_id,ae=$.student_id,fe=se&&ae&&se===ae||((Se=(oe=J.student)==null?void 0:oe.user)==null?void 0:Se.user_id)===$.user_id||se&&!ae&&se===$.id,ye=(J.status||"").toLowerCase();return fe&&(ye==="confirmed"||ye==="disputed"||ye==="refunded")});U.sort((J,se)=>new Date(se.created_at).getTime()-new Date(J.created_at).getTime()),a(U)}catch(B){console.error("Failed to fetch payment history:",B)}};j.useEffect(()=>{$!=null&&$.user_id&&R()},[$==null?void 0:$.user_id]);const F=B=>{var J;const O=(B.status||"").toLowerCase();if(O==="payment_pending")return"payment_pending";if(O==="admin_payment_pending")return"";if((J=B.payment)!=null&&J.status)return B.payment.status;const U={awaiting_payment:"pending",payment_rejected:"rejected",payment_approved:"confirmed",pending:"pending"};return O==="rejected"&&!B.payment?"":U[O]||O},W=B=>{const U=(F(B)||"").toLowerCase();return U==="payment_rejected"||U==="rejected"},q=B=>{const U=(F(B)||"").toLowerCase();return U==="awaiting_payment"||U==="pending"||U==="payment_rejected"||U==="rejected"};j.useEffect(()=>{const B={};t.forEach(O=>{const U=Y(O),J=b[O.id],se=W(O);U>0&&!J&&!se&&(B[O.id]=U.toFixed(2))}),Object.keys(B).length>0&&N(O=>({...O,...B}))},[t]);const X=async(B=!1)=>{var O,U;try{B&&l(!0);const se=(await we.get("/users/me/bookings")).data||[],ye=((await we.get("/payments").catch(()=>({data:[]}))).data||[]).filter(oe=>{var je,ie;if(!($!=null&&$.user_id))return!1;const Se=oe.student_id,ke=$.student_id,me=Se&&ke&&Se===ke||((ie=(je=oe.student)==null?void 0:je.user)==null?void 0:ie.user_id)===$.user_id||Se&&!ke&&Se===$.id,re=oe.sender==="tutee";return me&&re});s(ye);const Te=se.map(oe=>{const Se=(oe.payments||[]).filter(je=>{var bt,tt;if(!($!=null&&$.user_id)||je.sender!=="tutee")return!1;const Re=je.student_id,Ve=$.student_id;return Re&&Ve&&Re===Ve||((tt=(bt=je.student)==null?void 0:bt.user)==null?void 0:tt.user_id)===$.user_id||Re&&!Ve&&Re===$.id}),ke=Se.length>0?Se.sort((je,ie)=>new Date(ie.created_at).getTime()-new Date(je.created_at).getTime())[0]:null,me=oe.payment,re=me&&me.sender==="tutee";return{...oe,payment:ke||(re?me:null)}}).filter(oe=>{const Se=(oe.status||"").toLowerCase();if(oe.payment&&oe.payment.sender!=="tutee")return!1;const ke=oe.payment&&["pending","paid","admin_confirmed","confirmed","rejected","refunded"].includes((oe.payment.status||"").toLowerCase());return Se==="admin_payment_pending"?!1:Se==="awaiting_payment"||Se==="payment_pending"||Se==="payment_rejected"||Se==="pending"||Se==="paid"||Se==="admin_confirmed"||Se==="confirmed"||Se==="refunded"||Se==="payment_approved"||ke});Te.length>0&&console.log("Payment bookings with statuses:",Te.map(oe=>{var Se,ke,me;return{id:oe.id,bookingStatus:oe.status,paymentStatus:(Se=oe.payment)==null?void 0:Se.status,paymentId:(ke=oe.payment)==null?void 0:ke.payment_id,bookingRequestId:(me=oe.payment)==null?void 0:me.booking_request_id}})),e(Te),u(null)}catch(J){console.error("Failed to fetch bookings:",J),u(((U=(O=J.response)==null?void 0:O.data)==null?void 0:U.message)||"Failed to load bookings"),gt.error("Failed to load bookings. Please try again.")}finally{B&&l(!1)}},z=(B,O)=>{var J;const U=(J=B.target.files)==null?void 0:J[0];if(U){if(!U.type.startsWith("image/")){gt.error("Please upload an image file");return}if(U.size>5*1024*1024){gt.error("File size should be less than 5MB");return}f(se=>({...se,[O]:U}))}},K=async B=>{var ye,Te;const O=h[B],U=y.length>0?y[0].user_id:null,J=b[B]||"",se=t.find(oe=>oe.id===B),ae=se?Y(se):0,fe=Number(J);if(!O){gt.error("Please select a payment proof image first");return}if(!U){gt.error("Admin QR code not available. Please try again later.");return}if(!J||isNaN(fe)||fe<=0){gt.error("Please enter a valid amount");return}if(ae>0&&fe<ae){gt.error(`Amount paid (${fe.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}) must be at least ${ae.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})} (amount to pay). You can pay more if needed.`);return}try{x(!0);const oe=new FormData;oe.append("file",O),oe.append("bookingId",String(B)),oe.append("adminId",String(U)),oe.append("amount",J),await we.post("/payments/submit-proof",oe,{headers:{"Content-Type":"multipart/form-data"}}),gt.success("Payment submitted for verification"),f(Se=>{const ke={...Se};return delete ke[B],ke}),N(Se=>{const ke={...Se};return delete ke[B],ke}),await X(!1),await R()}catch(oe){console.error("Failed to upload payment:",oe),gt.error(((Te=(ye=oe.response)==null?void 0:ye.data)==null?void 0:Te.message)||"Failed to submit payment")}finally{x(!1)}},H=B=>{switch((B||"").toLowerCase()){case"pending":return{icon:o.jsx(vc,{className:"h-5 w-5 text-yellow-500"}),text:"Pending Payment",color:"text-yellow-700 bg-yellow-50 border-yellow-200",dotColor:"bg-yellow-500"};case"paid":return{icon:o.jsx(jr,{className:"h-5 w-5 text-blue-500"}),text:"Paid",color:"text-blue-700 bg-blue-50 border-blue-200",dotColor:"bg-blue-500"};case"admin_confirmed":return{icon:o.jsx(jr,{className:"h-5 w-5 text-indigo-500"}),text:"Admin Confirmed",color:"text-indigo-700 bg-indigo-50 border-indigo-200",dotColor:"bg-indigo-500"};case"confirmed":return{icon:o.jsx(jr,{className:"h-5 w-5 text-green-500"}),text:"Paid",color:"text-green-700 bg-green-50 border-green-200",dotColor:"bg-green-500"};case"disputed":return{icon:o.jsx(vc,{className:"h-5 w-5 text-purple-500"}),text:"Disputed",color:"text-purple-700 bg-purple-50 border-purple-200",dotColor:"bg-purple-500"};case"rejected":return{icon:o.jsx(Au,{className:"h-5 w-5 text-red-500"}),text:"Payment Rejected",color:"text-red-700 bg-red-50 border-red-200",dotColor:"bg-red-500"};case"refunded":return{icon:o.jsx(Au,{className:"h-5 w-5 text-orange-500"}),text:"Refunded",color:"text-orange-700 bg-orange-50 border-orange-200",dotColor:"bg-orange-500"};case"awaiting_payment":return{icon:o.jsx(vc,{className:"h-5 w-5 text-yellow-500"}),text:"Awaiting Payment",color:"text-yellow-700 bg-yellow-50 border-yellow-200",dotColor:"bg-yellow-500"};case"payment_pending":return{icon:o.jsx(jr,{className:"h-5 w-5 text-blue-500"}),text:"Awaiting Payment Confirmation",color:"text-blue-700 bg-blue-50 border-blue-200",dotColor:"bg-blue-500"};case"admin_payment_pending":return{icon:o.jsx(jr,{className:"h-5 w-5 text-indigo-500"}),text:"Admin Payment Pending",color:"text-indigo-700 bg-indigo-50 border-indigo-200",dotColor:"bg-indigo-500"};case"payment_rejected":return{icon:o.jsx(Au,{className:"h-5 w-5 text-red-500"}),text:"Payment Rejected",color:"text-red-700 bg-red-50 border-red-200",dotColor:"bg-red-500"};case"payment_approved":return{icon:o.jsx(jr,{className:"h-5 w-5 text-green-500"}),text:"Payment Approved",color:"text-green-700 bg-green-50 border-green-200",dotColor:"bg-green-500"};default:return console.warn("Unknown payment status:",B),{icon:o.jsx(vc,{className:"h-5 w-5 text-slate-500"}),text:B||"Unknown",color:"text-slate-700 bg-slate-50 border-slate-200",dotColor:"bg-slate-500"}}},Y=B=>{var J;const O=((J=B.tutor)==null?void 0:J.session_rate_per_hour)||0,U=B.duration||0;return O*U};return i?o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx(_l,{className:"h-8 w-8 text-blue-600"}),o.jsx("h1",{className:"text-3xl font-bold text-slate-800",children:"Payment"})]}),o.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-6",children:o.jsx("div",{className:"animate-pulse space-y-4",children:[1,2].map(B=>o.jsx("div",{className:"h-32 bg-slate-100 rounded-lg"},B))})})]}):o.jsxs("div",{className:"space-y-3 sm:space-y-4 md:space-y-6 pb-6 sm:pb-8 md:pb-10",children:[o.jsx(Kc,{"aria-label":"Notifications"}),o.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl sm:rounded-2xl p-3 sm:p-4 md:p-6 text-white shadow-lg -mx-2 sm:-mx-3 md:mx-0",children:o.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2.5 sm:gap-3 md:gap-0",children:[o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[o.jsx(_l,{className:"h-5 w-5 sm:h-6 sm:w-6 md:h-8 md:w-8 flex-shrink-0"}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl font-bold text-white",children:"Payment Management"}),o.jsx("p",{className:"text-xs sm:text-sm md:text-base text-blue-100/90 mt-0.5 sm:mt-1",children:"Manage your session payments and track payment history"})]})]}),o.jsxs("button",{onClick:async()=>{await X(!0),await R()},className:"mt-2 sm:mt-0 px-3 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm font-medium text-blue-600 hover:text-blue-700 active:text-blue-800 bg-white hover:bg-blue-50 active:bg-blue-100 rounded-lg sm:rounded-xl transition-all shadow-md hover:shadow-lg w-full sm:w-auto touch-manipulation flex items-center justify-center gap-2",style:{WebkitTapHighlightColor:"transparent"},children:[o.jsx("svg",{className:"w-3.5 h-3.5 sm:w-4 sm:w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),o.jsx("span",{children:"Refresh"})]})]})}),c?o.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 sm:p-4 text-red-700 -mx-2 sm:-mx-3 md:mx-0",children:o.jsx("p",{className:"text-xs sm:text-sm",children:c})}):t.length===0?o.jsxs("div",{className:"bg-white rounded-lg sm:rounded-xl shadow-sm border border-slate-200 p-6 sm:p-8 text-center -mx-2 sm:-mx-3 md:mx-0",children:[o.jsx(_l,{className:"h-10 w-10 sm:h-12 sm:w-12 text-slate-400 mx-auto mb-3 sm:mb-4"}),o.jsx("h3",{className:"text-base sm:text-lg font-medium text-slate-900 mb-1",children:"No Pending Payments"}),o.jsx("p",{className:"text-xs sm:text-sm md:text-base text-slate-600",children:"When you have bookings that require payment, they will appear here."})]}):o.jsx("div",{className:"space-y-4 sm:space-y-5 md:space-y-6 lg:space-y-8",children:t.map(B=>{var ae,fe,ye;const O=F(B),U=H(O),J=Y(B),se=((ae=B.tutor)==null?void 0:ae.session_rate_per_hour)||0;return o.jsxs("div",{className:"group relative bg-gradient-to-br from-white via-primary-50/20 to-primary-100/10 rounded-xl sm:rounded-2xl md:rounded-3xl shadow-lg md:shadow-xl border-2 border-slate-200/80 hover:border-primary-400 hover:shadow-2xl p-4 sm:p-5 md:p-7 lg:p-8 -mx-2 sm:-mx-3 md:mx-0 transition-all duration-300 overflow-hidden",children:[o.jsx("div",{className:`absolute top-0 left-0 right-0 h-1 md:h-1.5 ${O.toLowerCase()==="confirmed"||O.toLowerCase()==="admin_confirmed"?"bg-gradient-to-r from-green-500 via-emerald-500 to-green-600":W(B)?"bg-gradient-to-r from-red-500 via-rose-500 to-red-600":O.toLowerCase()==="pending"?"bg-gradient-to-r from-yellow-500 via-amber-500 to-yellow-600":"bg-gradient-to-r from-primary-500 via-primary-600 to-primary-700"}`}),o.jsxs("div",{className:"flex flex-col gap-4 sm:gap-5 md:gap-6 mb-4 sm:mb-5 md:mb-6",children:[o.jsxs("div",{className:"flex flex-col md:flex-row md:items-start md:justify-between gap-3 sm:gap-4 md:gap-5",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h3",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl font-extrabold text-slate-900 mb-2 sm:mb-3 md:mb-4 break-words leading-tight",children:B.subject}),o.jsxs("p",{className:"text-sm sm:text-base md:text-lg text-slate-700 mb-3 md:mb-4 font-semibold",children:["with ",o.jsx("span",{className:"text-primary-700",children:B.tutor.user.name})]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3 md:gap-4",children:[o.jsxs("span",{className:"flex items-center gap-1.5 sm:gap-2 px-2.5 sm:px-3 md:px-4 py-1.5 sm:py-2 bg-white rounded-lg md:rounded-xl border border-slate-200 md:border-2 shadow-sm md:shadow-md hover:shadow-lg transition-shadow",children:[o.jsx("svg",{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 md:h-5 md:w-5 text-primary-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),o.jsx("span",{className:"text-xs sm:text-sm md:text-base font-semibold text-slate-800",children:new Date(B.date).toLocaleDateString()})]}),o.jsxs("span",{className:"flex items-center gap-1.5 sm:gap-2 px-2.5 sm:px-3 md:px-4 py-1.5 sm:py-2 bg-white rounded-lg md:rounded-xl border border-slate-200 md:border-2 shadow-sm md:shadow-md hover:shadow-lg transition-shadow",children:[o.jsx("svg",{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 md:h-5 md:w-5 text-primary-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),o.jsx("span",{className:"text-xs sm:text-sm md:text-base font-semibold text-slate-800",children:B.time})]}),o.jsxs("span",{className:"flex items-center gap-1.5 sm:gap-2 px-2.5 sm:px-3 md:px-4 py-1.5 sm:py-2 bg-white rounded-lg md:rounded-xl border border-slate-200 md:border-2 shadow-sm md:shadow-md hover:shadow-lg transition-shadow",children:[o.jsx("svg",{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 md:h-5 md:w-5 text-primary-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),o.jsxs("span",{className:"text-xs sm:text-sm md:text-base font-semibold text-slate-800",children:[B.duration," ",B.duration===1?"hour":"hours"]})]})]})]}),o.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3 flex-shrink-0 w-full md:w-auto",children:[o.jsxs("div",{className:`px-3 sm:px-4 md:px-5 py-1.5 sm:py-2 md:py-2.5 rounded-xl md:rounded-2xl text-xs sm:text-sm md:text-base font-bold flex items-center gap-1.5 sm:gap-2 shadow-md md:shadow-lg ${U.color} border-2 ${U.color.includes("yellow")?"border-yellow-400":U.color.includes("red")?"border-red-400":U.color.includes("green")?"border-green-400":U.color.includes("indigo")?"border-indigo-400":"border-primary-400"}`,children:[U.icon,U.dotColor&&o.jsx("span",{className:`h-2.5 w-2.5 md:h-3 md:w-3 rounded-full ${U.dotColor}`}),o.jsx("span",{className:"whitespace-nowrap",children:U.text})]}),B.payment_proof&&!W(B)&&o.jsxs("div",{className:"px-3 sm:px-4 md:px-5 py-1.5 sm:py-2 md:py-2.5 rounded-xl md:rounded-2xl text-[10px] sm:text-xs md:text-sm font-bold bg-green-50 text-green-700 border-2 border-green-400 shadow-sm md:shadow-md flex items-center gap-1.5",children:[o.jsx(jr,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 md:h-5 md:w-5"}),o.jsx("span",{children:"Proof uploaded"})]})]})]}),se>0&&o.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-primary-50 via-primary-100/50 to-primary-50 rounded-xl md:rounded-2xl border-2 border-primary-200/80 shadow-md md:shadow-lg p-4 sm:p-5 md:p-6",children:[o.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-primary-200/20 rounded-full -mr-16 -mt-16 blur-2xl hidden md:block"}),o.jsxs("div",{className:"relative flex flex-col sm:flex-row sm:items-center gap-3 sm:gap-4 md:gap-6",children:[o.jsxs("div",{className:"flex items-center gap-3 md:gap-4",children:[o.jsx("div",{className:"p-2 md:p-3 bg-primary-100 rounded-lg md:rounded-xl shadow-sm",children:o.jsx("svg",{className:"h-5 w-5 md:h-6 md:w-6 text-primary-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),o.jsxs("div",{children:[o.jsx("span",{className:"text-xs sm:text-sm md:text-base font-bold text-slate-600 block mb-0.5 md:mb-1 uppercase tracking-wide",children:"Session Rate"}),o.jsxs("span",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl font-extrabold text-slate-900",children:["",se.toLocaleString(),"/hour"]})]})]}),J>0&&o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"hidden sm:block w-px h-8 md:h-10 bg-primary-300"}),o.jsxs("div",{className:"flex items-center gap-3 md:gap-4",children:[o.jsx("div",{className:"p-2 md:p-3 bg-primary-200 rounded-lg md:rounded-xl shadow-sm",children:o.jsx("svg",{className:"h-5 w-5 md:h-6 md:w-6 text-primary-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),o.jsxs("div",{children:[o.jsx("span",{className:"text-xs sm:text-sm md:text-base font-bold text-slate-600 block mb-0.5 md:mb-1 uppercase tracking-wide",children:"Total Amount"}),o.jsxs("span",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl font-extrabold bg-gradient-to-r from-primary-600 via-primary-700 to-primary-600 bg-clip-text text-transparent",children:["",J.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]})]})]})]})]})]}),q(B)&&o.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-br from-primary-50/80 via-primary-100/60 to-primary-50/80 rounded-xl md:rounded-2xl border-2 border-primary-200/80 p-4 sm:p-5 md:p-7 lg:p-8 mb-4 md:mb-6 shadow-lg md:shadow-xl",children:[o.jsx("div",{className:"absolute top-0 right-0 w-40 h-40 bg-primary-200/20 rounded-full -mr-20 -mt-20 blur-3xl hidden md:block"}),o.jsxs("div",{className:"relative",children:[o.jsxs("h4",{className:"font-extrabold text-base sm:text-lg md:text-2xl lg:text-3xl text-slate-900 mb-4 sm:mb-5 md:mb-6 flex items-center gap-2 md:gap-3",children:[o.jsx("div",{className:"p-2 md:p-3 bg-primary-100 rounded-xl md:rounded-2xl shadow-md border-2 border-primary-200",children:o.jsx(_l,{className:"h-5 w-5 sm:h-6 sm:w-6 md:h-7 md:w-7 text-primary-700"})}),"Payment Instructions"]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-5 md:gap-6 lg:gap-8",children:[o.jsx("div",{className:"flex flex-col items-center justify-center p-4 sm:p-5 md:p-6 lg:p-8 bg-white rounded-xl md:rounded-2xl border-2 border-primary-200 shadow-md md:shadow-lg",children:y.length>0?o.jsxs(o.Fragment,{children:[o.jsx("p",{className:"text-sm sm:text-base md:text-lg text-slate-700 font-bold mb-3 sm:mb-4 md:mb-5 text-center",children:"Scan this QR code to pay:"}),o.jsxs("div",{className:"relative",children:[o.jsx("img",{src:Zt(y[0].qr_code_url),alt:`${y[0].name} QR`,className:"h-48 w-48 sm:h-56 sm:w-56 md:h-64 md:w-64 lg:h-72 lg:w-72 object-contain bg-white rounded-xl md:rounded-2xl shadow-lg border-2 border-primary-100 p-2"}),o.jsx("button",{onClick:()=>{A(Zt(y[0].qr_code_url)),P(y[0].name),E(!0)},className:"absolute top-2 right-2 p-2 bg-primary-600 hover:bg-primary-700 text-white rounded-lg shadow-md hover:shadow-lg transition-all",title:"View larger",style:{WebkitTapHighlightColor:"transparent"},children:o.jsx("svg",{className:"h-4 w-4 sm:h-5 sm:w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"})})})]}),o.jsx("p",{className:"mt-4 sm:mt-5 md:mt-6 text-base sm:text-lg md:text-xl font-bold text-slate-900",children:y[0].name}),o.jsx("p",{className:"mt-2 text-xs sm:text-sm text-slate-600 text-center",children:"Click the icon on the QR code to view larger"})]}):o.jsxs("div",{className:"text-center py-8",children:[o.jsx(_l,{className:"h-12 w-12 sm:h-16 sm:w-16 text-slate-400 mx-auto mb-3"}),o.jsx("p",{className:"text-sm sm:text-base text-slate-500",children:"Admin QR code not available"})]})}),o.jsxs("div",{className:"bg-white rounded-xl md:rounded-2xl p-4 sm:p-5 md:p-6 border-2 border-slate-200/80 shadow-md md:shadow-lg space-y-4 sm:space-y-5 md:space-y-6",children:[o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm sm:text-base md:text-lg font-extrabold text-slate-900 mb-2 sm:mb-3 flex items-center gap-2",children:[o.jsx("svg",{className:"h-4 w-4 md:h-5 md:w-5 text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Amount to Pay"]}),J>0?o.jsxs("div",{className:"text-2xl sm:text-3xl md:text-4xl font-extrabold text-slate-900 bg-gradient-to-br from-primary-50 to-primary-100 rounded-xl md:rounded-2xl px-4 sm:px-5 md:px-6 py-3 sm:py-4 md:py-5 border-2 border-primary-200 shadow-lg",children:["",J.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}):o.jsx("div",{className:"text-sm sm:text-base text-slate-600 bg-slate-50 rounded-xl md:rounded-2xl px-4 sm:px-5 py-3 sm:py-4 border-2 border-slate-200 font-semibold",children:"Session rate not set"})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm sm:text-base md:text-lg font-extrabold text-slate-900 mb-2 sm:mb-3 flex items-center gap-2",children:[o.jsx("svg",{className:"h-4 w-4 md:h-5 md:w-5 text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),"Amount Paid"]}),o.jsx("input",{type:"number",min:"0",step:"0.01",value:b[B.id]||(J>0&&!W(B)?J.toFixed(2):""),onChange:Te=>N(oe=>({...oe,[B.id]:Te.target.value})),className:"w-full border-2 border-slate-300 rounded-xl md:rounded-2xl px-4 sm:px-5 md:px-6 py-3 sm:py-3.5 md:py-4 text-sm sm:text-base md:text-lg font-semibold focus:ring-4 focus:ring-primary-200 focus:border-primary-500 transition-all shadow-sm hover:shadow-md",placeholder:"0.00"}),J>0&&!W(B)&&o.jsx("p",{className:"text-[10px] sm:text-xs text-slate-500 mt-1.5",children:"Amount auto-filled based on session rate. You can enter a higher amount if needed."}),W(B)&&o.jsx("p",{className:"text-[10px] sm:text-xs text-amber-600 mt-1.5 font-medium",children:"Please enter the amount you paid"})]}),o.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[o.jsx("label",{className:"block text-xs sm:text-sm md:text-base font-semibold text-slate-800",children:"Upload Payment Proof"}),o.jsx("div",{className:"relative",children:o.jsx("input",{type:"file",accept:"image/*",onChange:Te=>z(Te,B.id),className:"w-full text-xs sm:text-sm md:text-base file:mr-3 file:py-2 file:px-4 file:rounded-lg file:border-0 file:text-xs sm:file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100 transition-colors",id:`file-input-${B.id}`})}),h[B.id]&&o.jsxs("div",{className:"flex items-center gap-2 p-2 sm:p-2.5 bg-green-50 border border-green-200 rounded-lg",children:[o.jsx(jr,{className:"h-4 w-4 sm:h-5 sm:w-5 text-green-600 flex-shrink-0"}),o.jsx("span",{className:"text-[10px] sm:text-xs md:text-sm text-green-700 truncate flex-1",children:(fe=h[B.id])==null?void 0:fe.name}),o.jsx("button",{onClick:()=>f(Te=>{const oe={...Te};return delete oe[B.id],oe}),className:"text-red-600 hover:text-red-700 text-xs sm:text-sm font-medium flex-shrink-0","aria-label":"Remove file",children:"Remove"})]}),b[B.id]&&J>0&&(()=>{const Te=Number(b[B.id]);return!isNaN(Te)&&Te>=J?Te>J?o.jsx("div",{className:"p-2 sm:p-2.5 bg-blue-50 border border-blue-300 rounded-lg",children:o.jsxs("p",{className:"text-[10px] sm:text-xs text-blue-800 font-medium",children:[" Amount paid (",Te.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),") is greater than the required amount. This is acceptable."]})}):null:o.jsx("div",{className:"p-2 sm:p-2.5 bg-amber-50 border border-amber-300 rounded-lg",children:o.jsxs("p",{className:"text-[10px] sm:text-xs text-amber-800 font-medium",children:[" Amount paid (",Te.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),") must be at least ",J.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})," (amount to pay). You can pay more if needed."]})})})(),o.jsx("button",{onClick:()=>K(B.id),disabled:(()=>{const Te=b[B.id]?Number(b[B.id]):0,oe=J>0?!isNaN(Te)&&Te>=J:!isNaN(Te)&&Te>0;return!h[B.id]||p||y.length===0||!b[B.id]||!oe})(),className:"w-full flex items-center justify-center gap-2 sm:gap-3 px-4 sm:px-5 md:px-6 py-3 sm:py-3.5 md:py-4 bg-gradient-to-r from-primary-600 to-primary-700 text-white rounded-xl md:rounded-2xl hover:from-primary-700 hover:to-primary-800 active:from-primary-800 active:to-primary-900 disabled:from-gray-400 disabled:to-gray-500 disabled:cursor-not-allowed transition-all shadow-lg md:shadow-xl hover:shadow-2xl disabled:shadow-none text-sm sm:text-base md:text-lg font-extrabold touch-manipulation transform hover:scale-[1.02] disabled:transform-none",style:{WebkitTapHighlightColor:"transparent"},children:p?o.jsxs(o.Fragment,{children:[o.jsxs("svg",{className:"animate-spin h-4 w-4 sm:h-5 sm:w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),o.jsx("span",{children:"Submitting..."})]}):o.jsxs(o.Fragment,{children:[o.jsx(iU,{className:"h-4 w-4 sm:h-5 sm:w-5"}),o.jsx("span",{children:W(B)?"Resubmit Payment Proof":"Submit Payment Proof"})]})}),(()=>{const Te=b[B.id]?Number(b[B.id]):0,oe=[];return y.length===0&&oe.push("Admin QR code not available"),h[B.id]||oe.push("Please select a payment proof image"),b[B.id]?J>0&&(isNaN(Te)||Te<J)?oe.push(`Amount paid must be at least ${J.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`):J===0&&(isNaN(Te)||Te<=0)&&oe.push("Please enter a valid amount"):oe.push("Please enter the amount paid"),oe.length>0?o.jsx("div",{className:"text-[10px] sm:text-xs text-slate-500 space-y-0.5",children:oe.map((Se,ke)=>o.jsxs("p",{children:[" ",Se]},ke))}):null})(),o.jsx("p",{className:"text-[10px] sm:text-xs text-slate-500 leading-relaxed",children:"Upload a screenshot of your payment to the admin QR code above (max 5MB, JPG/PNG)."})]})]})]})]})]}),W(B)&&o.jsx("div",{className:"bg-red-50 border-2 border-red-300 rounded-lg sm:rounded-xl p-3 sm:p-4 md:p-5 mb-4",children:o.jsxs("div",{className:"flex items-start gap-2 sm:gap-3",children:[o.jsx(Au,{className:"h-5 w-5 sm:h-6 sm:w-6 text-red-600 flex-shrink-0 mt-0.5"}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h4",{className:"font-semibold text-sm sm:text-base md:text-lg text-red-900 mb-1.5 sm:mb-2",children:"Payment Rejected"}),o.jsx("p",{className:"text-xs sm:text-sm md:text-base text-red-700 leading-relaxed mb-2 sm:mb-3",children:"Your previous payment proof was rejected. Please select an admin QR code, enter the amount paid, and upload a new proof of payment."}),((ye=B.payment)==null?void 0:ye.rejection_reason)&&o.jsxs("div",{className:"mt-2 sm:mt-3 p-2.5 sm:p-3 bg-red-100 border border-red-300 rounded-lg",children:[o.jsx("p",{className:"text-xs sm:text-sm font-semibold text-red-900 mb-1",children:"Rejection Reason:"}),o.jsx("p",{className:"text-xs sm:text-sm text-red-800 leading-relaxed whitespace-pre-wrap break-words",children:B.payment.rejection_reason})]})]})]})}),O.toLowerCase()==="pending"&&B.payment_proof&&o.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4 mb-4",children:o.jsxs("div",{className:"flex items-center text-blue-700",children:[o.jsx(jr,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2 flex-shrink-0"}),o.jsx("p",{className:"text-xs sm:text-sm",children:"Your payment has been submitted and is being reviewed by the admin."})]})}),O.toLowerCase()==="paid"&&o.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 sm:p-4 mb-4",children:o.jsxs("div",{className:"flex items-center text-blue-700",children:[o.jsx(jr,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2 flex-shrink-0"}),o.jsx("p",{className:"text-xs sm:text-sm",children:"Your payment has been recorded. Waiting for admin confirmation."})]})}),O.toLowerCase()==="admin_confirmed"&&o.jsx("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-3 sm:p-4 mb-4",children:o.jsxs("div",{className:"flex items-center text-indigo-700",children:[o.jsx(jr,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2 flex-shrink-0"}),o.jsx("p",{className:"text-xs sm:text-sm",children:"Your payment has been confirmed by the admin. Waiting for tutor confirmation."})]})}),O.toLowerCase()==="confirmed"&&o.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 sm:p-4 mb-4",children:o.jsxs("div",{className:"flex items-center text-green-700",children:[o.jsx(jr,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2 flex-shrink-0"}),o.jsx("p",{className:"text-xs sm:text-sm",children:"Your payment has been confirmed. The session is now confirmed."})]})}),O.toLowerCase()==="refunded"&&o.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3 sm:p-4 mb-4",children:o.jsxs("div",{className:"flex items-center text-orange-700",children:[o.jsx(Au,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2 flex-shrink-0"}),o.jsx("p",{className:"text-xs sm:text-sm",children:"Your payment has been refunded."})]})}),B.payment_proof&&o.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 sm:p-4 mt-4",children:o.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2",children:[o.jsxs("div",{className:"flex items-center text-green-700",children:[o.jsx(jr,{className:"h-4 w-4 sm:h-5 sm:w-5 mr-2 flex-shrink-0"}),o.jsx("p",{className:"text-xs sm:text-sm",children:"Your payment proof was uploaded."})]}),o.jsx("a",{href:Zt(B.payment_proof),target:"_blank",rel:"noreferrer",className:"text-xs sm:text-sm text-green-700 hover:text-green-800 underline",children:"View upload"})]})})]},B.id)})}),r.length>0&&o.jsxs("div",{className:"bg-white rounded-xl sm:rounded-2xl md:rounded-3xl shadow-xl md:shadow-2xl border-2 border-slate-200/80 overflow-hidden -mx-2 sm:-mx-3 md:mx-0",children:[o.jsxs("div",{className:"relative bg-gradient-to-r from-primary-600 via-primary-700 to-primary-800 p-4 sm:p-5 md:p-6 lg:p-6 text-white shadow-xl md:shadow-2xl overflow-hidden",children:[o.jsxs("div",{className:"absolute inset-0 opacity-10 hidden md:block",children:[o.jsx("div",{className:"absolute top-0 right-0 w-48 h-48 bg-white rounded-full -mr-24 -mt-24 blur-3xl"}),o.jsx("div",{className:"absolute bottom-0 left-0 w-36 h-36 bg-white rounded-full -ml-18 -mb-18 blur-3xl"})]}),o.jsx("div",{className:"relative flex items-center justify-between",children:o.jsxs("div",{className:"flex items-center gap-3 sm:gap-4",children:[o.jsx("div",{className:"p-2 sm:p-2.5 md:p-2.5 bg-white/20 backdrop-blur-sm rounded-xl shadow-lg border border-white/20",children:o.jsx(X3,{className:"h-5 w-5 sm:h-6 sm:w-6 md:h-7 md:w-7"})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl sm:text-2xl md:text-2xl lg:text-3xl font-extrabold mb-0.5 md:mb-1 tracking-tight",children:"Payment History"}),o.jsxs("p",{className:"text-xs sm:text-sm text-white/90 font-medium",children:[r.length," ",r.length===1?"payment":"payments"," recorded"]})]})]})})]}),o.jsx("div",{className:"p-4 sm:p-5 md:p-6 lg:p-6",children:o.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 sm:gap-5 md:gap-5 lg:gap-6",children:r.map((B,O)=>{var Re,Ve,Ze,bt,tt;const U=B.bookingRequest||B.booking_request;U!=null&&U.status;const J=(B.status||"").toLowerCase(),ae=H(J==="confirmed"?"paid":J),fe=((Ve=(Re=B.tutor)==null?void 0:Re.user)==null?void 0:Ve.name)||"Unknown Tutor",ye=new Date(B.created_at),Te=J==="confirmed",oe=J==="rejected",Se=J==="disputed",ke=J==="refunded",me=((Ze=B.tutor)==null?void 0:Ze.session_rate_per_hour)||((bt=U==null?void 0:U.tutor)==null?void 0:bt.session_rate_per_hour)||((tt=B.tutor)==null?void 0:tt.session_rate_per_hour)||0,re=(U==null?void 0:U.duration)||B.duration||0,je=me*re,ie=Number(B.amount)||0;return o.jsxs("div",{className:"group relative bg-gradient-to-br from-white via-primary-50/40 to-primary-100/30 rounded-xl sm:rounded-2xl border-2 border-slate-200/90 hover:border-primary-400/80 shadow-lg md:shadow-xl hover:shadow-2xl transition-all duration-300 overflow-hidden transform hover:-translate-y-0.5",children:[o.jsx("div",{className:`absolute top-0 left-0 right-0 h-1.5 md:h-2 ${Te?"bg-gradient-to-r from-green-400 via-emerald-500 to-green-600 shadow-md shadow-green-500/50":Se?"bg-gradient-to-r from-purple-400 via-purple-500 to-purple-600 shadow-md shadow-purple-500/50":ke?"bg-gradient-to-r from-orange-400 via-orange-500 to-orange-600 shadow-md shadow-orange-500/50":oe?"bg-gradient-to-r from-red-400 via-rose-500 to-red-600 shadow-md shadow-red-500/50":"bg-gradient-to-r from-primary-500 via-primary-600 to-primary-700 shadow-md shadow-primary-500/50"}`}),o.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-primary-200/10 rounded-full -mr-12 -mt-12 blur-2xl hidden md:block"}),o.jsx("div",{className:"absolute bottom-0 left-0 w-20 h-20 bg-primary-300/10 rounded-full -ml-10 -mb-10 blur-2xl hidden md:block"}),o.jsxs("div",{className:"relative p-4 sm:p-5 md:p-5 lg:p-6",children:[o.jsx("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3 sm:gap-4 mb-3 sm:mb-4",children:o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("div",{className:"flex flex-wrap items-center gap-2 sm:gap-2.5 mb-3",children:o.jsxs("div",{className:`px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg md:rounded-xl text-xs sm:text-sm font-bold flex items-center gap-1.5 shadow-md ${ae.color} border-2 ${ae.color.includes("yellow")?"border-yellow-400 bg-yellow-50":ae.color.includes("red")?"border-red-400 bg-red-50":ae.color.includes("green")?"border-green-400 bg-green-50":ae.color.includes("indigo")?"border-indigo-400 bg-indigo-50":"border-primary-400 bg-primary-50"}`,children:[ae.icon,ae.dotColor&&o.jsx("span",{className:`h-2.5 w-2.5 rounded-full ${ae.dotColor}`}),o.jsx("span",{className:"whitespace-nowrap",children:ae.text})]})}),o.jsx("div",{className:"mb-3 sm:mb-4",children:o.jsxs("div",{className:"relative overflow-hidden inline-flex flex-col sm:flex-row sm:items-baseline gap-1.5 sm:gap-3 bg-gradient-to-br from-green-50 via-emerald-50/70 to-green-50 px-4 sm:px-5 md:px-5 lg:px-6 py-2.5 sm:py-3 md:py-3 lg:py-3.5 rounded-xl md:rounded-2xl border-2 border-green-300/80 shadow-lg md:shadow-xl w-full sm:w-auto",children:[o.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-green-200/30 rounded-full -mr-10 -mt-10 blur-2xl hidden md:block"}),o.jsx("span",{className:"text-xs sm:text-sm text-slate-700 font-bold relative uppercase tracking-wide",children:"Amount Paid"}),o.jsxs("span",{className:"text-2xl sm:text-3xl md:text-3xl lg:text-4xl font-black bg-gradient-to-r from-green-600 via-emerald-700 to-green-800 bg-clip-text text-transparent relative leading-tight",children:["",ie.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]})]})}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-3.5 mb-3 sm:mb-4",children:[me>0&&o.jsxs("div",{className:"group/item flex items-start gap-2.5 sm:gap-3 p-2.5 sm:p-3 bg-white/80 backdrop-blur-sm rounded-lg md:rounded-xl border-2 border-slate-200 shadow-sm hover:shadow-md hover:border-primary-300 transition-all duration-200",children:[o.jsx("div",{className:"p-1.5 sm:p-2 bg-gradient-to-br from-blue-100 to-blue-200 rounded-lg shadow-sm flex-shrink-0",children:o.jsx("svg",{className:"h-4 w-4 sm:h-5 sm:w-5 text-blue-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-[10px] sm:text-xs text-slate-500 font-bold mb-0.5 uppercase tracking-wide",children:"Session Rate"}),o.jsxs("p",{className:"text-sm sm:text-base md:text-base font-bold text-slate-900",children:["",me.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}),"/hour"]})]})]}),je>0&&o.jsxs("div",{className:"group/item flex items-start gap-2.5 sm:gap-3 p-2.5 sm:p-3 bg-white/80 backdrop-blur-sm rounded-lg md:rounded-xl border-2 border-slate-200 shadow-sm hover:shadow-md hover:border-primary-300 transition-all duration-200",children:[o.jsx("div",{className:"p-1.5 sm:p-2 bg-gradient-to-br from-amber-100 to-amber-200 rounded-lg shadow-sm flex-shrink-0",children:o.jsx("svg",{className:"h-4 w-4 sm:h-5 sm:w-5 text-amber-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"})})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-[10px] sm:text-xs text-slate-500 font-bold mb-0.5 uppercase tracking-wide",children:"Total Amount to Pay"}),o.jsxs("p",{className:"text-sm sm:text-base md:text-base font-bold text-slate-900",children:["",je.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),re>0&&o.jsxs("p",{className:"text-[10px] sm:text-xs text-slate-500 mt-0.5",children:["(",re," ",re===1?"hour":"hours",")"]})]})]}),o.jsxs("div",{className:"group/item flex items-start gap-2.5 sm:gap-3 p-2.5 sm:p-3 bg-white/80 backdrop-blur-sm rounded-lg md:rounded-xl border-2 border-slate-200 shadow-sm hover:shadow-md hover:border-primary-300 transition-all duration-200",children:[o.jsx("div",{className:"p-1.5 sm:p-2 bg-gradient-to-br from-primary-100 to-primary-200 rounded-lg shadow-sm flex-shrink-0",children:o.jsx("svg",{className:"h-4 w-4 sm:h-5 sm:w-5 text-primary-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-[10px] sm:text-xs text-slate-500 font-bold mb-0.5 uppercase tracking-wide",children:"Tutor"}),o.jsx("p",{className:"text-sm sm:text-base md:text-base font-bold text-slate-900 break-words",children:fe})]})]}),(()=>{const St=B.subject;let mt=null;return typeof St=="string"?mt=St:St!=null&&St.subject_name?mt=St.subject_name:U!=null&&U.subject&&(mt=U.subject),mt?o.jsxs("div",{className:"group/item flex items-start gap-2.5 sm:gap-3 p-2.5 sm:p-3 bg-white/80 backdrop-blur-sm rounded-lg md:rounded-xl border-2 border-slate-200 shadow-sm hover:shadow-md hover:border-primary-300 transition-all duration-200",children:[o.jsx("div",{className:"p-1.5 sm:p-2 bg-gradient-to-br from-indigo-100 to-indigo-200 rounded-lg shadow-sm flex-shrink-0",children:o.jsx("svg",{className:"h-4 w-4 sm:h-5 sm:w-5 text-indigo-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-[10px] sm:text-xs text-slate-500 font-bold mb-0.5 uppercase tracking-wide",children:"Subject"}),o.jsx("p",{className:"text-sm sm:text-base md:text-base font-bold text-slate-900 break-words",children:mt})]})]}):null})(),o.jsxs("div",{className:"group/item flex items-start gap-2.5 sm:gap-3 p-2.5 sm:p-3 bg-white/80 backdrop-blur-sm rounded-lg md:rounded-xl border-2 border-slate-200 shadow-sm hover:shadow-md hover:border-primary-300 transition-all duration-200 sm:col-span-2",children:[o.jsx("div",{className:"p-1.5 sm:p-2 bg-gradient-to-br from-primary-100 to-primary-200 rounded-lg shadow-sm flex-shrink-0",children:o.jsx("svg",{className:"h-4 w-4 sm:h-5 sm:w-5 text-primary-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-[10px] sm:text-xs text-slate-500 font-bold mb-0.5 uppercase tracking-wide",children:"Payment Date"}),o.jsxs("p",{className:"text-sm sm:text-base md:text-base font-bold text-slate-900",children:[ye.toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),o.jsxs("span",{className:"text-slate-600 font-medium ml-2 text-xs sm:text-sm",children:["at ",ye.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit"})]})]})]})]})]}),B.rejection_reason&&o.jsx("div",{className:"mt-3 sm:mt-4 p-3 sm:p-4 bg-gradient-to-br from-red-50 via-rose-50 to-red-50 border-2 border-red-300 rounded-xl shadow-md",children:o.jsxs("div",{className:"flex items-start gap-2.5 sm:gap-3",children:[o.jsx("div",{className:"p-1.5 bg-red-100 rounded-lg flex-shrink-0",children:o.jsx(Au,{className:"h-4 w-4 sm:h-5 sm:w-5 text-red-600"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-xs sm:text-sm font-bold text-red-900 mb-1.5 uppercase tracking-wide",children:"Rejection Reason"}),o.jsx("p",{className:"text-xs sm:text-sm text-red-800 leading-relaxed whitespace-pre-wrap break-words font-medium",children:B.rejection_reason})]})]})})]})}),o.jsxs("div",{className:"flex flex-col sm:flex-row items-stretch gap-2.5 sm:gap-3 pt-3 md:pt-4 border-t-2 border-slate-300/80",children:[B.payment_proof&&o.jsxs("a",{href:Zt(B.payment_proof),target:"_blank",rel:"noreferrer",className:"group/btn flex items-center justify-center gap-2 px-4 sm:px-5 md:px-6 py-2.5 sm:py-3 bg-gradient-to-r from-primary-600 via-primary-700 to-primary-600 hover:from-primary-700 hover:via-primary-800 hover:to-primary-700 text-white rounded-lg md:rounded-xl font-bold text-xs sm:text-sm md:text-base shadow-lg md:shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:scale-105",children:[o.jsx(bs,{className:"h-4 w-4 sm:h-5 sm:w-5"}),o.jsx("span",{children:"View Proof"}),o.jsx("svg",{className:"h-4 w-4 sm:h-5 sm:w-5 opacity-0 group-hover/btn:opacity-100 transition-opacity duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]}),B.admin_proof&&o.jsxs("a",{href:Zt(B.admin_proof),target:"_blank",rel:"noreferrer",className:"group/btn flex items-center justify-center gap-2 px-4 sm:px-5 md:px-6 py-2.5 sm:py-3 bg-gradient-to-r from-primary-700 via-primary-600 to-primary-700 hover:from-primary-800 hover:via-primary-700 hover:to-primary-800 text-white rounded-lg md:rounded-xl font-bold text-xs sm:text-sm md:text-base shadow-lg md:shadow-xl hover:shadow-2xl transition-all duration-300 transform hover:scale-105",children:[o.jsx(bs,{className:"h-4 w-4 sm:h-5 sm:w-5"}),o.jsx("span",{children:"Admin Proof"}),o.jsx("svg",{className:"h-4 w-4 sm:h-5 sm:w-5 opacity-0 group-hover/btn:opacity-100 transition-opacity duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]})]})]})]},B.payment_id)})})})]}),o.jsx(On,{isOpen:T,onClose:()=>E(!1),title:I||"QR",children:D?o.jsx("div",{className:"w-full flex justify-center",children:o.jsx("img",{src:D,alt:I||"QR Image",className:"max-h-[70vh] object-contain"})}):o.jsx("div",{className:"text-slate-600",children:"No image available"})})]})},bKe=()=>{const[t,e]=j.useState([]),[n,s]=j.useState(!0),[r,a]=j.useState(null),{user:i}=rr(),[l,c]=j.useState(!1),[u,h]=j.useState(null),[f,p]=j.useState(5),[x,y]=j.useState(""),[v,b]=j.useState(new Date),[N,S]=j.useState(!1),[k,T]=j.useState(null);j.useEffect(()=>{const $=setInterval(()=>b(new Date),6e4);return()=>clearInterval($)},[]),j.useEffect(()=>{i!=null&&i.user_id&&D()},[i,v]);const E=($,R)=>{if(!$||!R)return null;let F=new Date(`${$.split("T")[0]}T${R}`);if(!isNaN(F.getTime()))return F;if(F=new Date($),isNaN(F.getTime()))return null;const W=R.match(/(\d{1,2}):(\d{2})(?::\d{2})?\s*(AM|PM)?/i);if(W){let q=parseInt(W[1],10);const X=parseInt(W[2],10),z=W[3];return z&&z.toLowerCase()==="pm"&&q<12&&(q+=12),z&&z.toLowerCase()==="am"&&q===12&&(q=0),F.setHours(q,X,0,0),F}return null},D=async()=>{var $,R;try{s(!0);const F=await we.get("/users/me/bookings");if(!Array.isArray(F.data))throw new Error("Invalid response format from server");const W=F.data.filter(q=>{const X=(q.status||"").toLowerCase();if(X==="completed"||X==="admin_payment_pending"||X==="awaiting_confirmation")return!0;if(["upcoming","confirmed"].includes(X)){const K=E(q.date,q.time);if(!K)return!1;const H=new Date(K.getTime()+(q.duration||0)*60*60*1e3);return v.getTime()>H.getTime()}return!1}).map(q=>{var K,H;const X=(q.status||"").toLowerCase().trim();let z=!1;if(X==="upcoming"||X==="confirmed"){const Y=E(q.date,q.time);if(Y){const B=new Date(Y.getTime()+(q.duration||0)*60*60*1e3);z=v.getTime()>B.getTime()}}return{id:q.id||0,subject:q.subject||"Untitled Session",date:q.date||new Date().toISOString(),time:q.time||"00:00",duration:q.duration||1,status:X,isPendingCompletion:z,tutee_rating:q.tutee_rating??null,tutee_comment:q.tutee_comment??null,student_notes:q.student_notes||"",tutor:{user:{name:((H=(K=q.tutor)==null?void 0:K.user)==null?void 0:H.name)||"Unknown Tutor"}}}});console.log("Fetched sessions:",W.map(q=>({id:q.id,status:q.status,hasRating:!!q.tutee_rating}))),e(W),a(null)}catch(F){const W=((R=($=F.response)==null?void 0:$.data)==null?void 0:R.message)||F.message||"Failed to load sessions.";a(W),gt.error(W)}finally{s(!1)}},A=async()=>{var $,R,F,W;if(!k){console.log("handleSecondaryConfirm called but no confirmTargetSession");return}console.log("handleSecondaryConfirm called for session ID:",k.id);try{s(!0);const q=await we.post(`/users/bookings/${k.id}/confirm-completion`);if(console.log("API response received:",q),($=q.data)!=null&&$.success)console.log("API call successful, showing success toast."),gt.success("Session confirmed! You can now leave feedback."),e(X=>X.map(z=>z.id===k.id?{...z,status:"completed"}:z)),S(!1),T(null),setTimeout(async()=>{await D(),console.log("Sessions refreshed after confirmation")},300);else throw console.error("API call failed or did not return success:true. Response data:",q.data),new Error(((R=q.data)==null?void 0:R.message)||"Failed to confirm session")}catch(q){console.error("Failed to confirm session",q),gt.error(((W=(F=q==null?void 0:q.response)==null?void 0:F.data)==null?void 0:W.message)||(q==null?void 0:q.message)||"Failed to confirm session")}finally{s(!1)}},I=async()=>{var $,R,F,W,q,X;if(u)try{await we.post(`/users/bookings/${u.id}/feedback`,{rating:f,comment:x});try{const z=await we.get("/users/me/bookings"),K=Array.isArray(z.data)?z.data.find(H=>H.id===u.id):null;if(K){const H=(($=K.tutor)==null?void 0:$.tutor_id)||((R=K.tutor)==null?void 0:R.id)||K.tutor_id||null,Y=((F=K.tutor)==null?void 0:F.session_rate_per_hour)||K.session_rate_per_hour||0,B=K.duration||u.duration||0,O=Y*B;if(H&&O>0)try{await we.post("/payments/request",{bookingId:u.id,tutorId:H,amount:O,subject:K.subject||u.subject})}catch(U){if(console.error("Payment request failed:",U),((W=U==null?void 0:U.response)==null?void 0:W.status)!==400)throw U}else console.warn("Cannot create payment: missing tutorId or amount",{tutorId:H,amount:O,booking:K})}}catch(z){console.error("Failed to create payment record:",z)}gt.success("Feedback submitted successfully!"),c(!1),h(null),p(5),y(""),await D()}catch(z){console.error("Failed to submit feedback",z),gt.error(((X=(q=z==null?void 0:z.response)==null?void 0:q.data)==null?void 0:X.message)||(z==null?void 0:z.message)||"Failed to submit feedback")}},P=$=>o.jsx("div",{className:"flex items-center gap-1",children:[...Array(5)].map((R,F)=>o.jsx(ja,{className:`h-5 w-5 ${F<$?"text-yellow-400 fill-current":"text-gray-300"}`},F))});return n?o.jsxs("div",{className:"space-y-3 sm:space-y-4 md:space-y-6",children:[o.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl sm:rounded-2xl p-3 sm:p-4 md:p-6 text-white shadow-lg -mx-2 sm:-mx-3 md:mx-0",children:o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[o.jsx(ja,{className:"h-5 w-5 sm:h-6 sm:w-6 md:h-8 md:w-8 text-yellow-300 flex-shrink-0"}),o.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl font-bold text-white",children:"After Session"})]})}),o.jsx("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-lg border border-slate-200 p-4 sm:p-6 -mx-2 sm:-mx-3 md:mx-0",children:o.jsx("div",{className:"animate-pulse space-y-4",children:[1,2].map($=>o.jsx("div",{className:"h-28 bg-gradient-to-r from-slate-100 to-slate-50 rounded-xl"},$))})})]}):o.jsxs("div",{className:"space-y-3 sm:space-y-4 md:space-y-6",children:[o.jsx(Kc,{}),o.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl sm:rounded-2xl p-3 sm:p-4 md:p-6 text-white shadow-lg -mx-2 sm:-mx-3 md:mx-0",children:[o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2 sm:mb-3",children:[o.jsx(ja,{className:"h-5 w-5 sm:h-6 sm:w-6 md:h-8 md:w-8 text-yellow-300 flex-shrink-0"}),o.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl font-bold text-white",children:"After Session"})]}),o.jsx("p",{className:"text-xs sm:text-sm md:text-base lg:text-lg text-blue-100/90 leading-relaxed",children:"Leave feedback for your completed sessions."})]}),o.jsxs("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-lg border border-slate-200 overflow-hidden -mx-2 sm:-mx-3 md:mx-0",children:[r&&o.jsx("div",{className:"p-4 m-4 bg-red-50 text-red-700 border border-red-200 rounded-lg",children:o.jsx("p",{children:r})}),t.length===0&&!n?o.jsxs("div",{className:"text-center py-12 sm:py-16 px-4",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 sm:w-20 sm:h-20 bg-gradient-to-br from-blue-100 to-indigo-100 rounded-2xl mb-4 sm:mb-6",children:o.jsx(jr,{className:"h-8 w-8 sm:h-10 sm:w-10 text-blue-600"})}),o.jsx("h3",{className:"text-xl sm:text-2xl font-bold text-slate-900 mb-2",children:"No Sessions Found"}),o.jsx("p",{className:"text-sm sm:text-base text-slate-600 max-w-md mx-auto",children:"When a session is finished or overdue, it will appear here."})]}):o.jsx("div",{className:"p-3 sm:p-4 md:p-6 space-y-3 sm:space-y-4",children:t.map($=>{var R,F;return o.jsxs("div",{className:"group bg-white rounded-xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow p-4",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-start gap-4",children:[o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:"text-lg font-bold text-slate-800",children:$.subject}),o.jsxs("div",{className:"flex items-center text-sm text-slate-500 mt-1",children:[o.jsx(za,{className:"h-4 w-4 mr-2"}),o.jsxs("span",{children:["with ",(F=(R=$.tutor)==null?void 0:R.user)==null?void 0:F.name]})]}),o.jsxs("div",{className:"flex items-center text-sm text-slate-500 mt-1",children:[o.jsx(Mi,{className:"h-4 w-4 mr-2"}),o.jsx("span",{children:new Date($.date).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})]})]}),o.jsx("div",{className:"flex-shrink-0 flex flex-col items-end justify-between gap-2",children:$.isPendingCompletion?o.jsx("span",{className:"inline-flex items-center px-3 py-1.5 rounded-full bg-yellow-100 text-yellow-700 text-xs sm:text-sm font-semibold border border-yellow-300",children:"Pending Completion"}):$.status==="awaiting_confirmation"?o.jsx(at,{onClick:()=>{console.log("Setting confirm target session:",$),T($),S(!0)},className:"bg-green-500 text-white hover:bg-green-600",disabled:n,children:"Confirm Session"}):$.status==="completed"||$.status==="admin_payment_pending"?$.tutee_rating?o.jsxs("div",{className:"text-right",children:[o.jsx("p",{className:"text-sm font-medium text-slate-600 mb-1",children:"Your Rating"}),P($.tutee_rating)]}):o.jsx(at,{onClick:()=>{console.log("Opening feedback modal for session:",$.id,"Status:",$.status,"Has rating:",!!$.tutee_rating),h($),c(!0)},className:"bg-blue-500 text-white hover:bg-blue-600",disabled:n,children:"Leave Feedback"}):o.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full bg-purple-100 text-purple-700 text-xs font-medium",children:"Completed"})})]}),$.tutee_comment&&o.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200",children:[o.jsx("p",{className:"text-sm font-semibold text-slate-700 mb-1",children:"Your Comment:"}),o.jsxs("p",{className:"text-sm text-slate-600 italic",children:['"',$.tutee_comment,'"']})]})]},$.id)})})]}),l&&u&&o.jsx(On,{isOpen:!0,onClose:()=>{console.log("Closing feedback modal"),c(!1),h(null),p(5),y("")},title:`Leave Feedback for ${u.subject}`,footer:o.jsxs(o.Fragment,{children:[o.jsx(at,{onClick:()=>{console.log("Submitting feedback for session:",u),I()},disabled:n,children:n?"Submitting...":"Submit Feedback"}),o.jsx(at,{variant:"secondary",onClick:()=>{c(!1),h(null),p(5),y("")},children:"Cancel"})]}),children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Rating"}),o.jsx("div",{className:"flex justify-center space-x-2",children:[5,4,3,2,1].map($=>o.jsx("button",{onClick:()=>p($),className:"focus:outline-none",children:o.jsx(ja,{className:`h-8 w-8 transition-colors ${f>=$?"text-yellow-400":"text-slate-300 hover:text-yellow-300"}`})},$))})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-slate-700",children:"Comment (optional)"}),o.jsx("textarea",{value:x,onChange:$=>y($.target.value),className:"mt-1 block w-full border border-slate-300 rounded-md p-2 focus:ring-blue-500 focus:border-blue-500",rows:4})]})]})}),N&&k&&o.jsxs(On,{isOpen:!0,onClose:()=>{S(!1),T(null)},title:"Confirm Session Completion",footer:o.jsxs(o.Fragment,{children:[o.jsx(at,{onClick:A,disabled:n,children:"Confirm"}),o.jsx(at,{variant:"secondary",onClick:()=>{S(!1),T(null)},children:"Cancel"})]}),children:[o.jsxs("p",{children:['Are you sure you want to confirm the completion of the session for "',k.subject,'"?']}),o.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Once confirmed, you will be able to leave feedback for your tutor."})]})]})},vKe=()=>{const[t,e]=j.useState([]),[n,s]=j.useState(!0),[r,a]=j.useState(null),{user:i}=rr(),[l,c]=j.useState(!1),[u,h]=j.useState(null),[f,p]=j.useState(5),[x,y]=j.useState(""),[v,b]=j.useState(new Date);j.useEffect(()=>{(async()=>{await T()})();const I=setInterval(T,1e4),P=()=>T();return window.addEventListener("focus",P),()=>{clearInterval(I),window.removeEventListener("focus",P)}},[v]),j.useEffect(()=>{const A=setInterval(()=>b(new Date),6e4);return()=>clearInterval(A)},[]);const N=(A,I)=>{if(!A||!I)return null;let P=new Date(`${A.split("T")[0]}T${I}`);if(!isNaN(P.getTime()))return P;if(P=new Date(A),isNaN(P.getTime()))return null;const $=I.match(/(\d{1,2}):(\d{2})(?::\d{2})?\s*(AM|PM)?/i);if($){let R=parseInt($[1],10);const F=parseInt($[2],10),W=$[3];W&&W.toLowerCase()==="pm"&&R<12&&(R+=12),W&&W.toLowerCase()==="am"&&R===12&&(R=0),P.setHours(R,F,0,0)}return P},S=A=>{const I=N(A.date,A.time);return I?v>=I:!1},k=A=>{const I=N(A.date,A.time);if(!I)return!1;const P=A.duration||1,$=new Date(I.getTime()+P*60*60*1e3);return v>=$},T=async()=>{var A,I,P;try{if(s(!0),!(i!=null&&i.user_id))throw new Error("User not found. Please log in again.");const $=await we.get("/users/me/bookings");if(!Array.isArray($.data))throw console.error("Invalid response:",$.data),new Error("Invalid response format from server");const F=$.data.map(W=>{var q,X;return{id:W.id||0,subject:W.subject||"Untitled Session",date:W.date||new Date().toISOString(),time:W.time||"00:00",duration:W.duration||1,status:W.status||"pending",tutee_rating:W.tutee_rating??null,tutee_comment:W.tutee_comment??null,student_notes:W.student_notes||"",tutor:{user:{name:((X=(q=W.tutor)==null?void 0:q.user)==null?void 0:X.name)||"Unknown Tutor"}}}}).filter(W=>{const q=W.status.toLowerCase();return q==="completed"||q==="admin_payment_pending"?W.tutee_rating!==null&&W.tutee_rating!==void 0:q==="upcoming"?S(W):!0});e(F),a(null)}catch($){console.error("Failed to fetch bookings:",$);const R=((I=(A=$.response)==null?void 0:A.data)==null?void 0:I.message)||$.message||"Failed to load your bookings. Please check your connection and try again.";a(R),gt.error(R),((P=$.response)==null?void 0:P.status)===401&&(localStorage.removeItem("token"),localStorage.removeItem("user"),window.location.href="/#/login")}finally{s(!1)}},E=A=>o.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:5},(I,P)=>o.jsx(ja,{className:`h-4 w-4 sm:h-5 sm:w-5 ${P<Math.floor(A)?"text-yellow-400 fill-current":"text-slate-300"}`},P))}),D=A=>{switch(A.toLowerCase()){case"pending":return{color:"bg-yellow-50 text-yellow-800 border-yellow-300",icon:o.jsx(vc,{className:"h-4 w-4"}),text:"Pending"};case"confirmed":return{color:"bg-green-50 text-green-800 border-green-300",icon:o.jsx(jr,{className:"h-4 w-4"}),text:"Confirmed"};case"completed":return{color:"bg-blue-50 text-blue-800 border-blue-300",icon:o.jsx(jr,{className:"h-4 w-4"}),text:"Completed"};case"cancelled":return{color:"bg-red-50 text-red-800 border-red-300",icon:o.jsx(Wre,{className:"h-4 w-4"}),text:"Cancelled"};default:return{color:"bg-slate-50 text-slate-800 border-slate-300",icon:o.jsx(vc,{className:"h-4 w-4"}),text:A}}};return n?o.jsxs("div",{className:"space-y-3 sm:space-y-4 md:space-y-6",children:[o.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl sm:rounded-2xl p-3 sm:p-4 md:p-6 text-white shadow-lg -mx-2 sm:-mx-3 md:mx-0",children:o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[o.jsx(Xd,{className:"h-5 w-5 sm:h-6 sm:w-6 md:h-8 md:w-8 flex-shrink-0"}),o.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl font-bold text-white",children:"My Bookings"})]})}),o.jsx("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-lg border border-slate-200 p-4 sm:p-6 -mx-2 sm:-mx-3 md:mx-0",children:o.jsx("div",{className:"animate-pulse space-y-4",children:[1,2,3].map(A=>o.jsx("div",{className:"h-32 bg-gradient-to-r from-slate-100 to-slate-50 rounded-xl"},A))})})]}):r?o.jsxs("div",{className:"space-y-3 sm:space-y-4 md:space-y-6",children:[o.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl sm:rounded-2xl p-3 sm:p-4 md:p-6 text-white shadow-lg -mx-2 sm:-mx-3 md:mx-0",children:o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[o.jsx(Xd,{className:"h-5 w-5 sm:h-6 sm:w-6 md:h-8 md:w-8 flex-shrink-0"}),o.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl font-bold text-white",children:"My Bookings"})]})}),o.jsx("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-lg border-2 border-red-200 p-4 sm:p-6 -mx-2 sm:-mx-3 md:mx-0",children:o.jsxs("div",{className:"flex items-center gap-3 p-4 bg-red-50 rounded-xl",children:[o.jsx(vc,{className:"h-5 w-5 sm:h-6 sm:w-6 text-red-600 flex-shrink-0"}),o.jsx("p",{className:"text-sm sm:text-base text-red-800 font-medium",children:r})]})})]}):o.jsxs("div",{className:"space-y-3 sm:space-y-4 md:space-y-6",children:[o.jsx(Kc,{"aria-label":"Notification messages"}),o.jsx("div",{className:"bg-gradient-to-r from-blue-600 to-indigo-600 rounded-xl sm:rounded-2xl p-3 sm:p-4 md:p-6 text-white shadow-lg -mx-2 sm:-mx-3 md:mx-0",children:o.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-2.5 sm:gap-3 md:gap-0",children:[o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[o.jsx(Xd,{className:"h-5 w-5 sm:h-6 sm:w-6 md:h-8 md:w-8 flex-shrink-0"}),o.jsxs("div",{children:[o.jsx("h1",{className:"text-lg sm:text-xl md:text-2xl lg:text-3xl font-bold text-white",children:"My Bookings"}),o.jsx("p",{className:"text-xs sm:text-sm md:text-base text-blue-100/90 mt-0.5 sm:mt-1",children:"View and manage your tutoring session bookings"})]})]}),o.jsxs("button",{onClick:()=>{gt.info("Refreshing bookings..."),T()},className:"mt-2 sm:mt-0 px-3 sm:px-4 py-1.5 sm:py-2 text-xs sm:text-sm font-medium text-blue-600 hover:text-blue-700 active:text-blue-800 bg-white hover:bg-blue-50 active:bg-blue-100 rounded-lg sm:rounded-xl transition-all shadow-md hover:shadow-lg w-full sm:w-auto touch-manipulation flex items-center justify-center gap-2",style:{WebkitTapHighlightColor:"transparent"},children:[o.jsx(Q3,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"}),o.jsx("span",{children:"Refresh"})]})]})}),o.jsx("div",{className:"bg-white rounded-xl sm:rounded-2xl shadow-lg border border-slate-200 overflow-hidden -mx-2 sm:-mx-3 md:mx-0",children:t.length===0?o.jsxs("div",{className:"text-center py-12 sm:py-16 px-4",children:[o.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 sm:w-20 sm:h-20 bg-gradient-to-br from-blue-100 to-indigo-100 rounded-2xl mb-4 sm:mb-6",children:o.jsx(Xd,{className:"h-8 w-8 sm:h-10 sm:w-10 text-blue-600"})}),o.jsx("h3",{className:"text-xl sm:text-2xl font-bold text-slate-900 mb-2",children:"No bookings yet"}),o.jsx("p",{className:"text-sm sm:text-base text-slate-600 max-w-md mx-auto",children:"When you book a session with a tutor, it will appear here."})]}):o.jsx("div",{className:"p-3 sm:p-4 md:p-6 space-y-3 sm:space-y-4",children:t.map(A=>{var $,R;const I=D(A.status),P=new Date(A.date);return P>=new Date(new Date().toISOString().split("T")[0]),o.jsxs("div",{className:"group relative bg-gradient-to-br from-white to-blue-50/30 rounded-xl sm:rounded-2xl border-2 border-slate-200 hover:border-blue-300 shadow-md hover:shadow-xl transition-all duration-300 overflow-hidden",children:[o.jsx("div",{className:`absolute top-0 left-0 right-0 h-1 ${A.status.toLowerCase()==="completed"||A.status.toLowerCase()==="confirmed"?"bg-gradient-to-r from-green-500 to-emerald-500":A.status.toLowerCase()==="cancelled"?"bg-gradient-to-r from-red-500 to-rose-500":A.status.toLowerCase()==="pending"?"bg-gradient-to-r from-yellow-500 to-amber-500":(A.status.toLowerCase()==="upcoming","bg-gradient-to-r from-blue-500 to-indigo-500")}`}),o.jsxs("div",{className:"p-4 sm:p-5 md:p-6",children:[o.jsx("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3 sm:gap-4 mb-4 sm:mb-5",children:o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2 sm:mb-3",children:[o.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-100 to-indigo-100 rounded-xl",children:o.jsx(Fg,{className:"h-4 w-4 sm:h-5 sm:w-5 text-blue-600"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h3",{className:"text-lg sm:text-xl md:text-2xl font-bold text-slate-900 mb-1 break-words",children:A.subject}),o.jsxs("div",{className:"flex items-center gap-2 text-sm sm:text-base text-slate-600",children:[o.jsx(za,{className:"h-4 w-4 text-indigo-600 flex-shrink-0"}),o.jsxs("span",{className:"truncate",children:["with ",((R=($=A.tutor)==null?void 0:$.user)==null?void 0:R.name)||"Unknown Tutor"]})]})]})]}),o.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-4",children:[(A.status.toLowerCase()==="completed"||A.status.toLowerCase()==="admin_payment_pending")&&o.jsxs("div",{className:"px-3 sm:px-4 py-1.5 sm:py-2 rounded-xl text-xs sm:text-sm font-bold flex items-center gap-1.5 sm:gap-2 border-2 shadow-md bg-green-50 text-green-700 border-green-300",children:[o.jsx(jr,{className:"h-4 w-4"}),o.jsx("span",{className:"whitespace-nowrap",children:"Completed"})]}),A.status.toLowerCase()==="upcoming"&&k(A)&&o.jsxs("div",{className:"px-3 sm:px-4 py-1.5 sm:py-2 rounded-xl text-xs sm:text-sm font-bold flex items-center gap-1.5 sm:gap-2 border-2 shadow-md bg-yellow-50 text-yellow-700 border-yellow-300",children:[o.jsx(Un,{className:"h-4 w-4"}),o.jsx("span",{className:"whitespace-nowrap",children:"Pending Completion"})]}),A.status.toLowerCase()==="upcoming"&&S(A)&&!k(A)&&o.jsxs("div",{className:"px-3 sm:px-4 py-1.5 sm:py-2 rounded-xl text-xs sm:text-sm font-bold flex items-center gap-1.5 sm:gap-2 border-2 shadow-md bg-green-50 text-green-700 border-green-300",children:[o.jsx(Un,{className:"h-4 w-4"}),o.jsx("span",{className:"whitespace-nowrap",children:"Session Started"})]}),A.status.toLowerCase()!=="completed"&&A.status.toLowerCase()!=="admin_payment_pending"&&A.status.toLowerCase()!=="upcoming"&&o.jsxs("div",{className:`px-3 sm:px-4 py-1.5 sm:py-2 rounded-xl text-xs sm:text-sm font-bold flex items-center gap-1.5 sm:gap-2 border-2 shadow-md ${I.color}`,children:[I.icon,o.jsx("span",{className:"whitespace-nowrap",children:I.text})]})]})]})}),o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4 mb-4",children:[o.jsxs("div",{className:"flex items-start gap-2 sm:gap-3 p-2.5 sm:p-3 bg-white rounded-lg border border-slate-200 shadow-sm",children:[o.jsx("div",{className:"p-1.5 sm:p-2 bg-blue-100 rounded-lg flex-shrink-0",children:o.jsx(Mi,{className:"h-4 w-4 sm:h-5 sm:w-5 text-blue-600"})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-[10px] sm:text-xs text-slate-500 font-medium mb-0.5",children:"Date"}),o.jsx("p",{className:"text-sm sm:text-base font-semibold text-slate-900",children:P.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})})]})]}),o.jsxs("div",{className:"flex items-start gap-2 sm:gap-3 p-2.5 sm:p-3 bg-white rounded-lg border border-slate-200 shadow-sm",children:[o.jsx("div",{className:"p-1.5 sm:p-2 bg-indigo-100 rounded-lg flex-shrink-0",children:o.jsx(Un,{className:"h-4 w-4 sm:h-5 sm:w-5 text-indigo-600"})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-[10px] sm:text-xs text-slate-500 font-medium mb-0.5",children:"Time"}),o.jsx("p",{className:"text-sm sm:text-base font-semibold text-slate-900",children:A.time})]})]}),o.jsxs("div",{className:"flex items-start gap-2 sm:gap-3 p-2.5 sm:p-3 bg-white rounded-lg border border-slate-200 shadow-sm",children:[o.jsx("div",{className:"p-1.5 sm:p-2 bg-blue-100 rounded-lg flex-shrink-0",children:o.jsx(Un,{className:"h-4 w-4 sm:h-5 sm:w-5 text-blue-600"})}),o.jsxs("div",{className:"min-w-0 flex-1",children:[o.jsx("p",{className:"text-[10px] sm:text-xs text-slate-500 font-medium mb-0.5",children:"Duration"}),o.jsxs("p",{className:"text-sm sm:text-base font-semibold text-slate-900",children:[A.duration," ",A.duration===1?"hour":"hours"]})]})]})]}),A.tutee_rating&&o.jsx("div",{className:"mt-4 p-3 sm:p-4 bg-gradient-to-br from-yellow-50 via-amber-50/50 to-yellow-50 border-2 border-yellow-200 rounded-xl",children:o.jsxs("div",{className:"flex items-start gap-2 sm:gap-3",children:[o.jsx("div",{className:"p-1.5 bg-yellow-100 rounded-lg flex-shrink-0",children:o.jsx(ja,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 text-yellow-600 fill-current"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"text-xs sm:text-sm font-semibold text-slate-700 mb-1.5",children:"Your Rating"}),E(A.tutee_rating),A.tutee_comment&&o.jsxs("div",{className:"mt-2 pt-2 border-t border-yellow-200",children:[o.jsx("p",{className:"text-xs sm:text-sm font-medium text-slate-600 mb-1",children:"Your Comment:"}),o.jsxs("p",{className:"text-xs sm:text-sm text-slate-700 leading-relaxed whitespace-pre-wrap break-words italic",children:['"',A.tutee_comment,'"']})]})]})]})}),(A.status.toLowerCase()==="completed"||A.status.toLowerCase()==="admin_payment_pending")&&!A.tutee_rating&&o.jsx("div",{className:"p-4 border-t border-slate-100 mt-4 flex items-center justify-end",children:o.jsx(at,{onClick:()=>{h(A),c(!0)},className:"px-4 py-2 bg-purple-600 text-white rounded-md",children:"Mark as done"})})]})]},A.id)})})}),l&&u&&o.jsx(On,{isOpen:!0,onClose:()=>{c(!1),h(null),p(5),y("")},title:"Leave feedback",footer:o.jsxs(o.Fragment,{children:[o.jsx(at,{onClick:async()=>{var A,I;try{s(!0),await we.post(`/users/bookings/${u.id}/feedback`,{rating:f,comment:x}),gt.success("Feedback submitted. Admins have been notified."),c(!1),h(null),p(5),y(""),await T()}catch(P){console.error("Failed to submit feedback",P),gt.error(((I=(A=P==null?void 0:P.response)==null?void 0:A.data)==null?void 0:I.message)||(P==null?void 0:P.message)||"Failed to submit feedback")}finally{s(!1)}},className:"w-full sm:w-auto px-6 py-2.5 sm:py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-semibold text-sm sm:text-base shadow-md hover:shadow-lg transition-all touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},disabled:n,children:n?"Submitting...":"Submit"}),o.jsx(at,{variant:"secondary",onClick:()=>{c(!1),h(null),p(5),y("")},className:"w-full sm:w-auto mt-2 sm:mt-0 sm:ml-2 px-6 py-2.5 sm:py-2 border-2 border-slate-300 hover:bg-slate-50 rounded-lg font-semibold text-sm sm:text-base transition-all touch-manipulation",style:{WebkitTapHighlightColor:"transparent"},children:"Cancel"})]}),children:o.jsxs("div",{className:"space-y-4 sm:space-y-5",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm sm:text-base font-semibold text-slate-800 mb-2",children:"Rating"}),o.jsx("select",{value:f,onChange:A=>p(Number(A.target.value)),className:"w-full border-2 border-slate-300 rounded-lg px-4 py-3 text-sm sm:text-base focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all bg-white",children:[5,4,3,2,1].map(A=>o.jsxs("option",{value:A,children:[A," / 5"]},A))})]}),o.jsxs("div",{children:[o.jsxs("label",{className:"block text-sm sm:text-base font-semibold text-slate-800 mb-2",children:["Comment ",o.jsx("span",{className:"text-slate-500 font-normal text-xs sm:text-sm",children:"(optional)"})]}),o.jsx("textarea",{value:x,onChange:A=>y(A.target.value),className:"w-full border-2 border-slate-300 rounded-lg px-4 py-3 text-sm sm:text-base focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500 transition-all resize-none min-h-[120px] sm:min-h-[140px]",rows:4,placeholder:"Share your experience with this session..."})]})]})})]})},wKe=()=>{var $,R;const{user:t}=kx(),[e,n]=j.useState((t==null?void 0:t.name)||""),[s,r]=j.useState((t==null?void 0:t.email)||""),[a,i]=j.useState((t==null?void 0:t.university_id)??""),[l,c]=j.useState((t==null?void 0:t.course_id)??""),[u,h]=j.useState((($=t==null?void 0:t.course)==null?void 0:$.course_name)||""),[f,p]=j.useState(!1),[x,y]=j.useState(!1),[v,b]=j.useState([]),[N,S]=j.useState([]),[k,T]=j.useState((t==null?void 0:t.year_level)??""),[E,D]=j.useState(null),A=async()=>{var F,W;if(t){if(p(!0),!e.trim()||!s.trim()){gt.error("Name and email are required"),p(!1);return}if(a&&s){const q=v.find(X=>X.university_id===a);if(q&&(s.split("@")[1]||"").toLowerCase()!==(q.email_domain||"").toLowerCase()){D(`Email domain must be ${(q.email_domain||"").toLowerCase()}`),gt.error("Email domain does not match selected university"),p(!1);return}}try{const q={name:e.trim(),email:s.trim(),university_id:a||void 0,course_id:l||void 0,course_name:!l&&u?u.trim():void 0,year_level:k||void 0},X=await we.patch(`/users/${t.user_id}`,q),z={...t,...X.data};localStorage.setItem("user",JSON.stringify(z)),Lg(z),gt.success("Profile updated successfully"),setTimeout(()=>window.location.reload(),500)}catch(q){console.error("Failed to update profile",q);const X=((W=(F=q==null?void 0:q.response)==null?void 0:F.data)==null?void 0:W.message)||(q==null?void 0:q.message)||"Failed to update profile";gt.error(X)}finally{p(!1)}}},I=async F=>{var q,X;const W=F.target.files&&F.target.files[0];if(!(!W||!t)){if(!W.type.startsWith("image/")){gt.error("Please select a valid image file.");return}y(!0);try{const z=new FormData;z.append("file",W);const K=await we.post(`/users/${t.user_id}/profile-image`,z,{headers:{"Content-Type":"multipart/form-data"}}),H={...t,profile_image_url:K.data.profile_image_url};localStorage.setItem("user",JSON.stringify(H)),Lg(H),gt.success("Profile image updated"),setTimeout(()=>window.location.reload(),500)}catch(z){console.error("Failed to upload profile image",z);const K=((X=(q=z==null?void 0:z.response)==null?void 0:q.data)==null?void 0:X.message)||(z==null?void 0:z.message)||"Failed to upload image";gt.error(K)}finally{y(!1),F.target&&(F.target.value="")}}};j.useEffect(()=>{let F=!0;return(async()=>{try{const[W,q]=await Promise.all([we.get("/universities"),we.get("/courses")]);if(!F)return;const X=(W.data||[]).filter(K=>K.status==="active");b(X);const z=(Array.isArray(q.data)?q.data:[]).map(K=>{var H;return{...K,university_id:(K==null?void 0:K.university_id)??((H=K==null?void 0:K.university)==null?void 0:H.university_id)??(K==null?void 0:K.universityId)??null}});S(z)}catch(W){console.error("Failed to fetch universities/courses",W)}})(),()=>{F=!1}},[]);const P=j.useMemo(()=>N.filter(F=>{var q;const W=(F==null?void 0:F.university_id)??((q=F==null?void 0:F.university)==null?void 0:q.university_id)??(F==null?void 0:F.universityId);return!a||W===a}),[N,a]);return o.jsxs("div",{className:"p-6",children:[o.jsx(Kc,{position:"top-center","aria-label":"Notification center"}),o.jsx("h1",{className:"text-2xl font-bold mb-4",children:"My Profile"}),o.jsx(Lt,{className:"p-6",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 items-start",children:[o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx("div",{className:"h-28 w-28 rounded-full overflow-hidden border-2 border-slate-200 mb-3",children:t!=null&&t.profile_image_url?o.jsx("img",{src:Zt(t.profile_image_url),alt:t==null?void 0:t.name,className:"w-full h-full object-cover"}):o.jsx("div",{className:"w-full h-full bg-gradient-to-br from-blue-500 to-indigo-600 flex items-center justify-center text-white text-3xl font-semibold",children:((R=t==null?void 0:t.name)==null?void 0:R.charAt(0).toUpperCase())||"U"})}),o.jsxs("label",{className:`px-3 py-2 text-sm rounded-md bg-gray-100 border ${x?"opacity-60 cursor-not-allowed":"hover:bg-gray-200"}`,children:[x?"Uploading":"Change photo",o.jsx("input",{type:"file",accept:"image/*",onChange:I,className:"hidden",disabled:x})]})]}),o.jsx("div",{className:"md:col-span-2",children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Full name"}),o.jsx("input",{className:"w-full border px-3 py-2 rounded-md",value:e,onChange:F=>n(F.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),o.jsx("input",{className:"w-full border px-3 py-2 rounded-md",value:s,onChange:F=>r(F.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"University"}),o.jsxs("select",{value:a,onChange:F=>i(F.target.value?Number(F.target.value):""),className:"w-full border px-3 py-2 rounded-md",children:[o.jsx("option",{value:"",children:"-- Select university --"}),v.map(F=>o.jsx("option",{value:F.university_id,children:F.name||F.university_name||F.display_name},F.university_id))]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Course"}),o.jsxs("select",{value:l,onChange:F=>c(F.target.value?Number(F.target.value):""),className:"w-full border px-3 py-2 rounded-md",children:[o.jsx("option",{value:"",children:"-- Select course --"}),P.map(F=>o.jsx("option",{value:F.course_id||F.id,children:F.course_name||F.name},F.course_id||F.id))]}),!l&&o.jsx("input",{className:"w-full border px-3 py-2 rounded-md mt-2",placeholder:"Or enter course name",value:u,onChange:F=>h(F.target.value)})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Year level"}),o.jsxs("select",{value:k,onChange:F=>T(F.target.value?Number(F.target.value):""),className:"w-full border px-3 py-2 rounded-md",children:[o.jsx("option",{value:"",children:"-- Select year level --"}),[1,2,3,4,5,6].map(F=>o.jsx("option",{value:F,children:F},F))]})]}),E&&o.jsx("div",{className:"text-sm text-red-600",children:E}),o.jsxs("div",{className:"flex items-center gap-3 mt-4",children:[o.jsx(at,{onClick:A,disabled:f,children:f?"Saving":"Save changes"}),o.jsx(at,{variant:"secondary",onClick:()=>{n((t==null?void 0:t.name)||""),r((t==null?void 0:t.email)||"")},children:"Cancel"})]})]})})]})})]})},NKe=()=>{const{user:t}=rr(),n=vi().pathname.includes("/tutee-dashboard/my-bookings");return o.jsx(pKe,{children:o.jsx("div",{className:"w-full",children:o.jsx("div",{className:n?"lg:col-span-3":"lg:col-span-4",children:o.jsxs(ew,{children:[o.jsx(rn,{path:"/",element:o.jsx(nl,{to:"/tutee-dashboard/become-tutor",replace:!0})}),o.jsx(rn,{path:"/become-tutor",element:o.jsx(gKe,{})}),o.jsx(rn,{path:"/find-tutors",element:o.jsx(xKe,{})}),o.jsx(rn,{path:"/my-bookings",element:o.jsx(vKe,{})}),o.jsx(rn,{path:"/profile",element:o.jsx(wKe,{})}),o.jsx(rn,{path:"/upcoming-sessions",element:o.jsx(eJ,{})}),o.jsx(rn,{path:"/payment",element:o.jsx(yKe,{})}),o.jsx(rn,{path:"/after-session",element:o.jsx(bKe,{})}),o.jsx(rn,{path:"*",element:o.jsx(nl,{to:"/tutee-dashboard/become-tutor",replace:!0})})]})})})})},SKe=()=>{const t=qr(),{loginTutorTutee:e}=rr(),[n,s]=j.useState({email:"",password:""}),[r,a]=j.useState(!1),[i,l]=j.useState(""),[c,u]=j.useState(!1),[h,f]=j.useState(0),[p,x]=j.useState(!1),[y,v]=j.useState(!1),b=[{src:"assets/images/bgp4.jpg",alt:"Student attending online tutoring session",title:"Personalized Tutoring",description:"One-on-one online sessions that make learning more effective"},{src:"assets/images/bg6.png",alt:"Tutor helping student with laptop",title:"Expert Guidance",description:"Students empowering each other through personalized learning"},{src:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?q=80&w=2070&auto=format&fit=crop",alt:"Students in university lecture hall",title:"Academic Excellence",description:"Building knowledge and skills for future success"},{src:"assets/images/bg2.png",alt:"Student raising hand in classroom",title:"Interactive Learning",description:"Engaging educational experiences that inspire growth"},{src:"assets/images/bg3.png",alt:"Person using laptop with virtual learning icons",title:"Digital Education",description:"Empowering learning through innovative online platforms"},{src:"assets/images/bg5.png",alt:"Students studying together in a modern classroom",title:"Collaborative Learning",description:"Students working together to achieve academic success"}];j.useEffect(()=>{const T=localStorage.getItem("rememberedEmail"),E=localStorage.getItem("rememberMe")==="true";T&&E&&(s(D=>({...D,email:T})),v(!0))},[]),j.useEffect(()=>{y&&n.email?(localStorage.setItem("rememberedEmail",n.email),localStorage.setItem("rememberMe","true")):y||(localStorage.removeItem("rememberedEmail"),localStorage.removeItem("rememberMe"))},[y,n.email]),j.useEffect(()=>{let T=!0;const E=setInterval(()=>{T&&f(D=>(D+1)%b.length)},4e3);return()=>{T=!1,clearInterval(E)}},[]);const N=T=>{const{name:E,value:D}=T.target;s(A=>({...A,[E]:D})),i&&l("")},S=async T=>{var E,D;T.preventDefault(),a(!0),l(""),console.log("Attempting login with:",{email:n.email});try{console.log("Calling loginTutorTutee...");const A=await e(n.email,n.password);console.log("Login result:",A);const I=A;switch(console.log("Determined role:",I),I){case"tutee":console.log("Navigating to tutee dashboard..."),t("/tutee-dashboard",{replace:!0});break;case"tutor":console.log("Navigating to tutor dashboard..."),t("/tutor-dashboard",{replace:!0});break;default:throw console.error("Invalid role received:",I),new Error("Invalid user role")}}catch(A){console.error("Login error:",A),console.error("Error response:",A.response);const I=((D=(E=A.response)==null?void 0:E.data)==null?void 0:D.message)||"Invalid credentials. Please try again.";console.error("Setting error message:",I),l(I)}finally{a(!1)}};return o.jsxs("div",{className:"h-screen bg-gradient-to-br from-slate-50 via-sky-50 to-indigo-100 flex items-center justify-center p-4 relative overflow-hidden",children:[o.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[o.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-gradient-to-br from-sky-400/20 to-indigo-400/20 rounded-full blur-3xl"}),o.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-gradient-to-tr from-indigo-400/20 to-sky-400/20 rounded-full blur-3xl"})]}),o.jsxs("div",{className:"w-full max-w-6xl bg-white/80 backdrop-blur-2xl rounded-[2.5rem] shadow-2xl overflow-hidden grid lg:grid-cols-2 relative z-10 max-h-[90vh] lg:max-h-[800px]",children:[o.jsxs("div",{className:"relative hidden lg:block h-full min-h-[500px]",children:[b.map((T,E)=>o.jsxs("div",{className:`absolute inset-0 transition-opacity duration-1000 ease-in-out ${E===h?"opacity-100":"opacity-0"}`,children:[o.jsx("img",{src:T.src,alt:T.alt,className:"w-full h-full object-cover"}),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/30 to-transparent"})]},E)),o.jsxs("div",{className:"absolute bottom-10 left-10 right-10 text-white z-20",children:[o.jsx("h2",{className:"text-3xl font-bold mb-2 leading-tight",children:b[h].title}),o.jsx("p",{className:"text-base text-white/90 mb-6 leading-normal max-w-md",children:b[h].description}),o.jsx("div",{className:"flex space-x-2",children:b.map((T,E)=>o.jsx("button",{onClick:()=>f(E),className:`h-1.5 rounded-full transition-all duration-300 ${E===h?"w-8 bg-white":"w-2 bg-white/40 hover:bg-white/60"}`,"aria-label":`Go to slide ${E+1}`},E))})]})]}),o.jsxs("div",{className:"relative w-full min-h-full lg:h-full bg-white overflow-hidden flex flex-col",children:[o.jsx("div",{className:"absolute top-0 right-0 -mt-20 -mr-20 w-80 h-80 bg-gradient-to-br from-sky-100/40 to-indigo-100/40 rounded-full blur-3xl pointer-events-none"}),o.jsx("div",{className:"relative lg:absolute lg:inset-0 overflow-y-auto flex flex-col justify-center p-6 sm:p-10 custom-scrollbar",children:o.jsxs("div",{className:"relative z-10 w-full max-w-md mx-auto",children:[o.jsx("div",{className:"mb-6",children:o.jsxs("div",{className:"flex flex-col lg:flex-row items-center lg:justify-between lg:items-end gap-4",children:[o.jsxs("div",{className:"flex flex-col lg:flex-row items-center gap-0",children:[o.jsx(Hu,{className:"h-11 w-auto text-sky-600"}),o.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-sky-600 to-indigo-600 bg-clip-text text-transparent tracking-tight text-center lg:text-left lg:-ml-1.5",children:"TutorFriends"})]}),o.jsxs("div",{className:"text-center lg:text-right pb-0.5",children:[o.jsx("h1",{className:"text-base font-bold text-slate-900 leading-tight",children:"Welcome Back"}),o.jsx("p",{className:"text-slate-500 text-xs font-medium leading-tight mt-0.5",children:"Please sign in"})]})]})}),o.jsxs("form",{className:"space-y-4",onSubmit:S,children:[o.jsxs("div",{className:"space-y-1.5",children:[o.jsx("label",{htmlFor:"email",className:"block text-xs font-bold text-slate-600 uppercase tracking-wider ml-1",children:"Email Address"}),o.jsxs("div",{className:"relative group",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx("svg",{className:"h-5 w-5 text-slate-400 group-focus-within:text-sky-500 transition-colors duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 12a4 4 0 10-8 0 4 4 0 008 0zm0 0v1.5a2.5 2.5 0 005 0V12a9 9 0 10-9 9m4.5-1.206a8.959 8.959 0 01-4.5 1.207"})})}),o.jsx("input",{id:"email",name:"email",type:"email",required:!0,value:n.email,onChange:N,className:"w-full pl-10 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-lg focus:bg-white focus:ring-[3px] focus:ring-sky-500/20 focus:border-sky-500 outline-none transition-all duration-300 font-medium text-slate-900 placeholder:text-slate-400 text-sm shadow-sm",placeholder:"student@university.edu"})]})]}),o.jsxs("div",{className:"space-y-1.5",children:[o.jsxs("div",{className:"flex justify-between items-center ml-1 mb-0.5",children:[o.jsx("label",{htmlFor:"password",className:"block text-xs font-bold text-slate-600 uppercase tracking-wider",children:"Password"}),o.jsx("button",{type:"button",onClick:()=>x(!0),className:"text-xs font-bold text-sky-600 hover:text-sky-700 transition-colors",children:"Forgot Password?"})]}),o.jsxs("div",{className:"relative group",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx("svg",{className:"h-5 w-5 text-slate-400 group-focus-within:text-sky-500 transition-colors duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),o.jsx("input",{id:"password",name:"password",type:c?"text":"password",required:!0,value:n.password,autoComplete:"current-password","data-form-type":"other","data-lpignore":"true","data-1p-ignore":"true","data-bwignore":"true",onChange:N,className:`w-full pl-10 pr-10 py-3 bg-slate-50 border border-slate-200 rounded-lg focus:bg-white focus:ring-[3px] focus:ring-sky-500/20 focus:border-sky-500 outline-none transition-all duration-300 font-medium text-slate-900 placeholder:text-slate-400 text-sm shadow-sm pr-10 
                      [&::-ms-reveal]:hidden 
                      [&::-webkit-credentials-auto-fill-button]:!hidden 
                      [&::-webkit-strong-password-auto-fill-button]:!hidden`,minLength:7,maxLength:13,placeholder:""}),o.jsx("button",{type:"button",onClick:()=>u(!c),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 transition-colors p-1",children:c?o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}):o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.242 4.242L6.228 6.228"})})})]})]}),i&&o.jsxs("div",{className:"bg-red-50/80 backdrop-blur-sm text-red-600 px-3 py-2 rounded-lg text-xs font-medium flex items-center shadow-sm border border-red-100 animate-fade-in-up",children:[o.jsx("svg",{className:"w-4 h-4 mr-2 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),i]}),o.jsx("button",{type:"submit",disabled:r,className:"w-full bg-gradient-to-r from-sky-600 to-indigo-600 hover:from-sky-700 hover:to-indigo-700 text-white font-bold py-3.5 rounded-xl shadow-lg shadow-sky-500/20 hover:shadow-sky-500/40 hover:-translate-y-0.5 transition-all duration-300 disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center space-x-2 text-sm tracking-wide",children:r?o.jsxs(o.Fragment,{children:[o.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),o.jsx("span",{children:"Signing In..."})]}):o.jsxs(o.Fragment,{children:[o.jsx("span",{children:"Sign In"}),o.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})})]}),o.jsx("div",{className:"mt-8 flex justify-center",children:o.jsxs("button",{onClick:()=>t("/LandingPage"),className:"group relative flex items-center justify-center text-slate-500 hover:text-sky-600 transition-all duration-300 text-sm font-semibold hover:translate-x-1 py-1",children:[o.jsx("span",{className:"absolute -left-6 opacity-0 -translate-x-2 group-hover:opacity-100 group-hover:translate-x-0 transition-all duration-300",children:""}),o.jsx("span",{children:"Back to Home Page"})]})})]})}),o.jsx(tU,{isOpen:p,onClose:()=>x(!1),onSuccess:()=>{}})]})]})]})},jKe=()=>{const t=qr(),[e]=_ne(),[n,s]=j.useState({code:"",newPassword:"",confirmPassword:""}),[r,a]=j.useState(!1),[i,l]=j.useState(""),[c,u]=j.useState(!1),[h,f]=j.useState(!1),[p,x]=j.useState(0),y=e.get("email")||"",v=e.get("type")==="admin"?"admin":"default",b=v==="admin"?"/auth/password-reset/admin/verify-and-reset":"/auth/password-reset/verify-and-reset",N=v==="admin"?"/admin-login":"/login",S=[{src:"https://images.unsplash.com/photo-1523240795612-9a054b0db644?q=80&w=2070&auto=format&fit=crop",alt:"Students studying together in a modern classroom",title:"Collaborative Learning",description:"Students working together to achieve academic success"},{src:"https://images.unsplash.com/photo-1543269865-cbf427effbad?q=80&w=2070&auto=format&fit=crop",alt:"Tutor helping student with laptop",title:"Expert Guidance",description:"Experienced tutors providing personalized support"},{src:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?q=80&w=2070&auto=format&fit=crop",alt:"Students in university lecture hall",title:"Academic Excellence",description:"Building knowledge and skills for future success"},{src:"https://images.unsplash.com/photo-1524178232363-1fb2b075b655?q=80&w=2070&auto=format&fit=crop",alt:"Student raising hand in classroom",title:"Interactive Learning",description:"Engaging educational experiences that inspire growth"}];j.useEffect(()=>{const D=setInterval(()=>{x(A=>(A+1)%S.length)},4e3);return()=>clearInterval(D)},[S.length]),j.useEffect(()=>{y||t(N)},[y,t,N]);const k=D=>{const{name:A,value:I}=D.target;s(P=>({...P,[A]:I})),i&&l("")},T=async D=>{var A,I;if(D.preventDefault(),a(!0),l(""),n.newPassword!==n.confirmPassword){l("Passwords do not match"),a(!1);return}if(n.newPassword.length<7){l("Password must be at least 7 characters long"),a(!1);return}try{(await we.post(b,{email:y,code:n.code,newPassword:n.newPassword})).data&&(alert("Password reset successful! You can now log in with your new password."),t(N))}catch(P){const $=((I=(A=P.response)==null?void 0:A.data)==null?void 0:I.message)||"Failed to reset password. Please try again.";l($)}finally{a(!1)}},E="w-full pl-10 pr-10 py-3 bg-slate-50 border border-slate-200 rounded-lg focus:bg-white focus:ring-[3px] focus:ring-sky-500/20 focus:border-sky-500 outline-none transition-all duration-300 font-medium text-slate-900 placeholder:text-slate-400 text-sm shadow-sm";return y?o.jsxs("div",{className:"h-screen bg-gradient-to-br from-slate-50 via-sky-50 to-indigo-100 flex items-center justify-center p-4 relative overflow-hidden",children:[o.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[o.jsx("div",{className:"absolute -top-40 -right-40 w-80 h-80 bg-gradient-to-br from-sky-400/20 to-indigo-400/20 rounded-full blur-3xl"}),o.jsx("div",{className:"absolute -bottom-40 -left-40 w-80 h-80 bg-gradient-to-tr from-indigo-400/20 to-sky-400/20 rounded-full blur-3xl"})]}),o.jsxs("div",{className:"w-full max-w-6xl bg-white/80 backdrop-blur-2xl rounded-[2.5rem] shadow-2xl overflow-hidden grid lg:grid-cols-2 relative z-10 max-h-[90vh] lg:max-h-[800px]",children:[o.jsxs("div",{className:"relative hidden lg:block h-full min-h-[500px]",children:[S.map((D,A)=>o.jsxs("div",{className:`absolute inset-0 transition-opacity duration-1000 ease-in-out ${A===p?"opacity-100":"opacity-0"}`,children:[o.jsx("img",{src:D.src,alt:D.alt,className:"w-full h-full object-cover"}),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/30 to-transparent"})]},A)),o.jsxs("div",{className:"absolute bottom-10 left-10 right-10 text-white z-20",children:[o.jsx("h2",{className:"text-3xl font-bold mb-2 leading-tight",children:S[p].title}),o.jsx("p",{className:"text-base text-white/90 mb-6 leading-normal max-w-md",children:S[p].description}),o.jsx("div",{className:"flex space-x-2",children:S.map((D,A)=>o.jsx("button",{onClick:()=>x(A),className:`h-1.5 rounded-full transition-all duration-300 ${A===p?"w-8 bg-white":"w-2 bg-white/40 hover:bg-white/60"}`,"aria-label":`Go to slide ${A+1}`},A))})]})]}),o.jsxs("div",{className:"relative w-full min-h-full lg:h-full bg-white overflow-hidden flex flex-col",children:[o.jsx("div",{className:"absolute top-0 right-0 -mt-20 -mr-20 w-80 h-80 bg-gradient-to-br from-sky-100/40 to-indigo-100/40 rounded-full blur-3xl pointer-events-none"}),o.jsx("div",{className:"relative lg:absolute lg:inset-0 overflow-hidden flex flex-col justify-center p-6 sm:p-10",children:o.jsxs("div",{className:"relative z-10 w-full max-w-md mx-auto",children:[o.jsx("div",{className:"mb-6",children:o.jsxs("div",{className:"flex flex-col lg:flex-row items-center lg:justify-between lg:items-end gap-4",children:[o.jsxs("div",{className:"flex flex-col lg:flex-row items-center gap-0",children:[o.jsx(Hu,{className:"h-11 w-auto text-sky-600"}),o.jsx("span",{className:"text-2xl font-bold bg-gradient-to-r from-sky-600 to-indigo-600 bg-clip-text text-transparent tracking-tight text-center lg:text-left lg:-ml-1.5",children:"TutorFriends"})]}),o.jsxs("div",{className:"text-center lg:text-right pb-0.5",children:[o.jsx("h1",{className:"text-base font-bold text-slate-900 leading-tight",children:v==="admin"?"Reset Admin Password":"Reset Password"}),o.jsx("p",{className:"text-slate-500 text-xs font-medium leading-tight mt-0.5",children:"Verify and Create New Password"})]})]})}),o.jsxs("form",{className:"space-y-4",onSubmit:T,children:[o.jsxs("div",{className:"space-y-1.5",children:[o.jsx("label",{htmlFor:"code",className:"block text-xs font-bold text-slate-600 uppercase tracking-wider ml-1",children:"Verification Code"}),o.jsxs("div",{className:"relative group",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx("svg",{className:"h-5 w-5 text-slate-400 group-focus-within:text-sky-500 transition-colors duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),o.jsx("input",{id:"code",name:"code",type:"text",required:!0,value:n.code,onChange:k,maxLength:6,className:"w-full pl-10 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-lg focus:bg-white focus:ring-[3px] focus:ring-sky-500/20 focus:border-sky-500 outline-none transition-all duration-300 font-medium text-slate-900 placeholder:text-slate-400 text-sm shadow-sm tracking-widest text-center",placeholder:"000000"})]}),o.jsxs("p",{className:"text-[10px] text-slate-400/80 ml-1",children:["Enter the 6-digit code sent to ",y]})]}),o.jsxs("div",{className:"space-y-1.5",children:[o.jsx("label",{htmlFor:"newPassword",className:"block text-xs font-bold text-slate-600 uppercase tracking-wider ml-1",children:"New Password"}),o.jsxs("div",{className:"relative group",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx("svg",{className:"h-5 w-5 text-slate-400 group-focus-within:text-sky-500 transition-colors duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),o.jsx("input",{id:"newPassword",name:"newPassword",type:c?"text":"password",required:!0,value:n.newPassword,onChange:k,className:`${E} pr-10 
                      [&::-ms-reveal]:hidden 
                      [&::-webkit-credentials-auto-fill-button]:!hidden 
                      [&::-webkit-strong-password-auto-fill-button]:!hidden`,minLength:7,maxLength:21,placeholder:""}),o.jsx("button",{type:"button",onClick:()=>u(!c),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 transition-colors p-1",children:c?o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}):o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.242 4.242L6.228 6.228"})})})]})]}),o.jsxs("div",{className:"space-y-1.5",children:[o.jsx("label",{htmlFor:"confirmPassword",className:"block text-xs font-bold text-slate-600 uppercase tracking-wider ml-1",children:"Confirm Password"}),o.jsxs("div",{className:"relative group",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx("svg",{className:"h-5 w-5 text-slate-400 group-focus-within:text-sky-500 transition-colors duration-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),o.jsx("input",{id:"confirmPassword",name:"confirmPassword",type:h?"text":"password",required:!0,value:n.confirmPassword,onChange:k,className:`${E} pr-10 
                      [&::-ms-reveal]:hidden 
                      [&::-webkit-credentials-auto-fill-button]:!hidden 
                      [&::-webkit-strong-password-auto-fill-button]:!hidden`,minLength:7,maxLength:21,placeholder:""}),o.jsx("button",{type:"button",onClick:()=>f(!h),className:"absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-slate-600 transition-colors p-1",children:h?o.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:[o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 010-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178z"}),o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})]}):o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-5 h-5",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 001.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.45 10.45 0 0112 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 01-4.293 5.774M6.228 6.228L3 3m3.228 3.228l3.65 3.65m7.894 7.894L21 21m-3.228-3.228l-3.65-3.65m0 0a3 3 0 10-4.243-4.243m4.242 4.242L6.228 6.228"})})})]})]}),i&&o.jsxs("div",{className:"bg-red-50/80 backdrop-blur-sm text-red-600 px-3 py-2 rounded-lg text-xs font-medium flex items-center shadow-sm border border-red-100 animate-fade-in-up",children:[o.jsx("svg",{className:"w-4 h-4 mr-2 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:o.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),i]}),o.jsx("button",{type:"submit",disabled:r,className:"w-full bg-gradient-to-r from-sky-600 to-indigo-600 hover:from-sky-700 hover:to-indigo-700 text-white font-bold py-3.5 rounded-xl shadow-lg shadow-sky-500/20 hover:shadow-sky-500/40 hover:-translate-y-0.5 transition-all duration-300 disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center space-x-2 text-sm tracking-wide",children:r?o.jsxs(o.Fragment,{children:[o.jsxs("svg",{className:"animate-spin h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[o.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),o.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),o.jsx("span",{children:"Resetting..."})]}):o.jsxs(o.Fragment,{children:[o.jsx("span",{children:"Reset Password"}),o.jsx("svg",{className:"w-4 h-4 ml-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14 5l7 7m0 0l-7 7m7-7H3"})})]})})]}),o.jsx("div",{className:"mt-8 flex justify-center",children:o.jsxs("button",{onClick:()=>t(N),className:"group relative flex items-center justify-center text-slate-500 hover:text-sky-600 transition-all duration-300 text-sm font-semibold hover:translate-x-1 py-1",children:[o.jsx("span",{className:"absolute -left-6 opacity-0 -translate-x-2 group-hover:opacity-100 group-hover:translate-x-0 transition-all duration-300",children:""}),o.jsxs("span",{children:["Back to ",v==="admin"?"Admin Login":"Login"]})]})})]})})]})]})]}):null},kKe=()=>o.jsxs(ew,{children:[o.jsx(rn,{path:"/",element:o.jsx(nl,{to:"/LandingPage",replace:!0})}),o.jsx(rn,{path:"/LandingPage",element:o.jsx(JB,{})}),o.jsx(rn,{path:"/landingpage",element:o.jsx(JB,{})}),o.jsx(rn,{path:"/TuteeRegistrationPage",element:o.jsx(Vqe,{})}),o.jsx(rn,{path:"/TutorRegistrationPage",element:o.jsx(Wqe,{})}),o.jsx(rn,{path:"/login",element:o.jsx(SKe,{})}),o.jsx(rn,{path:"/password-reset",element:o.jsx(jKe,{})}),o.jsx(rn,{path:"/admin-login",element:o.jsx(gre,{})}),o.jsx(rn,{path:"/register",element:o.jsx(bre,{})}),o.jsxs(rn,{element:o.jsx(wre,{}),children:[o.jsx(rn,{path:"/admin/*",element:o.jsx(Eae,{children:o.jsxs(ew,{children:[o.jsx(rn,{path:"/",element:o.jsx(r8,{})}),o.jsx(rn,{path:"dashboard",element:o.jsx(r8,{})}),o.jsx(rn,{path:"users",element:o.jsx(L1e,{})}),o.jsx(rn,{path:"tutors",element:o.jsx(M1e,{})}),o.jsx(rn,{path:"universities",element:o.jsx(F1e,{})}),o.jsx(rn,{path:"courses",element:o.jsx(z1e,{})}),o.jsx(rn,{path:"payments",element:o.jsx(B1e,{})}),o.jsx(rn,{path:"profile",element:o.jsx(U1e,{})}),o.jsx(rn,{path:"*",element:o.jsx(nl,{to:"/admin",replace:!0})})]})})}),o.jsx(rn,{path:"tutor-dashboard/*",element:o.jsx(mKe,{})}),o.jsx(rn,{path:"tutee-dashboard/*",element:o.jsx(NKe,{})})]}),o.jsx(rn,{path:"*",element:o.jsx(nl,{to:"/LandingPage",replace:!0})})]}),tJ=document.getElementById("root");if(!tJ)throw new Error("Failed to find the root element");const CKe=ete.createRoot(tJ);CKe.render(o.jsx(tn.StrictMode,{children:o.jsx(jne,{children:o.jsxs(yre,{children:[" ",o.jsx(pre,{children:o.jsx(o4,{children:o.jsx(kKe,{})})})]})})}));export{Xm as _};
